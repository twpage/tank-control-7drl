/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, {
/******/ 				configurable: false,
/******/ 				enumerable: true,
/******/ 				get: getter
/******/ 			});
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "/dist/";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./src/start.ts");
/******/ })
/************************************************************************/
/******/ ({

/***/ "./node_modules/lodash/lodash.js":
/*!***************************************!*\
  !*** ./node_modules/lodash/lodash.js ***!
  \***************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("/* WEBPACK VAR INJECTION */(function(global, module) {var __WEBPACK_AMD_DEFINE_RESULT__;/**\n * @license\n * Lodash <https://lodash.com/>\n * Copyright JS Foundation and other contributors <https://js.foundation/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n;(function() {\n\n  /** Used as a safe reference for `undefined` in pre-ES5 environments. */\n  var undefined;\n\n  /** Used as the semantic version number. */\n  var VERSION = '4.17.5';\n\n  /** Used as the size to enable large array optimizations. */\n  var LARGE_ARRAY_SIZE = 200;\n\n  /** Error message constants. */\n  var CORE_ERROR_TEXT = 'Unsupported core-js use. Try https://npms.io/search?q=ponyfill.',\n      FUNC_ERROR_TEXT = 'Expected a function';\n\n  /** Used to stand-in for `undefined` hash values. */\n  var HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n  /** Used as the maximum memoize cache size. */\n  var MAX_MEMOIZE_SIZE = 500;\n\n  /** Used as the internal argument placeholder. */\n  var PLACEHOLDER = '__lodash_placeholder__';\n\n  /** Used to compose bitmasks for cloning. */\n  var CLONE_DEEP_FLAG = 1,\n      CLONE_FLAT_FLAG = 2,\n      CLONE_SYMBOLS_FLAG = 4;\n\n  /** Used to compose bitmasks for value comparisons. */\n  var COMPARE_PARTIAL_FLAG = 1,\n      COMPARE_UNORDERED_FLAG = 2;\n\n  /** Used to compose bitmasks for function metadata. */\n  var WRAP_BIND_FLAG = 1,\n      WRAP_BIND_KEY_FLAG = 2,\n      WRAP_CURRY_BOUND_FLAG = 4,\n      WRAP_CURRY_FLAG = 8,\n      WRAP_CURRY_RIGHT_FLAG = 16,\n      WRAP_PARTIAL_FLAG = 32,\n      WRAP_PARTIAL_RIGHT_FLAG = 64,\n      WRAP_ARY_FLAG = 128,\n      WRAP_REARG_FLAG = 256,\n      WRAP_FLIP_FLAG = 512;\n\n  /** Used as default options for `_.truncate`. */\n  var DEFAULT_TRUNC_LENGTH = 30,\n      DEFAULT_TRUNC_OMISSION = '...';\n\n  /** Used to detect hot functions by number of calls within a span of milliseconds. */\n  var HOT_COUNT = 800,\n      HOT_SPAN = 16;\n\n  /** Used to indicate the type of lazy iteratees. */\n  var LAZY_FILTER_FLAG = 1,\n      LAZY_MAP_FLAG = 2,\n      LAZY_WHILE_FLAG = 3;\n\n  /** Used as references for various `Number` constants. */\n  var INFINITY = 1 / 0,\n      MAX_SAFE_INTEGER = 9007199254740991,\n      MAX_INTEGER = 1.7976931348623157e+308,\n      NAN = 0 / 0;\n\n  /** Used as references for the maximum length and index of an array. */\n  var MAX_ARRAY_LENGTH = 4294967295,\n      MAX_ARRAY_INDEX = MAX_ARRAY_LENGTH - 1,\n      HALF_MAX_ARRAY_LENGTH = MAX_ARRAY_LENGTH >>> 1;\n\n  /** Used to associate wrap methods with their bit flags. */\n  var wrapFlags = [\n    ['ary', WRAP_ARY_FLAG],\n    ['bind', WRAP_BIND_FLAG],\n    ['bindKey', WRAP_BIND_KEY_FLAG],\n    ['curry', WRAP_CURRY_FLAG],\n    ['curryRight', WRAP_CURRY_RIGHT_FLAG],\n    ['flip', WRAP_FLIP_FLAG],\n    ['partial', WRAP_PARTIAL_FLAG],\n    ['partialRight', WRAP_PARTIAL_RIGHT_FLAG],\n    ['rearg', WRAP_REARG_FLAG]\n  ];\n\n  /** `Object#toString` result references. */\n  var argsTag = '[object Arguments]',\n      arrayTag = '[object Array]',\n      asyncTag = '[object AsyncFunction]',\n      boolTag = '[object Boolean]',\n      dateTag = '[object Date]',\n      domExcTag = '[object DOMException]',\n      errorTag = '[object Error]',\n      funcTag = '[object Function]',\n      genTag = '[object GeneratorFunction]',\n      mapTag = '[object Map]',\n      numberTag = '[object Number]',\n      nullTag = '[object Null]',\n      objectTag = '[object Object]',\n      promiseTag = '[object Promise]',\n      proxyTag = '[object Proxy]',\n      regexpTag = '[object RegExp]',\n      setTag = '[object Set]',\n      stringTag = '[object String]',\n      symbolTag = '[object Symbol]',\n      undefinedTag = '[object Undefined]',\n      weakMapTag = '[object WeakMap]',\n      weakSetTag = '[object WeakSet]';\n\n  var arrayBufferTag = '[object ArrayBuffer]',\n      dataViewTag = '[object DataView]',\n      float32Tag = '[object Float32Array]',\n      float64Tag = '[object Float64Array]',\n      int8Tag = '[object Int8Array]',\n      int16Tag = '[object Int16Array]',\n      int32Tag = '[object Int32Array]',\n      uint8Tag = '[object Uint8Array]',\n      uint8ClampedTag = '[object Uint8ClampedArray]',\n      uint16Tag = '[object Uint16Array]',\n      uint32Tag = '[object Uint32Array]';\n\n  /** Used to match empty string literals in compiled template source. */\n  var reEmptyStringLeading = /\\b__p \\+= '';/g,\n      reEmptyStringMiddle = /\\b(__p \\+=) '' \\+/g,\n      reEmptyStringTrailing = /(__e\\(.*?\\)|\\b__t\\)) \\+\\n'';/g;\n\n  /** Used to match HTML entities and HTML characters. */\n  var reEscapedHtml = /&(?:amp|lt|gt|quot|#39);/g,\n      reUnescapedHtml = /[&<>\"']/g,\n      reHasEscapedHtml = RegExp(reEscapedHtml.source),\n      reHasUnescapedHtml = RegExp(reUnescapedHtml.source);\n\n  /** Used to match template delimiters. */\n  var reEscape = /<%-([\\s\\S]+?)%>/g,\n      reEvaluate = /<%([\\s\\S]+?)%>/g,\n      reInterpolate = /<%=([\\s\\S]+?)%>/g;\n\n  /** Used to match property names within property paths. */\n  var reIsDeepProp = /\\.|\\[(?:[^[\\]]*|([\"'])(?:(?!\\1)[^\\\\]|\\\\.)*?\\1)\\]/,\n      reIsPlainProp = /^\\w*$/,\n      rePropName = /[^.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))/g;\n\n  /**\n   * Used to match `RegExp`\n   * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n   */\n  var reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g,\n      reHasRegExpChar = RegExp(reRegExpChar.source);\n\n  /** Used to match leading and trailing whitespace. */\n  var reTrim = /^\\s+|\\s+$/g,\n      reTrimStart = /^\\s+/,\n      reTrimEnd = /\\s+$/;\n\n  /** Used to match wrap detail comments. */\n  var reWrapComment = /\\{(?:\\n\\/\\* \\[wrapped with .+\\] \\*\\/)?\\n?/,\n      reWrapDetails = /\\{\\n\\/\\* \\[wrapped with (.+)\\] \\*/,\n      reSplitDetails = /,? & /;\n\n  /** Used to match words composed of alphanumeric characters. */\n  var reAsciiWord = /[^\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\x7f]+/g;\n\n  /** Used to match backslashes in property paths. */\n  var reEscapeChar = /\\\\(\\\\)?/g;\n\n  /**\n   * Used to match\n   * [ES template delimiters](http://ecma-international.org/ecma-262/7.0/#sec-template-literal-lexical-components).\n   */\n  var reEsTemplate = /\\$\\{([^\\\\}]*(?:\\\\.[^\\\\}]*)*)\\}/g;\n\n  /** Used to match `RegExp` flags from their coerced string values. */\n  var reFlags = /\\w*$/;\n\n  /** Used to detect bad signed hexadecimal string values. */\n  var reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n  /** Used to detect binary string values. */\n  var reIsBinary = /^0b[01]+$/i;\n\n  /** Used to detect host constructors (Safari). */\n  var reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n  /** Used to detect octal string values. */\n  var reIsOctal = /^0o[0-7]+$/i;\n\n  /** Used to detect unsigned integer values. */\n  var reIsUint = /^(?:0|[1-9]\\d*)$/;\n\n  /** Used to match Latin Unicode letters (excluding mathematical operators). */\n  var reLatin = /[\\xc0-\\xd6\\xd8-\\xf6\\xf8-\\xff\\u0100-\\u017f]/g;\n\n  /** Used to ensure capturing order of template delimiters. */\n  var reNoMatch = /($^)/;\n\n  /** Used to match unescaped characters in compiled string literals. */\n  var reUnescapedString = /['\\n\\r\\u2028\\u2029\\\\]/g;\n\n  /** Used to compose unicode character classes. */\n  var rsAstralRange = '\\\\ud800-\\\\udfff',\n      rsComboMarksRange = '\\\\u0300-\\\\u036f',\n      reComboHalfMarksRange = '\\\\ufe20-\\\\ufe2f',\n      rsComboSymbolsRange = '\\\\u20d0-\\\\u20ff',\n      rsComboRange = rsComboMarksRange + reComboHalfMarksRange + rsComboSymbolsRange,\n      rsDingbatRange = '\\\\u2700-\\\\u27bf',\n      rsLowerRange = 'a-z\\\\xdf-\\\\xf6\\\\xf8-\\\\xff',\n      rsMathOpRange = '\\\\xac\\\\xb1\\\\xd7\\\\xf7',\n      rsNonCharRange = '\\\\x00-\\\\x2f\\\\x3a-\\\\x40\\\\x5b-\\\\x60\\\\x7b-\\\\xbf',\n      rsPunctuationRange = '\\\\u2000-\\\\u206f',\n      rsSpaceRange = ' \\\\t\\\\x0b\\\\f\\\\xa0\\\\ufeff\\\\n\\\\r\\\\u2028\\\\u2029\\\\u1680\\\\u180e\\\\u2000\\\\u2001\\\\u2002\\\\u2003\\\\u2004\\\\u2005\\\\u2006\\\\u2007\\\\u2008\\\\u2009\\\\u200a\\\\u202f\\\\u205f\\\\u3000',\n      rsUpperRange = 'A-Z\\\\xc0-\\\\xd6\\\\xd8-\\\\xde',\n      rsVarRange = '\\\\ufe0e\\\\ufe0f',\n      rsBreakRange = rsMathOpRange + rsNonCharRange + rsPunctuationRange + rsSpaceRange;\n\n  /** Used to compose unicode capture groups. */\n  var rsApos = \"['\\u2019]\",\n      rsAstral = '[' + rsAstralRange + ']',\n      rsBreak = '[' + rsBreakRange + ']',\n      rsCombo = '[' + rsComboRange + ']',\n      rsDigits = '\\\\d+',\n      rsDingbat = '[' + rsDingbatRange + ']',\n      rsLower = '[' + rsLowerRange + ']',\n      rsMisc = '[^' + rsAstralRange + rsBreakRange + rsDigits + rsDingbatRange + rsLowerRange + rsUpperRange + ']',\n      rsFitz = '\\\\ud83c[\\\\udffb-\\\\udfff]',\n      rsModifier = '(?:' + rsCombo + '|' + rsFitz + ')',\n      rsNonAstral = '[^' + rsAstralRange + ']',\n      rsRegional = '(?:\\\\ud83c[\\\\udde6-\\\\uddff]){2}',\n      rsSurrPair = '[\\\\ud800-\\\\udbff][\\\\udc00-\\\\udfff]',\n      rsUpper = '[' + rsUpperRange + ']',\n      rsZWJ = '\\\\u200d';\n\n  /** Used to compose unicode regexes. */\n  var rsMiscLower = '(?:' + rsLower + '|' + rsMisc + ')',\n      rsMiscUpper = '(?:' + rsUpper + '|' + rsMisc + ')',\n      rsOptContrLower = '(?:' + rsApos + '(?:d|ll|m|re|s|t|ve))?',\n      rsOptContrUpper = '(?:' + rsApos + '(?:D|LL|M|RE|S|T|VE))?',\n      reOptMod = rsModifier + '?',\n      rsOptVar = '[' + rsVarRange + ']?',\n      rsOptJoin = '(?:' + rsZWJ + '(?:' + [rsNonAstral, rsRegional, rsSurrPair].join('|') + ')' + rsOptVar + reOptMod + ')*',\n      rsOrdLower = '\\\\d*(?:1st|2nd|3rd|(?![123])\\\\dth)(?=\\\\b|[A-Z_])',\n      rsOrdUpper = '\\\\d*(?:1ST|2ND|3RD|(?![123])\\\\dTH)(?=\\\\b|[a-z_])',\n      rsSeq = rsOptVar + reOptMod + rsOptJoin,\n      rsEmoji = '(?:' + [rsDingbat, rsRegional, rsSurrPair].join('|') + ')' + rsSeq,\n      rsSymbol = '(?:' + [rsNonAstral + rsCombo + '?', rsCombo, rsRegional, rsSurrPair, rsAstral].join('|') + ')';\n\n  /** Used to match apostrophes. */\n  var reApos = RegExp(rsApos, 'g');\n\n  /**\n   * Used to match [combining diacritical marks](https://en.wikipedia.org/wiki/Combining_Diacritical_Marks) and\n   * [combining diacritical marks for symbols](https://en.wikipedia.org/wiki/Combining_Diacritical_Marks_for_Symbols).\n   */\n  var reComboMark = RegExp(rsCombo, 'g');\n\n  /** Used to match [string symbols](https://mathiasbynens.be/notes/javascript-unicode). */\n  var reUnicode = RegExp(rsFitz + '(?=' + rsFitz + ')|' + rsSymbol + rsSeq, 'g');\n\n  /** Used to match complex or compound words. */\n  var reUnicodeWord = RegExp([\n    rsUpper + '?' + rsLower + '+' + rsOptContrLower + '(?=' + [rsBreak, rsUpper, '$'].join('|') + ')',\n    rsMiscUpper + '+' + rsOptContrUpper + '(?=' + [rsBreak, rsUpper + rsMiscLower, '$'].join('|') + ')',\n    rsUpper + '?' + rsMiscLower + '+' + rsOptContrLower,\n    rsUpper + '+' + rsOptContrUpper,\n    rsOrdUpper,\n    rsOrdLower,\n    rsDigits,\n    rsEmoji\n  ].join('|'), 'g');\n\n  /** Used to detect strings with [zero-width joiners or code points from the astral planes](http://eev.ee/blog/2015/09/12/dark-corners-of-unicode/). */\n  var reHasUnicode = RegExp('[' + rsZWJ + rsAstralRange  + rsComboRange + rsVarRange + ']');\n\n  /** Used to detect strings that need a more robust regexp to match words. */\n  var reHasUnicodeWord = /[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;\n\n  /** Used to assign default `context` object properties. */\n  var contextProps = [\n    'Array', 'Buffer', 'DataView', 'Date', 'Error', 'Float32Array', 'Float64Array',\n    'Function', 'Int8Array', 'Int16Array', 'Int32Array', 'Map', 'Math', 'Object',\n    'Promise', 'RegExp', 'Set', 'String', 'Symbol', 'TypeError', 'Uint8Array',\n    'Uint8ClampedArray', 'Uint16Array', 'Uint32Array', 'WeakMap',\n    '_', 'clearTimeout', 'isFinite', 'parseInt', 'setTimeout'\n  ];\n\n  /** Used to make template sourceURLs easier to identify. */\n  var templateCounter = -1;\n\n  /** Used to identify `toStringTag` values of typed arrays. */\n  var typedArrayTags = {};\n  typedArrayTags[float32Tag] = typedArrayTags[float64Tag] =\n  typedArrayTags[int8Tag] = typedArrayTags[int16Tag] =\n  typedArrayTags[int32Tag] = typedArrayTags[uint8Tag] =\n  typedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] =\n  typedArrayTags[uint32Tag] = true;\n  typedArrayTags[argsTag] = typedArrayTags[arrayTag] =\n  typedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] =\n  typedArrayTags[dataViewTag] = typedArrayTags[dateTag] =\n  typedArrayTags[errorTag] = typedArrayTags[funcTag] =\n  typedArrayTags[mapTag] = typedArrayTags[numberTag] =\n  typedArrayTags[objectTag] = typedArrayTags[regexpTag] =\n  typedArrayTags[setTag] = typedArrayTags[stringTag] =\n  typedArrayTags[weakMapTag] = false;\n\n  /** Used to identify `toStringTag` values supported by `_.clone`. */\n  var cloneableTags = {};\n  cloneableTags[argsTag] = cloneableTags[arrayTag] =\n  cloneableTags[arrayBufferTag] = cloneableTags[dataViewTag] =\n  cloneableTags[boolTag] = cloneableTags[dateTag] =\n  cloneableTags[float32Tag] = cloneableTags[float64Tag] =\n  cloneableTags[int8Tag] = cloneableTags[int16Tag] =\n  cloneableTags[int32Tag] = cloneableTags[mapTag] =\n  cloneableTags[numberTag] = cloneableTags[objectTag] =\n  cloneableTags[regexpTag] = cloneableTags[setTag] =\n  cloneableTags[stringTag] = cloneableTags[symbolTag] =\n  cloneableTags[uint8Tag] = cloneableTags[uint8ClampedTag] =\n  cloneableTags[uint16Tag] = cloneableTags[uint32Tag] = true;\n  cloneableTags[errorTag] = cloneableTags[funcTag] =\n  cloneableTags[weakMapTag] = false;\n\n  /** Used to map Latin Unicode letters to basic Latin letters. */\n  var deburredLetters = {\n    // Latin-1 Supplement block.\n    '\\xc0': 'A',  '\\xc1': 'A', '\\xc2': 'A', '\\xc3': 'A', '\\xc4': 'A', '\\xc5': 'A',\n    '\\xe0': 'a',  '\\xe1': 'a', '\\xe2': 'a', '\\xe3': 'a', '\\xe4': 'a', '\\xe5': 'a',\n    '\\xc7': 'C',  '\\xe7': 'c',\n    '\\xd0': 'D',  '\\xf0': 'd',\n    '\\xc8': 'E',  '\\xc9': 'E', '\\xca': 'E', '\\xcb': 'E',\n    '\\xe8': 'e',  '\\xe9': 'e', '\\xea': 'e', '\\xeb': 'e',\n    '\\xcc': 'I',  '\\xcd': 'I', '\\xce': 'I', '\\xcf': 'I',\n    '\\xec': 'i',  '\\xed': 'i', '\\xee': 'i', '\\xef': 'i',\n    '\\xd1': 'N',  '\\xf1': 'n',\n    '\\xd2': 'O',  '\\xd3': 'O', '\\xd4': 'O', '\\xd5': 'O', '\\xd6': 'O', '\\xd8': 'O',\n    '\\xf2': 'o',  '\\xf3': 'o', '\\xf4': 'o', '\\xf5': 'o', '\\xf6': 'o', '\\xf8': 'o',\n    '\\xd9': 'U',  '\\xda': 'U', '\\xdb': 'U', '\\xdc': 'U',\n    '\\xf9': 'u',  '\\xfa': 'u', '\\xfb': 'u', '\\xfc': 'u',\n    '\\xdd': 'Y',  '\\xfd': 'y', '\\xff': 'y',\n    '\\xc6': 'Ae', '\\xe6': 'ae',\n    '\\xde': 'Th', '\\xfe': 'th',\n    '\\xdf': 'ss',\n    // Latin Extended-A block.\n    '\\u0100': 'A',  '\\u0102': 'A', '\\u0104': 'A',\n    '\\u0101': 'a',  '\\u0103': 'a', '\\u0105': 'a',\n    '\\u0106': 'C',  '\\u0108': 'C', '\\u010a': 'C', '\\u010c': 'C',\n    '\\u0107': 'c',  '\\u0109': 'c', '\\u010b': 'c', '\\u010d': 'c',\n    '\\u010e': 'D',  '\\u0110': 'D', '\\u010f': 'd', '\\u0111': 'd',\n    '\\u0112': 'E',  '\\u0114': 'E', '\\u0116': 'E', '\\u0118': 'E', '\\u011a': 'E',\n    '\\u0113': 'e',  '\\u0115': 'e', '\\u0117': 'e', '\\u0119': 'e', '\\u011b': 'e',\n    '\\u011c': 'G',  '\\u011e': 'G', '\\u0120': 'G', '\\u0122': 'G',\n    '\\u011d': 'g',  '\\u011f': 'g', '\\u0121': 'g', '\\u0123': 'g',\n    '\\u0124': 'H',  '\\u0126': 'H', '\\u0125': 'h', '\\u0127': 'h',\n    '\\u0128': 'I',  '\\u012a': 'I', '\\u012c': 'I', '\\u012e': 'I', '\\u0130': 'I',\n    '\\u0129': 'i',  '\\u012b': 'i', '\\u012d': 'i', '\\u012f': 'i', '\\u0131': 'i',\n    '\\u0134': 'J',  '\\u0135': 'j',\n    '\\u0136': 'K',  '\\u0137': 'k', '\\u0138': 'k',\n    '\\u0139': 'L',  '\\u013b': 'L', '\\u013d': 'L', '\\u013f': 'L', '\\u0141': 'L',\n    '\\u013a': 'l',  '\\u013c': 'l', '\\u013e': 'l', '\\u0140': 'l', '\\u0142': 'l',\n    '\\u0143': 'N',  '\\u0145': 'N', '\\u0147': 'N', '\\u014a': 'N',\n    '\\u0144': 'n',  '\\u0146': 'n', '\\u0148': 'n', '\\u014b': 'n',\n    '\\u014c': 'O',  '\\u014e': 'O', '\\u0150': 'O',\n    '\\u014d': 'o',  '\\u014f': 'o', '\\u0151': 'o',\n    '\\u0154': 'R',  '\\u0156': 'R', '\\u0158': 'R',\n    '\\u0155': 'r',  '\\u0157': 'r', '\\u0159': 'r',\n    '\\u015a': 'S',  '\\u015c': 'S', '\\u015e': 'S', '\\u0160': 'S',\n    '\\u015b': 's',  '\\u015d': 's', '\\u015f': 's', '\\u0161': 's',\n    '\\u0162': 'T',  '\\u0164': 'T', '\\u0166': 'T',\n    '\\u0163': 't',  '\\u0165': 't', '\\u0167': 't',\n    '\\u0168': 'U',  '\\u016a': 'U', '\\u016c': 'U', '\\u016e': 'U', '\\u0170': 'U', '\\u0172': 'U',\n    '\\u0169': 'u',  '\\u016b': 'u', '\\u016d': 'u', '\\u016f': 'u', '\\u0171': 'u', '\\u0173': 'u',\n    '\\u0174': 'W',  '\\u0175': 'w',\n    '\\u0176': 'Y',  '\\u0177': 'y', '\\u0178': 'Y',\n    '\\u0179': 'Z',  '\\u017b': 'Z', '\\u017d': 'Z',\n    '\\u017a': 'z',  '\\u017c': 'z', '\\u017e': 'z',\n    '\\u0132': 'IJ', '\\u0133': 'ij',\n    '\\u0152': 'Oe', '\\u0153': 'oe',\n    '\\u0149': \"'n\", '\\u017f': 's'\n  };\n\n  /** Used to map characters to HTML entities. */\n  var htmlEscapes = {\n    '&': '&amp;',\n    '<': '&lt;',\n    '>': '&gt;',\n    '\"': '&quot;',\n    \"'\": '&#39;'\n  };\n\n  /** Used to map HTML entities to characters. */\n  var htmlUnescapes = {\n    '&amp;': '&',\n    '&lt;': '<',\n    '&gt;': '>',\n    '&quot;': '\"',\n    '&#39;': \"'\"\n  };\n\n  /** Used to escape characters for inclusion in compiled string literals. */\n  var stringEscapes = {\n    '\\\\': '\\\\',\n    \"'\": \"'\",\n    '\\n': 'n',\n    '\\r': 'r',\n    '\\u2028': 'u2028',\n    '\\u2029': 'u2029'\n  };\n\n  /** Built-in method references without a dependency on `root`. */\n  var freeParseFloat = parseFloat,\n      freeParseInt = parseInt;\n\n  /** Detect free variable `global` from Node.js. */\n  var freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\n  /** Detect free variable `self`. */\n  var freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n  /** Used as a reference to the global object. */\n  var root = freeGlobal || freeSelf || Function('return this')();\n\n  /** Detect free variable `exports`. */\n  var freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n  /** Detect free variable `module`. */\n  var freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n  /** Detect the popular CommonJS extension `module.exports`. */\n  var moduleExports = freeModule && freeModule.exports === freeExports;\n\n  /** Detect free variable `process` from Node.js. */\n  var freeProcess = moduleExports && freeGlobal.process;\n\n  /** Used to access faster Node.js helpers. */\n  var nodeUtil = (function() {\n    try {\n      return freeProcess && freeProcess.binding && freeProcess.binding('util');\n    } catch (e) {}\n  }());\n\n  /* Node.js helper references. */\n  var nodeIsArrayBuffer = nodeUtil && nodeUtil.isArrayBuffer,\n      nodeIsDate = nodeUtil && nodeUtil.isDate,\n      nodeIsMap = nodeUtil && nodeUtil.isMap,\n      nodeIsRegExp = nodeUtil && nodeUtil.isRegExp,\n      nodeIsSet = nodeUtil && nodeUtil.isSet,\n      nodeIsTypedArray = nodeUtil && nodeUtil.isTypedArray;\n\n  /*--------------------------------------------------------------------------*/\n\n  /**\n   * A faster alternative to `Function#apply`, this function invokes `func`\n   * with the `this` binding of `thisArg` and the arguments of `args`.\n   *\n   * @private\n   * @param {Function} func The function to invoke.\n   * @param {*} thisArg The `this` binding of `func`.\n   * @param {Array} args The arguments to invoke `func` with.\n   * @returns {*} Returns the result of `func`.\n   */\n  function apply(func, thisArg, args) {\n    switch (args.length) {\n      case 0: return func.call(thisArg);\n      case 1: return func.call(thisArg, args[0]);\n      case 2: return func.call(thisArg, args[0], args[1]);\n      case 3: return func.call(thisArg, args[0], args[1], args[2]);\n    }\n    return func.apply(thisArg, args);\n  }\n\n  /**\n   * A specialized version of `baseAggregator` for arrays.\n   *\n   * @private\n   * @param {Array} [array] The array to iterate over.\n   * @param {Function} setter The function to set `accumulator` values.\n   * @param {Function} iteratee The iteratee to transform keys.\n   * @param {Object} accumulator The initial aggregated object.\n   * @returns {Function} Returns `accumulator`.\n   */\n  function arrayAggregator(array, setter, iteratee, accumulator) {\n    var index = -1,\n        length = array == null ? 0 : array.length;\n\n    while (++index < length) {\n      var value = array[index];\n      setter(accumulator, value, iteratee(value), array);\n    }\n    return accumulator;\n  }\n\n  /**\n   * A specialized version of `_.forEach` for arrays without support for\n   * iteratee shorthands.\n   *\n   * @private\n   * @param {Array} [array] The array to iterate over.\n   * @param {Function} iteratee The function invoked per iteration.\n   * @returns {Array} Returns `array`.\n   */\n  function arrayEach(array, iteratee) {\n    var index = -1,\n        length = array == null ? 0 : array.length;\n\n    while (++index < length) {\n      if (iteratee(array[index], index, array) === false) {\n        break;\n      }\n    }\n    return array;\n  }\n\n  /**\n   * A specialized version of `_.forEachRight` for arrays without support for\n   * iteratee shorthands.\n   *\n   * @private\n   * @param {Array} [array] The array to iterate over.\n   * @param {Function} iteratee The function invoked per iteration.\n   * @returns {Array} Returns `array`.\n   */\n  function arrayEachRight(array, iteratee) {\n    var length = array == null ? 0 : array.length;\n\n    while (length--) {\n      if (iteratee(array[length], length, array) === false) {\n        break;\n      }\n    }\n    return array;\n  }\n\n  /**\n   * A specialized version of `_.every` for arrays without support for\n   * iteratee shorthands.\n   *\n   * @private\n   * @param {Array} [array] The array to iterate over.\n   * @param {Function} predicate The function invoked per iteration.\n   * @returns {boolean} Returns `true` if all elements pass the predicate check,\n   *  else `false`.\n   */\n  function arrayEvery(array, predicate) {\n    var index = -1,\n        length = array == null ? 0 : array.length;\n\n    while (++index < length) {\n      if (!predicate(array[index], index, array)) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  /**\n   * A specialized version of `_.filter` for arrays without support for\n   * iteratee shorthands.\n   *\n   * @private\n   * @param {Array} [array] The array to iterate over.\n   * @param {Function} predicate The function invoked per iteration.\n   * @returns {Array} Returns the new filtered array.\n   */\n  function arrayFilter(array, predicate) {\n    var index = -1,\n        length = array == null ? 0 : array.length,\n        resIndex = 0,\n        result = [];\n\n    while (++index < length) {\n      var value = array[index];\n      if (predicate(value, index, array)) {\n        result[resIndex++] = value;\n      }\n    }\n    return result;\n  }\n\n  /**\n   * A specialized version of `_.includes` for arrays without support for\n   * specifying an index to search from.\n   *\n   * @private\n   * @param {Array} [array] The array to inspect.\n   * @param {*} target The value to search for.\n   * @returns {boolean} Returns `true` if `target` is found, else `false`.\n   */\n  function arrayIncludes(array, value) {\n    var length = array == null ? 0 : array.length;\n    return !!length && baseIndexOf(array, value, 0) > -1;\n  }\n\n  /**\n   * This function is like `arrayIncludes` except that it accepts a comparator.\n   *\n   * @private\n   * @param {Array} [array] The array to inspect.\n   * @param {*} target The value to search for.\n   * @param {Function} comparator The comparator invoked per element.\n   * @returns {boolean} Returns `true` if `target` is found, else `false`.\n   */\n  function arrayIncludesWith(array, value, comparator) {\n    var index = -1,\n        length = array == null ? 0 : array.length;\n\n    while (++index < length) {\n      if (comparator(value, array[index])) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /**\n   * A specialized version of `_.map` for arrays without support for iteratee\n   * shorthands.\n   *\n   * @private\n   * @param {Array} [array] The array to iterate over.\n   * @param {Function} iteratee The function invoked per iteration.\n   * @returns {Array} Returns the new mapped array.\n   */\n  function arrayMap(array, iteratee) {\n    var index = -1,\n        length = array == null ? 0 : array.length,\n        result = Array(length);\n\n    while (++index < length) {\n      result[index] = iteratee(array[index], index, array);\n    }\n    return result;\n  }\n\n  /**\n   * Appends the elements of `values` to `array`.\n   *\n   * @private\n   * @param {Array} array The array to modify.\n   * @param {Array} values The values to append.\n   * @returns {Array} Returns `array`.\n   */\n  function arrayPush(array, values) {\n    var index = -1,\n        length = values.length,\n        offset = array.length;\n\n    while (++index < length) {\n      array[offset + index] = values[index];\n    }\n    return array;\n  }\n\n  /**\n   * A specialized version of `_.reduce` for arrays without support for\n   * iteratee shorthands.\n   *\n   * @private\n   * @param {Array} [array] The array to iterate over.\n   * @param {Function} iteratee The function invoked per iteration.\n   * @param {*} [accumulator] The initial value.\n   * @param {boolean} [initAccum] Specify using the first element of `array` as\n   *  the initial value.\n   * @returns {*} Returns the accumulated value.\n   */\n  function arrayReduce(array, iteratee, accumulator, initAccum) {\n    var index = -1,\n        length = array == null ? 0 : array.length;\n\n    if (initAccum && length) {\n      accumulator = array[++index];\n    }\n    while (++index < length) {\n      accumulator = iteratee(accumulator, array[index], index, array);\n    }\n    return accumulator;\n  }\n\n  /**\n   * A specialized version of `_.reduceRight` for arrays without support for\n   * iteratee shorthands.\n   *\n   * @private\n   * @param {Array} [array] The array to iterate over.\n   * @param {Function} iteratee The function invoked per iteration.\n   * @param {*} [accumulator] The initial value.\n   * @param {boolean} [initAccum] Specify using the last element of `array` as\n   *  the initial value.\n   * @returns {*} Returns the accumulated value.\n   */\n  function arrayReduceRight(array, iteratee, accumulator, initAccum) {\n    var length = array == null ? 0 : array.length;\n    if (initAccum && length) {\n      accumulator = array[--length];\n    }\n    while (length--) {\n      accumulator = iteratee(accumulator, array[length], length, array);\n    }\n    return accumulator;\n  }\n\n  /**\n   * A specialized version of `_.some` for arrays without support for iteratee\n   * shorthands.\n   *\n   * @private\n   * @param {Array} [array] The array to iterate over.\n   * @param {Function} predicate The function invoked per iteration.\n   * @returns {boolean} Returns `true` if any element passes the predicate check,\n   *  else `false`.\n   */\n  function arraySome(array, predicate) {\n    var index = -1,\n        length = array == null ? 0 : array.length;\n\n    while (++index < length) {\n      if (predicate(array[index], index, array)) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Gets the size of an ASCII `string`.\n   *\n   * @private\n   * @param {string} string The string inspect.\n   * @returns {number} Returns the string size.\n   */\n  var asciiSize = baseProperty('length');\n\n  /**\n   * Converts an ASCII `string` to an array.\n   *\n   * @private\n   * @param {string} string The string to convert.\n   * @returns {Array} Returns the converted array.\n   */\n  function asciiToArray(string) {\n    return string.split('');\n  }\n\n  /**\n   * Splits an ASCII `string` into an array of its words.\n   *\n   * @private\n   * @param {string} The string to inspect.\n   * @returns {Array} Returns the words of `string`.\n   */\n  function asciiWords(string) {\n    return string.match(reAsciiWord) || [];\n  }\n\n  /**\n   * The base implementation of methods like `_.findKey` and `_.findLastKey`,\n   * without support for iteratee shorthands, which iterates over `collection`\n   * using `eachFunc`.\n   *\n   * @private\n   * @param {Array|Object} collection The collection to inspect.\n   * @param {Function} predicate The function invoked per iteration.\n   * @param {Function} eachFunc The function to iterate over `collection`.\n   * @returns {*} Returns the found element or its key, else `undefined`.\n   */\n  function baseFindKey(collection, predicate, eachFunc) {\n    var result;\n    eachFunc(collection, function(value, key, collection) {\n      if (predicate(value, key, collection)) {\n        result = key;\n        return false;\n      }\n    });\n    return result;\n  }\n\n  /**\n   * The base implementation of `_.findIndex` and `_.findLastIndex` without\n   * support for iteratee shorthands.\n   *\n   * @private\n   * @param {Array} array The array to inspect.\n   * @param {Function} predicate The function invoked per iteration.\n   * @param {number} fromIndex The index to search from.\n   * @param {boolean} [fromRight] Specify iterating from right to left.\n   * @returns {number} Returns the index of the matched value, else `-1`.\n   */\n  function baseFindIndex(array, predicate, fromIndex, fromRight) {\n    var length = array.length,\n        index = fromIndex + (fromRight ? 1 : -1);\n\n    while ((fromRight ? index-- : ++index < length)) {\n      if (predicate(array[index], index, array)) {\n        return index;\n      }\n    }\n    return -1;\n  }\n\n  /**\n   * The base implementation of `_.indexOf` without `fromIndex` bounds checks.\n   *\n   * @private\n   * @param {Array} array The array to inspect.\n   * @param {*} value The value to search for.\n   * @param {number} fromIndex The index to search from.\n   * @returns {number} Returns the index of the matched value, else `-1`.\n   */\n  function baseIndexOf(array, value, fromIndex) {\n    return value === value\n      ? strictIndexOf(array, value, fromIndex)\n      : baseFindIndex(array, baseIsNaN, fromIndex);\n  }\n\n  /**\n   * This function is like `baseIndexOf` except that it accepts a comparator.\n   *\n   * @private\n   * @param {Array} array The array to inspect.\n   * @param {*} value The value to search for.\n   * @param {number} fromIndex The index to search from.\n   * @param {Function} comparator The comparator invoked per element.\n   * @returns {number} Returns the index of the matched value, else `-1`.\n   */\n  function baseIndexOfWith(array, value, fromIndex, comparator) {\n    var index = fromIndex - 1,\n        length = array.length;\n\n    while (++index < length) {\n      if (comparator(array[index], value)) {\n        return index;\n      }\n    }\n    return -1;\n  }\n\n  /**\n   * The base implementation of `_.isNaN` without support for number objects.\n   *\n   * @private\n   * @param {*} value The value to check.\n   * @returns {boolean} Returns `true` if `value` is `NaN`, else `false`.\n   */\n  function baseIsNaN(value) {\n    return value !== value;\n  }\n\n  /**\n   * The base implementation of `_.mean` and `_.meanBy` without support for\n   * iteratee shorthands.\n   *\n   * @private\n   * @param {Array} array The array to iterate over.\n   * @param {Function} iteratee The function invoked per iteration.\n   * @returns {number} Returns the mean.\n   */\n  function baseMean(array, iteratee) {\n    var length = array == null ? 0 : array.length;\n    return length ? (baseSum(array, iteratee) / length) : NAN;\n  }\n\n  /**\n   * The base implementation of `_.property` without support for deep paths.\n   *\n   * @private\n   * @param {string} key The key of the property to get.\n   * @returns {Function} Returns the new accessor function.\n   */\n  function baseProperty(key) {\n    return function(object) {\n      return object == null ? undefined : object[key];\n    };\n  }\n\n  /**\n   * The base implementation of `_.propertyOf` without support for deep paths.\n   *\n   * @private\n   * @param {Object} object The object to query.\n   * @returns {Function} Returns the new accessor function.\n   */\n  function basePropertyOf(object) {\n    return function(key) {\n      return object == null ? undefined : object[key];\n    };\n  }\n\n  /**\n   * The base implementation of `_.reduce` and `_.reduceRight`, without support\n   * for iteratee shorthands, which iterates over `collection` using `eachFunc`.\n   *\n   * @private\n   * @param {Array|Object} collection The collection to iterate over.\n   * @param {Function} iteratee The function invoked per iteration.\n   * @param {*} accumulator The initial value.\n   * @param {boolean} initAccum Specify using the first or last element of\n   *  `collection` as the initial value.\n   * @param {Function} eachFunc The function to iterate over `collection`.\n   * @returns {*} Returns the accumulated value.\n   */\n  function baseReduce(collection, iteratee, accumulator, initAccum, eachFunc) {\n    eachFunc(collection, function(value, index, collection) {\n      accumulator = initAccum\n        ? (initAccum = false, value)\n        : iteratee(accumulator, value, index, collection);\n    });\n    return accumulator;\n  }\n\n  /**\n   * The base implementation of `_.sortBy` which uses `comparer` to define the\n   * sort order of `array` and replaces criteria objects with their corresponding\n   * values.\n   *\n   * @private\n   * @param {Array} array The array to sort.\n   * @param {Function} comparer The function to define sort order.\n   * @returns {Array} Returns `array`.\n   */\n  function baseSortBy(array, comparer) {\n    var length = array.length;\n\n    array.sort(comparer);\n    while (length--) {\n      array[length] = array[length].value;\n    }\n    return array;\n  }\n\n  /**\n   * The base implementation of `_.sum` and `_.sumBy` without support for\n   * iteratee shorthands.\n   *\n   * @private\n   * @param {Array} array The array to iterate over.\n   * @param {Function} iteratee The function invoked per iteration.\n   * @returns {number} Returns the sum.\n   */\n  function baseSum(array, iteratee) {\n    var result,\n        index = -1,\n        length = array.length;\n\n    while (++index < length) {\n      var current = iteratee(array[index]);\n      if (current !== undefined) {\n        result = result === undefined ? current : (result + current);\n      }\n    }\n    return result;\n  }\n\n  /**\n   * The base implementation of `_.times` without support for iteratee shorthands\n   * or max array length checks.\n   *\n   * @private\n   * @param {number} n The number of times to invoke `iteratee`.\n   * @param {Function} iteratee The function invoked per iteration.\n   * @returns {Array} Returns the array of results.\n   */\n  function baseTimes(n, iteratee) {\n    var index = -1,\n        result = Array(n);\n\n    while (++index < n) {\n      result[index] = iteratee(index);\n    }\n    return result;\n  }\n\n  /**\n   * The base implementation of `_.toPairs` and `_.toPairsIn` which creates an array\n   * of key-value pairs for `object` corresponding to the property names of `props`.\n   *\n   * @private\n   * @param {Object} object The object to query.\n   * @param {Array} props The property names to get values for.\n   * @returns {Object} Returns the key-value pairs.\n   */\n  function baseToPairs(object, props) {\n    return arrayMap(props, function(key) {\n      return [key, object[key]];\n    });\n  }\n\n  /**\n   * The base implementation of `_.unary` without support for storing metadata.\n   *\n   * @private\n   * @param {Function} func The function to cap arguments for.\n   * @returns {Function} Returns the new capped function.\n   */\n  function baseUnary(func) {\n    return function(value) {\n      return func(value);\n    };\n  }\n\n  /**\n   * The base implementation of `_.values` and `_.valuesIn` which creates an\n   * array of `object` property values corresponding to the property names\n   * of `props`.\n   *\n   * @private\n   * @param {Object} object The object to query.\n   * @param {Array} props The property names to get values for.\n   * @returns {Object} Returns the array of property values.\n   */\n  function baseValues(object, props) {\n    return arrayMap(props, function(key) {\n      return object[key];\n    });\n  }\n\n  /**\n   * Checks if a `cache` value for `key` exists.\n   *\n   * @private\n   * @param {Object} cache The cache to query.\n   * @param {string} key The key of the entry to check.\n   * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n   */\n  function cacheHas(cache, key) {\n    return cache.has(key);\n  }\n\n  /**\n   * Used by `_.trim` and `_.trimStart` to get the index of the first string symbol\n   * that is not found in the character symbols.\n   *\n   * @private\n   * @param {Array} strSymbols The string symbols to inspect.\n   * @param {Array} chrSymbols The character symbols to find.\n   * @returns {number} Returns the index of the first unmatched string symbol.\n   */\n  function charsStartIndex(strSymbols, chrSymbols) {\n    var index = -1,\n        length = strSymbols.length;\n\n    while (++index < length && baseIndexOf(chrSymbols, strSymbols[index], 0) > -1) {}\n    return index;\n  }\n\n  /**\n   * Used by `_.trim` and `_.trimEnd` to get the index of the last string symbol\n   * that is not found in the character symbols.\n   *\n   * @private\n   * @param {Array} strSymbols The string symbols to inspect.\n   * @param {Array} chrSymbols The character symbols to find.\n   * @returns {number} Returns the index of the last unmatched string symbol.\n   */\n  function charsEndIndex(strSymbols, chrSymbols) {\n    var index = strSymbols.length;\n\n    while (index-- && baseIndexOf(chrSymbols, strSymbols[index], 0) > -1) {}\n    return index;\n  }\n\n  /**\n   * Gets the number of `placeholder` occurrences in `array`.\n   *\n   * @private\n   * @param {Array} array The array to inspect.\n   * @param {*} placeholder The placeholder to search for.\n   * @returns {number} Returns the placeholder count.\n   */\n  function countHolders(array, placeholder) {\n    var length = array.length,\n        result = 0;\n\n    while (length--) {\n      if (array[length] === placeholder) {\n        ++result;\n      }\n    }\n    return result;\n  }\n\n  /**\n   * Used by `_.deburr` to convert Latin-1 Supplement and Latin Extended-A\n   * letters to basic Latin letters.\n   *\n   * @private\n   * @param {string} letter The matched letter to deburr.\n   * @returns {string} Returns the deburred letter.\n   */\n  var deburrLetter = basePropertyOf(deburredLetters);\n\n  /**\n   * Used by `_.escape` to convert characters to HTML entities.\n   *\n   * @private\n   * @param {string} chr The matched character to escape.\n   * @returns {string} Returns the escaped character.\n   */\n  var escapeHtmlChar = basePropertyOf(htmlEscapes);\n\n  /**\n   * Used by `_.template` to escape characters for inclusion in compiled string literals.\n   *\n   * @private\n   * @param {string} chr The matched character to escape.\n   * @returns {string} Returns the escaped character.\n   */\n  function escapeStringChar(chr) {\n    return '\\\\' + stringEscapes[chr];\n  }\n\n  /**\n   * Gets the value at `key` of `object`.\n   *\n   * @private\n   * @param {Object} [object] The object to query.\n   * @param {string} key The key of the property to get.\n   * @returns {*} Returns the property value.\n   */\n  function getValue(object, key) {\n    return object == null ? undefined : object[key];\n  }\n\n  /**\n   * Checks if `string` contains Unicode symbols.\n   *\n   * @private\n   * @param {string} string The string to inspect.\n   * @returns {boolean} Returns `true` if a symbol is found, else `false`.\n   */\n  function hasUnicode(string) {\n    return reHasUnicode.test(string);\n  }\n\n  /**\n   * Checks if `string` contains a word composed of Unicode symbols.\n   *\n   * @private\n   * @param {string} string The string to inspect.\n   * @returns {boolean} Returns `true` if a word is found, else `false`.\n   */\n  function hasUnicodeWord(string) {\n    return reHasUnicodeWord.test(string);\n  }\n\n  /**\n   * Converts `iterator` to an array.\n   *\n   * @private\n   * @param {Object} iterator The iterator to convert.\n   * @returns {Array} Returns the converted array.\n   */\n  function iteratorToArray(iterator) {\n    var data,\n        result = [];\n\n    while (!(data = iterator.next()).done) {\n      result.push(data.value);\n    }\n    return result;\n  }\n\n  /**\n   * Converts `map` to its key-value pairs.\n   *\n   * @private\n   * @param {Object} map The map to convert.\n   * @returns {Array} Returns the key-value pairs.\n   */\n  function mapToArray(map) {\n    var index = -1,\n        result = Array(map.size);\n\n    map.forEach(function(value, key) {\n      result[++index] = [key, value];\n    });\n    return result;\n  }\n\n  /**\n   * Creates a unary function that invokes `func` with its argument transformed.\n   *\n   * @private\n   * @param {Function} func The function to wrap.\n   * @param {Function} transform The argument transform.\n   * @returns {Function} Returns the new function.\n   */\n  function overArg(func, transform) {\n    return function(arg) {\n      return func(transform(arg));\n    };\n  }\n\n  /**\n   * Replaces all `placeholder` elements in `array` with an internal placeholder\n   * and returns an array of their indexes.\n   *\n   * @private\n   * @param {Array} array The array to modify.\n   * @param {*} placeholder The placeholder to replace.\n   * @returns {Array} Returns the new array of placeholder indexes.\n   */\n  function replaceHolders(array, placeholder) {\n    var index = -1,\n        length = array.length,\n        resIndex = 0,\n        result = [];\n\n    while (++index < length) {\n      var value = array[index];\n      if (value === placeholder || value === PLACEHOLDER) {\n        array[index] = PLACEHOLDER;\n        result[resIndex++] = index;\n      }\n    }\n    return result;\n  }\n\n  /**\n   * Gets the value at `key`, unless `key` is \"__proto__\".\n   *\n   * @private\n   * @param {Object} object The object to query.\n   * @param {string} key The key of the property to get.\n   * @returns {*} Returns the property value.\n   */\n  function safeGet(object, key) {\n    return key == '__proto__'\n      ? undefined\n      : object[key];\n  }\n\n  /**\n   * Converts `set` to an array of its values.\n   *\n   * @private\n   * @param {Object} set The set to convert.\n   * @returns {Array} Returns the values.\n   */\n  function setToArray(set) {\n    var index = -1,\n        result = Array(set.size);\n\n    set.forEach(function(value) {\n      result[++index] = value;\n    });\n    return result;\n  }\n\n  /**\n   * Converts `set` to its value-value pairs.\n   *\n   * @private\n   * @param {Object} set The set to convert.\n   * @returns {Array} Returns the value-value pairs.\n   */\n  function setToPairs(set) {\n    var index = -1,\n        result = Array(set.size);\n\n    set.forEach(function(value) {\n      result[++index] = [value, value];\n    });\n    return result;\n  }\n\n  /**\n   * A specialized version of `_.indexOf` which performs strict equality\n   * comparisons of values, i.e. `===`.\n   *\n   * @private\n   * @param {Array} array The array to inspect.\n   * @param {*} value The value to search for.\n   * @param {number} fromIndex The index to search from.\n   * @returns {number} Returns the index of the matched value, else `-1`.\n   */\n  function strictIndexOf(array, value, fromIndex) {\n    var index = fromIndex - 1,\n        length = array.length;\n\n    while (++index < length) {\n      if (array[index] === value) {\n        return index;\n      }\n    }\n    return -1;\n  }\n\n  /**\n   * A specialized version of `_.lastIndexOf` which performs strict equality\n   * comparisons of values, i.e. `===`.\n   *\n   * @private\n   * @param {Array} array The array to inspect.\n   * @param {*} value The value to search for.\n   * @param {number} fromIndex The index to search from.\n   * @returns {number} Returns the index of the matched value, else `-1`.\n   */\n  function strictLastIndexOf(array, value, fromIndex) {\n    var index = fromIndex + 1;\n    while (index--) {\n      if (array[index] === value) {\n        return index;\n      }\n    }\n    return index;\n  }\n\n  /**\n   * Gets the number of symbols in `string`.\n   *\n   * @private\n   * @param {string} string The string to inspect.\n   * @returns {number} Returns the string size.\n   */\n  function stringSize(string) {\n    return hasUnicode(string)\n      ? unicodeSize(string)\n      : asciiSize(string);\n  }\n\n  /**\n   * Converts `string` to an array.\n   *\n   * @private\n   * @param {string} string The string to convert.\n   * @returns {Array} Returns the converted array.\n   */\n  function stringToArray(string) {\n    return hasUnicode(string)\n      ? unicodeToArray(string)\n      : asciiToArray(string);\n  }\n\n  /**\n   * Used by `_.unescape` to convert HTML entities to characters.\n   *\n   * @private\n   * @param {string} chr The matched character to unescape.\n   * @returns {string} Returns the unescaped character.\n   */\n  var unescapeHtmlChar = basePropertyOf(htmlUnescapes);\n\n  /**\n   * Gets the size of a Unicode `string`.\n   *\n   * @private\n   * @param {string} string The string inspect.\n   * @returns {number} Returns the string size.\n   */\n  function unicodeSize(string) {\n    var result = reUnicode.lastIndex = 0;\n    while (reUnicode.test(string)) {\n      ++result;\n    }\n    return result;\n  }\n\n  /**\n   * Converts a Unicode `string` to an array.\n   *\n   * @private\n   * @param {string} string The string to convert.\n   * @returns {Array} Returns the converted array.\n   */\n  function unicodeToArray(string) {\n    return string.match(reUnicode) || [];\n  }\n\n  /**\n   * Splits a Unicode `string` into an array of its words.\n   *\n   * @private\n   * @param {string} The string to inspect.\n   * @returns {Array} Returns the words of `string`.\n   */\n  function unicodeWords(string) {\n    return string.match(reUnicodeWord) || [];\n  }\n\n  /*--------------------------------------------------------------------------*/\n\n  /**\n   * Create a new pristine `lodash` function using the `context` object.\n   *\n   * @static\n   * @memberOf _\n   * @since 1.1.0\n   * @category Util\n   * @param {Object} [context=root] The context object.\n   * @returns {Function} Returns a new `lodash` function.\n   * @example\n   *\n   * _.mixin({ 'foo': _.constant('foo') });\n   *\n   * var lodash = _.runInContext();\n   * lodash.mixin({ 'bar': lodash.constant('bar') });\n   *\n   * _.isFunction(_.foo);\n   * // => true\n   * _.isFunction(_.bar);\n   * // => false\n   *\n   * lodash.isFunction(lodash.foo);\n   * // => false\n   * lodash.isFunction(lodash.bar);\n   * // => true\n   *\n   * // Create a suped-up `defer` in Node.js.\n   * var defer = _.runInContext({ 'setTimeout': setImmediate }).defer;\n   */\n  var runInContext = (function runInContext(context) {\n    context = context == null ? root : _.defaults(root.Object(), context, _.pick(root, contextProps));\n\n    /** Built-in constructor references. */\n    var Array = context.Array,\n        Date = context.Date,\n        Error = context.Error,\n        Function = context.Function,\n        Math = context.Math,\n        Object = context.Object,\n        RegExp = context.RegExp,\n        String = context.String,\n        TypeError = context.TypeError;\n\n    /** Used for built-in method references. */\n    var arrayProto = Array.prototype,\n        funcProto = Function.prototype,\n        objectProto = Object.prototype;\n\n    /** Used to detect overreaching core-js shims. */\n    var coreJsData = context['__core-js_shared__'];\n\n    /** Used to resolve the decompiled source of functions. */\n    var funcToString = funcProto.toString;\n\n    /** Used to check objects for own properties. */\n    var hasOwnProperty = objectProto.hasOwnProperty;\n\n    /** Used to generate unique IDs. */\n    var idCounter = 0;\n\n    /** Used to detect methods masquerading as native. */\n    var maskSrcKey = (function() {\n      var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n      return uid ? ('Symbol(src)_1.' + uid) : '';\n    }());\n\n    /**\n     * Used to resolve the\n     * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n     * of values.\n     */\n    var nativeObjectToString = objectProto.toString;\n\n    /** Used to infer the `Object` constructor. */\n    var objectCtorString = funcToString.call(Object);\n\n    /** Used to restore the original `_` reference in `_.noConflict`. */\n    var oldDash = root._;\n\n    /** Used to detect if a method is native. */\n    var reIsNative = RegExp('^' +\n      funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\\\$&')\n      .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n    );\n\n    /** Built-in value references. */\n    var Buffer = moduleExports ? context.Buffer : undefined,\n        Symbol = context.Symbol,\n        Uint8Array = context.Uint8Array,\n        allocUnsafe = Buffer ? Buffer.allocUnsafe : undefined,\n        getPrototype = overArg(Object.getPrototypeOf, Object),\n        objectCreate = Object.create,\n        propertyIsEnumerable = objectProto.propertyIsEnumerable,\n        splice = arrayProto.splice,\n        spreadableSymbol = Symbol ? Symbol.isConcatSpreadable : undefined,\n        symIterator = Symbol ? Symbol.iterator : undefined,\n        symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n    var defineProperty = (function() {\n      try {\n        var func = getNative(Object, 'defineProperty');\n        func({}, '', {});\n        return func;\n      } catch (e) {}\n    }());\n\n    /** Mocked built-ins. */\n    var ctxClearTimeout = context.clearTimeout !== root.clearTimeout && context.clearTimeout,\n        ctxNow = Date && Date.now !== root.Date.now && Date.now,\n        ctxSetTimeout = context.setTimeout !== root.setTimeout && context.setTimeout;\n\n    /* Built-in method references for those with the same name as other `lodash` methods. */\n    var nativeCeil = Math.ceil,\n        nativeFloor = Math.floor,\n        nativeGetSymbols = Object.getOwnPropertySymbols,\n        nativeIsBuffer = Buffer ? Buffer.isBuffer : undefined,\n        nativeIsFinite = context.isFinite,\n        nativeJoin = arrayProto.join,\n        nativeKeys = overArg(Object.keys, Object),\n        nativeMax = Math.max,\n        nativeMin = Math.min,\n        nativeNow = Date.now,\n        nativeParseInt = context.parseInt,\n        nativeRandom = Math.random,\n        nativeReverse = arrayProto.reverse;\n\n    /* Built-in method references that are verified to be native. */\n    var DataView = getNative(context, 'DataView'),\n        Map = getNative(context, 'Map'),\n        Promise = getNative(context, 'Promise'),\n        Set = getNative(context, 'Set'),\n        WeakMap = getNative(context, 'WeakMap'),\n        nativeCreate = getNative(Object, 'create');\n\n    /** Used to store function metadata. */\n    var metaMap = WeakMap && new WeakMap;\n\n    /** Used to lookup unminified function names. */\n    var realNames = {};\n\n    /** Used to detect maps, sets, and weakmaps. */\n    var dataViewCtorString = toSource(DataView),\n        mapCtorString = toSource(Map),\n        promiseCtorString = toSource(Promise),\n        setCtorString = toSource(Set),\n        weakMapCtorString = toSource(WeakMap);\n\n    /** Used to convert symbols to primitives and strings. */\n    var symbolProto = Symbol ? Symbol.prototype : undefined,\n        symbolValueOf = symbolProto ? symbolProto.valueOf : undefined,\n        symbolToString = symbolProto ? symbolProto.toString : undefined;\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Creates a `lodash` object which wraps `value` to enable implicit method\n     * chain sequences. Methods that operate on and return arrays, collections,\n     * and functions can be chained together. Methods that retrieve a single value\n     * or may return a primitive value will automatically end the chain sequence\n     * and return the unwrapped value. Otherwise, the value must be unwrapped\n     * with `_#value`.\n     *\n     * Explicit chain sequences, which must be unwrapped with `_#value`, may be\n     * enabled using `_.chain`.\n     *\n     * The execution of chained methods is lazy, that is, it's deferred until\n     * `_#value` is implicitly or explicitly called.\n     *\n     * Lazy evaluation allows several methods to support shortcut fusion.\n     * Shortcut fusion is an optimization to merge iteratee calls; this avoids\n     * the creation of intermediate arrays and can greatly reduce the number of\n     * iteratee executions. Sections of a chain sequence qualify for shortcut\n     * fusion if the section is applied to an array and iteratees accept only\n     * one argument. The heuristic for whether a section qualifies for shortcut\n     * fusion is subject to change.\n     *\n     * Chaining is supported in custom builds as long as the `_#value` method is\n     * directly or indirectly included in the build.\n     *\n     * In addition to lodash methods, wrappers have `Array` and `String` methods.\n     *\n     * The wrapper `Array` methods are:\n     * `concat`, `join`, `pop`, `push`, `shift`, `sort`, `splice`, and `unshift`\n     *\n     * The wrapper `String` methods are:\n     * `replace` and `split`\n     *\n     * The wrapper methods that support shortcut fusion are:\n     * `at`, `compact`, `drop`, `dropRight`, `dropWhile`, `filter`, `find`,\n     * `findLast`, `head`, `initial`, `last`, `map`, `reject`, `reverse`, `slice`,\n     * `tail`, `take`, `takeRight`, `takeRightWhile`, `takeWhile`, and `toArray`\n     *\n     * The chainable wrapper methods are:\n     * `after`, `ary`, `assign`, `assignIn`, `assignInWith`, `assignWith`, `at`,\n     * `before`, `bind`, `bindAll`, `bindKey`, `castArray`, `chain`, `chunk`,\n     * `commit`, `compact`, `concat`, `conforms`, `constant`, `countBy`, `create`,\n     * `curry`, `debounce`, `defaults`, `defaultsDeep`, `defer`, `delay`,\n     * `difference`, `differenceBy`, `differenceWith`, `drop`, `dropRight`,\n     * `dropRightWhile`, `dropWhile`, `extend`, `extendWith`, `fill`, `filter`,\n     * `flatMap`, `flatMapDeep`, `flatMapDepth`, `flatten`, `flattenDeep`,\n     * `flattenDepth`, `flip`, `flow`, `flowRight`, `fromPairs`, `functions`,\n     * `functionsIn`, `groupBy`, `initial`, `intersection`, `intersectionBy`,\n     * `intersectionWith`, `invert`, `invertBy`, `invokeMap`, `iteratee`, `keyBy`,\n     * `keys`, `keysIn`, `map`, `mapKeys`, `mapValues`, `matches`, `matchesProperty`,\n     * `memoize`, `merge`, `mergeWith`, `method`, `methodOf`, `mixin`, `negate`,\n     * `nthArg`, `omit`, `omitBy`, `once`, `orderBy`, `over`, `overArgs`,\n     * `overEvery`, `overSome`, `partial`, `partialRight`, `partition`, `pick`,\n     * `pickBy`, `plant`, `property`, `propertyOf`, `pull`, `pullAll`, `pullAllBy`,\n     * `pullAllWith`, `pullAt`, `push`, `range`, `rangeRight`, `rearg`, `reject`,\n     * `remove`, `rest`, `reverse`, `sampleSize`, `set`, `setWith`, `shuffle`,\n     * `slice`, `sort`, `sortBy`, `splice`, `spread`, `tail`, `take`, `takeRight`,\n     * `takeRightWhile`, `takeWhile`, `tap`, `throttle`, `thru`, `toArray`,\n     * `toPairs`, `toPairsIn`, `toPath`, `toPlainObject`, `transform`, `unary`,\n     * `union`, `unionBy`, `unionWith`, `uniq`, `uniqBy`, `uniqWith`, `unset`,\n     * `unshift`, `unzip`, `unzipWith`, `update`, `updateWith`, `values`,\n     * `valuesIn`, `without`, `wrap`, `xor`, `xorBy`, `xorWith`, `zip`,\n     * `zipObject`, `zipObjectDeep`, and `zipWith`\n     *\n     * The wrapper methods that are **not** chainable by default are:\n     * `add`, `attempt`, `camelCase`, `capitalize`, `ceil`, `clamp`, `clone`,\n     * `cloneDeep`, `cloneDeepWith`, `cloneWith`, `conformsTo`, `deburr`,\n     * `defaultTo`, `divide`, `each`, `eachRight`, `endsWith`, `eq`, `escape`,\n     * `escapeRegExp`, `every`, `find`, `findIndex`, `findKey`, `findLast`,\n     * `findLastIndex`, `findLastKey`, `first`, `floor`, `forEach`, `forEachRight`,\n     * `forIn`, `forInRight`, `forOwn`, `forOwnRight`, `get`, `gt`, `gte`, `has`,\n     * `hasIn`, `head`, `identity`, `includes`, `indexOf`, `inRange`, `invoke`,\n     * `isArguments`, `isArray`, `isArrayBuffer`, `isArrayLike`, `isArrayLikeObject`,\n     * `isBoolean`, `isBuffer`, `isDate`, `isElement`, `isEmpty`, `isEqual`,\n     * `isEqualWith`, `isError`, `isFinite`, `isFunction`, `isInteger`, `isLength`,\n     * `isMap`, `isMatch`, `isMatchWith`, `isNaN`, `isNative`, `isNil`, `isNull`,\n     * `isNumber`, `isObject`, `isObjectLike`, `isPlainObject`, `isRegExp`,\n     * `isSafeInteger`, `isSet`, `isString`, `isUndefined`, `isTypedArray`,\n     * `isWeakMap`, `isWeakSet`, `join`, `kebabCase`, `last`, `lastIndexOf`,\n     * `lowerCase`, `lowerFirst`, `lt`, `lte`, `max`, `maxBy`, `mean`, `meanBy`,\n     * `min`, `minBy`, `multiply`, `noConflict`, `noop`, `now`, `nth`, `pad`,\n     * `padEnd`, `padStart`, `parseInt`, `pop`, `random`, `reduce`, `reduceRight`,\n     * `repeat`, `result`, `round`, `runInContext`, `sample`, `shift`, `size`,\n     * `snakeCase`, `some`, `sortedIndex`, `sortedIndexBy`, `sortedLastIndex`,\n     * `sortedLastIndexBy`, `startCase`, `startsWith`, `stubArray`, `stubFalse`,\n     * `stubObject`, `stubString`, `stubTrue`, `subtract`, `sum`, `sumBy`,\n     * `template`, `times`, `toFinite`, `toInteger`, `toJSON`, `toLength`,\n     * `toLower`, `toNumber`, `toSafeInteger`, `toString`, `toUpper`, `trim`,\n     * `trimEnd`, `trimStart`, `truncate`, `unescape`, `uniqueId`, `upperCase`,\n     * `upperFirst`, `value`, and `words`\n     *\n     * @name _\n     * @constructor\n     * @category Seq\n     * @param {*} value The value to wrap in a `lodash` instance.\n     * @returns {Object} Returns the new `lodash` wrapper instance.\n     * @example\n     *\n     * function square(n) {\n     *   return n * n;\n     * }\n     *\n     * var wrapped = _([1, 2, 3]);\n     *\n     * // Returns an unwrapped value.\n     * wrapped.reduce(_.add);\n     * // => 6\n     *\n     * // Returns a wrapped value.\n     * var squares = wrapped.map(square);\n     *\n     * _.isArray(squares);\n     * // => false\n     *\n     * _.isArray(squares.value());\n     * // => true\n     */\n    function lodash(value) {\n      if (isObjectLike(value) && !isArray(value) && !(value instanceof LazyWrapper)) {\n        if (value instanceof LodashWrapper) {\n          return value;\n        }\n        if (hasOwnProperty.call(value, '__wrapped__')) {\n          return wrapperClone(value);\n        }\n      }\n      return new LodashWrapper(value);\n    }\n\n    /**\n     * The base implementation of `_.create` without support for assigning\n     * properties to the created object.\n     *\n     * @private\n     * @param {Object} proto The object to inherit from.\n     * @returns {Object} Returns the new object.\n     */\n    var baseCreate = (function() {\n      function object() {}\n      return function(proto) {\n        if (!isObject(proto)) {\n          return {};\n        }\n        if (objectCreate) {\n          return objectCreate(proto);\n        }\n        object.prototype = proto;\n        var result = new object;\n        object.prototype = undefined;\n        return result;\n      };\n    }());\n\n    /**\n     * The function whose prototype chain sequence wrappers inherit from.\n     *\n     * @private\n     */\n    function baseLodash() {\n      // No operation performed.\n    }\n\n    /**\n     * The base constructor for creating `lodash` wrapper objects.\n     *\n     * @private\n     * @param {*} value The value to wrap.\n     * @param {boolean} [chainAll] Enable explicit method chain sequences.\n     */\n    function LodashWrapper(value, chainAll) {\n      this.__wrapped__ = value;\n      this.__actions__ = [];\n      this.__chain__ = !!chainAll;\n      this.__index__ = 0;\n      this.__values__ = undefined;\n    }\n\n    /**\n     * By default, the template delimiters used by lodash are like those in\n     * embedded Ruby (ERB) as well as ES2015 template strings. Change the\n     * following template settings to use alternative delimiters.\n     *\n     * @static\n     * @memberOf _\n     * @type {Object}\n     */\n    lodash.templateSettings = {\n\n      /**\n       * Used to detect `data` property values to be HTML-escaped.\n       *\n       * @memberOf _.templateSettings\n       * @type {RegExp}\n       */\n      'escape': reEscape,\n\n      /**\n       * Used to detect code to be evaluated.\n       *\n       * @memberOf _.templateSettings\n       * @type {RegExp}\n       */\n      'evaluate': reEvaluate,\n\n      /**\n       * Used to detect `data` property values to inject.\n       *\n       * @memberOf _.templateSettings\n       * @type {RegExp}\n       */\n      'interpolate': reInterpolate,\n\n      /**\n       * Used to reference the data object in the template text.\n       *\n       * @memberOf _.templateSettings\n       * @type {string}\n       */\n      'variable': '',\n\n      /**\n       * Used to import variables into the compiled template.\n       *\n       * @memberOf _.templateSettings\n       * @type {Object}\n       */\n      'imports': {\n\n        /**\n         * A reference to the `lodash` function.\n         *\n         * @memberOf _.templateSettings.imports\n         * @type {Function}\n         */\n        '_': lodash\n      }\n    };\n\n    // Ensure wrappers are instances of `baseLodash`.\n    lodash.prototype = baseLodash.prototype;\n    lodash.prototype.constructor = lodash;\n\n    LodashWrapper.prototype = baseCreate(baseLodash.prototype);\n    LodashWrapper.prototype.constructor = LodashWrapper;\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Creates a lazy wrapper object which wraps `value` to enable lazy evaluation.\n     *\n     * @private\n     * @constructor\n     * @param {*} value The value to wrap.\n     */\n    function LazyWrapper(value) {\n      this.__wrapped__ = value;\n      this.__actions__ = [];\n      this.__dir__ = 1;\n      this.__filtered__ = false;\n      this.__iteratees__ = [];\n      this.__takeCount__ = MAX_ARRAY_LENGTH;\n      this.__views__ = [];\n    }\n\n    /**\n     * Creates a clone of the lazy wrapper object.\n     *\n     * @private\n     * @name clone\n     * @memberOf LazyWrapper\n     * @returns {Object} Returns the cloned `LazyWrapper` object.\n     */\n    function lazyClone() {\n      var result = new LazyWrapper(this.__wrapped__);\n      result.__actions__ = copyArray(this.__actions__);\n      result.__dir__ = this.__dir__;\n      result.__filtered__ = this.__filtered__;\n      result.__iteratees__ = copyArray(this.__iteratees__);\n      result.__takeCount__ = this.__takeCount__;\n      result.__views__ = copyArray(this.__views__);\n      return result;\n    }\n\n    /**\n     * Reverses the direction of lazy iteration.\n     *\n     * @private\n     * @name reverse\n     * @memberOf LazyWrapper\n     * @returns {Object} Returns the new reversed `LazyWrapper` object.\n     */\n    function lazyReverse() {\n      if (this.__filtered__) {\n        var result = new LazyWrapper(this);\n        result.__dir__ = -1;\n        result.__filtered__ = true;\n      } else {\n        result = this.clone();\n        result.__dir__ *= -1;\n      }\n      return result;\n    }\n\n    /**\n     * Extracts the unwrapped value from its lazy wrapper.\n     *\n     * @private\n     * @name value\n     * @memberOf LazyWrapper\n     * @returns {*} Returns the unwrapped value.\n     */\n    function lazyValue() {\n      var array = this.__wrapped__.value(),\n          dir = this.__dir__,\n          isArr = isArray(array),\n          isRight = dir < 0,\n          arrLength = isArr ? array.length : 0,\n          view = getView(0, arrLength, this.__views__),\n          start = view.start,\n          end = view.end,\n          length = end - start,\n          index = isRight ? end : (start - 1),\n          iteratees = this.__iteratees__,\n          iterLength = iteratees.length,\n          resIndex = 0,\n          takeCount = nativeMin(length, this.__takeCount__);\n\n      if (!isArr || (!isRight && arrLength == length && takeCount == length)) {\n        return baseWrapperValue(array, this.__actions__);\n      }\n      var result = [];\n\n      outer:\n      while (length-- && resIndex < takeCount) {\n        index += dir;\n\n        var iterIndex = -1,\n            value = array[index];\n\n        while (++iterIndex < iterLength) {\n          var data = iteratees[iterIndex],\n              iteratee = data.iteratee,\n              type = data.type,\n              computed = iteratee(value);\n\n          if (type == LAZY_MAP_FLAG) {\n            value = computed;\n          } else if (!computed) {\n            if (type == LAZY_FILTER_FLAG) {\n              continue outer;\n            } else {\n              break outer;\n            }\n          }\n        }\n        result[resIndex++] = value;\n      }\n      return result;\n    }\n\n    // Ensure `LazyWrapper` is an instance of `baseLodash`.\n    LazyWrapper.prototype = baseCreate(baseLodash.prototype);\n    LazyWrapper.prototype.constructor = LazyWrapper;\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Creates a hash object.\n     *\n     * @private\n     * @constructor\n     * @param {Array} [entries] The key-value pairs to cache.\n     */\n    function Hash(entries) {\n      var index = -1,\n          length = entries == null ? 0 : entries.length;\n\n      this.clear();\n      while (++index < length) {\n        var entry = entries[index];\n        this.set(entry[0], entry[1]);\n      }\n    }\n\n    /**\n     * Removes all key-value entries from the hash.\n     *\n     * @private\n     * @name clear\n     * @memberOf Hash\n     */\n    function hashClear() {\n      this.__data__ = nativeCreate ? nativeCreate(null) : {};\n      this.size = 0;\n    }\n\n    /**\n     * Removes `key` and its value from the hash.\n     *\n     * @private\n     * @name delete\n     * @memberOf Hash\n     * @param {Object} hash The hash to modify.\n     * @param {string} key The key of the value to remove.\n     * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n     */\n    function hashDelete(key) {\n      var result = this.has(key) && delete this.__data__[key];\n      this.size -= result ? 1 : 0;\n      return result;\n    }\n\n    /**\n     * Gets the hash value for `key`.\n     *\n     * @private\n     * @name get\n     * @memberOf Hash\n     * @param {string} key The key of the value to get.\n     * @returns {*} Returns the entry value.\n     */\n    function hashGet(key) {\n      var data = this.__data__;\n      if (nativeCreate) {\n        var result = data[key];\n        return result === HASH_UNDEFINED ? undefined : result;\n      }\n      return hasOwnProperty.call(data, key) ? data[key] : undefined;\n    }\n\n    /**\n     * Checks if a hash value for `key` exists.\n     *\n     * @private\n     * @name has\n     * @memberOf Hash\n     * @param {string} key The key of the entry to check.\n     * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n     */\n    function hashHas(key) {\n      var data = this.__data__;\n      return nativeCreate ? (data[key] !== undefined) : hasOwnProperty.call(data, key);\n    }\n\n    /**\n     * Sets the hash `key` to `value`.\n     *\n     * @private\n     * @name set\n     * @memberOf Hash\n     * @param {string} key The key of the value to set.\n     * @param {*} value The value to set.\n     * @returns {Object} Returns the hash instance.\n     */\n    function hashSet(key, value) {\n      var data = this.__data__;\n      this.size += this.has(key) ? 0 : 1;\n      data[key] = (nativeCreate && value === undefined) ? HASH_UNDEFINED : value;\n      return this;\n    }\n\n    // Add methods to `Hash`.\n    Hash.prototype.clear = hashClear;\n    Hash.prototype['delete'] = hashDelete;\n    Hash.prototype.get = hashGet;\n    Hash.prototype.has = hashHas;\n    Hash.prototype.set = hashSet;\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Creates an list cache object.\n     *\n     * @private\n     * @constructor\n     * @param {Array} [entries] The key-value pairs to cache.\n     */\n    function ListCache(entries) {\n      var index = -1,\n          length = entries == null ? 0 : entries.length;\n\n      this.clear();\n      while (++index < length) {\n        var entry = entries[index];\n        this.set(entry[0], entry[1]);\n      }\n    }\n\n    /**\n     * Removes all key-value entries from the list cache.\n     *\n     * @private\n     * @name clear\n     * @memberOf ListCache\n     */\n    function listCacheClear() {\n      this.__data__ = [];\n      this.size = 0;\n    }\n\n    /**\n     * Removes `key` and its value from the list cache.\n     *\n     * @private\n     * @name delete\n     * @memberOf ListCache\n     * @param {string} key The key of the value to remove.\n     * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n     */\n    function listCacheDelete(key) {\n      var data = this.__data__,\n          index = assocIndexOf(data, key);\n\n      if (index < 0) {\n        return false;\n      }\n      var lastIndex = data.length - 1;\n      if (index == lastIndex) {\n        data.pop();\n      } else {\n        splice.call(data, index, 1);\n      }\n      --this.size;\n      return true;\n    }\n\n    /**\n     * Gets the list cache value for `key`.\n     *\n     * @private\n     * @name get\n     * @memberOf ListCache\n     * @param {string} key The key of the value to get.\n     * @returns {*} Returns the entry value.\n     */\n    function listCacheGet(key) {\n      var data = this.__data__,\n          index = assocIndexOf(data, key);\n\n      return index < 0 ? undefined : data[index][1];\n    }\n\n    /**\n     * Checks if a list cache value for `key` exists.\n     *\n     * @private\n     * @name has\n     * @memberOf ListCache\n     * @param {string} key The key of the entry to check.\n     * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n     */\n    function listCacheHas(key) {\n      return assocIndexOf(this.__data__, key) > -1;\n    }\n\n    /**\n     * Sets the list cache `key` to `value`.\n     *\n     * @private\n     * @name set\n     * @memberOf ListCache\n     * @param {string} key The key of the value to set.\n     * @param {*} value The value to set.\n     * @returns {Object} Returns the list cache instance.\n     */\n    function listCacheSet(key, value) {\n      var data = this.__data__,\n          index = assocIndexOf(data, key);\n\n      if (index < 0) {\n        ++this.size;\n        data.push([key, value]);\n      } else {\n        data[index][1] = value;\n      }\n      return this;\n    }\n\n    // Add methods to `ListCache`.\n    ListCache.prototype.clear = listCacheClear;\n    ListCache.prototype['delete'] = listCacheDelete;\n    ListCache.prototype.get = listCacheGet;\n    ListCache.prototype.has = listCacheHas;\n    ListCache.prototype.set = listCacheSet;\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Creates a map cache object to store key-value pairs.\n     *\n     * @private\n     * @constructor\n     * @param {Array} [entries] The key-value pairs to cache.\n     */\n    function MapCache(entries) {\n      var index = -1,\n          length = entries == null ? 0 : entries.length;\n\n      this.clear();\n      while (++index < length) {\n        var entry = entries[index];\n        this.set(entry[0], entry[1]);\n      }\n    }\n\n    /**\n     * Removes all key-value entries from the map.\n     *\n     * @private\n     * @name clear\n     * @memberOf MapCache\n     */\n    function mapCacheClear() {\n      this.size = 0;\n      this.__data__ = {\n        'hash': new Hash,\n        'map': new (Map || ListCache),\n        'string': new Hash\n      };\n    }\n\n    /**\n     * Removes `key` and its value from the map.\n     *\n     * @private\n     * @name delete\n     * @memberOf MapCache\n     * @param {string} key The key of the value to remove.\n     * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n     */\n    function mapCacheDelete(key) {\n      var result = getMapData(this, key)['delete'](key);\n      this.size -= result ? 1 : 0;\n      return result;\n    }\n\n    /**\n     * Gets the map value for `key`.\n     *\n     * @private\n     * @name get\n     * @memberOf MapCache\n     * @param {string} key The key of the value to get.\n     * @returns {*} Returns the entry value.\n     */\n    function mapCacheGet(key) {\n      return getMapData(this, key).get(key);\n    }\n\n    /**\n     * Checks if a map value for `key` exists.\n     *\n     * @private\n     * @name has\n     * @memberOf MapCache\n     * @param {string} key The key of the entry to check.\n     * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n     */\n    function mapCacheHas(key) {\n      return getMapData(this, key).has(key);\n    }\n\n    /**\n     * Sets the map `key` to `value`.\n     *\n     * @private\n     * @name set\n     * @memberOf MapCache\n     * @param {string} key The key of the value to set.\n     * @param {*} value The value to set.\n     * @returns {Object} Returns the map cache instance.\n     */\n    function mapCacheSet(key, value) {\n      var data = getMapData(this, key),\n          size = data.size;\n\n      data.set(key, value);\n      this.size += data.size == size ? 0 : 1;\n      return this;\n    }\n\n    // Add methods to `MapCache`.\n    MapCache.prototype.clear = mapCacheClear;\n    MapCache.prototype['delete'] = mapCacheDelete;\n    MapCache.prototype.get = mapCacheGet;\n    MapCache.prototype.has = mapCacheHas;\n    MapCache.prototype.set = mapCacheSet;\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     *\n     * Creates an array cache object to store unique values.\n     *\n     * @private\n     * @constructor\n     * @param {Array} [values] The values to cache.\n     */\n    function SetCache(values) {\n      var index = -1,\n          length = values == null ? 0 : values.length;\n\n      this.__data__ = new MapCache;\n      while (++index < length) {\n        this.add(values[index]);\n      }\n    }\n\n    /**\n     * Adds `value` to the array cache.\n     *\n     * @private\n     * @name add\n     * @memberOf SetCache\n     * @alias push\n     * @param {*} value The value to cache.\n     * @returns {Object} Returns the cache instance.\n     */\n    function setCacheAdd(value) {\n      this.__data__.set(value, HASH_UNDEFINED);\n      return this;\n    }\n\n    /**\n     * Checks if `value` is in the array cache.\n     *\n     * @private\n     * @name has\n     * @memberOf SetCache\n     * @param {*} value The value to search for.\n     * @returns {number} Returns `true` if `value` is found, else `false`.\n     */\n    function setCacheHas(value) {\n      return this.__data__.has(value);\n    }\n\n    // Add methods to `SetCache`.\n    SetCache.prototype.add = SetCache.prototype.push = setCacheAdd;\n    SetCache.prototype.has = setCacheHas;\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Creates a stack cache object to store key-value pairs.\n     *\n     * @private\n     * @constructor\n     * @param {Array} [entries] The key-value pairs to cache.\n     */\n    function Stack(entries) {\n      var data = this.__data__ = new ListCache(entries);\n      this.size = data.size;\n    }\n\n    /**\n     * Removes all key-value entries from the stack.\n     *\n     * @private\n     * @name clear\n     * @memberOf Stack\n     */\n    function stackClear() {\n      this.__data__ = new ListCache;\n      this.size = 0;\n    }\n\n    /**\n     * Removes `key` and its value from the stack.\n     *\n     * @private\n     * @name delete\n     * @memberOf Stack\n     * @param {string} key The key of the value to remove.\n     * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n     */\n    function stackDelete(key) {\n      var data = this.__data__,\n          result = data['delete'](key);\n\n      this.size = data.size;\n      return result;\n    }\n\n    /**\n     * Gets the stack value for `key`.\n     *\n     * @private\n     * @name get\n     * @memberOf Stack\n     * @param {string} key The key of the value to get.\n     * @returns {*} Returns the entry value.\n     */\n    function stackGet(key) {\n      return this.__data__.get(key);\n    }\n\n    /**\n     * Checks if a stack value for `key` exists.\n     *\n     * @private\n     * @name has\n     * @memberOf Stack\n     * @param {string} key The key of the entry to check.\n     * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n     */\n    function stackHas(key) {\n      return this.__data__.has(key);\n    }\n\n    /**\n     * Sets the stack `key` to `value`.\n     *\n     * @private\n     * @name set\n     * @memberOf Stack\n     * @param {string} key The key of the value to set.\n     * @param {*} value The value to set.\n     * @returns {Object} Returns the stack cache instance.\n     */\n    function stackSet(key, value) {\n      var data = this.__data__;\n      if (data instanceof ListCache) {\n        var pairs = data.__data__;\n        if (!Map || (pairs.length < LARGE_ARRAY_SIZE - 1)) {\n          pairs.push([key, value]);\n          this.size = ++data.size;\n          return this;\n        }\n        data = this.__data__ = new MapCache(pairs);\n      }\n      data.set(key, value);\n      this.size = data.size;\n      return this;\n    }\n\n    // Add methods to `Stack`.\n    Stack.prototype.clear = stackClear;\n    Stack.prototype['delete'] = stackDelete;\n    Stack.prototype.get = stackGet;\n    Stack.prototype.has = stackHas;\n    Stack.prototype.set = stackSet;\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Creates an array of the enumerable property names of the array-like `value`.\n     *\n     * @private\n     * @param {*} value The value to query.\n     * @param {boolean} inherited Specify returning inherited property names.\n     * @returns {Array} Returns the array of property names.\n     */\n    function arrayLikeKeys(value, inherited) {\n      var isArr = isArray(value),\n          isArg = !isArr && isArguments(value),\n          isBuff = !isArr && !isArg && isBuffer(value),\n          isType = !isArr && !isArg && !isBuff && isTypedArray(value),\n          skipIndexes = isArr || isArg || isBuff || isType,\n          result = skipIndexes ? baseTimes(value.length, String) : [],\n          length = result.length;\n\n      for (var key in value) {\n        if ((inherited || hasOwnProperty.call(value, key)) &&\n            !(skipIndexes && (\n               // Safari 9 has enumerable `arguments.length` in strict mode.\n               key == 'length' ||\n               // Node.js 0.10 has enumerable non-index properties on buffers.\n               (isBuff && (key == 'offset' || key == 'parent')) ||\n               // PhantomJS 2 has enumerable non-index properties on typed arrays.\n               (isType && (key == 'buffer' || key == 'byteLength' || key == 'byteOffset')) ||\n               // Skip index properties.\n               isIndex(key, length)\n            ))) {\n          result.push(key);\n        }\n      }\n      return result;\n    }\n\n    /**\n     * A specialized version of `_.sample` for arrays.\n     *\n     * @private\n     * @param {Array} array The array to sample.\n     * @returns {*} Returns the random element.\n     */\n    function arraySample(array) {\n      var length = array.length;\n      return length ? array[baseRandom(0, length - 1)] : undefined;\n    }\n\n    /**\n     * A specialized version of `_.sampleSize` for arrays.\n     *\n     * @private\n     * @param {Array} array The array to sample.\n     * @param {number} n The number of elements to sample.\n     * @returns {Array} Returns the random elements.\n     */\n    function arraySampleSize(array, n) {\n      return shuffleSelf(copyArray(array), baseClamp(n, 0, array.length));\n    }\n\n    /**\n     * A specialized version of `_.shuffle` for arrays.\n     *\n     * @private\n     * @param {Array} array The array to shuffle.\n     * @returns {Array} Returns the new shuffled array.\n     */\n    function arrayShuffle(array) {\n      return shuffleSelf(copyArray(array));\n    }\n\n    /**\n     * This function is like `assignValue` except that it doesn't assign\n     * `undefined` values.\n     *\n     * @private\n     * @param {Object} object The object to modify.\n     * @param {string} key The key of the property to assign.\n     * @param {*} value The value to assign.\n     */\n    function assignMergeValue(object, key, value) {\n      if ((value !== undefined && !eq(object[key], value)) ||\n          (value === undefined && !(key in object))) {\n        baseAssignValue(object, key, value);\n      }\n    }\n\n    /**\n     * Assigns `value` to `key` of `object` if the existing value is not equivalent\n     * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n     * for equality comparisons.\n     *\n     * @private\n     * @param {Object} object The object to modify.\n     * @param {string} key The key of the property to assign.\n     * @param {*} value The value to assign.\n     */\n    function assignValue(object, key, value) {\n      var objValue = object[key];\n      if (!(hasOwnProperty.call(object, key) && eq(objValue, value)) ||\n          (value === undefined && !(key in object))) {\n        baseAssignValue(object, key, value);\n      }\n    }\n\n    /**\n     * Gets the index at which the `key` is found in `array` of key-value pairs.\n     *\n     * @private\n     * @param {Array} array The array to inspect.\n     * @param {*} key The key to search for.\n     * @returns {number} Returns the index of the matched value, else `-1`.\n     */\n    function assocIndexOf(array, key) {\n      var length = array.length;\n      while (length--) {\n        if (eq(array[length][0], key)) {\n          return length;\n        }\n      }\n      return -1;\n    }\n\n    /**\n     * Aggregates elements of `collection` on `accumulator` with keys transformed\n     * by `iteratee` and values set by `setter`.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} setter The function to set `accumulator` values.\n     * @param {Function} iteratee The iteratee to transform keys.\n     * @param {Object} accumulator The initial aggregated object.\n     * @returns {Function} Returns `accumulator`.\n     */\n    function baseAggregator(collection, setter, iteratee, accumulator) {\n      baseEach(collection, function(value, key, collection) {\n        setter(accumulator, value, iteratee(value), collection);\n      });\n      return accumulator;\n    }\n\n    /**\n     * The base implementation of `_.assign` without support for multiple sources\n     * or `customizer` functions.\n     *\n     * @private\n     * @param {Object} object The destination object.\n     * @param {Object} source The source object.\n     * @returns {Object} Returns `object`.\n     */\n    function baseAssign(object, source) {\n      return object && copyObject(source, keys(source), object);\n    }\n\n    /**\n     * The base implementation of `_.assignIn` without support for multiple sources\n     * or `customizer` functions.\n     *\n     * @private\n     * @param {Object} object The destination object.\n     * @param {Object} source The source object.\n     * @returns {Object} Returns `object`.\n     */\n    function baseAssignIn(object, source) {\n      return object && copyObject(source, keysIn(source), object);\n    }\n\n    /**\n     * The base implementation of `assignValue` and `assignMergeValue` without\n     * value checks.\n     *\n     * @private\n     * @param {Object} object The object to modify.\n     * @param {string} key The key of the property to assign.\n     * @param {*} value The value to assign.\n     */\n    function baseAssignValue(object, key, value) {\n      if (key == '__proto__' && defineProperty) {\n        defineProperty(object, key, {\n          'configurable': true,\n          'enumerable': true,\n          'value': value,\n          'writable': true\n        });\n      } else {\n        object[key] = value;\n      }\n    }\n\n    /**\n     * The base implementation of `_.at` without support for individual paths.\n     *\n     * @private\n     * @param {Object} object The object to iterate over.\n     * @param {string[]} paths The property paths to pick.\n     * @returns {Array} Returns the picked elements.\n     */\n    function baseAt(object, paths) {\n      var index = -1,\n          length = paths.length,\n          result = Array(length),\n          skip = object == null;\n\n      while (++index < length) {\n        result[index] = skip ? undefined : get(object, paths[index]);\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.clamp` which doesn't coerce arguments.\n     *\n     * @private\n     * @param {number} number The number to clamp.\n     * @param {number} [lower] The lower bound.\n     * @param {number} upper The upper bound.\n     * @returns {number} Returns the clamped number.\n     */\n    function baseClamp(number, lower, upper) {\n      if (number === number) {\n        if (upper !== undefined) {\n          number = number <= upper ? number : upper;\n        }\n        if (lower !== undefined) {\n          number = number >= lower ? number : lower;\n        }\n      }\n      return number;\n    }\n\n    /**\n     * The base implementation of `_.clone` and `_.cloneDeep` which tracks\n     * traversed objects.\n     *\n     * @private\n     * @param {*} value The value to clone.\n     * @param {boolean} bitmask The bitmask flags.\n     *  1 - Deep clone\n     *  2 - Flatten inherited properties\n     *  4 - Clone symbols\n     * @param {Function} [customizer] The function to customize cloning.\n     * @param {string} [key] The key of `value`.\n     * @param {Object} [object] The parent object of `value`.\n     * @param {Object} [stack] Tracks traversed objects and their clone counterparts.\n     * @returns {*} Returns the cloned value.\n     */\n    function baseClone(value, bitmask, customizer, key, object, stack) {\n      var result,\n          isDeep = bitmask & CLONE_DEEP_FLAG,\n          isFlat = bitmask & CLONE_FLAT_FLAG,\n          isFull = bitmask & CLONE_SYMBOLS_FLAG;\n\n      if (customizer) {\n        result = object ? customizer(value, key, object, stack) : customizer(value);\n      }\n      if (result !== undefined) {\n        return result;\n      }\n      if (!isObject(value)) {\n        return value;\n      }\n      var isArr = isArray(value);\n      if (isArr) {\n        result = initCloneArray(value);\n        if (!isDeep) {\n          return copyArray(value, result);\n        }\n      } else {\n        var tag = getTag(value),\n            isFunc = tag == funcTag || tag == genTag;\n\n        if (isBuffer(value)) {\n          return cloneBuffer(value, isDeep);\n        }\n        if (tag == objectTag || tag == argsTag || (isFunc && !object)) {\n          result = (isFlat || isFunc) ? {} : initCloneObject(value);\n          if (!isDeep) {\n            return isFlat\n              ? copySymbolsIn(value, baseAssignIn(result, value))\n              : copySymbols(value, baseAssign(result, value));\n          }\n        } else {\n          if (!cloneableTags[tag]) {\n            return object ? value : {};\n          }\n          result = initCloneByTag(value, tag, isDeep);\n        }\n      }\n      // Check for circular references and return its corresponding clone.\n      stack || (stack = new Stack);\n      var stacked = stack.get(value);\n      if (stacked) {\n        return stacked;\n      }\n      stack.set(value, result);\n\n      if (isSet(value)) {\n        value.forEach(function(subValue) {\n          result.add(baseClone(subValue, bitmask, customizer, subValue, value, stack));\n        });\n\n        return result;\n      }\n\n      if (isMap(value)) {\n        value.forEach(function(subValue, key) {\n          result.set(key, baseClone(subValue, bitmask, customizer, key, value, stack));\n        });\n\n        return result;\n      }\n\n      var keysFunc = isFull\n        ? (isFlat ? getAllKeysIn : getAllKeys)\n        : (isFlat ? keysIn : keys);\n\n      var props = isArr ? undefined : keysFunc(value);\n      arrayEach(props || value, function(subValue, key) {\n        if (props) {\n          key = subValue;\n          subValue = value[key];\n        }\n        // Recursively populate clone (susceptible to call stack limits).\n        assignValue(result, key, baseClone(subValue, bitmask, customizer, key, value, stack));\n      });\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.conforms` which doesn't clone `source`.\n     *\n     * @private\n     * @param {Object} source The object of property predicates to conform to.\n     * @returns {Function} Returns the new spec function.\n     */\n    function baseConforms(source) {\n      var props = keys(source);\n      return function(object) {\n        return baseConformsTo(object, source, props);\n      };\n    }\n\n    /**\n     * The base implementation of `_.conformsTo` which accepts `props` to check.\n     *\n     * @private\n     * @param {Object} object The object to inspect.\n     * @param {Object} source The object of property predicates to conform to.\n     * @returns {boolean} Returns `true` if `object` conforms, else `false`.\n     */\n    function baseConformsTo(object, source, props) {\n      var length = props.length;\n      if (object == null) {\n        return !length;\n      }\n      object = Object(object);\n      while (length--) {\n        var key = props[length],\n            predicate = source[key],\n            value = object[key];\n\n        if ((value === undefined && !(key in object)) || !predicate(value)) {\n          return false;\n        }\n      }\n      return true;\n    }\n\n    /**\n     * The base implementation of `_.delay` and `_.defer` which accepts `args`\n     * to provide to `func`.\n     *\n     * @private\n     * @param {Function} func The function to delay.\n     * @param {number} wait The number of milliseconds to delay invocation.\n     * @param {Array} args The arguments to provide to `func`.\n     * @returns {number|Object} Returns the timer id or timeout object.\n     */\n    function baseDelay(func, wait, args) {\n      if (typeof func != 'function') {\n        throw new TypeError(FUNC_ERROR_TEXT);\n      }\n      return setTimeout(function() { func.apply(undefined, args); }, wait);\n    }\n\n    /**\n     * The base implementation of methods like `_.difference` without support\n     * for excluding multiple arrays or iteratee shorthands.\n     *\n     * @private\n     * @param {Array} array The array to inspect.\n     * @param {Array} values The values to exclude.\n     * @param {Function} [iteratee] The iteratee invoked per element.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns the new array of filtered values.\n     */\n    function baseDifference(array, values, iteratee, comparator) {\n      var index = -1,\n          includes = arrayIncludes,\n          isCommon = true,\n          length = array.length,\n          result = [],\n          valuesLength = values.length;\n\n      if (!length) {\n        return result;\n      }\n      if (iteratee) {\n        values = arrayMap(values, baseUnary(iteratee));\n      }\n      if (comparator) {\n        includes = arrayIncludesWith;\n        isCommon = false;\n      }\n      else if (values.length >= LARGE_ARRAY_SIZE) {\n        includes = cacheHas;\n        isCommon = false;\n        values = new SetCache(values);\n      }\n      outer:\n      while (++index < length) {\n        var value = array[index],\n            computed = iteratee == null ? value : iteratee(value);\n\n        value = (comparator || value !== 0) ? value : 0;\n        if (isCommon && computed === computed) {\n          var valuesIndex = valuesLength;\n          while (valuesIndex--) {\n            if (values[valuesIndex] === computed) {\n              continue outer;\n            }\n          }\n          result.push(value);\n        }\n        else if (!includes(values, computed, comparator)) {\n          result.push(value);\n        }\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.forEach` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} iteratee The function invoked per iteration.\n     * @returns {Array|Object} Returns `collection`.\n     */\n    var baseEach = createBaseEach(baseForOwn);\n\n    /**\n     * The base implementation of `_.forEachRight` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} iteratee The function invoked per iteration.\n     * @returns {Array|Object} Returns `collection`.\n     */\n    var baseEachRight = createBaseEach(baseForOwnRight, true);\n\n    /**\n     * The base implementation of `_.every` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} predicate The function invoked per iteration.\n     * @returns {boolean} Returns `true` if all elements pass the predicate check,\n     *  else `false`\n     */\n    function baseEvery(collection, predicate) {\n      var result = true;\n      baseEach(collection, function(value, index, collection) {\n        result = !!predicate(value, index, collection);\n        return result;\n      });\n      return result;\n    }\n\n    /**\n     * The base implementation of methods like `_.max` and `_.min` which accepts a\n     * `comparator` to determine the extremum value.\n     *\n     * @private\n     * @param {Array} array The array to iterate over.\n     * @param {Function} iteratee The iteratee invoked per iteration.\n     * @param {Function} comparator The comparator used to compare values.\n     * @returns {*} Returns the extremum value.\n     */\n    function baseExtremum(array, iteratee, comparator) {\n      var index = -1,\n          length = array.length;\n\n      while (++index < length) {\n        var value = array[index],\n            current = iteratee(value);\n\n        if (current != null && (computed === undefined\n              ? (current === current && !isSymbol(current))\n              : comparator(current, computed)\n            )) {\n          var computed = current,\n              result = value;\n        }\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.fill` without an iteratee call guard.\n     *\n     * @private\n     * @param {Array} array The array to fill.\n     * @param {*} value The value to fill `array` with.\n     * @param {number} [start=0] The start position.\n     * @param {number} [end=array.length] The end position.\n     * @returns {Array} Returns `array`.\n     */\n    function baseFill(array, value, start, end) {\n      var length = array.length;\n\n      start = toInteger(start);\n      if (start < 0) {\n        start = -start > length ? 0 : (length + start);\n      }\n      end = (end === undefined || end > length) ? length : toInteger(end);\n      if (end < 0) {\n        end += length;\n      }\n      end = start > end ? 0 : toLength(end);\n      while (start < end) {\n        array[start++] = value;\n      }\n      return array;\n    }\n\n    /**\n     * The base implementation of `_.filter` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} predicate The function invoked per iteration.\n     * @returns {Array} Returns the new filtered array.\n     */\n    function baseFilter(collection, predicate) {\n      var result = [];\n      baseEach(collection, function(value, index, collection) {\n        if (predicate(value, index, collection)) {\n          result.push(value);\n        }\n      });\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.flatten` with support for restricting flattening.\n     *\n     * @private\n     * @param {Array} array The array to flatten.\n     * @param {number} depth The maximum recursion depth.\n     * @param {boolean} [predicate=isFlattenable] The function invoked per iteration.\n     * @param {boolean} [isStrict] Restrict to values that pass `predicate` checks.\n     * @param {Array} [result=[]] The initial result value.\n     * @returns {Array} Returns the new flattened array.\n     */\n    function baseFlatten(array, depth, predicate, isStrict, result) {\n      var index = -1,\n          length = array.length;\n\n      predicate || (predicate = isFlattenable);\n      result || (result = []);\n\n      while (++index < length) {\n        var value = array[index];\n        if (depth > 0 && predicate(value)) {\n          if (depth > 1) {\n            // Recursively flatten arrays (susceptible to call stack limits).\n            baseFlatten(value, depth - 1, predicate, isStrict, result);\n          } else {\n            arrayPush(result, value);\n          }\n        } else if (!isStrict) {\n          result[result.length] = value;\n        }\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `baseForOwn` which iterates over `object`\n     * properties returned by `keysFunc` and invokes `iteratee` for each property.\n     * Iteratee functions may exit iteration early by explicitly returning `false`.\n     *\n     * @private\n     * @param {Object} object The object to iterate over.\n     * @param {Function} iteratee The function invoked per iteration.\n     * @param {Function} keysFunc The function to get the keys of `object`.\n     * @returns {Object} Returns `object`.\n     */\n    var baseFor = createBaseFor();\n\n    /**\n     * This function is like `baseFor` except that it iterates over properties\n     * in the opposite order.\n     *\n     * @private\n     * @param {Object} object The object to iterate over.\n     * @param {Function} iteratee The function invoked per iteration.\n     * @param {Function} keysFunc The function to get the keys of `object`.\n     * @returns {Object} Returns `object`.\n     */\n    var baseForRight = createBaseFor(true);\n\n    /**\n     * The base implementation of `_.forOwn` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Object} object The object to iterate over.\n     * @param {Function} iteratee The function invoked per iteration.\n     * @returns {Object} Returns `object`.\n     */\n    function baseForOwn(object, iteratee) {\n      return object && baseFor(object, iteratee, keys);\n    }\n\n    /**\n     * The base implementation of `_.forOwnRight` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Object} object The object to iterate over.\n     * @param {Function} iteratee The function invoked per iteration.\n     * @returns {Object} Returns `object`.\n     */\n    function baseForOwnRight(object, iteratee) {\n      return object && baseForRight(object, iteratee, keys);\n    }\n\n    /**\n     * The base implementation of `_.functions` which creates an array of\n     * `object` function property names filtered from `props`.\n     *\n     * @private\n     * @param {Object} object The object to inspect.\n     * @param {Array} props The property names to filter.\n     * @returns {Array} Returns the function names.\n     */\n    function baseFunctions(object, props) {\n      return arrayFilter(props, function(key) {\n        return isFunction(object[key]);\n      });\n    }\n\n    /**\n     * The base implementation of `_.get` without support for default values.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @param {Array|string} path The path of the property to get.\n     * @returns {*} Returns the resolved value.\n     */\n    function baseGet(object, path) {\n      path = castPath(path, object);\n\n      var index = 0,\n          length = path.length;\n\n      while (object != null && index < length) {\n        object = object[toKey(path[index++])];\n      }\n      return (index && index == length) ? object : undefined;\n    }\n\n    /**\n     * The base implementation of `getAllKeys` and `getAllKeysIn` which uses\n     * `keysFunc` and `symbolsFunc` to get the enumerable property names and\n     * symbols of `object`.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @param {Function} keysFunc The function to get the keys of `object`.\n     * @param {Function} symbolsFunc The function to get the symbols of `object`.\n     * @returns {Array} Returns the array of property names and symbols.\n     */\n    function baseGetAllKeys(object, keysFunc, symbolsFunc) {\n      var result = keysFunc(object);\n      return isArray(object) ? result : arrayPush(result, symbolsFunc(object));\n    }\n\n    /**\n     * The base implementation of `getTag` without fallbacks for buggy environments.\n     *\n     * @private\n     * @param {*} value The value to query.\n     * @returns {string} Returns the `toStringTag`.\n     */\n    function baseGetTag(value) {\n      if (value == null) {\n        return value === undefined ? undefinedTag : nullTag;\n      }\n      return (symToStringTag && symToStringTag in Object(value))\n        ? getRawTag(value)\n        : objectToString(value);\n    }\n\n    /**\n     * The base implementation of `_.gt` which doesn't coerce arguments.\n     *\n     * @private\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @returns {boolean} Returns `true` if `value` is greater than `other`,\n     *  else `false`.\n     */\n    function baseGt(value, other) {\n      return value > other;\n    }\n\n    /**\n     * The base implementation of `_.has` without support for deep paths.\n     *\n     * @private\n     * @param {Object} [object] The object to query.\n     * @param {Array|string} key The key to check.\n     * @returns {boolean} Returns `true` if `key` exists, else `false`.\n     */\n    function baseHas(object, key) {\n      return object != null && hasOwnProperty.call(object, key);\n    }\n\n    /**\n     * The base implementation of `_.hasIn` without support for deep paths.\n     *\n     * @private\n     * @param {Object} [object] The object to query.\n     * @param {Array|string} key The key to check.\n     * @returns {boolean} Returns `true` if `key` exists, else `false`.\n     */\n    function baseHasIn(object, key) {\n      return object != null && key in Object(object);\n    }\n\n    /**\n     * The base implementation of `_.inRange` which doesn't coerce arguments.\n     *\n     * @private\n     * @param {number} number The number to check.\n     * @param {number} start The start of the range.\n     * @param {number} end The end of the range.\n     * @returns {boolean} Returns `true` if `number` is in the range, else `false`.\n     */\n    function baseInRange(number, start, end) {\n      return number >= nativeMin(start, end) && number < nativeMax(start, end);\n    }\n\n    /**\n     * The base implementation of methods like `_.intersection`, without support\n     * for iteratee shorthands, that accepts an array of arrays to inspect.\n     *\n     * @private\n     * @param {Array} arrays The arrays to inspect.\n     * @param {Function} [iteratee] The iteratee invoked per element.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns the new array of shared values.\n     */\n    function baseIntersection(arrays, iteratee, comparator) {\n      var includes = comparator ? arrayIncludesWith : arrayIncludes,\n          length = arrays[0].length,\n          othLength = arrays.length,\n          othIndex = othLength,\n          caches = Array(othLength),\n          maxLength = Infinity,\n          result = [];\n\n      while (othIndex--) {\n        var array = arrays[othIndex];\n        if (othIndex && iteratee) {\n          array = arrayMap(array, baseUnary(iteratee));\n        }\n        maxLength = nativeMin(array.length, maxLength);\n        caches[othIndex] = !comparator && (iteratee || (length >= 120 && array.length >= 120))\n          ? new SetCache(othIndex && array)\n          : undefined;\n      }\n      array = arrays[0];\n\n      var index = -1,\n          seen = caches[0];\n\n      outer:\n      while (++index < length && result.length < maxLength) {\n        var value = array[index],\n            computed = iteratee ? iteratee(value) : value;\n\n        value = (comparator || value !== 0) ? value : 0;\n        if (!(seen\n              ? cacheHas(seen, computed)\n              : includes(result, computed, comparator)\n            )) {\n          othIndex = othLength;\n          while (--othIndex) {\n            var cache = caches[othIndex];\n            if (!(cache\n                  ? cacheHas(cache, computed)\n                  : includes(arrays[othIndex], computed, comparator))\n                ) {\n              continue outer;\n            }\n          }\n          if (seen) {\n            seen.push(computed);\n          }\n          result.push(value);\n        }\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.invert` and `_.invertBy` which inverts\n     * `object` with values transformed by `iteratee` and set by `setter`.\n     *\n     * @private\n     * @param {Object} object The object to iterate over.\n     * @param {Function} setter The function to set `accumulator` values.\n     * @param {Function} iteratee The iteratee to transform values.\n     * @param {Object} accumulator The initial inverted object.\n     * @returns {Function} Returns `accumulator`.\n     */\n    function baseInverter(object, setter, iteratee, accumulator) {\n      baseForOwn(object, function(value, key, object) {\n        setter(accumulator, iteratee(value), key, object);\n      });\n      return accumulator;\n    }\n\n    /**\n     * The base implementation of `_.invoke` without support for individual\n     * method arguments.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @param {Array|string} path The path of the method to invoke.\n     * @param {Array} args The arguments to invoke the method with.\n     * @returns {*} Returns the result of the invoked method.\n     */\n    function baseInvoke(object, path, args) {\n      path = castPath(path, object);\n      object = parent(object, path);\n      var func = object == null ? object : object[toKey(last(path))];\n      return func == null ? undefined : apply(func, object, args);\n    }\n\n    /**\n     * The base implementation of `_.isArguments`.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n     */\n    function baseIsArguments(value) {\n      return isObjectLike(value) && baseGetTag(value) == argsTag;\n    }\n\n    /**\n     * The base implementation of `_.isArrayBuffer` without Node.js optimizations.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is an array buffer, else `false`.\n     */\n    function baseIsArrayBuffer(value) {\n      return isObjectLike(value) && baseGetTag(value) == arrayBufferTag;\n    }\n\n    /**\n     * The base implementation of `_.isDate` without Node.js optimizations.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a date object, else `false`.\n     */\n    function baseIsDate(value) {\n      return isObjectLike(value) && baseGetTag(value) == dateTag;\n    }\n\n    /**\n     * The base implementation of `_.isEqual` which supports partial comparisons\n     * and tracks traversed objects.\n     *\n     * @private\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @param {boolean} bitmask The bitmask flags.\n     *  1 - Unordered comparison\n     *  2 - Partial comparison\n     * @param {Function} [customizer] The function to customize comparisons.\n     * @param {Object} [stack] Tracks traversed `value` and `other` objects.\n     * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n     */\n    function baseIsEqual(value, other, bitmask, customizer, stack) {\n      if (value === other) {\n        return true;\n      }\n      if (value == null || other == null || (!isObjectLike(value) && !isObjectLike(other))) {\n        return value !== value && other !== other;\n      }\n      return baseIsEqualDeep(value, other, bitmask, customizer, baseIsEqual, stack);\n    }\n\n    /**\n     * A specialized version of `baseIsEqual` for arrays and objects which performs\n     * deep comparisons and tracks traversed objects enabling objects with circular\n     * references to be compared.\n     *\n     * @private\n     * @param {Object} object The object to compare.\n     * @param {Object} other The other object to compare.\n     * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n     * @param {Function} customizer The function to customize comparisons.\n     * @param {Function} equalFunc The function to determine equivalents of values.\n     * @param {Object} [stack] Tracks traversed `object` and `other` objects.\n     * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n     */\n    function baseIsEqualDeep(object, other, bitmask, customizer, equalFunc, stack) {\n      var objIsArr = isArray(object),\n          othIsArr = isArray(other),\n          objTag = objIsArr ? arrayTag : getTag(object),\n          othTag = othIsArr ? arrayTag : getTag(other);\n\n      objTag = objTag == argsTag ? objectTag : objTag;\n      othTag = othTag == argsTag ? objectTag : othTag;\n\n      var objIsObj = objTag == objectTag,\n          othIsObj = othTag == objectTag,\n          isSameTag = objTag == othTag;\n\n      if (isSameTag && isBuffer(object)) {\n        if (!isBuffer(other)) {\n          return false;\n        }\n        objIsArr = true;\n        objIsObj = false;\n      }\n      if (isSameTag && !objIsObj) {\n        stack || (stack = new Stack);\n        return (objIsArr || isTypedArray(object))\n          ? equalArrays(object, other, bitmask, customizer, equalFunc, stack)\n          : equalByTag(object, other, objTag, bitmask, customizer, equalFunc, stack);\n      }\n      if (!(bitmask & COMPARE_PARTIAL_FLAG)) {\n        var objIsWrapped = objIsObj && hasOwnProperty.call(object, '__wrapped__'),\n            othIsWrapped = othIsObj && hasOwnProperty.call(other, '__wrapped__');\n\n        if (objIsWrapped || othIsWrapped) {\n          var objUnwrapped = objIsWrapped ? object.value() : object,\n              othUnwrapped = othIsWrapped ? other.value() : other;\n\n          stack || (stack = new Stack);\n          return equalFunc(objUnwrapped, othUnwrapped, bitmask, customizer, stack);\n        }\n      }\n      if (!isSameTag) {\n        return false;\n      }\n      stack || (stack = new Stack);\n      return equalObjects(object, other, bitmask, customizer, equalFunc, stack);\n    }\n\n    /**\n     * The base implementation of `_.isMap` without Node.js optimizations.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a map, else `false`.\n     */\n    function baseIsMap(value) {\n      return isObjectLike(value) && getTag(value) == mapTag;\n    }\n\n    /**\n     * The base implementation of `_.isMatch` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Object} object The object to inspect.\n     * @param {Object} source The object of property values to match.\n     * @param {Array} matchData The property names, values, and compare flags to match.\n     * @param {Function} [customizer] The function to customize comparisons.\n     * @returns {boolean} Returns `true` if `object` is a match, else `false`.\n     */\n    function baseIsMatch(object, source, matchData, customizer) {\n      var index = matchData.length,\n          length = index,\n          noCustomizer = !customizer;\n\n      if (object == null) {\n        return !length;\n      }\n      object = Object(object);\n      while (index--) {\n        var data = matchData[index];\n        if ((noCustomizer && data[2])\n              ? data[1] !== object[data[0]]\n              : !(data[0] in object)\n            ) {\n          return false;\n        }\n      }\n      while (++index < length) {\n        data = matchData[index];\n        var key = data[0],\n            objValue = object[key],\n            srcValue = data[1];\n\n        if (noCustomizer && data[2]) {\n          if (objValue === undefined && !(key in object)) {\n            return false;\n          }\n        } else {\n          var stack = new Stack;\n          if (customizer) {\n            var result = customizer(objValue, srcValue, key, object, source, stack);\n          }\n          if (!(result === undefined\n                ? baseIsEqual(srcValue, objValue, COMPARE_PARTIAL_FLAG | COMPARE_UNORDERED_FLAG, customizer, stack)\n                : result\n              )) {\n            return false;\n          }\n        }\n      }\n      return true;\n    }\n\n    /**\n     * The base implementation of `_.isNative` without bad shim checks.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a native function,\n     *  else `false`.\n     */\n    function baseIsNative(value) {\n      if (!isObject(value) || isMasked(value)) {\n        return false;\n      }\n      var pattern = isFunction(value) ? reIsNative : reIsHostCtor;\n      return pattern.test(toSource(value));\n    }\n\n    /**\n     * The base implementation of `_.isRegExp` without Node.js optimizations.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a regexp, else `false`.\n     */\n    function baseIsRegExp(value) {\n      return isObjectLike(value) && baseGetTag(value) == regexpTag;\n    }\n\n    /**\n     * The base implementation of `_.isSet` without Node.js optimizations.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a set, else `false`.\n     */\n    function baseIsSet(value) {\n      return isObjectLike(value) && getTag(value) == setTag;\n    }\n\n    /**\n     * The base implementation of `_.isTypedArray` without Node.js optimizations.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n     */\n    function baseIsTypedArray(value) {\n      return isObjectLike(value) &&\n        isLength(value.length) && !!typedArrayTags[baseGetTag(value)];\n    }\n\n    /**\n     * The base implementation of `_.iteratee`.\n     *\n     * @private\n     * @param {*} [value=_.identity] The value to convert to an iteratee.\n     * @returns {Function} Returns the iteratee.\n     */\n    function baseIteratee(value) {\n      // Don't store the `typeof` result in a variable to avoid a JIT bug in Safari 9.\n      // See https://bugs.webkit.org/show_bug.cgi?id=156034 for more details.\n      if (typeof value == 'function') {\n        return value;\n      }\n      if (value == null) {\n        return identity;\n      }\n      if (typeof value == 'object') {\n        return isArray(value)\n          ? baseMatchesProperty(value[0], value[1])\n          : baseMatches(value);\n      }\n      return property(value);\n    }\n\n    /**\n     * The base implementation of `_.keys` which doesn't treat sparse arrays as dense.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of property names.\n     */\n    function baseKeys(object) {\n      if (!isPrototype(object)) {\n        return nativeKeys(object);\n      }\n      var result = [];\n      for (var key in Object(object)) {\n        if (hasOwnProperty.call(object, key) && key != 'constructor') {\n          result.push(key);\n        }\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.keysIn` which doesn't treat sparse arrays as dense.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of property names.\n     */\n    function baseKeysIn(object) {\n      if (!isObject(object)) {\n        return nativeKeysIn(object);\n      }\n      var isProto = isPrototype(object),\n          result = [];\n\n      for (var key in object) {\n        if (!(key == 'constructor' && (isProto || !hasOwnProperty.call(object, key)))) {\n          result.push(key);\n        }\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.lt` which doesn't coerce arguments.\n     *\n     * @private\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @returns {boolean} Returns `true` if `value` is less than `other`,\n     *  else `false`.\n     */\n    function baseLt(value, other) {\n      return value < other;\n    }\n\n    /**\n     * The base implementation of `_.map` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} iteratee The function invoked per iteration.\n     * @returns {Array} Returns the new mapped array.\n     */\n    function baseMap(collection, iteratee) {\n      var index = -1,\n          result = isArrayLike(collection) ? Array(collection.length) : [];\n\n      baseEach(collection, function(value, key, collection) {\n        result[++index] = iteratee(value, key, collection);\n      });\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.matches` which doesn't clone `source`.\n     *\n     * @private\n     * @param {Object} source The object of property values to match.\n     * @returns {Function} Returns the new spec function.\n     */\n    function baseMatches(source) {\n      var matchData = getMatchData(source);\n      if (matchData.length == 1 && matchData[0][2]) {\n        return matchesStrictComparable(matchData[0][0], matchData[0][1]);\n      }\n      return function(object) {\n        return object === source || baseIsMatch(object, source, matchData);\n      };\n    }\n\n    /**\n     * The base implementation of `_.matchesProperty` which doesn't clone `srcValue`.\n     *\n     * @private\n     * @param {string} path The path of the property to get.\n     * @param {*} srcValue The value to match.\n     * @returns {Function} Returns the new spec function.\n     */\n    function baseMatchesProperty(path, srcValue) {\n      if (isKey(path) && isStrictComparable(srcValue)) {\n        return matchesStrictComparable(toKey(path), srcValue);\n      }\n      return function(object) {\n        var objValue = get(object, path);\n        return (objValue === undefined && objValue === srcValue)\n          ? hasIn(object, path)\n          : baseIsEqual(srcValue, objValue, COMPARE_PARTIAL_FLAG | COMPARE_UNORDERED_FLAG);\n      };\n    }\n\n    /**\n     * The base implementation of `_.merge` without support for multiple sources.\n     *\n     * @private\n     * @param {Object} object The destination object.\n     * @param {Object} source The source object.\n     * @param {number} srcIndex The index of `source`.\n     * @param {Function} [customizer] The function to customize merged values.\n     * @param {Object} [stack] Tracks traversed source values and their merged\n     *  counterparts.\n     */\n    function baseMerge(object, source, srcIndex, customizer, stack) {\n      if (object === source) {\n        return;\n      }\n      baseFor(source, function(srcValue, key) {\n        if (isObject(srcValue)) {\n          stack || (stack = new Stack);\n          baseMergeDeep(object, source, key, srcIndex, baseMerge, customizer, stack);\n        }\n        else {\n          var newValue = customizer\n            ? customizer(safeGet(object, key), srcValue, (key + ''), object, source, stack)\n            : undefined;\n\n          if (newValue === undefined) {\n            newValue = srcValue;\n          }\n          assignMergeValue(object, key, newValue);\n        }\n      }, keysIn);\n    }\n\n    /**\n     * A specialized version of `baseMerge` for arrays and objects which performs\n     * deep merges and tracks traversed objects enabling objects with circular\n     * references to be merged.\n     *\n     * @private\n     * @param {Object} object The destination object.\n     * @param {Object} source The source object.\n     * @param {string} key The key of the value to merge.\n     * @param {number} srcIndex The index of `source`.\n     * @param {Function} mergeFunc The function to merge values.\n     * @param {Function} [customizer] The function to customize assigned values.\n     * @param {Object} [stack] Tracks traversed source values and their merged\n     *  counterparts.\n     */\n    function baseMergeDeep(object, source, key, srcIndex, mergeFunc, customizer, stack) {\n      var objValue = safeGet(object, key),\n          srcValue = safeGet(source, key),\n          stacked = stack.get(srcValue);\n\n      if (stacked) {\n        assignMergeValue(object, key, stacked);\n        return;\n      }\n      var newValue = customizer\n        ? customizer(objValue, srcValue, (key + ''), object, source, stack)\n        : undefined;\n\n      var isCommon = newValue === undefined;\n\n      if (isCommon) {\n        var isArr = isArray(srcValue),\n            isBuff = !isArr && isBuffer(srcValue),\n            isTyped = !isArr && !isBuff && isTypedArray(srcValue);\n\n        newValue = srcValue;\n        if (isArr || isBuff || isTyped) {\n          if (isArray(objValue)) {\n            newValue = objValue;\n          }\n          else if (isArrayLikeObject(objValue)) {\n            newValue = copyArray(objValue);\n          }\n          else if (isBuff) {\n            isCommon = false;\n            newValue = cloneBuffer(srcValue, true);\n          }\n          else if (isTyped) {\n            isCommon = false;\n            newValue = cloneTypedArray(srcValue, true);\n          }\n          else {\n            newValue = [];\n          }\n        }\n        else if (isPlainObject(srcValue) || isArguments(srcValue)) {\n          newValue = objValue;\n          if (isArguments(objValue)) {\n            newValue = toPlainObject(objValue);\n          }\n          else if (!isObject(objValue) || (srcIndex && isFunction(objValue))) {\n            newValue = initCloneObject(srcValue);\n          }\n        }\n        else {\n          isCommon = false;\n        }\n      }\n      if (isCommon) {\n        // Recursively merge objects and arrays (susceptible to call stack limits).\n        stack.set(srcValue, newValue);\n        mergeFunc(newValue, srcValue, srcIndex, customizer, stack);\n        stack['delete'](srcValue);\n      }\n      assignMergeValue(object, key, newValue);\n    }\n\n    /**\n     * The base implementation of `_.nth` which doesn't coerce arguments.\n     *\n     * @private\n     * @param {Array} array The array to query.\n     * @param {number} n The index of the element to return.\n     * @returns {*} Returns the nth element of `array`.\n     */\n    function baseNth(array, n) {\n      var length = array.length;\n      if (!length) {\n        return;\n      }\n      n += n < 0 ? length : 0;\n      return isIndex(n, length) ? array[n] : undefined;\n    }\n\n    /**\n     * The base implementation of `_.orderBy` without param guards.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function[]|Object[]|string[]} iteratees The iteratees to sort by.\n     * @param {string[]} orders The sort orders of `iteratees`.\n     * @returns {Array} Returns the new sorted array.\n     */\n    function baseOrderBy(collection, iteratees, orders) {\n      var index = -1;\n      iteratees = arrayMap(iteratees.length ? iteratees : [identity], baseUnary(getIteratee()));\n\n      var result = baseMap(collection, function(value, key, collection) {\n        var criteria = arrayMap(iteratees, function(iteratee) {\n          return iteratee(value);\n        });\n        return { 'criteria': criteria, 'index': ++index, 'value': value };\n      });\n\n      return baseSortBy(result, function(object, other) {\n        return compareMultiple(object, other, orders);\n      });\n    }\n\n    /**\n     * The base implementation of `_.pick` without support for individual\n     * property identifiers.\n     *\n     * @private\n     * @param {Object} object The source object.\n     * @param {string[]} paths The property paths to pick.\n     * @returns {Object} Returns the new object.\n     */\n    function basePick(object, paths) {\n      return basePickBy(object, paths, function(value, path) {\n        return hasIn(object, path);\n      });\n    }\n\n    /**\n     * The base implementation of  `_.pickBy` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Object} object The source object.\n     * @param {string[]} paths The property paths to pick.\n     * @param {Function} predicate The function invoked per property.\n     * @returns {Object} Returns the new object.\n     */\n    function basePickBy(object, paths, predicate) {\n      var index = -1,\n          length = paths.length,\n          result = {};\n\n      while (++index < length) {\n        var path = paths[index],\n            value = baseGet(object, path);\n\n        if (predicate(value, path)) {\n          baseSet(result, castPath(path, object), value);\n        }\n      }\n      return result;\n    }\n\n    /**\n     * A specialized version of `baseProperty` which supports deep paths.\n     *\n     * @private\n     * @param {Array|string} path The path of the property to get.\n     * @returns {Function} Returns the new accessor function.\n     */\n    function basePropertyDeep(path) {\n      return function(object) {\n        return baseGet(object, path);\n      };\n    }\n\n    /**\n     * The base implementation of `_.pullAllBy` without support for iteratee\n     * shorthands.\n     *\n     * @private\n     * @param {Array} array The array to modify.\n     * @param {Array} values The values to remove.\n     * @param {Function} [iteratee] The iteratee invoked per element.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns `array`.\n     */\n    function basePullAll(array, values, iteratee, comparator) {\n      var indexOf = comparator ? baseIndexOfWith : baseIndexOf,\n          index = -1,\n          length = values.length,\n          seen = array;\n\n      if (array === values) {\n        values = copyArray(values);\n      }\n      if (iteratee) {\n        seen = arrayMap(array, baseUnary(iteratee));\n      }\n      while (++index < length) {\n        var fromIndex = 0,\n            value = values[index],\n            computed = iteratee ? iteratee(value) : value;\n\n        while ((fromIndex = indexOf(seen, computed, fromIndex, comparator)) > -1) {\n          if (seen !== array) {\n            splice.call(seen, fromIndex, 1);\n          }\n          splice.call(array, fromIndex, 1);\n        }\n      }\n      return array;\n    }\n\n    /**\n     * The base implementation of `_.pullAt` without support for individual\n     * indexes or capturing the removed elements.\n     *\n     * @private\n     * @param {Array} array The array to modify.\n     * @param {number[]} indexes The indexes of elements to remove.\n     * @returns {Array} Returns `array`.\n     */\n    function basePullAt(array, indexes) {\n      var length = array ? indexes.length : 0,\n          lastIndex = length - 1;\n\n      while (length--) {\n        var index = indexes[length];\n        if (length == lastIndex || index !== previous) {\n          var previous = index;\n          if (isIndex(index)) {\n            splice.call(array, index, 1);\n          } else {\n            baseUnset(array, index);\n          }\n        }\n      }\n      return array;\n    }\n\n    /**\n     * The base implementation of `_.random` without support for returning\n     * floating-point numbers.\n     *\n     * @private\n     * @param {number} lower The lower bound.\n     * @param {number} upper The upper bound.\n     * @returns {number} Returns the random number.\n     */\n    function baseRandom(lower, upper) {\n      return lower + nativeFloor(nativeRandom() * (upper - lower + 1));\n    }\n\n    /**\n     * The base implementation of `_.range` and `_.rangeRight` which doesn't\n     * coerce arguments.\n     *\n     * @private\n     * @param {number} start The start of the range.\n     * @param {number} end The end of the range.\n     * @param {number} step The value to increment or decrement by.\n     * @param {boolean} [fromRight] Specify iterating from right to left.\n     * @returns {Array} Returns the range of numbers.\n     */\n    function baseRange(start, end, step, fromRight) {\n      var index = -1,\n          length = nativeMax(nativeCeil((end - start) / (step || 1)), 0),\n          result = Array(length);\n\n      while (length--) {\n        result[fromRight ? length : ++index] = start;\n        start += step;\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.repeat` which doesn't coerce arguments.\n     *\n     * @private\n     * @param {string} string The string to repeat.\n     * @param {number} n The number of times to repeat the string.\n     * @returns {string} Returns the repeated string.\n     */\n    function baseRepeat(string, n) {\n      var result = '';\n      if (!string || n < 1 || n > MAX_SAFE_INTEGER) {\n        return result;\n      }\n      // Leverage the exponentiation by squaring algorithm for a faster repeat.\n      // See https://en.wikipedia.org/wiki/Exponentiation_by_squaring for more details.\n      do {\n        if (n % 2) {\n          result += string;\n        }\n        n = nativeFloor(n / 2);\n        if (n) {\n          string += string;\n        }\n      } while (n);\n\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.rest` which doesn't validate or coerce arguments.\n     *\n     * @private\n     * @param {Function} func The function to apply a rest parameter to.\n     * @param {number} [start=func.length-1] The start position of the rest parameter.\n     * @returns {Function} Returns the new function.\n     */\n    function baseRest(func, start) {\n      return setToString(overRest(func, start, identity), func + '');\n    }\n\n    /**\n     * The base implementation of `_.sample`.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to sample.\n     * @returns {*} Returns the random element.\n     */\n    function baseSample(collection) {\n      return arraySample(values(collection));\n    }\n\n    /**\n     * The base implementation of `_.sampleSize` without param guards.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to sample.\n     * @param {number} n The number of elements to sample.\n     * @returns {Array} Returns the random elements.\n     */\n    function baseSampleSize(collection, n) {\n      var array = values(collection);\n      return shuffleSelf(array, baseClamp(n, 0, array.length));\n    }\n\n    /**\n     * The base implementation of `_.set`.\n     *\n     * @private\n     * @param {Object} object The object to modify.\n     * @param {Array|string} path The path of the property to set.\n     * @param {*} value The value to set.\n     * @param {Function} [customizer] The function to customize path creation.\n     * @returns {Object} Returns `object`.\n     */\n    function baseSet(object, path, value, customizer) {\n      if (!isObject(object)) {\n        return object;\n      }\n      path = castPath(path, object);\n\n      var index = -1,\n          length = path.length,\n          lastIndex = length - 1,\n          nested = object;\n\n      while (nested != null && ++index < length) {\n        var key = toKey(path[index]),\n            newValue = value;\n\n        if (index != lastIndex) {\n          var objValue = nested[key];\n          newValue = customizer ? customizer(objValue, key, nested) : undefined;\n          if (newValue === undefined) {\n            newValue = isObject(objValue)\n              ? objValue\n              : (isIndex(path[index + 1]) ? [] : {});\n          }\n        }\n        assignValue(nested, key, newValue);\n        nested = nested[key];\n      }\n      return object;\n    }\n\n    /**\n     * The base implementation of `setData` without support for hot loop shorting.\n     *\n     * @private\n     * @param {Function} func The function to associate metadata with.\n     * @param {*} data The metadata.\n     * @returns {Function} Returns `func`.\n     */\n    var baseSetData = !metaMap ? identity : function(func, data) {\n      metaMap.set(func, data);\n      return func;\n    };\n\n    /**\n     * The base implementation of `setToString` without support for hot loop shorting.\n     *\n     * @private\n     * @param {Function} func The function to modify.\n     * @param {Function} string The `toString` result.\n     * @returns {Function} Returns `func`.\n     */\n    var baseSetToString = !defineProperty ? identity : function(func, string) {\n      return defineProperty(func, 'toString', {\n        'configurable': true,\n        'enumerable': false,\n        'value': constant(string),\n        'writable': true\n      });\n    };\n\n    /**\n     * The base implementation of `_.shuffle`.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to shuffle.\n     * @returns {Array} Returns the new shuffled array.\n     */\n    function baseShuffle(collection) {\n      return shuffleSelf(values(collection));\n    }\n\n    /**\n     * The base implementation of `_.slice` without an iteratee call guard.\n     *\n     * @private\n     * @param {Array} array The array to slice.\n     * @param {number} [start=0] The start position.\n     * @param {number} [end=array.length] The end position.\n     * @returns {Array} Returns the slice of `array`.\n     */\n    function baseSlice(array, start, end) {\n      var index = -1,\n          length = array.length;\n\n      if (start < 0) {\n        start = -start > length ? 0 : (length + start);\n      }\n      end = end > length ? length : end;\n      if (end < 0) {\n        end += length;\n      }\n      length = start > end ? 0 : ((end - start) >>> 0);\n      start >>>= 0;\n\n      var result = Array(length);\n      while (++index < length) {\n        result[index] = array[index + start];\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.some` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} predicate The function invoked per iteration.\n     * @returns {boolean} Returns `true` if any element passes the predicate check,\n     *  else `false`.\n     */\n    function baseSome(collection, predicate) {\n      var result;\n\n      baseEach(collection, function(value, index, collection) {\n        result = predicate(value, index, collection);\n        return !result;\n      });\n      return !!result;\n    }\n\n    /**\n     * The base implementation of `_.sortedIndex` and `_.sortedLastIndex` which\n     * performs a binary search of `array` to determine the index at which `value`\n     * should be inserted into `array` in order to maintain its sort order.\n     *\n     * @private\n     * @param {Array} array The sorted array to inspect.\n     * @param {*} value The value to evaluate.\n     * @param {boolean} [retHighest] Specify returning the highest qualified index.\n     * @returns {number} Returns the index at which `value` should be inserted\n     *  into `array`.\n     */\n    function baseSortedIndex(array, value, retHighest) {\n      var low = 0,\n          high = array == null ? low : array.length;\n\n      if (typeof value == 'number' && value === value && high <= HALF_MAX_ARRAY_LENGTH) {\n        while (low < high) {\n          var mid = (low + high) >>> 1,\n              computed = array[mid];\n\n          if (computed !== null && !isSymbol(computed) &&\n              (retHighest ? (computed <= value) : (computed < value))) {\n            low = mid + 1;\n          } else {\n            high = mid;\n          }\n        }\n        return high;\n      }\n      return baseSortedIndexBy(array, value, identity, retHighest);\n    }\n\n    /**\n     * The base implementation of `_.sortedIndexBy` and `_.sortedLastIndexBy`\n     * which invokes `iteratee` for `value` and each element of `array` to compute\n     * their sort ranking. The iteratee is invoked with one argument; (value).\n     *\n     * @private\n     * @param {Array} array The sorted array to inspect.\n     * @param {*} value The value to evaluate.\n     * @param {Function} iteratee The iteratee invoked per element.\n     * @param {boolean} [retHighest] Specify returning the highest qualified index.\n     * @returns {number} Returns the index at which `value` should be inserted\n     *  into `array`.\n     */\n    function baseSortedIndexBy(array, value, iteratee, retHighest) {\n      value = iteratee(value);\n\n      var low = 0,\n          high = array == null ? 0 : array.length,\n          valIsNaN = value !== value,\n          valIsNull = value === null,\n          valIsSymbol = isSymbol(value),\n          valIsUndefined = value === undefined;\n\n      while (low < high) {\n        var mid = nativeFloor((low + high) / 2),\n            computed = iteratee(array[mid]),\n            othIsDefined = computed !== undefined,\n            othIsNull = computed === null,\n            othIsReflexive = computed === computed,\n            othIsSymbol = isSymbol(computed);\n\n        if (valIsNaN) {\n          var setLow = retHighest || othIsReflexive;\n        } else if (valIsUndefined) {\n          setLow = othIsReflexive && (retHighest || othIsDefined);\n        } else if (valIsNull) {\n          setLow = othIsReflexive && othIsDefined && (retHighest || !othIsNull);\n        } else if (valIsSymbol) {\n          setLow = othIsReflexive && othIsDefined && !othIsNull && (retHighest || !othIsSymbol);\n        } else if (othIsNull || othIsSymbol) {\n          setLow = false;\n        } else {\n          setLow = retHighest ? (computed <= value) : (computed < value);\n        }\n        if (setLow) {\n          low = mid + 1;\n        } else {\n          high = mid;\n        }\n      }\n      return nativeMin(high, MAX_ARRAY_INDEX);\n    }\n\n    /**\n     * The base implementation of `_.sortedUniq` and `_.sortedUniqBy` without\n     * support for iteratee shorthands.\n     *\n     * @private\n     * @param {Array} array The array to inspect.\n     * @param {Function} [iteratee] The iteratee invoked per element.\n     * @returns {Array} Returns the new duplicate free array.\n     */\n    function baseSortedUniq(array, iteratee) {\n      var index = -1,\n          length = array.length,\n          resIndex = 0,\n          result = [];\n\n      while (++index < length) {\n        var value = array[index],\n            computed = iteratee ? iteratee(value) : value;\n\n        if (!index || !eq(computed, seen)) {\n          var seen = computed;\n          result[resIndex++] = value === 0 ? 0 : value;\n        }\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.toNumber` which doesn't ensure correct\n     * conversions of binary, hexadecimal, or octal string values.\n     *\n     * @private\n     * @param {*} value The value to process.\n     * @returns {number} Returns the number.\n     */\n    function baseToNumber(value) {\n      if (typeof value == 'number') {\n        return value;\n      }\n      if (isSymbol(value)) {\n        return NAN;\n      }\n      return +value;\n    }\n\n    /**\n     * The base implementation of `_.toString` which doesn't convert nullish\n     * values to empty strings.\n     *\n     * @private\n     * @param {*} value The value to process.\n     * @returns {string} Returns the string.\n     */\n    function baseToString(value) {\n      // Exit early for strings to avoid a performance hit in some environments.\n      if (typeof value == 'string') {\n        return value;\n      }\n      if (isArray(value)) {\n        // Recursively convert values (susceptible to call stack limits).\n        return arrayMap(value, baseToString) + '';\n      }\n      if (isSymbol(value)) {\n        return symbolToString ? symbolToString.call(value) : '';\n      }\n      var result = (value + '');\n      return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n    }\n\n    /**\n     * The base implementation of `_.uniqBy` without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Array} array The array to inspect.\n     * @param {Function} [iteratee] The iteratee invoked per element.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns the new duplicate free array.\n     */\n    function baseUniq(array, iteratee, comparator) {\n      var index = -1,\n          includes = arrayIncludes,\n          length = array.length,\n          isCommon = true,\n          result = [],\n          seen = result;\n\n      if (comparator) {\n        isCommon = false;\n        includes = arrayIncludesWith;\n      }\n      else if (length >= LARGE_ARRAY_SIZE) {\n        var set = iteratee ? null : createSet(array);\n        if (set) {\n          return setToArray(set);\n        }\n        isCommon = false;\n        includes = cacheHas;\n        seen = new SetCache;\n      }\n      else {\n        seen = iteratee ? [] : result;\n      }\n      outer:\n      while (++index < length) {\n        var value = array[index],\n            computed = iteratee ? iteratee(value) : value;\n\n        value = (comparator || value !== 0) ? value : 0;\n        if (isCommon && computed === computed) {\n          var seenIndex = seen.length;\n          while (seenIndex--) {\n            if (seen[seenIndex] === computed) {\n              continue outer;\n            }\n          }\n          if (iteratee) {\n            seen.push(computed);\n          }\n          result.push(value);\n        }\n        else if (!includes(seen, computed, comparator)) {\n          if (seen !== result) {\n            seen.push(computed);\n          }\n          result.push(value);\n        }\n      }\n      return result;\n    }\n\n    /**\n     * The base implementation of `_.unset`.\n     *\n     * @private\n     * @param {Object} object The object to modify.\n     * @param {Array|string} path The property path to unset.\n     * @returns {boolean} Returns `true` if the property is deleted, else `false`.\n     */\n    function baseUnset(object, path) {\n      path = castPath(path, object);\n      object = parent(object, path);\n      return object == null || delete object[toKey(last(path))];\n    }\n\n    /**\n     * The base implementation of `_.update`.\n     *\n     * @private\n     * @param {Object} object The object to modify.\n     * @param {Array|string} path The path of the property to update.\n     * @param {Function} updater The function to produce the updated value.\n     * @param {Function} [customizer] The function to customize path creation.\n     * @returns {Object} Returns `object`.\n     */\n    function baseUpdate(object, path, updater, customizer) {\n      return baseSet(object, path, updater(baseGet(object, path)), customizer);\n    }\n\n    /**\n     * The base implementation of methods like `_.dropWhile` and `_.takeWhile`\n     * without support for iteratee shorthands.\n     *\n     * @private\n     * @param {Array} array The array to query.\n     * @param {Function} predicate The function invoked per iteration.\n     * @param {boolean} [isDrop] Specify dropping elements instead of taking them.\n     * @param {boolean} [fromRight] Specify iterating from right to left.\n     * @returns {Array} Returns the slice of `array`.\n     */\n    function baseWhile(array, predicate, isDrop, fromRight) {\n      var length = array.length,\n          index = fromRight ? length : -1;\n\n      while ((fromRight ? index-- : ++index < length) &&\n        predicate(array[index], index, array)) {}\n\n      return isDrop\n        ? baseSlice(array, (fromRight ? 0 : index), (fromRight ? index + 1 : length))\n        : baseSlice(array, (fromRight ? index + 1 : 0), (fromRight ? length : index));\n    }\n\n    /**\n     * The base implementation of `wrapperValue` which returns the result of\n     * performing a sequence of actions on the unwrapped `value`, where each\n     * successive action is supplied the return value of the previous.\n     *\n     * @private\n     * @param {*} value The unwrapped value.\n     * @param {Array} actions Actions to perform to resolve the unwrapped value.\n     * @returns {*} Returns the resolved value.\n     */\n    function baseWrapperValue(value, actions) {\n      var result = value;\n      if (result instanceof LazyWrapper) {\n        result = result.value();\n      }\n      return arrayReduce(actions, function(result, action) {\n        return action.func.apply(action.thisArg, arrayPush([result], action.args));\n      }, result);\n    }\n\n    /**\n     * The base implementation of methods like `_.xor`, without support for\n     * iteratee shorthands, that accepts an array of arrays to inspect.\n     *\n     * @private\n     * @param {Array} arrays The arrays to inspect.\n     * @param {Function} [iteratee] The iteratee invoked per element.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns the new array of values.\n     */\n    function baseXor(arrays, iteratee, comparator) {\n      var length = arrays.length;\n      if (length < 2) {\n        return length ? baseUniq(arrays[0]) : [];\n      }\n      var index = -1,\n          result = Array(length);\n\n      while (++index < length) {\n        var array = arrays[index],\n            othIndex = -1;\n\n        while (++othIndex < length) {\n          if (othIndex != index) {\n            result[index] = baseDifference(result[index] || array, arrays[othIndex], iteratee, comparator);\n          }\n        }\n      }\n      return baseUniq(baseFlatten(result, 1), iteratee, comparator);\n    }\n\n    /**\n     * This base implementation of `_.zipObject` which assigns values using `assignFunc`.\n     *\n     * @private\n     * @param {Array} props The property identifiers.\n     * @param {Array} values The property values.\n     * @param {Function} assignFunc The function to assign values.\n     * @returns {Object} Returns the new object.\n     */\n    function baseZipObject(props, values, assignFunc) {\n      var index = -1,\n          length = props.length,\n          valsLength = values.length,\n          result = {};\n\n      while (++index < length) {\n        var value = index < valsLength ? values[index] : undefined;\n        assignFunc(result, props[index], value);\n      }\n      return result;\n    }\n\n    /**\n     * Casts `value` to an empty array if it's not an array like object.\n     *\n     * @private\n     * @param {*} value The value to inspect.\n     * @returns {Array|Object} Returns the cast array-like object.\n     */\n    function castArrayLikeObject(value) {\n      return isArrayLikeObject(value) ? value : [];\n    }\n\n    /**\n     * Casts `value` to `identity` if it's not a function.\n     *\n     * @private\n     * @param {*} value The value to inspect.\n     * @returns {Function} Returns cast function.\n     */\n    function castFunction(value) {\n      return typeof value == 'function' ? value : identity;\n    }\n\n    /**\n     * Casts `value` to a path array if it's not one.\n     *\n     * @private\n     * @param {*} value The value to inspect.\n     * @param {Object} [object] The object to query keys on.\n     * @returns {Array} Returns the cast property path array.\n     */\n    function castPath(value, object) {\n      if (isArray(value)) {\n        return value;\n      }\n      return isKey(value, object) ? [value] : stringToPath(toString(value));\n    }\n\n    /**\n     * A `baseRest` alias which can be replaced with `identity` by module\n     * replacement plugins.\n     *\n     * @private\n     * @type {Function}\n     * @param {Function} func The function to apply a rest parameter to.\n     * @returns {Function} Returns the new function.\n     */\n    var castRest = baseRest;\n\n    /**\n     * Casts `array` to a slice if it's needed.\n     *\n     * @private\n     * @param {Array} array The array to inspect.\n     * @param {number} start The start position.\n     * @param {number} [end=array.length] The end position.\n     * @returns {Array} Returns the cast slice.\n     */\n    function castSlice(array, start, end) {\n      var length = array.length;\n      end = end === undefined ? length : end;\n      return (!start && end >= length) ? array : baseSlice(array, start, end);\n    }\n\n    /**\n     * A simple wrapper around the global [`clearTimeout`](https://mdn.io/clearTimeout).\n     *\n     * @private\n     * @param {number|Object} id The timer id or timeout object of the timer to clear.\n     */\n    var clearTimeout = ctxClearTimeout || function(id) {\n      return root.clearTimeout(id);\n    };\n\n    /**\n     * Creates a clone of  `buffer`.\n     *\n     * @private\n     * @param {Buffer} buffer The buffer to clone.\n     * @param {boolean} [isDeep] Specify a deep clone.\n     * @returns {Buffer} Returns the cloned buffer.\n     */\n    function cloneBuffer(buffer, isDeep) {\n      if (isDeep) {\n        return buffer.slice();\n      }\n      var length = buffer.length,\n          result = allocUnsafe ? allocUnsafe(length) : new buffer.constructor(length);\n\n      buffer.copy(result);\n      return result;\n    }\n\n    /**\n     * Creates a clone of `arrayBuffer`.\n     *\n     * @private\n     * @param {ArrayBuffer} arrayBuffer The array buffer to clone.\n     * @returns {ArrayBuffer} Returns the cloned array buffer.\n     */\n    function cloneArrayBuffer(arrayBuffer) {\n      var result = new arrayBuffer.constructor(arrayBuffer.byteLength);\n      new Uint8Array(result).set(new Uint8Array(arrayBuffer));\n      return result;\n    }\n\n    /**\n     * Creates a clone of `dataView`.\n     *\n     * @private\n     * @param {Object} dataView The data view to clone.\n     * @param {boolean} [isDeep] Specify a deep clone.\n     * @returns {Object} Returns the cloned data view.\n     */\n    function cloneDataView(dataView, isDeep) {\n      var buffer = isDeep ? cloneArrayBuffer(dataView.buffer) : dataView.buffer;\n      return new dataView.constructor(buffer, dataView.byteOffset, dataView.byteLength);\n    }\n\n    /**\n     * Creates a clone of `regexp`.\n     *\n     * @private\n     * @param {Object} regexp The regexp to clone.\n     * @returns {Object} Returns the cloned regexp.\n     */\n    function cloneRegExp(regexp) {\n      var result = new regexp.constructor(regexp.source, reFlags.exec(regexp));\n      result.lastIndex = regexp.lastIndex;\n      return result;\n    }\n\n    /**\n     * Creates a clone of the `symbol` object.\n     *\n     * @private\n     * @param {Object} symbol The symbol object to clone.\n     * @returns {Object} Returns the cloned symbol object.\n     */\n    function cloneSymbol(symbol) {\n      return symbolValueOf ? Object(symbolValueOf.call(symbol)) : {};\n    }\n\n    /**\n     * Creates a clone of `typedArray`.\n     *\n     * @private\n     * @param {Object} typedArray The typed array to clone.\n     * @param {boolean} [isDeep] Specify a deep clone.\n     * @returns {Object} Returns the cloned typed array.\n     */\n    function cloneTypedArray(typedArray, isDeep) {\n      var buffer = isDeep ? cloneArrayBuffer(typedArray.buffer) : typedArray.buffer;\n      return new typedArray.constructor(buffer, typedArray.byteOffset, typedArray.length);\n    }\n\n    /**\n     * Compares values to sort them in ascending order.\n     *\n     * @private\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @returns {number} Returns the sort order indicator for `value`.\n     */\n    function compareAscending(value, other) {\n      if (value !== other) {\n        var valIsDefined = value !== undefined,\n            valIsNull = value === null,\n            valIsReflexive = value === value,\n            valIsSymbol = isSymbol(value);\n\n        var othIsDefined = other !== undefined,\n            othIsNull = other === null,\n            othIsReflexive = other === other,\n            othIsSymbol = isSymbol(other);\n\n        if ((!othIsNull && !othIsSymbol && !valIsSymbol && value > other) ||\n            (valIsSymbol && othIsDefined && othIsReflexive && !othIsNull && !othIsSymbol) ||\n            (valIsNull && othIsDefined && othIsReflexive) ||\n            (!valIsDefined && othIsReflexive) ||\n            !valIsReflexive) {\n          return 1;\n        }\n        if ((!valIsNull && !valIsSymbol && !othIsSymbol && value < other) ||\n            (othIsSymbol && valIsDefined && valIsReflexive && !valIsNull && !valIsSymbol) ||\n            (othIsNull && valIsDefined && valIsReflexive) ||\n            (!othIsDefined && valIsReflexive) ||\n            !othIsReflexive) {\n          return -1;\n        }\n      }\n      return 0;\n    }\n\n    /**\n     * Used by `_.orderBy` to compare multiple properties of a value to another\n     * and stable sort them.\n     *\n     * If `orders` is unspecified, all values are sorted in ascending order. Otherwise,\n     * specify an order of \"desc\" for descending or \"asc\" for ascending sort order\n     * of corresponding values.\n     *\n     * @private\n     * @param {Object} object The object to compare.\n     * @param {Object} other The other object to compare.\n     * @param {boolean[]|string[]} orders The order to sort by for each property.\n     * @returns {number} Returns the sort order indicator for `object`.\n     */\n    function compareMultiple(object, other, orders) {\n      var index = -1,\n          objCriteria = object.criteria,\n          othCriteria = other.criteria,\n          length = objCriteria.length,\n          ordersLength = orders.length;\n\n      while (++index < length) {\n        var result = compareAscending(objCriteria[index], othCriteria[index]);\n        if (result) {\n          if (index >= ordersLength) {\n            return result;\n          }\n          var order = orders[index];\n          return result * (order == 'desc' ? -1 : 1);\n        }\n      }\n      // Fixes an `Array#sort` bug in the JS engine embedded in Adobe applications\n      // that causes it, under certain circumstances, to provide the same value for\n      // `object` and `other`. See https://github.com/jashkenas/underscore/pull/1247\n      // for more details.\n      //\n      // This also ensures a stable sort in V8 and other engines.\n      // See https://bugs.chromium.org/p/v8/issues/detail?id=90 for more details.\n      return object.index - other.index;\n    }\n\n    /**\n     * Creates an array that is the composition of partially applied arguments,\n     * placeholders, and provided arguments into a single array of arguments.\n     *\n     * @private\n     * @param {Array} args The provided arguments.\n     * @param {Array} partials The arguments to prepend to those provided.\n     * @param {Array} holders The `partials` placeholder indexes.\n     * @params {boolean} [isCurried] Specify composing for a curried function.\n     * @returns {Array} Returns the new array of composed arguments.\n     */\n    function composeArgs(args, partials, holders, isCurried) {\n      var argsIndex = -1,\n          argsLength = args.length,\n          holdersLength = holders.length,\n          leftIndex = -1,\n          leftLength = partials.length,\n          rangeLength = nativeMax(argsLength - holdersLength, 0),\n          result = Array(leftLength + rangeLength),\n          isUncurried = !isCurried;\n\n      while (++leftIndex < leftLength) {\n        result[leftIndex] = partials[leftIndex];\n      }\n      while (++argsIndex < holdersLength) {\n        if (isUncurried || argsIndex < argsLength) {\n          result[holders[argsIndex]] = args[argsIndex];\n        }\n      }\n      while (rangeLength--) {\n        result[leftIndex++] = args[argsIndex++];\n      }\n      return result;\n    }\n\n    /**\n     * This function is like `composeArgs` except that the arguments composition\n     * is tailored for `_.partialRight`.\n     *\n     * @private\n     * @param {Array} args The provided arguments.\n     * @param {Array} partials The arguments to append to those provided.\n     * @param {Array} holders The `partials` placeholder indexes.\n     * @params {boolean} [isCurried] Specify composing for a curried function.\n     * @returns {Array} Returns the new array of composed arguments.\n     */\n    function composeArgsRight(args, partials, holders, isCurried) {\n      var argsIndex = -1,\n          argsLength = args.length,\n          holdersIndex = -1,\n          holdersLength = holders.length,\n          rightIndex = -1,\n          rightLength = partials.length,\n          rangeLength = nativeMax(argsLength - holdersLength, 0),\n          result = Array(rangeLength + rightLength),\n          isUncurried = !isCurried;\n\n      while (++argsIndex < rangeLength) {\n        result[argsIndex] = args[argsIndex];\n      }\n      var offset = argsIndex;\n      while (++rightIndex < rightLength) {\n        result[offset + rightIndex] = partials[rightIndex];\n      }\n      while (++holdersIndex < holdersLength) {\n        if (isUncurried || argsIndex < argsLength) {\n          result[offset + holders[holdersIndex]] = args[argsIndex++];\n        }\n      }\n      return result;\n    }\n\n    /**\n     * Copies the values of `source` to `array`.\n     *\n     * @private\n     * @param {Array} source The array to copy values from.\n     * @param {Array} [array=[]] The array to copy values to.\n     * @returns {Array} Returns `array`.\n     */\n    function copyArray(source, array) {\n      var index = -1,\n          length = source.length;\n\n      array || (array = Array(length));\n      while (++index < length) {\n        array[index] = source[index];\n      }\n      return array;\n    }\n\n    /**\n     * Copies properties of `source` to `object`.\n     *\n     * @private\n     * @param {Object} source The object to copy properties from.\n     * @param {Array} props The property identifiers to copy.\n     * @param {Object} [object={}] The object to copy properties to.\n     * @param {Function} [customizer] The function to customize copied values.\n     * @returns {Object} Returns `object`.\n     */\n    function copyObject(source, props, object, customizer) {\n      var isNew = !object;\n      object || (object = {});\n\n      var index = -1,\n          length = props.length;\n\n      while (++index < length) {\n        var key = props[index];\n\n        var newValue = customizer\n          ? customizer(object[key], source[key], key, object, source)\n          : undefined;\n\n        if (newValue === undefined) {\n          newValue = source[key];\n        }\n        if (isNew) {\n          baseAssignValue(object, key, newValue);\n        } else {\n          assignValue(object, key, newValue);\n        }\n      }\n      return object;\n    }\n\n    /**\n     * Copies own symbols of `source` to `object`.\n     *\n     * @private\n     * @param {Object} source The object to copy symbols from.\n     * @param {Object} [object={}] The object to copy symbols to.\n     * @returns {Object} Returns `object`.\n     */\n    function copySymbols(source, object) {\n      return copyObject(source, getSymbols(source), object);\n    }\n\n    /**\n     * Copies own and inherited symbols of `source` to `object`.\n     *\n     * @private\n     * @param {Object} source The object to copy symbols from.\n     * @param {Object} [object={}] The object to copy symbols to.\n     * @returns {Object} Returns `object`.\n     */\n    function copySymbolsIn(source, object) {\n      return copyObject(source, getSymbolsIn(source), object);\n    }\n\n    /**\n     * Creates a function like `_.groupBy`.\n     *\n     * @private\n     * @param {Function} setter The function to set accumulator values.\n     * @param {Function} [initializer] The accumulator object initializer.\n     * @returns {Function} Returns the new aggregator function.\n     */\n    function createAggregator(setter, initializer) {\n      return function(collection, iteratee) {\n        var func = isArray(collection) ? arrayAggregator : baseAggregator,\n            accumulator = initializer ? initializer() : {};\n\n        return func(collection, setter, getIteratee(iteratee, 2), accumulator);\n      };\n    }\n\n    /**\n     * Creates a function like `_.assign`.\n     *\n     * @private\n     * @param {Function} assigner The function to assign values.\n     * @returns {Function} Returns the new assigner function.\n     */\n    function createAssigner(assigner) {\n      return baseRest(function(object, sources) {\n        var index = -1,\n            length = sources.length,\n            customizer = length > 1 ? sources[length - 1] : undefined,\n            guard = length > 2 ? sources[2] : undefined;\n\n        customizer = (assigner.length > 3 && typeof customizer == 'function')\n          ? (length--, customizer)\n          : undefined;\n\n        if (guard && isIterateeCall(sources[0], sources[1], guard)) {\n          customizer = length < 3 ? undefined : customizer;\n          length = 1;\n        }\n        object = Object(object);\n        while (++index < length) {\n          var source = sources[index];\n          if (source) {\n            assigner(object, source, index, customizer);\n          }\n        }\n        return object;\n      });\n    }\n\n    /**\n     * Creates a `baseEach` or `baseEachRight` function.\n     *\n     * @private\n     * @param {Function} eachFunc The function to iterate over a collection.\n     * @param {boolean} [fromRight] Specify iterating from right to left.\n     * @returns {Function} Returns the new base function.\n     */\n    function createBaseEach(eachFunc, fromRight) {\n      return function(collection, iteratee) {\n        if (collection == null) {\n          return collection;\n        }\n        if (!isArrayLike(collection)) {\n          return eachFunc(collection, iteratee);\n        }\n        var length = collection.length,\n            index = fromRight ? length : -1,\n            iterable = Object(collection);\n\n        while ((fromRight ? index-- : ++index < length)) {\n          if (iteratee(iterable[index], index, iterable) === false) {\n            break;\n          }\n        }\n        return collection;\n      };\n    }\n\n    /**\n     * Creates a base function for methods like `_.forIn` and `_.forOwn`.\n     *\n     * @private\n     * @param {boolean} [fromRight] Specify iterating from right to left.\n     * @returns {Function} Returns the new base function.\n     */\n    function createBaseFor(fromRight) {\n      return function(object, iteratee, keysFunc) {\n        var index = -1,\n            iterable = Object(object),\n            props = keysFunc(object),\n            length = props.length;\n\n        while (length--) {\n          var key = props[fromRight ? length : ++index];\n          if (iteratee(iterable[key], key, iterable) === false) {\n            break;\n          }\n        }\n        return object;\n      };\n    }\n\n    /**\n     * Creates a function that wraps `func` to invoke it with the optional `this`\n     * binding of `thisArg`.\n     *\n     * @private\n     * @param {Function} func The function to wrap.\n     * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n     * @param {*} [thisArg] The `this` binding of `func`.\n     * @returns {Function} Returns the new wrapped function.\n     */\n    function createBind(func, bitmask, thisArg) {\n      var isBind = bitmask & WRAP_BIND_FLAG,\n          Ctor = createCtor(func);\n\n      function wrapper() {\n        var fn = (this && this !== root && this instanceof wrapper) ? Ctor : func;\n        return fn.apply(isBind ? thisArg : this, arguments);\n      }\n      return wrapper;\n    }\n\n    /**\n     * Creates a function like `_.lowerFirst`.\n     *\n     * @private\n     * @param {string} methodName The name of the `String` case method to use.\n     * @returns {Function} Returns the new case function.\n     */\n    function createCaseFirst(methodName) {\n      return function(string) {\n        string = toString(string);\n\n        var strSymbols = hasUnicode(string)\n          ? stringToArray(string)\n          : undefined;\n\n        var chr = strSymbols\n          ? strSymbols[0]\n          : string.charAt(0);\n\n        var trailing = strSymbols\n          ? castSlice(strSymbols, 1).join('')\n          : string.slice(1);\n\n        return chr[methodName]() + trailing;\n      };\n    }\n\n    /**\n     * Creates a function like `_.camelCase`.\n     *\n     * @private\n     * @param {Function} callback The function to combine each word.\n     * @returns {Function} Returns the new compounder function.\n     */\n    function createCompounder(callback) {\n      return function(string) {\n        return arrayReduce(words(deburr(string).replace(reApos, '')), callback, '');\n      };\n    }\n\n    /**\n     * Creates a function that produces an instance of `Ctor` regardless of\n     * whether it was invoked as part of a `new` expression or by `call` or `apply`.\n     *\n     * @private\n     * @param {Function} Ctor The constructor to wrap.\n     * @returns {Function} Returns the new wrapped function.\n     */\n    function createCtor(Ctor) {\n      return function() {\n        // Use a `switch` statement to work with class constructors. See\n        // http://ecma-international.org/ecma-262/7.0/#sec-ecmascript-function-objects-call-thisargument-argumentslist\n        // for more details.\n        var args = arguments;\n        switch (args.length) {\n          case 0: return new Ctor;\n          case 1: return new Ctor(args[0]);\n          case 2: return new Ctor(args[0], args[1]);\n          case 3: return new Ctor(args[0], args[1], args[2]);\n          case 4: return new Ctor(args[0], args[1], args[2], args[3]);\n          case 5: return new Ctor(args[0], args[1], args[2], args[3], args[4]);\n          case 6: return new Ctor(args[0], args[1], args[2], args[3], args[4], args[5]);\n          case 7: return new Ctor(args[0], args[1], args[2], args[3], args[4], args[5], args[6]);\n        }\n        var thisBinding = baseCreate(Ctor.prototype),\n            result = Ctor.apply(thisBinding, args);\n\n        // Mimic the constructor's `return` behavior.\n        // See https://es5.github.io/#x13.2.2 for more details.\n        return isObject(result) ? result : thisBinding;\n      };\n    }\n\n    /**\n     * Creates a function that wraps `func` to enable currying.\n     *\n     * @private\n     * @param {Function} func The function to wrap.\n     * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n     * @param {number} arity The arity of `func`.\n     * @returns {Function} Returns the new wrapped function.\n     */\n    function createCurry(func, bitmask, arity) {\n      var Ctor = createCtor(func);\n\n      function wrapper() {\n        var length = arguments.length,\n            args = Array(length),\n            index = length,\n            placeholder = getHolder(wrapper);\n\n        while (index--) {\n          args[index] = arguments[index];\n        }\n        var holders = (length < 3 && args[0] !== placeholder && args[length - 1] !== placeholder)\n          ? []\n          : replaceHolders(args, placeholder);\n\n        length -= holders.length;\n        if (length < arity) {\n          return createRecurry(\n            func, bitmask, createHybrid, wrapper.placeholder, undefined,\n            args, holders, undefined, undefined, arity - length);\n        }\n        var fn = (this && this !== root && this instanceof wrapper) ? Ctor : func;\n        return apply(fn, this, args);\n      }\n      return wrapper;\n    }\n\n    /**\n     * Creates a `_.find` or `_.findLast` function.\n     *\n     * @private\n     * @param {Function} findIndexFunc The function to find the collection index.\n     * @returns {Function} Returns the new find function.\n     */\n    function createFind(findIndexFunc) {\n      return function(collection, predicate, fromIndex) {\n        var iterable = Object(collection);\n        if (!isArrayLike(collection)) {\n          var iteratee = getIteratee(predicate, 3);\n          collection = keys(collection);\n          predicate = function(key) { return iteratee(iterable[key], key, iterable); };\n        }\n        var index = findIndexFunc(collection, predicate, fromIndex);\n        return index > -1 ? iterable[iteratee ? collection[index] : index] : undefined;\n      };\n    }\n\n    /**\n     * Creates a `_.flow` or `_.flowRight` function.\n     *\n     * @private\n     * @param {boolean} [fromRight] Specify iterating from right to left.\n     * @returns {Function} Returns the new flow function.\n     */\n    function createFlow(fromRight) {\n      return flatRest(function(funcs) {\n        var length = funcs.length,\n            index = length,\n            prereq = LodashWrapper.prototype.thru;\n\n        if (fromRight) {\n          funcs.reverse();\n        }\n        while (index--) {\n          var func = funcs[index];\n          if (typeof func != 'function') {\n            throw new TypeError(FUNC_ERROR_TEXT);\n          }\n          if (prereq && !wrapper && getFuncName(func) == 'wrapper') {\n            var wrapper = new LodashWrapper([], true);\n          }\n        }\n        index = wrapper ? index : length;\n        while (++index < length) {\n          func = funcs[index];\n\n          var funcName = getFuncName(func),\n              data = funcName == 'wrapper' ? getData(func) : undefined;\n\n          if (data && isLaziable(data[0]) &&\n                data[1] == (WRAP_ARY_FLAG | WRAP_CURRY_FLAG | WRAP_PARTIAL_FLAG | WRAP_REARG_FLAG) &&\n                !data[4].length && data[9] == 1\n              ) {\n            wrapper = wrapper[getFuncName(data[0])].apply(wrapper, data[3]);\n          } else {\n            wrapper = (func.length == 1 && isLaziable(func))\n              ? wrapper[funcName]()\n              : wrapper.thru(func);\n          }\n        }\n        return function() {\n          var args = arguments,\n              value = args[0];\n\n          if (wrapper && args.length == 1 && isArray(value)) {\n            return wrapper.plant(value).value();\n          }\n          var index = 0,\n              result = length ? funcs[index].apply(this, args) : value;\n\n          while (++index < length) {\n            result = funcs[index].call(this, result);\n          }\n          return result;\n        };\n      });\n    }\n\n    /**\n     * Creates a function that wraps `func` to invoke it with optional `this`\n     * binding of `thisArg`, partial application, and currying.\n     *\n     * @private\n     * @param {Function|string} func The function or method name to wrap.\n     * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n     * @param {*} [thisArg] The `this` binding of `func`.\n     * @param {Array} [partials] The arguments to prepend to those provided to\n     *  the new function.\n     * @param {Array} [holders] The `partials` placeholder indexes.\n     * @param {Array} [partialsRight] The arguments to append to those provided\n     *  to the new function.\n     * @param {Array} [holdersRight] The `partialsRight` placeholder indexes.\n     * @param {Array} [argPos] The argument positions of the new function.\n     * @param {number} [ary] The arity cap of `func`.\n     * @param {number} [arity] The arity of `func`.\n     * @returns {Function} Returns the new wrapped function.\n     */\n    function createHybrid(func, bitmask, thisArg, partials, holders, partialsRight, holdersRight, argPos, ary, arity) {\n      var isAry = bitmask & WRAP_ARY_FLAG,\n          isBind = bitmask & WRAP_BIND_FLAG,\n          isBindKey = bitmask & WRAP_BIND_KEY_FLAG,\n          isCurried = bitmask & (WRAP_CURRY_FLAG | WRAP_CURRY_RIGHT_FLAG),\n          isFlip = bitmask & WRAP_FLIP_FLAG,\n          Ctor = isBindKey ? undefined : createCtor(func);\n\n      function wrapper() {\n        var length = arguments.length,\n            args = Array(length),\n            index = length;\n\n        while (index--) {\n          args[index] = arguments[index];\n        }\n        if (isCurried) {\n          var placeholder = getHolder(wrapper),\n              holdersCount = countHolders(args, placeholder);\n        }\n        if (partials) {\n          args = composeArgs(args, partials, holders, isCurried);\n        }\n        if (partialsRight) {\n          args = composeArgsRight(args, partialsRight, holdersRight, isCurried);\n        }\n        length -= holdersCount;\n        if (isCurried && length < arity) {\n          var newHolders = replaceHolders(args, placeholder);\n          return createRecurry(\n            func, bitmask, createHybrid, wrapper.placeholder, thisArg,\n            args, newHolders, argPos, ary, arity - length\n          );\n        }\n        var thisBinding = isBind ? thisArg : this,\n            fn = isBindKey ? thisBinding[func] : func;\n\n        length = args.length;\n        if (argPos) {\n          args = reorder(args, argPos);\n        } else if (isFlip && length > 1) {\n          args.reverse();\n        }\n        if (isAry && ary < length) {\n          args.length = ary;\n        }\n        if (this && this !== root && this instanceof wrapper) {\n          fn = Ctor || createCtor(fn);\n        }\n        return fn.apply(thisBinding, args);\n      }\n      return wrapper;\n    }\n\n    /**\n     * Creates a function like `_.invertBy`.\n     *\n     * @private\n     * @param {Function} setter The function to set accumulator values.\n     * @param {Function} toIteratee The function to resolve iteratees.\n     * @returns {Function} Returns the new inverter function.\n     */\n    function createInverter(setter, toIteratee) {\n      return function(object, iteratee) {\n        return baseInverter(object, setter, toIteratee(iteratee), {});\n      };\n    }\n\n    /**\n     * Creates a function that performs a mathematical operation on two values.\n     *\n     * @private\n     * @param {Function} operator The function to perform the operation.\n     * @param {number} [defaultValue] The value used for `undefined` arguments.\n     * @returns {Function} Returns the new mathematical operation function.\n     */\n    function createMathOperation(operator, defaultValue) {\n      return function(value, other) {\n        var result;\n        if (value === undefined && other === undefined) {\n          return defaultValue;\n        }\n        if (value !== undefined) {\n          result = value;\n        }\n        if (other !== undefined) {\n          if (result === undefined) {\n            return other;\n          }\n          if (typeof value == 'string' || typeof other == 'string') {\n            value = baseToString(value);\n            other = baseToString(other);\n          } else {\n            value = baseToNumber(value);\n            other = baseToNumber(other);\n          }\n          result = operator(value, other);\n        }\n        return result;\n      };\n    }\n\n    /**\n     * Creates a function like `_.over`.\n     *\n     * @private\n     * @param {Function} arrayFunc The function to iterate over iteratees.\n     * @returns {Function} Returns the new over function.\n     */\n    function createOver(arrayFunc) {\n      return flatRest(function(iteratees) {\n        iteratees = arrayMap(iteratees, baseUnary(getIteratee()));\n        return baseRest(function(args) {\n          var thisArg = this;\n          return arrayFunc(iteratees, function(iteratee) {\n            return apply(iteratee, thisArg, args);\n          });\n        });\n      });\n    }\n\n    /**\n     * Creates the padding for `string` based on `length`. The `chars` string\n     * is truncated if the number of characters exceeds `length`.\n     *\n     * @private\n     * @param {number} length The padding length.\n     * @param {string} [chars=' '] The string used as padding.\n     * @returns {string} Returns the padding for `string`.\n     */\n    function createPadding(length, chars) {\n      chars = chars === undefined ? ' ' : baseToString(chars);\n\n      var charsLength = chars.length;\n      if (charsLength < 2) {\n        return charsLength ? baseRepeat(chars, length) : chars;\n      }\n      var result = baseRepeat(chars, nativeCeil(length / stringSize(chars)));\n      return hasUnicode(chars)\n        ? castSlice(stringToArray(result), 0, length).join('')\n        : result.slice(0, length);\n    }\n\n    /**\n     * Creates a function that wraps `func` to invoke it with the `this` binding\n     * of `thisArg` and `partials` prepended to the arguments it receives.\n     *\n     * @private\n     * @param {Function} func The function to wrap.\n     * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n     * @param {*} thisArg The `this` binding of `func`.\n     * @param {Array} partials The arguments to prepend to those provided to\n     *  the new function.\n     * @returns {Function} Returns the new wrapped function.\n     */\n    function createPartial(func, bitmask, thisArg, partials) {\n      var isBind = bitmask & WRAP_BIND_FLAG,\n          Ctor = createCtor(func);\n\n      function wrapper() {\n        var argsIndex = -1,\n            argsLength = arguments.length,\n            leftIndex = -1,\n            leftLength = partials.length,\n            args = Array(leftLength + argsLength),\n            fn = (this && this !== root && this instanceof wrapper) ? Ctor : func;\n\n        while (++leftIndex < leftLength) {\n          args[leftIndex] = partials[leftIndex];\n        }\n        while (argsLength--) {\n          args[leftIndex++] = arguments[++argsIndex];\n        }\n        return apply(fn, isBind ? thisArg : this, args);\n      }\n      return wrapper;\n    }\n\n    /**\n     * Creates a `_.range` or `_.rangeRight` function.\n     *\n     * @private\n     * @param {boolean} [fromRight] Specify iterating from right to left.\n     * @returns {Function} Returns the new range function.\n     */\n    function createRange(fromRight) {\n      return function(start, end, step) {\n        if (step && typeof step != 'number' && isIterateeCall(start, end, step)) {\n          end = step = undefined;\n        }\n        // Ensure the sign of `-0` is preserved.\n        start = toFinite(start);\n        if (end === undefined) {\n          end = start;\n          start = 0;\n        } else {\n          end = toFinite(end);\n        }\n        step = step === undefined ? (start < end ? 1 : -1) : toFinite(step);\n        return baseRange(start, end, step, fromRight);\n      };\n    }\n\n    /**\n     * Creates a function that performs a relational operation on two values.\n     *\n     * @private\n     * @param {Function} operator The function to perform the operation.\n     * @returns {Function} Returns the new relational operation function.\n     */\n    function createRelationalOperation(operator) {\n      return function(value, other) {\n        if (!(typeof value == 'string' && typeof other == 'string')) {\n          value = toNumber(value);\n          other = toNumber(other);\n        }\n        return operator(value, other);\n      };\n    }\n\n    /**\n     * Creates a function that wraps `func` to continue currying.\n     *\n     * @private\n     * @param {Function} func The function to wrap.\n     * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n     * @param {Function} wrapFunc The function to create the `func` wrapper.\n     * @param {*} placeholder The placeholder value.\n     * @param {*} [thisArg] The `this` binding of `func`.\n     * @param {Array} [partials] The arguments to prepend to those provided to\n     *  the new function.\n     * @param {Array} [holders] The `partials` placeholder indexes.\n     * @param {Array} [argPos] The argument positions of the new function.\n     * @param {number} [ary] The arity cap of `func`.\n     * @param {number} [arity] The arity of `func`.\n     * @returns {Function} Returns the new wrapped function.\n     */\n    function createRecurry(func, bitmask, wrapFunc, placeholder, thisArg, partials, holders, argPos, ary, arity) {\n      var isCurry = bitmask & WRAP_CURRY_FLAG,\n          newHolders = isCurry ? holders : undefined,\n          newHoldersRight = isCurry ? undefined : holders,\n          newPartials = isCurry ? partials : undefined,\n          newPartialsRight = isCurry ? undefined : partials;\n\n      bitmask |= (isCurry ? WRAP_PARTIAL_FLAG : WRAP_PARTIAL_RIGHT_FLAG);\n      bitmask &= ~(isCurry ? WRAP_PARTIAL_RIGHT_FLAG : WRAP_PARTIAL_FLAG);\n\n      if (!(bitmask & WRAP_CURRY_BOUND_FLAG)) {\n        bitmask &= ~(WRAP_BIND_FLAG | WRAP_BIND_KEY_FLAG);\n      }\n      var newData = [\n        func, bitmask, thisArg, newPartials, newHolders, newPartialsRight,\n        newHoldersRight, argPos, ary, arity\n      ];\n\n      var result = wrapFunc.apply(undefined, newData);\n      if (isLaziable(func)) {\n        setData(result, newData);\n      }\n      result.placeholder = placeholder;\n      return setWrapToString(result, func, bitmask);\n    }\n\n    /**\n     * Creates a function like `_.round`.\n     *\n     * @private\n     * @param {string} methodName The name of the `Math` method to use when rounding.\n     * @returns {Function} Returns the new round function.\n     */\n    function createRound(methodName) {\n      var func = Math[methodName];\n      return function(number, precision) {\n        number = toNumber(number);\n        precision = precision == null ? 0 : nativeMin(toInteger(precision), 292);\n        if (precision) {\n          // Shift with exponential notation to avoid floating-point issues.\n          // See [MDN](https://mdn.io/round#Examples) for more details.\n          var pair = (toString(number) + 'e').split('e'),\n              value = func(pair[0] + 'e' + (+pair[1] + precision));\n\n          pair = (toString(value) + 'e').split('e');\n          return +(pair[0] + 'e' + (+pair[1] - precision));\n        }\n        return func(number);\n      };\n    }\n\n    /**\n     * Creates a set object of `values`.\n     *\n     * @private\n     * @param {Array} values The values to add to the set.\n     * @returns {Object} Returns the new set.\n     */\n    var createSet = !(Set && (1 / setToArray(new Set([,-0]))[1]) == INFINITY) ? noop : function(values) {\n      return new Set(values);\n    };\n\n    /**\n     * Creates a `_.toPairs` or `_.toPairsIn` function.\n     *\n     * @private\n     * @param {Function} keysFunc The function to get the keys of a given object.\n     * @returns {Function} Returns the new pairs function.\n     */\n    function createToPairs(keysFunc) {\n      return function(object) {\n        var tag = getTag(object);\n        if (tag == mapTag) {\n          return mapToArray(object);\n        }\n        if (tag == setTag) {\n          return setToPairs(object);\n        }\n        return baseToPairs(object, keysFunc(object));\n      };\n    }\n\n    /**\n     * Creates a function that either curries or invokes `func` with optional\n     * `this` binding and partially applied arguments.\n     *\n     * @private\n     * @param {Function|string} func The function or method name to wrap.\n     * @param {number} bitmask The bitmask flags.\n     *    1 - `_.bind`\n     *    2 - `_.bindKey`\n     *    4 - `_.curry` or `_.curryRight` of a bound function\n     *    8 - `_.curry`\n     *   16 - `_.curryRight`\n     *   32 - `_.partial`\n     *   64 - `_.partialRight`\n     *  128 - `_.rearg`\n     *  256 - `_.ary`\n     *  512 - `_.flip`\n     * @param {*} [thisArg] The `this` binding of `func`.\n     * @param {Array} [partials] The arguments to be partially applied.\n     * @param {Array} [holders] The `partials` placeholder indexes.\n     * @param {Array} [argPos] The argument positions of the new function.\n     * @param {number} [ary] The arity cap of `func`.\n     * @param {number} [arity] The arity of `func`.\n     * @returns {Function} Returns the new wrapped function.\n     */\n    function createWrap(func, bitmask, thisArg, partials, holders, argPos, ary, arity) {\n      var isBindKey = bitmask & WRAP_BIND_KEY_FLAG;\n      if (!isBindKey && typeof func != 'function') {\n        throw new TypeError(FUNC_ERROR_TEXT);\n      }\n      var length = partials ? partials.length : 0;\n      if (!length) {\n        bitmask &= ~(WRAP_PARTIAL_FLAG | WRAP_PARTIAL_RIGHT_FLAG);\n        partials = holders = undefined;\n      }\n      ary = ary === undefined ? ary : nativeMax(toInteger(ary), 0);\n      arity = arity === undefined ? arity : toInteger(arity);\n      length -= holders ? holders.length : 0;\n\n      if (bitmask & WRAP_PARTIAL_RIGHT_FLAG) {\n        var partialsRight = partials,\n            holdersRight = holders;\n\n        partials = holders = undefined;\n      }\n      var data = isBindKey ? undefined : getData(func);\n\n      var newData = [\n        func, bitmask, thisArg, partials, holders, partialsRight, holdersRight,\n        argPos, ary, arity\n      ];\n\n      if (data) {\n        mergeData(newData, data);\n      }\n      func = newData[0];\n      bitmask = newData[1];\n      thisArg = newData[2];\n      partials = newData[3];\n      holders = newData[4];\n      arity = newData[9] = newData[9] === undefined\n        ? (isBindKey ? 0 : func.length)\n        : nativeMax(newData[9] - length, 0);\n\n      if (!arity && bitmask & (WRAP_CURRY_FLAG | WRAP_CURRY_RIGHT_FLAG)) {\n        bitmask &= ~(WRAP_CURRY_FLAG | WRAP_CURRY_RIGHT_FLAG);\n      }\n      if (!bitmask || bitmask == WRAP_BIND_FLAG) {\n        var result = createBind(func, bitmask, thisArg);\n      } else if (bitmask == WRAP_CURRY_FLAG || bitmask == WRAP_CURRY_RIGHT_FLAG) {\n        result = createCurry(func, bitmask, arity);\n      } else if ((bitmask == WRAP_PARTIAL_FLAG || bitmask == (WRAP_BIND_FLAG | WRAP_PARTIAL_FLAG)) && !holders.length) {\n        result = createPartial(func, bitmask, thisArg, partials);\n      } else {\n        result = createHybrid.apply(undefined, newData);\n      }\n      var setter = data ? baseSetData : setData;\n      return setWrapToString(setter(result, newData), func, bitmask);\n    }\n\n    /**\n     * Used by `_.defaults` to customize its `_.assignIn` use to assign properties\n     * of source objects to the destination object for all destination properties\n     * that resolve to `undefined`.\n     *\n     * @private\n     * @param {*} objValue The destination value.\n     * @param {*} srcValue The source value.\n     * @param {string} key The key of the property to assign.\n     * @param {Object} object The parent object of `objValue`.\n     * @returns {*} Returns the value to assign.\n     */\n    function customDefaultsAssignIn(objValue, srcValue, key, object) {\n      if (objValue === undefined ||\n          (eq(objValue, objectProto[key]) && !hasOwnProperty.call(object, key))) {\n        return srcValue;\n      }\n      return objValue;\n    }\n\n    /**\n     * Used by `_.defaultsDeep` to customize its `_.merge` use to merge source\n     * objects into destination objects that are passed thru.\n     *\n     * @private\n     * @param {*} objValue The destination value.\n     * @param {*} srcValue The source value.\n     * @param {string} key The key of the property to merge.\n     * @param {Object} object The parent object of `objValue`.\n     * @param {Object} source The parent object of `srcValue`.\n     * @param {Object} [stack] Tracks traversed source values and their merged\n     *  counterparts.\n     * @returns {*} Returns the value to assign.\n     */\n    function customDefaultsMerge(objValue, srcValue, key, object, source, stack) {\n      if (isObject(objValue) && isObject(srcValue)) {\n        // Recursively merge objects and arrays (susceptible to call stack limits).\n        stack.set(srcValue, objValue);\n        baseMerge(objValue, srcValue, undefined, customDefaultsMerge, stack);\n        stack['delete'](srcValue);\n      }\n      return objValue;\n    }\n\n    /**\n     * Used by `_.omit` to customize its `_.cloneDeep` use to only clone plain\n     * objects.\n     *\n     * @private\n     * @param {*} value The value to inspect.\n     * @param {string} key The key of the property to inspect.\n     * @returns {*} Returns the uncloned value or `undefined` to defer cloning to `_.cloneDeep`.\n     */\n    function customOmitClone(value) {\n      return isPlainObject(value) ? undefined : value;\n    }\n\n    /**\n     * A specialized version of `baseIsEqualDeep` for arrays with support for\n     * partial deep comparisons.\n     *\n     * @private\n     * @param {Array} array The array to compare.\n     * @param {Array} other The other array to compare.\n     * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n     * @param {Function} customizer The function to customize comparisons.\n     * @param {Function} equalFunc The function to determine equivalents of values.\n     * @param {Object} stack Tracks traversed `array` and `other` objects.\n     * @returns {boolean} Returns `true` if the arrays are equivalent, else `false`.\n     */\n    function equalArrays(array, other, bitmask, customizer, equalFunc, stack) {\n      var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n          arrLength = array.length,\n          othLength = other.length;\n\n      if (arrLength != othLength && !(isPartial && othLength > arrLength)) {\n        return false;\n      }\n      // Assume cyclic values are equal.\n      var stacked = stack.get(array);\n      if (stacked && stack.get(other)) {\n        return stacked == other;\n      }\n      var index = -1,\n          result = true,\n          seen = (bitmask & COMPARE_UNORDERED_FLAG) ? new SetCache : undefined;\n\n      stack.set(array, other);\n      stack.set(other, array);\n\n      // Ignore non-index properties.\n      while (++index < arrLength) {\n        var arrValue = array[index],\n            othValue = other[index];\n\n        if (customizer) {\n          var compared = isPartial\n            ? customizer(othValue, arrValue, index, other, array, stack)\n            : customizer(arrValue, othValue, index, array, other, stack);\n        }\n        if (compared !== undefined) {\n          if (compared) {\n            continue;\n          }\n          result = false;\n          break;\n        }\n        // Recursively compare arrays (susceptible to call stack limits).\n        if (seen) {\n          if (!arraySome(other, function(othValue, othIndex) {\n                if (!cacheHas(seen, othIndex) &&\n                    (arrValue === othValue || equalFunc(arrValue, othValue, bitmask, customizer, stack))) {\n                  return seen.push(othIndex);\n                }\n              })) {\n            result = false;\n            break;\n          }\n        } else if (!(\n              arrValue === othValue ||\n                equalFunc(arrValue, othValue, bitmask, customizer, stack)\n            )) {\n          result = false;\n          break;\n        }\n      }\n      stack['delete'](array);\n      stack['delete'](other);\n      return result;\n    }\n\n    /**\n     * A specialized version of `baseIsEqualDeep` for comparing objects of\n     * the same `toStringTag`.\n     *\n     * **Note:** This function only supports comparing values with tags of\n     * `Boolean`, `Date`, `Error`, `Number`, `RegExp`, or `String`.\n     *\n     * @private\n     * @param {Object} object The object to compare.\n     * @param {Object} other The other object to compare.\n     * @param {string} tag The `toStringTag` of the objects to compare.\n     * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n     * @param {Function} customizer The function to customize comparisons.\n     * @param {Function} equalFunc The function to determine equivalents of values.\n     * @param {Object} stack Tracks traversed `object` and `other` objects.\n     * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n     */\n    function equalByTag(object, other, tag, bitmask, customizer, equalFunc, stack) {\n      switch (tag) {\n        case dataViewTag:\n          if ((object.byteLength != other.byteLength) ||\n              (object.byteOffset != other.byteOffset)) {\n            return false;\n          }\n          object = object.buffer;\n          other = other.buffer;\n\n        case arrayBufferTag:\n          if ((object.byteLength != other.byteLength) ||\n              !equalFunc(new Uint8Array(object), new Uint8Array(other))) {\n            return false;\n          }\n          return true;\n\n        case boolTag:\n        case dateTag:\n        case numberTag:\n          // Coerce booleans to `1` or `0` and dates to milliseconds.\n          // Invalid dates are coerced to `NaN`.\n          return eq(+object, +other);\n\n        case errorTag:\n          return object.name == other.name && object.message == other.message;\n\n        case regexpTag:\n        case stringTag:\n          // Coerce regexes to strings and treat strings, primitives and objects,\n          // as equal. See http://www.ecma-international.org/ecma-262/7.0/#sec-regexp.prototype.tostring\n          // for more details.\n          return object == (other + '');\n\n        case mapTag:\n          var convert = mapToArray;\n\n        case setTag:\n          var isPartial = bitmask & COMPARE_PARTIAL_FLAG;\n          convert || (convert = setToArray);\n\n          if (object.size != other.size && !isPartial) {\n            return false;\n          }\n          // Assume cyclic values are equal.\n          var stacked = stack.get(object);\n          if (stacked) {\n            return stacked == other;\n          }\n          bitmask |= COMPARE_UNORDERED_FLAG;\n\n          // Recursively compare objects (susceptible to call stack limits).\n          stack.set(object, other);\n          var result = equalArrays(convert(object), convert(other), bitmask, customizer, equalFunc, stack);\n          stack['delete'](object);\n          return result;\n\n        case symbolTag:\n          if (symbolValueOf) {\n            return symbolValueOf.call(object) == symbolValueOf.call(other);\n          }\n      }\n      return false;\n    }\n\n    /**\n     * A specialized version of `baseIsEqualDeep` for objects with support for\n     * partial deep comparisons.\n     *\n     * @private\n     * @param {Object} object The object to compare.\n     * @param {Object} other The other object to compare.\n     * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n     * @param {Function} customizer The function to customize comparisons.\n     * @param {Function} equalFunc The function to determine equivalents of values.\n     * @param {Object} stack Tracks traversed `object` and `other` objects.\n     * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n     */\n    function equalObjects(object, other, bitmask, customizer, equalFunc, stack) {\n      var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n          objProps = getAllKeys(object),\n          objLength = objProps.length,\n          othProps = getAllKeys(other),\n          othLength = othProps.length;\n\n      if (objLength != othLength && !isPartial) {\n        return false;\n      }\n      var index = objLength;\n      while (index--) {\n        var key = objProps[index];\n        if (!(isPartial ? key in other : hasOwnProperty.call(other, key))) {\n          return false;\n        }\n      }\n      // Assume cyclic values are equal.\n      var stacked = stack.get(object);\n      if (stacked && stack.get(other)) {\n        return stacked == other;\n      }\n      var result = true;\n      stack.set(object, other);\n      stack.set(other, object);\n\n      var skipCtor = isPartial;\n      while (++index < objLength) {\n        key = objProps[index];\n        var objValue = object[key],\n            othValue = other[key];\n\n        if (customizer) {\n          var compared = isPartial\n            ? customizer(othValue, objValue, key, other, object, stack)\n            : customizer(objValue, othValue, key, object, other, stack);\n        }\n        // Recursively compare objects (susceptible to call stack limits).\n        if (!(compared === undefined\n              ? (objValue === othValue || equalFunc(objValue, othValue, bitmask, customizer, stack))\n              : compared\n            )) {\n          result = false;\n          break;\n        }\n        skipCtor || (skipCtor = key == 'constructor');\n      }\n      if (result && !skipCtor) {\n        var objCtor = object.constructor,\n            othCtor = other.constructor;\n\n        // Non `Object` object instances with different constructors are not equal.\n        if (objCtor != othCtor &&\n            ('constructor' in object && 'constructor' in other) &&\n            !(typeof objCtor == 'function' && objCtor instanceof objCtor &&\n              typeof othCtor == 'function' && othCtor instanceof othCtor)) {\n          result = false;\n        }\n      }\n      stack['delete'](object);\n      stack['delete'](other);\n      return result;\n    }\n\n    /**\n     * A specialized version of `baseRest` which flattens the rest array.\n     *\n     * @private\n     * @param {Function} func The function to apply a rest parameter to.\n     * @returns {Function} Returns the new function.\n     */\n    function flatRest(func) {\n      return setToString(overRest(func, undefined, flatten), func + '');\n    }\n\n    /**\n     * Creates an array of own enumerable property names and symbols of `object`.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of property names and symbols.\n     */\n    function getAllKeys(object) {\n      return baseGetAllKeys(object, keys, getSymbols);\n    }\n\n    /**\n     * Creates an array of own and inherited enumerable property names and\n     * symbols of `object`.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of property names and symbols.\n     */\n    function getAllKeysIn(object) {\n      return baseGetAllKeys(object, keysIn, getSymbolsIn);\n    }\n\n    /**\n     * Gets metadata for `func`.\n     *\n     * @private\n     * @param {Function} func The function to query.\n     * @returns {*} Returns the metadata for `func`.\n     */\n    var getData = !metaMap ? noop : function(func) {\n      return metaMap.get(func);\n    };\n\n    /**\n     * Gets the name of `func`.\n     *\n     * @private\n     * @param {Function} func The function to query.\n     * @returns {string} Returns the function name.\n     */\n    function getFuncName(func) {\n      var result = (func.name + ''),\n          array = realNames[result],\n          length = hasOwnProperty.call(realNames, result) ? array.length : 0;\n\n      while (length--) {\n        var data = array[length],\n            otherFunc = data.func;\n        if (otherFunc == null || otherFunc == func) {\n          return data.name;\n        }\n      }\n      return result;\n    }\n\n    /**\n     * Gets the argument placeholder value for `func`.\n     *\n     * @private\n     * @param {Function} func The function to inspect.\n     * @returns {*} Returns the placeholder value.\n     */\n    function getHolder(func) {\n      var object = hasOwnProperty.call(lodash, 'placeholder') ? lodash : func;\n      return object.placeholder;\n    }\n\n    /**\n     * Gets the appropriate \"iteratee\" function. If `_.iteratee` is customized,\n     * this function returns the custom method, otherwise it returns `baseIteratee`.\n     * If arguments are provided, the chosen function is invoked with them and\n     * its result is returned.\n     *\n     * @private\n     * @param {*} [value] The value to convert to an iteratee.\n     * @param {number} [arity] The arity of the created iteratee.\n     * @returns {Function} Returns the chosen function or its result.\n     */\n    function getIteratee() {\n      var result = lodash.iteratee || iteratee;\n      result = result === iteratee ? baseIteratee : result;\n      return arguments.length ? result(arguments[0], arguments[1]) : result;\n    }\n\n    /**\n     * Gets the data for `map`.\n     *\n     * @private\n     * @param {Object} map The map to query.\n     * @param {string} key The reference key.\n     * @returns {*} Returns the map data.\n     */\n    function getMapData(map, key) {\n      var data = map.__data__;\n      return isKeyable(key)\n        ? data[typeof key == 'string' ? 'string' : 'hash']\n        : data.map;\n    }\n\n    /**\n     * Gets the property names, values, and compare flags of `object`.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the match data of `object`.\n     */\n    function getMatchData(object) {\n      var result = keys(object),\n          length = result.length;\n\n      while (length--) {\n        var key = result[length],\n            value = object[key];\n\n        result[length] = [key, value, isStrictComparable(value)];\n      }\n      return result;\n    }\n\n    /**\n     * Gets the native function at `key` of `object`.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @param {string} key The key of the method to get.\n     * @returns {*} Returns the function if it's native, else `undefined`.\n     */\n    function getNative(object, key) {\n      var value = getValue(object, key);\n      return baseIsNative(value) ? value : undefined;\n    }\n\n    /**\n     * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n     *\n     * @private\n     * @param {*} value The value to query.\n     * @returns {string} Returns the raw `toStringTag`.\n     */\n    function getRawTag(value) {\n      var isOwn = hasOwnProperty.call(value, symToStringTag),\n          tag = value[symToStringTag];\n\n      try {\n        value[symToStringTag] = undefined;\n        var unmasked = true;\n      } catch (e) {}\n\n      var result = nativeObjectToString.call(value);\n      if (unmasked) {\n        if (isOwn) {\n          value[symToStringTag] = tag;\n        } else {\n          delete value[symToStringTag];\n        }\n      }\n      return result;\n    }\n\n    /**\n     * Creates an array of the own enumerable symbols of `object`.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of symbols.\n     */\n    var getSymbols = !nativeGetSymbols ? stubArray : function(object) {\n      if (object == null) {\n        return [];\n      }\n      object = Object(object);\n      return arrayFilter(nativeGetSymbols(object), function(symbol) {\n        return propertyIsEnumerable.call(object, symbol);\n      });\n    };\n\n    /**\n     * Creates an array of the own and inherited enumerable symbols of `object`.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of symbols.\n     */\n    var getSymbolsIn = !nativeGetSymbols ? stubArray : function(object) {\n      var result = [];\n      while (object) {\n        arrayPush(result, getSymbols(object));\n        object = getPrototype(object);\n      }\n      return result;\n    };\n\n    /**\n     * Gets the `toStringTag` of `value`.\n     *\n     * @private\n     * @param {*} value The value to query.\n     * @returns {string} Returns the `toStringTag`.\n     */\n    var getTag = baseGetTag;\n\n    // Fallback for data views, maps, sets, and weak maps in IE 11 and promises in Node.js < 6.\n    if ((DataView && getTag(new DataView(new ArrayBuffer(1))) != dataViewTag) ||\n        (Map && getTag(new Map) != mapTag) ||\n        (Promise && getTag(Promise.resolve()) != promiseTag) ||\n        (Set && getTag(new Set) != setTag) ||\n        (WeakMap && getTag(new WeakMap) != weakMapTag)) {\n      getTag = function(value) {\n        var result = baseGetTag(value),\n            Ctor = result == objectTag ? value.constructor : undefined,\n            ctorString = Ctor ? toSource(Ctor) : '';\n\n        if (ctorString) {\n          switch (ctorString) {\n            case dataViewCtorString: return dataViewTag;\n            case mapCtorString: return mapTag;\n            case promiseCtorString: return promiseTag;\n            case setCtorString: return setTag;\n            case weakMapCtorString: return weakMapTag;\n          }\n        }\n        return result;\n      };\n    }\n\n    /**\n     * Gets the view, applying any `transforms` to the `start` and `end` positions.\n     *\n     * @private\n     * @param {number} start The start of the view.\n     * @param {number} end The end of the view.\n     * @param {Array} transforms The transformations to apply to the view.\n     * @returns {Object} Returns an object containing the `start` and `end`\n     *  positions of the view.\n     */\n    function getView(start, end, transforms) {\n      var index = -1,\n          length = transforms.length;\n\n      while (++index < length) {\n        var data = transforms[index],\n            size = data.size;\n\n        switch (data.type) {\n          case 'drop':      start += size; break;\n          case 'dropRight': end -= size; break;\n          case 'take':      end = nativeMin(end, start + size); break;\n          case 'takeRight': start = nativeMax(start, end - size); break;\n        }\n      }\n      return { 'start': start, 'end': end };\n    }\n\n    /**\n     * Extracts wrapper details from the `source` body comment.\n     *\n     * @private\n     * @param {string} source The source to inspect.\n     * @returns {Array} Returns the wrapper details.\n     */\n    function getWrapDetails(source) {\n      var match = source.match(reWrapDetails);\n      return match ? match[1].split(reSplitDetails) : [];\n    }\n\n    /**\n     * Checks if `path` exists on `object`.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @param {Array|string} path The path to check.\n     * @param {Function} hasFunc The function to check properties.\n     * @returns {boolean} Returns `true` if `path` exists, else `false`.\n     */\n    function hasPath(object, path, hasFunc) {\n      path = castPath(path, object);\n\n      var index = -1,\n          length = path.length,\n          result = false;\n\n      while (++index < length) {\n        var key = toKey(path[index]);\n        if (!(result = object != null && hasFunc(object, key))) {\n          break;\n        }\n        object = object[key];\n      }\n      if (result || ++index != length) {\n        return result;\n      }\n      length = object == null ? 0 : object.length;\n      return !!length && isLength(length) && isIndex(key, length) &&\n        (isArray(object) || isArguments(object));\n    }\n\n    /**\n     * Initializes an array clone.\n     *\n     * @private\n     * @param {Array} array The array to clone.\n     * @returns {Array} Returns the initialized clone.\n     */\n    function initCloneArray(array) {\n      var length = array.length,\n          result = new array.constructor(length);\n\n      // Add properties assigned by `RegExp#exec`.\n      if (length && typeof array[0] == 'string' && hasOwnProperty.call(array, 'index')) {\n        result.index = array.index;\n        result.input = array.input;\n      }\n      return result;\n    }\n\n    /**\n     * Initializes an object clone.\n     *\n     * @private\n     * @param {Object} object The object to clone.\n     * @returns {Object} Returns the initialized clone.\n     */\n    function initCloneObject(object) {\n      return (typeof object.constructor == 'function' && !isPrototype(object))\n        ? baseCreate(getPrototype(object))\n        : {};\n    }\n\n    /**\n     * Initializes an object clone based on its `toStringTag`.\n     *\n     * **Note:** This function only supports cloning values with tags of\n     * `Boolean`, `Date`, `Error`, `Map`, `Number`, `RegExp`, `Set`, or `String`.\n     *\n     * @private\n     * @param {Object} object The object to clone.\n     * @param {string} tag The `toStringTag` of the object to clone.\n     * @param {boolean} [isDeep] Specify a deep clone.\n     * @returns {Object} Returns the initialized clone.\n     */\n    function initCloneByTag(object, tag, isDeep) {\n      var Ctor = object.constructor;\n      switch (tag) {\n        case arrayBufferTag:\n          return cloneArrayBuffer(object);\n\n        case boolTag:\n        case dateTag:\n          return new Ctor(+object);\n\n        case dataViewTag:\n          return cloneDataView(object, isDeep);\n\n        case float32Tag: case float64Tag:\n        case int8Tag: case int16Tag: case int32Tag:\n        case uint8Tag: case uint8ClampedTag: case uint16Tag: case uint32Tag:\n          return cloneTypedArray(object, isDeep);\n\n        case mapTag:\n          return new Ctor;\n\n        case numberTag:\n        case stringTag:\n          return new Ctor(object);\n\n        case regexpTag:\n          return cloneRegExp(object);\n\n        case setTag:\n          return new Ctor;\n\n        case symbolTag:\n          return cloneSymbol(object);\n      }\n    }\n\n    /**\n     * Inserts wrapper `details` in a comment at the top of the `source` body.\n     *\n     * @private\n     * @param {string} source The source to modify.\n     * @returns {Array} details The details to insert.\n     * @returns {string} Returns the modified source.\n     */\n    function insertWrapDetails(source, details) {\n      var length = details.length;\n      if (!length) {\n        return source;\n      }\n      var lastIndex = length - 1;\n      details[lastIndex] = (length > 1 ? '& ' : '') + details[lastIndex];\n      details = details.join(length > 2 ? ', ' : ' ');\n      return source.replace(reWrapComment, '{\\n/* [wrapped with ' + details + '] */\\n');\n    }\n\n    /**\n     * Checks if `value` is a flattenable `arguments` object or array.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is flattenable, else `false`.\n     */\n    function isFlattenable(value) {\n      return isArray(value) || isArguments(value) ||\n        !!(spreadableSymbol && value && value[spreadableSymbol]);\n    }\n\n    /**\n     * Checks if `value` is a valid array-like index.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.\n     * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.\n     */\n    function isIndex(value, length) {\n      var type = typeof value;\n      length = length == null ? MAX_SAFE_INTEGER : length;\n\n      return !!length &&\n        (type == 'number' ||\n          (type != 'symbol' && reIsUint.test(value))) &&\n            (value > -1 && value % 1 == 0 && value < length);\n    }\n\n    /**\n     * Checks if the given arguments are from an iteratee call.\n     *\n     * @private\n     * @param {*} value The potential iteratee value argument.\n     * @param {*} index The potential iteratee index or key argument.\n     * @param {*} object The potential iteratee object argument.\n     * @returns {boolean} Returns `true` if the arguments are from an iteratee call,\n     *  else `false`.\n     */\n    function isIterateeCall(value, index, object) {\n      if (!isObject(object)) {\n        return false;\n      }\n      var type = typeof index;\n      if (type == 'number'\n            ? (isArrayLike(object) && isIndex(index, object.length))\n            : (type == 'string' && index in object)\n          ) {\n        return eq(object[index], value);\n      }\n      return false;\n    }\n\n    /**\n     * Checks if `value` is a property name and not a property path.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @param {Object} [object] The object to query keys on.\n     * @returns {boolean} Returns `true` if `value` is a property name, else `false`.\n     */\n    function isKey(value, object) {\n      if (isArray(value)) {\n        return false;\n      }\n      var type = typeof value;\n      if (type == 'number' || type == 'symbol' || type == 'boolean' ||\n          value == null || isSymbol(value)) {\n        return true;\n      }\n      return reIsPlainProp.test(value) || !reIsDeepProp.test(value) ||\n        (object != null && value in Object(object));\n    }\n\n    /**\n     * Checks if `value` is suitable for use as unique object key.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is suitable, else `false`.\n     */\n    function isKeyable(value) {\n      var type = typeof value;\n      return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')\n        ? (value !== '__proto__')\n        : (value === null);\n    }\n\n    /**\n     * Checks if `func` has a lazy counterpart.\n     *\n     * @private\n     * @param {Function} func The function to check.\n     * @returns {boolean} Returns `true` if `func` has a lazy counterpart,\n     *  else `false`.\n     */\n    function isLaziable(func) {\n      var funcName = getFuncName(func),\n          other = lodash[funcName];\n\n      if (typeof other != 'function' || !(funcName in LazyWrapper.prototype)) {\n        return false;\n      }\n      if (func === other) {\n        return true;\n      }\n      var data = getData(other);\n      return !!data && func === data[0];\n    }\n\n    /**\n     * Checks if `func` has its source masked.\n     *\n     * @private\n     * @param {Function} func The function to check.\n     * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n     */\n    function isMasked(func) {\n      return !!maskSrcKey && (maskSrcKey in func);\n    }\n\n    /**\n     * Checks if `func` is capable of being masked.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `func` is maskable, else `false`.\n     */\n    var isMaskable = coreJsData ? isFunction : stubFalse;\n\n    /**\n     * Checks if `value` is likely a prototype object.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.\n     */\n    function isPrototype(value) {\n      var Ctor = value && value.constructor,\n          proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto;\n\n      return value === proto;\n    }\n\n    /**\n     * Checks if `value` is suitable for strict equality comparisons, i.e. `===`.\n     *\n     * @private\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` if suitable for strict\n     *  equality comparisons, else `false`.\n     */\n    function isStrictComparable(value) {\n      return value === value && !isObject(value);\n    }\n\n    /**\n     * A specialized version of `matchesProperty` for source values suitable\n     * for strict equality comparisons, i.e. `===`.\n     *\n     * @private\n     * @param {string} key The key of the property to get.\n     * @param {*} srcValue The value to match.\n     * @returns {Function} Returns the new spec function.\n     */\n    function matchesStrictComparable(key, srcValue) {\n      return function(object) {\n        if (object == null) {\n          return false;\n        }\n        return object[key] === srcValue &&\n          (srcValue !== undefined || (key in Object(object)));\n      };\n    }\n\n    /**\n     * A specialized version of `_.memoize` which clears the memoized function's\n     * cache when it exceeds `MAX_MEMOIZE_SIZE`.\n     *\n     * @private\n     * @param {Function} func The function to have its output memoized.\n     * @returns {Function} Returns the new memoized function.\n     */\n    function memoizeCapped(func) {\n      var result = memoize(func, function(key) {\n        if (cache.size === MAX_MEMOIZE_SIZE) {\n          cache.clear();\n        }\n        return key;\n      });\n\n      var cache = result.cache;\n      return result;\n    }\n\n    /**\n     * Merges the function metadata of `source` into `data`.\n     *\n     * Merging metadata reduces the number of wrappers used to invoke a function.\n     * This is possible because methods like `_.bind`, `_.curry`, and `_.partial`\n     * may be applied regardless of execution order. Methods like `_.ary` and\n     * `_.rearg` modify function arguments, making the order in which they are\n     * executed important, preventing the merging of metadata. However, we make\n     * an exception for a safe combined case where curried functions have `_.ary`\n     * and or `_.rearg` applied.\n     *\n     * @private\n     * @param {Array} data The destination metadata.\n     * @param {Array} source The source metadata.\n     * @returns {Array} Returns `data`.\n     */\n    function mergeData(data, source) {\n      var bitmask = data[1],\n          srcBitmask = source[1],\n          newBitmask = bitmask | srcBitmask,\n          isCommon = newBitmask < (WRAP_BIND_FLAG | WRAP_BIND_KEY_FLAG | WRAP_ARY_FLAG);\n\n      var isCombo =\n        ((srcBitmask == WRAP_ARY_FLAG) && (bitmask == WRAP_CURRY_FLAG)) ||\n        ((srcBitmask == WRAP_ARY_FLAG) && (bitmask == WRAP_REARG_FLAG) && (data[7].length <= source[8])) ||\n        ((srcBitmask == (WRAP_ARY_FLAG | WRAP_REARG_FLAG)) && (source[7].length <= source[8]) && (bitmask == WRAP_CURRY_FLAG));\n\n      // Exit early if metadata can't be merged.\n      if (!(isCommon || isCombo)) {\n        return data;\n      }\n      // Use source `thisArg` if available.\n      if (srcBitmask & WRAP_BIND_FLAG) {\n        data[2] = source[2];\n        // Set when currying a bound function.\n        newBitmask |= bitmask & WRAP_BIND_FLAG ? 0 : WRAP_CURRY_BOUND_FLAG;\n      }\n      // Compose partial arguments.\n      var value = source[3];\n      if (value) {\n        var partials = data[3];\n        data[3] = partials ? composeArgs(partials, value, source[4]) : value;\n        data[4] = partials ? replaceHolders(data[3], PLACEHOLDER) : source[4];\n      }\n      // Compose partial right arguments.\n      value = source[5];\n      if (value) {\n        partials = data[5];\n        data[5] = partials ? composeArgsRight(partials, value, source[6]) : value;\n        data[6] = partials ? replaceHolders(data[5], PLACEHOLDER) : source[6];\n      }\n      // Use source `argPos` if available.\n      value = source[7];\n      if (value) {\n        data[7] = value;\n      }\n      // Use source `ary` if it's smaller.\n      if (srcBitmask & WRAP_ARY_FLAG) {\n        data[8] = data[8] == null ? source[8] : nativeMin(data[8], source[8]);\n      }\n      // Use source `arity` if one is not provided.\n      if (data[9] == null) {\n        data[9] = source[9];\n      }\n      // Use source `func` and merge bitmasks.\n      data[0] = source[0];\n      data[1] = newBitmask;\n\n      return data;\n    }\n\n    /**\n     * This function is like\n     * [`Object.keys`](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n     * except that it includes inherited enumerable properties.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of property names.\n     */\n    function nativeKeysIn(object) {\n      var result = [];\n      if (object != null) {\n        for (var key in Object(object)) {\n          result.push(key);\n        }\n      }\n      return result;\n    }\n\n    /**\n     * Converts `value` to a string using `Object.prototype.toString`.\n     *\n     * @private\n     * @param {*} value The value to convert.\n     * @returns {string} Returns the converted string.\n     */\n    function objectToString(value) {\n      return nativeObjectToString.call(value);\n    }\n\n    /**\n     * A specialized version of `baseRest` which transforms the rest array.\n     *\n     * @private\n     * @param {Function} func The function to apply a rest parameter to.\n     * @param {number} [start=func.length-1] The start position of the rest parameter.\n     * @param {Function} transform The rest array transform.\n     * @returns {Function} Returns the new function.\n     */\n    function overRest(func, start, transform) {\n      start = nativeMax(start === undefined ? (func.length - 1) : start, 0);\n      return function() {\n        var args = arguments,\n            index = -1,\n            length = nativeMax(args.length - start, 0),\n            array = Array(length);\n\n        while (++index < length) {\n          array[index] = args[start + index];\n        }\n        index = -1;\n        var otherArgs = Array(start + 1);\n        while (++index < start) {\n          otherArgs[index] = args[index];\n        }\n        otherArgs[start] = transform(array);\n        return apply(func, this, otherArgs);\n      };\n    }\n\n    /**\n     * Gets the parent value at `path` of `object`.\n     *\n     * @private\n     * @param {Object} object The object to query.\n     * @param {Array} path The path to get the parent value of.\n     * @returns {*} Returns the parent value.\n     */\n    function parent(object, path) {\n      return path.length < 2 ? object : baseGet(object, baseSlice(path, 0, -1));\n    }\n\n    /**\n     * Reorder `array` according to the specified indexes where the element at\n     * the first index is assigned as the first element, the element at\n     * the second index is assigned as the second element, and so on.\n     *\n     * @private\n     * @param {Array} array The array to reorder.\n     * @param {Array} indexes The arranged array indexes.\n     * @returns {Array} Returns `array`.\n     */\n    function reorder(array, indexes) {\n      var arrLength = array.length,\n          length = nativeMin(indexes.length, arrLength),\n          oldArray = copyArray(array);\n\n      while (length--) {\n        var index = indexes[length];\n        array[length] = isIndex(index, arrLength) ? oldArray[index] : undefined;\n      }\n      return array;\n    }\n\n    /**\n     * Sets metadata for `func`.\n     *\n     * **Note:** If this function becomes hot, i.e. is invoked a lot in a short\n     * period of time, it will trip its breaker and transition to an identity\n     * function to avoid garbage collection pauses in V8. See\n     * [V8 issue 2070](https://bugs.chromium.org/p/v8/issues/detail?id=2070)\n     * for more details.\n     *\n     * @private\n     * @param {Function} func The function to associate metadata with.\n     * @param {*} data The metadata.\n     * @returns {Function} Returns `func`.\n     */\n    var setData = shortOut(baseSetData);\n\n    /**\n     * A simple wrapper around the global [`setTimeout`](https://mdn.io/setTimeout).\n     *\n     * @private\n     * @param {Function} func The function to delay.\n     * @param {number} wait The number of milliseconds to delay invocation.\n     * @returns {number|Object} Returns the timer id or timeout object.\n     */\n    var setTimeout = ctxSetTimeout || function(func, wait) {\n      return root.setTimeout(func, wait);\n    };\n\n    /**\n     * Sets the `toString` method of `func` to return `string`.\n     *\n     * @private\n     * @param {Function} func The function to modify.\n     * @param {Function} string The `toString` result.\n     * @returns {Function} Returns `func`.\n     */\n    var setToString = shortOut(baseSetToString);\n\n    /**\n     * Sets the `toString` method of `wrapper` to mimic the source of `reference`\n     * with wrapper details in a comment at the top of the source body.\n     *\n     * @private\n     * @param {Function} wrapper The function to modify.\n     * @param {Function} reference The reference function.\n     * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n     * @returns {Function} Returns `wrapper`.\n     */\n    function setWrapToString(wrapper, reference, bitmask) {\n      var source = (reference + '');\n      return setToString(wrapper, insertWrapDetails(source, updateWrapDetails(getWrapDetails(source), bitmask)));\n    }\n\n    /**\n     * Creates a function that'll short out and invoke `identity` instead\n     * of `func` when it's called `HOT_COUNT` or more times in `HOT_SPAN`\n     * milliseconds.\n     *\n     * @private\n     * @param {Function} func The function to restrict.\n     * @returns {Function} Returns the new shortable function.\n     */\n    function shortOut(func) {\n      var count = 0,\n          lastCalled = 0;\n\n      return function() {\n        var stamp = nativeNow(),\n            remaining = HOT_SPAN - (stamp - lastCalled);\n\n        lastCalled = stamp;\n        if (remaining > 0) {\n          if (++count >= HOT_COUNT) {\n            return arguments[0];\n          }\n        } else {\n          count = 0;\n        }\n        return func.apply(undefined, arguments);\n      };\n    }\n\n    /**\n     * A specialized version of `_.shuffle` which mutates and sets the size of `array`.\n     *\n     * @private\n     * @param {Array} array The array to shuffle.\n     * @param {number} [size=array.length] The size of `array`.\n     * @returns {Array} Returns `array`.\n     */\n    function shuffleSelf(array, size) {\n      var index = -1,\n          length = array.length,\n          lastIndex = length - 1;\n\n      size = size === undefined ? length : size;\n      while (++index < size) {\n        var rand = baseRandom(index, lastIndex),\n            value = array[rand];\n\n        array[rand] = array[index];\n        array[index] = value;\n      }\n      array.length = size;\n      return array;\n    }\n\n    /**\n     * Converts `string` to a property path array.\n     *\n     * @private\n     * @param {string} string The string to convert.\n     * @returns {Array} Returns the property path array.\n     */\n    var stringToPath = memoizeCapped(function(string) {\n      var result = [];\n      if (string.charCodeAt(0) === 46 /* . */) {\n        result.push('');\n      }\n      string.replace(rePropName, function(match, number, quote, subString) {\n        result.push(quote ? subString.replace(reEscapeChar, '$1') : (number || match));\n      });\n      return result;\n    });\n\n    /**\n     * Converts `value` to a string key if it's not a string or symbol.\n     *\n     * @private\n     * @param {*} value The value to inspect.\n     * @returns {string|symbol} Returns the key.\n     */\n    function toKey(value) {\n      if (typeof value == 'string' || isSymbol(value)) {\n        return value;\n      }\n      var result = (value + '');\n      return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n    }\n\n    /**\n     * Converts `func` to its source code.\n     *\n     * @private\n     * @param {Function} func The function to convert.\n     * @returns {string} Returns the source code.\n     */\n    function toSource(func) {\n      if (func != null) {\n        try {\n          return funcToString.call(func);\n        } catch (e) {}\n        try {\n          return (func + '');\n        } catch (e) {}\n      }\n      return '';\n    }\n\n    /**\n     * Updates wrapper `details` based on `bitmask` flags.\n     *\n     * @private\n     * @returns {Array} details The details to modify.\n     * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n     * @returns {Array} Returns `details`.\n     */\n    function updateWrapDetails(details, bitmask) {\n      arrayEach(wrapFlags, function(pair) {\n        var value = '_.' + pair[0];\n        if ((bitmask & pair[1]) && !arrayIncludes(details, value)) {\n          details.push(value);\n        }\n      });\n      return details.sort();\n    }\n\n    /**\n     * Creates a clone of `wrapper`.\n     *\n     * @private\n     * @param {Object} wrapper The wrapper to clone.\n     * @returns {Object} Returns the cloned wrapper.\n     */\n    function wrapperClone(wrapper) {\n      if (wrapper instanceof LazyWrapper) {\n        return wrapper.clone();\n      }\n      var result = new LodashWrapper(wrapper.__wrapped__, wrapper.__chain__);\n      result.__actions__ = copyArray(wrapper.__actions__);\n      result.__index__  = wrapper.__index__;\n      result.__values__ = wrapper.__values__;\n      return result;\n    }\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Creates an array of elements split into groups the length of `size`.\n     * If `array` can't be split evenly, the final chunk will be the remaining\n     * elements.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The array to process.\n     * @param {number} [size=1] The length of each chunk\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Array} Returns the new array of chunks.\n     * @example\n     *\n     * _.chunk(['a', 'b', 'c', 'd'], 2);\n     * // => [['a', 'b'], ['c', 'd']]\n     *\n     * _.chunk(['a', 'b', 'c', 'd'], 3);\n     * // => [['a', 'b', 'c'], ['d']]\n     */\n    function chunk(array, size, guard) {\n      if ((guard ? isIterateeCall(array, size, guard) : size === undefined)) {\n        size = 1;\n      } else {\n        size = nativeMax(toInteger(size), 0);\n      }\n      var length = array == null ? 0 : array.length;\n      if (!length || size < 1) {\n        return [];\n      }\n      var index = 0,\n          resIndex = 0,\n          result = Array(nativeCeil(length / size));\n\n      while (index < length) {\n        result[resIndex++] = baseSlice(array, index, (index += size));\n      }\n      return result;\n    }\n\n    /**\n     * Creates an array with all falsey values removed. The values `false`, `null`,\n     * `0`, `\"\"`, `undefined`, and `NaN` are falsey.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The array to compact.\n     * @returns {Array} Returns the new array of filtered values.\n     * @example\n     *\n     * _.compact([0, 1, false, 2, '', 3]);\n     * // => [1, 2, 3]\n     */\n    function compact(array) {\n      var index = -1,\n          length = array == null ? 0 : array.length,\n          resIndex = 0,\n          result = [];\n\n      while (++index < length) {\n        var value = array[index];\n        if (value) {\n          result[resIndex++] = value;\n        }\n      }\n      return result;\n    }\n\n    /**\n     * Creates a new array concatenating `array` with any additional arrays\n     * and/or values.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to concatenate.\n     * @param {...*} [values] The values to concatenate.\n     * @returns {Array} Returns the new concatenated array.\n     * @example\n     *\n     * var array = [1];\n     * var other = _.concat(array, 2, [3], [[4]]);\n     *\n     * console.log(other);\n     * // => [1, 2, 3, [4]]\n     *\n     * console.log(array);\n     * // => [1]\n     */\n    function concat() {\n      var length = arguments.length;\n      if (!length) {\n        return [];\n      }\n      var args = Array(length - 1),\n          array = arguments[0],\n          index = length;\n\n      while (index--) {\n        args[index - 1] = arguments[index];\n      }\n      return arrayPush(isArray(array) ? copyArray(array) : [array], baseFlatten(args, 1));\n    }\n\n    /**\n     * Creates an array of `array` values not included in the other given arrays\n     * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n     * for equality comparisons. The order and references of result values are\n     * determined by the first array.\n     *\n     * **Note:** Unlike `_.pullAll`, this method returns a new array.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {...Array} [values] The values to exclude.\n     * @returns {Array} Returns the new array of filtered values.\n     * @see _.without, _.xor\n     * @example\n     *\n     * _.difference([2, 1], [2, 3]);\n     * // => [1]\n     */\n    var difference = baseRest(function(array, values) {\n      return isArrayLikeObject(array)\n        ? baseDifference(array, baseFlatten(values, 1, isArrayLikeObject, true))\n        : [];\n    });\n\n    /**\n     * This method is like `_.difference` except that it accepts `iteratee` which\n     * is invoked for each element of `array` and `values` to generate the criterion\n     * by which they're compared. The order and references of result values are\n     * determined by the first array. The iteratee is invoked with one argument:\n     * (value).\n     *\n     * **Note:** Unlike `_.pullAllBy`, this method returns a new array.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {...Array} [values] The values to exclude.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {Array} Returns the new array of filtered values.\n     * @example\n     *\n     * _.differenceBy([2.1, 1.2], [2.3, 3.4], Math.floor);\n     * // => [1.2]\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.differenceBy([{ 'x': 2 }, { 'x': 1 }], [{ 'x': 1 }], 'x');\n     * // => [{ 'x': 2 }]\n     */\n    var differenceBy = baseRest(function(array, values) {\n      var iteratee = last(values);\n      if (isArrayLikeObject(iteratee)) {\n        iteratee = undefined;\n      }\n      return isArrayLikeObject(array)\n        ? baseDifference(array, baseFlatten(values, 1, isArrayLikeObject, true), getIteratee(iteratee, 2))\n        : [];\n    });\n\n    /**\n     * This method is like `_.difference` except that it accepts `comparator`\n     * which is invoked to compare elements of `array` to `values`. The order and\n     * references of result values are determined by the first array. The comparator\n     * is invoked with two arguments: (arrVal, othVal).\n     *\n     * **Note:** Unlike `_.pullAllWith`, this method returns a new array.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {...Array} [values] The values to exclude.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns the new array of filtered values.\n     * @example\n     *\n     * var objects = [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }];\n     *\n     * _.differenceWith(objects, [{ 'x': 1, 'y': 2 }], _.isEqual);\n     * // => [{ 'x': 2, 'y': 1 }]\n     */\n    var differenceWith = baseRest(function(array, values) {\n      var comparator = last(values);\n      if (isArrayLikeObject(comparator)) {\n        comparator = undefined;\n      }\n      return isArrayLikeObject(array)\n        ? baseDifference(array, baseFlatten(values, 1, isArrayLikeObject, true), undefined, comparator)\n        : [];\n    });\n\n    /**\n     * Creates a slice of `array` with `n` elements dropped from the beginning.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.5.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @param {number} [n=1] The number of elements to drop.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Array} Returns the slice of `array`.\n     * @example\n     *\n     * _.drop([1, 2, 3]);\n     * // => [2, 3]\n     *\n     * _.drop([1, 2, 3], 2);\n     * // => [3]\n     *\n     * _.drop([1, 2, 3], 5);\n     * // => []\n     *\n     * _.drop([1, 2, 3], 0);\n     * // => [1, 2, 3]\n     */\n    function drop(array, n, guard) {\n      var length = array == null ? 0 : array.length;\n      if (!length) {\n        return [];\n      }\n      n = (guard || n === undefined) ? 1 : toInteger(n);\n      return baseSlice(array, n < 0 ? 0 : n, length);\n    }\n\n    /**\n     * Creates a slice of `array` with `n` elements dropped from the end.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @param {number} [n=1] The number of elements to drop.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Array} Returns the slice of `array`.\n     * @example\n     *\n     * _.dropRight([1, 2, 3]);\n     * // => [1, 2]\n     *\n     * _.dropRight([1, 2, 3], 2);\n     * // => [1]\n     *\n     * _.dropRight([1, 2, 3], 5);\n     * // => []\n     *\n     * _.dropRight([1, 2, 3], 0);\n     * // => [1, 2, 3]\n     */\n    function dropRight(array, n, guard) {\n      var length = array == null ? 0 : array.length;\n      if (!length) {\n        return [];\n      }\n      n = (guard || n === undefined) ? 1 : toInteger(n);\n      n = length - n;\n      return baseSlice(array, 0, n < 0 ? 0 : n);\n    }\n\n    /**\n     * Creates a slice of `array` excluding elements dropped from the end.\n     * Elements are dropped until `predicate` returns falsey. The predicate is\n     * invoked with three arguments: (value, index, array).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the slice of `array`.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney',  'active': true },\n     *   { 'user': 'fred',    'active': false },\n     *   { 'user': 'pebbles', 'active': false }\n     * ];\n     *\n     * _.dropRightWhile(users, function(o) { return !o.active; });\n     * // => objects for ['barney']\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.dropRightWhile(users, { 'user': 'pebbles', 'active': false });\n     * // => objects for ['barney', 'fred']\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.dropRightWhile(users, ['active', false]);\n     * // => objects for ['barney']\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.dropRightWhile(users, 'active');\n     * // => objects for ['barney', 'fred', 'pebbles']\n     */\n    function dropRightWhile(array, predicate) {\n      return (array && array.length)\n        ? baseWhile(array, getIteratee(predicate, 3), true, true)\n        : [];\n    }\n\n    /**\n     * Creates a slice of `array` excluding elements dropped from the beginning.\n     * Elements are dropped until `predicate` returns falsey. The predicate is\n     * invoked with three arguments: (value, index, array).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the slice of `array`.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney',  'active': false },\n     *   { 'user': 'fred',    'active': false },\n     *   { 'user': 'pebbles', 'active': true }\n     * ];\n     *\n     * _.dropWhile(users, function(o) { return !o.active; });\n     * // => objects for ['pebbles']\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.dropWhile(users, { 'user': 'barney', 'active': false });\n     * // => objects for ['fred', 'pebbles']\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.dropWhile(users, ['active', false]);\n     * // => objects for ['pebbles']\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.dropWhile(users, 'active');\n     * // => objects for ['barney', 'fred', 'pebbles']\n     */\n    function dropWhile(array, predicate) {\n      return (array && array.length)\n        ? baseWhile(array, getIteratee(predicate, 3), true)\n        : [];\n    }\n\n    /**\n     * Fills elements of `array` with `value` from `start` up to, but not\n     * including, `end`.\n     *\n     * **Note:** This method mutates `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.2.0\n     * @category Array\n     * @param {Array} array The array to fill.\n     * @param {*} value The value to fill `array` with.\n     * @param {number} [start=0] The start position.\n     * @param {number} [end=array.length] The end position.\n     * @returns {Array} Returns `array`.\n     * @example\n     *\n     * var array = [1, 2, 3];\n     *\n     * _.fill(array, 'a');\n     * console.log(array);\n     * // => ['a', 'a', 'a']\n     *\n     * _.fill(Array(3), 2);\n     * // => [2, 2, 2]\n     *\n     * _.fill([4, 6, 8, 10], '*', 1, 3);\n     * // => [4, '*', '*', 10]\n     */\n    function fill(array, value, start, end) {\n      var length = array == null ? 0 : array.length;\n      if (!length) {\n        return [];\n      }\n      if (start && typeof start != 'number' && isIterateeCall(array, value, start)) {\n        start = 0;\n        end = length;\n      }\n      return baseFill(array, value, start, end);\n    }\n\n    /**\n     * This method is like `_.find` except that it returns the index of the first\n     * element `predicate` returns truthy for instead of the element itself.\n     *\n     * @static\n     * @memberOf _\n     * @since 1.1.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @param {number} [fromIndex=0] The index to search from.\n     * @returns {number} Returns the index of the found element, else `-1`.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney',  'active': false },\n     *   { 'user': 'fred',    'active': false },\n     *   { 'user': 'pebbles', 'active': true }\n     * ];\n     *\n     * _.findIndex(users, function(o) { return o.user == 'barney'; });\n     * // => 0\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.findIndex(users, { 'user': 'fred', 'active': false });\n     * // => 1\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.findIndex(users, ['active', false]);\n     * // => 0\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.findIndex(users, 'active');\n     * // => 2\n     */\n    function findIndex(array, predicate, fromIndex) {\n      var length = array == null ? 0 : array.length;\n      if (!length) {\n        return -1;\n      }\n      var index = fromIndex == null ? 0 : toInteger(fromIndex);\n      if (index < 0) {\n        index = nativeMax(length + index, 0);\n      }\n      return baseFindIndex(array, getIteratee(predicate, 3), index);\n    }\n\n    /**\n     * This method is like `_.findIndex` except that it iterates over elements\n     * of `collection` from right to left.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.0.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @param {number} [fromIndex=array.length-1] The index to search from.\n     * @returns {number} Returns the index of the found element, else `-1`.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney',  'active': true },\n     *   { 'user': 'fred',    'active': false },\n     *   { 'user': 'pebbles', 'active': false }\n     * ];\n     *\n     * _.findLastIndex(users, function(o) { return o.user == 'pebbles'; });\n     * // => 2\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.findLastIndex(users, { 'user': 'barney', 'active': true });\n     * // => 0\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.findLastIndex(users, ['active', false]);\n     * // => 2\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.findLastIndex(users, 'active');\n     * // => 0\n     */\n    function findLastIndex(array, predicate, fromIndex) {\n      var length = array == null ? 0 : array.length;\n      if (!length) {\n        return -1;\n      }\n      var index = length - 1;\n      if (fromIndex !== undefined) {\n        index = toInteger(fromIndex);\n        index = fromIndex < 0\n          ? nativeMax(length + index, 0)\n          : nativeMin(index, length - 1);\n      }\n      return baseFindIndex(array, getIteratee(predicate, 3), index, true);\n    }\n\n    /**\n     * Flattens `array` a single level deep.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The array to flatten.\n     * @returns {Array} Returns the new flattened array.\n     * @example\n     *\n     * _.flatten([1, [2, [3, [4]], 5]]);\n     * // => [1, 2, [3, [4]], 5]\n     */\n    function flatten(array) {\n      var length = array == null ? 0 : array.length;\n      return length ? baseFlatten(array, 1) : [];\n    }\n\n    /**\n     * Recursively flattens `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The array to flatten.\n     * @returns {Array} Returns the new flattened array.\n     * @example\n     *\n     * _.flattenDeep([1, [2, [3, [4]], 5]]);\n     * // => [1, 2, 3, 4, 5]\n     */\n    function flattenDeep(array) {\n      var length = array == null ? 0 : array.length;\n      return length ? baseFlatten(array, INFINITY) : [];\n    }\n\n    /**\n     * Recursively flatten `array` up to `depth` times.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.4.0\n     * @category Array\n     * @param {Array} array The array to flatten.\n     * @param {number} [depth=1] The maximum recursion depth.\n     * @returns {Array} Returns the new flattened array.\n     * @example\n     *\n     * var array = [1, [2, [3, [4]], 5]];\n     *\n     * _.flattenDepth(array, 1);\n     * // => [1, 2, [3, [4]], 5]\n     *\n     * _.flattenDepth(array, 2);\n     * // => [1, 2, 3, [4], 5]\n     */\n    function flattenDepth(array, depth) {\n      var length = array == null ? 0 : array.length;\n      if (!length) {\n        return [];\n      }\n      depth = depth === undefined ? 1 : toInteger(depth);\n      return baseFlatten(array, depth);\n    }\n\n    /**\n     * The inverse of `_.toPairs`; this method returns an object composed\n     * from key-value `pairs`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} pairs The key-value pairs.\n     * @returns {Object} Returns the new object.\n     * @example\n     *\n     * _.fromPairs([['a', 1], ['b', 2]]);\n     * // => { 'a': 1, 'b': 2 }\n     */\n    function fromPairs(pairs) {\n      var index = -1,\n          length = pairs == null ? 0 : pairs.length,\n          result = {};\n\n      while (++index < length) {\n        var pair = pairs[index];\n        result[pair[0]] = pair[1];\n      }\n      return result;\n    }\n\n    /**\n     * Gets the first element of `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @alias first\n     * @category Array\n     * @param {Array} array The array to query.\n     * @returns {*} Returns the first element of `array`.\n     * @example\n     *\n     * _.head([1, 2, 3]);\n     * // => 1\n     *\n     * _.head([]);\n     * // => undefined\n     */\n    function head(array) {\n      return (array && array.length) ? array[0] : undefined;\n    }\n\n    /**\n     * Gets the index at which the first occurrence of `value` is found in `array`\n     * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n     * for equality comparisons. If `fromIndex` is negative, it's used as the\n     * offset from the end of `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {*} value The value to search for.\n     * @param {number} [fromIndex=0] The index to search from.\n     * @returns {number} Returns the index of the matched value, else `-1`.\n     * @example\n     *\n     * _.indexOf([1, 2, 1, 2], 2);\n     * // => 1\n     *\n     * // Search from the `fromIndex`.\n     * _.indexOf([1, 2, 1, 2], 2, 2);\n     * // => 3\n     */\n    function indexOf(array, value, fromIndex) {\n      var length = array == null ? 0 : array.length;\n      if (!length) {\n        return -1;\n      }\n      var index = fromIndex == null ? 0 : toInteger(fromIndex);\n      if (index < 0) {\n        index = nativeMax(length + index, 0);\n      }\n      return baseIndexOf(array, value, index);\n    }\n\n    /**\n     * Gets all but the last element of `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @returns {Array} Returns the slice of `array`.\n     * @example\n     *\n     * _.initial([1, 2, 3]);\n     * // => [1, 2]\n     */\n    function initial(array) {\n      var length = array == null ? 0 : array.length;\n      return length ? baseSlice(array, 0, -1) : [];\n    }\n\n    /**\n     * Creates an array of unique values that are included in all given arrays\n     * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n     * for equality comparisons. The order and references of result values are\n     * determined by the first array.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to inspect.\n     * @returns {Array} Returns the new array of intersecting values.\n     * @example\n     *\n     * _.intersection([2, 1], [2, 3]);\n     * // => [2]\n     */\n    var intersection = baseRest(function(arrays) {\n      var mapped = arrayMap(arrays, castArrayLikeObject);\n      return (mapped.length && mapped[0] === arrays[0])\n        ? baseIntersection(mapped)\n        : [];\n    });\n\n    /**\n     * This method is like `_.intersection` except that it accepts `iteratee`\n     * which is invoked for each element of each `arrays` to generate the criterion\n     * by which they're compared. The order and references of result values are\n     * determined by the first array. The iteratee is invoked with one argument:\n     * (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to inspect.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {Array} Returns the new array of intersecting values.\n     * @example\n     *\n     * _.intersectionBy([2.1, 1.2], [2.3, 3.4], Math.floor);\n     * // => [2.1]\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.intersectionBy([{ 'x': 1 }], [{ 'x': 2 }, { 'x': 1 }], 'x');\n     * // => [{ 'x': 1 }]\n     */\n    var intersectionBy = baseRest(function(arrays) {\n      var iteratee = last(arrays),\n          mapped = arrayMap(arrays, castArrayLikeObject);\n\n      if (iteratee === last(mapped)) {\n        iteratee = undefined;\n      } else {\n        mapped.pop();\n      }\n      return (mapped.length && mapped[0] === arrays[0])\n        ? baseIntersection(mapped, getIteratee(iteratee, 2))\n        : [];\n    });\n\n    /**\n     * This method is like `_.intersection` except that it accepts `comparator`\n     * which is invoked to compare elements of `arrays`. The order and references\n     * of result values are determined by the first array. The comparator is\n     * invoked with two arguments: (arrVal, othVal).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to inspect.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns the new array of intersecting values.\n     * @example\n     *\n     * var objects = [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }];\n     * var others = [{ 'x': 1, 'y': 1 }, { 'x': 1, 'y': 2 }];\n     *\n     * _.intersectionWith(objects, others, _.isEqual);\n     * // => [{ 'x': 1, 'y': 2 }]\n     */\n    var intersectionWith = baseRest(function(arrays) {\n      var comparator = last(arrays),\n          mapped = arrayMap(arrays, castArrayLikeObject);\n\n      comparator = typeof comparator == 'function' ? comparator : undefined;\n      if (comparator) {\n        mapped.pop();\n      }\n      return (mapped.length && mapped[0] === arrays[0])\n        ? baseIntersection(mapped, undefined, comparator)\n        : [];\n    });\n\n    /**\n     * Converts all elements in `array` into a string separated by `separator`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to convert.\n     * @param {string} [separator=','] The element separator.\n     * @returns {string} Returns the joined string.\n     * @example\n     *\n     * _.join(['a', 'b', 'c'], '~');\n     * // => 'a~b~c'\n     */\n    function join(array, separator) {\n      return array == null ? '' : nativeJoin.call(array, separator);\n    }\n\n    /**\n     * Gets the last element of `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @returns {*} Returns the last element of `array`.\n     * @example\n     *\n     * _.last([1, 2, 3]);\n     * // => 3\n     */\n    function last(array) {\n      var length = array == null ? 0 : array.length;\n      return length ? array[length - 1] : undefined;\n    }\n\n    /**\n     * This method is like `_.indexOf` except that it iterates over elements of\n     * `array` from right to left.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {*} value The value to search for.\n     * @param {number} [fromIndex=array.length-1] The index to search from.\n     * @returns {number} Returns the index of the matched value, else `-1`.\n     * @example\n     *\n     * _.lastIndexOf([1, 2, 1, 2], 2);\n     * // => 3\n     *\n     * // Search from the `fromIndex`.\n     * _.lastIndexOf([1, 2, 1, 2], 2, 2);\n     * // => 1\n     */\n    function lastIndexOf(array, value, fromIndex) {\n      var length = array == null ? 0 : array.length;\n      if (!length) {\n        return -1;\n      }\n      var index = length;\n      if (fromIndex !== undefined) {\n        index = toInteger(fromIndex);\n        index = index < 0 ? nativeMax(length + index, 0) : nativeMin(index, length - 1);\n      }\n      return value === value\n        ? strictLastIndexOf(array, value, index)\n        : baseFindIndex(array, baseIsNaN, index, true);\n    }\n\n    /**\n     * Gets the element at index `n` of `array`. If `n` is negative, the nth\n     * element from the end is returned.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.11.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @param {number} [n=0] The index of the element to return.\n     * @returns {*} Returns the nth element of `array`.\n     * @example\n     *\n     * var array = ['a', 'b', 'c', 'd'];\n     *\n     * _.nth(array, 1);\n     * // => 'b'\n     *\n     * _.nth(array, -2);\n     * // => 'c';\n     */\n    function nth(array, n) {\n      return (array && array.length) ? baseNth(array, toInteger(n)) : undefined;\n    }\n\n    /**\n     * Removes all given values from `array` using\n     * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n     * for equality comparisons.\n     *\n     * **Note:** Unlike `_.without`, this method mutates `array`. Use `_.remove`\n     * to remove elements from an array by predicate.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.0.0\n     * @category Array\n     * @param {Array} array The array to modify.\n     * @param {...*} [values] The values to remove.\n     * @returns {Array} Returns `array`.\n     * @example\n     *\n     * var array = ['a', 'b', 'c', 'a', 'b', 'c'];\n     *\n     * _.pull(array, 'a', 'c');\n     * console.log(array);\n     * // => ['b', 'b']\n     */\n    var pull = baseRest(pullAll);\n\n    /**\n     * This method is like `_.pull` except that it accepts an array of values to remove.\n     *\n     * **Note:** Unlike `_.difference`, this method mutates `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to modify.\n     * @param {Array} values The values to remove.\n     * @returns {Array} Returns `array`.\n     * @example\n     *\n     * var array = ['a', 'b', 'c', 'a', 'b', 'c'];\n     *\n     * _.pullAll(array, ['a', 'c']);\n     * console.log(array);\n     * // => ['b', 'b']\n     */\n    function pullAll(array, values) {\n      return (array && array.length && values && values.length)\n        ? basePullAll(array, values)\n        : array;\n    }\n\n    /**\n     * This method is like `_.pullAll` except that it accepts `iteratee` which is\n     * invoked for each element of `array` and `values` to generate the criterion\n     * by which they're compared. The iteratee is invoked with one argument: (value).\n     *\n     * **Note:** Unlike `_.differenceBy`, this method mutates `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to modify.\n     * @param {Array} values The values to remove.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {Array} Returns `array`.\n     * @example\n     *\n     * var array = [{ 'x': 1 }, { 'x': 2 }, { 'x': 3 }, { 'x': 1 }];\n     *\n     * _.pullAllBy(array, [{ 'x': 1 }, { 'x': 3 }], 'x');\n     * console.log(array);\n     * // => [{ 'x': 2 }]\n     */\n    function pullAllBy(array, values, iteratee) {\n      return (array && array.length && values && values.length)\n        ? basePullAll(array, values, getIteratee(iteratee, 2))\n        : array;\n    }\n\n    /**\n     * This method is like `_.pullAll` except that it accepts `comparator` which\n     * is invoked to compare elements of `array` to `values`. The comparator is\n     * invoked with two arguments: (arrVal, othVal).\n     *\n     * **Note:** Unlike `_.differenceWith`, this method mutates `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.6.0\n     * @category Array\n     * @param {Array} array The array to modify.\n     * @param {Array} values The values to remove.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns `array`.\n     * @example\n     *\n     * var array = [{ 'x': 1, 'y': 2 }, { 'x': 3, 'y': 4 }, { 'x': 5, 'y': 6 }];\n     *\n     * _.pullAllWith(array, [{ 'x': 3, 'y': 4 }], _.isEqual);\n     * console.log(array);\n     * // => [{ 'x': 1, 'y': 2 }, { 'x': 5, 'y': 6 }]\n     */\n    function pullAllWith(array, values, comparator) {\n      return (array && array.length && values && values.length)\n        ? basePullAll(array, values, undefined, comparator)\n        : array;\n    }\n\n    /**\n     * Removes elements from `array` corresponding to `indexes` and returns an\n     * array of removed elements.\n     *\n     * **Note:** Unlike `_.at`, this method mutates `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The array to modify.\n     * @param {...(number|number[])} [indexes] The indexes of elements to remove.\n     * @returns {Array} Returns the new array of removed elements.\n     * @example\n     *\n     * var array = ['a', 'b', 'c', 'd'];\n     * var pulled = _.pullAt(array, [1, 3]);\n     *\n     * console.log(array);\n     * // => ['a', 'c']\n     *\n     * console.log(pulled);\n     * // => ['b', 'd']\n     */\n    var pullAt = flatRest(function(array, indexes) {\n      var length = array == null ? 0 : array.length,\n          result = baseAt(array, indexes);\n\n      basePullAt(array, arrayMap(indexes, function(index) {\n        return isIndex(index, length) ? +index : index;\n      }).sort(compareAscending));\n\n      return result;\n    });\n\n    /**\n     * Removes all elements from `array` that `predicate` returns truthy for\n     * and returns an array of the removed elements. The predicate is invoked\n     * with three arguments: (value, index, array).\n     *\n     * **Note:** Unlike `_.filter`, this method mutates `array`. Use `_.pull`\n     * to pull elements from an array by value.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.0.0\n     * @category Array\n     * @param {Array} array The array to modify.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the new array of removed elements.\n     * @example\n     *\n     * var array = [1, 2, 3, 4];\n     * var evens = _.remove(array, function(n) {\n     *   return n % 2 == 0;\n     * });\n     *\n     * console.log(array);\n     * // => [1, 3]\n     *\n     * console.log(evens);\n     * // => [2, 4]\n     */\n    function remove(array, predicate) {\n      var result = [];\n      if (!(array && array.length)) {\n        return result;\n      }\n      var index = -1,\n          indexes = [],\n          length = array.length;\n\n      predicate = getIteratee(predicate, 3);\n      while (++index < length) {\n        var value = array[index];\n        if (predicate(value, index, array)) {\n          result.push(value);\n          indexes.push(index);\n        }\n      }\n      basePullAt(array, indexes);\n      return result;\n    }\n\n    /**\n     * Reverses `array` so that the first element becomes the last, the second\n     * element becomes the second to last, and so on.\n     *\n     * **Note:** This method mutates `array` and is based on\n     * [`Array#reverse`](https://mdn.io/Array/reverse).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to modify.\n     * @returns {Array} Returns `array`.\n     * @example\n     *\n     * var array = [1, 2, 3];\n     *\n     * _.reverse(array);\n     * // => [3, 2, 1]\n     *\n     * console.log(array);\n     * // => [3, 2, 1]\n     */\n    function reverse(array) {\n      return array == null ? array : nativeReverse.call(array);\n    }\n\n    /**\n     * Creates a slice of `array` from `start` up to, but not including, `end`.\n     *\n     * **Note:** This method is used instead of\n     * [`Array#slice`](https://mdn.io/Array/slice) to ensure dense arrays are\n     * returned.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The array to slice.\n     * @param {number} [start=0] The start position.\n     * @param {number} [end=array.length] The end position.\n     * @returns {Array} Returns the slice of `array`.\n     */\n    function slice(array, start, end) {\n      var length = array == null ? 0 : array.length;\n      if (!length) {\n        return [];\n      }\n      if (end && typeof end != 'number' && isIterateeCall(array, start, end)) {\n        start = 0;\n        end = length;\n      }\n      else {\n        start = start == null ? 0 : toInteger(start);\n        end = end === undefined ? length : toInteger(end);\n      }\n      return baseSlice(array, start, end);\n    }\n\n    /**\n     * Uses a binary search to determine the lowest index at which `value`\n     * should be inserted into `array` in order to maintain its sort order.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The sorted array to inspect.\n     * @param {*} value The value to evaluate.\n     * @returns {number} Returns the index at which `value` should be inserted\n     *  into `array`.\n     * @example\n     *\n     * _.sortedIndex([30, 50], 40);\n     * // => 1\n     */\n    function sortedIndex(array, value) {\n      return baseSortedIndex(array, value);\n    }\n\n    /**\n     * This method is like `_.sortedIndex` except that it accepts `iteratee`\n     * which is invoked for `value` and each element of `array` to compute their\n     * sort ranking. The iteratee is invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The sorted array to inspect.\n     * @param {*} value The value to evaluate.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {number} Returns the index at which `value` should be inserted\n     *  into `array`.\n     * @example\n     *\n     * var objects = [{ 'x': 4 }, { 'x': 5 }];\n     *\n     * _.sortedIndexBy(objects, { 'x': 4 }, function(o) { return o.x; });\n     * // => 0\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.sortedIndexBy(objects, { 'x': 4 }, 'x');\n     * // => 0\n     */\n    function sortedIndexBy(array, value, iteratee) {\n      return baseSortedIndexBy(array, value, getIteratee(iteratee, 2));\n    }\n\n    /**\n     * This method is like `_.indexOf` except that it performs a binary\n     * search on a sorted `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {*} value The value to search for.\n     * @returns {number} Returns the index of the matched value, else `-1`.\n     * @example\n     *\n     * _.sortedIndexOf([4, 5, 5, 5, 6], 5);\n     * // => 1\n     */\n    function sortedIndexOf(array, value) {\n      var length = array == null ? 0 : array.length;\n      if (length) {\n        var index = baseSortedIndex(array, value);\n        if (index < length && eq(array[index], value)) {\n          return index;\n        }\n      }\n      return -1;\n    }\n\n    /**\n     * This method is like `_.sortedIndex` except that it returns the highest\n     * index at which `value` should be inserted into `array` in order to\n     * maintain its sort order.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The sorted array to inspect.\n     * @param {*} value The value to evaluate.\n     * @returns {number} Returns the index at which `value` should be inserted\n     *  into `array`.\n     * @example\n     *\n     * _.sortedLastIndex([4, 5, 5, 5, 6], 5);\n     * // => 4\n     */\n    function sortedLastIndex(array, value) {\n      return baseSortedIndex(array, value, true);\n    }\n\n    /**\n     * This method is like `_.sortedLastIndex` except that it accepts `iteratee`\n     * which is invoked for `value` and each element of `array` to compute their\n     * sort ranking. The iteratee is invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The sorted array to inspect.\n     * @param {*} value The value to evaluate.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {number} Returns the index at which `value` should be inserted\n     *  into `array`.\n     * @example\n     *\n     * var objects = [{ 'x': 4 }, { 'x': 5 }];\n     *\n     * _.sortedLastIndexBy(objects, { 'x': 4 }, function(o) { return o.x; });\n     * // => 1\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.sortedLastIndexBy(objects, { 'x': 4 }, 'x');\n     * // => 1\n     */\n    function sortedLastIndexBy(array, value, iteratee) {\n      return baseSortedIndexBy(array, value, getIteratee(iteratee, 2), true);\n    }\n\n    /**\n     * This method is like `_.lastIndexOf` except that it performs a binary\n     * search on a sorted `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {*} value The value to search for.\n     * @returns {number} Returns the index of the matched value, else `-1`.\n     * @example\n     *\n     * _.sortedLastIndexOf([4, 5, 5, 5, 6], 5);\n     * // => 3\n     */\n    function sortedLastIndexOf(array, value) {\n      var length = array == null ? 0 : array.length;\n      if (length) {\n        var index = baseSortedIndex(array, value, true) - 1;\n        if (eq(array[index], value)) {\n          return index;\n        }\n      }\n      return -1;\n    }\n\n    /**\n     * This method is like `_.uniq` except that it's designed and optimized\n     * for sorted arrays.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @returns {Array} Returns the new duplicate free array.\n     * @example\n     *\n     * _.sortedUniq([1, 1, 2]);\n     * // => [1, 2]\n     */\n    function sortedUniq(array) {\n      return (array && array.length)\n        ? baseSortedUniq(array)\n        : [];\n    }\n\n    /**\n     * This method is like `_.uniqBy` except that it's designed and optimized\n     * for sorted arrays.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {Function} [iteratee] The iteratee invoked per element.\n     * @returns {Array} Returns the new duplicate free array.\n     * @example\n     *\n     * _.sortedUniqBy([1.1, 1.2, 2.3, 2.4], Math.floor);\n     * // => [1.1, 2.3]\n     */\n    function sortedUniqBy(array, iteratee) {\n      return (array && array.length)\n        ? baseSortedUniq(array, getIteratee(iteratee, 2))\n        : [];\n    }\n\n    /**\n     * Gets all but the first element of `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @returns {Array} Returns the slice of `array`.\n     * @example\n     *\n     * _.tail([1, 2, 3]);\n     * // => [2, 3]\n     */\n    function tail(array) {\n      var length = array == null ? 0 : array.length;\n      return length ? baseSlice(array, 1, length) : [];\n    }\n\n    /**\n     * Creates a slice of `array` with `n` elements taken from the beginning.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @param {number} [n=1] The number of elements to take.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Array} Returns the slice of `array`.\n     * @example\n     *\n     * _.take([1, 2, 3]);\n     * // => [1]\n     *\n     * _.take([1, 2, 3], 2);\n     * // => [1, 2]\n     *\n     * _.take([1, 2, 3], 5);\n     * // => [1, 2, 3]\n     *\n     * _.take([1, 2, 3], 0);\n     * // => []\n     */\n    function take(array, n, guard) {\n      if (!(array && array.length)) {\n        return [];\n      }\n      n = (guard || n === undefined) ? 1 : toInteger(n);\n      return baseSlice(array, 0, n < 0 ? 0 : n);\n    }\n\n    /**\n     * Creates a slice of `array` with `n` elements taken from the end.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @param {number} [n=1] The number of elements to take.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Array} Returns the slice of `array`.\n     * @example\n     *\n     * _.takeRight([1, 2, 3]);\n     * // => [3]\n     *\n     * _.takeRight([1, 2, 3], 2);\n     * // => [2, 3]\n     *\n     * _.takeRight([1, 2, 3], 5);\n     * // => [1, 2, 3]\n     *\n     * _.takeRight([1, 2, 3], 0);\n     * // => []\n     */\n    function takeRight(array, n, guard) {\n      var length = array == null ? 0 : array.length;\n      if (!length) {\n        return [];\n      }\n      n = (guard || n === undefined) ? 1 : toInteger(n);\n      n = length - n;\n      return baseSlice(array, n < 0 ? 0 : n, length);\n    }\n\n    /**\n     * Creates a slice of `array` with elements taken from the end. Elements are\n     * taken until `predicate` returns falsey. The predicate is invoked with\n     * three arguments: (value, index, array).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the slice of `array`.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney',  'active': true },\n     *   { 'user': 'fred',    'active': false },\n     *   { 'user': 'pebbles', 'active': false }\n     * ];\n     *\n     * _.takeRightWhile(users, function(o) { return !o.active; });\n     * // => objects for ['fred', 'pebbles']\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.takeRightWhile(users, { 'user': 'pebbles', 'active': false });\n     * // => objects for ['pebbles']\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.takeRightWhile(users, ['active', false]);\n     * // => objects for ['fred', 'pebbles']\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.takeRightWhile(users, 'active');\n     * // => []\n     */\n    function takeRightWhile(array, predicate) {\n      return (array && array.length)\n        ? baseWhile(array, getIteratee(predicate, 3), false, true)\n        : [];\n    }\n\n    /**\n     * Creates a slice of `array` with elements taken from the beginning. Elements\n     * are taken until `predicate` returns falsey. The predicate is invoked with\n     * three arguments: (value, index, array).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Array\n     * @param {Array} array The array to query.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the slice of `array`.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney',  'active': false },\n     *   { 'user': 'fred',    'active': false },\n     *   { 'user': 'pebbles', 'active': true }\n     * ];\n     *\n     * _.takeWhile(users, function(o) { return !o.active; });\n     * // => objects for ['barney', 'fred']\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.takeWhile(users, { 'user': 'barney', 'active': false });\n     * // => objects for ['barney']\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.takeWhile(users, ['active', false]);\n     * // => objects for ['barney', 'fred']\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.takeWhile(users, 'active');\n     * // => []\n     */\n    function takeWhile(array, predicate) {\n      return (array && array.length)\n        ? baseWhile(array, getIteratee(predicate, 3))\n        : [];\n    }\n\n    /**\n     * Creates an array of unique values, in order, from all given arrays using\n     * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n     * for equality comparisons.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to inspect.\n     * @returns {Array} Returns the new array of combined values.\n     * @example\n     *\n     * _.union([2], [1, 2]);\n     * // => [2, 1]\n     */\n    var union = baseRest(function(arrays) {\n      return baseUniq(baseFlatten(arrays, 1, isArrayLikeObject, true));\n    });\n\n    /**\n     * This method is like `_.union` except that it accepts `iteratee` which is\n     * invoked for each element of each `arrays` to generate the criterion by\n     * which uniqueness is computed. Result values are chosen from the first\n     * array in which the value occurs. The iteratee is invoked with one argument:\n     * (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to inspect.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {Array} Returns the new array of combined values.\n     * @example\n     *\n     * _.unionBy([2.1], [1.2, 2.3], Math.floor);\n     * // => [2.1, 1.2]\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.unionBy([{ 'x': 1 }], [{ 'x': 2 }, { 'x': 1 }], 'x');\n     * // => [{ 'x': 1 }, { 'x': 2 }]\n     */\n    var unionBy = baseRest(function(arrays) {\n      var iteratee = last(arrays);\n      if (isArrayLikeObject(iteratee)) {\n        iteratee = undefined;\n      }\n      return baseUniq(baseFlatten(arrays, 1, isArrayLikeObject, true), getIteratee(iteratee, 2));\n    });\n\n    /**\n     * This method is like `_.union` except that it accepts `comparator` which\n     * is invoked to compare elements of `arrays`. Result values are chosen from\n     * the first array in which the value occurs. The comparator is invoked\n     * with two arguments: (arrVal, othVal).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to inspect.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns the new array of combined values.\n     * @example\n     *\n     * var objects = [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }];\n     * var others = [{ 'x': 1, 'y': 1 }, { 'x': 1, 'y': 2 }];\n     *\n     * _.unionWith(objects, others, _.isEqual);\n     * // => [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }, { 'x': 1, 'y': 1 }]\n     */\n    var unionWith = baseRest(function(arrays) {\n      var comparator = last(arrays);\n      comparator = typeof comparator == 'function' ? comparator : undefined;\n      return baseUniq(baseFlatten(arrays, 1, isArrayLikeObject, true), undefined, comparator);\n    });\n\n    /**\n     * Creates a duplicate-free version of an array, using\n     * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n     * for equality comparisons, in which only the first occurrence of each element\n     * is kept. The order of result values is determined by the order they occur\n     * in the array.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @returns {Array} Returns the new duplicate free array.\n     * @example\n     *\n     * _.uniq([2, 1, 2]);\n     * // => [2, 1]\n     */\n    function uniq(array) {\n      return (array && array.length) ? baseUniq(array) : [];\n    }\n\n    /**\n     * This method is like `_.uniq` except that it accepts `iteratee` which is\n     * invoked for each element in `array` to generate the criterion by which\n     * uniqueness is computed. The order of result values is determined by the\n     * order they occur in the array. The iteratee is invoked with one argument:\n     * (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {Array} Returns the new duplicate free array.\n     * @example\n     *\n     * _.uniqBy([2.1, 1.2, 2.3], Math.floor);\n     * // => [2.1, 1.2]\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.uniqBy([{ 'x': 1 }, { 'x': 2 }, { 'x': 1 }], 'x');\n     * // => [{ 'x': 1 }, { 'x': 2 }]\n     */\n    function uniqBy(array, iteratee) {\n      return (array && array.length) ? baseUniq(array, getIteratee(iteratee, 2)) : [];\n    }\n\n    /**\n     * This method is like `_.uniq` except that it accepts `comparator` which\n     * is invoked to compare elements of `array`. The order of result values is\n     * determined by the order they occur in the array.The comparator is invoked\n     * with two arguments: (arrVal, othVal).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns the new duplicate free array.\n     * @example\n     *\n     * var objects = [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }, { 'x': 1, 'y': 2 }];\n     *\n     * _.uniqWith(objects, _.isEqual);\n     * // => [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }]\n     */\n    function uniqWith(array, comparator) {\n      comparator = typeof comparator == 'function' ? comparator : undefined;\n      return (array && array.length) ? baseUniq(array, undefined, comparator) : [];\n    }\n\n    /**\n     * This method is like `_.zip` except that it accepts an array of grouped\n     * elements and creates an array regrouping the elements to their pre-zip\n     * configuration.\n     *\n     * @static\n     * @memberOf _\n     * @since 1.2.0\n     * @category Array\n     * @param {Array} array The array of grouped elements to process.\n     * @returns {Array} Returns the new array of regrouped elements.\n     * @example\n     *\n     * var zipped = _.zip(['a', 'b'], [1, 2], [true, false]);\n     * // => [['a', 1, true], ['b', 2, false]]\n     *\n     * _.unzip(zipped);\n     * // => [['a', 'b'], [1, 2], [true, false]]\n     */\n    function unzip(array) {\n      if (!(array && array.length)) {\n        return [];\n      }\n      var length = 0;\n      array = arrayFilter(array, function(group) {\n        if (isArrayLikeObject(group)) {\n          length = nativeMax(group.length, length);\n          return true;\n        }\n      });\n      return baseTimes(length, function(index) {\n        return arrayMap(array, baseProperty(index));\n      });\n    }\n\n    /**\n     * This method is like `_.unzip` except that it accepts `iteratee` to specify\n     * how regrouped values should be combined. The iteratee is invoked with the\n     * elements of each group: (...group).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.8.0\n     * @category Array\n     * @param {Array} array The array of grouped elements to process.\n     * @param {Function} [iteratee=_.identity] The function to combine\n     *  regrouped values.\n     * @returns {Array} Returns the new array of regrouped elements.\n     * @example\n     *\n     * var zipped = _.zip([1, 2], [10, 20], [100, 200]);\n     * // => [[1, 10, 100], [2, 20, 200]]\n     *\n     * _.unzipWith(zipped, _.add);\n     * // => [3, 30, 300]\n     */\n    function unzipWith(array, iteratee) {\n      if (!(array && array.length)) {\n        return [];\n      }\n      var result = unzip(array);\n      if (iteratee == null) {\n        return result;\n      }\n      return arrayMap(result, function(group) {\n        return apply(iteratee, undefined, group);\n      });\n    }\n\n    /**\n     * Creates an array excluding all given values using\n     * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n     * for equality comparisons.\n     *\n     * **Note:** Unlike `_.pull`, this method returns a new array.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {Array} array The array to inspect.\n     * @param {...*} [values] The values to exclude.\n     * @returns {Array} Returns the new array of filtered values.\n     * @see _.difference, _.xor\n     * @example\n     *\n     * _.without([2, 1, 2, 3], 1, 2);\n     * // => [3]\n     */\n    var without = baseRest(function(array, values) {\n      return isArrayLikeObject(array)\n        ? baseDifference(array, values)\n        : [];\n    });\n\n    /**\n     * Creates an array of unique values that is the\n     * [symmetric difference](https://en.wikipedia.org/wiki/Symmetric_difference)\n     * of the given arrays. The order of result values is determined by the order\n     * they occur in the arrays.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.4.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to inspect.\n     * @returns {Array} Returns the new array of filtered values.\n     * @see _.difference, _.without\n     * @example\n     *\n     * _.xor([2, 1], [2, 3]);\n     * // => [1, 3]\n     */\n    var xor = baseRest(function(arrays) {\n      return baseXor(arrayFilter(arrays, isArrayLikeObject));\n    });\n\n    /**\n     * This method is like `_.xor` except that it accepts `iteratee` which is\n     * invoked for each element of each `arrays` to generate the criterion by\n     * which by which they're compared. The order of result values is determined\n     * by the order they occur in the arrays. The iteratee is invoked with one\n     * argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to inspect.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {Array} Returns the new array of filtered values.\n     * @example\n     *\n     * _.xorBy([2.1, 1.2], [2.3, 3.4], Math.floor);\n     * // => [1.2, 3.4]\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.xorBy([{ 'x': 1 }], [{ 'x': 2 }, { 'x': 1 }], 'x');\n     * // => [{ 'x': 2 }]\n     */\n    var xorBy = baseRest(function(arrays) {\n      var iteratee = last(arrays);\n      if (isArrayLikeObject(iteratee)) {\n        iteratee = undefined;\n      }\n      return baseXor(arrayFilter(arrays, isArrayLikeObject), getIteratee(iteratee, 2));\n    });\n\n    /**\n     * This method is like `_.xor` except that it accepts `comparator` which is\n     * invoked to compare elements of `arrays`. The order of result values is\n     * determined by the order they occur in the arrays. The comparator is invoked\n     * with two arguments: (arrVal, othVal).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to inspect.\n     * @param {Function} [comparator] The comparator invoked per element.\n     * @returns {Array} Returns the new array of filtered values.\n     * @example\n     *\n     * var objects = [{ 'x': 1, 'y': 2 }, { 'x': 2, 'y': 1 }];\n     * var others = [{ 'x': 1, 'y': 1 }, { 'x': 1, 'y': 2 }];\n     *\n     * _.xorWith(objects, others, _.isEqual);\n     * // => [{ 'x': 2, 'y': 1 }, { 'x': 1, 'y': 1 }]\n     */\n    var xorWith = baseRest(function(arrays) {\n      var comparator = last(arrays);\n      comparator = typeof comparator == 'function' ? comparator : undefined;\n      return baseXor(arrayFilter(arrays, isArrayLikeObject), undefined, comparator);\n    });\n\n    /**\n     * Creates an array of grouped elements, the first of which contains the\n     * first elements of the given arrays, the second of which contains the\n     * second elements of the given arrays, and so on.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to process.\n     * @returns {Array} Returns the new array of grouped elements.\n     * @example\n     *\n     * _.zip(['a', 'b'], [1, 2], [true, false]);\n     * // => [['a', 1, true], ['b', 2, false]]\n     */\n    var zip = baseRest(unzip);\n\n    /**\n     * This method is like `_.fromPairs` except that it accepts two arrays,\n     * one of property identifiers and one of corresponding values.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.4.0\n     * @category Array\n     * @param {Array} [props=[]] The property identifiers.\n     * @param {Array} [values=[]] The property values.\n     * @returns {Object} Returns the new object.\n     * @example\n     *\n     * _.zipObject(['a', 'b'], [1, 2]);\n     * // => { 'a': 1, 'b': 2 }\n     */\n    function zipObject(props, values) {\n      return baseZipObject(props || [], values || [], assignValue);\n    }\n\n    /**\n     * This method is like `_.zipObject` except that it supports property paths.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.1.0\n     * @category Array\n     * @param {Array} [props=[]] The property identifiers.\n     * @param {Array} [values=[]] The property values.\n     * @returns {Object} Returns the new object.\n     * @example\n     *\n     * _.zipObjectDeep(['a.b[0].c', 'a.b[1].d'], [1, 2]);\n     * // => { 'a': { 'b': [{ 'c': 1 }, { 'd': 2 }] } }\n     */\n    function zipObjectDeep(props, values) {\n      return baseZipObject(props || [], values || [], baseSet);\n    }\n\n    /**\n     * This method is like `_.zip` except that it accepts `iteratee` to specify\n     * how grouped values should be combined. The iteratee is invoked with the\n     * elements of each group: (...group).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.8.0\n     * @category Array\n     * @param {...Array} [arrays] The arrays to process.\n     * @param {Function} [iteratee=_.identity] The function to combine\n     *  grouped values.\n     * @returns {Array} Returns the new array of grouped elements.\n     * @example\n     *\n     * _.zipWith([1, 2], [10, 20], [100, 200], function(a, b, c) {\n     *   return a + b + c;\n     * });\n     * // => [111, 222]\n     */\n    var zipWith = baseRest(function(arrays) {\n      var length = arrays.length,\n          iteratee = length > 1 ? arrays[length - 1] : undefined;\n\n      iteratee = typeof iteratee == 'function' ? (arrays.pop(), iteratee) : undefined;\n      return unzipWith(arrays, iteratee);\n    });\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Creates a `lodash` wrapper instance that wraps `value` with explicit method\n     * chain sequences enabled. The result of such sequences must be unwrapped\n     * with `_#value`.\n     *\n     * @static\n     * @memberOf _\n     * @since 1.3.0\n     * @category Seq\n     * @param {*} value The value to wrap.\n     * @returns {Object} Returns the new `lodash` wrapper instance.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney',  'age': 36 },\n     *   { 'user': 'fred',    'age': 40 },\n     *   { 'user': 'pebbles', 'age': 1 }\n     * ];\n     *\n     * var youngest = _\n     *   .chain(users)\n     *   .sortBy('age')\n     *   .map(function(o) {\n     *     return o.user + ' is ' + o.age;\n     *   })\n     *   .head()\n     *   .value();\n     * // => 'pebbles is 1'\n     */\n    function chain(value) {\n      var result = lodash(value);\n      result.__chain__ = true;\n      return result;\n    }\n\n    /**\n     * This method invokes `interceptor` and returns `value`. The interceptor\n     * is invoked with one argument; (value). The purpose of this method is to\n     * \"tap into\" a method chain sequence in order to modify intermediate results.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Seq\n     * @param {*} value The value to provide to `interceptor`.\n     * @param {Function} interceptor The function to invoke.\n     * @returns {*} Returns `value`.\n     * @example\n     *\n     * _([1, 2, 3])\n     *  .tap(function(array) {\n     *    // Mutate input array.\n     *    array.pop();\n     *  })\n     *  .reverse()\n     *  .value();\n     * // => [2, 1]\n     */\n    function tap(value, interceptor) {\n      interceptor(value);\n      return value;\n    }\n\n    /**\n     * This method is like `_.tap` except that it returns the result of `interceptor`.\n     * The purpose of this method is to \"pass thru\" values replacing intermediate\n     * results in a method chain sequence.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Seq\n     * @param {*} value The value to provide to `interceptor`.\n     * @param {Function} interceptor The function to invoke.\n     * @returns {*} Returns the result of `interceptor`.\n     * @example\n     *\n     * _('  abc  ')\n     *  .chain()\n     *  .trim()\n     *  .thru(function(value) {\n     *    return [value];\n     *  })\n     *  .value();\n     * // => ['abc']\n     */\n    function thru(value, interceptor) {\n      return interceptor(value);\n    }\n\n    /**\n     * This method is the wrapper version of `_.at`.\n     *\n     * @name at\n     * @memberOf _\n     * @since 1.0.0\n     * @category Seq\n     * @param {...(string|string[])} [paths] The property paths to pick.\n     * @returns {Object} Returns the new `lodash` wrapper instance.\n     * @example\n     *\n     * var object = { 'a': [{ 'b': { 'c': 3 } }, 4] };\n     *\n     * _(object).at(['a[0].b.c', 'a[1]']).value();\n     * // => [3, 4]\n     */\n    var wrapperAt = flatRest(function(paths) {\n      var length = paths.length,\n          start = length ? paths[0] : 0,\n          value = this.__wrapped__,\n          interceptor = function(object) { return baseAt(object, paths); };\n\n      if (length > 1 || this.__actions__.length ||\n          !(value instanceof LazyWrapper) || !isIndex(start)) {\n        return this.thru(interceptor);\n      }\n      value = value.slice(start, +start + (length ? 1 : 0));\n      value.__actions__.push({\n        'func': thru,\n        'args': [interceptor],\n        'thisArg': undefined\n      });\n      return new LodashWrapper(value, this.__chain__).thru(function(array) {\n        if (length && !array.length) {\n          array.push(undefined);\n        }\n        return array;\n      });\n    });\n\n    /**\n     * Creates a `lodash` wrapper instance with explicit method chain sequences enabled.\n     *\n     * @name chain\n     * @memberOf _\n     * @since 0.1.0\n     * @category Seq\n     * @returns {Object} Returns the new `lodash` wrapper instance.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney', 'age': 36 },\n     *   { 'user': 'fred',   'age': 40 }\n     * ];\n     *\n     * // A sequence without explicit chaining.\n     * _(users).head();\n     * // => { 'user': 'barney', 'age': 36 }\n     *\n     * // A sequence with explicit chaining.\n     * _(users)\n     *   .chain()\n     *   .head()\n     *   .pick('user')\n     *   .value();\n     * // => { 'user': 'barney' }\n     */\n    function wrapperChain() {\n      return chain(this);\n    }\n\n    /**\n     * Executes the chain sequence and returns the wrapped result.\n     *\n     * @name commit\n     * @memberOf _\n     * @since 3.2.0\n     * @category Seq\n     * @returns {Object} Returns the new `lodash` wrapper instance.\n     * @example\n     *\n     * var array = [1, 2];\n     * var wrapped = _(array).push(3);\n     *\n     * console.log(array);\n     * // => [1, 2]\n     *\n     * wrapped = wrapped.commit();\n     * console.log(array);\n     * // => [1, 2, 3]\n     *\n     * wrapped.last();\n     * // => 3\n     *\n     * console.log(array);\n     * // => [1, 2, 3]\n     */\n    function wrapperCommit() {\n      return new LodashWrapper(this.value(), this.__chain__);\n    }\n\n    /**\n     * Gets the next value on a wrapped object following the\n     * [iterator protocol](https://mdn.io/iteration_protocols#iterator).\n     *\n     * @name next\n     * @memberOf _\n     * @since 4.0.0\n     * @category Seq\n     * @returns {Object} Returns the next iterator value.\n     * @example\n     *\n     * var wrapped = _([1, 2]);\n     *\n     * wrapped.next();\n     * // => { 'done': false, 'value': 1 }\n     *\n     * wrapped.next();\n     * // => { 'done': false, 'value': 2 }\n     *\n     * wrapped.next();\n     * // => { 'done': true, 'value': undefined }\n     */\n    function wrapperNext() {\n      if (this.__values__ === undefined) {\n        this.__values__ = toArray(this.value());\n      }\n      var done = this.__index__ >= this.__values__.length,\n          value = done ? undefined : this.__values__[this.__index__++];\n\n      return { 'done': done, 'value': value };\n    }\n\n    /**\n     * Enables the wrapper to be iterable.\n     *\n     * @name Symbol.iterator\n     * @memberOf _\n     * @since 4.0.0\n     * @category Seq\n     * @returns {Object} Returns the wrapper object.\n     * @example\n     *\n     * var wrapped = _([1, 2]);\n     *\n     * wrapped[Symbol.iterator]() === wrapped;\n     * // => true\n     *\n     * Array.from(wrapped);\n     * // => [1, 2]\n     */\n    function wrapperToIterator() {\n      return this;\n    }\n\n    /**\n     * Creates a clone of the chain sequence planting `value` as the wrapped value.\n     *\n     * @name plant\n     * @memberOf _\n     * @since 3.2.0\n     * @category Seq\n     * @param {*} value The value to plant.\n     * @returns {Object} Returns the new `lodash` wrapper instance.\n     * @example\n     *\n     * function square(n) {\n     *   return n * n;\n     * }\n     *\n     * var wrapped = _([1, 2]).map(square);\n     * var other = wrapped.plant([3, 4]);\n     *\n     * other.value();\n     * // => [9, 16]\n     *\n     * wrapped.value();\n     * // => [1, 4]\n     */\n    function wrapperPlant(value) {\n      var result,\n          parent = this;\n\n      while (parent instanceof baseLodash) {\n        var clone = wrapperClone(parent);\n        clone.__index__ = 0;\n        clone.__values__ = undefined;\n        if (result) {\n          previous.__wrapped__ = clone;\n        } else {\n          result = clone;\n        }\n        var previous = clone;\n        parent = parent.__wrapped__;\n      }\n      previous.__wrapped__ = value;\n      return result;\n    }\n\n    /**\n     * This method is the wrapper version of `_.reverse`.\n     *\n     * **Note:** This method mutates the wrapped array.\n     *\n     * @name reverse\n     * @memberOf _\n     * @since 0.1.0\n     * @category Seq\n     * @returns {Object} Returns the new `lodash` wrapper instance.\n     * @example\n     *\n     * var array = [1, 2, 3];\n     *\n     * _(array).reverse().value()\n     * // => [3, 2, 1]\n     *\n     * console.log(array);\n     * // => [3, 2, 1]\n     */\n    function wrapperReverse() {\n      var value = this.__wrapped__;\n      if (value instanceof LazyWrapper) {\n        var wrapped = value;\n        if (this.__actions__.length) {\n          wrapped = new LazyWrapper(this);\n        }\n        wrapped = wrapped.reverse();\n        wrapped.__actions__.push({\n          'func': thru,\n          'args': [reverse],\n          'thisArg': undefined\n        });\n        return new LodashWrapper(wrapped, this.__chain__);\n      }\n      return this.thru(reverse);\n    }\n\n    /**\n     * Executes the chain sequence to resolve the unwrapped value.\n     *\n     * @name value\n     * @memberOf _\n     * @since 0.1.0\n     * @alias toJSON, valueOf\n     * @category Seq\n     * @returns {*} Returns the resolved unwrapped value.\n     * @example\n     *\n     * _([1, 2, 3]).value();\n     * // => [1, 2, 3]\n     */\n    function wrapperValue() {\n      return baseWrapperValue(this.__wrapped__, this.__actions__);\n    }\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Creates an object composed of keys generated from the results of running\n     * each element of `collection` thru `iteratee`. The corresponding value of\n     * each key is the number of times the key was returned by `iteratee`. The\n     * iteratee is invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 0.5.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The iteratee to transform keys.\n     * @returns {Object} Returns the composed aggregate object.\n     * @example\n     *\n     * _.countBy([6.1, 4.2, 6.3], Math.floor);\n     * // => { '4': 1, '6': 2 }\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.countBy(['one', 'two', 'three'], 'length');\n     * // => { '3': 2, '5': 1 }\n     */\n    var countBy = createAggregator(function(result, value, key) {\n      if (hasOwnProperty.call(result, key)) {\n        ++result[key];\n      } else {\n        baseAssignValue(result, key, 1);\n      }\n    });\n\n    /**\n     * Checks if `predicate` returns truthy for **all** elements of `collection`.\n     * Iteration is stopped once `predicate` returns falsey. The predicate is\n     * invoked with three arguments: (value, index|key, collection).\n     *\n     * **Note:** This method returns `true` for\n     * [empty collections](https://en.wikipedia.org/wiki/Empty_set) because\n     * [everything is true](https://en.wikipedia.org/wiki/Vacuous_truth) of\n     * elements of empty collections.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {boolean} Returns `true` if all elements pass the predicate check,\n     *  else `false`.\n     * @example\n     *\n     * _.every([true, 1, null, 'yes'], Boolean);\n     * // => false\n     *\n     * var users = [\n     *   { 'user': 'barney', 'age': 36, 'active': false },\n     *   { 'user': 'fred',   'age': 40, 'active': false }\n     * ];\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.every(users, { 'user': 'barney', 'active': false });\n     * // => false\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.every(users, ['active', false]);\n     * // => true\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.every(users, 'active');\n     * // => false\n     */\n    function every(collection, predicate, guard) {\n      var func = isArray(collection) ? arrayEvery : baseEvery;\n      if (guard && isIterateeCall(collection, predicate, guard)) {\n        predicate = undefined;\n      }\n      return func(collection, getIteratee(predicate, 3));\n    }\n\n    /**\n     * Iterates over elements of `collection`, returning an array of all elements\n     * `predicate` returns truthy for. The predicate is invoked with three\n     * arguments: (value, index|key, collection).\n     *\n     * **Note:** Unlike `_.remove`, this method returns a new array.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the new filtered array.\n     * @see _.reject\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney', 'age': 36, 'active': true },\n     *   { 'user': 'fred',   'age': 40, 'active': false }\n     * ];\n     *\n     * _.filter(users, function(o) { return !o.active; });\n     * // => objects for ['fred']\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.filter(users, { 'age': 36, 'active': true });\n     * // => objects for ['barney']\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.filter(users, ['active', false]);\n     * // => objects for ['fred']\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.filter(users, 'active');\n     * // => objects for ['barney']\n     */\n    function filter(collection, predicate) {\n      var func = isArray(collection) ? arrayFilter : baseFilter;\n      return func(collection, getIteratee(predicate, 3));\n    }\n\n    /**\n     * Iterates over elements of `collection`, returning the first element\n     * `predicate` returns truthy for. The predicate is invoked with three\n     * arguments: (value, index|key, collection).\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to inspect.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @param {number} [fromIndex=0] The index to search from.\n     * @returns {*} Returns the matched element, else `undefined`.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney',  'age': 36, 'active': true },\n     *   { 'user': 'fred',    'age': 40, 'active': false },\n     *   { 'user': 'pebbles', 'age': 1,  'active': true }\n     * ];\n     *\n     * _.find(users, function(o) { return o.age < 40; });\n     * // => object for 'barney'\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.find(users, { 'age': 1, 'active': true });\n     * // => object for 'pebbles'\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.find(users, ['active', false]);\n     * // => object for 'fred'\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.find(users, 'active');\n     * // => object for 'barney'\n     */\n    var find = createFind(findIndex);\n\n    /**\n     * This method is like `_.find` except that it iterates over elements of\n     * `collection` from right to left.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.0.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to inspect.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @param {number} [fromIndex=collection.length-1] The index to search from.\n     * @returns {*} Returns the matched element, else `undefined`.\n     * @example\n     *\n     * _.findLast([1, 2, 3, 4], function(n) {\n     *   return n % 2 == 1;\n     * });\n     * // => 3\n     */\n    var findLast = createFind(findLastIndex);\n\n    /**\n     * Creates a flattened array of values by running each element in `collection`\n     * thru `iteratee` and flattening the mapped results. The iteratee is invoked\n     * with three arguments: (value, index|key, collection).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the new flattened array.\n     * @example\n     *\n     * function duplicate(n) {\n     *   return [n, n];\n     * }\n     *\n     * _.flatMap([1, 2], duplicate);\n     * // => [1, 1, 2, 2]\n     */\n    function flatMap(collection, iteratee) {\n      return baseFlatten(map(collection, iteratee), 1);\n    }\n\n    /**\n     * This method is like `_.flatMap` except that it recursively flattens the\n     * mapped results.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.7.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the new flattened array.\n     * @example\n     *\n     * function duplicate(n) {\n     *   return [[[n, n]]];\n     * }\n     *\n     * _.flatMapDeep([1, 2], duplicate);\n     * // => [1, 1, 2, 2]\n     */\n    function flatMapDeep(collection, iteratee) {\n      return baseFlatten(map(collection, iteratee), INFINITY);\n    }\n\n    /**\n     * This method is like `_.flatMap` except that it recursively flattens the\n     * mapped results up to `depth` times.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.7.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @param {number} [depth=1] The maximum recursion depth.\n     * @returns {Array} Returns the new flattened array.\n     * @example\n     *\n     * function duplicate(n) {\n     *   return [[[n, n]]];\n     * }\n     *\n     * _.flatMapDepth([1, 2], duplicate, 2);\n     * // => [[1, 1], [2, 2]]\n     */\n    function flatMapDepth(collection, iteratee, depth) {\n      depth = depth === undefined ? 1 : toInteger(depth);\n      return baseFlatten(map(collection, iteratee), depth);\n    }\n\n    /**\n     * Iterates over elements of `collection` and invokes `iteratee` for each element.\n     * The iteratee is invoked with three arguments: (value, index|key, collection).\n     * Iteratee functions may exit iteration early by explicitly returning `false`.\n     *\n     * **Note:** As with other \"Collections\" methods, objects with a \"length\"\n     * property are iterated like arrays. To avoid this behavior use `_.forIn`\n     * or `_.forOwn` for object iteration.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @alias each\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Array|Object} Returns `collection`.\n     * @see _.forEachRight\n     * @example\n     *\n     * _.forEach([1, 2], function(value) {\n     *   console.log(value);\n     * });\n     * // => Logs `1` then `2`.\n     *\n     * _.forEach({ 'a': 1, 'b': 2 }, function(value, key) {\n     *   console.log(key);\n     * });\n     * // => Logs 'a' then 'b' (iteration order is not guaranteed).\n     */\n    function forEach(collection, iteratee) {\n      var func = isArray(collection) ? arrayEach : baseEach;\n      return func(collection, getIteratee(iteratee, 3));\n    }\n\n    /**\n     * This method is like `_.forEach` except that it iterates over elements of\n     * `collection` from right to left.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.0.0\n     * @alias eachRight\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Array|Object} Returns `collection`.\n     * @see _.forEach\n     * @example\n     *\n     * _.forEachRight([1, 2], function(value) {\n     *   console.log(value);\n     * });\n     * // => Logs `2` then `1`.\n     */\n    function forEachRight(collection, iteratee) {\n      var func = isArray(collection) ? arrayEachRight : baseEachRight;\n      return func(collection, getIteratee(iteratee, 3));\n    }\n\n    /**\n     * Creates an object composed of keys generated from the results of running\n     * each element of `collection` thru `iteratee`. The order of grouped values\n     * is determined by the order they occur in `collection`. The corresponding\n     * value of each key is an array of elements responsible for generating the\n     * key. The iteratee is invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The iteratee to transform keys.\n     * @returns {Object} Returns the composed aggregate object.\n     * @example\n     *\n     * _.groupBy([6.1, 4.2, 6.3], Math.floor);\n     * // => { '4': [4.2], '6': [6.1, 6.3] }\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.groupBy(['one', 'two', 'three'], 'length');\n     * // => { '3': ['one', 'two'], '5': ['three'] }\n     */\n    var groupBy = createAggregator(function(result, value, key) {\n      if (hasOwnProperty.call(result, key)) {\n        result[key].push(value);\n      } else {\n        baseAssignValue(result, key, [value]);\n      }\n    });\n\n    /**\n     * Checks if `value` is in `collection`. If `collection` is a string, it's\n     * checked for a substring of `value`, otherwise\n     * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n     * is used for equality comparisons. If `fromIndex` is negative, it's used as\n     * the offset from the end of `collection`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object|string} collection The collection to inspect.\n     * @param {*} value The value to search for.\n     * @param {number} [fromIndex=0] The index to search from.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.reduce`.\n     * @returns {boolean} Returns `true` if `value` is found, else `false`.\n     * @example\n     *\n     * _.includes([1, 2, 3], 1);\n     * // => true\n     *\n     * _.includes([1, 2, 3], 1, 2);\n     * // => false\n     *\n     * _.includes({ 'a': 1, 'b': 2 }, 1);\n     * // => true\n     *\n     * _.includes('abcd', 'bc');\n     * // => true\n     */\n    function includes(collection, value, fromIndex, guard) {\n      collection = isArrayLike(collection) ? collection : values(collection);\n      fromIndex = (fromIndex && !guard) ? toInteger(fromIndex) : 0;\n\n      var length = collection.length;\n      if (fromIndex < 0) {\n        fromIndex = nativeMax(length + fromIndex, 0);\n      }\n      return isString(collection)\n        ? (fromIndex <= length && collection.indexOf(value, fromIndex) > -1)\n        : (!!length && baseIndexOf(collection, value, fromIndex) > -1);\n    }\n\n    /**\n     * Invokes the method at `path` of each element in `collection`, returning\n     * an array of the results of each invoked method. Any additional arguments\n     * are provided to each invoked method. If `path` is a function, it's invoked\n     * for, and `this` bound to, each element in `collection`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Array|Function|string} path The path of the method to invoke or\n     *  the function invoked per iteration.\n     * @param {...*} [args] The arguments to invoke each method with.\n     * @returns {Array} Returns the array of results.\n     * @example\n     *\n     * _.invokeMap([[5, 1, 7], [3, 2, 1]], 'sort');\n     * // => [[1, 5, 7], [1, 2, 3]]\n     *\n     * _.invokeMap([123, 456], String.prototype.split, '');\n     * // => [['1', '2', '3'], ['4', '5', '6']]\n     */\n    var invokeMap = baseRest(function(collection, path, args) {\n      var index = -1,\n          isFunc = typeof path == 'function',\n          result = isArrayLike(collection) ? Array(collection.length) : [];\n\n      baseEach(collection, function(value) {\n        result[++index] = isFunc ? apply(path, value, args) : baseInvoke(value, path, args);\n      });\n      return result;\n    });\n\n    /**\n     * Creates an object composed of keys generated from the results of running\n     * each element of `collection` thru `iteratee`. The corresponding value of\n     * each key is the last element responsible for generating the key. The\n     * iteratee is invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The iteratee to transform keys.\n     * @returns {Object} Returns the composed aggregate object.\n     * @example\n     *\n     * var array = [\n     *   { 'dir': 'left', 'code': 97 },\n     *   { 'dir': 'right', 'code': 100 }\n     * ];\n     *\n     * _.keyBy(array, function(o) {\n     *   return String.fromCharCode(o.code);\n     * });\n     * // => { 'a': { 'dir': 'left', 'code': 97 }, 'd': { 'dir': 'right', 'code': 100 } }\n     *\n     * _.keyBy(array, 'dir');\n     * // => { 'left': { 'dir': 'left', 'code': 97 }, 'right': { 'dir': 'right', 'code': 100 } }\n     */\n    var keyBy = createAggregator(function(result, value, key) {\n      baseAssignValue(result, key, value);\n    });\n\n    /**\n     * Creates an array of values by running each element in `collection` thru\n     * `iteratee`. The iteratee is invoked with three arguments:\n     * (value, index|key, collection).\n     *\n     * Many lodash methods are guarded to work as iteratees for methods like\n     * `_.every`, `_.filter`, `_.map`, `_.mapValues`, `_.reject`, and `_.some`.\n     *\n     * The guarded methods are:\n     * `ary`, `chunk`, `curry`, `curryRight`, `drop`, `dropRight`, `every`,\n     * `fill`, `invert`, `parseInt`, `random`, `range`, `rangeRight`, `repeat`,\n     * `sampleSize`, `slice`, `some`, `sortBy`, `split`, `take`, `takeRight`,\n     * `template`, `trim`, `trimEnd`, `trimStart`, and `words`\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the new mapped array.\n     * @example\n     *\n     * function square(n) {\n     *   return n * n;\n     * }\n     *\n     * _.map([4, 8], square);\n     * // => [16, 64]\n     *\n     * _.map({ 'a': 4, 'b': 8 }, square);\n     * // => [16, 64] (iteration order is not guaranteed)\n     *\n     * var users = [\n     *   { 'user': 'barney' },\n     *   { 'user': 'fred' }\n     * ];\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.map(users, 'user');\n     * // => ['barney', 'fred']\n     */\n    function map(collection, iteratee) {\n      var func = isArray(collection) ? arrayMap : baseMap;\n      return func(collection, getIteratee(iteratee, 3));\n    }\n\n    /**\n     * This method is like `_.sortBy` except that it allows specifying the sort\n     * orders of the iteratees to sort by. If `orders` is unspecified, all values\n     * are sorted in ascending order. Otherwise, specify an order of \"desc\" for\n     * descending or \"asc\" for ascending sort order of corresponding values.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Array[]|Function[]|Object[]|string[]} [iteratees=[_.identity]]\n     *  The iteratees to sort by.\n     * @param {string[]} [orders] The sort orders of `iteratees`.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.reduce`.\n     * @returns {Array} Returns the new sorted array.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'fred',   'age': 48 },\n     *   { 'user': 'barney', 'age': 34 },\n     *   { 'user': 'fred',   'age': 40 },\n     *   { 'user': 'barney', 'age': 36 }\n     * ];\n     *\n     * // Sort by `user` in ascending order and by `age` in descending order.\n     * _.orderBy(users, ['user', 'age'], ['asc', 'desc']);\n     * // => objects for [['barney', 36], ['barney', 34], ['fred', 48], ['fred', 40]]\n     */\n    function orderBy(collection, iteratees, orders, guard) {\n      if (collection == null) {\n        return [];\n      }\n      if (!isArray(iteratees)) {\n        iteratees = iteratees == null ? [] : [iteratees];\n      }\n      orders = guard ? undefined : orders;\n      if (!isArray(orders)) {\n        orders = orders == null ? [] : [orders];\n      }\n      return baseOrderBy(collection, iteratees, orders);\n    }\n\n    /**\n     * Creates an array of elements split into two groups, the first of which\n     * contains elements `predicate` returns truthy for, the second of which\n     * contains elements `predicate` returns falsey for. The predicate is\n     * invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the array of grouped elements.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney',  'age': 36, 'active': false },\n     *   { 'user': 'fred',    'age': 40, 'active': true },\n     *   { 'user': 'pebbles', 'age': 1,  'active': false }\n     * ];\n     *\n     * _.partition(users, function(o) { return o.active; });\n     * // => objects for [['fred'], ['barney', 'pebbles']]\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.partition(users, { 'age': 1, 'active': false });\n     * // => objects for [['pebbles'], ['barney', 'fred']]\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.partition(users, ['active', false]);\n     * // => objects for [['barney', 'pebbles'], ['fred']]\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.partition(users, 'active');\n     * // => objects for [['fred'], ['barney', 'pebbles']]\n     */\n    var partition = createAggregator(function(result, value, key) {\n      result[key ? 0 : 1].push(value);\n    }, function() { return [[], []]; });\n\n    /**\n     * Reduces `collection` to a value which is the accumulated result of running\n     * each element in `collection` thru `iteratee`, where each successive\n     * invocation is supplied the return value of the previous. If `accumulator`\n     * is not given, the first element of `collection` is used as the initial\n     * value. The iteratee is invoked with four arguments:\n     * (accumulator, value, index|key, collection).\n     *\n     * Many lodash methods are guarded to work as iteratees for methods like\n     * `_.reduce`, `_.reduceRight`, and `_.transform`.\n     *\n     * The guarded methods are:\n     * `assign`, `defaults`, `defaultsDeep`, `includes`, `merge`, `orderBy`,\n     * and `sortBy`\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @param {*} [accumulator] The initial value.\n     * @returns {*} Returns the accumulated value.\n     * @see _.reduceRight\n     * @example\n     *\n     * _.reduce([1, 2], function(sum, n) {\n     *   return sum + n;\n     * }, 0);\n     * // => 3\n     *\n     * _.reduce({ 'a': 1, 'b': 2, 'c': 1 }, function(result, value, key) {\n     *   (result[value] || (result[value] = [])).push(key);\n     *   return result;\n     * }, {});\n     * // => { '1': ['a', 'c'], '2': ['b'] } (iteration order is not guaranteed)\n     */\n    function reduce(collection, iteratee, accumulator) {\n      var func = isArray(collection) ? arrayReduce : baseReduce,\n          initAccum = arguments.length < 3;\n\n      return func(collection, getIteratee(iteratee, 4), accumulator, initAccum, baseEach);\n    }\n\n    /**\n     * This method is like `_.reduce` except that it iterates over elements of\n     * `collection` from right to left.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @param {*} [accumulator] The initial value.\n     * @returns {*} Returns the accumulated value.\n     * @see _.reduce\n     * @example\n     *\n     * var array = [[0, 1], [2, 3], [4, 5]];\n     *\n     * _.reduceRight(array, function(flattened, other) {\n     *   return flattened.concat(other);\n     * }, []);\n     * // => [4, 5, 2, 3, 0, 1]\n     */\n    function reduceRight(collection, iteratee, accumulator) {\n      var func = isArray(collection) ? arrayReduceRight : baseReduce,\n          initAccum = arguments.length < 3;\n\n      return func(collection, getIteratee(iteratee, 4), accumulator, initAccum, baseEachRight);\n    }\n\n    /**\n     * The opposite of `_.filter`; this method returns the elements of `collection`\n     * that `predicate` does **not** return truthy for.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the new filtered array.\n     * @see _.filter\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney', 'age': 36, 'active': false },\n     *   { 'user': 'fred',   'age': 40, 'active': true }\n     * ];\n     *\n     * _.reject(users, function(o) { return !o.active; });\n     * // => objects for ['fred']\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.reject(users, { 'age': 40, 'active': true });\n     * // => objects for ['barney']\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.reject(users, ['active', false]);\n     * // => objects for ['fred']\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.reject(users, 'active');\n     * // => objects for ['barney']\n     */\n    function reject(collection, predicate) {\n      var func = isArray(collection) ? arrayFilter : baseFilter;\n      return func(collection, negate(getIteratee(predicate, 3)));\n    }\n\n    /**\n     * Gets a random element from `collection`.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.0.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to sample.\n     * @returns {*} Returns the random element.\n     * @example\n     *\n     * _.sample([1, 2, 3, 4]);\n     * // => 2\n     */\n    function sample(collection) {\n      var func = isArray(collection) ? arraySample : baseSample;\n      return func(collection);\n    }\n\n    /**\n     * Gets `n` random elements at unique keys from `collection` up to the\n     * size of `collection`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to sample.\n     * @param {number} [n=1] The number of elements to sample.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Array} Returns the random elements.\n     * @example\n     *\n     * _.sampleSize([1, 2, 3], 2);\n     * // => [3, 1]\n     *\n     * _.sampleSize([1, 2, 3], 4);\n     * // => [2, 3, 1]\n     */\n    function sampleSize(collection, n, guard) {\n      if ((guard ? isIterateeCall(collection, n, guard) : n === undefined)) {\n        n = 1;\n      } else {\n        n = toInteger(n);\n      }\n      var func = isArray(collection) ? arraySampleSize : baseSampleSize;\n      return func(collection, n);\n    }\n\n    /**\n     * Creates an array of shuffled values, using a version of the\n     * [Fisher-Yates shuffle](https://en.wikipedia.org/wiki/Fisher-Yates_shuffle).\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to shuffle.\n     * @returns {Array} Returns the new shuffled array.\n     * @example\n     *\n     * _.shuffle([1, 2, 3, 4]);\n     * // => [4, 1, 3, 2]\n     */\n    function shuffle(collection) {\n      var func = isArray(collection) ? arrayShuffle : baseShuffle;\n      return func(collection);\n    }\n\n    /**\n     * Gets the size of `collection` by returning its length for array-like\n     * values or the number of own enumerable string keyed properties for objects.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object|string} collection The collection to inspect.\n     * @returns {number} Returns the collection size.\n     * @example\n     *\n     * _.size([1, 2, 3]);\n     * // => 3\n     *\n     * _.size({ 'a': 1, 'b': 2 });\n     * // => 2\n     *\n     * _.size('pebbles');\n     * // => 7\n     */\n    function size(collection) {\n      if (collection == null) {\n        return 0;\n      }\n      if (isArrayLike(collection)) {\n        return isString(collection) ? stringSize(collection) : collection.length;\n      }\n      var tag = getTag(collection);\n      if (tag == mapTag || tag == setTag) {\n        return collection.size;\n      }\n      return baseKeys(collection).length;\n    }\n\n    /**\n     * Checks if `predicate` returns truthy for **any** element of `collection`.\n     * Iteration is stopped once `predicate` returns truthy. The predicate is\n     * invoked with three arguments: (value, index|key, collection).\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {boolean} Returns `true` if any element passes the predicate check,\n     *  else `false`.\n     * @example\n     *\n     * _.some([null, 0, 'yes', false], Boolean);\n     * // => true\n     *\n     * var users = [\n     *   { 'user': 'barney', 'active': true },\n     *   { 'user': 'fred',   'active': false }\n     * ];\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.some(users, { 'user': 'barney', 'active': false });\n     * // => false\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.some(users, ['active', false]);\n     * // => true\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.some(users, 'active');\n     * // => true\n     */\n    function some(collection, predicate, guard) {\n      var func = isArray(collection) ? arraySome : baseSome;\n      if (guard && isIterateeCall(collection, predicate, guard)) {\n        predicate = undefined;\n      }\n      return func(collection, getIteratee(predicate, 3));\n    }\n\n    /**\n     * Creates an array of elements, sorted in ascending order by the results of\n     * running each element in a collection thru each iteratee. This method\n     * performs a stable sort, that is, it preserves the original sort order of\n     * equal elements. The iteratees are invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Collection\n     * @param {Array|Object} collection The collection to iterate over.\n     * @param {...(Function|Function[])} [iteratees=[_.identity]]\n     *  The iteratees to sort by.\n     * @returns {Array} Returns the new sorted array.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'fred',   'age': 48 },\n     *   { 'user': 'barney', 'age': 36 },\n     *   { 'user': 'fred',   'age': 40 },\n     *   { 'user': 'barney', 'age': 34 }\n     * ];\n     *\n     * _.sortBy(users, [function(o) { return o.user; }]);\n     * // => objects for [['barney', 36], ['barney', 34], ['fred', 48], ['fred', 40]]\n     *\n     * _.sortBy(users, ['user', 'age']);\n     * // => objects for [['barney', 34], ['barney', 36], ['fred', 40], ['fred', 48]]\n     */\n    var sortBy = baseRest(function(collection, iteratees) {\n      if (collection == null) {\n        return [];\n      }\n      var length = iteratees.length;\n      if (length > 1 && isIterateeCall(collection, iteratees[0], iteratees[1])) {\n        iteratees = [];\n      } else if (length > 2 && isIterateeCall(iteratees[0], iteratees[1], iteratees[2])) {\n        iteratees = [iteratees[0]];\n      }\n      return baseOrderBy(collection, baseFlatten(iteratees, 1), []);\n    });\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Gets the timestamp of the number of milliseconds that have elapsed since\n     * the Unix epoch (1 January 1970 00:00:00 UTC).\n     *\n     * @static\n     * @memberOf _\n     * @since 2.4.0\n     * @category Date\n     * @returns {number} Returns the timestamp.\n     * @example\n     *\n     * _.defer(function(stamp) {\n     *   console.log(_.now() - stamp);\n     * }, _.now());\n     * // => Logs the number of milliseconds it took for the deferred invocation.\n     */\n    var now = ctxNow || function() {\n      return root.Date.now();\n    };\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * The opposite of `_.before`; this method creates a function that invokes\n     * `func` once it's called `n` or more times.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Function\n     * @param {number} n The number of calls before `func` is invoked.\n     * @param {Function} func The function to restrict.\n     * @returns {Function} Returns the new restricted function.\n     * @example\n     *\n     * var saves = ['profile', 'settings'];\n     *\n     * var done = _.after(saves.length, function() {\n     *   console.log('done saving!');\n     * });\n     *\n     * _.forEach(saves, function(type) {\n     *   asyncSave({ 'type': type, 'complete': done });\n     * });\n     * // => Logs 'done saving!' after the two async saves have completed.\n     */\n    function after(n, func) {\n      if (typeof func != 'function') {\n        throw new TypeError(FUNC_ERROR_TEXT);\n      }\n      n = toInteger(n);\n      return function() {\n        if (--n < 1) {\n          return func.apply(this, arguments);\n        }\n      };\n    }\n\n    /**\n     * Creates a function that invokes `func`, with up to `n` arguments,\n     * ignoring any additional arguments.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Function\n     * @param {Function} func The function to cap arguments for.\n     * @param {number} [n=func.length] The arity cap.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Function} Returns the new capped function.\n     * @example\n     *\n     * _.map(['6', '8', '10'], _.ary(parseInt, 1));\n     * // => [6, 8, 10]\n     */\n    function ary(func, n, guard) {\n      n = guard ? undefined : n;\n      n = (func && n == null) ? func.length : n;\n      return createWrap(func, WRAP_ARY_FLAG, undefined, undefined, undefined, undefined, n);\n    }\n\n    /**\n     * Creates a function that invokes `func`, with the `this` binding and arguments\n     * of the created function, while it's called less than `n` times. Subsequent\n     * calls to the created function return the result of the last `func` invocation.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Function\n     * @param {number} n The number of calls at which `func` is no longer invoked.\n     * @param {Function} func The function to restrict.\n     * @returns {Function} Returns the new restricted function.\n     * @example\n     *\n     * jQuery(element).on('click', _.before(5, addContactToList));\n     * // => Allows adding up to 4 contacts to the list.\n     */\n    function before(n, func) {\n      var result;\n      if (typeof func != 'function') {\n        throw new TypeError(FUNC_ERROR_TEXT);\n      }\n      n = toInteger(n);\n      return function() {\n        if (--n > 0) {\n          result = func.apply(this, arguments);\n        }\n        if (n <= 1) {\n          func = undefined;\n        }\n        return result;\n      };\n    }\n\n    /**\n     * Creates a function that invokes `func` with the `this` binding of `thisArg`\n     * and `partials` prepended to the arguments it receives.\n     *\n     * The `_.bind.placeholder` value, which defaults to `_` in monolithic builds,\n     * may be used as a placeholder for partially applied arguments.\n     *\n     * **Note:** Unlike native `Function#bind`, this method doesn't set the \"length\"\n     * property of bound functions.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Function\n     * @param {Function} func The function to bind.\n     * @param {*} thisArg The `this` binding of `func`.\n     * @param {...*} [partials] The arguments to be partially applied.\n     * @returns {Function} Returns the new bound function.\n     * @example\n     *\n     * function greet(greeting, punctuation) {\n     *   return greeting + ' ' + this.user + punctuation;\n     * }\n     *\n     * var object = { 'user': 'fred' };\n     *\n     * var bound = _.bind(greet, object, 'hi');\n     * bound('!');\n     * // => 'hi fred!'\n     *\n     * // Bound with placeholders.\n     * var bound = _.bind(greet, object, _, '!');\n     * bound('hi');\n     * // => 'hi fred!'\n     */\n    var bind = baseRest(function(func, thisArg, partials) {\n      var bitmask = WRAP_BIND_FLAG;\n      if (partials.length) {\n        var holders = replaceHolders(partials, getHolder(bind));\n        bitmask |= WRAP_PARTIAL_FLAG;\n      }\n      return createWrap(func, bitmask, thisArg, partials, holders);\n    });\n\n    /**\n     * Creates a function that invokes the method at `object[key]` with `partials`\n     * prepended to the arguments it receives.\n     *\n     * This method differs from `_.bind` by allowing bound functions to reference\n     * methods that may be redefined or don't yet exist. See\n     * [Peter Michaux's article](http://peter.michaux.ca/articles/lazy-function-definition-pattern)\n     * for more details.\n     *\n     * The `_.bindKey.placeholder` value, which defaults to `_` in monolithic\n     * builds, may be used as a placeholder for partially applied arguments.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.10.0\n     * @category Function\n     * @param {Object} object The object to invoke the method on.\n     * @param {string} key The key of the method.\n     * @param {...*} [partials] The arguments to be partially applied.\n     * @returns {Function} Returns the new bound function.\n     * @example\n     *\n     * var object = {\n     *   'user': 'fred',\n     *   'greet': function(greeting, punctuation) {\n     *     return greeting + ' ' + this.user + punctuation;\n     *   }\n     * };\n     *\n     * var bound = _.bindKey(object, 'greet', 'hi');\n     * bound('!');\n     * // => 'hi fred!'\n     *\n     * object.greet = function(greeting, punctuation) {\n     *   return greeting + 'ya ' + this.user + punctuation;\n     * };\n     *\n     * bound('!');\n     * // => 'hiya fred!'\n     *\n     * // Bound with placeholders.\n     * var bound = _.bindKey(object, 'greet', _, '!');\n     * bound('hi');\n     * // => 'hiya fred!'\n     */\n    var bindKey = baseRest(function(object, key, partials) {\n      var bitmask = WRAP_BIND_FLAG | WRAP_BIND_KEY_FLAG;\n      if (partials.length) {\n        var holders = replaceHolders(partials, getHolder(bindKey));\n        bitmask |= WRAP_PARTIAL_FLAG;\n      }\n      return createWrap(key, bitmask, object, partials, holders);\n    });\n\n    /**\n     * Creates a function that accepts arguments of `func` and either invokes\n     * `func` returning its result, if at least `arity` number of arguments have\n     * been provided, or returns a function that accepts the remaining `func`\n     * arguments, and so on. The arity of `func` may be specified if `func.length`\n     * is not sufficient.\n     *\n     * The `_.curry.placeholder` value, which defaults to `_` in monolithic builds,\n     * may be used as a placeholder for provided arguments.\n     *\n     * **Note:** This method doesn't set the \"length\" property of curried functions.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.0.0\n     * @category Function\n     * @param {Function} func The function to curry.\n     * @param {number} [arity=func.length] The arity of `func`.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Function} Returns the new curried function.\n     * @example\n     *\n     * var abc = function(a, b, c) {\n     *   return [a, b, c];\n     * };\n     *\n     * var curried = _.curry(abc);\n     *\n     * curried(1)(2)(3);\n     * // => [1, 2, 3]\n     *\n     * curried(1, 2)(3);\n     * // => [1, 2, 3]\n     *\n     * curried(1, 2, 3);\n     * // => [1, 2, 3]\n     *\n     * // Curried with placeholders.\n     * curried(1)(_, 3)(2);\n     * // => [1, 2, 3]\n     */\n    function curry(func, arity, guard) {\n      arity = guard ? undefined : arity;\n      var result = createWrap(func, WRAP_CURRY_FLAG, undefined, undefined, undefined, undefined, undefined, arity);\n      result.placeholder = curry.placeholder;\n      return result;\n    }\n\n    /**\n     * This method is like `_.curry` except that arguments are applied to `func`\n     * in the manner of `_.partialRight` instead of `_.partial`.\n     *\n     * The `_.curryRight.placeholder` value, which defaults to `_` in monolithic\n     * builds, may be used as a placeholder for provided arguments.\n     *\n     * **Note:** This method doesn't set the \"length\" property of curried functions.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Function\n     * @param {Function} func The function to curry.\n     * @param {number} [arity=func.length] The arity of `func`.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Function} Returns the new curried function.\n     * @example\n     *\n     * var abc = function(a, b, c) {\n     *   return [a, b, c];\n     * };\n     *\n     * var curried = _.curryRight(abc);\n     *\n     * curried(3)(2)(1);\n     * // => [1, 2, 3]\n     *\n     * curried(2, 3)(1);\n     * // => [1, 2, 3]\n     *\n     * curried(1, 2, 3);\n     * // => [1, 2, 3]\n     *\n     * // Curried with placeholders.\n     * curried(3)(1, _)(2);\n     * // => [1, 2, 3]\n     */\n    function curryRight(func, arity, guard) {\n      arity = guard ? undefined : arity;\n      var result = createWrap(func, WRAP_CURRY_RIGHT_FLAG, undefined, undefined, undefined, undefined, undefined, arity);\n      result.placeholder = curryRight.placeholder;\n      return result;\n    }\n\n    /**\n     * Creates a debounced function that delays invoking `func` until after `wait`\n     * milliseconds have elapsed since the last time the debounced function was\n     * invoked. The debounced function comes with a `cancel` method to cancel\n     * delayed `func` invocations and a `flush` method to immediately invoke them.\n     * Provide `options` to indicate whether `func` should be invoked on the\n     * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n     * with the last arguments provided to the debounced function. Subsequent\n     * calls to the debounced function return the result of the last `func`\n     * invocation.\n     *\n     * **Note:** If `leading` and `trailing` options are `true`, `func` is\n     * invoked on the trailing edge of the timeout only if the debounced function\n     * is invoked more than once during the `wait` timeout.\n     *\n     * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n     * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n     *\n     * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n     * for details over the differences between `_.debounce` and `_.throttle`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Function\n     * @param {Function} func The function to debounce.\n     * @param {number} [wait=0] The number of milliseconds to delay.\n     * @param {Object} [options={}] The options object.\n     * @param {boolean} [options.leading=false]\n     *  Specify invoking on the leading edge of the timeout.\n     * @param {number} [options.maxWait]\n     *  The maximum time `func` is allowed to be delayed before it's invoked.\n     * @param {boolean} [options.trailing=true]\n     *  Specify invoking on the trailing edge of the timeout.\n     * @returns {Function} Returns the new debounced function.\n     * @example\n     *\n     * // Avoid costly calculations while the window size is in flux.\n     * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n     *\n     * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n     * jQuery(element).on('click', _.debounce(sendMail, 300, {\n     *   'leading': true,\n     *   'trailing': false\n     * }));\n     *\n     * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n     * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n     * var source = new EventSource('/stream');\n     * jQuery(source).on('message', debounced);\n     *\n     * // Cancel the trailing debounced invocation.\n     * jQuery(window).on('popstate', debounced.cancel);\n     */\n    function debounce(func, wait, options) {\n      var lastArgs,\n          lastThis,\n          maxWait,\n          result,\n          timerId,\n          lastCallTime,\n          lastInvokeTime = 0,\n          leading = false,\n          maxing = false,\n          trailing = true;\n\n      if (typeof func != 'function') {\n        throw new TypeError(FUNC_ERROR_TEXT);\n      }\n      wait = toNumber(wait) || 0;\n      if (isObject(options)) {\n        leading = !!options.leading;\n        maxing = 'maxWait' in options;\n        maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n        trailing = 'trailing' in options ? !!options.trailing : trailing;\n      }\n\n      function invokeFunc(time) {\n        var args = lastArgs,\n            thisArg = lastThis;\n\n        lastArgs = lastThis = undefined;\n        lastInvokeTime = time;\n        result = func.apply(thisArg, args);\n        return result;\n      }\n\n      function leadingEdge(time) {\n        // Reset any `maxWait` timer.\n        lastInvokeTime = time;\n        // Start the timer for the trailing edge.\n        timerId = setTimeout(timerExpired, wait);\n        // Invoke the leading edge.\n        return leading ? invokeFunc(time) : result;\n      }\n\n      function remainingWait(time) {\n        var timeSinceLastCall = time - lastCallTime,\n            timeSinceLastInvoke = time - lastInvokeTime,\n            timeWaiting = wait - timeSinceLastCall;\n\n        return maxing\n          ? nativeMin(timeWaiting, maxWait - timeSinceLastInvoke)\n          : timeWaiting;\n      }\n\n      function shouldInvoke(time) {\n        var timeSinceLastCall = time - lastCallTime,\n            timeSinceLastInvoke = time - lastInvokeTime;\n\n        // Either this is the first call, activity has stopped and we're at the\n        // trailing edge, the system time has gone backwards and we're treating\n        // it as the trailing edge, or we've hit the `maxWait` limit.\n        return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n          (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n      }\n\n      function timerExpired() {\n        var time = now();\n        if (shouldInvoke(time)) {\n          return trailingEdge(time);\n        }\n        // Restart the timer.\n        timerId = setTimeout(timerExpired, remainingWait(time));\n      }\n\n      function trailingEdge(time) {\n        timerId = undefined;\n\n        // Only invoke if we have `lastArgs` which means `func` has been\n        // debounced at least once.\n        if (trailing && lastArgs) {\n          return invokeFunc(time);\n        }\n        lastArgs = lastThis = undefined;\n        return result;\n      }\n\n      function cancel() {\n        if (timerId !== undefined) {\n          clearTimeout(timerId);\n        }\n        lastInvokeTime = 0;\n        lastArgs = lastCallTime = lastThis = timerId = undefined;\n      }\n\n      function flush() {\n        return timerId === undefined ? result : trailingEdge(now());\n      }\n\n      function debounced() {\n        var time = now(),\n            isInvoking = shouldInvoke(time);\n\n        lastArgs = arguments;\n        lastThis = this;\n        lastCallTime = time;\n\n        if (isInvoking) {\n          if (timerId === undefined) {\n            return leadingEdge(lastCallTime);\n          }\n          if (maxing) {\n            // Handle invocations in a tight loop.\n            timerId = setTimeout(timerExpired, wait);\n            return invokeFunc(lastCallTime);\n          }\n        }\n        if (timerId === undefined) {\n          timerId = setTimeout(timerExpired, wait);\n        }\n        return result;\n      }\n      debounced.cancel = cancel;\n      debounced.flush = flush;\n      return debounced;\n    }\n\n    /**\n     * Defers invoking the `func` until the current call stack has cleared. Any\n     * additional arguments are provided to `func` when it's invoked.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Function\n     * @param {Function} func The function to defer.\n     * @param {...*} [args] The arguments to invoke `func` with.\n     * @returns {number} Returns the timer id.\n     * @example\n     *\n     * _.defer(function(text) {\n     *   console.log(text);\n     * }, 'deferred');\n     * // => Logs 'deferred' after one millisecond.\n     */\n    var defer = baseRest(function(func, args) {\n      return baseDelay(func, 1, args);\n    });\n\n    /**\n     * Invokes `func` after `wait` milliseconds. Any additional arguments are\n     * provided to `func` when it's invoked.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Function\n     * @param {Function} func The function to delay.\n     * @param {number} wait The number of milliseconds to delay invocation.\n     * @param {...*} [args] The arguments to invoke `func` with.\n     * @returns {number} Returns the timer id.\n     * @example\n     *\n     * _.delay(function(text) {\n     *   console.log(text);\n     * }, 1000, 'later');\n     * // => Logs 'later' after one second.\n     */\n    var delay = baseRest(function(func, wait, args) {\n      return baseDelay(func, toNumber(wait) || 0, args);\n    });\n\n    /**\n     * Creates a function that invokes `func` with arguments reversed.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Function\n     * @param {Function} func The function to flip arguments for.\n     * @returns {Function} Returns the new flipped function.\n     * @example\n     *\n     * var flipped = _.flip(function() {\n     *   return _.toArray(arguments);\n     * });\n     *\n     * flipped('a', 'b', 'c', 'd');\n     * // => ['d', 'c', 'b', 'a']\n     */\n    function flip(func) {\n      return createWrap(func, WRAP_FLIP_FLAG);\n    }\n\n    /**\n     * Creates a function that memoizes the result of `func`. If `resolver` is\n     * provided, it determines the cache key for storing the result based on the\n     * arguments provided to the memoized function. By default, the first argument\n     * provided to the memoized function is used as the map cache key. The `func`\n     * is invoked with the `this` binding of the memoized function.\n     *\n     * **Note:** The cache is exposed as the `cache` property on the memoized\n     * function. Its creation may be customized by replacing the `_.memoize.Cache`\n     * constructor with one whose instances implement the\n     * [`Map`](http://ecma-international.org/ecma-262/7.0/#sec-properties-of-the-map-prototype-object)\n     * method interface of `clear`, `delete`, `get`, `has`, and `set`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Function\n     * @param {Function} func The function to have its output memoized.\n     * @param {Function} [resolver] The function to resolve the cache key.\n     * @returns {Function} Returns the new memoized function.\n     * @example\n     *\n     * var object = { 'a': 1, 'b': 2 };\n     * var other = { 'c': 3, 'd': 4 };\n     *\n     * var values = _.memoize(_.values);\n     * values(object);\n     * // => [1, 2]\n     *\n     * values(other);\n     * // => [3, 4]\n     *\n     * object.a = 2;\n     * values(object);\n     * // => [1, 2]\n     *\n     * // Modify the result cache.\n     * values.cache.set(object, ['a', 'b']);\n     * values(object);\n     * // => ['a', 'b']\n     *\n     * // Replace `_.memoize.Cache`.\n     * _.memoize.Cache = WeakMap;\n     */\n    function memoize(func, resolver) {\n      if (typeof func != 'function' || (resolver != null && typeof resolver != 'function')) {\n        throw new TypeError(FUNC_ERROR_TEXT);\n      }\n      var memoized = function() {\n        var args = arguments,\n            key = resolver ? resolver.apply(this, args) : args[0],\n            cache = memoized.cache;\n\n        if (cache.has(key)) {\n          return cache.get(key);\n        }\n        var result = func.apply(this, args);\n        memoized.cache = cache.set(key, result) || cache;\n        return result;\n      };\n      memoized.cache = new (memoize.Cache || MapCache);\n      return memoized;\n    }\n\n    // Expose `MapCache`.\n    memoize.Cache = MapCache;\n\n    /**\n     * Creates a function that negates the result of the predicate `func`. The\n     * `func` predicate is invoked with the `this` binding and arguments of the\n     * created function.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Function\n     * @param {Function} predicate The predicate to negate.\n     * @returns {Function} Returns the new negated function.\n     * @example\n     *\n     * function isEven(n) {\n     *   return n % 2 == 0;\n     * }\n     *\n     * _.filter([1, 2, 3, 4, 5, 6], _.negate(isEven));\n     * // => [1, 3, 5]\n     */\n    function negate(predicate) {\n      if (typeof predicate != 'function') {\n        throw new TypeError(FUNC_ERROR_TEXT);\n      }\n      return function() {\n        var args = arguments;\n        switch (args.length) {\n          case 0: return !predicate.call(this);\n          case 1: return !predicate.call(this, args[0]);\n          case 2: return !predicate.call(this, args[0], args[1]);\n          case 3: return !predicate.call(this, args[0], args[1], args[2]);\n        }\n        return !predicate.apply(this, args);\n      };\n    }\n\n    /**\n     * Creates a function that is restricted to invoking `func` once. Repeat calls\n     * to the function return the value of the first invocation. The `func` is\n     * invoked with the `this` binding and arguments of the created function.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Function\n     * @param {Function} func The function to restrict.\n     * @returns {Function} Returns the new restricted function.\n     * @example\n     *\n     * var initialize = _.once(createApplication);\n     * initialize();\n     * initialize();\n     * // => `createApplication` is invoked once\n     */\n    function once(func) {\n      return before(2, func);\n    }\n\n    /**\n     * Creates a function that invokes `func` with its arguments transformed.\n     *\n     * @static\n     * @since 4.0.0\n     * @memberOf _\n     * @category Function\n     * @param {Function} func The function to wrap.\n     * @param {...(Function|Function[])} [transforms=[_.identity]]\n     *  The argument transforms.\n     * @returns {Function} Returns the new function.\n     * @example\n     *\n     * function doubled(n) {\n     *   return n * 2;\n     * }\n     *\n     * function square(n) {\n     *   return n * n;\n     * }\n     *\n     * var func = _.overArgs(function(x, y) {\n     *   return [x, y];\n     * }, [square, doubled]);\n     *\n     * func(9, 3);\n     * // => [81, 6]\n     *\n     * func(10, 5);\n     * // => [100, 10]\n     */\n    var overArgs = castRest(function(func, transforms) {\n      transforms = (transforms.length == 1 && isArray(transforms[0]))\n        ? arrayMap(transforms[0], baseUnary(getIteratee()))\n        : arrayMap(baseFlatten(transforms, 1), baseUnary(getIteratee()));\n\n      var funcsLength = transforms.length;\n      return baseRest(function(args) {\n        var index = -1,\n            length = nativeMin(args.length, funcsLength);\n\n        while (++index < length) {\n          args[index] = transforms[index].call(this, args[index]);\n        }\n        return apply(func, this, args);\n      });\n    });\n\n    /**\n     * Creates a function that invokes `func` with `partials` prepended to the\n     * arguments it receives. This method is like `_.bind` except it does **not**\n     * alter the `this` binding.\n     *\n     * The `_.partial.placeholder` value, which defaults to `_` in monolithic\n     * builds, may be used as a placeholder for partially applied arguments.\n     *\n     * **Note:** This method doesn't set the \"length\" property of partially\n     * applied functions.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.2.0\n     * @category Function\n     * @param {Function} func The function to partially apply arguments to.\n     * @param {...*} [partials] The arguments to be partially applied.\n     * @returns {Function} Returns the new partially applied function.\n     * @example\n     *\n     * function greet(greeting, name) {\n     *   return greeting + ' ' + name;\n     * }\n     *\n     * var sayHelloTo = _.partial(greet, 'hello');\n     * sayHelloTo('fred');\n     * // => 'hello fred'\n     *\n     * // Partially applied with placeholders.\n     * var greetFred = _.partial(greet, _, 'fred');\n     * greetFred('hi');\n     * // => 'hi fred'\n     */\n    var partial = baseRest(function(func, partials) {\n      var holders = replaceHolders(partials, getHolder(partial));\n      return createWrap(func, WRAP_PARTIAL_FLAG, undefined, partials, holders);\n    });\n\n    /**\n     * This method is like `_.partial` except that partially applied arguments\n     * are appended to the arguments it receives.\n     *\n     * The `_.partialRight.placeholder` value, which defaults to `_` in monolithic\n     * builds, may be used as a placeholder for partially applied arguments.\n     *\n     * **Note:** This method doesn't set the \"length\" property of partially\n     * applied functions.\n     *\n     * @static\n     * @memberOf _\n     * @since 1.0.0\n     * @category Function\n     * @param {Function} func The function to partially apply arguments to.\n     * @param {...*} [partials] The arguments to be partially applied.\n     * @returns {Function} Returns the new partially applied function.\n     * @example\n     *\n     * function greet(greeting, name) {\n     *   return greeting + ' ' + name;\n     * }\n     *\n     * var greetFred = _.partialRight(greet, 'fred');\n     * greetFred('hi');\n     * // => 'hi fred'\n     *\n     * // Partially applied with placeholders.\n     * var sayHelloTo = _.partialRight(greet, 'hello', _);\n     * sayHelloTo('fred');\n     * // => 'hello fred'\n     */\n    var partialRight = baseRest(function(func, partials) {\n      var holders = replaceHolders(partials, getHolder(partialRight));\n      return createWrap(func, WRAP_PARTIAL_RIGHT_FLAG, undefined, partials, holders);\n    });\n\n    /**\n     * Creates a function that invokes `func` with arguments arranged according\n     * to the specified `indexes` where the argument value at the first index is\n     * provided as the first argument, the argument value at the second index is\n     * provided as the second argument, and so on.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Function\n     * @param {Function} func The function to rearrange arguments for.\n     * @param {...(number|number[])} indexes The arranged argument indexes.\n     * @returns {Function} Returns the new function.\n     * @example\n     *\n     * var rearged = _.rearg(function(a, b, c) {\n     *   return [a, b, c];\n     * }, [2, 0, 1]);\n     *\n     * rearged('b', 'c', 'a')\n     * // => ['a', 'b', 'c']\n     */\n    var rearg = flatRest(function(func, indexes) {\n      return createWrap(func, WRAP_REARG_FLAG, undefined, undefined, undefined, indexes);\n    });\n\n    /**\n     * Creates a function that invokes `func` with the `this` binding of the\n     * created function and arguments from `start` and beyond provided as\n     * an array.\n     *\n     * **Note:** This method is based on the\n     * [rest parameter](https://mdn.io/rest_parameters).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Function\n     * @param {Function} func The function to apply a rest parameter to.\n     * @param {number} [start=func.length-1] The start position of the rest parameter.\n     * @returns {Function} Returns the new function.\n     * @example\n     *\n     * var say = _.rest(function(what, names) {\n     *   return what + ' ' + _.initial(names).join(', ') +\n     *     (_.size(names) > 1 ? ', & ' : '') + _.last(names);\n     * });\n     *\n     * say('hello', 'fred', 'barney', 'pebbles');\n     * // => 'hello fred, barney, & pebbles'\n     */\n    function rest(func, start) {\n      if (typeof func != 'function') {\n        throw new TypeError(FUNC_ERROR_TEXT);\n      }\n      start = start === undefined ? start : toInteger(start);\n      return baseRest(func, start);\n    }\n\n    /**\n     * Creates a function that invokes `func` with the `this` binding of the\n     * create function and an array of arguments much like\n     * [`Function#apply`](http://www.ecma-international.org/ecma-262/7.0/#sec-function.prototype.apply).\n     *\n     * **Note:** This method is based on the\n     * [spread operator](https://mdn.io/spread_operator).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.2.0\n     * @category Function\n     * @param {Function} func The function to spread arguments over.\n     * @param {number} [start=0] The start position of the spread.\n     * @returns {Function} Returns the new function.\n     * @example\n     *\n     * var say = _.spread(function(who, what) {\n     *   return who + ' says ' + what;\n     * });\n     *\n     * say(['fred', 'hello']);\n     * // => 'fred says hello'\n     *\n     * var numbers = Promise.all([\n     *   Promise.resolve(40),\n     *   Promise.resolve(36)\n     * ]);\n     *\n     * numbers.then(_.spread(function(x, y) {\n     *   return x + y;\n     * }));\n     * // => a Promise of 76\n     */\n    function spread(func, start) {\n      if (typeof func != 'function') {\n        throw new TypeError(FUNC_ERROR_TEXT);\n      }\n      start = start == null ? 0 : nativeMax(toInteger(start), 0);\n      return baseRest(function(args) {\n        var array = args[start],\n            otherArgs = castSlice(args, 0, start);\n\n        if (array) {\n          arrayPush(otherArgs, array);\n        }\n        return apply(func, this, otherArgs);\n      });\n    }\n\n    /**\n     * Creates a throttled function that only invokes `func` at most once per\n     * every `wait` milliseconds. The throttled function comes with a `cancel`\n     * method to cancel delayed `func` invocations and a `flush` method to\n     * immediately invoke them. Provide `options` to indicate whether `func`\n     * should be invoked on the leading and/or trailing edge of the `wait`\n     * timeout. The `func` is invoked with the last arguments provided to the\n     * throttled function. Subsequent calls to the throttled function return the\n     * result of the last `func` invocation.\n     *\n     * **Note:** If `leading` and `trailing` options are `true`, `func` is\n     * invoked on the trailing edge of the timeout only if the throttled function\n     * is invoked more than once during the `wait` timeout.\n     *\n     * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n     * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n     *\n     * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n     * for details over the differences between `_.throttle` and `_.debounce`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Function\n     * @param {Function} func The function to throttle.\n     * @param {number} [wait=0] The number of milliseconds to throttle invocations to.\n     * @param {Object} [options={}] The options object.\n     * @param {boolean} [options.leading=true]\n     *  Specify invoking on the leading edge of the timeout.\n     * @param {boolean} [options.trailing=true]\n     *  Specify invoking on the trailing edge of the timeout.\n     * @returns {Function} Returns the new throttled function.\n     * @example\n     *\n     * // Avoid excessively updating the position while scrolling.\n     * jQuery(window).on('scroll', _.throttle(updatePosition, 100));\n     *\n     * // Invoke `renewToken` when the click event is fired, but not more than once every 5 minutes.\n     * var throttled = _.throttle(renewToken, 300000, { 'trailing': false });\n     * jQuery(element).on('click', throttled);\n     *\n     * // Cancel the trailing throttled invocation.\n     * jQuery(window).on('popstate', throttled.cancel);\n     */\n    function throttle(func, wait, options) {\n      var leading = true,\n          trailing = true;\n\n      if (typeof func != 'function') {\n        throw new TypeError(FUNC_ERROR_TEXT);\n      }\n      if (isObject(options)) {\n        leading = 'leading' in options ? !!options.leading : leading;\n        trailing = 'trailing' in options ? !!options.trailing : trailing;\n      }\n      return debounce(func, wait, {\n        'leading': leading,\n        'maxWait': wait,\n        'trailing': trailing\n      });\n    }\n\n    /**\n     * Creates a function that accepts up to one argument, ignoring any\n     * additional arguments.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Function\n     * @param {Function} func The function to cap arguments for.\n     * @returns {Function} Returns the new capped function.\n     * @example\n     *\n     * _.map(['6', '8', '10'], _.unary(parseInt));\n     * // => [6, 8, 10]\n     */\n    function unary(func) {\n      return ary(func, 1);\n    }\n\n    /**\n     * Creates a function that provides `value` to `wrapper` as its first\n     * argument. Any additional arguments provided to the function are appended\n     * to those provided to the `wrapper`. The wrapper is invoked with the `this`\n     * binding of the created function.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Function\n     * @param {*} value The value to wrap.\n     * @param {Function} [wrapper=identity] The wrapper function.\n     * @returns {Function} Returns the new function.\n     * @example\n     *\n     * var p = _.wrap(_.escape, function(func, text) {\n     *   return '<p>' + func(text) + '</p>';\n     * });\n     *\n     * p('fred, barney, & pebbles');\n     * // => '<p>fred, barney, &amp; pebbles</p>'\n     */\n    function wrap(value, wrapper) {\n      return partial(castFunction(wrapper), value);\n    }\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Casts `value` as an array if it's not one.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.4.0\n     * @category Lang\n     * @param {*} value The value to inspect.\n     * @returns {Array} Returns the cast array.\n     * @example\n     *\n     * _.castArray(1);\n     * // => [1]\n     *\n     * _.castArray({ 'a': 1 });\n     * // => [{ 'a': 1 }]\n     *\n     * _.castArray('abc');\n     * // => ['abc']\n     *\n     * _.castArray(null);\n     * // => [null]\n     *\n     * _.castArray(undefined);\n     * // => [undefined]\n     *\n     * _.castArray();\n     * // => []\n     *\n     * var array = [1, 2, 3];\n     * console.log(_.castArray(array) === array);\n     * // => true\n     */\n    function castArray() {\n      if (!arguments.length) {\n        return [];\n      }\n      var value = arguments[0];\n      return isArray(value) ? value : [value];\n    }\n\n    /**\n     * Creates a shallow clone of `value`.\n     *\n     * **Note:** This method is loosely based on the\n     * [structured clone algorithm](https://mdn.io/Structured_clone_algorithm)\n     * and supports cloning arrays, array buffers, booleans, date objects, maps,\n     * numbers, `Object` objects, regexes, sets, strings, symbols, and typed\n     * arrays. The own enumerable properties of `arguments` objects are cloned\n     * as plain objects. An empty object is returned for uncloneable values such\n     * as error objects, functions, DOM nodes, and WeakMaps.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to clone.\n     * @returns {*} Returns the cloned value.\n     * @see _.cloneDeep\n     * @example\n     *\n     * var objects = [{ 'a': 1 }, { 'b': 2 }];\n     *\n     * var shallow = _.clone(objects);\n     * console.log(shallow[0] === objects[0]);\n     * // => true\n     */\n    function clone(value) {\n      return baseClone(value, CLONE_SYMBOLS_FLAG);\n    }\n\n    /**\n     * This method is like `_.clone` except that it accepts `customizer` which\n     * is invoked to produce the cloned value. If `customizer` returns `undefined`,\n     * cloning is handled by the method instead. The `customizer` is invoked with\n     * up to four arguments; (value [, index|key, object, stack]).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to clone.\n     * @param {Function} [customizer] The function to customize cloning.\n     * @returns {*} Returns the cloned value.\n     * @see _.cloneDeepWith\n     * @example\n     *\n     * function customizer(value) {\n     *   if (_.isElement(value)) {\n     *     return value.cloneNode(false);\n     *   }\n     * }\n     *\n     * var el = _.cloneWith(document.body, customizer);\n     *\n     * console.log(el === document.body);\n     * // => false\n     * console.log(el.nodeName);\n     * // => 'BODY'\n     * console.log(el.childNodes.length);\n     * // => 0\n     */\n    function cloneWith(value, customizer) {\n      customizer = typeof customizer == 'function' ? customizer : undefined;\n      return baseClone(value, CLONE_SYMBOLS_FLAG, customizer);\n    }\n\n    /**\n     * This method is like `_.clone` except that it recursively clones `value`.\n     *\n     * @static\n     * @memberOf _\n     * @since 1.0.0\n     * @category Lang\n     * @param {*} value The value to recursively clone.\n     * @returns {*} Returns the deep cloned value.\n     * @see _.clone\n     * @example\n     *\n     * var objects = [{ 'a': 1 }, { 'b': 2 }];\n     *\n     * var deep = _.cloneDeep(objects);\n     * console.log(deep[0] === objects[0]);\n     * // => false\n     */\n    function cloneDeep(value) {\n      return baseClone(value, CLONE_DEEP_FLAG | CLONE_SYMBOLS_FLAG);\n    }\n\n    /**\n     * This method is like `_.cloneWith` except that it recursively clones `value`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to recursively clone.\n     * @param {Function} [customizer] The function to customize cloning.\n     * @returns {*} Returns the deep cloned value.\n     * @see _.cloneWith\n     * @example\n     *\n     * function customizer(value) {\n     *   if (_.isElement(value)) {\n     *     return value.cloneNode(true);\n     *   }\n     * }\n     *\n     * var el = _.cloneDeepWith(document.body, customizer);\n     *\n     * console.log(el === document.body);\n     * // => false\n     * console.log(el.nodeName);\n     * // => 'BODY'\n     * console.log(el.childNodes.length);\n     * // => 20\n     */\n    function cloneDeepWith(value, customizer) {\n      customizer = typeof customizer == 'function' ? customizer : undefined;\n      return baseClone(value, CLONE_DEEP_FLAG | CLONE_SYMBOLS_FLAG, customizer);\n    }\n\n    /**\n     * Checks if `object` conforms to `source` by invoking the predicate\n     * properties of `source` with the corresponding property values of `object`.\n     *\n     * **Note:** This method is equivalent to `_.conforms` when `source` is\n     * partially applied.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.14.0\n     * @category Lang\n     * @param {Object} object The object to inspect.\n     * @param {Object} source The object of property predicates to conform to.\n     * @returns {boolean} Returns `true` if `object` conforms, else `false`.\n     * @example\n     *\n     * var object = { 'a': 1, 'b': 2 };\n     *\n     * _.conformsTo(object, { 'b': function(n) { return n > 1; } });\n     * // => true\n     *\n     * _.conformsTo(object, { 'b': function(n) { return n > 2; } });\n     * // => false\n     */\n    function conformsTo(object, source) {\n      return source == null || baseConformsTo(object, source, keys(source));\n    }\n\n    /**\n     * Performs a\n     * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n     * comparison between two values to determine if they are equivalent.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n     * @example\n     *\n     * var object = { 'a': 1 };\n     * var other = { 'a': 1 };\n     *\n     * _.eq(object, object);\n     * // => true\n     *\n     * _.eq(object, other);\n     * // => false\n     *\n     * _.eq('a', 'a');\n     * // => true\n     *\n     * _.eq('a', Object('a'));\n     * // => false\n     *\n     * _.eq(NaN, NaN);\n     * // => true\n     */\n    function eq(value, other) {\n      return value === other || (value !== value && other !== other);\n    }\n\n    /**\n     * Checks if `value` is greater than `other`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.9.0\n     * @category Lang\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @returns {boolean} Returns `true` if `value` is greater than `other`,\n     *  else `false`.\n     * @see _.lt\n     * @example\n     *\n     * _.gt(3, 1);\n     * // => true\n     *\n     * _.gt(3, 3);\n     * // => false\n     *\n     * _.gt(1, 3);\n     * // => false\n     */\n    var gt = createRelationalOperation(baseGt);\n\n    /**\n     * Checks if `value` is greater than or equal to `other`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.9.0\n     * @category Lang\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @returns {boolean} Returns `true` if `value` is greater than or equal to\n     *  `other`, else `false`.\n     * @see _.lte\n     * @example\n     *\n     * _.gte(3, 1);\n     * // => true\n     *\n     * _.gte(3, 3);\n     * // => true\n     *\n     * _.gte(1, 3);\n     * // => false\n     */\n    var gte = createRelationalOperation(function(value, other) {\n      return value >= other;\n    });\n\n    /**\n     * Checks if `value` is likely an `arguments` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n     *  else `false`.\n     * @example\n     *\n     * _.isArguments(function() { return arguments; }());\n     * // => true\n     *\n     * _.isArguments([1, 2, 3]);\n     * // => false\n     */\n    var isArguments = baseIsArguments(function() { return arguments; }()) ? baseIsArguments : function(value) {\n      return isObjectLike(value) && hasOwnProperty.call(value, 'callee') &&\n        !propertyIsEnumerable.call(value, 'callee');\n    };\n\n    /**\n     * Checks if `value` is classified as an `Array` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n     * @example\n     *\n     * _.isArray([1, 2, 3]);\n     * // => true\n     *\n     * _.isArray(document.body.children);\n     * // => false\n     *\n     * _.isArray('abc');\n     * // => false\n     *\n     * _.isArray(_.noop);\n     * // => false\n     */\n    var isArray = Array.isArray;\n\n    /**\n     * Checks if `value` is classified as an `ArrayBuffer` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.3.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is an array buffer, else `false`.\n     * @example\n     *\n     * _.isArrayBuffer(new ArrayBuffer(2));\n     * // => true\n     *\n     * _.isArrayBuffer(new Array(2));\n     * // => false\n     */\n    var isArrayBuffer = nodeIsArrayBuffer ? baseUnary(nodeIsArrayBuffer) : baseIsArrayBuffer;\n\n    /**\n     * Checks if `value` is array-like. A value is considered array-like if it's\n     * not a function and has a `value.length` that's an integer greater than or\n     * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n     * @example\n     *\n     * _.isArrayLike([1, 2, 3]);\n     * // => true\n     *\n     * _.isArrayLike(document.body.children);\n     * // => true\n     *\n     * _.isArrayLike('abc');\n     * // => true\n     *\n     * _.isArrayLike(_.noop);\n     * // => false\n     */\n    function isArrayLike(value) {\n      return value != null && isLength(value.length) && !isFunction(value);\n    }\n\n    /**\n     * This method is like `_.isArrayLike` except that it also checks if `value`\n     * is an object.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is an array-like object,\n     *  else `false`.\n     * @example\n     *\n     * _.isArrayLikeObject([1, 2, 3]);\n     * // => true\n     *\n     * _.isArrayLikeObject(document.body.children);\n     * // => true\n     *\n     * _.isArrayLikeObject('abc');\n     * // => false\n     *\n     * _.isArrayLikeObject(_.noop);\n     * // => false\n     */\n    function isArrayLikeObject(value) {\n      return isObjectLike(value) && isArrayLike(value);\n    }\n\n    /**\n     * Checks if `value` is classified as a boolean primitive or object.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a boolean, else `false`.\n     * @example\n     *\n     * _.isBoolean(false);\n     * // => true\n     *\n     * _.isBoolean(null);\n     * // => false\n     */\n    function isBoolean(value) {\n      return value === true || value === false ||\n        (isObjectLike(value) && baseGetTag(value) == boolTag);\n    }\n\n    /**\n     * Checks if `value` is a buffer.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.3.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a buffer, else `false`.\n     * @example\n     *\n     * _.isBuffer(new Buffer(2));\n     * // => true\n     *\n     * _.isBuffer(new Uint8Array(2));\n     * // => false\n     */\n    var isBuffer = nativeIsBuffer || stubFalse;\n\n    /**\n     * Checks if `value` is classified as a `Date` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a date object, else `false`.\n     * @example\n     *\n     * _.isDate(new Date);\n     * // => true\n     *\n     * _.isDate('Mon April 23 2012');\n     * // => false\n     */\n    var isDate = nodeIsDate ? baseUnary(nodeIsDate) : baseIsDate;\n\n    /**\n     * Checks if `value` is likely a DOM element.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a DOM element, else `false`.\n     * @example\n     *\n     * _.isElement(document.body);\n     * // => true\n     *\n     * _.isElement('<body>');\n     * // => false\n     */\n    function isElement(value) {\n      return isObjectLike(value) && value.nodeType === 1 && !isPlainObject(value);\n    }\n\n    /**\n     * Checks if `value` is an empty object, collection, map, or set.\n     *\n     * Objects are considered empty if they have no own enumerable string keyed\n     * properties.\n     *\n     * Array-like values such as `arguments` objects, arrays, buffers, strings, or\n     * jQuery-like collections are considered empty if they have a `length` of `0`.\n     * Similarly, maps and sets are considered empty if they have a `size` of `0`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is empty, else `false`.\n     * @example\n     *\n     * _.isEmpty(null);\n     * // => true\n     *\n     * _.isEmpty(true);\n     * // => true\n     *\n     * _.isEmpty(1);\n     * // => true\n     *\n     * _.isEmpty([1, 2, 3]);\n     * // => false\n     *\n     * _.isEmpty({ 'a': 1 });\n     * // => false\n     */\n    function isEmpty(value) {\n      if (value == null) {\n        return true;\n      }\n      if (isArrayLike(value) &&\n          (isArray(value) || typeof value == 'string' || typeof value.splice == 'function' ||\n            isBuffer(value) || isTypedArray(value) || isArguments(value))) {\n        return !value.length;\n      }\n      var tag = getTag(value);\n      if (tag == mapTag || tag == setTag) {\n        return !value.size;\n      }\n      if (isPrototype(value)) {\n        return !baseKeys(value).length;\n      }\n      for (var key in value) {\n        if (hasOwnProperty.call(value, key)) {\n          return false;\n        }\n      }\n      return true;\n    }\n\n    /**\n     * Performs a deep comparison between two values to determine if they are\n     * equivalent.\n     *\n     * **Note:** This method supports comparing arrays, array buffers, booleans,\n     * date objects, error objects, maps, numbers, `Object` objects, regexes,\n     * sets, strings, symbols, and typed arrays. `Object` objects are compared\n     * by their own, not inherited, enumerable properties. Functions and DOM\n     * nodes are compared by strict equality, i.e. `===`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n     * @example\n     *\n     * var object = { 'a': 1 };\n     * var other = { 'a': 1 };\n     *\n     * _.isEqual(object, other);\n     * // => true\n     *\n     * object === other;\n     * // => false\n     */\n    function isEqual(value, other) {\n      return baseIsEqual(value, other);\n    }\n\n    /**\n     * This method is like `_.isEqual` except that it accepts `customizer` which\n     * is invoked to compare values. If `customizer` returns `undefined`, comparisons\n     * are handled by the method instead. The `customizer` is invoked with up to\n     * six arguments: (objValue, othValue [, index|key, object, other, stack]).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @param {Function} [customizer] The function to customize comparisons.\n     * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n     * @example\n     *\n     * function isGreeting(value) {\n     *   return /^h(?:i|ello)$/.test(value);\n     * }\n     *\n     * function customizer(objValue, othValue) {\n     *   if (isGreeting(objValue) && isGreeting(othValue)) {\n     *     return true;\n     *   }\n     * }\n     *\n     * var array = ['hello', 'goodbye'];\n     * var other = ['hi', 'goodbye'];\n     *\n     * _.isEqualWith(array, other, customizer);\n     * // => true\n     */\n    function isEqualWith(value, other, customizer) {\n      customizer = typeof customizer == 'function' ? customizer : undefined;\n      var result = customizer ? customizer(value, other) : undefined;\n      return result === undefined ? baseIsEqual(value, other, undefined, customizer) : !!result;\n    }\n\n    /**\n     * Checks if `value` is an `Error`, `EvalError`, `RangeError`, `ReferenceError`,\n     * `SyntaxError`, `TypeError`, or `URIError` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is an error object, else `false`.\n     * @example\n     *\n     * _.isError(new Error);\n     * // => true\n     *\n     * _.isError(Error);\n     * // => false\n     */\n    function isError(value) {\n      if (!isObjectLike(value)) {\n        return false;\n      }\n      var tag = baseGetTag(value);\n      return tag == errorTag || tag == domExcTag ||\n        (typeof value.message == 'string' && typeof value.name == 'string' && !isPlainObject(value));\n    }\n\n    /**\n     * Checks if `value` is a finite primitive number.\n     *\n     * **Note:** This method is based on\n     * [`Number.isFinite`](https://mdn.io/Number/isFinite).\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a finite number, else `false`.\n     * @example\n     *\n     * _.isFinite(3);\n     * // => true\n     *\n     * _.isFinite(Number.MIN_VALUE);\n     * // => true\n     *\n     * _.isFinite(Infinity);\n     * // => false\n     *\n     * _.isFinite('3');\n     * // => false\n     */\n    function isFinite(value) {\n      return typeof value == 'number' && nativeIsFinite(value);\n    }\n\n    /**\n     * Checks if `value` is classified as a `Function` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n     * @example\n     *\n     * _.isFunction(_);\n     * // => true\n     *\n     * _.isFunction(/abc/);\n     * // => false\n     */\n    function isFunction(value) {\n      if (!isObject(value)) {\n        return false;\n      }\n      // The use of `Object#toString` avoids issues with the `typeof` operator\n      // in Safari 9 which returns 'object' for typed arrays and other constructors.\n      var tag = baseGetTag(value);\n      return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;\n    }\n\n    /**\n     * Checks if `value` is an integer.\n     *\n     * **Note:** This method is based on\n     * [`Number.isInteger`](https://mdn.io/Number/isInteger).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is an integer, else `false`.\n     * @example\n     *\n     * _.isInteger(3);\n     * // => true\n     *\n     * _.isInteger(Number.MIN_VALUE);\n     * // => false\n     *\n     * _.isInteger(Infinity);\n     * // => false\n     *\n     * _.isInteger('3');\n     * // => false\n     */\n    function isInteger(value) {\n      return typeof value == 'number' && value == toInteger(value);\n    }\n\n    /**\n     * Checks if `value` is a valid array-like length.\n     *\n     * **Note:** This method is loosely based on\n     * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n     * @example\n     *\n     * _.isLength(3);\n     * // => true\n     *\n     * _.isLength(Number.MIN_VALUE);\n     * // => false\n     *\n     * _.isLength(Infinity);\n     * // => false\n     *\n     * _.isLength('3');\n     * // => false\n     */\n    function isLength(value) {\n      return typeof value == 'number' &&\n        value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n    }\n\n    /**\n     * Checks if `value` is the\n     * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n     * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n     * @example\n     *\n     * _.isObject({});\n     * // => true\n     *\n     * _.isObject([1, 2, 3]);\n     * // => true\n     *\n     * _.isObject(_.noop);\n     * // => true\n     *\n     * _.isObject(null);\n     * // => false\n     */\n    function isObject(value) {\n      var type = typeof value;\n      return value != null && (type == 'object' || type == 'function');\n    }\n\n    /**\n     * Checks if `value` is object-like. A value is object-like if it's not `null`\n     * and has a `typeof` result of \"object\".\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n     * @example\n     *\n     * _.isObjectLike({});\n     * // => true\n     *\n     * _.isObjectLike([1, 2, 3]);\n     * // => true\n     *\n     * _.isObjectLike(_.noop);\n     * // => false\n     *\n     * _.isObjectLike(null);\n     * // => false\n     */\n    function isObjectLike(value) {\n      return value != null && typeof value == 'object';\n    }\n\n    /**\n     * Checks if `value` is classified as a `Map` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.3.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a map, else `false`.\n     * @example\n     *\n     * _.isMap(new Map);\n     * // => true\n     *\n     * _.isMap(new WeakMap);\n     * // => false\n     */\n    var isMap = nodeIsMap ? baseUnary(nodeIsMap) : baseIsMap;\n\n    /**\n     * Performs a partial deep comparison between `object` and `source` to\n     * determine if `object` contains equivalent property values.\n     *\n     * **Note:** This method is equivalent to `_.matches` when `source` is\n     * partially applied.\n     *\n     * Partial comparisons will match empty array and empty object `source`\n     * values against any array or object value, respectively. See `_.isEqual`\n     * for a list of supported value comparisons.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Lang\n     * @param {Object} object The object to inspect.\n     * @param {Object} source The object of property values to match.\n     * @returns {boolean} Returns `true` if `object` is a match, else `false`.\n     * @example\n     *\n     * var object = { 'a': 1, 'b': 2 };\n     *\n     * _.isMatch(object, { 'b': 2 });\n     * // => true\n     *\n     * _.isMatch(object, { 'b': 1 });\n     * // => false\n     */\n    function isMatch(object, source) {\n      return object === source || baseIsMatch(object, source, getMatchData(source));\n    }\n\n    /**\n     * This method is like `_.isMatch` except that it accepts `customizer` which\n     * is invoked to compare values. If `customizer` returns `undefined`, comparisons\n     * are handled by the method instead. The `customizer` is invoked with five\n     * arguments: (objValue, srcValue, index|key, object, source).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {Object} object The object to inspect.\n     * @param {Object} source The object of property values to match.\n     * @param {Function} [customizer] The function to customize comparisons.\n     * @returns {boolean} Returns `true` if `object` is a match, else `false`.\n     * @example\n     *\n     * function isGreeting(value) {\n     *   return /^h(?:i|ello)$/.test(value);\n     * }\n     *\n     * function customizer(objValue, srcValue) {\n     *   if (isGreeting(objValue) && isGreeting(srcValue)) {\n     *     return true;\n     *   }\n     * }\n     *\n     * var object = { 'greeting': 'hello' };\n     * var source = { 'greeting': 'hi' };\n     *\n     * _.isMatchWith(object, source, customizer);\n     * // => true\n     */\n    function isMatchWith(object, source, customizer) {\n      customizer = typeof customizer == 'function' ? customizer : undefined;\n      return baseIsMatch(object, source, getMatchData(source), customizer);\n    }\n\n    /**\n     * Checks if `value` is `NaN`.\n     *\n     * **Note:** This method is based on\n     * [`Number.isNaN`](https://mdn.io/Number/isNaN) and is not the same as\n     * global [`isNaN`](https://mdn.io/isNaN) which returns `true` for\n     * `undefined` and other non-number values.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is `NaN`, else `false`.\n     * @example\n     *\n     * _.isNaN(NaN);\n     * // => true\n     *\n     * _.isNaN(new Number(NaN));\n     * // => true\n     *\n     * isNaN(undefined);\n     * // => true\n     *\n     * _.isNaN(undefined);\n     * // => false\n     */\n    function isNaN(value) {\n      // An `NaN` primitive is the only value that is not equal to itself.\n      // Perform the `toStringTag` check first to avoid errors with some\n      // ActiveX objects in IE.\n      return isNumber(value) && value != +value;\n    }\n\n    /**\n     * Checks if `value` is a pristine native function.\n     *\n     * **Note:** This method can't reliably detect native functions in the presence\n     * of the core-js package because core-js circumvents this kind of detection.\n     * Despite multiple requests, the core-js maintainer has made it clear: any\n     * attempt to fix the detection will be obstructed. As a result, we're left\n     * with little choice but to throw an error. Unfortunately, this also affects\n     * packages, like [babel-polyfill](https://www.npmjs.com/package/babel-polyfill),\n     * which rely on core-js.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a native function,\n     *  else `false`.\n     * @example\n     *\n     * _.isNative(Array.prototype.push);\n     * // => true\n     *\n     * _.isNative(_);\n     * // => false\n     */\n    function isNative(value) {\n      if (isMaskable(value)) {\n        throw new Error(CORE_ERROR_TEXT);\n      }\n      return baseIsNative(value);\n    }\n\n    /**\n     * Checks if `value` is `null`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is `null`, else `false`.\n     * @example\n     *\n     * _.isNull(null);\n     * // => true\n     *\n     * _.isNull(void 0);\n     * // => false\n     */\n    function isNull(value) {\n      return value === null;\n    }\n\n    /**\n     * Checks if `value` is `null` or `undefined`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is nullish, else `false`.\n     * @example\n     *\n     * _.isNil(null);\n     * // => true\n     *\n     * _.isNil(void 0);\n     * // => true\n     *\n     * _.isNil(NaN);\n     * // => false\n     */\n    function isNil(value) {\n      return value == null;\n    }\n\n    /**\n     * Checks if `value` is classified as a `Number` primitive or object.\n     *\n     * **Note:** To exclude `Infinity`, `-Infinity`, and `NaN`, which are\n     * classified as numbers, use the `_.isFinite` method.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a number, else `false`.\n     * @example\n     *\n     * _.isNumber(3);\n     * // => true\n     *\n     * _.isNumber(Number.MIN_VALUE);\n     * // => true\n     *\n     * _.isNumber(Infinity);\n     * // => true\n     *\n     * _.isNumber('3');\n     * // => false\n     */\n    function isNumber(value) {\n      return typeof value == 'number' ||\n        (isObjectLike(value) && baseGetTag(value) == numberTag);\n    }\n\n    /**\n     * Checks if `value` is a plain object, that is, an object created by the\n     * `Object` constructor or one with a `[[Prototype]]` of `null`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.8.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a plain object, else `false`.\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     * }\n     *\n     * _.isPlainObject(new Foo);\n     * // => false\n     *\n     * _.isPlainObject([1, 2, 3]);\n     * // => false\n     *\n     * _.isPlainObject({ 'x': 0, 'y': 0 });\n     * // => true\n     *\n     * _.isPlainObject(Object.create(null));\n     * // => true\n     */\n    function isPlainObject(value) {\n      if (!isObjectLike(value) || baseGetTag(value) != objectTag) {\n        return false;\n      }\n      var proto = getPrototype(value);\n      if (proto === null) {\n        return true;\n      }\n      var Ctor = hasOwnProperty.call(proto, 'constructor') && proto.constructor;\n      return typeof Ctor == 'function' && Ctor instanceof Ctor &&\n        funcToString.call(Ctor) == objectCtorString;\n    }\n\n    /**\n     * Checks if `value` is classified as a `RegExp` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.1.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a regexp, else `false`.\n     * @example\n     *\n     * _.isRegExp(/abc/);\n     * // => true\n     *\n     * _.isRegExp('/abc/');\n     * // => false\n     */\n    var isRegExp = nodeIsRegExp ? baseUnary(nodeIsRegExp) : baseIsRegExp;\n\n    /**\n     * Checks if `value` is a safe integer. An integer is safe if it's an IEEE-754\n     * double precision number which isn't the result of a rounded unsafe integer.\n     *\n     * **Note:** This method is based on\n     * [`Number.isSafeInteger`](https://mdn.io/Number/isSafeInteger).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a safe integer, else `false`.\n     * @example\n     *\n     * _.isSafeInteger(3);\n     * // => true\n     *\n     * _.isSafeInteger(Number.MIN_VALUE);\n     * // => false\n     *\n     * _.isSafeInteger(Infinity);\n     * // => false\n     *\n     * _.isSafeInteger('3');\n     * // => false\n     */\n    function isSafeInteger(value) {\n      return isInteger(value) && value >= -MAX_SAFE_INTEGER && value <= MAX_SAFE_INTEGER;\n    }\n\n    /**\n     * Checks if `value` is classified as a `Set` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.3.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a set, else `false`.\n     * @example\n     *\n     * _.isSet(new Set);\n     * // => true\n     *\n     * _.isSet(new WeakSet);\n     * // => false\n     */\n    var isSet = nodeIsSet ? baseUnary(nodeIsSet) : baseIsSet;\n\n    /**\n     * Checks if `value` is classified as a `String` primitive or object.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a string, else `false`.\n     * @example\n     *\n     * _.isString('abc');\n     * // => true\n     *\n     * _.isString(1);\n     * // => false\n     */\n    function isString(value) {\n      return typeof value == 'string' ||\n        (!isArray(value) && isObjectLike(value) && baseGetTag(value) == stringTag);\n    }\n\n    /**\n     * Checks if `value` is classified as a `Symbol` primitive or object.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n     * @example\n     *\n     * _.isSymbol(Symbol.iterator);\n     * // => true\n     *\n     * _.isSymbol('abc');\n     * // => false\n     */\n    function isSymbol(value) {\n      return typeof value == 'symbol' ||\n        (isObjectLike(value) && baseGetTag(value) == symbolTag);\n    }\n\n    /**\n     * Checks if `value` is classified as a typed array.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n     * @example\n     *\n     * _.isTypedArray(new Uint8Array);\n     * // => true\n     *\n     * _.isTypedArray([]);\n     * // => false\n     */\n    var isTypedArray = nodeIsTypedArray ? baseUnary(nodeIsTypedArray) : baseIsTypedArray;\n\n    /**\n     * Checks if `value` is `undefined`.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is `undefined`, else `false`.\n     * @example\n     *\n     * _.isUndefined(void 0);\n     * // => true\n     *\n     * _.isUndefined(null);\n     * // => false\n     */\n    function isUndefined(value) {\n      return value === undefined;\n    }\n\n    /**\n     * Checks if `value` is classified as a `WeakMap` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.3.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a weak map, else `false`.\n     * @example\n     *\n     * _.isWeakMap(new WeakMap);\n     * // => true\n     *\n     * _.isWeakMap(new Map);\n     * // => false\n     */\n    function isWeakMap(value) {\n      return isObjectLike(value) && getTag(value) == weakMapTag;\n    }\n\n    /**\n     * Checks if `value` is classified as a `WeakSet` object.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.3.0\n     * @category Lang\n     * @param {*} value The value to check.\n     * @returns {boolean} Returns `true` if `value` is a weak set, else `false`.\n     * @example\n     *\n     * _.isWeakSet(new WeakSet);\n     * // => true\n     *\n     * _.isWeakSet(new Set);\n     * // => false\n     */\n    function isWeakSet(value) {\n      return isObjectLike(value) && baseGetTag(value) == weakSetTag;\n    }\n\n    /**\n     * Checks if `value` is less than `other`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.9.0\n     * @category Lang\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @returns {boolean} Returns `true` if `value` is less than `other`,\n     *  else `false`.\n     * @see _.gt\n     * @example\n     *\n     * _.lt(1, 3);\n     * // => true\n     *\n     * _.lt(3, 3);\n     * // => false\n     *\n     * _.lt(3, 1);\n     * // => false\n     */\n    var lt = createRelationalOperation(baseLt);\n\n    /**\n     * Checks if `value` is less than or equal to `other`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.9.0\n     * @category Lang\n     * @param {*} value The value to compare.\n     * @param {*} other The other value to compare.\n     * @returns {boolean} Returns `true` if `value` is less than or equal to\n     *  `other`, else `false`.\n     * @see _.gte\n     * @example\n     *\n     * _.lte(1, 3);\n     * // => true\n     *\n     * _.lte(3, 3);\n     * // => true\n     *\n     * _.lte(3, 1);\n     * // => false\n     */\n    var lte = createRelationalOperation(function(value, other) {\n      return value <= other;\n    });\n\n    /**\n     * Converts `value` to an array.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Lang\n     * @param {*} value The value to convert.\n     * @returns {Array} Returns the converted array.\n     * @example\n     *\n     * _.toArray({ 'a': 1, 'b': 2 });\n     * // => [1, 2]\n     *\n     * _.toArray('abc');\n     * // => ['a', 'b', 'c']\n     *\n     * _.toArray(1);\n     * // => []\n     *\n     * _.toArray(null);\n     * // => []\n     */\n    function toArray(value) {\n      if (!value) {\n        return [];\n      }\n      if (isArrayLike(value)) {\n        return isString(value) ? stringToArray(value) : copyArray(value);\n      }\n      if (symIterator && value[symIterator]) {\n        return iteratorToArray(value[symIterator]());\n      }\n      var tag = getTag(value),\n          func = tag == mapTag ? mapToArray : (tag == setTag ? setToArray : values);\n\n      return func(value);\n    }\n\n    /**\n     * Converts `value` to a finite number.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.12.0\n     * @category Lang\n     * @param {*} value The value to convert.\n     * @returns {number} Returns the converted number.\n     * @example\n     *\n     * _.toFinite(3.2);\n     * // => 3.2\n     *\n     * _.toFinite(Number.MIN_VALUE);\n     * // => 5e-324\n     *\n     * _.toFinite(Infinity);\n     * // => 1.7976931348623157e+308\n     *\n     * _.toFinite('3.2');\n     * // => 3.2\n     */\n    function toFinite(value) {\n      if (!value) {\n        return value === 0 ? value : 0;\n      }\n      value = toNumber(value);\n      if (value === INFINITY || value === -INFINITY) {\n        var sign = (value < 0 ? -1 : 1);\n        return sign * MAX_INTEGER;\n      }\n      return value === value ? value : 0;\n    }\n\n    /**\n     * Converts `value` to an integer.\n     *\n     * **Note:** This method is loosely based on\n     * [`ToInteger`](http://www.ecma-international.org/ecma-262/7.0/#sec-tointeger).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to convert.\n     * @returns {number} Returns the converted integer.\n     * @example\n     *\n     * _.toInteger(3.2);\n     * // => 3\n     *\n     * _.toInteger(Number.MIN_VALUE);\n     * // => 0\n     *\n     * _.toInteger(Infinity);\n     * // => 1.7976931348623157e+308\n     *\n     * _.toInteger('3.2');\n     * // => 3\n     */\n    function toInteger(value) {\n      var result = toFinite(value),\n          remainder = result % 1;\n\n      return result === result ? (remainder ? result - remainder : result) : 0;\n    }\n\n    /**\n     * Converts `value` to an integer suitable for use as the length of an\n     * array-like object.\n     *\n     * **Note:** This method is based on\n     * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to convert.\n     * @returns {number} Returns the converted integer.\n     * @example\n     *\n     * _.toLength(3.2);\n     * // => 3\n     *\n     * _.toLength(Number.MIN_VALUE);\n     * // => 0\n     *\n     * _.toLength(Infinity);\n     * // => 4294967295\n     *\n     * _.toLength('3.2');\n     * // => 3\n     */\n    function toLength(value) {\n      return value ? baseClamp(toInteger(value), 0, MAX_ARRAY_LENGTH) : 0;\n    }\n\n    /**\n     * Converts `value` to a number.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to process.\n     * @returns {number} Returns the number.\n     * @example\n     *\n     * _.toNumber(3.2);\n     * // => 3.2\n     *\n     * _.toNumber(Number.MIN_VALUE);\n     * // => 5e-324\n     *\n     * _.toNumber(Infinity);\n     * // => Infinity\n     *\n     * _.toNumber('3.2');\n     * // => 3.2\n     */\n    function toNumber(value) {\n      if (typeof value == 'number') {\n        return value;\n      }\n      if (isSymbol(value)) {\n        return NAN;\n      }\n      if (isObject(value)) {\n        var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n        value = isObject(other) ? (other + '') : other;\n      }\n      if (typeof value != 'string') {\n        return value === 0 ? value : +value;\n      }\n      value = value.replace(reTrim, '');\n      var isBinary = reIsBinary.test(value);\n      return (isBinary || reIsOctal.test(value))\n        ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n        : (reIsBadHex.test(value) ? NAN : +value);\n    }\n\n    /**\n     * Converts `value` to a plain object flattening inherited enumerable string\n     * keyed properties of `value` to own properties of the plain object.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Lang\n     * @param {*} value The value to convert.\n     * @returns {Object} Returns the converted plain object.\n     * @example\n     *\n     * function Foo() {\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.assign({ 'a': 1 }, new Foo);\n     * // => { 'a': 1, 'b': 2 }\n     *\n     * _.assign({ 'a': 1 }, _.toPlainObject(new Foo));\n     * // => { 'a': 1, 'b': 2, 'c': 3 }\n     */\n    function toPlainObject(value) {\n      return copyObject(value, keysIn(value));\n    }\n\n    /**\n     * Converts `value` to a safe integer. A safe integer can be compared and\n     * represented correctly.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to convert.\n     * @returns {number} Returns the converted integer.\n     * @example\n     *\n     * _.toSafeInteger(3.2);\n     * // => 3\n     *\n     * _.toSafeInteger(Number.MIN_VALUE);\n     * // => 0\n     *\n     * _.toSafeInteger(Infinity);\n     * // => 9007199254740991\n     *\n     * _.toSafeInteger('3.2');\n     * // => 3\n     */\n    function toSafeInteger(value) {\n      return value\n        ? baseClamp(toInteger(value), -MAX_SAFE_INTEGER, MAX_SAFE_INTEGER)\n        : (value === 0 ? value : 0);\n    }\n\n    /**\n     * Converts `value` to a string. An empty string is returned for `null`\n     * and `undefined` values. The sign of `-0` is preserved.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Lang\n     * @param {*} value The value to convert.\n     * @returns {string} Returns the converted string.\n     * @example\n     *\n     * _.toString(null);\n     * // => ''\n     *\n     * _.toString(-0);\n     * // => '-0'\n     *\n     * _.toString([1, 2, 3]);\n     * // => '1,2,3'\n     */\n    function toString(value) {\n      return value == null ? '' : baseToString(value);\n    }\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Assigns own enumerable string keyed properties of source objects to the\n     * destination object. Source objects are applied from left to right.\n     * Subsequent sources overwrite property assignments of previous sources.\n     *\n     * **Note:** This method mutates `object` and is loosely based on\n     * [`Object.assign`](https://mdn.io/Object/assign).\n     *\n     * @static\n     * @memberOf _\n     * @since 0.10.0\n     * @category Object\n     * @param {Object} object The destination object.\n     * @param {...Object} [sources] The source objects.\n     * @returns {Object} Returns `object`.\n     * @see _.assignIn\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     * }\n     *\n     * function Bar() {\n     *   this.c = 3;\n     * }\n     *\n     * Foo.prototype.b = 2;\n     * Bar.prototype.d = 4;\n     *\n     * _.assign({ 'a': 0 }, new Foo, new Bar);\n     * // => { 'a': 1, 'c': 3 }\n     */\n    var assign = createAssigner(function(object, source) {\n      if (isPrototype(source) || isArrayLike(source)) {\n        copyObject(source, keys(source), object);\n        return;\n      }\n      for (var key in source) {\n        if (hasOwnProperty.call(source, key)) {\n          assignValue(object, key, source[key]);\n        }\n      }\n    });\n\n    /**\n     * This method is like `_.assign` except that it iterates over own and\n     * inherited source properties.\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @alias extend\n     * @category Object\n     * @param {Object} object The destination object.\n     * @param {...Object} [sources] The source objects.\n     * @returns {Object} Returns `object`.\n     * @see _.assign\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     * }\n     *\n     * function Bar() {\n     *   this.c = 3;\n     * }\n     *\n     * Foo.prototype.b = 2;\n     * Bar.prototype.d = 4;\n     *\n     * _.assignIn({ 'a': 0 }, new Foo, new Bar);\n     * // => { 'a': 1, 'b': 2, 'c': 3, 'd': 4 }\n     */\n    var assignIn = createAssigner(function(object, source) {\n      copyObject(source, keysIn(source), object);\n    });\n\n    /**\n     * This method is like `_.assignIn` except that it accepts `customizer`\n     * which is invoked to produce the assigned values. If `customizer` returns\n     * `undefined`, assignment is handled by the method instead. The `customizer`\n     * is invoked with five arguments: (objValue, srcValue, key, object, source).\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @alias extendWith\n     * @category Object\n     * @param {Object} object The destination object.\n     * @param {...Object} sources The source objects.\n     * @param {Function} [customizer] The function to customize assigned values.\n     * @returns {Object} Returns `object`.\n     * @see _.assignWith\n     * @example\n     *\n     * function customizer(objValue, srcValue) {\n     *   return _.isUndefined(objValue) ? srcValue : objValue;\n     * }\n     *\n     * var defaults = _.partialRight(_.assignInWith, customizer);\n     *\n     * defaults({ 'a': 1 }, { 'b': 2 }, { 'a': 3 });\n     * // => { 'a': 1, 'b': 2 }\n     */\n    var assignInWith = createAssigner(function(object, source, srcIndex, customizer) {\n      copyObject(source, keysIn(source), object, customizer);\n    });\n\n    /**\n     * This method is like `_.assign` except that it accepts `customizer`\n     * which is invoked to produce the assigned values. If `customizer` returns\n     * `undefined`, assignment is handled by the method instead. The `customizer`\n     * is invoked with five arguments: (objValue, srcValue, key, object, source).\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Object\n     * @param {Object} object The destination object.\n     * @param {...Object} sources The source objects.\n     * @param {Function} [customizer] The function to customize assigned values.\n     * @returns {Object} Returns `object`.\n     * @see _.assignInWith\n     * @example\n     *\n     * function customizer(objValue, srcValue) {\n     *   return _.isUndefined(objValue) ? srcValue : objValue;\n     * }\n     *\n     * var defaults = _.partialRight(_.assignWith, customizer);\n     *\n     * defaults({ 'a': 1 }, { 'b': 2 }, { 'a': 3 });\n     * // => { 'a': 1, 'b': 2 }\n     */\n    var assignWith = createAssigner(function(object, source, srcIndex, customizer) {\n      copyObject(source, keys(source), object, customizer);\n    });\n\n    /**\n     * Creates an array of values corresponding to `paths` of `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 1.0.0\n     * @category Object\n     * @param {Object} object The object to iterate over.\n     * @param {...(string|string[])} [paths] The property paths to pick.\n     * @returns {Array} Returns the picked values.\n     * @example\n     *\n     * var object = { 'a': [{ 'b': { 'c': 3 } }, 4] };\n     *\n     * _.at(object, ['a[0].b.c', 'a[1]']);\n     * // => [3, 4]\n     */\n    var at = flatRest(baseAt);\n\n    /**\n     * Creates an object that inherits from the `prototype` object. If a\n     * `properties` object is given, its own enumerable string keyed properties\n     * are assigned to the created object.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.3.0\n     * @category Object\n     * @param {Object} prototype The object to inherit from.\n     * @param {Object} [properties] The properties to assign to the object.\n     * @returns {Object} Returns the new object.\n     * @example\n     *\n     * function Shape() {\n     *   this.x = 0;\n     *   this.y = 0;\n     * }\n     *\n     * function Circle() {\n     *   Shape.call(this);\n     * }\n     *\n     * Circle.prototype = _.create(Shape.prototype, {\n     *   'constructor': Circle\n     * });\n     *\n     * var circle = new Circle;\n     * circle instanceof Circle;\n     * // => true\n     *\n     * circle instanceof Shape;\n     * // => true\n     */\n    function create(prototype, properties) {\n      var result = baseCreate(prototype);\n      return properties == null ? result : baseAssign(result, properties);\n    }\n\n    /**\n     * Assigns own and inherited enumerable string keyed properties of source\n     * objects to the destination object for all destination properties that\n     * resolve to `undefined`. Source objects are applied from left to right.\n     * Once a property is set, additional values of the same property are ignored.\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Object\n     * @param {Object} object The destination object.\n     * @param {...Object} [sources] The source objects.\n     * @returns {Object} Returns `object`.\n     * @see _.defaultsDeep\n     * @example\n     *\n     * _.defaults({ 'a': 1 }, { 'b': 2 }, { 'a': 3 });\n     * // => { 'a': 1, 'b': 2 }\n     */\n    var defaults = baseRest(function(object, sources) {\n      object = Object(object);\n\n      var index = -1;\n      var length = sources.length;\n      var guard = length > 2 ? sources[2] : undefined;\n\n      if (guard && isIterateeCall(sources[0], sources[1], guard)) {\n        length = 1;\n      }\n\n      while (++index < length) {\n        var source = sources[index];\n        var props = keysIn(source);\n        var propsIndex = -1;\n        var propsLength = props.length;\n\n        while (++propsIndex < propsLength) {\n          var key = props[propsIndex];\n          var value = object[key];\n\n          if (value === undefined ||\n              (eq(value, objectProto[key]) && !hasOwnProperty.call(object, key))) {\n            object[key] = source[key];\n          }\n        }\n      }\n\n      return object;\n    });\n\n    /**\n     * This method is like `_.defaults` except that it recursively assigns\n     * default properties.\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.10.0\n     * @category Object\n     * @param {Object} object The destination object.\n     * @param {...Object} [sources] The source objects.\n     * @returns {Object} Returns `object`.\n     * @see _.defaults\n     * @example\n     *\n     * _.defaultsDeep({ 'a': { 'b': 2 } }, { 'a': { 'b': 1, 'c': 3 } });\n     * // => { 'a': { 'b': 2, 'c': 3 } }\n     */\n    var defaultsDeep = baseRest(function(args) {\n      args.push(undefined, customDefaultsMerge);\n      return apply(mergeWith, undefined, args);\n    });\n\n    /**\n     * This method is like `_.find` except that it returns the key of the first\n     * element `predicate` returns truthy for instead of the element itself.\n     *\n     * @static\n     * @memberOf _\n     * @since 1.1.0\n     * @category Object\n     * @param {Object} object The object to inspect.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @returns {string|undefined} Returns the key of the matched element,\n     *  else `undefined`.\n     * @example\n     *\n     * var users = {\n     *   'barney':  { 'age': 36, 'active': true },\n     *   'fred':    { 'age': 40, 'active': false },\n     *   'pebbles': { 'age': 1,  'active': true }\n     * };\n     *\n     * _.findKey(users, function(o) { return o.age < 40; });\n     * // => 'barney' (iteration order is not guaranteed)\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.findKey(users, { 'age': 1, 'active': true });\n     * // => 'pebbles'\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.findKey(users, ['active', false]);\n     * // => 'fred'\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.findKey(users, 'active');\n     * // => 'barney'\n     */\n    function findKey(object, predicate) {\n      return baseFindKey(object, getIteratee(predicate, 3), baseForOwn);\n    }\n\n    /**\n     * This method is like `_.findKey` except that it iterates over elements of\n     * a collection in the opposite order.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.0.0\n     * @category Object\n     * @param {Object} object The object to inspect.\n     * @param {Function} [predicate=_.identity] The function invoked per iteration.\n     * @returns {string|undefined} Returns the key of the matched element,\n     *  else `undefined`.\n     * @example\n     *\n     * var users = {\n     *   'barney':  { 'age': 36, 'active': true },\n     *   'fred':    { 'age': 40, 'active': false },\n     *   'pebbles': { 'age': 1,  'active': true }\n     * };\n     *\n     * _.findLastKey(users, function(o) { return o.age < 40; });\n     * // => returns 'pebbles' assuming `_.findKey` returns 'barney'\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.findLastKey(users, { 'age': 36, 'active': true });\n     * // => 'barney'\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.findLastKey(users, ['active', false]);\n     * // => 'fred'\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.findLastKey(users, 'active');\n     * // => 'pebbles'\n     */\n    function findLastKey(object, predicate) {\n      return baseFindKey(object, getIteratee(predicate, 3), baseForOwnRight);\n    }\n\n    /**\n     * Iterates over own and inherited enumerable string keyed properties of an\n     * object and invokes `iteratee` for each property. The iteratee is invoked\n     * with three arguments: (value, key, object). Iteratee functions may exit\n     * iteration early by explicitly returning `false`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.3.0\n     * @category Object\n     * @param {Object} object The object to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Object} Returns `object`.\n     * @see _.forInRight\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.forIn(new Foo, function(value, key) {\n     *   console.log(key);\n     * });\n     * // => Logs 'a', 'b', then 'c' (iteration order is not guaranteed).\n     */\n    function forIn(object, iteratee) {\n      return object == null\n        ? object\n        : baseFor(object, getIteratee(iteratee, 3), keysIn);\n    }\n\n    /**\n     * This method is like `_.forIn` except that it iterates over properties of\n     * `object` in the opposite order.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.0.0\n     * @category Object\n     * @param {Object} object The object to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Object} Returns `object`.\n     * @see _.forIn\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.forInRight(new Foo, function(value, key) {\n     *   console.log(key);\n     * });\n     * // => Logs 'c', 'b', then 'a' assuming `_.forIn` logs 'a', 'b', then 'c'.\n     */\n    function forInRight(object, iteratee) {\n      return object == null\n        ? object\n        : baseForRight(object, getIteratee(iteratee, 3), keysIn);\n    }\n\n    /**\n     * Iterates over own enumerable string keyed properties of an object and\n     * invokes `iteratee` for each property. The iteratee is invoked with three\n     * arguments: (value, key, object). Iteratee functions may exit iteration\n     * early by explicitly returning `false`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.3.0\n     * @category Object\n     * @param {Object} object The object to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Object} Returns `object`.\n     * @see _.forOwnRight\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.forOwn(new Foo, function(value, key) {\n     *   console.log(key);\n     * });\n     * // => Logs 'a' then 'b' (iteration order is not guaranteed).\n     */\n    function forOwn(object, iteratee) {\n      return object && baseForOwn(object, getIteratee(iteratee, 3));\n    }\n\n    /**\n     * This method is like `_.forOwn` except that it iterates over properties of\n     * `object` in the opposite order.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.0.0\n     * @category Object\n     * @param {Object} object The object to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Object} Returns `object`.\n     * @see _.forOwn\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.forOwnRight(new Foo, function(value, key) {\n     *   console.log(key);\n     * });\n     * // => Logs 'b' then 'a' assuming `_.forOwn` logs 'a' then 'b'.\n     */\n    function forOwnRight(object, iteratee) {\n      return object && baseForOwnRight(object, getIteratee(iteratee, 3));\n    }\n\n    /**\n     * Creates an array of function property names from own enumerable properties\n     * of `object`.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Object\n     * @param {Object} object The object to inspect.\n     * @returns {Array} Returns the function names.\n     * @see _.functionsIn\n     * @example\n     *\n     * function Foo() {\n     *   this.a = _.constant('a');\n     *   this.b = _.constant('b');\n     * }\n     *\n     * Foo.prototype.c = _.constant('c');\n     *\n     * _.functions(new Foo);\n     * // => ['a', 'b']\n     */\n    function functions(object) {\n      return object == null ? [] : baseFunctions(object, keys(object));\n    }\n\n    /**\n     * Creates an array of function property names from own and inherited\n     * enumerable properties of `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Object\n     * @param {Object} object The object to inspect.\n     * @returns {Array} Returns the function names.\n     * @see _.functions\n     * @example\n     *\n     * function Foo() {\n     *   this.a = _.constant('a');\n     *   this.b = _.constant('b');\n     * }\n     *\n     * Foo.prototype.c = _.constant('c');\n     *\n     * _.functionsIn(new Foo);\n     * // => ['a', 'b', 'c']\n     */\n    function functionsIn(object) {\n      return object == null ? [] : baseFunctions(object, keysIn(object));\n    }\n\n    /**\n     * Gets the value at `path` of `object`. If the resolved value is\n     * `undefined`, the `defaultValue` is returned in its place.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.7.0\n     * @category Object\n     * @param {Object} object The object to query.\n     * @param {Array|string} path The path of the property to get.\n     * @param {*} [defaultValue] The value returned for `undefined` resolved values.\n     * @returns {*} Returns the resolved value.\n     * @example\n     *\n     * var object = { 'a': [{ 'b': { 'c': 3 } }] };\n     *\n     * _.get(object, 'a[0].b.c');\n     * // => 3\n     *\n     * _.get(object, ['a', '0', 'b', 'c']);\n     * // => 3\n     *\n     * _.get(object, 'a.b.c', 'default');\n     * // => 'default'\n     */\n    function get(object, path, defaultValue) {\n      var result = object == null ? undefined : baseGet(object, path);\n      return result === undefined ? defaultValue : result;\n    }\n\n    /**\n     * Checks if `path` is a direct property of `object`.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Object\n     * @param {Object} object The object to query.\n     * @param {Array|string} path The path to check.\n     * @returns {boolean} Returns `true` if `path` exists, else `false`.\n     * @example\n     *\n     * var object = { 'a': { 'b': 2 } };\n     * var other = _.create({ 'a': _.create({ 'b': 2 }) });\n     *\n     * _.has(object, 'a');\n     * // => true\n     *\n     * _.has(object, 'a.b');\n     * // => true\n     *\n     * _.has(object, ['a', 'b']);\n     * // => true\n     *\n     * _.has(other, 'a');\n     * // => false\n     */\n    function has(object, path) {\n      return object != null && hasPath(object, path, baseHas);\n    }\n\n    /**\n     * Checks if `path` is a direct or inherited property of `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Object\n     * @param {Object} object The object to query.\n     * @param {Array|string} path The path to check.\n     * @returns {boolean} Returns `true` if `path` exists, else `false`.\n     * @example\n     *\n     * var object = _.create({ 'a': _.create({ 'b': 2 }) });\n     *\n     * _.hasIn(object, 'a');\n     * // => true\n     *\n     * _.hasIn(object, 'a.b');\n     * // => true\n     *\n     * _.hasIn(object, ['a', 'b']);\n     * // => true\n     *\n     * _.hasIn(object, 'b');\n     * // => false\n     */\n    function hasIn(object, path) {\n      return object != null && hasPath(object, path, baseHasIn);\n    }\n\n    /**\n     * Creates an object composed of the inverted keys and values of `object`.\n     * If `object` contains duplicate values, subsequent values overwrite\n     * property assignments of previous values.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.7.0\n     * @category Object\n     * @param {Object} object The object to invert.\n     * @returns {Object} Returns the new inverted object.\n     * @example\n     *\n     * var object = { 'a': 1, 'b': 2, 'c': 1 };\n     *\n     * _.invert(object);\n     * // => { '1': 'c', '2': 'b' }\n     */\n    var invert = createInverter(function(result, value, key) {\n      if (value != null &&\n          typeof value.toString != 'function') {\n        value = nativeObjectToString.call(value);\n      }\n\n      result[value] = key;\n    }, constant(identity));\n\n    /**\n     * This method is like `_.invert` except that the inverted object is generated\n     * from the results of running each element of `object` thru `iteratee`. The\n     * corresponding inverted value of each inverted key is an array of keys\n     * responsible for generating the inverted value. The iteratee is invoked\n     * with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.1.0\n     * @category Object\n     * @param {Object} object The object to invert.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {Object} Returns the new inverted object.\n     * @example\n     *\n     * var object = { 'a': 1, 'b': 2, 'c': 1 };\n     *\n     * _.invertBy(object);\n     * // => { '1': ['a', 'c'], '2': ['b'] }\n     *\n     * _.invertBy(object, function(value) {\n     *   return 'group' + value;\n     * });\n     * // => { 'group1': ['a', 'c'], 'group2': ['b'] }\n     */\n    var invertBy = createInverter(function(result, value, key) {\n      if (value != null &&\n          typeof value.toString != 'function') {\n        value = nativeObjectToString.call(value);\n      }\n\n      if (hasOwnProperty.call(result, value)) {\n        result[value].push(key);\n      } else {\n        result[value] = [key];\n      }\n    }, getIteratee);\n\n    /**\n     * Invokes the method at `path` of `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Object\n     * @param {Object} object The object to query.\n     * @param {Array|string} path The path of the method to invoke.\n     * @param {...*} [args] The arguments to invoke the method with.\n     * @returns {*} Returns the result of the invoked method.\n     * @example\n     *\n     * var object = { 'a': [{ 'b': { 'c': [1, 2, 3, 4] } }] };\n     *\n     * _.invoke(object, 'a[0].b.c.slice', 1, 3);\n     * // => [2, 3]\n     */\n    var invoke = baseRest(baseInvoke);\n\n    /**\n     * Creates an array of the own enumerable property names of `object`.\n     *\n     * **Note:** Non-object values are coerced to objects. See the\n     * [ES spec](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n     * for more details.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Object\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of property names.\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.keys(new Foo);\n     * // => ['a', 'b'] (iteration order is not guaranteed)\n     *\n     * _.keys('hi');\n     * // => ['0', '1']\n     */\n    function keys(object) {\n      return isArrayLike(object) ? arrayLikeKeys(object) : baseKeys(object);\n    }\n\n    /**\n     * Creates an array of the own and inherited enumerable property names of `object`.\n     *\n     * **Note:** Non-object values are coerced to objects.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Object\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of property names.\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.keysIn(new Foo);\n     * // => ['a', 'b', 'c'] (iteration order is not guaranteed)\n     */\n    function keysIn(object) {\n      return isArrayLike(object) ? arrayLikeKeys(object, true) : baseKeysIn(object);\n    }\n\n    /**\n     * The opposite of `_.mapValues`; this method creates an object with the\n     * same values as `object` and keys generated by running each own enumerable\n     * string keyed property of `object` thru `iteratee`. The iteratee is invoked\n     * with three arguments: (value, key, object).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.8.0\n     * @category Object\n     * @param {Object} object The object to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Object} Returns the new mapped object.\n     * @see _.mapValues\n     * @example\n     *\n     * _.mapKeys({ 'a': 1, 'b': 2 }, function(value, key) {\n     *   return key + value;\n     * });\n     * // => { 'a1': 1, 'b2': 2 }\n     */\n    function mapKeys(object, iteratee) {\n      var result = {};\n      iteratee = getIteratee(iteratee, 3);\n\n      baseForOwn(object, function(value, key, object) {\n        baseAssignValue(result, iteratee(value, key, object), value);\n      });\n      return result;\n    }\n\n    /**\n     * Creates an object with the same keys as `object` and values generated\n     * by running each own enumerable string keyed property of `object` thru\n     * `iteratee`. The iteratee is invoked with three arguments:\n     * (value, key, object).\n     *\n     * @static\n     * @memberOf _\n     * @since 2.4.0\n     * @category Object\n     * @param {Object} object The object to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Object} Returns the new mapped object.\n     * @see _.mapKeys\n     * @example\n     *\n     * var users = {\n     *   'fred':    { 'user': 'fred',    'age': 40 },\n     *   'pebbles': { 'user': 'pebbles', 'age': 1 }\n     * };\n     *\n     * _.mapValues(users, function(o) { return o.age; });\n     * // => { 'fred': 40, 'pebbles': 1 } (iteration order is not guaranteed)\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.mapValues(users, 'age');\n     * // => { 'fred': 40, 'pebbles': 1 } (iteration order is not guaranteed)\n     */\n    function mapValues(object, iteratee) {\n      var result = {};\n      iteratee = getIteratee(iteratee, 3);\n\n      baseForOwn(object, function(value, key, object) {\n        baseAssignValue(result, key, iteratee(value, key, object));\n      });\n      return result;\n    }\n\n    /**\n     * This method is like `_.assign` except that it recursively merges own and\n     * inherited enumerable string keyed properties of source objects into the\n     * destination object. Source properties that resolve to `undefined` are\n     * skipped if a destination value exists. Array and plain object properties\n     * are merged recursively. Other objects and value types are overridden by\n     * assignment. Source objects are applied from left to right. Subsequent\n     * sources overwrite property assignments of previous sources.\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.5.0\n     * @category Object\n     * @param {Object} object The destination object.\n     * @param {...Object} [sources] The source objects.\n     * @returns {Object} Returns `object`.\n     * @example\n     *\n     * var object = {\n     *   'a': [{ 'b': 2 }, { 'd': 4 }]\n     * };\n     *\n     * var other = {\n     *   'a': [{ 'c': 3 }, { 'e': 5 }]\n     * };\n     *\n     * _.merge(object, other);\n     * // => { 'a': [{ 'b': 2, 'c': 3 }, { 'd': 4, 'e': 5 }] }\n     */\n    var merge = createAssigner(function(object, source, srcIndex) {\n      baseMerge(object, source, srcIndex);\n    });\n\n    /**\n     * This method is like `_.merge` except that it accepts `customizer` which\n     * is invoked to produce the merged values of the destination and source\n     * properties. If `customizer` returns `undefined`, merging is handled by the\n     * method instead. The `customizer` is invoked with six arguments:\n     * (objValue, srcValue, key, object, source, stack).\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Object\n     * @param {Object} object The destination object.\n     * @param {...Object} sources The source objects.\n     * @param {Function} customizer The function to customize assigned values.\n     * @returns {Object} Returns `object`.\n     * @example\n     *\n     * function customizer(objValue, srcValue) {\n     *   if (_.isArray(objValue)) {\n     *     return objValue.concat(srcValue);\n     *   }\n     * }\n     *\n     * var object = { 'a': [1], 'b': [2] };\n     * var other = { 'a': [3], 'b': [4] };\n     *\n     * _.mergeWith(object, other, customizer);\n     * // => { 'a': [1, 3], 'b': [2, 4] }\n     */\n    var mergeWith = createAssigner(function(object, source, srcIndex, customizer) {\n      baseMerge(object, source, srcIndex, customizer);\n    });\n\n    /**\n     * The opposite of `_.pick`; this method creates an object composed of the\n     * own and inherited enumerable property paths of `object` that are not omitted.\n     *\n     * **Note:** This method is considerably slower than `_.pick`.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Object\n     * @param {Object} object The source object.\n     * @param {...(string|string[])} [paths] The property paths to omit.\n     * @returns {Object} Returns the new object.\n     * @example\n     *\n     * var object = { 'a': 1, 'b': '2', 'c': 3 };\n     *\n     * _.omit(object, ['a', 'c']);\n     * // => { 'b': '2' }\n     */\n    var omit = flatRest(function(object, paths) {\n      var result = {};\n      if (object == null) {\n        return result;\n      }\n      var isDeep = false;\n      paths = arrayMap(paths, function(path) {\n        path = castPath(path, object);\n        isDeep || (isDeep = path.length > 1);\n        return path;\n      });\n      copyObject(object, getAllKeysIn(object), result);\n      if (isDeep) {\n        result = baseClone(result, CLONE_DEEP_FLAG | CLONE_FLAT_FLAG | CLONE_SYMBOLS_FLAG, customOmitClone);\n      }\n      var length = paths.length;\n      while (length--) {\n        baseUnset(result, paths[length]);\n      }\n      return result;\n    });\n\n    /**\n     * The opposite of `_.pickBy`; this method creates an object composed of\n     * the own and inherited enumerable string keyed properties of `object` that\n     * `predicate` doesn't return truthy for. The predicate is invoked with two\n     * arguments: (value, key).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Object\n     * @param {Object} object The source object.\n     * @param {Function} [predicate=_.identity] The function invoked per property.\n     * @returns {Object} Returns the new object.\n     * @example\n     *\n     * var object = { 'a': 1, 'b': '2', 'c': 3 };\n     *\n     * _.omitBy(object, _.isNumber);\n     * // => { 'b': '2' }\n     */\n    function omitBy(object, predicate) {\n      return pickBy(object, negate(getIteratee(predicate)));\n    }\n\n    /**\n     * Creates an object composed of the picked `object` properties.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Object\n     * @param {Object} object The source object.\n     * @param {...(string|string[])} [paths] The property paths to pick.\n     * @returns {Object} Returns the new object.\n     * @example\n     *\n     * var object = { 'a': 1, 'b': '2', 'c': 3 };\n     *\n     * _.pick(object, ['a', 'c']);\n     * // => { 'a': 1, 'c': 3 }\n     */\n    var pick = flatRest(function(object, paths) {\n      return object == null ? {} : basePick(object, paths);\n    });\n\n    /**\n     * Creates an object composed of the `object` properties `predicate` returns\n     * truthy for. The predicate is invoked with two arguments: (value, key).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Object\n     * @param {Object} object The source object.\n     * @param {Function} [predicate=_.identity] The function invoked per property.\n     * @returns {Object} Returns the new object.\n     * @example\n     *\n     * var object = { 'a': 1, 'b': '2', 'c': 3 };\n     *\n     * _.pickBy(object, _.isNumber);\n     * // => { 'a': 1, 'c': 3 }\n     */\n    function pickBy(object, predicate) {\n      if (object == null) {\n        return {};\n      }\n      var props = arrayMap(getAllKeysIn(object), function(prop) {\n        return [prop];\n      });\n      predicate = getIteratee(predicate);\n      return basePickBy(object, props, function(value, path) {\n        return predicate(value, path[0]);\n      });\n    }\n\n    /**\n     * This method is like `_.get` except that if the resolved value is a\n     * function it's invoked with the `this` binding of its parent object and\n     * its result is returned.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Object\n     * @param {Object} object The object to query.\n     * @param {Array|string} path The path of the property to resolve.\n     * @param {*} [defaultValue] The value returned for `undefined` resolved values.\n     * @returns {*} Returns the resolved value.\n     * @example\n     *\n     * var object = { 'a': [{ 'b': { 'c1': 3, 'c2': _.constant(4) } }] };\n     *\n     * _.result(object, 'a[0].b.c1');\n     * // => 3\n     *\n     * _.result(object, 'a[0].b.c2');\n     * // => 4\n     *\n     * _.result(object, 'a[0].b.c3', 'default');\n     * // => 'default'\n     *\n     * _.result(object, 'a[0].b.c3', _.constant('default'));\n     * // => 'default'\n     */\n    function result(object, path, defaultValue) {\n      path = castPath(path, object);\n\n      var index = -1,\n          length = path.length;\n\n      // Ensure the loop is entered when path is empty.\n      if (!length) {\n        length = 1;\n        object = undefined;\n      }\n      while (++index < length) {\n        var value = object == null ? undefined : object[toKey(path[index])];\n        if (value === undefined) {\n          index = length;\n          value = defaultValue;\n        }\n        object = isFunction(value) ? value.call(object) : value;\n      }\n      return object;\n    }\n\n    /**\n     * Sets the value at `path` of `object`. If a portion of `path` doesn't exist,\n     * it's created. Arrays are created for missing index properties while objects\n     * are created for all other missing properties. Use `_.setWith` to customize\n     * `path` creation.\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.7.0\n     * @category Object\n     * @param {Object} object The object to modify.\n     * @param {Array|string} path The path of the property to set.\n     * @param {*} value The value to set.\n     * @returns {Object} Returns `object`.\n     * @example\n     *\n     * var object = { 'a': [{ 'b': { 'c': 3 } }] };\n     *\n     * _.set(object, 'a[0].b.c', 4);\n     * console.log(object.a[0].b.c);\n     * // => 4\n     *\n     * _.set(object, ['x', '0', 'y', 'z'], 5);\n     * console.log(object.x[0].y.z);\n     * // => 5\n     */\n    function set(object, path, value) {\n      return object == null ? object : baseSet(object, path, value);\n    }\n\n    /**\n     * This method is like `_.set` except that it accepts `customizer` which is\n     * invoked to produce the objects of `path`.  If `customizer` returns `undefined`\n     * path creation is handled by the method instead. The `customizer` is invoked\n     * with three arguments: (nsValue, key, nsObject).\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Object\n     * @param {Object} object The object to modify.\n     * @param {Array|string} path The path of the property to set.\n     * @param {*} value The value to set.\n     * @param {Function} [customizer] The function to customize assigned values.\n     * @returns {Object} Returns `object`.\n     * @example\n     *\n     * var object = {};\n     *\n     * _.setWith(object, '[0][1]', 'a', Object);\n     * // => { '0': { '1': 'a' } }\n     */\n    function setWith(object, path, value, customizer) {\n      customizer = typeof customizer == 'function' ? customizer : undefined;\n      return object == null ? object : baseSet(object, path, value, customizer);\n    }\n\n    /**\n     * Creates an array of own enumerable string keyed-value pairs for `object`\n     * which can be consumed by `_.fromPairs`. If `object` is a map or set, its\n     * entries are returned.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @alias entries\n     * @category Object\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the key-value pairs.\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.toPairs(new Foo);\n     * // => [['a', 1], ['b', 2]] (iteration order is not guaranteed)\n     */\n    var toPairs = createToPairs(keys);\n\n    /**\n     * Creates an array of own and inherited enumerable string keyed-value pairs\n     * for `object` which can be consumed by `_.fromPairs`. If `object` is a map\n     * or set, its entries are returned.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @alias entriesIn\n     * @category Object\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the key-value pairs.\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.toPairsIn(new Foo);\n     * // => [['a', 1], ['b', 2], ['c', 3]] (iteration order is not guaranteed)\n     */\n    var toPairsIn = createToPairs(keysIn);\n\n    /**\n     * An alternative to `_.reduce`; this method transforms `object` to a new\n     * `accumulator` object which is the result of running each of its own\n     * enumerable string keyed properties thru `iteratee`, with each invocation\n     * potentially mutating the `accumulator` object. If `accumulator` is not\n     * provided, a new object with the same `[[Prototype]]` will be used. The\n     * iteratee is invoked with four arguments: (accumulator, value, key, object).\n     * Iteratee functions may exit iteration early by explicitly returning `false`.\n     *\n     * @static\n     * @memberOf _\n     * @since 1.3.0\n     * @category Object\n     * @param {Object} object The object to iterate over.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @param {*} [accumulator] The custom accumulator value.\n     * @returns {*} Returns the accumulated value.\n     * @example\n     *\n     * _.transform([2, 3, 4], function(result, n) {\n     *   result.push(n *= n);\n     *   return n % 2 == 0;\n     * }, []);\n     * // => [4, 9]\n     *\n     * _.transform({ 'a': 1, 'b': 2, 'c': 1 }, function(result, value, key) {\n     *   (result[value] || (result[value] = [])).push(key);\n     * }, {});\n     * // => { '1': ['a', 'c'], '2': ['b'] }\n     */\n    function transform(object, iteratee, accumulator) {\n      var isArr = isArray(object),\n          isArrLike = isArr || isBuffer(object) || isTypedArray(object);\n\n      iteratee = getIteratee(iteratee, 4);\n      if (accumulator == null) {\n        var Ctor = object && object.constructor;\n        if (isArrLike) {\n          accumulator = isArr ? new Ctor : [];\n        }\n        else if (isObject(object)) {\n          accumulator = isFunction(Ctor) ? baseCreate(getPrototype(object)) : {};\n        }\n        else {\n          accumulator = {};\n        }\n      }\n      (isArrLike ? arrayEach : baseForOwn)(object, function(value, index, object) {\n        return iteratee(accumulator, value, index, object);\n      });\n      return accumulator;\n    }\n\n    /**\n     * Removes the property at `path` of `object`.\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Object\n     * @param {Object} object The object to modify.\n     * @param {Array|string} path The path of the property to unset.\n     * @returns {boolean} Returns `true` if the property is deleted, else `false`.\n     * @example\n     *\n     * var object = { 'a': [{ 'b': { 'c': 7 } }] };\n     * _.unset(object, 'a[0].b.c');\n     * // => true\n     *\n     * console.log(object);\n     * // => { 'a': [{ 'b': {} }] };\n     *\n     * _.unset(object, ['a', '0', 'b', 'c']);\n     * // => true\n     *\n     * console.log(object);\n     * // => { 'a': [{ 'b': {} }] };\n     */\n    function unset(object, path) {\n      return object == null ? true : baseUnset(object, path);\n    }\n\n    /**\n     * This method is like `_.set` except that accepts `updater` to produce the\n     * value to set. Use `_.updateWith` to customize `path` creation. The `updater`\n     * is invoked with one argument: (value).\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.6.0\n     * @category Object\n     * @param {Object} object The object to modify.\n     * @param {Array|string} path The path of the property to set.\n     * @param {Function} updater The function to produce the updated value.\n     * @returns {Object} Returns `object`.\n     * @example\n     *\n     * var object = { 'a': [{ 'b': { 'c': 3 } }] };\n     *\n     * _.update(object, 'a[0].b.c', function(n) { return n * n; });\n     * console.log(object.a[0].b.c);\n     * // => 9\n     *\n     * _.update(object, 'x[0].y.z', function(n) { return n ? n + 1 : 0; });\n     * console.log(object.x[0].y.z);\n     * // => 0\n     */\n    function update(object, path, updater) {\n      return object == null ? object : baseUpdate(object, path, castFunction(updater));\n    }\n\n    /**\n     * This method is like `_.update` except that it accepts `customizer` which is\n     * invoked to produce the objects of `path`.  If `customizer` returns `undefined`\n     * path creation is handled by the method instead. The `customizer` is invoked\n     * with three arguments: (nsValue, key, nsObject).\n     *\n     * **Note:** This method mutates `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.6.0\n     * @category Object\n     * @param {Object} object The object to modify.\n     * @param {Array|string} path The path of the property to set.\n     * @param {Function} updater The function to produce the updated value.\n     * @param {Function} [customizer] The function to customize assigned values.\n     * @returns {Object} Returns `object`.\n     * @example\n     *\n     * var object = {};\n     *\n     * _.updateWith(object, '[0][1]', _.constant('a'), Object);\n     * // => { '0': { '1': 'a' } }\n     */\n    function updateWith(object, path, updater, customizer) {\n      customizer = typeof customizer == 'function' ? customizer : undefined;\n      return object == null ? object : baseUpdate(object, path, castFunction(updater), customizer);\n    }\n\n    /**\n     * Creates an array of the own enumerable string keyed property values of `object`.\n     *\n     * **Note:** Non-object values are coerced to objects.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Object\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of property values.\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.values(new Foo);\n     * // => [1, 2] (iteration order is not guaranteed)\n     *\n     * _.values('hi');\n     * // => ['h', 'i']\n     */\n    function values(object) {\n      return object == null ? [] : baseValues(object, keys(object));\n    }\n\n    /**\n     * Creates an array of the own and inherited enumerable string keyed property\n     * values of `object`.\n     *\n     * **Note:** Non-object values are coerced to objects.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Object\n     * @param {Object} object The object to query.\n     * @returns {Array} Returns the array of property values.\n     * @example\n     *\n     * function Foo() {\n     *   this.a = 1;\n     *   this.b = 2;\n     * }\n     *\n     * Foo.prototype.c = 3;\n     *\n     * _.valuesIn(new Foo);\n     * // => [1, 2, 3] (iteration order is not guaranteed)\n     */\n    function valuesIn(object) {\n      return object == null ? [] : baseValues(object, keysIn(object));\n    }\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Clamps `number` within the inclusive `lower` and `upper` bounds.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Number\n     * @param {number} number The number to clamp.\n     * @param {number} [lower] The lower bound.\n     * @param {number} upper The upper bound.\n     * @returns {number} Returns the clamped number.\n     * @example\n     *\n     * _.clamp(-10, -5, 5);\n     * // => -5\n     *\n     * _.clamp(10, -5, 5);\n     * // => 5\n     */\n    function clamp(number, lower, upper) {\n      if (upper === undefined) {\n        upper = lower;\n        lower = undefined;\n      }\n      if (upper !== undefined) {\n        upper = toNumber(upper);\n        upper = upper === upper ? upper : 0;\n      }\n      if (lower !== undefined) {\n        lower = toNumber(lower);\n        lower = lower === lower ? lower : 0;\n      }\n      return baseClamp(toNumber(number), lower, upper);\n    }\n\n    /**\n     * Checks if `n` is between `start` and up to, but not including, `end`. If\n     * `end` is not specified, it's set to `start` with `start` then set to `0`.\n     * If `start` is greater than `end` the params are swapped to support\n     * negative ranges.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.3.0\n     * @category Number\n     * @param {number} number The number to check.\n     * @param {number} [start=0] The start of the range.\n     * @param {number} end The end of the range.\n     * @returns {boolean} Returns `true` if `number` is in the range, else `false`.\n     * @see _.range, _.rangeRight\n     * @example\n     *\n     * _.inRange(3, 2, 4);\n     * // => true\n     *\n     * _.inRange(4, 8);\n     * // => true\n     *\n     * _.inRange(4, 2);\n     * // => false\n     *\n     * _.inRange(2, 2);\n     * // => false\n     *\n     * _.inRange(1.2, 2);\n     * // => true\n     *\n     * _.inRange(5.2, 4);\n     * // => false\n     *\n     * _.inRange(-3, -2, -6);\n     * // => true\n     */\n    function inRange(number, start, end) {\n      start = toFinite(start);\n      if (end === undefined) {\n        end = start;\n        start = 0;\n      } else {\n        end = toFinite(end);\n      }\n      number = toNumber(number);\n      return baseInRange(number, start, end);\n    }\n\n    /**\n     * Produces a random number between the inclusive `lower` and `upper` bounds.\n     * If only one argument is provided a number between `0` and the given number\n     * is returned. If `floating` is `true`, or either `lower` or `upper` are\n     * floats, a floating-point number is returned instead of an integer.\n     *\n     * **Note:** JavaScript follows the IEEE-754 standard for resolving\n     * floating-point values which can produce unexpected results.\n     *\n     * @static\n     * @memberOf _\n     * @since 0.7.0\n     * @category Number\n     * @param {number} [lower=0] The lower bound.\n     * @param {number} [upper=1] The upper bound.\n     * @param {boolean} [floating] Specify returning a floating-point number.\n     * @returns {number} Returns the random number.\n     * @example\n     *\n     * _.random(0, 5);\n     * // => an integer between 0 and 5\n     *\n     * _.random(5);\n     * // => also an integer between 0 and 5\n     *\n     * _.random(5, true);\n     * // => a floating-point number between 0 and 5\n     *\n     * _.random(1.2, 5.2);\n     * // => a floating-point number between 1.2 and 5.2\n     */\n    function random(lower, upper, floating) {\n      if (floating && typeof floating != 'boolean' && isIterateeCall(lower, upper, floating)) {\n        upper = floating = undefined;\n      }\n      if (floating === undefined) {\n        if (typeof upper == 'boolean') {\n          floating = upper;\n          upper = undefined;\n        }\n        else if (typeof lower == 'boolean') {\n          floating = lower;\n          lower = undefined;\n        }\n      }\n      if (lower === undefined && upper === undefined) {\n        lower = 0;\n        upper = 1;\n      }\n      else {\n        lower = toFinite(lower);\n        if (upper === undefined) {\n          upper = lower;\n          lower = 0;\n        } else {\n          upper = toFinite(upper);\n        }\n      }\n      if (lower > upper) {\n        var temp = lower;\n        lower = upper;\n        upper = temp;\n      }\n      if (floating || lower % 1 || upper % 1) {\n        var rand = nativeRandom();\n        return nativeMin(lower + (rand * (upper - lower + freeParseFloat('1e-' + ((rand + '').length - 1)))), upper);\n      }\n      return baseRandom(lower, upper);\n    }\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Converts `string` to [camel case](https://en.wikipedia.org/wiki/CamelCase).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to convert.\n     * @returns {string} Returns the camel cased string.\n     * @example\n     *\n     * _.camelCase('Foo Bar');\n     * // => 'fooBar'\n     *\n     * _.camelCase('--foo-bar--');\n     * // => 'fooBar'\n     *\n     * _.camelCase('__FOO_BAR__');\n     * // => 'fooBar'\n     */\n    var camelCase = createCompounder(function(result, word, index) {\n      word = word.toLowerCase();\n      return result + (index ? capitalize(word) : word);\n    });\n\n    /**\n     * Converts the first character of `string` to upper case and the remaining\n     * to lower case.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to capitalize.\n     * @returns {string} Returns the capitalized string.\n     * @example\n     *\n     * _.capitalize('FRED');\n     * // => 'Fred'\n     */\n    function capitalize(string) {\n      return upperFirst(toString(string).toLowerCase());\n    }\n\n    /**\n     * Deburrs `string` by converting\n     * [Latin-1 Supplement](https://en.wikipedia.org/wiki/Latin-1_Supplement_(Unicode_block)#Character_table)\n     * and [Latin Extended-A](https://en.wikipedia.org/wiki/Latin_Extended-A)\n     * letters to basic Latin letters and removing\n     * [combining diacritical marks](https://en.wikipedia.org/wiki/Combining_Diacritical_Marks).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to deburr.\n     * @returns {string} Returns the deburred string.\n     * @example\n     *\n     * _.deburr('déjà vu');\n     * // => 'deja vu'\n     */\n    function deburr(string) {\n      string = toString(string);\n      return string && string.replace(reLatin, deburrLetter).replace(reComboMark, '');\n    }\n\n    /**\n     * Checks if `string` ends with the given target string.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to inspect.\n     * @param {string} [target] The string to search for.\n     * @param {number} [position=string.length] The position to search up to.\n     * @returns {boolean} Returns `true` if `string` ends with `target`,\n     *  else `false`.\n     * @example\n     *\n     * _.endsWith('abc', 'c');\n     * // => true\n     *\n     * _.endsWith('abc', 'b');\n     * // => false\n     *\n     * _.endsWith('abc', 'b', 2);\n     * // => true\n     */\n    function endsWith(string, target, position) {\n      string = toString(string);\n      target = baseToString(target);\n\n      var length = string.length;\n      position = position === undefined\n        ? length\n        : baseClamp(toInteger(position), 0, length);\n\n      var end = position;\n      position -= target.length;\n      return position >= 0 && string.slice(position, end) == target;\n    }\n\n    /**\n     * Converts the characters \"&\", \"<\", \">\", '\"', and \"'\" in `string` to their\n     * corresponding HTML entities.\n     *\n     * **Note:** No other characters are escaped. To escape additional\n     * characters use a third-party library like [_he_](https://mths.be/he).\n     *\n     * Though the \">\" character is escaped for symmetry, characters like\n     * \">\" and \"/\" don't need escaping in HTML and have no special meaning\n     * unless they're part of a tag or unquoted attribute value. See\n     * [Mathias Bynens's article](https://mathiasbynens.be/notes/ambiguous-ampersands)\n     * (under \"semi-related fun fact\") for more details.\n     *\n     * When working with HTML you should always\n     * [quote attribute values](http://wonko.com/post/html-escaping) to reduce\n     * XSS vectors.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category String\n     * @param {string} [string=''] The string to escape.\n     * @returns {string} Returns the escaped string.\n     * @example\n     *\n     * _.escape('fred, barney, & pebbles');\n     * // => 'fred, barney, &amp; pebbles'\n     */\n    function escape(string) {\n      string = toString(string);\n      return (string && reHasUnescapedHtml.test(string))\n        ? string.replace(reUnescapedHtml, escapeHtmlChar)\n        : string;\n    }\n\n    /**\n     * Escapes the `RegExp` special characters \"^\", \"$\", \"\\\", \".\", \"*\", \"+\",\n     * \"?\", \"(\", \")\", \"[\", \"]\", \"{\", \"}\", and \"|\" in `string`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to escape.\n     * @returns {string} Returns the escaped string.\n     * @example\n     *\n     * _.escapeRegExp('[lodash](https://lodash.com/)');\n     * // => '\\[lodash\\]\\(https://lodash\\.com/\\)'\n     */\n    function escapeRegExp(string) {\n      string = toString(string);\n      return (string && reHasRegExpChar.test(string))\n        ? string.replace(reRegExpChar, '\\\\$&')\n        : string;\n    }\n\n    /**\n     * Converts `string` to\n     * [kebab case](https://en.wikipedia.org/wiki/Letter_case#Special_case_styles).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to convert.\n     * @returns {string} Returns the kebab cased string.\n     * @example\n     *\n     * _.kebabCase('Foo Bar');\n     * // => 'foo-bar'\n     *\n     * _.kebabCase('fooBar');\n     * // => 'foo-bar'\n     *\n     * _.kebabCase('__FOO_BAR__');\n     * // => 'foo-bar'\n     */\n    var kebabCase = createCompounder(function(result, word, index) {\n      return result + (index ? '-' : '') + word.toLowerCase();\n    });\n\n    /**\n     * Converts `string`, as space separated words, to lower case.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to convert.\n     * @returns {string} Returns the lower cased string.\n     * @example\n     *\n     * _.lowerCase('--Foo-Bar--');\n     * // => 'foo bar'\n     *\n     * _.lowerCase('fooBar');\n     * // => 'foo bar'\n     *\n     * _.lowerCase('__FOO_BAR__');\n     * // => 'foo bar'\n     */\n    var lowerCase = createCompounder(function(result, word, index) {\n      return result + (index ? ' ' : '') + word.toLowerCase();\n    });\n\n    /**\n     * Converts the first character of `string` to lower case.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to convert.\n     * @returns {string} Returns the converted string.\n     * @example\n     *\n     * _.lowerFirst('Fred');\n     * // => 'fred'\n     *\n     * _.lowerFirst('FRED');\n     * // => 'fRED'\n     */\n    var lowerFirst = createCaseFirst('toLowerCase');\n\n    /**\n     * Pads `string` on the left and right sides if it's shorter than `length`.\n     * Padding characters are truncated if they can't be evenly divided by `length`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to pad.\n     * @param {number} [length=0] The padding length.\n     * @param {string} [chars=' '] The string used as padding.\n     * @returns {string} Returns the padded string.\n     * @example\n     *\n     * _.pad('abc', 8);\n     * // => '  abc   '\n     *\n     * _.pad('abc', 8, '_-');\n     * // => '_-abc_-_'\n     *\n     * _.pad('abc', 3);\n     * // => 'abc'\n     */\n    function pad(string, length, chars) {\n      string = toString(string);\n      length = toInteger(length);\n\n      var strLength = length ? stringSize(string) : 0;\n      if (!length || strLength >= length) {\n        return string;\n      }\n      var mid = (length - strLength) / 2;\n      return (\n        createPadding(nativeFloor(mid), chars) +\n        string +\n        createPadding(nativeCeil(mid), chars)\n      );\n    }\n\n    /**\n     * Pads `string` on the right side if it's shorter than `length`. Padding\n     * characters are truncated if they exceed `length`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to pad.\n     * @param {number} [length=0] The padding length.\n     * @param {string} [chars=' '] The string used as padding.\n     * @returns {string} Returns the padded string.\n     * @example\n     *\n     * _.padEnd('abc', 6);\n     * // => 'abc   '\n     *\n     * _.padEnd('abc', 6, '_-');\n     * // => 'abc_-_'\n     *\n     * _.padEnd('abc', 3);\n     * // => 'abc'\n     */\n    function padEnd(string, length, chars) {\n      string = toString(string);\n      length = toInteger(length);\n\n      var strLength = length ? stringSize(string) : 0;\n      return (length && strLength < length)\n        ? (string + createPadding(length - strLength, chars))\n        : string;\n    }\n\n    /**\n     * Pads `string` on the left side if it's shorter than `length`. Padding\n     * characters are truncated if they exceed `length`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to pad.\n     * @param {number} [length=0] The padding length.\n     * @param {string} [chars=' '] The string used as padding.\n     * @returns {string} Returns the padded string.\n     * @example\n     *\n     * _.padStart('abc', 6);\n     * // => '   abc'\n     *\n     * _.padStart('abc', 6, '_-');\n     * // => '_-_abc'\n     *\n     * _.padStart('abc', 3);\n     * // => 'abc'\n     */\n    function padStart(string, length, chars) {\n      string = toString(string);\n      length = toInteger(length);\n\n      var strLength = length ? stringSize(string) : 0;\n      return (length && strLength < length)\n        ? (createPadding(length - strLength, chars) + string)\n        : string;\n    }\n\n    /**\n     * Converts `string` to an integer of the specified radix. If `radix` is\n     * `undefined` or `0`, a `radix` of `10` is used unless `value` is a\n     * hexadecimal, in which case a `radix` of `16` is used.\n     *\n     * **Note:** This method aligns with the\n     * [ES5 implementation](https://es5.github.io/#x15.1.2.2) of `parseInt`.\n     *\n     * @static\n     * @memberOf _\n     * @since 1.1.0\n     * @category String\n     * @param {string} string The string to convert.\n     * @param {number} [radix=10] The radix to interpret `value` by.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {number} Returns the converted integer.\n     * @example\n     *\n     * _.parseInt('08');\n     * // => 8\n     *\n     * _.map(['6', '08', '10'], _.parseInt);\n     * // => [6, 8, 10]\n     */\n    function parseInt(string, radix, guard) {\n      if (guard || radix == null) {\n        radix = 0;\n      } else if (radix) {\n        radix = +radix;\n      }\n      return nativeParseInt(toString(string).replace(reTrimStart, ''), radix || 0);\n    }\n\n    /**\n     * Repeats the given string `n` times.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to repeat.\n     * @param {number} [n=1] The number of times to repeat the string.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {string} Returns the repeated string.\n     * @example\n     *\n     * _.repeat('*', 3);\n     * // => '***'\n     *\n     * _.repeat('abc', 2);\n     * // => 'abcabc'\n     *\n     * _.repeat('abc', 0);\n     * // => ''\n     */\n    function repeat(string, n, guard) {\n      if ((guard ? isIterateeCall(string, n, guard) : n === undefined)) {\n        n = 1;\n      } else {\n        n = toInteger(n);\n      }\n      return baseRepeat(toString(string), n);\n    }\n\n    /**\n     * Replaces matches for `pattern` in `string` with `replacement`.\n     *\n     * **Note:** This method is based on\n     * [`String#replace`](https://mdn.io/String/replace).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to modify.\n     * @param {RegExp|string} pattern The pattern to replace.\n     * @param {Function|string} replacement The match replacement.\n     * @returns {string} Returns the modified string.\n     * @example\n     *\n     * _.replace('Hi Fred', 'Fred', 'Barney');\n     * // => 'Hi Barney'\n     */\n    function replace() {\n      var args = arguments,\n          string = toString(args[0]);\n\n      return args.length < 3 ? string : string.replace(args[1], args[2]);\n    }\n\n    /**\n     * Converts `string` to\n     * [snake case](https://en.wikipedia.org/wiki/Snake_case).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to convert.\n     * @returns {string} Returns the snake cased string.\n     * @example\n     *\n     * _.snakeCase('Foo Bar');\n     * // => 'foo_bar'\n     *\n     * _.snakeCase('fooBar');\n     * // => 'foo_bar'\n     *\n     * _.snakeCase('--FOO-BAR--');\n     * // => 'foo_bar'\n     */\n    var snakeCase = createCompounder(function(result, word, index) {\n      return result + (index ? '_' : '') + word.toLowerCase();\n    });\n\n    /**\n     * Splits `string` by `separator`.\n     *\n     * **Note:** This method is based on\n     * [`String#split`](https://mdn.io/String/split).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to split.\n     * @param {RegExp|string} separator The separator pattern to split by.\n     * @param {number} [limit] The length to truncate results to.\n     * @returns {Array} Returns the string segments.\n     * @example\n     *\n     * _.split('a-b-c', '-', 2);\n     * // => ['a', 'b']\n     */\n    function split(string, separator, limit) {\n      if (limit && typeof limit != 'number' && isIterateeCall(string, separator, limit)) {\n        separator = limit = undefined;\n      }\n      limit = limit === undefined ? MAX_ARRAY_LENGTH : limit >>> 0;\n      if (!limit) {\n        return [];\n      }\n      string = toString(string);\n      if (string && (\n            typeof separator == 'string' ||\n            (separator != null && !isRegExp(separator))\n          )) {\n        separator = baseToString(separator);\n        if (!separator && hasUnicode(string)) {\n          return castSlice(stringToArray(string), 0, limit);\n        }\n      }\n      return string.split(separator, limit);\n    }\n\n    /**\n     * Converts `string` to\n     * [start case](https://en.wikipedia.org/wiki/Letter_case#Stylistic_or_specialised_usage).\n     *\n     * @static\n     * @memberOf _\n     * @since 3.1.0\n     * @category String\n     * @param {string} [string=''] The string to convert.\n     * @returns {string} Returns the start cased string.\n     * @example\n     *\n     * _.startCase('--foo-bar--');\n     * // => 'Foo Bar'\n     *\n     * _.startCase('fooBar');\n     * // => 'Foo Bar'\n     *\n     * _.startCase('__FOO_BAR__');\n     * // => 'FOO BAR'\n     */\n    var startCase = createCompounder(function(result, word, index) {\n      return result + (index ? ' ' : '') + upperFirst(word);\n    });\n\n    /**\n     * Checks if `string` starts with the given target string.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to inspect.\n     * @param {string} [target] The string to search for.\n     * @param {number} [position=0] The position to search from.\n     * @returns {boolean} Returns `true` if `string` starts with `target`,\n     *  else `false`.\n     * @example\n     *\n     * _.startsWith('abc', 'a');\n     * // => true\n     *\n     * _.startsWith('abc', 'b');\n     * // => false\n     *\n     * _.startsWith('abc', 'b', 1);\n     * // => true\n     */\n    function startsWith(string, target, position) {\n      string = toString(string);\n      position = position == null\n        ? 0\n        : baseClamp(toInteger(position), 0, string.length);\n\n      target = baseToString(target);\n      return string.slice(position, position + target.length) == target;\n    }\n\n    /**\n     * Creates a compiled template function that can interpolate data properties\n     * in \"interpolate\" delimiters, HTML-escape interpolated data properties in\n     * \"escape\" delimiters, and execute JavaScript in \"evaluate\" delimiters. Data\n     * properties may be accessed as free variables in the template. If a setting\n     * object is given, it takes precedence over `_.templateSettings` values.\n     *\n     * **Note:** In the development build `_.template` utilizes\n     * [sourceURLs](http://www.html5rocks.com/en/tutorials/developertools/sourcemaps/#toc-sourceurl)\n     * for easier debugging.\n     *\n     * For more information on precompiling templates see\n     * [lodash's custom builds documentation](https://lodash.com/custom-builds).\n     *\n     * For more information on Chrome extension sandboxes see\n     * [Chrome's extensions documentation](https://developer.chrome.com/extensions/sandboxingEval).\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category String\n     * @param {string} [string=''] The template string.\n     * @param {Object} [options={}] The options object.\n     * @param {RegExp} [options.escape=_.templateSettings.escape]\n     *  The HTML \"escape\" delimiter.\n     * @param {RegExp} [options.evaluate=_.templateSettings.evaluate]\n     *  The \"evaluate\" delimiter.\n     * @param {Object} [options.imports=_.templateSettings.imports]\n     *  An object to import into the template as free variables.\n     * @param {RegExp} [options.interpolate=_.templateSettings.interpolate]\n     *  The \"interpolate\" delimiter.\n     * @param {string} [options.sourceURL='lodash.templateSources[n]']\n     *  The sourceURL of the compiled template.\n     * @param {string} [options.variable='obj']\n     *  The data object variable name.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Function} Returns the compiled template function.\n     * @example\n     *\n     * // Use the \"interpolate\" delimiter to create a compiled template.\n     * var compiled = _.template('hello <%= user %>!');\n     * compiled({ 'user': 'fred' });\n     * // => 'hello fred!'\n     *\n     * // Use the HTML \"escape\" delimiter to escape data property values.\n     * var compiled = _.template('<b><%- value %></b>');\n     * compiled({ 'value': '<script>' });\n     * // => '<b>&lt;script&gt;</b>'\n     *\n     * // Use the \"evaluate\" delimiter to execute JavaScript and generate HTML.\n     * var compiled = _.template('<% _.forEach(users, function(user) { %><li><%- user %></li><% }); %>');\n     * compiled({ 'users': ['fred', 'barney'] });\n     * // => '<li>fred</li><li>barney</li>'\n     *\n     * // Use the internal `print` function in \"evaluate\" delimiters.\n     * var compiled = _.template('<% print(\"hello \" + user); %>!');\n     * compiled({ 'user': 'barney' });\n     * // => 'hello barney!'\n     *\n     * // Use the ES template literal delimiter as an \"interpolate\" delimiter.\n     * // Disable support by replacing the \"interpolate\" delimiter.\n     * var compiled = _.template('hello ${ user }!');\n     * compiled({ 'user': 'pebbles' });\n     * // => 'hello pebbles!'\n     *\n     * // Use backslashes to treat delimiters as plain text.\n     * var compiled = _.template('<%= \"\\\\<%- value %\\\\>\" %>');\n     * compiled({ 'value': 'ignored' });\n     * // => '<%- value %>'\n     *\n     * // Use the `imports` option to import `jQuery` as `jq`.\n     * var text = '<% jq.each(users, function(user) { %><li><%- user %></li><% }); %>';\n     * var compiled = _.template(text, { 'imports': { 'jq': jQuery } });\n     * compiled({ 'users': ['fred', 'barney'] });\n     * // => '<li>fred</li><li>barney</li>'\n     *\n     * // Use the `sourceURL` option to specify a custom sourceURL for the template.\n     * var compiled = _.template('hello <%= user %>!', { 'sourceURL': '/basic/greeting.jst' });\n     * compiled(data);\n     * // => Find the source of \"greeting.jst\" under the Sources tab or Resources panel of the web inspector.\n     *\n     * // Use the `variable` option to ensure a with-statement isn't used in the compiled template.\n     * var compiled = _.template('hi <%= data.user %>!', { 'variable': 'data' });\n     * compiled.source;\n     * // => function(data) {\n     * //   var __t, __p = '';\n     * //   __p += 'hi ' + ((__t = ( data.user )) == null ? '' : __t) + '!';\n     * //   return __p;\n     * // }\n     *\n     * // Use custom template delimiters.\n     * _.templateSettings.interpolate = /{{([\\s\\S]+?)}}/g;\n     * var compiled = _.template('hello {{ user }}!');\n     * compiled({ 'user': 'mustache' });\n     * // => 'hello mustache!'\n     *\n     * // Use the `source` property to inline compiled templates for meaningful\n     * // line numbers in error messages and stack traces.\n     * fs.writeFileSync(path.join(process.cwd(), 'jst.js'), '\\\n     *   var JST = {\\\n     *     \"main\": ' + _.template(mainText).source + '\\\n     *   };\\\n     * ');\n     */\n    function template(string, options, guard) {\n      // Based on John Resig's `tmpl` implementation\n      // (http://ejohn.org/blog/javascript-micro-templating/)\n      // and Laura Doktorova's doT.js (https://github.com/olado/doT).\n      var settings = lodash.templateSettings;\n\n      if (guard && isIterateeCall(string, options, guard)) {\n        options = undefined;\n      }\n      string = toString(string);\n      options = assignInWith({}, options, settings, customDefaultsAssignIn);\n\n      var imports = assignInWith({}, options.imports, settings.imports, customDefaultsAssignIn),\n          importsKeys = keys(imports),\n          importsValues = baseValues(imports, importsKeys);\n\n      var isEscaping,\n          isEvaluating,\n          index = 0,\n          interpolate = options.interpolate || reNoMatch,\n          source = \"__p += '\";\n\n      // Compile the regexp to match each delimiter.\n      var reDelimiters = RegExp(\n        (options.escape || reNoMatch).source + '|' +\n        interpolate.source + '|' +\n        (interpolate === reInterpolate ? reEsTemplate : reNoMatch).source + '|' +\n        (options.evaluate || reNoMatch).source + '|$'\n      , 'g');\n\n      // Use a sourceURL for easier debugging.\n      var sourceURL = '//# sourceURL=' +\n        ('sourceURL' in options\n          ? options.sourceURL\n          : ('lodash.templateSources[' + (++templateCounter) + ']')\n        ) + '\\n';\n\n      string.replace(reDelimiters, function(match, escapeValue, interpolateValue, esTemplateValue, evaluateValue, offset) {\n        interpolateValue || (interpolateValue = esTemplateValue);\n\n        // Escape characters that can't be included in string literals.\n        source += string.slice(index, offset).replace(reUnescapedString, escapeStringChar);\n\n        // Replace delimiters with snippets.\n        if (escapeValue) {\n          isEscaping = true;\n          source += \"' +\\n__e(\" + escapeValue + \") +\\n'\";\n        }\n        if (evaluateValue) {\n          isEvaluating = true;\n          source += \"';\\n\" + evaluateValue + \";\\n__p += '\";\n        }\n        if (interpolateValue) {\n          source += \"' +\\n((__t = (\" + interpolateValue + \")) == null ? '' : __t) +\\n'\";\n        }\n        index = offset + match.length;\n\n        // The JS engine embedded in Adobe products needs `match` returned in\n        // order to produce the correct `offset` value.\n        return match;\n      });\n\n      source += \"';\\n\";\n\n      // If `variable` is not specified wrap a with-statement around the generated\n      // code to add the data object to the top of the scope chain.\n      var variable = options.variable;\n      if (!variable) {\n        source = 'with (obj) {\\n' + source + '\\n}\\n';\n      }\n      // Cleanup code by stripping empty strings.\n      source = (isEvaluating ? source.replace(reEmptyStringLeading, '') : source)\n        .replace(reEmptyStringMiddle, '$1')\n        .replace(reEmptyStringTrailing, '$1;');\n\n      // Frame code as the function body.\n      source = 'function(' + (variable || 'obj') + ') {\\n' +\n        (variable\n          ? ''\n          : 'obj || (obj = {});\\n'\n        ) +\n        \"var __t, __p = ''\" +\n        (isEscaping\n           ? ', __e = _.escape'\n           : ''\n        ) +\n        (isEvaluating\n          ? ', __j = Array.prototype.join;\\n' +\n            \"function print() { __p += __j.call(arguments, '') }\\n\"\n          : ';\\n'\n        ) +\n        source +\n        'return __p\\n}';\n\n      var result = attempt(function() {\n        return Function(importsKeys, sourceURL + 'return ' + source)\n          .apply(undefined, importsValues);\n      });\n\n      // Provide the compiled function's source by its `toString` method or\n      // the `source` property as a convenience for inlining compiled templates.\n      result.source = source;\n      if (isError(result)) {\n        throw result;\n      }\n      return result;\n    }\n\n    /**\n     * Converts `string`, as a whole, to lower case just like\n     * [String#toLowerCase](https://mdn.io/toLowerCase).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to convert.\n     * @returns {string} Returns the lower cased string.\n     * @example\n     *\n     * _.toLower('--Foo-Bar--');\n     * // => '--foo-bar--'\n     *\n     * _.toLower('fooBar');\n     * // => 'foobar'\n     *\n     * _.toLower('__FOO_BAR__');\n     * // => '__foo_bar__'\n     */\n    function toLower(value) {\n      return toString(value).toLowerCase();\n    }\n\n    /**\n     * Converts `string`, as a whole, to upper case just like\n     * [String#toUpperCase](https://mdn.io/toUpperCase).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to convert.\n     * @returns {string} Returns the upper cased string.\n     * @example\n     *\n     * _.toUpper('--foo-bar--');\n     * // => '--FOO-BAR--'\n     *\n     * _.toUpper('fooBar');\n     * // => 'FOOBAR'\n     *\n     * _.toUpper('__foo_bar__');\n     * // => '__FOO_BAR__'\n     */\n    function toUpper(value) {\n      return toString(value).toUpperCase();\n    }\n\n    /**\n     * Removes leading and trailing whitespace or specified characters from `string`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to trim.\n     * @param {string} [chars=whitespace] The characters to trim.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {string} Returns the trimmed string.\n     * @example\n     *\n     * _.trim('  abc  ');\n     * // => 'abc'\n     *\n     * _.trim('-_-abc-_-', '_-');\n     * // => 'abc'\n     *\n     * _.map(['  foo  ', '  bar  '], _.trim);\n     * // => ['foo', 'bar']\n     */\n    function trim(string, chars, guard) {\n      string = toString(string);\n      if (string && (guard || chars === undefined)) {\n        return string.replace(reTrim, '');\n      }\n      if (!string || !(chars = baseToString(chars))) {\n        return string;\n      }\n      var strSymbols = stringToArray(string),\n          chrSymbols = stringToArray(chars),\n          start = charsStartIndex(strSymbols, chrSymbols),\n          end = charsEndIndex(strSymbols, chrSymbols) + 1;\n\n      return castSlice(strSymbols, start, end).join('');\n    }\n\n    /**\n     * Removes trailing whitespace or specified characters from `string`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to trim.\n     * @param {string} [chars=whitespace] The characters to trim.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {string} Returns the trimmed string.\n     * @example\n     *\n     * _.trimEnd('  abc  ');\n     * // => '  abc'\n     *\n     * _.trimEnd('-_-abc-_-', '_-');\n     * // => '-_-abc'\n     */\n    function trimEnd(string, chars, guard) {\n      string = toString(string);\n      if (string && (guard || chars === undefined)) {\n        return string.replace(reTrimEnd, '');\n      }\n      if (!string || !(chars = baseToString(chars))) {\n        return string;\n      }\n      var strSymbols = stringToArray(string),\n          end = charsEndIndex(strSymbols, stringToArray(chars)) + 1;\n\n      return castSlice(strSymbols, 0, end).join('');\n    }\n\n    /**\n     * Removes leading whitespace or specified characters from `string`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to trim.\n     * @param {string} [chars=whitespace] The characters to trim.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {string} Returns the trimmed string.\n     * @example\n     *\n     * _.trimStart('  abc  ');\n     * // => 'abc  '\n     *\n     * _.trimStart('-_-abc-_-', '_-');\n     * // => 'abc-_-'\n     */\n    function trimStart(string, chars, guard) {\n      string = toString(string);\n      if (string && (guard || chars === undefined)) {\n        return string.replace(reTrimStart, '');\n      }\n      if (!string || !(chars = baseToString(chars))) {\n        return string;\n      }\n      var strSymbols = stringToArray(string),\n          start = charsStartIndex(strSymbols, stringToArray(chars));\n\n      return castSlice(strSymbols, start).join('');\n    }\n\n    /**\n     * Truncates `string` if it's longer than the given maximum string length.\n     * The last characters of the truncated string are replaced with the omission\n     * string which defaults to \"...\".\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to truncate.\n     * @param {Object} [options={}] The options object.\n     * @param {number} [options.length=30] The maximum string length.\n     * @param {string} [options.omission='...'] The string to indicate text is omitted.\n     * @param {RegExp|string} [options.separator] The separator pattern to truncate to.\n     * @returns {string} Returns the truncated string.\n     * @example\n     *\n     * _.truncate('hi-diddly-ho there, neighborino');\n     * // => 'hi-diddly-ho there, neighbo...'\n     *\n     * _.truncate('hi-diddly-ho there, neighborino', {\n     *   'length': 24,\n     *   'separator': ' '\n     * });\n     * // => 'hi-diddly-ho there,...'\n     *\n     * _.truncate('hi-diddly-ho there, neighborino', {\n     *   'length': 24,\n     *   'separator': /,? +/\n     * });\n     * // => 'hi-diddly-ho there...'\n     *\n     * _.truncate('hi-diddly-ho there, neighborino', {\n     *   'omission': ' [...]'\n     * });\n     * // => 'hi-diddly-ho there, neig [...]'\n     */\n    function truncate(string, options) {\n      var length = DEFAULT_TRUNC_LENGTH,\n          omission = DEFAULT_TRUNC_OMISSION;\n\n      if (isObject(options)) {\n        var separator = 'separator' in options ? options.separator : separator;\n        length = 'length' in options ? toInteger(options.length) : length;\n        omission = 'omission' in options ? baseToString(options.omission) : omission;\n      }\n      string = toString(string);\n\n      var strLength = string.length;\n      if (hasUnicode(string)) {\n        var strSymbols = stringToArray(string);\n        strLength = strSymbols.length;\n      }\n      if (length >= strLength) {\n        return string;\n      }\n      var end = length - stringSize(omission);\n      if (end < 1) {\n        return omission;\n      }\n      var result = strSymbols\n        ? castSlice(strSymbols, 0, end).join('')\n        : string.slice(0, end);\n\n      if (separator === undefined) {\n        return result + omission;\n      }\n      if (strSymbols) {\n        end += (result.length - end);\n      }\n      if (isRegExp(separator)) {\n        if (string.slice(end).search(separator)) {\n          var match,\n              substring = result;\n\n          if (!separator.global) {\n            separator = RegExp(separator.source, toString(reFlags.exec(separator)) + 'g');\n          }\n          separator.lastIndex = 0;\n          while ((match = separator.exec(substring))) {\n            var newEnd = match.index;\n          }\n          result = result.slice(0, newEnd === undefined ? end : newEnd);\n        }\n      } else if (string.indexOf(baseToString(separator), end) != end) {\n        var index = result.lastIndexOf(separator);\n        if (index > -1) {\n          result = result.slice(0, index);\n        }\n      }\n      return result + omission;\n    }\n\n    /**\n     * The inverse of `_.escape`; this method converts the HTML entities\n     * `&amp;`, `&lt;`, `&gt;`, `&quot;`, and `&#39;` in `string` to\n     * their corresponding characters.\n     *\n     * **Note:** No other HTML entities are unescaped. To unescape additional\n     * HTML entities use a third-party library like [_he_](https://mths.be/he).\n     *\n     * @static\n     * @memberOf _\n     * @since 0.6.0\n     * @category String\n     * @param {string} [string=''] The string to unescape.\n     * @returns {string} Returns the unescaped string.\n     * @example\n     *\n     * _.unescape('fred, barney, &amp; pebbles');\n     * // => 'fred, barney, & pebbles'\n     */\n    function unescape(string) {\n      string = toString(string);\n      return (string && reHasEscapedHtml.test(string))\n        ? string.replace(reEscapedHtml, unescapeHtmlChar)\n        : string;\n    }\n\n    /**\n     * Converts `string`, as space separated words, to upper case.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to convert.\n     * @returns {string} Returns the upper cased string.\n     * @example\n     *\n     * _.upperCase('--foo-bar');\n     * // => 'FOO BAR'\n     *\n     * _.upperCase('fooBar');\n     * // => 'FOO BAR'\n     *\n     * _.upperCase('__foo_bar__');\n     * // => 'FOO BAR'\n     */\n    var upperCase = createCompounder(function(result, word, index) {\n      return result + (index ? ' ' : '') + word.toUpperCase();\n    });\n\n    /**\n     * Converts the first character of `string` to upper case.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category String\n     * @param {string} [string=''] The string to convert.\n     * @returns {string} Returns the converted string.\n     * @example\n     *\n     * _.upperFirst('fred');\n     * // => 'Fred'\n     *\n     * _.upperFirst('FRED');\n     * // => 'FRED'\n     */\n    var upperFirst = createCaseFirst('toUpperCase');\n\n    /**\n     * Splits `string` into an array of its words.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category String\n     * @param {string} [string=''] The string to inspect.\n     * @param {RegExp|string} [pattern] The pattern to match words.\n     * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n     * @returns {Array} Returns the words of `string`.\n     * @example\n     *\n     * _.words('fred, barney, & pebbles');\n     * // => ['fred', 'barney', 'pebbles']\n     *\n     * _.words('fred, barney, & pebbles', /[^, ]+/g);\n     * // => ['fred', 'barney', '&', 'pebbles']\n     */\n    function words(string, pattern, guard) {\n      string = toString(string);\n      pattern = guard ? undefined : pattern;\n\n      if (pattern === undefined) {\n        return hasUnicodeWord(string) ? unicodeWords(string) : asciiWords(string);\n      }\n      return string.match(pattern) || [];\n    }\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Attempts to invoke `func`, returning either the result or the caught error\n     * object. Any additional arguments are provided to `func` when it's invoked.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Util\n     * @param {Function} func The function to attempt.\n     * @param {...*} [args] The arguments to invoke `func` with.\n     * @returns {*} Returns the `func` result or error object.\n     * @example\n     *\n     * // Avoid throwing errors for invalid selectors.\n     * var elements = _.attempt(function(selector) {\n     *   return document.querySelectorAll(selector);\n     * }, '>_>');\n     *\n     * if (_.isError(elements)) {\n     *   elements = [];\n     * }\n     */\n    var attempt = baseRest(function(func, args) {\n      try {\n        return apply(func, undefined, args);\n      } catch (e) {\n        return isError(e) ? e : new Error(e);\n      }\n    });\n\n    /**\n     * Binds methods of an object to the object itself, overwriting the existing\n     * method.\n     *\n     * **Note:** This method doesn't set the \"length\" property of bound functions.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Util\n     * @param {Object} object The object to bind and assign the bound methods to.\n     * @param {...(string|string[])} methodNames The object method names to bind.\n     * @returns {Object} Returns `object`.\n     * @example\n     *\n     * var view = {\n     *   'label': 'docs',\n     *   'click': function() {\n     *     console.log('clicked ' + this.label);\n     *   }\n     * };\n     *\n     * _.bindAll(view, ['click']);\n     * jQuery(element).on('click', view.click);\n     * // => Logs 'clicked docs' when clicked.\n     */\n    var bindAll = flatRest(function(object, methodNames) {\n      arrayEach(methodNames, function(key) {\n        key = toKey(key);\n        baseAssignValue(object, key, bind(object[key], object));\n      });\n      return object;\n    });\n\n    /**\n     * Creates a function that iterates over `pairs` and invokes the corresponding\n     * function of the first predicate to return truthy. The predicate-function\n     * pairs are invoked with the `this` binding and arguments of the created\n     * function.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Util\n     * @param {Array} pairs The predicate-function pairs.\n     * @returns {Function} Returns the new composite function.\n     * @example\n     *\n     * var func = _.cond([\n     *   [_.matches({ 'a': 1 }),           _.constant('matches A')],\n     *   [_.conforms({ 'b': _.isNumber }), _.constant('matches B')],\n     *   [_.stubTrue,                      _.constant('no match')]\n     * ]);\n     *\n     * func({ 'a': 1, 'b': 2 });\n     * // => 'matches A'\n     *\n     * func({ 'a': 0, 'b': 1 });\n     * // => 'matches B'\n     *\n     * func({ 'a': '1', 'b': '2' });\n     * // => 'no match'\n     */\n    function cond(pairs) {\n      var length = pairs == null ? 0 : pairs.length,\n          toIteratee = getIteratee();\n\n      pairs = !length ? [] : arrayMap(pairs, function(pair) {\n        if (typeof pair[1] != 'function') {\n          throw new TypeError(FUNC_ERROR_TEXT);\n        }\n        return [toIteratee(pair[0]), pair[1]];\n      });\n\n      return baseRest(function(args) {\n        var index = -1;\n        while (++index < length) {\n          var pair = pairs[index];\n          if (apply(pair[0], this, args)) {\n            return apply(pair[1], this, args);\n          }\n        }\n      });\n    }\n\n    /**\n     * Creates a function that invokes the predicate properties of `source` with\n     * the corresponding property values of a given object, returning `true` if\n     * all predicates return truthy, else `false`.\n     *\n     * **Note:** The created function is equivalent to `_.conformsTo` with\n     * `source` partially applied.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Util\n     * @param {Object} source The object of property predicates to conform to.\n     * @returns {Function} Returns the new spec function.\n     * @example\n     *\n     * var objects = [\n     *   { 'a': 2, 'b': 1 },\n     *   { 'a': 1, 'b': 2 }\n     * ];\n     *\n     * _.filter(objects, _.conforms({ 'b': function(n) { return n > 1; } }));\n     * // => [{ 'a': 1, 'b': 2 }]\n     */\n    function conforms(source) {\n      return baseConforms(baseClone(source, CLONE_DEEP_FLAG));\n    }\n\n    /**\n     * Creates a function that returns `value`.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.4.0\n     * @category Util\n     * @param {*} value The value to return from the new function.\n     * @returns {Function} Returns the new constant function.\n     * @example\n     *\n     * var objects = _.times(2, _.constant({ 'a': 1 }));\n     *\n     * console.log(objects);\n     * // => [{ 'a': 1 }, { 'a': 1 }]\n     *\n     * console.log(objects[0] === objects[1]);\n     * // => true\n     */\n    function constant(value) {\n      return function() {\n        return value;\n      };\n    }\n\n    /**\n     * Checks `value` to determine whether a default value should be returned in\n     * its place. The `defaultValue` is returned if `value` is `NaN`, `null`,\n     * or `undefined`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.14.0\n     * @category Util\n     * @param {*} value The value to check.\n     * @param {*} defaultValue The default value.\n     * @returns {*} Returns the resolved value.\n     * @example\n     *\n     * _.defaultTo(1, 10);\n     * // => 1\n     *\n     * _.defaultTo(undefined, 10);\n     * // => 10\n     */\n    function defaultTo(value, defaultValue) {\n      return (value == null || value !== value) ? defaultValue : value;\n    }\n\n    /**\n     * Creates a function that returns the result of invoking the given functions\n     * with the `this` binding of the created function, where each successive\n     * invocation is supplied the return value of the previous.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Util\n     * @param {...(Function|Function[])} [funcs] The functions to invoke.\n     * @returns {Function} Returns the new composite function.\n     * @see _.flowRight\n     * @example\n     *\n     * function square(n) {\n     *   return n * n;\n     * }\n     *\n     * var addSquare = _.flow([_.add, square]);\n     * addSquare(1, 2);\n     * // => 9\n     */\n    var flow = createFlow();\n\n    /**\n     * This method is like `_.flow` except that it creates a function that\n     * invokes the given functions from right to left.\n     *\n     * @static\n     * @since 3.0.0\n     * @memberOf _\n     * @category Util\n     * @param {...(Function|Function[])} [funcs] The functions to invoke.\n     * @returns {Function} Returns the new composite function.\n     * @see _.flow\n     * @example\n     *\n     * function square(n) {\n     *   return n * n;\n     * }\n     *\n     * var addSquare = _.flowRight([square, _.add]);\n     * addSquare(1, 2);\n     * // => 9\n     */\n    var flowRight = createFlow(true);\n\n    /**\n     * This method returns the first argument it receives.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Util\n     * @param {*} value Any value.\n     * @returns {*} Returns `value`.\n     * @example\n     *\n     * var object = { 'a': 1 };\n     *\n     * console.log(_.identity(object) === object);\n     * // => true\n     */\n    function identity(value) {\n      return value;\n    }\n\n    /**\n     * Creates a function that invokes `func` with the arguments of the created\n     * function. If `func` is a property name, the created function returns the\n     * property value for a given element. If `func` is an array or object, the\n     * created function returns `true` for elements that contain the equivalent\n     * source properties, otherwise it returns `false`.\n     *\n     * @static\n     * @since 4.0.0\n     * @memberOf _\n     * @category Util\n     * @param {*} [func=_.identity] The value to convert to a callback.\n     * @returns {Function} Returns the callback.\n     * @example\n     *\n     * var users = [\n     *   { 'user': 'barney', 'age': 36, 'active': true },\n     *   { 'user': 'fred',   'age': 40, 'active': false }\n     * ];\n     *\n     * // The `_.matches` iteratee shorthand.\n     * _.filter(users, _.iteratee({ 'user': 'barney', 'active': true }));\n     * // => [{ 'user': 'barney', 'age': 36, 'active': true }]\n     *\n     * // The `_.matchesProperty` iteratee shorthand.\n     * _.filter(users, _.iteratee(['user', 'fred']));\n     * // => [{ 'user': 'fred', 'age': 40 }]\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.map(users, _.iteratee('user'));\n     * // => ['barney', 'fred']\n     *\n     * // Create custom iteratee shorthands.\n     * _.iteratee = _.wrap(_.iteratee, function(iteratee, func) {\n     *   return !_.isRegExp(func) ? iteratee(func) : function(string) {\n     *     return func.test(string);\n     *   };\n     * });\n     *\n     * _.filter(['abc', 'def'], /ef/);\n     * // => ['def']\n     */\n    function iteratee(func) {\n      return baseIteratee(typeof func == 'function' ? func : baseClone(func, CLONE_DEEP_FLAG));\n    }\n\n    /**\n     * Creates a function that performs a partial deep comparison between a given\n     * object and `source`, returning `true` if the given object has equivalent\n     * property values, else `false`.\n     *\n     * **Note:** The created function is equivalent to `_.isMatch` with `source`\n     * partially applied.\n     *\n     * Partial comparisons will match empty array and empty object `source`\n     * values against any array or object value, respectively. See `_.isEqual`\n     * for a list of supported value comparisons.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Util\n     * @param {Object} source The object of property values to match.\n     * @returns {Function} Returns the new spec function.\n     * @example\n     *\n     * var objects = [\n     *   { 'a': 1, 'b': 2, 'c': 3 },\n     *   { 'a': 4, 'b': 5, 'c': 6 }\n     * ];\n     *\n     * _.filter(objects, _.matches({ 'a': 4, 'c': 6 }));\n     * // => [{ 'a': 4, 'b': 5, 'c': 6 }]\n     */\n    function matches(source) {\n      return baseMatches(baseClone(source, CLONE_DEEP_FLAG));\n    }\n\n    /**\n     * Creates a function that performs a partial deep comparison between the\n     * value at `path` of a given object to `srcValue`, returning `true` if the\n     * object value is equivalent, else `false`.\n     *\n     * **Note:** Partial comparisons will match empty array and empty object\n     * `srcValue` values against any array or object value, respectively. See\n     * `_.isEqual` for a list of supported value comparisons.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.2.0\n     * @category Util\n     * @param {Array|string} path The path of the property to get.\n     * @param {*} srcValue The value to match.\n     * @returns {Function} Returns the new spec function.\n     * @example\n     *\n     * var objects = [\n     *   { 'a': 1, 'b': 2, 'c': 3 },\n     *   { 'a': 4, 'b': 5, 'c': 6 }\n     * ];\n     *\n     * _.find(objects, _.matchesProperty('a', 4));\n     * // => { 'a': 4, 'b': 5, 'c': 6 }\n     */\n    function matchesProperty(path, srcValue) {\n      return baseMatchesProperty(path, baseClone(srcValue, CLONE_DEEP_FLAG));\n    }\n\n    /**\n     * Creates a function that invokes the method at `path` of a given object.\n     * Any additional arguments are provided to the invoked method.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.7.0\n     * @category Util\n     * @param {Array|string} path The path of the method to invoke.\n     * @param {...*} [args] The arguments to invoke the method with.\n     * @returns {Function} Returns the new invoker function.\n     * @example\n     *\n     * var objects = [\n     *   { 'a': { 'b': _.constant(2) } },\n     *   { 'a': { 'b': _.constant(1) } }\n     * ];\n     *\n     * _.map(objects, _.method('a.b'));\n     * // => [2, 1]\n     *\n     * _.map(objects, _.method(['a', 'b']));\n     * // => [2, 1]\n     */\n    var method = baseRest(function(path, args) {\n      return function(object) {\n        return baseInvoke(object, path, args);\n      };\n    });\n\n    /**\n     * The opposite of `_.method`; this method creates a function that invokes\n     * the method at a given path of `object`. Any additional arguments are\n     * provided to the invoked method.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.7.0\n     * @category Util\n     * @param {Object} object The object to query.\n     * @param {...*} [args] The arguments to invoke the method with.\n     * @returns {Function} Returns the new invoker function.\n     * @example\n     *\n     * var array = _.times(3, _.constant),\n     *     object = { 'a': array, 'b': array, 'c': array };\n     *\n     * _.map(['a[2]', 'c[0]'], _.methodOf(object));\n     * // => [2, 0]\n     *\n     * _.map([['a', '2'], ['c', '0']], _.methodOf(object));\n     * // => [2, 0]\n     */\n    var methodOf = baseRest(function(object, args) {\n      return function(path) {\n        return baseInvoke(object, path, args);\n      };\n    });\n\n    /**\n     * Adds all own enumerable string keyed function properties of a source\n     * object to the destination object. If `object` is a function, then methods\n     * are added to its prototype as well.\n     *\n     * **Note:** Use `_.runInContext` to create a pristine `lodash` function to\n     * avoid conflicts caused by modifying the original.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Util\n     * @param {Function|Object} [object=lodash] The destination object.\n     * @param {Object} source The object of functions to add.\n     * @param {Object} [options={}] The options object.\n     * @param {boolean} [options.chain=true] Specify whether mixins are chainable.\n     * @returns {Function|Object} Returns `object`.\n     * @example\n     *\n     * function vowels(string) {\n     *   return _.filter(string, function(v) {\n     *     return /[aeiou]/i.test(v);\n     *   });\n     * }\n     *\n     * _.mixin({ 'vowels': vowels });\n     * _.vowels('fred');\n     * // => ['e']\n     *\n     * _('fred').vowels().value();\n     * // => ['e']\n     *\n     * _.mixin({ 'vowels': vowels }, { 'chain': false });\n     * _('fred').vowels();\n     * // => ['e']\n     */\n    function mixin(object, source, options) {\n      var props = keys(source),\n          methodNames = baseFunctions(source, props);\n\n      if (options == null &&\n          !(isObject(source) && (methodNames.length || !props.length))) {\n        options = source;\n        source = object;\n        object = this;\n        methodNames = baseFunctions(source, keys(source));\n      }\n      var chain = !(isObject(options) && 'chain' in options) || !!options.chain,\n          isFunc = isFunction(object);\n\n      arrayEach(methodNames, function(methodName) {\n        var func = source[methodName];\n        object[methodName] = func;\n        if (isFunc) {\n          object.prototype[methodName] = function() {\n            var chainAll = this.__chain__;\n            if (chain || chainAll) {\n              var result = object(this.__wrapped__),\n                  actions = result.__actions__ = copyArray(this.__actions__);\n\n              actions.push({ 'func': func, 'args': arguments, 'thisArg': object });\n              result.__chain__ = chainAll;\n              return result;\n            }\n            return func.apply(object, arrayPush([this.value()], arguments));\n          };\n        }\n      });\n\n      return object;\n    }\n\n    /**\n     * Reverts the `_` variable to its previous value and returns a reference to\n     * the `lodash` function.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Util\n     * @returns {Function} Returns the `lodash` function.\n     * @example\n     *\n     * var lodash = _.noConflict();\n     */\n    function noConflict() {\n      if (root._ === this) {\n        root._ = oldDash;\n      }\n      return this;\n    }\n\n    /**\n     * This method returns `undefined`.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.3.0\n     * @category Util\n     * @example\n     *\n     * _.times(2, _.noop);\n     * // => [undefined, undefined]\n     */\n    function noop() {\n      // No operation performed.\n    }\n\n    /**\n     * Creates a function that gets the argument at index `n`. If `n` is negative,\n     * the nth argument from the end is returned.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Util\n     * @param {number} [n=0] The index of the argument to return.\n     * @returns {Function} Returns the new pass-thru function.\n     * @example\n     *\n     * var func = _.nthArg(1);\n     * func('a', 'b', 'c', 'd');\n     * // => 'b'\n     *\n     * var func = _.nthArg(-2);\n     * func('a', 'b', 'c', 'd');\n     * // => 'c'\n     */\n    function nthArg(n) {\n      n = toInteger(n);\n      return baseRest(function(args) {\n        return baseNth(args, n);\n      });\n    }\n\n    /**\n     * Creates a function that invokes `iteratees` with the arguments it receives\n     * and returns their results.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Util\n     * @param {...(Function|Function[])} [iteratees=[_.identity]]\n     *  The iteratees to invoke.\n     * @returns {Function} Returns the new function.\n     * @example\n     *\n     * var func = _.over([Math.max, Math.min]);\n     *\n     * func(1, 2, 3, 4);\n     * // => [4, 1]\n     */\n    var over = createOver(arrayMap);\n\n    /**\n     * Creates a function that checks if **all** of the `predicates` return\n     * truthy when invoked with the arguments it receives.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Util\n     * @param {...(Function|Function[])} [predicates=[_.identity]]\n     *  The predicates to check.\n     * @returns {Function} Returns the new function.\n     * @example\n     *\n     * var func = _.overEvery([Boolean, isFinite]);\n     *\n     * func('1');\n     * // => true\n     *\n     * func(null);\n     * // => false\n     *\n     * func(NaN);\n     * // => false\n     */\n    var overEvery = createOver(arrayEvery);\n\n    /**\n     * Creates a function that checks if **any** of the `predicates` return\n     * truthy when invoked with the arguments it receives.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Util\n     * @param {...(Function|Function[])} [predicates=[_.identity]]\n     *  The predicates to check.\n     * @returns {Function} Returns the new function.\n     * @example\n     *\n     * var func = _.overSome([Boolean, isFinite]);\n     *\n     * func('1');\n     * // => true\n     *\n     * func(null);\n     * // => true\n     *\n     * func(NaN);\n     * // => false\n     */\n    var overSome = createOver(arraySome);\n\n    /**\n     * Creates a function that returns the value at `path` of a given object.\n     *\n     * @static\n     * @memberOf _\n     * @since 2.4.0\n     * @category Util\n     * @param {Array|string} path The path of the property to get.\n     * @returns {Function} Returns the new accessor function.\n     * @example\n     *\n     * var objects = [\n     *   { 'a': { 'b': 2 } },\n     *   { 'a': { 'b': 1 } }\n     * ];\n     *\n     * _.map(objects, _.property('a.b'));\n     * // => [2, 1]\n     *\n     * _.map(_.sortBy(objects, _.property(['a', 'b'])), 'a.b');\n     * // => [1, 2]\n     */\n    function property(path) {\n      return isKey(path) ? baseProperty(toKey(path)) : basePropertyDeep(path);\n    }\n\n    /**\n     * The opposite of `_.property`; this method creates a function that returns\n     * the value at a given path of `object`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.0.0\n     * @category Util\n     * @param {Object} object The object to query.\n     * @returns {Function} Returns the new accessor function.\n     * @example\n     *\n     * var array = [0, 1, 2],\n     *     object = { 'a': array, 'b': array, 'c': array };\n     *\n     * _.map(['a[2]', 'c[0]'], _.propertyOf(object));\n     * // => [2, 0]\n     *\n     * _.map([['a', '2'], ['c', '0']], _.propertyOf(object));\n     * // => [2, 0]\n     */\n    function propertyOf(object) {\n      return function(path) {\n        return object == null ? undefined : baseGet(object, path);\n      };\n    }\n\n    /**\n     * Creates an array of numbers (positive and/or negative) progressing from\n     * `start` up to, but not including, `end`. A step of `-1` is used if a negative\n     * `start` is specified without an `end` or `step`. If `end` is not specified,\n     * it's set to `start` with `start` then set to `0`.\n     *\n     * **Note:** JavaScript follows the IEEE-754 standard for resolving\n     * floating-point values which can produce unexpected results.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Util\n     * @param {number} [start=0] The start of the range.\n     * @param {number} end The end of the range.\n     * @param {number} [step=1] The value to increment or decrement by.\n     * @returns {Array} Returns the range of numbers.\n     * @see _.inRange, _.rangeRight\n     * @example\n     *\n     * _.range(4);\n     * // => [0, 1, 2, 3]\n     *\n     * _.range(-4);\n     * // => [0, -1, -2, -3]\n     *\n     * _.range(1, 5);\n     * // => [1, 2, 3, 4]\n     *\n     * _.range(0, 20, 5);\n     * // => [0, 5, 10, 15]\n     *\n     * _.range(0, -4, -1);\n     * // => [0, -1, -2, -3]\n     *\n     * _.range(1, 4, 0);\n     * // => [1, 1, 1]\n     *\n     * _.range(0);\n     * // => []\n     */\n    var range = createRange();\n\n    /**\n     * This method is like `_.range` except that it populates values in\n     * descending order.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Util\n     * @param {number} [start=0] The start of the range.\n     * @param {number} end The end of the range.\n     * @param {number} [step=1] The value to increment or decrement by.\n     * @returns {Array} Returns the range of numbers.\n     * @see _.inRange, _.range\n     * @example\n     *\n     * _.rangeRight(4);\n     * // => [3, 2, 1, 0]\n     *\n     * _.rangeRight(-4);\n     * // => [-3, -2, -1, 0]\n     *\n     * _.rangeRight(1, 5);\n     * // => [4, 3, 2, 1]\n     *\n     * _.rangeRight(0, 20, 5);\n     * // => [15, 10, 5, 0]\n     *\n     * _.rangeRight(0, -4, -1);\n     * // => [-3, -2, -1, 0]\n     *\n     * _.rangeRight(1, 4, 0);\n     * // => [1, 1, 1]\n     *\n     * _.rangeRight(0);\n     * // => []\n     */\n    var rangeRight = createRange(true);\n\n    /**\n     * This method returns a new empty array.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.13.0\n     * @category Util\n     * @returns {Array} Returns the new empty array.\n     * @example\n     *\n     * var arrays = _.times(2, _.stubArray);\n     *\n     * console.log(arrays);\n     * // => [[], []]\n     *\n     * console.log(arrays[0] === arrays[1]);\n     * // => false\n     */\n    function stubArray() {\n      return [];\n    }\n\n    /**\n     * This method returns `false`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.13.0\n     * @category Util\n     * @returns {boolean} Returns `false`.\n     * @example\n     *\n     * _.times(2, _.stubFalse);\n     * // => [false, false]\n     */\n    function stubFalse() {\n      return false;\n    }\n\n    /**\n     * This method returns a new empty object.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.13.0\n     * @category Util\n     * @returns {Object} Returns the new empty object.\n     * @example\n     *\n     * var objects = _.times(2, _.stubObject);\n     *\n     * console.log(objects);\n     * // => [{}, {}]\n     *\n     * console.log(objects[0] === objects[1]);\n     * // => false\n     */\n    function stubObject() {\n      return {};\n    }\n\n    /**\n     * This method returns an empty string.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.13.0\n     * @category Util\n     * @returns {string} Returns the empty string.\n     * @example\n     *\n     * _.times(2, _.stubString);\n     * // => ['', '']\n     */\n    function stubString() {\n      return '';\n    }\n\n    /**\n     * This method returns `true`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.13.0\n     * @category Util\n     * @returns {boolean} Returns `true`.\n     * @example\n     *\n     * _.times(2, _.stubTrue);\n     * // => [true, true]\n     */\n    function stubTrue() {\n      return true;\n    }\n\n    /**\n     * Invokes the iteratee `n` times, returning an array of the results of\n     * each invocation. The iteratee is invoked with one argument; (index).\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Util\n     * @param {number} n The number of times to invoke `iteratee`.\n     * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n     * @returns {Array} Returns the array of results.\n     * @example\n     *\n     * _.times(3, String);\n     * // => ['0', '1', '2']\n     *\n     *  _.times(4, _.constant(0));\n     * // => [0, 0, 0, 0]\n     */\n    function times(n, iteratee) {\n      n = toInteger(n);\n      if (n < 1 || n > MAX_SAFE_INTEGER) {\n        return [];\n      }\n      var index = MAX_ARRAY_LENGTH,\n          length = nativeMin(n, MAX_ARRAY_LENGTH);\n\n      iteratee = getIteratee(iteratee);\n      n -= MAX_ARRAY_LENGTH;\n\n      var result = baseTimes(length, iteratee);\n      while (++index < n) {\n        iteratee(index);\n      }\n      return result;\n    }\n\n    /**\n     * Converts `value` to a property path array.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Util\n     * @param {*} value The value to convert.\n     * @returns {Array} Returns the new property path array.\n     * @example\n     *\n     * _.toPath('a.b.c');\n     * // => ['a', 'b', 'c']\n     *\n     * _.toPath('a[0].b.c');\n     * // => ['a', '0', 'b', 'c']\n     */\n    function toPath(value) {\n      if (isArray(value)) {\n        return arrayMap(value, toKey);\n      }\n      return isSymbol(value) ? [value] : copyArray(stringToPath(toString(value)));\n    }\n\n    /**\n     * Generates a unique ID. If `prefix` is given, the ID is appended to it.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Util\n     * @param {string} [prefix=''] The value to prefix the ID with.\n     * @returns {string} Returns the unique ID.\n     * @example\n     *\n     * _.uniqueId('contact_');\n     * // => 'contact_104'\n     *\n     * _.uniqueId();\n     * // => '105'\n     */\n    function uniqueId(prefix) {\n      var id = ++idCounter;\n      return toString(prefix) + id;\n    }\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Adds two numbers.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.4.0\n     * @category Math\n     * @param {number} augend The first number in an addition.\n     * @param {number} addend The second number in an addition.\n     * @returns {number} Returns the total.\n     * @example\n     *\n     * _.add(6, 4);\n     * // => 10\n     */\n    var add = createMathOperation(function(augend, addend) {\n      return augend + addend;\n    }, 0);\n\n    /**\n     * Computes `number` rounded up to `precision`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.10.0\n     * @category Math\n     * @param {number} number The number to round up.\n     * @param {number} [precision=0] The precision to round up to.\n     * @returns {number} Returns the rounded up number.\n     * @example\n     *\n     * _.ceil(4.006);\n     * // => 5\n     *\n     * _.ceil(6.004, 2);\n     * // => 6.01\n     *\n     * _.ceil(6040, -2);\n     * // => 6100\n     */\n    var ceil = createRound('ceil');\n\n    /**\n     * Divide two numbers.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.7.0\n     * @category Math\n     * @param {number} dividend The first number in a division.\n     * @param {number} divisor The second number in a division.\n     * @returns {number} Returns the quotient.\n     * @example\n     *\n     * _.divide(6, 4);\n     * // => 1.5\n     */\n    var divide = createMathOperation(function(dividend, divisor) {\n      return dividend / divisor;\n    }, 1);\n\n    /**\n     * Computes `number` rounded down to `precision`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.10.0\n     * @category Math\n     * @param {number} number The number to round down.\n     * @param {number} [precision=0] The precision to round down to.\n     * @returns {number} Returns the rounded down number.\n     * @example\n     *\n     * _.floor(4.006);\n     * // => 4\n     *\n     * _.floor(0.046, 2);\n     * // => 0.04\n     *\n     * _.floor(4060, -2);\n     * // => 4000\n     */\n    var floor = createRound('floor');\n\n    /**\n     * Computes the maximum value of `array`. If `array` is empty or falsey,\n     * `undefined` is returned.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Math\n     * @param {Array} array The array to iterate over.\n     * @returns {*} Returns the maximum value.\n     * @example\n     *\n     * _.max([4, 2, 8, 6]);\n     * // => 8\n     *\n     * _.max([]);\n     * // => undefined\n     */\n    function max(array) {\n      return (array && array.length)\n        ? baseExtremum(array, identity, baseGt)\n        : undefined;\n    }\n\n    /**\n     * This method is like `_.max` except that it accepts `iteratee` which is\n     * invoked for each element in `array` to generate the criterion by which\n     * the value is ranked. The iteratee is invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Math\n     * @param {Array} array The array to iterate over.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {*} Returns the maximum value.\n     * @example\n     *\n     * var objects = [{ 'n': 1 }, { 'n': 2 }];\n     *\n     * _.maxBy(objects, function(o) { return o.n; });\n     * // => { 'n': 2 }\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.maxBy(objects, 'n');\n     * // => { 'n': 2 }\n     */\n    function maxBy(array, iteratee) {\n      return (array && array.length)\n        ? baseExtremum(array, getIteratee(iteratee, 2), baseGt)\n        : undefined;\n    }\n\n    /**\n     * Computes the mean of the values in `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Math\n     * @param {Array} array The array to iterate over.\n     * @returns {number} Returns the mean.\n     * @example\n     *\n     * _.mean([4, 2, 8, 6]);\n     * // => 5\n     */\n    function mean(array) {\n      return baseMean(array, identity);\n    }\n\n    /**\n     * This method is like `_.mean` except that it accepts `iteratee` which is\n     * invoked for each element in `array` to generate the value to be averaged.\n     * The iteratee is invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.7.0\n     * @category Math\n     * @param {Array} array The array to iterate over.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {number} Returns the mean.\n     * @example\n     *\n     * var objects = [{ 'n': 4 }, { 'n': 2 }, { 'n': 8 }, { 'n': 6 }];\n     *\n     * _.meanBy(objects, function(o) { return o.n; });\n     * // => 5\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.meanBy(objects, 'n');\n     * // => 5\n     */\n    function meanBy(array, iteratee) {\n      return baseMean(array, getIteratee(iteratee, 2));\n    }\n\n    /**\n     * Computes the minimum value of `array`. If `array` is empty or falsey,\n     * `undefined` is returned.\n     *\n     * @static\n     * @since 0.1.0\n     * @memberOf _\n     * @category Math\n     * @param {Array} array The array to iterate over.\n     * @returns {*} Returns the minimum value.\n     * @example\n     *\n     * _.min([4, 2, 8, 6]);\n     * // => 2\n     *\n     * _.min([]);\n     * // => undefined\n     */\n    function min(array) {\n      return (array && array.length)\n        ? baseExtremum(array, identity, baseLt)\n        : undefined;\n    }\n\n    /**\n     * This method is like `_.min` except that it accepts `iteratee` which is\n     * invoked for each element in `array` to generate the criterion by which\n     * the value is ranked. The iteratee is invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Math\n     * @param {Array} array The array to iterate over.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {*} Returns the minimum value.\n     * @example\n     *\n     * var objects = [{ 'n': 1 }, { 'n': 2 }];\n     *\n     * _.minBy(objects, function(o) { return o.n; });\n     * // => { 'n': 1 }\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.minBy(objects, 'n');\n     * // => { 'n': 1 }\n     */\n    function minBy(array, iteratee) {\n      return (array && array.length)\n        ? baseExtremum(array, getIteratee(iteratee, 2), baseLt)\n        : undefined;\n    }\n\n    /**\n     * Multiply two numbers.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.7.0\n     * @category Math\n     * @param {number} multiplier The first number in a multiplication.\n     * @param {number} multiplicand The second number in a multiplication.\n     * @returns {number} Returns the product.\n     * @example\n     *\n     * _.multiply(6, 4);\n     * // => 24\n     */\n    var multiply = createMathOperation(function(multiplier, multiplicand) {\n      return multiplier * multiplicand;\n    }, 1);\n\n    /**\n     * Computes `number` rounded to `precision`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.10.0\n     * @category Math\n     * @param {number} number The number to round.\n     * @param {number} [precision=0] The precision to round to.\n     * @returns {number} Returns the rounded number.\n     * @example\n     *\n     * _.round(4.006);\n     * // => 4\n     *\n     * _.round(4.006, 2);\n     * // => 4.01\n     *\n     * _.round(4060, -2);\n     * // => 4100\n     */\n    var round = createRound('round');\n\n    /**\n     * Subtract two numbers.\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Math\n     * @param {number} minuend The first number in a subtraction.\n     * @param {number} subtrahend The second number in a subtraction.\n     * @returns {number} Returns the difference.\n     * @example\n     *\n     * _.subtract(6, 4);\n     * // => 2\n     */\n    var subtract = createMathOperation(function(minuend, subtrahend) {\n      return minuend - subtrahend;\n    }, 0);\n\n    /**\n     * Computes the sum of the values in `array`.\n     *\n     * @static\n     * @memberOf _\n     * @since 3.4.0\n     * @category Math\n     * @param {Array} array The array to iterate over.\n     * @returns {number} Returns the sum.\n     * @example\n     *\n     * _.sum([4, 2, 8, 6]);\n     * // => 20\n     */\n    function sum(array) {\n      return (array && array.length)\n        ? baseSum(array, identity)\n        : 0;\n    }\n\n    /**\n     * This method is like `_.sum` except that it accepts `iteratee` which is\n     * invoked for each element in `array` to generate the value to be summed.\n     * The iteratee is invoked with one argument: (value).\n     *\n     * @static\n     * @memberOf _\n     * @since 4.0.0\n     * @category Math\n     * @param {Array} array The array to iterate over.\n     * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n     * @returns {number} Returns the sum.\n     * @example\n     *\n     * var objects = [{ 'n': 4 }, { 'n': 2 }, { 'n': 8 }, { 'n': 6 }];\n     *\n     * _.sumBy(objects, function(o) { return o.n; });\n     * // => 20\n     *\n     * // The `_.property` iteratee shorthand.\n     * _.sumBy(objects, 'n');\n     * // => 20\n     */\n    function sumBy(array, iteratee) {\n      return (array && array.length)\n        ? baseSum(array, getIteratee(iteratee, 2))\n        : 0;\n    }\n\n    /*------------------------------------------------------------------------*/\n\n    // Add methods that return wrapped values in chain sequences.\n    lodash.after = after;\n    lodash.ary = ary;\n    lodash.assign = assign;\n    lodash.assignIn = assignIn;\n    lodash.assignInWith = assignInWith;\n    lodash.assignWith = assignWith;\n    lodash.at = at;\n    lodash.before = before;\n    lodash.bind = bind;\n    lodash.bindAll = bindAll;\n    lodash.bindKey = bindKey;\n    lodash.castArray = castArray;\n    lodash.chain = chain;\n    lodash.chunk = chunk;\n    lodash.compact = compact;\n    lodash.concat = concat;\n    lodash.cond = cond;\n    lodash.conforms = conforms;\n    lodash.constant = constant;\n    lodash.countBy = countBy;\n    lodash.create = create;\n    lodash.curry = curry;\n    lodash.curryRight = curryRight;\n    lodash.debounce = debounce;\n    lodash.defaults = defaults;\n    lodash.defaultsDeep = defaultsDeep;\n    lodash.defer = defer;\n    lodash.delay = delay;\n    lodash.difference = difference;\n    lodash.differenceBy = differenceBy;\n    lodash.differenceWith = differenceWith;\n    lodash.drop = drop;\n    lodash.dropRight = dropRight;\n    lodash.dropRightWhile = dropRightWhile;\n    lodash.dropWhile = dropWhile;\n    lodash.fill = fill;\n    lodash.filter = filter;\n    lodash.flatMap = flatMap;\n    lodash.flatMapDeep = flatMapDeep;\n    lodash.flatMapDepth = flatMapDepth;\n    lodash.flatten = flatten;\n    lodash.flattenDeep = flattenDeep;\n    lodash.flattenDepth = flattenDepth;\n    lodash.flip = flip;\n    lodash.flow = flow;\n    lodash.flowRight = flowRight;\n    lodash.fromPairs = fromPairs;\n    lodash.functions = functions;\n    lodash.functionsIn = functionsIn;\n    lodash.groupBy = groupBy;\n    lodash.initial = initial;\n    lodash.intersection = intersection;\n    lodash.intersectionBy = intersectionBy;\n    lodash.intersectionWith = intersectionWith;\n    lodash.invert = invert;\n    lodash.invertBy = invertBy;\n    lodash.invokeMap = invokeMap;\n    lodash.iteratee = iteratee;\n    lodash.keyBy = keyBy;\n    lodash.keys = keys;\n    lodash.keysIn = keysIn;\n    lodash.map = map;\n    lodash.mapKeys = mapKeys;\n    lodash.mapValues = mapValues;\n    lodash.matches = matches;\n    lodash.matchesProperty = matchesProperty;\n    lodash.memoize = memoize;\n    lodash.merge = merge;\n    lodash.mergeWith = mergeWith;\n    lodash.method = method;\n    lodash.methodOf = methodOf;\n    lodash.mixin = mixin;\n    lodash.negate = negate;\n    lodash.nthArg = nthArg;\n    lodash.omit = omit;\n    lodash.omitBy = omitBy;\n    lodash.once = once;\n    lodash.orderBy = orderBy;\n    lodash.over = over;\n    lodash.overArgs = overArgs;\n    lodash.overEvery = overEvery;\n    lodash.overSome = overSome;\n    lodash.partial = partial;\n    lodash.partialRight = partialRight;\n    lodash.partition = partition;\n    lodash.pick = pick;\n    lodash.pickBy = pickBy;\n    lodash.property = property;\n    lodash.propertyOf = propertyOf;\n    lodash.pull = pull;\n    lodash.pullAll = pullAll;\n    lodash.pullAllBy = pullAllBy;\n    lodash.pullAllWith = pullAllWith;\n    lodash.pullAt = pullAt;\n    lodash.range = range;\n    lodash.rangeRight = rangeRight;\n    lodash.rearg = rearg;\n    lodash.reject = reject;\n    lodash.remove = remove;\n    lodash.rest = rest;\n    lodash.reverse = reverse;\n    lodash.sampleSize = sampleSize;\n    lodash.set = set;\n    lodash.setWith = setWith;\n    lodash.shuffle = shuffle;\n    lodash.slice = slice;\n    lodash.sortBy = sortBy;\n    lodash.sortedUniq = sortedUniq;\n    lodash.sortedUniqBy = sortedUniqBy;\n    lodash.split = split;\n    lodash.spread = spread;\n    lodash.tail = tail;\n    lodash.take = take;\n    lodash.takeRight = takeRight;\n    lodash.takeRightWhile = takeRightWhile;\n    lodash.takeWhile = takeWhile;\n    lodash.tap = tap;\n    lodash.throttle = throttle;\n    lodash.thru = thru;\n    lodash.toArray = toArray;\n    lodash.toPairs = toPairs;\n    lodash.toPairsIn = toPairsIn;\n    lodash.toPath = toPath;\n    lodash.toPlainObject = toPlainObject;\n    lodash.transform = transform;\n    lodash.unary = unary;\n    lodash.union = union;\n    lodash.unionBy = unionBy;\n    lodash.unionWith = unionWith;\n    lodash.uniq = uniq;\n    lodash.uniqBy = uniqBy;\n    lodash.uniqWith = uniqWith;\n    lodash.unset = unset;\n    lodash.unzip = unzip;\n    lodash.unzipWith = unzipWith;\n    lodash.update = update;\n    lodash.updateWith = updateWith;\n    lodash.values = values;\n    lodash.valuesIn = valuesIn;\n    lodash.without = without;\n    lodash.words = words;\n    lodash.wrap = wrap;\n    lodash.xor = xor;\n    lodash.xorBy = xorBy;\n    lodash.xorWith = xorWith;\n    lodash.zip = zip;\n    lodash.zipObject = zipObject;\n    lodash.zipObjectDeep = zipObjectDeep;\n    lodash.zipWith = zipWith;\n\n    // Add aliases.\n    lodash.entries = toPairs;\n    lodash.entriesIn = toPairsIn;\n    lodash.extend = assignIn;\n    lodash.extendWith = assignInWith;\n\n    // Add methods to `lodash.prototype`.\n    mixin(lodash, lodash);\n\n    /*------------------------------------------------------------------------*/\n\n    // Add methods that return unwrapped values in chain sequences.\n    lodash.add = add;\n    lodash.attempt = attempt;\n    lodash.camelCase = camelCase;\n    lodash.capitalize = capitalize;\n    lodash.ceil = ceil;\n    lodash.clamp = clamp;\n    lodash.clone = clone;\n    lodash.cloneDeep = cloneDeep;\n    lodash.cloneDeepWith = cloneDeepWith;\n    lodash.cloneWith = cloneWith;\n    lodash.conformsTo = conformsTo;\n    lodash.deburr = deburr;\n    lodash.defaultTo = defaultTo;\n    lodash.divide = divide;\n    lodash.endsWith = endsWith;\n    lodash.eq = eq;\n    lodash.escape = escape;\n    lodash.escapeRegExp = escapeRegExp;\n    lodash.every = every;\n    lodash.find = find;\n    lodash.findIndex = findIndex;\n    lodash.findKey = findKey;\n    lodash.findLast = findLast;\n    lodash.findLastIndex = findLastIndex;\n    lodash.findLastKey = findLastKey;\n    lodash.floor = floor;\n    lodash.forEach = forEach;\n    lodash.forEachRight = forEachRight;\n    lodash.forIn = forIn;\n    lodash.forInRight = forInRight;\n    lodash.forOwn = forOwn;\n    lodash.forOwnRight = forOwnRight;\n    lodash.get = get;\n    lodash.gt = gt;\n    lodash.gte = gte;\n    lodash.has = has;\n    lodash.hasIn = hasIn;\n    lodash.head = head;\n    lodash.identity = identity;\n    lodash.includes = includes;\n    lodash.indexOf = indexOf;\n    lodash.inRange = inRange;\n    lodash.invoke = invoke;\n    lodash.isArguments = isArguments;\n    lodash.isArray = isArray;\n    lodash.isArrayBuffer = isArrayBuffer;\n    lodash.isArrayLike = isArrayLike;\n    lodash.isArrayLikeObject = isArrayLikeObject;\n    lodash.isBoolean = isBoolean;\n    lodash.isBuffer = isBuffer;\n    lodash.isDate = isDate;\n    lodash.isElement = isElement;\n    lodash.isEmpty = isEmpty;\n    lodash.isEqual = isEqual;\n    lodash.isEqualWith = isEqualWith;\n    lodash.isError = isError;\n    lodash.isFinite = isFinite;\n    lodash.isFunction = isFunction;\n    lodash.isInteger = isInteger;\n    lodash.isLength = isLength;\n    lodash.isMap = isMap;\n    lodash.isMatch = isMatch;\n    lodash.isMatchWith = isMatchWith;\n    lodash.isNaN = isNaN;\n    lodash.isNative = isNative;\n    lodash.isNil = isNil;\n    lodash.isNull = isNull;\n    lodash.isNumber = isNumber;\n    lodash.isObject = isObject;\n    lodash.isObjectLike = isObjectLike;\n    lodash.isPlainObject = isPlainObject;\n    lodash.isRegExp = isRegExp;\n    lodash.isSafeInteger = isSafeInteger;\n    lodash.isSet = isSet;\n    lodash.isString = isString;\n    lodash.isSymbol = isSymbol;\n    lodash.isTypedArray = isTypedArray;\n    lodash.isUndefined = isUndefined;\n    lodash.isWeakMap = isWeakMap;\n    lodash.isWeakSet = isWeakSet;\n    lodash.join = join;\n    lodash.kebabCase = kebabCase;\n    lodash.last = last;\n    lodash.lastIndexOf = lastIndexOf;\n    lodash.lowerCase = lowerCase;\n    lodash.lowerFirst = lowerFirst;\n    lodash.lt = lt;\n    lodash.lte = lte;\n    lodash.max = max;\n    lodash.maxBy = maxBy;\n    lodash.mean = mean;\n    lodash.meanBy = meanBy;\n    lodash.min = min;\n    lodash.minBy = minBy;\n    lodash.stubArray = stubArray;\n    lodash.stubFalse = stubFalse;\n    lodash.stubObject = stubObject;\n    lodash.stubString = stubString;\n    lodash.stubTrue = stubTrue;\n    lodash.multiply = multiply;\n    lodash.nth = nth;\n    lodash.noConflict = noConflict;\n    lodash.noop = noop;\n    lodash.now = now;\n    lodash.pad = pad;\n    lodash.padEnd = padEnd;\n    lodash.padStart = padStart;\n    lodash.parseInt = parseInt;\n    lodash.random = random;\n    lodash.reduce = reduce;\n    lodash.reduceRight = reduceRight;\n    lodash.repeat = repeat;\n    lodash.replace = replace;\n    lodash.result = result;\n    lodash.round = round;\n    lodash.runInContext = runInContext;\n    lodash.sample = sample;\n    lodash.size = size;\n    lodash.snakeCase = snakeCase;\n    lodash.some = some;\n    lodash.sortedIndex = sortedIndex;\n    lodash.sortedIndexBy = sortedIndexBy;\n    lodash.sortedIndexOf = sortedIndexOf;\n    lodash.sortedLastIndex = sortedLastIndex;\n    lodash.sortedLastIndexBy = sortedLastIndexBy;\n    lodash.sortedLastIndexOf = sortedLastIndexOf;\n    lodash.startCase = startCase;\n    lodash.startsWith = startsWith;\n    lodash.subtract = subtract;\n    lodash.sum = sum;\n    lodash.sumBy = sumBy;\n    lodash.template = template;\n    lodash.times = times;\n    lodash.toFinite = toFinite;\n    lodash.toInteger = toInteger;\n    lodash.toLength = toLength;\n    lodash.toLower = toLower;\n    lodash.toNumber = toNumber;\n    lodash.toSafeInteger = toSafeInteger;\n    lodash.toString = toString;\n    lodash.toUpper = toUpper;\n    lodash.trim = trim;\n    lodash.trimEnd = trimEnd;\n    lodash.trimStart = trimStart;\n    lodash.truncate = truncate;\n    lodash.unescape = unescape;\n    lodash.uniqueId = uniqueId;\n    lodash.upperCase = upperCase;\n    lodash.upperFirst = upperFirst;\n\n    // Add aliases.\n    lodash.each = forEach;\n    lodash.eachRight = forEachRight;\n    lodash.first = head;\n\n    mixin(lodash, (function() {\n      var source = {};\n      baseForOwn(lodash, function(func, methodName) {\n        if (!hasOwnProperty.call(lodash.prototype, methodName)) {\n          source[methodName] = func;\n        }\n      });\n      return source;\n    }()), { 'chain': false });\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * The semantic version number.\n     *\n     * @static\n     * @memberOf _\n     * @type {string}\n     */\n    lodash.VERSION = VERSION;\n\n    // Assign default placeholders.\n    arrayEach(['bind', 'bindKey', 'curry', 'curryRight', 'partial', 'partialRight'], function(methodName) {\n      lodash[methodName].placeholder = lodash;\n    });\n\n    // Add `LazyWrapper` methods for `_.drop` and `_.take` variants.\n    arrayEach(['drop', 'take'], function(methodName, index) {\n      LazyWrapper.prototype[methodName] = function(n) {\n        n = n === undefined ? 1 : nativeMax(toInteger(n), 0);\n\n        var result = (this.__filtered__ && !index)\n          ? new LazyWrapper(this)\n          : this.clone();\n\n        if (result.__filtered__) {\n          result.__takeCount__ = nativeMin(n, result.__takeCount__);\n        } else {\n          result.__views__.push({\n            'size': nativeMin(n, MAX_ARRAY_LENGTH),\n            'type': methodName + (result.__dir__ < 0 ? 'Right' : '')\n          });\n        }\n        return result;\n      };\n\n      LazyWrapper.prototype[methodName + 'Right'] = function(n) {\n        return this.reverse()[methodName](n).reverse();\n      };\n    });\n\n    // Add `LazyWrapper` methods that accept an `iteratee` value.\n    arrayEach(['filter', 'map', 'takeWhile'], function(methodName, index) {\n      var type = index + 1,\n          isFilter = type == LAZY_FILTER_FLAG || type == LAZY_WHILE_FLAG;\n\n      LazyWrapper.prototype[methodName] = function(iteratee) {\n        var result = this.clone();\n        result.__iteratees__.push({\n          'iteratee': getIteratee(iteratee, 3),\n          'type': type\n        });\n        result.__filtered__ = result.__filtered__ || isFilter;\n        return result;\n      };\n    });\n\n    // Add `LazyWrapper` methods for `_.head` and `_.last`.\n    arrayEach(['head', 'last'], function(methodName, index) {\n      var takeName = 'take' + (index ? 'Right' : '');\n\n      LazyWrapper.prototype[methodName] = function() {\n        return this[takeName](1).value()[0];\n      };\n    });\n\n    // Add `LazyWrapper` methods for `_.initial` and `_.tail`.\n    arrayEach(['initial', 'tail'], function(methodName, index) {\n      var dropName = 'drop' + (index ? '' : 'Right');\n\n      LazyWrapper.prototype[methodName] = function() {\n        return this.__filtered__ ? new LazyWrapper(this) : this[dropName](1);\n      };\n    });\n\n    LazyWrapper.prototype.compact = function() {\n      return this.filter(identity);\n    };\n\n    LazyWrapper.prototype.find = function(predicate) {\n      return this.filter(predicate).head();\n    };\n\n    LazyWrapper.prototype.findLast = function(predicate) {\n      return this.reverse().find(predicate);\n    };\n\n    LazyWrapper.prototype.invokeMap = baseRest(function(path, args) {\n      if (typeof path == 'function') {\n        return new LazyWrapper(this);\n      }\n      return this.map(function(value) {\n        return baseInvoke(value, path, args);\n      });\n    });\n\n    LazyWrapper.prototype.reject = function(predicate) {\n      return this.filter(negate(getIteratee(predicate)));\n    };\n\n    LazyWrapper.prototype.slice = function(start, end) {\n      start = toInteger(start);\n\n      var result = this;\n      if (result.__filtered__ && (start > 0 || end < 0)) {\n        return new LazyWrapper(result);\n      }\n      if (start < 0) {\n        result = result.takeRight(-start);\n      } else if (start) {\n        result = result.drop(start);\n      }\n      if (end !== undefined) {\n        end = toInteger(end);\n        result = end < 0 ? result.dropRight(-end) : result.take(end - start);\n      }\n      return result;\n    };\n\n    LazyWrapper.prototype.takeRightWhile = function(predicate) {\n      return this.reverse().takeWhile(predicate).reverse();\n    };\n\n    LazyWrapper.prototype.toArray = function() {\n      return this.take(MAX_ARRAY_LENGTH);\n    };\n\n    // Add `LazyWrapper` methods to `lodash.prototype`.\n    baseForOwn(LazyWrapper.prototype, function(func, methodName) {\n      var checkIteratee = /^(?:filter|find|map|reject)|While$/.test(methodName),\n          isTaker = /^(?:head|last)$/.test(methodName),\n          lodashFunc = lodash[isTaker ? ('take' + (methodName == 'last' ? 'Right' : '')) : methodName],\n          retUnwrapped = isTaker || /^find/.test(methodName);\n\n      if (!lodashFunc) {\n        return;\n      }\n      lodash.prototype[methodName] = function() {\n        var value = this.__wrapped__,\n            args = isTaker ? [1] : arguments,\n            isLazy = value instanceof LazyWrapper,\n            iteratee = args[0],\n            useLazy = isLazy || isArray(value);\n\n        var interceptor = function(value) {\n          var result = lodashFunc.apply(lodash, arrayPush([value], args));\n          return (isTaker && chainAll) ? result[0] : result;\n        };\n\n        if (useLazy && checkIteratee && typeof iteratee == 'function' && iteratee.length != 1) {\n          // Avoid lazy use if the iteratee has a \"length\" value other than `1`.\n          isLazy = useLazy = false;\n        }\n        var chainAll = this.__chain__,\n            isHybrid = !!this.__actions__.length,\n            isUnwrapped = retUnwrapped && !chainAll,\n            onlyLazy = isLazy && !isHybrid;\n\n        if (!retUnwrapped && useLazy) {\n          value = onlyLazy ? value : new LazyWrapper(this);\n          var result = func.apply(value, args);\n          result.__actions__.push({ 'func': thru, 'args': [interceptor], 'thisArg': undefined });\n          return new LodashWrapper(result, chainAll);\n        }\n        if (isUnwrapped && onlyLazy) {\n          return func.apply(this, args);\n        }\n        result = this.thru(interceptor);\n        return isUnwrapped ? (isTaker ? result.value()[0] : result.value()) : result;\n      };\n    });\n\n    // Add `Array` methods to `lodash.prototype`.\n    arrayEach(['pop', 'push', 'shift', 'sort', 'splice', 'unshift'], function(methodName) {\n      var func = arrayProto[methodName],\n          chainName = /^(?:push|sort|unshift)$/.test(methodName) ? 'tap' : 'thru',\n          retUnwrapped = /^(?:pop|shift)$/.test(methodName);\n\n      lodash.prototype[methodName] = function() {\n        var args = arguments;\n        if (retUnwrapped && !this.__chain__) {\n          var value = this.value();\n          return func.apply(isArray(value) ? value : [], args);\n        }\n        return this[chainName](function(value) {\n          return func.apply(isArray(value) ? value : [], args);\n        });\n      };\n    });\n\n    // Map minified method names to their real names.\n    baseForOwn(LazyWrapper.prototype, function(func, methodName) {\n      var lodashFunc = lodash[methodName];\n      if (lodashFunc) {\n        var key = (lodashFunc.name + ''),\n            names = realNames[key] || (realNames[key] = []);\n\n        names.push({ 'name': methodName, 'func': lodashFunc });\n      }\n    });\n\n    realNames[createHybrid(undefined, WRAP_BIND_KEY_FLAG).name] = [{\n      'name': 'wrapper',\n      'func': undefined\n    }];\n\n    // Add methods to `LazyWrapper`.\n    LazyWrapper.prototype.clone = lazyClone;\n    LazyWrapper.prototype.reverse = lazyReverse;\n    LazyWrapper.prototype.value = lazyValue;\n\n    // Add chain sequence methods to the `lodash` wrapper.\n    lodash.prototype.at = wrapperAt;\n    lodash.prototype.chain = wrapperChain;\n    lodash.prototype.commit = wrapperCommit;\n    lodash.prototype.next = wrapperNext;\n    lodash.prototype.plant = wrapperPlant;\n    lodash.prototype.reverse = wrapperReverse;\n    lodash.prototype.toJSON = lodash.prototype.valueOf = lodash.prototype.value = wrapperValue;\n\n    // Add lazy aliases.\n    lodash.prototype.first = lodash.prototype.head;\n\n    if (symIterator) {\n      lodash.prototype[symIterator] = wrapperToIterator;\n    }\n    return lodash;\n  });\n\n  /*--------------------------------------------------------------------------*/\n\n  // Export lodash.\n  var _ = runInContext();\n\n  // Some AMD build optimizers, like r.js, check for condition patterns like:\n  if (true) {\n    // Expose Lodash on the global object to prevent errors when Lodash is\n    // loaded by a script tag in the presence of an AMD loader.\n    // See http://requirejs.org/docs/errors.html#mismatch for more details.\n    // Use `_.noConflict` to remove Lodash from the global object.\n    root._ = _;\n\n    // Define as an anonymous module so, through path mapping, it can be\n    // referenced as the \"underscore\" module.\n    !(__WEBPACK_AMD_DEFINE_RESULT__ = (function() {\n      return _;\n    }).call(exports, __webpack_require__, exports, module),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  }\n  // Check for `exports` after `define` in case a build optimizer adds it.\n  else {}\n}.call(this));\n\n/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../webpack/buildin/global.js */ \"./node_modules/webpack/buildin/global.js\"), __webpack_require__(/*! ./../webpack/buildin/module.js */ \"./node_modules/webpack/buildin/module.js\")(module)))\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvbG9kYXNoL2xvZGFzaC5qcz8yZWYwIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJzREFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQzs7QUFFRDtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSwyQ0FBMkM7QUFDM0M7QUFDQSwyREFBMkQ7O0FBRTNEO0FBQ0EsK0NBQStDO0FBQy9DO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNDQUFzQztBQUN0Qzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLHlCQUF5QjtBQUN6Qix5QkFBeUI7QUFDekI7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLE1BQU0sYUFBYSxPQUFPOztBQUVwRDtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaURBQWlELEVBQUU7QUFDbkQ7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLDJDQUEyQyxHQUFHOztBQUU5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGVBQWU7QUFDZixjQUFjO0FBQ2QsY0FBYztBQUNkLGdCQUFnQjtBQUNoQixlQUFlO0FBQ2Y7O0FBRUE7QUFDQTtBQUNBLFVBQVU7QUFDVixTQUFTO0FBQ1QsU0FBUztBQUNULFdBQVc7QUFDWCxVQUFVO0FBQ1Y7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7O0FBRUg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsU0FBUztBQUN0QixhQUFhLEVBQUU7QUFDZixhQUFhLE1BQU07QUFDbkIsZUFBZSxFQUFFO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxNQUFNO0FBQ25CLGFBQWEsU0FBUztBQUN0QixhQUFhLFNBQVM7QUFDdEIsYUFBYSxPQUFPO0FBQ3BCLGVBQWUsU0FBUztBQUN4QjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsTUFBTTtBQUNuQixhQUFhLFNBQVM7QUFDdEIsZUFBZSxNQUFNO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLE1BQU07QUFDbkIsYUFBYSxTQUFTO0FBQ3RCLGVBQWUsTUFBTTtBQUNyQjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsTUFBTTtBQUNuQixhQUFhLFNBQVM7QUFDdEIsZUFBZSxRQUFRO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsTUFBTTtBQUNuQixhQUFhLFNBQVM7QUFDdEIsZUFBZSxNQUFNO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLE1BQU07QUFDbkIsYUFBYSxFQUFFO0FBQ2YsZUFBZSxRQUFRO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLE1BQU07QUFDbkIsYUFBYSxFQUFFO0FBQ2YsYUFBYSxTQUFTO0FBQ3RCLGVBQWUsUUFBUTtBQUN2QjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxNQUFNO0FBQ25CLGFBQWEsU0FBUztBQUN0QixlQUFlLE1BQU07QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxNQUFNO0FBQ25CLGFBQWEsTUFBTTtBQUNuQixlQUFlLE1BQU07QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLE1BQU07QUFDbkIsYUFBYSxTQUFTO0FBQ3RCLGFBQWEsRUFBRTtBQUNmLGFBQWEsUUFBUTtBQUNyQjtBQUNBLGVBQWUsRUFBRTtBQUNqQjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLE1BQU07QUFDbkIsYUFBYSxTQUFTO0FBQ3RCLGFBQWEsRUFBRTtBQUNmLGFBQWEsUUFBUTtBQUNyQjtBQUNBLGVBQWUsRUFBRTtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLE1BQU07QUFDbkIsYUFBYSxTQUFTO0FBQ3RCLGVBQWUsUUFBUTtBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxPQUFPO0FBQ3BCLGVBQWUsT0FBTztBQUN0QjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxPQUFPO0FBQ3BCLGVBQWUsTUFBTTtBQUNyQjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsT0FBTztBQUNwQixlQUFlLE1BQU07QUFDckI7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxhQUFhO0FBQzFCLGFBQWEsU0FBUztBQUN0QixhQUFhLFNBQVM7QUFDdEIsZUFBZSxFQUFFO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxNQUFNO0FBQ25CLGFBQWEsU0FBUztBQUN0QixhQUFhLE9BQU87QUFDcEIsYUFBYSxRQUFRO0FBQ3JCLGVBQWUsT0FBTztBQUN0QjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsTUFBTTtBQUNuQixhQUFhLEVBQUU7QUFDZixhQUFhLE9BQU87QUFDcEIsZUFBZSxPQUFPO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsTUFBTTtBQUNuQixhQUFhLEVBQUU7QUFDZixhQUFhLE9BQU87QUFDcEIsYUFBYSxTQUFTO0FBQ3RCLGVBQWUsT0FBTztBQUN0QjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsRUFBRTtBQUNmLGVBQWUsUUFBUTtBQUN2QjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxNQUFNO0FBQ25CLGFBQWEsU0FBUztBQUN0QixlQUFlLE9BQU87QUFDdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsT0FBTztBQUNwQixlQUFlLFNBQVM7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxPQUFPO0FBQ3BCLGVBQWUsU0FBUztBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsYUFBYTtBQUMxQixhQUFhLFNBQVM7QUFDdEIsYUFBYSxFQUFFO0FBQ2YsYUFBYSxRQUFRO0FBQ3JCO0FBQ0EsYUFBYSxTQUFTO0FBQ3RCLGVBQWUsRUFBRTtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLE1BQU07QUFDbkIsYUFBYSxTQUFTO0FBQ3RCLGVBQWUsTUFBTTtBQUNyQjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLE1BQU07QUFDbkIsYUFBYSxTQUFTO0FBQ3RCLGVBQWUsT0FBTztBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsT0FBTztBQUNwQixhQUFhLFNBQVM7QUFDdEIsZUFBZSxNQUFNO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsT0FBTztBQUNwQixhQUFhLE1BQU07QUFDbkIsZUFBZSxPQUFPO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxTQUFTO0FBQ3RCLGVBQWUsU0FBUztBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxPQUFPO0FBQ3BCLGFBQWEsTUFBTTtBQUNuQixlQUFlLE9BQU87QUFDdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLE9BQU87QUFDcEIsYUFBYSxPQUFPO0FBQ3BCLGVBQWUsUUFBUTtBQUN2QjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxNQUFNO0FBQ25CLGFBQWEsTUFBTTtBQUNuQixlQUFlLE9BQU87QUFDdEI7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLE1BQU07QUFDbkIsYUFBYSxNQUFNO0FBQ25CLGVBQWUsT0FBTztBQUN0QjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxNQUFNO0FBQ25CLGFBQWEsRUFBRTtBQUNmLGVBQWUsT0FBTztBQUN0QjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxPQUFPO0FBQ3BCLGVBQWUsT0FBTztBQUN0QjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxPQUFPO0FBQ3BCLGVBQWUsT0FBTztBQUN0QjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxPQUFPO0FBQ3BCLGVBQWUsT0FBTztBQUN0QjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsT0FBTztBQUNwQixhQUFhLE9BQU87QUFDcEIsZUFBZSxFQUFFO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxPQUFPO0FBQ3BCLGVBQWUsUUFBUTtBQUN2QjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsT0FBTztBQUNwQixlQUFlLFFBQVE7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLE9BQU87QUFDcEIsZUFBZSxNQUFNO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLE9BQU87QUFDcEIsZUFBZSxNQUFNO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsU0FBUztBQUN0QixhQUFhLFNBQVM7QUFDdEIsZUFBZSxTQUFTO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxNQUFNO0FBQ25CLGFBQWEsRUFBRTtBQUNmLGVBQWUsTUFBTTtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxPQUFPO0FBQ3BCLGFBQWEsT0FBTztBQUNwQixlQUFlLEVBQUU7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxPQUFPO0FBQ3BCLGVBQWUsTUFBTTtBQUNyQjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLE9BQU87QUFDcEIsZUFBZSxNQUFNO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxNQUFNO0FBQ25CLGFBQWEsRUFBRTtBQUNmLGFBQWEsT0FBTztBQUNwQixlQUFlLE9BQU87QUFDdEI7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsTUFBTTtBQUNuQixhQUFhLEVBQUU7QUFDZixhQUFhLE9BQU87QUFDcEIsZUFBZSxPQUFPO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxPQUFPO0FBQ3BCLGVBQWUsT0FBTztBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLE9BQU87QUFDcEIsZUFBZSxNQUFNO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsT0FBTztBQUNwQixlQUFlLE9BQU87QUFDdEI7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsT0FBTztBQUNwQixlQUFlLE9BQU87QUFDdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsT0FBTztBQUNwQixlQUFlLE1BQU07QUFDckI7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLE9BQU87QUFDcEIsZUFBZSxNQUFNO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxPQUFPO0FBQ3BCLGVBQWUsU0FBUztBQUN4QjtBQUNBO0FBQ0EsY0FBYywyQkFBMkI7QUFDekM7QUFDQTtBQUNBLG1CQUFtQixnQ0FBZ0M7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDLDZCQUE2QjtBQUM5RDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLFFBQVE7QUFDdkI7QUFDQSxPQUFPO0FBQ1AsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0VBQWtFO0FBQ2xFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsRUFBRTtBQUNqQixpQkFBaUIsT0FBTztBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxl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QUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxFQUFFO0FBQ2pCLGlCQUFpQixRQUFRO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsRUFBRTtBQUNqQixpQkFBaUIsUUFBUTtBQUN6QjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsRUFBRTtBQUNqQixpQkFBaUIsUUFBUTtBQUN6QjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsRUFBRTtBQUNqQixpQkFBaUIsUUFBUTtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxFQUFFO0FBQ2pCLGlCQUFpQixTQUFTO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLE9BQU87QUFDdEIsaUJBQWlCLE1BQU07QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLE9BQU87QUFDdEIsaUJBQWlCLE1BQU07QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLEVBQUU7QUFDakIsZUFBZSxFQUFFO0FBQ2pCLGlCQUFpQixRQUFRO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLGFBQWE7QUFD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QTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLE9BQU87QUFDdEIsZUFBZSxPQUFPO0FBQ3RCLGVBQWUsT0FBTztBQUN0QixlQUFlLE9BQU87QUFDdEIsZUFBZSxTQUFTO0FBQ3hCLGVBQWUsU0FBUztBQUN4QixlQUFlLE9BQU87QUFDdEIsaUJBQWlCLFFBQVE7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxPQUFPO0FBQ3RCLGVBQWUsT0FBTztBQUN0QixlQUFlLE9BQU87QUFDdEIsZUFBZSxTQUFTO0FBQ3hCLGVBQWUsU0FBUztBQUN4QixlQUFlLE9BQU87QUFDdEIsaUJBQWlCLFFBQVE7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtB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QztBQUM3Qzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsRUFBRTtBQUNqQixpQkFBaUIsUUFBUTtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxFQUFFO0FBQ2pCLGVBQWUsT0FBTztBQUN0QixpQkFBaUIsUUFBUTtBQUN6QjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxFQUFFO0FBQ2pCLGVBQWUsRUFBRTtBQUNqQixlQUFlLEVBQUU7QUFDakIsaUJBQWlCLFFBQVE7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxFQUFFO0FBQ2pCLGVBQWUsT0FBTztBQUN0QixpQkFBaUIsUUFBUTtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsRUFBRTtBQUNqQixpQkFBaUIsUUFBUTtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsU0FBUztBQUN4QixpQkFBaUIsUUFBUTtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsU0FBUztBQUN4QixpQkFBaUIsUUFBUTtBQUN6QjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsRUFBRTtBQUNqQixpQkFBaUIsUUFBUTtBQUN6QjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxFQUFFO0FBQ2pC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QTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxTQUFTO0FBQ3hCLGVBQWUsS0FBSztBQUNwQixpQkFBaUIsT0FBTztBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsU0FBUztBQUN4QixlQUFlLE9BQU87QUFDdEIsZUFBZSxLQUFLO0FBQ3BCLGlCQUFpQixPQUFPO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsU0FBUztBQUN4QixpQkFBaUIsU0FBUztBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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QTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsRUFBRTtBQUNqQixpQkFBaUIsUUFBUTtBQUN6QjtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUMsa0JBQWtCLEVBQUU7QUFDckQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtEQUFrRCxrQkFBa0IsRUFBRTtBQUN0RTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLEVBQUU7QUFDakIsaUJBQWlCLFFBQVE7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxFQUFFO0FBQ2pCLGlCQUFpQixRQUFRO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLEVBQUU7QUFDakIsaUJBQWlCLFFBQVE7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxFQUFFO0FBQ2pCLGlCQUFpQixRQUFRO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsRUFBRTtBQUNqQixpQkFBaUIsUUFBUTtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLEVBQUU7QUFDakIsaUJBQWlCLFFBQVE7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxFQUFFO0FBQ2pCLGlCQUFpQixRQUFRO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsRUFBRTtBQUNqQixpQkFBaUIsUUFBUTtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLEVBQUU7QUFDakIsaUJBQWlCLFFBQVE7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixTQUFTO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLEVBQUU7QUFDakIsZUFBZSxFQUFFO0FBQ2pCLGlCQUFpQixRQUFRO0FBQ3pCO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckIsb0JBQW9CO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxFQUFFO0FBQ2pCLGVBQWUsRUFBRTtBQUNqQixlQUFlLFNBQVM7QUFDeEIsaUJBQWlCLFFBQVE7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxFQUFFO0FBQ2pCLGlCQUFpQixRQUFRO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxFQUFFO0FBQ2pCLGlCQUFpQixRQUFRO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLEVBQUU7QUFDakIsaUJBQWlCLFFBQVE7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsRUFBRTtBQUNqQixpQkFBaUIsUUFBUTtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7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QixRQUFRO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxFQUFFO0FBQ2pCLGlCQUFpQixRQUFRO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixpQkFBaUI7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsRUFBRTtBQUNqQixpQkFBaUIsUUFBUTtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsRUFBRTtBQUNqQixpQkFBaUIsUUFBUTtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxFQUFFO0FBQ2pCLGlCQUFpQixRQUFRO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsRUFBRTtBQUNqQixpQkFBaUIsUUFBUTtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLEVBQUU7QUFDakIsaUJBQWlCLFFBQVE7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxFQUFFO0FBQ2pCLGlCQUFpQixRQUFRO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsRUFBRTtBQUNqQixpQkFBaUIsUUFBUTtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxFQUFFO0FBQ2pCLGlCQUFpQixRQUFRO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLEVBQUU7QUFDakIsaUJBQWlCLFFBQVE7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsRUFBRTtBQUNqQixlQUFlLEVBQUU7QUFDakIsaUJBQWlCLFFBQVE7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsRUFBRTtBQUNqQixlQUFlLEVBQUU7QUFDakIsaUJBQWlCLFFBQVE7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsRUFBRTtBQUNqQixpQkFBaUIsTUFBTTtBQUN2QjtBQUNBO0FBQ0Esa0JBQWtCLGlCQUFpQjtBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLEVBQUU7QUFDakIsaUJBQWlCLE9BQU87QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLEVBQUU7QUFDakIsaUJBQWlCLE9BQU87QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLEVBQUU7QUFDakIsaUJBQWlCLE9BQU87QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsRUFBRTtBQUNqQixpQkFBaUIsT0FBTztBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFD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O0FBQ0EsZUFBZSxPQUFPO0FBQ3RCLGlCQUFpQixNQUFNO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsT0FBTztBQUN0QixpQkFBaUIsTUFBTTtBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLE9BQU87QUFDdEIsZUFBZSxPQUFPO0FBQ3RCLGVBQWUsT0FBTztBQUN0QixpQkFBaUIsT0FBTztBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxPQUFPO0FBQ3RCLGVBQWUsT0FBTztBQUN0QixlQUFlLE9BQU87QUFDdEIsaUJBQWlCLFFBQVE7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxPQUFPO0FBQ3RCLGVBQWUsT0FB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QTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEtBQUssTUFBTSxpQkFBaUI7O0FBRTVCOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7O0FBRUw7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DLDREQUE0RDtBQUMvRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxvQkFBb0IseUNBQXlDO0FBQzdEO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7O0FBRUg7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFBQTtBQUNMO0FBQ0E7QUFDQSxTQVNBO0FBQ0EsQ0FBQyIsImZpbGUiOiIuL25vZGVfbW9kdWxlcy9sb2Rhc2gvbG9kYXNoLmpzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBAbGljZW5zZVxuICogTG9kYXNoIDxodHRwczovL2xvZGFzaC5jb20vPlxuICogQ29weXJpZ2h0IEpTIEZvdW5kYXRpb24gYW5kIG90aGVyIGNvbnRyaWJ1dG9ycyA8aHR0cHM6Ly9qcy5mb3VuZGF0aW9uLz5cbiAqIFJlbGVhc2VkIHVuZGVyIE1JVCBsaWNlbnNlIDxodHRwczovL2xvZGFzaC5jb20vbGljZW5zZT5cbiAqIEJhc2VkIG9uIFVuZGVyc2NvcmUuanMgMS44LjMgPGh0dHA6Ly91bmRlcnNjb3JlanMub3JnL0xJQ0VOU0U+XG4gKiBDb3B5cmlnaHQgSmVyZW15IEFzaGtlbmFzLCBEb2N1bWVudENsb3VkIGFuZCBJbnZlc3RpZ2F0aXZlIFJlcG9ydGVycyAmIEVkaXRvcnNcbiAqL1xuOyhmdW5jdGlvbigpIHtcblxuICAvKiogVXNlZCBhcyBhIHNhZmUgcmVmZXJlbmNlIGZvciBgdW5kZWZpbmVkYCBpbiBwcmUtRVM1IGVudmlyb25tZW50cy4gKi9cbiAgdmFyIHVuZGVmaW5lZDtcblxuICAvKiogVXNlZCBhcyB0aGUgc2VtYW50aWMgdmVyc2lvbiBudW1iZXIuICovXG4gIHZhciBWRVJTSU9OID0gJzQuMTcuNSc7XG5cbiAgLyoqIFVzZWQgYXMgdGhlIHNpemUgdG8gZW5hYmxlIGxhcmdlIGFycmF5IG9wdGltaXphdGlvbnMuICovXG4gIHZhciBMQVJHRV9BUlJBWV9TSVpFID0gMjAwO1xuXG4gIC8qKiBFcnJvciBtZXNzYWdlIGNvbnN0YW50cy4gKi9cbiAgdmFyIENPUkVfRVJST1JfVEVYVCA9ICdVbnN1cHBvcnRlZCBjb3JlLWpzIHVzZS4gVHJ5IGh0dHBzOi8vbnBtcy5pby9zZWFyY2g/cT1wb255ZmlsbC4nLFxuICAgICAgRlVOQ19FUlJPUl9URVhUID0gJ0V4cGVjdGVkIGEgZnVuY3Rpb24nO1xuXG4gIC8qKiBVc2VkIHRvIHN0YW5kLWluIGZvciBgdW5kZWZpbmVkYCBoYXNoIHZhbHVlcy4gKi9cbiAgdmFyIEhBU0hfVU5ERUZJTkVEID0gJ19fbG9kYXNoX2hhc2hfdW5kZWZpbmVkX18nO1xuXG4gIC8qKiBVc2VkIGFzIHRoZSBtYXhpbXVtIG1lbW9pemUgY2FjaGUgc2l6ZS4gKi9cbiAgdmFyIE1BWF9NRU1PSVpFX1NJWkUgPSA1MDA7XG5cbiAgLyoqIFVzZWQgYXMgdGhlIGludGVybmFsIGFyZ3VtZW50IHBsYWNlaG9sZGVyLiAqL1xuICB2YXIgUExBQ0VIT0xERVIgPSAnX19sb2Rhc2hfcGxhY2Vob2xkZXJfXyc7XG5cbiAgLyoqIFVzZWQgdG8gY29tcG9zZSBiaXRtYXNrcyBmb3IgY2xvbmluZy4gKi9cbiAgdmFyIENMT05FX0RFRVBfRkxBRyA9IDEsXG4gICAgICBDTE9ORV9GTEFUX0ZMQUcgPSAyLFxuICAgICAgQ0xPTkVfU1lNQk9MU19GTEFHID0gNDtcblxuICAvKiogVXNlZCB0byBjb21wb3NlIGJpdG1hc2tzIGZvciB2YWx1ZSBjb21wYXJpc29ucy4gKi9cbiAgdmFyIENPTVBBUkVfUEFSVElBTF9GTEFHID0gMSxcbiAgICAgIENPTVBBUkVfVU5PUkRFUkVEX0ZMQUcgPSAyO1xuXG4gIC8qKiBVc2VkIHRvIGNvbXBvc2UgYml0bWFza3MgZm9yIGZ1bmN0aW9uIG1ldGFkYXRhLiAqL1xuICB2YXIgV1JBUF9CSU5EX0ZMQUcgPSAxLFxuICAgICAgV1JBUF9CSU5EX0tFWV9GTEFHID0gMixcbiAgICAgIFdSQVBfQ1VSUllfQk9VTkRfRkxBRyA9IDQsXG4gICAgICBXUkFQX0NVUlJZX0ZMQUcgPSA4LFxuICAgICAgV1JBUF9DVVJSWV9SSUdIVF9GTEFHID0gMTYsXG4gICAgICBXUkFQX1BBUlRJQUxfRkxBRyA9IDMyLFxuICAgICAgV1JBUF9QQVJUSUFMX1JJR0hUX0ZMQUcgPSA2NCxcbiAgICAgIFdSQVBfQVJZX0ZMQUcgPSAxMjgsXG4gICAgICBXUkFQX1JFQVJHX0ZMQUcgPSAyNTYsXG4gICAgICBXUkFQX0ZMSVBfRkxBRyA9IDUxMjtcblxuICAvKiogVXNlZCBhcyBkZWZhdWx0IG9wdGlvbnMgZm9yIGBfLnRydW5jYXRlYC4gKi9cbiAgdmFyIERFRkFVTFRfVFJVTkNfTEVOR1RIID0gMzAsXG4gICAgICBERUZBVUxUX1RSVU5DX09NSVNTSU9OID0gJy4uLic7XG5cbiAgLyoqIFVzZWQgdG8gZGV0ZWN0IGhvdCBmdW5jdGlvbnMgYnkgbnVtYmVyIG9mIGNhbGxzIHdpdGhpbiBhIHNwYW4gb2YgbWlsbGlzZWNvbmRzLiAqL1xuICB2YXIgSE9UX0NPVU5UID0gODAwLFxuICAgICAgSE9UX1NQQU4gPSAxNjtcblxuICAvKiogVXNlZCB0byBpbmRpY2F0ZSB0aGUgdHlwZSBvZiBsYXp5IGl0ZXJhdGVlcy4gKi9cbiAgdmFyIExBWllfRklMVEVSX0ZMQUcgPSAxLFxuICAgICAgTEFaWV9NQVBfRkxBRyA9IDIsXG4gICAgICBMQVpZX1dISUxFX0ZMQUcgPSAzO1xuXG4gIC8qKiBVc2VkIGFzIHJlZmVyZW5jZXMgZm9yIHZhcmlvdXMgYE51bWJlcmAgY29uc3RhbnRzLiAqL1xuICB2YXIgSU5GSU5JVFkgPSAxIC8gMCxcbiAgICAgIE1BWF9TQUZFX0lOVEVHRVIgPSA5MDA3MTk5MjU0NzQwOTkxLFxuICAgICAgTUFYX0lOVEVHRVIgPSAxLjc5NzY5MzEzNDg2MjMxNTdlKzMwOCxcbiAgICAgIE5BTiA9IDAgLyAwO1xuXG4gIC8qKiBVc2VkIGFzIHJlZmVyZW5jZXMgZm9yIHRoZSBtYXhpbXVtIGxlbmd0aCBhbmQgaW5kZXggb2YgYW4gYXJyYXkuICovXG4gIHZhciBNQVhfQVJSQVlfTEVOR1RIID0gNDI5NDk2NzI5NSxcbiAgICAgIE1BWF9BUlJBWV9JTkRFWCA9IE1BWF9BUlJBWV9MRU5HVEggLSAxLFxuICAgICAgSEFMRl9NQVhfQVJSQVlfTEVOR1RIID0gTUFYX0FSUkFZX0xFTkdUSCA+Pj4gMTtcblxuICAvKiogVXNlZCB0byBhc3NvY2lhdGUgd3JhcCBtZXRob2RzIHdpdGggdGhlaXIgYml0IGZsYWdzLiAqL1xuICB2YXIgd3JhcEZsYWdzID0gW1xuICAgIFsnYXJ5JywgV1JBUF9BUllfRkxBR10sXG4gICAgWydiaW5kJywgV1JBUF9CSU5EX0ZMQUddLFxuICAgIFsnYmluZEtleScsIFdSQVBfQklORF9LRVlfRkxBR10sXG4gICAgWydjdXJyeScsIFdSQVBfQ1VSUllfRkxBR10sXG4gICAgWydjdXJyeVJpZ2h0JywgV1JBUF9DVVJSWV9SSUdIVF9GTEFHXSxcbiAgICBbJ2ZsaXAnLCBXUkFQX0ZMSVBfRkxBR10sXG4gICAgWydwYXJ0aWFsJywgV1JBUF9QQVJUSUFMX0ZMQUddLFxuICAgIFsncGFydGlhbFJpZ2h0JywgV1JBUF9QQVJUSUFMX1JJR0hUX0ZMQUddLFxuICAgIFsncmVhcmcnLCBXUkFQX1JFQVJHX0ZMQUddXG4gIF07XG5cbiAgLyoqIGBPYmplY3QjdG9TdHJpbmdgIHJlc3VsdCByZWZlcmVuY2VzLiAqL1xuICB2YXIgYXJnc1RhZyA9ICdbb2JqZWN0IEFyZ3VtZW50c10nLFxuICAgICAgYXJyYXlUYWcgPSAnW29iamVjdCBBcnJheV0nLFxuICAgICAgYXN5bmNUYWcgPSAnW29iamVjdCBBc3luY0Z1bmN0aW9uXScsXG4gICAgICBib29sVGFnID0gJ1tvYmplY3QgQm9vbGVhbl0nLFxuICAgICAgZGF0ZVRhZyA9ICdbb2JqZWN0IERhdGVdJyxcbiAgICAgIGRvbUV4Y1RhZyA9ICdbb2JqZWN0IERPTUV4Y2VwdGlvbl0nLFxuICAgICAgZXJyb3JUYWcgPSAnW29iamVjdCBFcnJvcl0nLFxuICAgICAgZnVuY1RhZyA9ICdbb2JqZWN0IEZ1bmN0aW9uXScsXG4gICAgICBnZW5UYWcgPSAnW29iamVjdCBHZW5lcmF0b3JGdW5jdGlvbl0nLFxuICAgICAgbWFwVGFnID0gJ1tvYmplY3QgTWFwXScsXG4gICAgICBudW1iZXJUYWcgPSAnW29iamVjdCBOdW1iZXJdJyxcbiAgICAgIG51bGxUYWcgPSAnW29iamVjdCBOdWxsXScsXG4gICAgICBvYmplY3RUYWcgPSAnW29iamVjdCBPYmplY3RdJyxcbiAgICAgIHByb21pc2VUYWcgPSAnW29iamVjdCBQcm9taXNlXScsXG4gICAgICBwcm94eVRhZyA9ICdbb2JqZWN0IFByb3h5XScsXG4gICAgICByZWdleHBUYWcgPSAnW29iamVjdCBSZWdFeHBdJyxcbiAgICAgIHNldFRhZyA9ICdbb2JqZWN0IFNldF0nLFxuICAgICAgc3RyaW5nVGFnID0gJ1tvYmplY3QgU3RyaW5nXScsXG4gICAgICBzeW1ib2xUYWcgPSAnW29iamVjdCBTeW1ib2xdJyxcbiAgICAgIHVuZGVmaW5lZFRhZyA9ICdbb2JqZWN0IFVuZGVmaW5lZF0nLFxuICAgICAgd2Vha01hcFRhZyA9ICdbb2JqZWN0IFdlYWtNYXBdJyxcbiAgICAgIHdlYWtTZXRUYWcgPSAnW29iamVjdCBXZWFrU2V0XSc7XG5cbiAgdmFyIGFycmF5QnVmZmVyVGFnID0gJ1tvYmplY3QgQXJyYXlCdWZmZXJdJyxcbiAgICAgIGRhdGFWaWV3VGFnID0gJ1tvYmplY3QgRGF0YVZpZXddJyxcbiAgICAgIGZsb2F0MzJUYWcgPSAnW29iamVjdCBGbG9hdDMyQXJyYXldJyxcbiAgICAgIGZsb2F0NjRUYWcgPSAnW29iamVjdCBGbG9hdDY0QXJyYXldJyxcbiAgICAgIGludDhUYWcgPSAnW29iamVjdCBJbnQ4QXJyYXldJyxcbiAgICAgIGludDE2VGFnID0gJ1tvYmplY3QgSW50MTZBcnJheV0nLFxuICAgICAgaW50MzJUYWcgPSAnW29iamVjdCBJbnQzMkFycmF5XScsXG4gICAgICB1aW50OFRhZyA9ICdbb2JqZWN0IFVpbnQ4QXJyYXldJyxcbiAgICAgIHVpbnQ4Q2xhbXBlZFRhZyA9ICdbb2JqZWN0IFVpbnQ4Q2xhbXBlZEFycmF5XScsXG4gICAgICB1aW50MTZUYWcgPSAnW29iamVjdCBVaW50MTZBcnJheV0nLFxuICAgICAgdWludDMyVGFnID0gJ1tvYmplY3QgVWludDMyQXJyYXldJztcblxuICAvKiogVXNlZCB0byBtYXRjaCBlbXB0eSBzdHJpbmcgbGl0ZXJhbHMgaW4gY29tcGlsZWQgdGVtcGxhdGUgc291cmNlLiAqL1xuICB2YXIgcmVFbXB0eVN0cmluZ0xlYWRpbmcgPSAvXFxiX19wIFxcKz0gJyc7L2csXG4gICAgICByZUVtcHR5U3RyaW5nTWlkZGxlID0gL1xcYihfX3AgXFwrPSkgJycgXFwrL2csXG4gICAgICByZUVtcHR5U3RyaW5nVHJhaWxpbmcgPSAvKF9fZVxcKC4qP1xcKXxcXGJfX3RcXCkpIFxcK1xcbicnOy9nO1xuXG4gIC8qKiBVc2VkIHRvIG1hdGNoIEhUTUwgZW50aXRpZXMgYW5kIEhUTUwgY2hhcmFjdGVycy4gKi9cbiAgdmFyIHJlRXNjYXBlZEh0bWwgPSAvJig/OmFtcHxsdHxndHxxdW90fCMzOSk7L2csXG4gICAgICByZVVuZXNjYXBlZEh0bWwgPSAvWyY8PlwiJ10vZyxcbiAgICAgIHJlSGFzRXNjYXBlZEh0bWwgPSBSZWdFeHAocmVFc2NhcGVkSHRtbC5zb3VyY2UpLFxuICAgICAgcmVIYXNVbmVzY2FwZWRIdG1sID0gUmVnRXhwKHJlVW5lc2NhcGVkSHRtbC5zb3VyY2UpO1xuXG4gIC8qKiBVc2VkIHRvIG1hdGNoIHRlbXBsYXRlIGRlbGltaXRlcnMuICovXG4gIHZhciByZUVzY2FwZSA9IC88JS0oW1xcc1xcU10rPyklPi9nLFxuICAgICAgcmVFdmFsdWF0ZSA9IC88JShbXFxzXFxTXSs/KSU+L2csXG4gICAgICByZUludGVycG9sYXRlID0gLzwlPShbXFxzXFxTXSs/KSU+L2c7XG5cbiAgLyoqIFVzZWQgdG8gbWF0Y2ggcHJvcGVydHkgbmFtZXMgd2l0aGluIHByb3BlcnR5IHBhdGhzLiAqL1xuICB2YXIgcmVJc0RlZXBQcm9wID0gL1xcLnxcXFsoPzpbXltcXF1dKnwoW1wiJ10pKD86KD8hXFwxKVteXFxcXF18XFxcXC4pKj9cXDEpXFxdLyxcbiAgICAgIHJlSXNQbGFpblByb3AgPSAvXlxcdyokLyxcbiAgICAgIHJlUHJvcE5hbWUgPSAvW14uW1xcXV0rfFxcWyg/OigtP1xcZCsoPzpcXC5cXGQrKT8pfChbXCInXSkoKD86KD8hXFwyKVteXFxcXF18XFxcXC4pKj8pXFwyKVxcXXwoPz0oPzpcXC58XFxbXFxdKSg/OlxcLnxcXFtcXF18JCkpL2c7XG5cbiAgLyoqXG4gICAqIFVzZWQgdG8gbWF0Y2ggYFJlZ0V4cGBcbiAgICogW3N5bnRheCBjaGFyYWN0ZXJzXShodHRwOi8vZWNtYS1pbnRlcm5hdGlvbmFsLm9yZy9lY21hLTI2Mi83LjAvI3NlYy1wYXR0ZXJucykuXG4gICAqL1xuICB2YXIgcmVSZWdFeHBDaGFyID0gL1tcXFxcXiQuKis/KClbXFxde318XS9nLFxuICAgICAgcmVIYXNSZWdFeHBDaGFyID0gUmVnRXhwKHJlUmVnRXhwQ2hhci5zb3VyY2UpO1xuXG4gIC8qKiBVc2VkIHRvIG1hdGNoIGxlYWRpbmcgYW5kIHRyYWlsaW5nIHdoaXRlc3BhY2UuICovXG4gIHZhciByZVRyaW0gPSAvXlxccyt8XFxzKyQvZyxcbiAgICAgIHJlVHJpbVN0YXJ0ID0gL15cXHMrLyxcbiAgICAgIHJlVHJpbUVuZCA9IC9cXHMrJC87XG5cbiAgLyoqIFVzZWQgdG8gbWF0Y2ggd3JhcCBkZXRhaWwgY29tbWVudHMuICovXG4gIHZhciByZVdyYXBDb21tZW50ID0gL1xceyg/OlxcblxcL1xcKiBcXFt3cmFwcGVkIHdpdGggLitcXF0gXFwqXFwvKT9cXG4/LyxcbiAgICAgIHJlV3JhcERldGFpbHMgPSAvXFx7XFxuXFwvXFwqIFxcW3dyYXBwZWQgd2l0aCAoLispXFxdIFxcKi8sXG4gICAgICByZVNwbGl0RGV0YWlscyA9IC8sPyAmIC87XG5cbiAgLyoqIFVzZWQgdG8gbWF0Y2ggd29yZHMgY29tcG9zZWQgb2YgYWxwaGFudW1lcmljIGNoYXJhY3RlcnMuICovXG4gIHZhciByZUFzY2lpV29yZCA9IC9bXlxceDAwLVxceDJmXFx4M2EtXFx4NDBcXHg1Yi1cXHg2MFxceDdiLVxceDdmXSsvZztcblxuICAvKiogVXNlZCB0byBtYXRjaCBiYWNrc2xhc2hlcyBpbiBwcm9wZXJ0eSBwYXRocy4gKi9cbiAgdmFyIHJlRXNjYXBlQ2hhciA9IC9cXFxcKFxcXFwpPy9nO1xuXG4gIC8qKlxuICAgKiBVc2VkIHRvIG1hdGNoXG4gICAqIFtFUyB0ZW1wbGF0ZSBkZWxpbWl0ZXJzXShodHRwOi8vZWNtYS1pbnRlcm5hdGlvbmFsLm9yZy9lY21hLTI2Mi83LjAvI3NlYy10ZW1wbGF0ZS1saXRlcmFsLWxleGljYWwtY29tcG9uZW50cykuXG4gICAqL1xuICB2YXIgcmVFc1RlbXBsYXRlID0gL1xcJFxceyhbXlxcXFx9XSooPzpcXFxcLlteXFxcXH1dKikqKVxcfS9nO1xuXG4gIC8qKiBVc2VkIHRvIG1hdGNoIGBSZWdFeHBgIGZsYWdzIGZyb20gdGhlaXIgY29lcmNlZCBzdHJpbmcgdmFsdWVzLiAqL1xuICB2YXIgcmVGbGFncyA9IC9cXHcqJC87XG5cbiAgLyoqIFVzZWQgdG8gZGV0ZWN0IGJhZCBzaWduZWQgaGV4YWRlY2ltYWwgc3RyaW5nIHZhbHVlcy4gKi9cbiAgdmFyIHJlSXNCYWRIZXggPSAvXlstK10weFswLTlhLWZdKyQvaTtcblxuICAvKiogVXNlZCB0byBkZXRlY3QgYmluYXJ5IHN0cmluZyB2YWx1ZXMuICovXG4gIHZhciByZUlzQmluYXJ5ID0gL14wYlswMV0rJC9pO1xuXG4gIC8qKiBVc2VkIHRvIGRldGVjdCBob3N0IGNvbnN0cnVjdG9ycyAoU2FmYXJpKS4gKi9cbiAgdmFyIHJlSXNIb3N0Q3RvciA9IC9eXFxbb2JqZWN0IC4rP0NvbnN0cnVjdG9yXFxdJC87XG5cbiAgLyoqIFVzZWQgdG8gZGV0ZWN0IG9jdGFsIHN0cmluZyB2YWx1ZXMuICovXG4gIHZhciByZUlzT2N0YWwgPSAvXjBvWzAtN10rJC9pO1xuXG4gIC8qKiBVc2VkIHRvIGRldGVjdCB1bnNpZ25lZCBpbnRlZ2VyIHZhbHVlcy4gKi9cbiAgdmFyIHJlSXNVaW50ID0gL14oPzowfFsxLTldXFxkKikkLztcblxuICAvKiogVXNlZCB0byBtYXRjaCBMYXRpbiBVbmljb2RlIGxldHRlcnMgKGV4Y2x1ZGluZyBtYXRoZW1hdGljYWwgb3BlcmF0b3JzKS4gKi9cbiAgdmFyIHJlTGF0aW4gPSAvW1xceGMwLVxceGQ2XFx4ZDgtXFx4ZjZcXHhmOC1cXHhmZlxcdTAxMDAtXFx1MDE3Zl0vZztcblxuICAvKiogVXNlZCB0byBlbnN1cmUgY2FwdHVyaW5nIG9yZGVyIG9mIHRlbXBsYXRlIGRlbGltaXRlcnMuICovXG4gIHZhciByZU5vTWF0Y2ggPSAvKCReKS87XG5cbiAgLyoqIFVzZWQgdG8gbWF0Y2ggdW5lc2NhcGVkIGNoYXJhY3RlcnMgaW4gY29tcGlsZWQgc3RyaW5nIGxpdGVyYWxzLiAqL1xuICB2YXIgcmVVbmVzY2FwZWRTdHJpbmcgPSAvWydcXG5cXHJcXHUyMDI4XFx1MjAyOVxcXFxdL2c7XG5cbiAgLyoqIFVzZWQgdG8gY29tcG9zZSB1bmljb2RlIGNoYXJhY3RlciBjbGFzc2VzLiAqL1xuICB2YXIgcnNBc3RyYWxSYW5nZSA9ICdcXFxcdWQ4MDAtXFxcXHVkZmZmJyxcbiAgICAgIHJzQ29tYm9NYXJrc1JhbmdlID0gJ1xcXFx1MDMwMC1cXFxcdTAzNmYnLFxuICAgICAgcmVDb21ib0hhbGZNYXJrc1JhbmdlID0gJ1xcXFx1ZmUyMC1cXFxcdWZlMmYnLFxuICAgICAgcnNDb21ib1N5bWJvbHNSYW5nZSA9ICdcXFxcdTIwZDAtXFxcXHUyMGZmJyxcbiAgICAgIHJzQ29tYm9SYW5nZSA9IHJzQ29tYm9NYXJrc1JhbmdlICsgcmVDb21ib0hhbGZNYXJrc1JhbmdlICsgcnNDb21ib1N5bWJvbHNSYW5nZSxcbiAgICAgIHJzRGluZ2JhdFJhbmdlID0gJ1xcXFx1MjcwMC1cXFxcdTI3YmYnLFxuICAgICAgcnNMb3dlclJhbmdlID0gJ2EtelxcXFx4ZGYtXFxcXHhmNlxcXFx4ZjgtXFxcXHhmZicsXG4gICAgICByc01hdGhPcFJhbmdlID0gJ1xcXFx4YWNcXFxceGIxXFxcXHhkN1xcXFx4ZjcnLFxuICAgICAgcnNOb25DaGFyUmFuZ2UgPSAnXFxcXHgwMC1cXFxceDJmXFxcXHgzYS1cXFxceDQwXFxcXHg1Yi1cXFxceDYwXFxcXHg3Yi1cXFxceGJmJyxcbiAgICAgIHJzUHVuY3R1YXRpb25SYW5nZSA9ICdcXFxcdTIwMDAtXFxcXHUyMDZmJyxcbiAgICAgIHJzU3BhY2VSYW5nZSA9ICcgXFxcXHRcXFxceDBiXFxcXGZcXFxceGEwXFxcXHVmZWZmXFxcXG5cXFxcclxcXFx1MjAyOFxcXFx1MjAyOVxcXFx1MTY4MFxcXFx1MTgwZVxcXFx1MjAwMFxcXFx1MjAwMVxcXFx1MjAwMlxcXFx1MjAwM1xcXFx1MjAwNFxcXFx1MjAwNVxcXFx1MjAwNlxcXFx1MjAwN1xcXFx1MjAwOFxcXFx1MjAwOVxcXFx1MjAwYVxcXFx1MjAyZlxcXFx1MjA1ZlxcXFx1MzAwMCcsXG4gICAgICByc1VwcGVyUmFuZ2UgPSAnQS1aXFxcXHhjMC1cXFxceGQ2XFxcXHhkOC1cXFxceGRlJyxcbiAgICAgIHJzVmFyUmFuZ2UgPSAnXFxcXHVmZTBlXFxcXHVmZTBmJyxcbiAgICAgIHJzQnJlYWtSYW5nZSA9IHJzTWF0aE9wUmFuZ2UgKyByc05vbkNoYXJSYW5nZSArIHJzUHVuY3R1YXRpb25SYW5nZSArIHJzU3BhY2VSYW5nZTtcblxuICAvKiogVXNlZCB0byBjb21wb3NlIHVuaWNvZGUgY2FwdHVyZSBncm91cHMuICovXG4gIHZhciByc0Fwb3MgPSBcIlsnXFx1MjAxOV1cIixcbiAgICAgIHJzQXN0cmFsID0gJ1snICsgcnNBc3RyYWxSYW5nZSArICddJyxcbiAgICAgIHJzQnJlYWsgPSAnWycgKyByc0JyZWFrUmFuZ2UgKyAnXScsXG4gICAgICByc0NvbWJvID0gJ1snICsgcnNDb21ib1JhbmdlICsgJ10nLFxuICAgICAgcnNEaWdpdHMgPSAnXFxcXGQrJyxcbiAgICAgIHJzRGluZ2JhdCA9ICdbJyArIHJzRGluZ2JhdFJhbmdlICsgJ10nLFxuICAgICAgcnNMb3dlciA9ICdbJyArIHJzTG93ZXJSYW5nZSArICddJyxcbiAgICAgIHJzTWlzYyA9ICdbXicgKyByc0FzdHJhbFJhbmdlICsgcnNCcmVha1JhbmdlICsgcnNEaWdpdHMgKyByc0RpbmdiYXRSYW5nZSArIHJzTG93ZXJSYW5nZSArIHJzVXBwZXJSYW5nZSArICddJyxcbiAgICAgIHJzRml0eiA9ICdcXFxcdWQ4M2NbXFxcXHVkZmZiLVxcXFx1ZGZmZl0nLFxuICAgICAgcnNNb2RpZmllciA9ICcoPzonICsgcnNDb21ibyArICd8JyArIHJzRml0eiArICcpJyxcbiAgICAgIHJzTm9uQXN0cmFsID0gJ1teJyArIHJzQXN0cmFsUmFuZ2UgKyAnXScsXG4gICAgICByc1JlZ2lvbmFsID0gJyg/OlxcXFx1ZDgzY1tcXFxcdWRkZTYtXFxcXHVkZGZmXSl7Mn0nLFxuICAgICAgcnNTdXJyUGFpciA9ICdbXFxcXHVkODAwLVxcXFx1ZGJmZl1bXFxcXHVkYzAwLVxcXFx1ZGZmZl0nLFxuICAgICAgcnNVcHBlciA9ICdbJyArIHJzVXBwZXJSYW5nZSArICddJyxcbiAgICAgIHJzWldKID0gJ1xcXFx1MjAwZCc7XG5cbiAgLyoqIFVzZWQgdG8gY29tcG9zZSB1bmljb2RlIHJlZ2V4ZXMuICovXG4gIHZhciByc01pc2NMb3dlciA9ICcoPzonICsgcnNMb3dlciArICd8JyArIHJzTWlzYyArICcpJyxcbiAgICAgIHJzTWlzY1VwcGVyID0gJyg/OicgKyByc1VwcGVyICsgJ3wnICsgcnNNaXNjICsgJyknLFxuICAgICAgcnNPcHRDb250ckxvd2VyID0gJyg/OicgKyByc0Fwb3MgKyAnKD86ZHxsbHxtfHJlfHN8dHx2ZSkpPycsXG4gICAgICByc09wdENvbnRyVXBwZXIgPSAnKD86JyArIHJzQXBvcyArICcoPzpEfExMfE18UkV8U3xUfFZFKSk/JyxcbiAgICAgIHJlT3B0TW9kID0gcnNNb2RpZmllciArICc/JyxcbiAgICAgIHJzT3B0VmFyID0gJ1snICsgcnNWYXJSYW5nZSArICddPycsXG4gICAgICByc09wdEpvaW4gPSAnKD86JyArIHJzWldKICsgJyg/OicgKyBbcnNOb25Bc3RyYWwsIHJzUmVnaW9uYWwsIHJzU3VyclBhaXJdLmpvaW4oJ3wnKSArICcpJyArIHJzT3B0VmFyICsgcmVPcHRNb2QgKyAnKSonLFxuICAgICAgcnNPcmRMb3dlciA9ICdcXFxcZCooPzoxc3R8Mm5kfDNyZHwoPyFbMTIzXSlcXFxcZHRoKSg/PVxcXFxifFtBLVpfXSknLFxuICAgICAgcnNPcmRVcHBlciA9ICdcXFxcZCooPzoxU1R8Mk5EfDNSRHwoPyFbMTIzXSlcXFxcZFRIKSg/PVxcXFxifFthLXpfXSknLFxuICAgICAgcnNTZXEgPSByc09wdFZhciArIHJlT3B0TW9kICsgcnNPcHRKb2luLFxuICAgICAgcnNFbW9qaSA9ICcoPzonICsgW3JzRGluZ2JhdCwgcnNSZWdpb25hbCwgcnNTdXJyUGFpcl0uam9pbignfCcpICsgJyknICsgcnNTZXEsXG4gICAgICByc1N5bWJvbCA9ICcoPzonICsgW3JzTm9uQXN0cmFsICsgcnNDb21ibyArICc/JywgcnNDb21ibywgcnNSZWdpb25hbCwgcnNTdXJyUGFpciwgcnNBc3RyYWxdLmpvaW4oJ3wnKSArICcpJztcblxuICAvKiogVXNlZCB0byBtYXRjaCBhcG9zdHJvcGhlcy4gKi9cbiAgdmFyIHJlQXBvcyA9IFJlZ0V4cChyc0Fwb3MsICdnJyk7XG5cbiAgLyoqXG4gICAqIFVzZWQgdG8gbWF0Y2ggW2NvbWJpbmluZyBkaWFjcml0aWNhbCBtYXJrc10oaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvQ29tYmluaW5nX0RpYWNyaXRpY2FsX01hcmtzKSBhbmRcbiAgICogW2NvbWJpbmluZyBkaWFjcml0aWNhbCBtYXJrcyBmb3Igc3ltYm9sc10oaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvQ29tYmluaW5nX0RpYWNyaXRpY2FsX01hcmtzX2Zvcl9TeW1ib2xzKS5cbiAgICovXG4gIHZhciByZUNvbWJvTWFyayA9IFJlZ0V4cChyc0NvbWJvLCAnZycpO1xuXG4gIC8qKiBVc2VkIHRvIG1hdGNoIFtzdHJpbmcgc3ltYm9sc10oaHR0cHM6Ly9tYXRoaWFzYnluZW5zLmJlL25vdGVzL2phdmFzY3JpcHQtdW5pY29kZSkuICovXG4gIHZhciByZVVuaWNvZGUgPSBSZWdFeHAocnNGaXR6ICsgJyg/PScgKyByc0ZpdHogKyAnKXwnICsgcnNTeW1ib2wgKyByc1NlcSwgJ2cnKTtcblxuICAvKiogVXNlZCB0byBtYXRjaCBjb21wbGV4IG9yIGNvbXBvdW5kIHdvcmRzLiAqL1xuICB2YXIgcmVVbmljb2RlV29yZCA9IFJlZ0V4cChbXG4gICAgcnNVcHBlciArICc/JyArIHJzTG93ZXIgKyAnKycgKyByc09wdENvbnRyTG93ZXIgKyAnKD89JyArIFtyc0JyZWFrLCByc1VwcGVyLCAnJCddLmpvaW4oJ3wnKSArICcpJyxcbiAgICByc01pc2NVcHBlciArICcrJyArIHJzT3B0Q29udHJVcHBlciArICcoPz0nICsgW3JzQnJlYWssIHJzVXBwZXIgKyByc01pc2NMb3dlciwgJyQnXS5qb2luKCd8JykgKyAnKScsXG4gICAgcnNVcHBlciArICc/JyArIHJzTWlzY0xvd2VyICsgJysnICsgcnNPcHRDb250ckxvd2VyLFxuICAgIHJzVXBwZXIgKyAnKycgKyByc09wdENvbnRyVXBwZXIsXG4gICAgcnNPcmRVcHBlcixcbiAgICByc09yZExvd2VyLFxuICAgIHJzRGlnaXRzLFxuICAgIHJzRW1vamlcbiAgXS5qb2luKCd8JyksICdnJyk7XG5cbiAgLyoqIFVzZWQgdG8gZGV0ZWN0IHN0cmluZ3Mgd2l0aCBbemVyby13aWR0aCBqb2luZXJzIG9yIGNvZGUgcG9pbnRzIGZyb20gdGhlIGFzdHJhbCBwbGFuZXNdKGh0dHA6Ly9lZXYuZWUvYmxvZy8yMDE1LzA5LzEyL2RhcmstY29ybmVycy1vZi11bmljb2RlLykuICovXG4gIHZhciByZUhhc1VuaWNvZGUgPSBSZWdFeHAoJ1snICsgcnNaV0ogKyByc0FzdHJhbFJhbmdlICArIHJzQ29tYm9SYW5nZSArIHJzVmFyUmFuZ2UgKyAnXScpO1xuXG4gIC8qKiBVc2VkIHRvIGRldGVjdCBzdHJpbmdzIHRoYXQgbmVlZCBhIG1vcmUgcm9idXN0IHJlZ2V4cCB0byBtYXRjaCB3b3Jkcy4gKi9cbiAgdmFyIHJlSGFzVW5pY29kZVdvcmQgPSAvW2Etel1bQS1aXXxbQS1aXXsyLH1bYS16XXxbMC05XVthLXpBLVpdfFthLXpBLVpdWzAtOV18W15hLXpBLVowLTkgXS87XG5cbiAgLyoqIFVzZWQgdG8gYXNzaWduIGRlZmF1bHQgYGNvbnRleHRgIG9iamVjdCBwcm9wZXJ0aWVzLiAqL1xuICB2YXIgY29udGV4dFByb3BzID0gW1xuICAgICdBcnJheScsICdCdWZmZXInLCAnRGF0YVZpZXcnLCAnRGF0ZScsICdFcnJvcicsICdGbG9hdDMyQXJyYXknLCAnRmxvYXQ2NEFycmF5JyxcbiAgICAnRnVuY3Rpb24nLCAnSW50OEFycmF5JywgJ0ludDE2QXJyYXknLCAnSW50MzJBcnJheScsICdNYXAnLCAnTWF0aCcsICdPYmplY3QnLFxuICAgICdQcm9taXNlJywgJ1JlZ0V4cCcsICdTZXQnLCAnU3RyaW5nJywgJ1N5bWJvbCcsICdUeXBlRXJyb3InLCAnVWludDhBcnJheScsXG4gICAgJ1VpbnQ4Q2xhbXBlZEFycmF5JywgJ1VpbnQxNkFycmF5JywgJ1VpbnQzMkFycmF5JywgJ1dlYWtNYXAnLFxuICAgICdfJywgJ2NsZWFyVGltZW91dCcsICdpc0Zpbml0ZScsICdwYXJzZUludCcsICdzZXRUaW1lb3V0J1xuICBdO1xuXG4gIC8qKiBVc2VkIHRvIG1ha2UgdGVtcGxhdGUgc291cmNlVVJMcyBlYXNpZXIgdG8gaWRlbnRpZnkuICovXG4gIHZhciB0ZW1wbGF0ZUNvdW50ZXIgPSAtMTtcblxuICAvKiogVXNlZCB0byBpZGVudGlmeSBgdG9TdHJpbmdUYWdgIHZhbHVlcyBvZiB0eXBlZCBhcnJheXMuICovXG4gIHZhciB0eXBlZEFycmF5VGFncyA9IHt9O1xuICB0eXBlZEFycmF5VGFnc1tmbG9hdDMyVGFnXSA9IHR5cGVkQXJyYXlUYWdzW2Zsb2F0NjRUYWddID1cbiAgdHlwZWRBcnJheVRhZ3NbaW50OFRhZ10gPSB0eXBlZEFycmF5VGFnc1tpbnQxNlRhZ10gPVxuICB0eXBlZEFycmF5VGFnc1tpbnQzMlRhZ10gPSB0eXBlZEFycmF5VGFnc1t1aW50OFRhZ10gPVxuICB0eXBlZEFycmF5VGFnc1t1aW50OENsYW1wZWRUYWddID0gdHlwZWRBcnJheVRhZ3NbdWludDE2VGFnXSA9XG4gIHR5cGVkQXJyYXlUYWdzW3VpbnQzMlRhZ10gPSB0cnVlO1xuICB0eXBlZEFycmF5VGFnc1thcmdzVGFnXSA9IHR5cGVkQXJyYXlUYWdzW2FycmF5VGFnXSA9XG4gIHR5cGVkQXJyYXlUYWdzW2FycmF5QnVmZmVyVGFnXSA9IHR5cGVkQXJyYXlUYWdzW2Jvb2xUYWddID1cbiAgdHlwZWRBcnJheVRhZ3NbZGF0YVZpZXdUYWddID0gdHlwZWRBcnJheVRhZ3NbZGF0ZVRhZ10gPVxuICB0eXBlZEFycmF5VGFnc1tlcnJvclRhZ10gPSB0eXBlZEFycmF5VGFnc1tmdW5jVGFnXSA9XG4gIHR5cGVkQXJyYXlUYWdzW21hcFRhZ10gPSB0eXBlZEFycmF5VGFnc1tudW1iZXJUYWddID1cbiAgdHlwZWRBcnJheVRhZ3Nbb2JqZWN0VGFnXSA9IHR5cGVkQXJyYXlUYWdzW3JlZ2V4cFRhZ10gPVxuICB0eXBlZEFycmF5VGFnc1tzZXRUYWddID0gdHlwZWRBcnJheVRhZ3Nbc3RyaW5nVGFnXSA9XG4gIHR5cGVkQXJyYXlUYWdzW3dlYWtNYXBUYWddID0gZmFsc2U7XG5cbiAgLyoqIFVzZWQgdG8gaWRlbnRpZnkgYHRvU3RyaW5nVGFnYCB2YWx1ZXMgc3VwcG9ydGVkIGJ5IGBfLmNsb25lYC4gKi9cbiAgdmFyIGNsb25lYWJsZVRhZ3MgPSB7fTtcbiAgY2xvbmVhYmxlVGFnc1thcmdzVGFnXSA9IGNsb25lYWJsZVRhZ3NbYXJyYXlUYWddID1cbiAgY2xvbmVhYmxlVGFnc1thcnJheUJ1ZmZlclRhZ10gPSBjbG9uZWFibGVUYWdzW2RhdGFWaWV3VGFnXSA9XG4gIGNsb25lYWJsZVRhZ3NbYm9vbFRhZ10gPSBjbG9uZWFibGVUYWdzW2RhdGVUYWddID1cbiAgY2xvbmVhYmxlVGFnc1tmbG9hdDMyVGFnXSA9IGNsb25lYWJsZVRhZ3NbZmxvYXQ2NFRhZ10gPVxuICBjbG9uZWFibGVUYWdzW2ludDhUYWddID0gY2xvbmVhYmxlVGFnc1tpbnQxNlRhZ10gPVxuICBjbG9uZWFibGVUYWdzW2ludDMyVGFnXSA9IGNsb25lYWJsZVRhZ3NbbWFwVGFnXSA9XG4gIGNsb25lYWJsZVRhZ3NbbnVtYmVyVGFnXSA9IGNsb25lYWJsZVRhZ3Nbb2JqZWN0VGFnXSA9XG4gIGNsb25lYWJsZVRhZ3NbcmVnZXhwVGFnXSA9IGNsb25lYWJsZVRhZ3Nbc2V0VGFnXSA9XG4gIGNsb25lYWJsZVRhZ3Nbc3RyaW5nVGFnXSA9IGNsb25lYWJsZVRhZ3Nbc3ltYm9sVGFnXSA9XG4gIGNsb25lYWJsZVRhZ3NbdWludDhUYWddID0gY2xvbmVhYmxlVGFnc1t1aW50OENsYW1wZWRUYWddID1cbiAgY2xvbmVhYmxlVGFnc1t1aW50MTZUYWddID0gY2xvbmVhYmxlVGFnc1t1aW50MzJUYWddID0gdHJ1ZTtcbiAgY2xvbmVhYmxlVGFnc1tlcnJvclRhZ10gPSBjbG9uZWFibGVUYWdzW2Z1bmNUYWddID1cbiAgY2xvbmVhYmxlVGFnc1t3ZWFrTWFwVGFnXSA9IGZhbHNlO1xuXG4gIC8qKiBVc2VkIHRvIG1hcCBMYXRpbiBVbmljb2RlIGxldHRlcnMgdG8gYmFzaWMgTGF0aW4gbGV0dGVycy4gKi9cbiAgdmFyIGRlYnVycmVkTGV0dGVycyA9IHtcbiAgICAvLyBMYXRpbi0xIFN1cHBsZW1lbnQgYmxvY2suXG4gICAgJ1xceGMwJzogJ0EnLCAgJ1xceGMxJzogJ0EnLCAnXFx4YzInOiAnQScsICdcXHhjMyc6ICdBJywgJ1xceGM0JzogJ0EnLCAnXFx4YzUnOiAnQScsXG4gICAgJ1xceGUwJzogJ2EnLCAgJ1xceGUxJzogJ2EnLCAnXFx4ZTInOiAnYScsICdcXHhlMyc6ICdhJywgJ1xceGU0JzogJ2EnLCAnXFx4ZTUnOiAnYScsXG4gICAgJ1xceGM3JzogJ0MnLCAgJ1xceGU3JzogJ2MnLFxuICAgICdcXHhkMCc6ICdEJywgICdcXHhmMCc6ICdkJyxcbiAgICAnXFx4YzgnOiAnRScsICAnXFx4YzknOiAnRScsICdcXHhjYSc6ICdFJywgJ1xceGNiJzogJ0UnLFxuICAgICdcXHhlOCc6ICdlJywgICdcXHhlOSc6ICdlJywgJ1xceGVhJzogJ2UnLCAnXFx4ZWInOiAnZScsXG4gICAgJ1xceGNjJzogJ0knLCAgJ1xceGNkJzogJ0knLCAnXFx4Y2UnOiAnSScsICdcXHhjZic6ICdJJyxcbiAgICAnXFx4ZWMnOiAnaScsICAnXFx4ZWQnOiAnaScsICdcXHhlZSc6ICdpJywgJ1xceGVmJzogJ2knLFxuICAgICdcXHhkMSc6ICdOJywgICdcXHhmMSc6ICduJyxcbiAgICAnXFx4ZDInOiAnTycsICAnXFx4ZDMnOiAnTycsICdcXHhkNCc6ICdPJywgJ1xceGQ1JzogJ08nLCAnXFx4ZDYnOiAnTycsICdcXHhkOCc6ICdPJyxcbiAgICAnXFx4ZjInOiAnbycsICAnXFx4ZjMnOiAnbycsICdcXHhmNCc6ICdvJywgJ1xceGY1JzogJ28nLCAnXFx4ZjYnOiAnbycsICdcXHhmOCc6ICdvJyxcbiAgICAnXFx4ZDknOiAnVScsICAnXFx4ZGEnOiAnVScsICdcXHhkYic6ICdVJywgJ1xceGRjJzogJ1UnLFxuICAgICdcXHhmOSc6ICd1JywgICdcXHhmYSc6ICd1JywgJ1xceGZiJzogJ3UnLCAnXFx4ZmMnOiAndScsXG4gICAgJ1xceGRkJzogJ1knLCAgJ1xceGZkJzogJ3knLCAnXFx4ZmYnOiAneScsXG4gICAgJ1xceGM2JzogJ0FlJywgJ1xceGU2JzogJ2FlJyxcbiAgICAnXFx4ZGUnOiAnVGgnLCAnXFx4ZmUnOiAndGgnLFxuICAgICdcXHhkZic6ICdzcycsXG4gICAgLy8gTGF0aW4gRXh0ZW5kZWQtQSBibG9jay5cbiAgICAnXFx1MDEwMCc6ICdBJywgICdcXHUwMTAyJzogJ0EnLCAnXFx1MDEwNCc6ICdBJyxcbiAgICAnXFx1MDEwMSc6ICdhJywgICdcXHUwMTAzJzogJ2EnLCAnXFx1MDEwNSc6ICdhJyxcbiAgICAnXFx1MDEwNic6ICdDJywgICdcXHUwMTA4JzogJ0MnLCAnXFx1MDEwYSc6ICdDJywgJ1xcdTAxMGMnOiAnQycsXG4gICAgJ1xcdTAxMDcnOiAnYycsICAnXFx1MDEwOSc6ICdjJywgJ1xcdTAxMGInOiAnYycsICdcXHUwMTBkJzogJ2MnLFxuICAgICdcXHUwMTBlJzogJ0QnLCAgJ1xcdTAxMTAnOiAnRCcsICdcXHUwMTBmJzogJ2QnLCAnXFx1MDExMSc6ICdkJyxcbiAgICAnXFx1MDExMic6ICdFJywgICdcXHUwMTE0JzogJ0UnLCAnXFx1MDExNic6ICdFJywgJ1xcdTAxMTgnOiAnRScsICdcXHUwMTFhJzogJ0UnLFxuICAgICdcXHUwMTEzJzogJ2UnLCAgJ1xcdTAxMTUnOiAnZScsICdcXHUwMTE3JzogJ2UnLCAnXFx1MDExOSc6ICdlJywgJ1xcdTAxMWInOiAnZScsXG4gICAgJ1xcdTAxMWMnOiAnRycsICAnXFx1MDExZSc6ICdHJywgJ1xcdTAxMjAnOiAnRycsICdcXHUwMTIyJzogJ0cnLFxuICAgICdcXHUwMTFkJzogJ2cnLCAgJ1xcdTAxMWYnOiAnZycsICdcXHUwMTIxJzogJ2cnLCAnXFx1MDEyMyc6ICdnJyxcbiAgICAnXFx1MDEyNCc6ICdIJywgICdcXHUwMTI2JzogJ0gnLCAnXFx1MDEyNSc6ICdoJywgJ1xcdTAxMjcnOiAnaCcsXG4gICAgJ1xcdTAxMjgnOiAnSScsICAnXFx1MDEyYSc6ICdJJywgJ1xcdTAxMmMnOiAnSScsICdcXHUwMTJlJzogJ0knLCAnXFx1MDEzMCc6ICdJJyxcbiAgICAnXFx1MDEyOSc6ICdpJywgICdcXHUwMTJiJzogJ2knLCAnXFx1MDEyZCc6ICdpJywgJ1xcdTAxMmYnOiAnaScsICdcXHUwMTMxJzogJ2knLFxuICAgICdcXHUwMTM0JzogJ0onLCAgJ1xcdTAxMzUnOiAnaicsXG4gICAgJ1xcdTAxMzYnOiAnSycsICAnXFx1MDEzNyc6ICdrJywgJ1xcdTAxMzgnOiAnaycsXG4gICAgJ1xcdTAxMzknOiAnTCcsICAnXFx1MDEzYic6ICdMJywgJ1xcdTAxM2QnOiAnTCcsICdcXHUwMTNmJzogJ0wnLCAnXFx1MDE0MSc6ICdMJyxcbiAgICAnXFx1MDEzYSc6ICdsJywgICdcXHUwMTNjJzogJ2wnLCAnXFx1MDEzZSc6ICdsJywgJ1xcdTAxNDAnOiAnbCcsICdcXHUwMTQyJzogJ2wnLFxuICAgICdcXHUwMTQzJzogJ04nLCAgJ1xcdTAxNDUnOiAnTicsICdcXHUwMTQ3JzogJ04nLCAnXFx1MDE0YSc6ICdOJyxcbiAgICAnXFx1MDE0NCc6ICduJywgICdcXHUwMTQ2JzogJ24nLCAnXFx1MDE0OCc6ICduJywgJ1xcdTAxNGInOiAnbicsXG4gICAgJ1xcdTAxNGMnOiAnTycsICAnXFx1MDE0ZSc6ICdPJywgJ1xcdTAxNTAnOiAnTycsXG4gICAgJ1xcdTAxNGQnOiAnbycsICAnXFx1MDE0Zic6ICdvJywgJ1xcdTAxNTEnOiAnbycsXG4gICAgJ1xcdTAxNTQnOiAnUicsICAnXFx1MDE1Nic6ICdSJywgJ1xcdTAxNTgnOiAnUicsXG4gICAgJ1xcdTAxNTUnOiAncicsICAnXFx1MDE1Nyc6ICdyJywgJ1xcdTAxNTknOiAncicsXG4gICAgJ1xcdTAxNWEnOiAnUycsICAnXFx1MDE1Yyc6ICdTJywgJ1xcdTAxNWUnOiAnUycsICdcXHUwMTYwJzogJ1MnLFxuICAgICdcXHUwMTViJzogJ3MnLCAgJ1xcdTAxNWQnOiAncycsICdcXHUwMTVmJzogJ3MnLCAnXFx1MDE2MSc6ICdzJyxcbiAgICAnXFx1MDE2Mic6ICdUJywgICdcXHUwMTY0JzogJ1QnLCAnXFx1MDE2Nic6ICdUJyxcbiAgICAnXFx1MDE2Myc6ICd0JywgICdcXHUwMTY1JzogJ3QnLCAnXFx1MDE2Nyc6ICd0JyxcbiAgICAnXFx1MDE2OCc6ICdVJywgICdcXHUwMTZhJzogJ1UnLCAnXFx1MDE2Yyc6ICdVJywgJ1xcdTAxNmUnOiAnVScsICdcXHUwMTcwJzogJ1UnLCAnXFx1MDE3Mic6ICdVJyxcbiAgICAnXFx1MDE2OSc6ICd1JywgICdcXHUwMTZiJzogJ3UnLCAnXFx1MDE2ZCc6ICd1JywgJ1xcdTAxNmYnOiAndScsICdcXHUwMTcxJzogJ3UnLCAnXFx1MDE3Myc6ICd1JyxcbiAgICAnXFx1MDE3NCc6ICdXJywgICdcXHUwMTc1JzogJ3cnLFxuICAgICdcXHUwMTc2JzogJ1knLCAgJ1xcdTAxNzcnOiAneScsICdcXHUwMTc4JzogJ1knLFxuICAgICdcXHUwMTc5JzogJ1onLCAgJ1xcdTAxN2InOiAnWicsICdcXHUwMTdkJzogJ1onLFxuICAgICdcXHUwMTdhJzogJ3onLCAgJ1xcdTAxN2MnOiAneicsICdcXHUwMTdlJzogJ3onLFxuICAgICdcXHUwMTMyJzogJ0lKJywgJ1xcdTAxMzMnOiAnaWonLFxuICAgICdcXHUwMTUyJzogJ09lJywgJ1xcdTAxNTMnOiAnb2UnLFxuICAgICdcXHUwMTQ5JzogXCInblwiLCAnXFx1MDE3Zic6ICdzJ1xuICB9O1xuXG4gIC8qKiBVc2VkIHRvIG1hcCBjaGFyYWN0ZXJzIHRvIEhUTUwgZW50aXRpZXMuICovXG4gIHZhciBodG1sRXNjYXBlcyA9IHtcbiAgICAnJic6ICcmYW1wOycsXG4gICAgJzwnOiAnJmx0OycsXG4gICAgJz4nOiAnJmd0OycsXG4gICAgJ1wiJzogJyZxdW90OycsXG4gICAgXCInXCI6ICcmIzM5OydcbiAgfTtcblxuICAvKiogVXNlZCB0byBtYXAgSFRNTCBlbnRpdGllcyB0byBjaGFyYWN0ZXJzLiAqL1xuICB2YXIgaHRtbFVuZXNjYXBlcyA9IHtcbiAgICAnJmFtcDsnOiAnJicsXG4gICAgJyZsdDsnOiAnPCcsXG4gICAgJyZndDsnOiAnPicsXG4gICAgJyZxdW90Oyc6ICdcIicsXG4gICAgJyYjMzk7JzogXCInXCJcbiAgfTtcblxuICAvKiogVXNlZCB0byBlc2NhcGUgY2hhcmFjdGVycyBmb3IgaW5jbHVzaW9uIGluIGNvbXBpbGVkIHN0cmluZyBsaXRlcmFscy4gKi9cbiAgdmFyIHN0cmluZ0VzY2FwZXMgPSB7XG4gICAgJ1xcXFwnOiAnXFxcXCcsXG4gICAgXCInXCI6IFwiJ1wiLFxuICAgICdcXG4nOiAnbicsXG4gICAgJ1xccic6ICdyJyxcbiAgICAnXFx1MjAyOCc6ICd1MjAyOCcsXG4gICAgJ1xcdTIwMjknOiAndTIwMjknXG4gIH07XG5cbiAgLyoqIEJ1aWx0LWluIG1ldGhvZCByZWZlcmVuY2VzIHdpdGhvdXQgYSBkZXBlbmRlbmN5IG9uIGByb290YC4gKi9cbiAgdmFyIGZyZWVQYXJzZUZsb2F0ID0gcGFyc2VGbG9hdCxcbiAgICAgIGZyZWVQYXJzZUludCA9IHBhcnNlSW50O1xuXG4gIC8qKiBEZXRlY3QgZnJlZSB2YXJpYWJsZSBgZ2xvYmFsYCBmcm9tIE5vZGUuanMuICovXG4gIHZhciBmcmVlR2xvYmFsID0gdHlwZW9mIGdsb2JhbCA9PSAnb2JqZWN0JyAmJiBnbG9iYWwgJiYgZ2xvYmFsLk9iamVjdCA9PT0gT2JqZWN0ICYmIGdsb2JhbDtcblxuICAvKiogRGV0ZWN0IGZyZWUgdmFyaWFibGUgYHNlbGZgLiAqL1xuICB2YXIgZnJlZVNlbGYgPSB0eXBlb2Ygc2VsZiA9PSAnb2JqZWN0JyAmJiBzZWxmICYmIHNlbGYuT2JqZWN0ID09PSBPYmplY3QgJiYgc2VsZjtcblxuICAvKiogVXNlZCBhcyBhIHJlZmVyZW5jZSB0byB0aGUgZ2xvYmFsIG9iamVjdC4gKi9cbiAgdmFyIHJvb3QgPSBmcmVlR2xvYmFsIHx8IGZyZWVTZWxmIHx8IEZ1bmN0aW9uKCdyZXR1cm4gdGhpcycpKCk7XG5cbiAgLyoqIERldGVjdCBmcmVlIHZhcmlhYmxlIGBleHBvcnRzYC4gKi9cbiAgdmFyIGZyZWVFeHBvcnRzID0gdHlwZW9mIGV4cG9ydHMgPT0gJ29iamVjdCcgJiYgZXhwb3J0cyAmJiAhZXhwb3J0cy5ub2RlVHlwZSAmJiBleHBvcnRzO1xuXG4gIC8qKiBEZXRlY3QgZnJlZSB2YXJpYWJsZSBgbW9kdWxlYC4gKi9cbiAgdmFyIGZyZWVNb2R1bGUgPSBmcmVlRXhwb3J0cyAmJiB0eXBlb2YgbW9kdWxlID09ICdvYmplY3QnICYmIG1vZHVsZSAmJiAhbW9kdWxlLm5vZGVUeXBlICYmIG1vZHVsZTtcblxuICAvKiogRGV0ZWN0IHRoZSBwb3B1bGFyIENvbW1vbkpTIGV4dGVuc2lvbiBgbW9kdWxlLmV4cG9ydHNgLiAqL1xuICB2YXIgbW9kdWxlRXhwb3J0cyA9IGZyZWVNb2R1bGUgJiYgZnJlZU1vZHVsZS5leHBvcnRzID09PSBmcmVlRXhwb3J0cztcblxuICAvKiogRGV0ZWN0IGZyZWUgdmFyaWFibGUgYHByb2Nlc3NgIGZyb20gTm9kZS5qcy4gKi9cbiAgdmFyIGZyZWVQcm9jZXNzID0gbW9kdWxlRXhwb3J0cyAmJiBmcmVlR2xvYmFsLnByb2Nlc3M7XG5cbiAgLyoqIFVzZWQgdG8gYWNjZXNzIGZhc3RlciBOb2RlLmpzIGhlbHBlcnMuICovXG4gIHZhciBub2RlVXRpbCA9IChmdW5jdGlvbigpIHtcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIGZyZWVQcm9jZXNzICYmIGZyZWVQcm9jZXNzLmJpbmRpbmcgJiYgZnJlZVByb2Nlc3MuYmluZGluZygndXRpbCcpO1xuICAgIH0gY2F0Y2ggKGUpIHt9XG4gIH0oKSk7XG5cbiAgLyogTm9kZS5qcyBoZWxwZXIgcmVmZXJlbmNlcy4gKi9cbiAgdmFyIG5vZGVJc0FycmF5QnVmZmVyID0gbm9kZVV0aWwgJiYgbm9kZVV0aWwuaXNBcnJheUJ1ZmZlcixcbiAgICAgIG5vZGVJc0RhdGUgPSBub2RlVXRpbCAmJiBub2RlVXRpbC5pc0RhdGUsXG4gICAgICBub2RlSXNNYXAgPSBub2RlVXRpbCAmJiBub2RlVXRpbC5pc01hcCxcbiAgICAgIG5vZGVJc1JlZ0V4cCA9IG5vZGVVdGlsICYmIG5vZGVVdGlsLmlzUmVnRXhwLFxuICAgICAgbm9kZUlzU2V0ID0gbm9kZVV0aWwgJiYgbm9kZVV0aWwuaXNTZXQsXG4gICAgICBub2RlSXNUeXBlZEFycmF5ID0gbm9kZVV0aWwgJiYgbm9kZVV0aWwuaXNUeXBlZEFycmF5O1xuXG4gIC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG4gIC8qKlxuICAgKiBBIGZhc3RlciBhbHRlcm5hdGl2ZSB0byBgRnVuY3Rpb24jYXBwbHlgLCB0aGlzIGZ1bmN0aW9uIGludm9rZXMgYGZ1bmNgXG4gICAqIHdpdGggdGhlIGB0aGlzYCBiaW5kaW5nIG9mIGB0aGlzQXJnYCBhbmQgdGhlIGFyZ3VtZW50cyBvZiBgYXJnc2AuXG4gICAqXG4gICAqIEBwcml2YXRlXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IGZ1bmMgVGhlIGZ1bmN0aW9uIHRvIGludm9rZS5cbiAgICogQHBhcmFtIHsqfSB0aGlzQXJnIFRoZSBgdGhpc2AgYmluZGluZyBvZiBgZnVuY2AuXG4gICAqIEBwYXJhbSB7QXJyYXl9IGFyZ3MgVGhlIGFyZ3VtZW50cyB0byBpbnZva2UgYGZ1bmNgIHdpdGguXG4gICAqIEByZXR1cm5zIHsqfSBSZXR1cm5zIHRoZSByZXN1bHQgb2YgYGZ1bmNgLlxuICAgKi9cbiAgZnVuY3Rpb24gYXBwbHkoZnVuYywgdGhpc0FyZywgYXJncykge1xuICAgIHN3aXRjaCAoYXJncy5sZW5ndGgpIHtcbiAgICAgIGNhc2UgMDogcmV0dXJuIGZ1bmMuY2FsbCh0aGlzQXJnKTtcbiAgICAgIGNhc2UgMTogcmV0dXJuIGZ1bmMuY2FsbCh0aGlzQXJnLCBhcmdzWzBdKTtcbiAgICAgIGNhc2UgMjogcmV0dXJuIGZ1bmMuY2FsbCh0aGlzQXJnLCBhcmdzWzBdLCBhcmdzWzFdKTtcbiAgICAgIGNhc2UgMzogcmV0dXJuIGZ1bmMuY2FsbCh0aGlzQXJnLCBhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdKTtcbiAgICB9XG4gICAgcmV0dXJuIGZ1bmMuYXBwbHkodGhpc0FyZywgYXJncyk7XG4gIH1cblxuICAvKipcbiAgICogQSBzcGVjaWFsaXplZCB2ZXJzaW9uIG9mIGBiYXNlQWdncmVnYXRvcmAgZm9yIGFycmF5cy5cbiAgICpcbiAgICogQHByaXZhdGVcbiAgICogQHBhcmFtIHtBcnJheX0gW2FycmF5XSBUaGUgYXJyYXkgdG8gaXRlcmF0ZSBvdmVyLlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBzZXR0ZXIgVGhlIGZ1bmN0aW9uIHRvIHNldCBgYWNjdW11bGF0b3JgIHZhbHVlcy5cbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gaXRlcmF0ZWUgVGhlIGl0ZXJhdGVlIHRvIHRyYW5zZm9ybSBrZXlzLlxuICAgKiBAcGFyYW0ge09iamVjdH0gYWNjdW11bGF0b3IgVGhlIGluaXRpYWwgYWdncmVnYXRlZCBvYmplY3QuXG4gICAqIEByZXR1cm5zIHtGdW5jdGlvbn0gUmV0dXJucyBgYWNjdW11bGF0b3JgLlxuICAgKi9cbiAgZnVuY3Rpb24gYXJyYXlBZ2dyZWdhdG9yKGFycmF5LCBzZXR0ZXIsIGl0ZXJhdGVlLCBhY2N1bXVsYXRvcikge1xuICAgIHZhciBpbmRleCA9IC0xLFxuICAgICAgICBsZW5ndGggPSBhcnJheSA9PSBudWxsID8gMCA6IGFycmF5Lmxlbmd0aDtcblxuICAgIHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG4gICAgICB2YXIgdmFsdWUgPSBhcnJheVtpbmRleF07XG4gICAgICBzZXR0ZXIoYWNjdW11bGF0b3IsIHZhbHVlLCBpdGVyYXRlZSh2YWx1ZSksIGFycmF5KTtcbiAgICB9XG4gICAgcmV0dXJuIGFjY3VtdWxhdG9yO1xuICB9XG5cbiAgLyoqXG4gICAqIEEgc3BlY2lhbGl6ZWQgdmVyc2lvbiBvZiBgXy5mb3JFYWNoYCBmb3IgYXJyYXlzIHdpdGhvdXQgc3VwcG9ydCBmb3JcbiAgICogaXRlcmF0ZWUgc2hvcnRoYW5kcy5cbiAgICpcbiAgICogQHByaXZhdGVcbiAgICogQHBhcmFtIHtBcnJheX0gW2FycmF5XSBUaGUgYXJyYXkgdG8gaXRlcmF0ZSBvdmVyLlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBpdGVyYXRlZSBUaGUgZnVuY3Rpb24gaW52b2tlZCBwZXIgaXRlcmF0aW9uLlxuICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgYGFycmF5YC5cbiAgICovXG4gIGZ1bmN0aW9uIGFycmF5RWFjaChhcnJheSwgaXRlcmF0ZWUpIHtcbiAgICB2YXIgaW5kZXggPSAtMSxcbiAgICAgICAgbGVuZ3RoID0gYXJyYXkgPT0gbnVsbCA/IDAgOiBhcnJheS5sZW5ndGg7XG5cbiAgICB3aGlsZSAoKytpbmRleCA8IGxlbmd0aCkge1xuICAgICAgaWYgKGl0ZXJhdGVlKGFycmF5W2luZGV4XSwgaW5kZXgsIGFycmF5KSA9PT0gZmFsc2UpIHtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBhcnJheTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBIHNwZWNpYWxpemVkIHZlcnNpb24gb2YgYF8uZm9yRWFjaFJpZ2h0YCBmb3IgYXJyYXlzIHdpdGhvdXQgc3VwcG9ydCBmb3JcbiAgICogaXRlcmF0ZWUgc2hvcnRoYW5kcy5cbiAgICpcbiAgICogQHByaXZhdGVcbiAgICogQHBhcmFtIHtBcnJheX0gW2FycmF5XSBUaGUgYXJyYXkgdG8gaXRlcmF0ZSBvdmVyLlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBpdGVyYXRlZSBUaGUgZnVuY3Rpb24gaW52b2tlZCBwZXIgaXRlcmF0aW9uLlxuICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgYGFycmF5YC5cbiAgICovXG4gIGZ1bmN0aW9uIGFycmF5RWFjaFJpZ2h0KGFycmF5LCBpdGVyYXRlZSkge1xuICAgIHZhciBsZW5ndGggPSBhcnJheSA9PSBudWxsID8gMCA6IGFycmF5Lmxlbmd0aDtcblxuICAgIHdoaWxlIChsZW5ndGgtLSkge1xuICAgICAgaWYgKGl0ZXJhdGVlKGFycmF5W2xlbmd0aF0sIGxlbmd0aCwgYXJyYXkpID09PSBmYWxzZSkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGFycmF5O1xuICB9XG5cbiAgLyoqXG4gICAqIEEgc3BlY2lhbGl6ZWQgdmVyc2lvbiBvZiBgXy5ldmVyeWAgZm9yIGFycmF5cyB3aXRob3V0IHN1cHBvcnQgZm9yXG4gICAqIGl0ZXJhdGVlIHNob3J0aGFuZHMuXG4gICAqXG4gICAqIEBwcml2YXRlXG4gICAqIEBwYXJhbSB7QXJyYXl9IFthcnJheV0gVGhlIGFycmF5IHRvIGl0ZXJhdGUgb3Zlci5cbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gcHJlZGljYXRlIFRoZSBmdW5jdGlvbiBpbnZva2VkIHBlciBpdGVyYXRpb24uXG4gICAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBhbGwgZWxlbWVudHMgcGFzcyB0aGUgcHJlZGljYXRlIGNoZWNrLFxuICAgKiAgZWxzZSBgZmFsc2VgLlxuICAgKi9cbiAgZnVuY3Rpb24gYXJyYXlFdmVyeShhcnJheSwgcHJlZGljYXRlKSB7XG4gICAgdmFyIGluZGV4ID0gLTEsXG4gICAgICAgIGxlbmd0aCA9IGFycmF5ID09IG51bGwgPyAwIDogYXJyYXkubGVuZ3RoO1xuXG4gICAgd2hpbGUgKCsraW5kZXggPCBsZW5ndGgpIHtcbiAgICAgIGlmICghcHJlZGljYXRlKGFycmF5W2luZGV4XSwgaW5kZXgsIGFycmF5KSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgLyoqXG4gICAqIEEgc3BlY2lhbGl6ZWQgdmVyc2lvbiBvZiBgXy5maWx0ZXJgIGZvciBhcnJheXMgd2l0aG91dCBzdXBwb3J0IGZvclxuICAgKiBpdGVyYXRlZSBzaG9ydGhhbmRzLlxuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAcGFyYW0ge0FycmF5fSBbYXJyYXldIFRoZSBhcnJheSB0byBpdGVyYXRlIG92ZXIuXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IHByZWRpY2F0ZSBUaGUgZnVuY3Rpb24gaW52b2tlZCBwZXIgaXRlcmF0aW9uLlxuICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgdGhlIG5ldyBmaWx0ZXJlZCBhcnJheS5cbiAgICovXG4gIGZ1bmN0aW9uIGFycmF5RmlsdGVyKGFycmF5LCBwcmVkaWNhdGUpIHtcbiAgICB2YXIgaW5kZXggPSAtMSxcbiAgICAgICAgbGVuZ3RoID0gYXJyYXkgPT0gbnVsbCA/IDAgOiBhcnJheS5sZW5ndGgsXG4gICAgICAgIHJlc0luZGV4ID0gMCxcbiAgICAgICAgcmVzdWx0ID0gW107XG5cbiAgICB3aGlsZSAoKytpbmRleCA8IGxlbmd0aCkge1xuICAgICAgdmFyIHZhbHVlID0gYXJyYXlbaW5kZXhdO1xuICAgICAgaWYgKHByZWRpY2F0ZSh2YWx1ZSwgaW5kZXgsIGFycmF5KSkge1xuICAgICAgICByZXN1bHRbcmVzSW5kZXgrK10gPSB2YWx1ZTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIC8qKlxuICAgKiBBIHNwZWNpYWxpemVkIHZlcnNpb24gb2YgYF8uaW5jbHVkZXNgIGZvciBhcnJheXMgd2l0aG91dCBzdXBwb3J0IGZvclxuICAgKiBzcGVjaWZ5aW5nIGFuIGluZGV4IHRvIHNlYXJjaCBmcm9tLlxuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAcGFyYW0ge0FycmF5fSBbYXJyYXldIFRoZSBhcnJheSB0byBpbnNwZWN0LlxuICAgKiBAcGFyYW0geyp9IHRhcmdldCBUaGUgdmFsdWUgdG8gc2VhcmNoIGZvci5cbiAgICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGB0YXJnZXRgIGlzIGZvdW5kLCBlbHNlIGBmYWxzZWAuXG4gICAqL1xuICBmdW5jdGlvbiBhcnJheUluY2x1ZGVzKGFycmF5LCB2YWx1ZSkge1xuICAgIHZhciBsZW5ndGggPSBhcnJheSA9PSBudWxsID8gMCA6IGFycmF5Lmxlbmd0aDtcbiAgICByZXR1cm4gISFsZW5ndGggJiYgYmFzZUluZGV4T2YoYXJyYXksIHZhbHVlLCAwKSA+IC0xO1xuICB9XG5cbiAgLyoqXG4gICAqIFRoaXMgZnVuY3Rpb24gaXMgbGlrZSBgYXJyYXlJbmNsdWRlc2AgZXhjZXB0IHRoYXQgaXQgYWNjZXB0cyBhIGNvbXBhcmF0b3IuXG4gICAqXG4gICAqIEBwcml2YXRlXG4gICAqIEBwYXJhbSB7QXJyYXl9IFthcnJheV0gVGhlIGFycmF5IHRvIGluc3BlY3QuXG4gICAqIEBwYXJhbSB7Kn0gdGFyZ2V0IFRoZSB2YWx1ZSB0byBzZWFyY2ggZm9yLlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjb21wYXJhdG9yIFRoZSBjb21wYXJhdG9yIGludm9rZWQgcGVyIGVsZW1lbnQuXG4gICAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBgdGFyZ2V0YCBpcyBmb3VuZCwgZWxzZSBgZmFsc2VgLlxuICAgKi9cbiAgZnVuY3Rpb24gYXJyYXlJbmNsdWRlc1dpdGgoYXJyYXksIHZhbHVlLCBjb21wYXJhdG9yKSB7XG4gICAgdmFyIGluZGV4ID0gLTEsXG4gICAgICAgIGxlbmd0aCA9IGFycmF5ID09IG51bGwgPyAwIDogYXJyYXkubGVuZ3RoO1xuXG4gICAgd2hpbGUgKCsraW5kZXggPCBsZW5ndGgpIHtcbiAgICAgIGlmIChjb21wYXJhdG9yKHZhbHVlLCBhcnJheVtpbmRleF0pKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICAvKipcbiAgICogQSBzcGVjaWFsaXplZCB2ZXJzaW9uIG9mIGBfLm1hcGAgZm9yIGFycmF5cyB3aXRob3V0IHN1cHBvcnQgZm9yIGl0ZXJhdGVlXG4gICAqIHNob3J0aGFuZHMuXG4gICAqXG4gICAqIEBwcml2YXRlXG4gICAqIEBwYXJhbSB7QXJyYXl9IFthcnJheV0gVGhlIGFycmF5IHRvIGl0ZXJhdGUgb3Zlci5cbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gaXRlcmF0ZWUgVGhlIGZ1bmN0aW9uIGludm9rZWQgcGVyIGl0ZXJhdGlvbi5cbiAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIHRoZSBuZXcgbWFwcGVkIGFycmF5LlxuICAgKi9cbiAgZnVuY3Rpb24gYXJyYXlNYXAoYXJyYXksIGl0ZXJhdGVlKSB7XG4gICAgdmFyIGluZGV4ID0gLTEsXG4gICAgICAgIGxlbmd0aCA9IGFycmF5ID09IG51bGwgPyAwIDogYXJyYXkubGVuZ3RoLFxuICAgICAgICByZXN1bHQgPSBBcnJheShsZW5ndGgpO1xuXG4gICAgd2hpbGUgKCsraW5kZXggPCBsZW5ndGgpIHtcbiAgICAgIHJlc3VsdFtpbmRleF0gPSBpdGVyYXRlZShhcnJheVtpbmRleF0sIGluZGV4LCBhcnJheSk7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICAvKipcbiAgICogQXBwZW5kcyB0aGUgZWxlbWVudHMgb2YgYHZhbHVlc2AgdG8gYGFycmF5YC5cbiAgICpcbiAgICogQHByaXZhdGVcbiAgICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIGFycmF5IHRvIG1vZGlmeS5cbiAgICogQHBhcmFtIHtBcnJheX0gdmFsdWVzIFRoZSB2YWx1ZXMgdG8gYXBwZW5kLlxuICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgYGFycmF5YC5cbiAgICovXG4gIGZ1bmN0aW9uIGFycmF5UHVzaChhcnJheSwgdmFsdWVzKSB7XG4gICAgdmFyIGluZGV4ID0gLTEsXG4gICAgICAgIGxlbmd0aCA9IHZhbHVlcy5sZW5ndGgsXG4gICAgICAgIG9mZnNldCA9IGFycmF5Lmxlbmd0aDtcblxuICAgIHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG4gICAgICBhcnJheVtvZmZzZXQgKyBpbmRleF0gPSB2YWx1ZXNbaW5kZXhdO1xuICAgIH1cbiAgICByZXR1cm4gYXJyYXk7XG4gIH1cblxuICAvKipcbiAgICogQSBzcGVjaWFsaXplZCB2ZXJzaW9uIG9mIGBfLnJlZHVjZWAgZm9yIGFycmF5cyB3aXRob3V0IHN1cHBvcnQgZm9yXG4gICAqIGl0ZXJhdGVlIHNob3J0aGFuZHMuXG4gICAqXG4gICAqIEBwcml2YXRlXG4gICAqIEBwYXJhbSB7QXJyYXl9IFthcnJheV0gVGhlIGFycmF5IHRvIGl0ZXJhdGUgb3Zlci5cbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gaXRlcmF0ZWUgVGhlIGZ1bmN0aW9uIGludm9rZWQgcGVyIGl0ZXJhdGlvbi5cbiAgICogQHBhcmFtIHsqfSBbYWNjdW11bGF0b3JdIFRoZSBpbml0aWFsIHZhbHVlLlxuICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtpbml0QWNjdW1dIFNwZWNpZnkgdXNpbmcgdGhlIGZpcnN0IGVsZW1lbnQgb2YgYGFycmF5YCBhc1xuICAgKiAgdGhlIGluaXRpYWwgdmFsdWUuXG4gICAqIEByZXR1cm5zIHsqfSBSZXR1cm5zIHRoZSBhY2N1bXVsYXRlZCB2YWx1ZS5cbiAgICovXG4gIGZ1bmN0aW9uIGFycmF5UmVkdWNlKGFycmF5LCBpdGVyYXRlZSwgYWNjdW11bGF0b3IsIGluaXRBY2N1bSkge1xuICAgIHZhciBpbmRleCA9IC0xLFxuICAgICAgICBsZW5ndGggPSBhcnJheSA9PSBudWxsID8gMCA6IGFycmF5Lmxlbmd0aDtcblxuICAgIGlmIChpbml0QWNjdW0gJiYgbGVuZ3RoKSB7XG4gICAgICBhY2N1bXVsYXRvciA9IGFycmF5WysraW5kZXhdO1xuICAgIH1cbiAgICB3aGlsZSAoKytpbmRleCA8IGxlbmd0aCkge1xuICAgICAgYWNjdW11bGF0b3IgPSBpdGVyYXRlZShhY2N1bXVsYXRvciwgYXJyYXlbaW5kZXhdLCBpbmRleCwgYXJyYXkpO1xuICAgIH1cbiAgICByZXR1cm4gYWNjdW11bGF0b3I7XG4gIH1cblxuICAvKipcbiAgICogQSBzcGVjaWFsaXplZCB2ZXJzaW9uIG9mIGBfLnJlZHVjZVJpZ2h0YCBmb3IgYXJyYXlzIHdpdGhvdXQgc3VwcG9ydCBmb3JcbiAgICogaXRlcmF0ZWUgc2hvcnRoYW5kcy5cbiAgICpcbiAgICogQHByaXZhdGVcbiAgICogQHBhcmFtIHtBcnJheX0gW2FycmF5XSBUaGUgYXJyYXkgdG8gaXRlcmF0ZSBvdmVyLlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBpdGVyYXRlZSBUaGUgZnVuY3Rpb24gaW52b2tlZCBwZXIgaXRlcmF0aW9uLlxuICAgKiBAcGFyYW0geyp9IFthY2N1bXVsYXRvcl0gVGhlIGluaXRpYWwgdmFsdWUuXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gW2luaXRBY2N1bV0gU3BlY2lmeSB1c2luZyB0aGUgbGFzdCBlbGVtZW50IG9mIGBhcnJheWAgYXNcbiAgICogIHRoZSBpbml0aWFsIHZhbHVlLlxuICAgKiBAcmV0dXJucyB7Kn0gUmV0dXJucyB0aGUgYWNjdW11bGF0ZWQgdmFsdWUuXG4gICAqL1xuICBmdW5jdGlvbiBhcnJheVJlZHVjZVJpZ2h0KGFycmF5LCBpdGVyYXRlZSwgYWNjdW11bGF0b3IsIGluaXRBY2N1bSkge1xuICAgIHZhciBsZW5ndGggPSBhcnJheSA9PSBudWxsID8gMCA6IGFycmF5Lmxlbmd0aDtcbiAgICBpZiAoaW5pdEFjY3VtICYmIGxlbmd0aCkge1xuICAgICAgYWNjdW11bGF0b3IgPSBhcnJheVstLWxlbmd0aF07XG4gICAgfVxuICAgIHdoaWxlIChsZW5ndGgtLSkge1xuICAgICAgYWNjdW11bGF0b3IgPSBpdGVyYXRlZShhY2N1bXVsYXRvciwgYXJyYXlbbGVuZ3RoXSwgbGVuZ3RoLCBhcnJheSk7XG4gICAgfVxuICAgIHJldHVybiBhY2N1bXVsYXRvcjtcbiAgfVxuXG4gIC8qKlxuICAgKiBBIHNwZWNpYWxpemVkIHZlcnNpb24gb2YgYF8uc29tZWAgZm9yIGFycmF5cyB3aXRob3V0IHN1cHBvcnQgZm9yIGl0ZXJhdGVlXG4gICAqIHNob3J0aGFuZHMuXG4gICAqXG4gICAqIEBwcml2YXRlXG4gICAqIEBwYXJhbSB7QXJyYXl9IFthcnJheV0gVGhlIGFycmF5IHRvIGl0ZXJhdGUgb3Zlci5cbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gcHJlZGljYXRlIFRoZSBmdW5jdGlvbiBpbnZva2VkIHBlciBpdGVyYXRpb24uXG4gICAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBhbnkgZWxlbWVudCBwYXNzZXMgdGhlIHByZWRpY2F0ZSBjaGVjayxcbiAgICogIGVsc2UgYGZhbHNlYC5cbiAgICovXG4gIGZ1bmN0aW9uIGFycmF5U29tZShhcnJheSwgcHJlZGljYXRlKSB7XG4gICAgdmFyIGluZGV4ID0gLTEsXG4gICAgICAgIGxlbmd0aCA9IGFycmF5ID09IG51bGwgPyAwIDogYXJyYXkubGVuZ3RoO1xuXG4gICAgd2hpbGUgKCsraW5kZXggPCBsZW5ndGgpIHtcbiAgICAgIGlmIChwcmVkaWNhdGUoYXJyYXlbaW5kZXhdLCBpbmRleCwgYXJyYXkpKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICAvKipcbiAgICogR2V0cyB0aGUgc2l6ZSBvZiBhbiBBU0NJSSBgc3RyaW5nYC5cbiAgICpcbiAgICogQHByaXZhdGVcbiAgICogQHBhcmFtIHtzdHJpbmd9IHN0cmluZyBUaGUgc3RyaW5nIGluc3BlY3QuXG4gICAqIEByZXR1cm5zIHtudW1iZXJ9IFJldHVybnMgdGhlIHN0cmluZyBzaXplLlxuICAgKi9cbiAgdmFyIGFzY2lpU2l6ZSA9IGJhc2VQcm9wZXJ0eSgnbGVuZ3RoJyk7XG5cbiAgLyoqXG4gICAqIENvbnZlcnRzIGFuIEFTQ0lJIGBzdHJpbmdgIHRvIGFuIGFycmF5LlxuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAcGFyYW0ge3N0cmluZ30gc3RyaW5nIFRoZSBzdHJpbmcgdG8gY29udmVydC5cbiAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIHRoZSBjb252ZXJ0ZWQgYXJyYXkuXG4gICAqL1xuICBmdW5jdGlvbiBhc2NpaVRvQXJyYXkoc3RyaW5nKSB7XG4gICAgcmV0dXJuIHN0cmluZy5zcGxpdCgnJyk7XG4gIH1cblxuICAvKipcbiAgICogU3BsaXRzIGFuIEFTQ0lJIGBzdHJpbmdgIGludG8gYW4gYXJyYXkgb2YgaXRzIHdvcmRzLlxuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAcGFyYW0ge3N0cmluZ30gVGhlIHN0cmluZyB0byBpbnNwZWN0LlxuICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgdGhlIHdvcmRzIG9mIGBzdHJpbmdgLlxuICAgKi9cbiAgZnVuY3Rpb24gYXNjaWlXb3JkcyhzdHJpbmcpIHtcbiAgICByZXR1cm4gc3RyaW5nLm1hdGNoKHJlQXNjaWlXb3JkKSB8fCBbXTtcbiAgfVxuXG4gIC8qKlxuICAgKiBUaGUgYmFzZSBpbXBsZW1lbnRhdGlvbiBvZiBtZXRob2RzIGxpa2UgYF8uZmluZEtleWAgYW5kIGBfLmZpbmRMYXN0S2V5YCxcbiAgICogd2l0aG91dCBzdXBwb3J0IGZvciBpdGVyYXRlZSBzaG9ydGhhbmRzLCB3aGljaCBpdGVyYXRlcyBvdmVyIGBjb2xsZWN0aW9uYFxuICAgKiB1c2luZyBgZWFjaEZ1bmNgLlxuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAcGFyYW0ge0FycmF5fE9iamVjdH0gY29sbGVjdGlvbiBUaGUgY29sbGVjdGlvbiB0byBpbnNwZWN0LlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBwcmVkaWNhdGUgVGhlIGZ1bmN0aW9uIGludm9rZWQgcGVyIGl0ZXJhdGlvbi5cbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gZWFjaEZ1bmMgVGhlIGZ1bmN0aW9uIHRvIGl0ZXJhdGUgb3ZlciBgY29sbGVjdGlvbmAuXG4gICAqIEByZXR1cm5zIHsqfSBSZXR1cm5zIHRoZSBmb3VuZCBlbGVtZW50IG9yIGl0cyBrZXksIGVsc2UgYHVuZGVmaW5lZGAuXG4gICAqL1xuICBmdW5jdGlvbiBiYXNlRmluZEtleShjb2xsZWN0aW9uLCBwcmVkaWNhdGUsIGVhY2hGdW5jKSB7XG4gICAgdmFyIHJlc3VsdDtcbiAgICBlYWNoRnVuYyhjb2xsZWN0aW9uLCBmdW5jdGlvbih2YWx1ZSwga2V5LCBjb2xsZWN0aW9uKSB7XG4gICAgICBpZiAocHJlZGljYXRlKHZhbHVlLCBrZXksIGNvbGxlY3Rpb24pKSB7XG4gICAgICAgIHJlc3VsdCA9IGtleTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICAvKipcbiAgICogVGhlIGJhc2UgaW1wbGVtZW50YXRpb24gb2YgYF8uZmluZEluZGV4YCBhbmQgYF8uZmluZExhc3RJbmRleGAgd2l0aG91dFxuICAgKiBzdXBwb3J0IGZvciBpdGVyYXRlZSBzaG9ydGhhbmRzLlxuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAcGFyYW0ge0FycmF5fSBhcnJheSBUaGUgYXJyYXkgdG8gaW5zcGVjdC5cbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gcHJlZGljYXRlIFRoZSBmdW5jdGlvbiBpbnZva2VkIHBlciBpdGVyYXRpb24uXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBmcm9tSW5kZXggVGhlIGluZGV4IHRvIHNlYXJjaCBmcm9tLlxuICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtmcm9tUmlnaHRdIFNwZWNpZnkgaXRlcmF0aW5nIGZyb20gcmlnaHQgdG8gbGVmdC5cbiAgICogQHJldHVybnMge251bWJlcn0gUmV0dXJucyB0aGUgaW5kZXggb2YgdGhlIG1hdGNoZWQgdmFsdWUsIGVsc2UgYC0xYC5cbiAgICovXG4gIGZ1bmN0aW9uIGJhc2VGaW5kSW5kZXgoYXJyYXksIHByZWRpY2F0ZSwgZnJvbUluZGV4LCBmcm9tUmlnaHQpIHtcbiAgICB2YXIgbGVuZ3RoID0gYXJyYXkubGVuZ3RoLFxuICAgICAgICBpbmRleCA9IGZyb21JbmRleCArIChmcm9tUmlnaHQgPyAxIDogLTEpO1xuXG4gICAgd2hpbGUgKChmcm9tUmlnaHQgPyBpbmRleC0tIDogKytpbmRleCA8IGxlbmd0aCkpIHtcbiAgICAgIGlmIChwcmVkaWNhdGUoYXJyYXlbaW5kZXhdLCBpbmRleCwgYXJyYXkpKSB7XG4gICAgICAgIHJldHVybiBpbmRleDtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIC0xO1xuICB9XG5cbiAgLyoqXG4gICAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBfLmluZGV4T2ZgIHdpdGhvdXQgYGZyb21JbmRleGAgYm91bmRzIGNoZWNrcy5cbiAgICpcbiAgICogQHByaXZhdGVcbiAgICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIGFycmF5IHRvIGluc3BlY3QuXG4gICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIHNlYXJjaCBmb3IuXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBmcm9tSW5kZXggVGhlIGluZGV4IHRvIHNlYXJjaCBmcm9tLlxuICAgKiBAcmV0dXJucyB7bnVtYmVyfSBSZXR1cm5zIHRoZSBpbmRleCBvZiB0aGUgbWF0Y2hlZCB2YWx1ZSwgZWxzZSBgLTFgLlxuICAgKi9cbiAgZnVuY3Rpb24gYmFzZUluZGV4T2YoYXJyYXksIHZhbHVlLCBmcm9tSW5kZXgpIHtcbiAgICByZXR1cm4gdmFsdWUgPT09IHZhbHVlXG4gICAgICA/IHN0cmljdEluZGV4T2YoYXJyYXksIHZhbHVlLCBmcm9tSW5kZXgpXG4gICAgICA6IGJhc2VGaW5kSW5kZXgoYXJyYXksIGJhc2VJc05hTiwgZnJvbUluZGV4KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBUaGlzIGZ1bmN0aW9uIGlzIGxpa2UgYGJhc2VJbmRleE9mYCBleGNlcHQgdGhhdCBpdCBhY2NlcHRzIGEgY29tcGFyYXRvci5cbiAgICpcbiAgICogQHByaXZhdGVcbiAgICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIGFycmF5IHRvIGluc3BlY3QuXG4gICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIHNlYXJjaCBmb3IuXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBmcm9tSW5kZXggVGhlIGluZGV4IHRvIHNlYXJjaCBmcm9tLlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjb21wYXJhdG9yIFRoZSBjb21wYXJhdG9yIGludm9rZWQgcGVyIGVsZW1lbnQuXG4gICAqIEByZXR1cm5zIHtudW1iZXJ9IFJldHVybnMgdGhlIGluZGV4IG9mIHRoZSBtYXRjaGVkIHZhbHVlLCBlbHNlIGAtMWAuXG4gICAqL1xuICBmdW5jdGlvbiBiYXNlSW5kZXhPZldpdGgoYXJyYXksIHZhbHVlLCBmcm9tSW5kZXgsIGNvbXBhcmF0b3IpIHtcbiAgICB2YXIgaW5kZXggPSBmcm9tSW5kZXggLSAxLFxuICAgICAgICBsZW5ndGggPSBhcnJheS5sZW5ndGg7XG5cbiAgICB3aGlsZSAoKytpbmRleCA8IGxlbmd0aCkge1xuICAgICAgaWYgKGNvbXBhcmF0b3IoYXJyYXlbaW5kZXhdLCB2YWx1ZSkpIHtcbiAgICAgICAgcmV0dXJuIGluZGV4O1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gLTE7XG4gIH1cblxuICAvKipcbiAgICogVGhlIGJhc2UgaW1wbGVtZW50YXRpb24gb2YgYF8uaXNOYU5gIHdpdGhvdXQgc3VwcG9ydCBmb3IgbnVtYmVyIG9iamVjdHMuXG4gICAqXG4gICAqIEBwcml2YXRlXG4gICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNoZWNrLlxuICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYHZhbHVlYCBpcyBgTmFOYCwgZWxzZSBgZmFsc2VgLlxuICAgKi9cbiAgZnVuY3Rpb24gYmFzZUlzTmFOKHZhbHVlKSB7XG4gICAgcmV0dXJuIHZhbHVlICE9PSB2YWx1ZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBUaGUgYmFzZSBpbXBsZW1lbnRhdGlvbiBvZiBgXy5tZWFuYCBhbmQgYF8ubWVhbkJ5YCB3aXRob3V0IHN1cHBvcnQgZm9yXG4gICAqIGl0ZXJhdGVlIHNob3J0aGFuZHMuXG4gICAqXG4gICAqIEBwcml2YXRlXG4gICAqIEBwYXJhbSB7QXJyYXl9IGFycmF5IFRoZSBhcnJheSB0byBpdGVyYXRlIG92ZXIuXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IGl0ZXJhdGVlIFRoZSBmdW5jdGlvbiBpbnZva2VkIHBlciBpdGVyYXRpb24uXG4gICAqIEByZXR1cm5zIHtudW1iZXJ9IFJldHVybnMgdGhlIG1lYW4uXG4gICAqL1xuICBmdW5jdGlvbiBiYXNlTWVhbihhcnJheSwgaXRlcmF0ZWUpIHtcbiAgICB2YXIgbGVuZ3RoID0gYXJyYXkgPT0gbnVsbCA/IDAgOiBhcnJheS5sZW5ndGg7XG4gICAgcmV0dXJuIGxlbmd0aCA/IChiYXNlU3VtKGFycmF5LCBpdGVyYXRlZSkgLyBsZW5ndGgpIDogTkFOO1xuICB9XG5cbiAgLyoqXG4gICAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBfLnByb3BlcnR5YCB3aXRob3V0IHN1cHBvcnQgZm9yIGRlZXAgcGF0aHMuXG4gICAqXG4gICAqIEBwcml2YXRlXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgVGhlIGtleSBvZiB0aGUgcHJvcGVydHkgdG8gZ2V0LlxuICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgdGhlIG5ldyBhY2Nlc3NvciBmdW5jdGlvbi5cbiAgICovXG4gIGZ1bmN0aW9uIGJhc2VQcm9wZXJ0eShrZXkpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24ob2JqZWN0KSB7XG4gICAgICByZXR1cm4gb2JqZWN0ID09IG51bGwgPyB1bmRlZmluZWQgOiBvYmplY3Rba2V5XTtcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBfLnByb3BlcnR5T2ZgIHdpdGhvdXQgc3VwcG9ydCBmb3IgZGVlcCBwYXRocy5cbiAgICpcbiAgICogQHByaXZhdGVcbiAgICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgb2JqZWN0IHRvIHF1ZXJ5LlxuICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgdGhlIG5ldyBhY2Nlc3NvciBmdW5jdGlvbi5cbiAgICovXG4gIGZ1bmN0aW9uIGJhc2VQcm9wZXJ0eU9mKG9iamVjdCkge1xuICAgIHJldHVybiBmdW5jdGlvbihrZXkpIHtcbiAgICAgIHJldHVybiBvYmplY3QgPT0gbnVsbCA/IHVuZGVmaW5lZCA6IG9iamVjdFtrZXldO1xuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogVGhlIGJhc2UgaW1wbGVtZW50YXRpb24gb2YgYF8ucmVkdWNlYCBhbmQgYF8ucmVkdWNlUmlnaHRgLCB3aXRob3V0IHN1cHBvcnRcbiAgICogZm9yIGl0ZXJhdGVlIHNob3J0aGFuZHMsIHdoaWNoIGl0ZXJhdGVzIG92ZXIgYGNvbGxlY3Rpb25gIHVzaW5nIGBlYWNoRnVuY2AuXG4gICAqXG4gICAqIEBwcml2YXRlXG4gICAqIEBwYXJhbSB7QXJyYXl8T2JqZWN0fSBjb2xsZWN0aW9uIFRoZSBjb2xsZWN0aW9uIHRvIGl0ZXJhdGUgb3Zlci5cbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gaXRlcmF0ZWUgVGhlIGZ1bmN0aW9uIGludm9rZWQgcGVyIGl0ZXJhdGlvbi5cbiAgICogQHBhcmFtIHsqfSBhY2N1bXVsYXRvciBUaGUgaW5pdGlhbCB2YWx1ZS5cbiAgICogQHBhcmFtIHtib29sZWFufSBpbml0QWNjdW0gU3BlY2lmeSB1c2luZyB0aGUgZmlyc3Qgb3IgbGFzdCBlbGVtZW50IG9mXG4gICAqICBgY29sbGVjdGlvbmAgYXMgdGhlIGluaXRpYWwgdmFsdWUuXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IGVhY2hGdW5jIFRoZSBmdW5jdGlvbiB0byBpdGVyYXRlIG92ZXIgYGNvbGxlY3Rpb25gLlxuICAgKiBAcmV0dXJucyB7Kn0gUmV0dXJucyB0aGUgYWNjdW11bGF0ZWQgdmFsdWUuXG4gICAqL1xuICBmdW5jdGlvbiBiYXNlUmVkdWNlKGNvbGxlY3Rpb24sIGl0ZXJhdGVlLCBhY2N1bXVsYXRvciwgaW5pdEFjY3VtLCBlYWNoRnVuYykge1xuICAgIGVhY2hGdW5jKGNvbGxlY3Rpb24sIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgY29sbGVjdGlvbikge1xuICAgICAgYWNjdW11bGF0b3IgPSBpbml0QWNjdW1cbiAgICAgICAgPyAoaW5pdEFjY3VtID0gZmFsc2UsIHZhbHVlKVxuICAgICAgICA6IGl0ZXJhdGVlKGFjY3VtdWxhdG9yLCB2YWx1ZSwgaW5kZXgsIGNvbGxlY3Rpb24pO1xuICAgIH0pO1xuICAgIHJldHVybiBhY2N1bXVsYXRvcjtcbiAgfVxuXG4gIC8qKlxuICAgKiBUaGUgYmFzZSBpbXBsZW1lbnRhdGlvbiBvZiBgXy5zb3J0QnlgIHdoaWNoIHVzZXMgYGNvbXBhcmVyYCB0byBkZWZpbmUgdGhlXG4gICAqIHNvcnQgb3JkZXIgb2YgYGFycmF5YCBhbmQgcmVwbGFjZXMgY3JpdGVyaWEgb2JqZWN0cyB3aXRoIHRoZWlyIGNvcnJlc3BvbmRpbmdcbiAgICogdmFsdWVzLlxuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAcGFyYW0ge0FycmF5fSBhcnJheSBUaGUgYXJyYXkgdG8gc29ydC5cbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gY29tcGFyZXIgVGhlIGZ1bmN0aW9uIHRvIGRlZmluZSBzb3J0IG9yZGVyLlxuICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgYGFycmF5YC5cbiAgICovXG4gIGZ1bmN0aW9uIGJhc2VTb3J0QnkoYXJyYXksIGNvbXBhcmVyKSB7XG4gICAgdmFyIGxlbmd0aCA9IGFycmF5Lmxlbmd0aDtcblxuICAgIGFycmF5LnNvcnQoY29tcGFyZXIpO1xuICAgIHdoaWxlIChsZW5ndGgtLSkge1xuICAgICAgYXJyYXlbbGVuZ3RoXSA9IGFycmF5W2xlbmd0aF0udmFsdWU7XG4gICAgfVxuICAgIHJldHVybiBhcnJheTtcbiAgfVxuXG4gIC8qKlxuICAgKiBUaGUgYmFzZSBpbXBsZW1lbnRhdGlvbiBvZiBgXy5zdW1gIGFuZCBgXy5zdW1CeWAgd2l0aG91dCBzdXBwb3J0IGZvclxuICAgKiBpdGVyYXRlZSBzaG9ydGhhbmRzLlxuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAcGFyYW0ge0FycmF5fSBhcnJheSBUaGUgYXJyYXkgdG8gaXRlcmF0ZSBvdmVyLlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBpdGVyYXRlZSBUaGUgZnVuY3Rpb24gaW52b2tlZCBwZXIgaXRlcmF0aW9uLlxuICAgKiBAcmV0dXJucyB7bnVtYmVyfSBSZXR1cm5zIHRoZSBzdW0uXG4gICAqL1xuICBmdW5jdGlvbiBiYXNlU3VtKGFycmF5LCBpdGVyYXRlZSkge1xuICAgIHZhciByZXN1bHQsXG4gICAgICAgIGluZGV4ID0gLTEsXG4gICAgICAgIGxlbmd0aCA9IGFycmF5Lmxlbmd0aDtcblxuICAgIHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG4gICAgICB2YXIgY3VycmVudCA9IGl0ZXJhdGVlKGFycmF5W2luZGV4XSk7XG4gICAgICBpZiAoY3VycmVudCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJlc3VsdCA9IHJlc3VsdCA9PT0gdW5kZWZpbmVkID8gY3VycmVudCA6IChyZXN1bHQgKyBjdXJyZW50KTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIC8qKlxuICAgKiBUaGUgYmFzZSBpbXBsZW1lbnRhdGlvbiBvZiBgXy50aW1lc2Agd2l0aG91dCBzdXBwb3J0IGZvciBpdGVyYXRlZSBzaG9ydGhhbmRzXG4gICAqIG9yIG1heCBhcnJheSBsZW5ndGggY2hlY2tzLlxuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAcGFyYW0ge251bWJlcn0gbiBUaGUgbnVtYmVyIG9mIHRpbWVzIHRvIGludm9rZSBgaXRlcmF0ZWVgLlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBpdGVyYXRlZSBUaGUgZnVuY3Rpb24gaW52b2tlZCBwZXIgaXRlcmF0aW9uLlxuICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgdGhlIGFycmF5IG9mIHJlc3VsdHMuXG4gICAqL1xuICBmdW5jdGlvbiBiYXNlVGltZXMobiwgaXRlcmF0ZWUpIHtcbiAgICB2YXIgaW5kZXggPSAtMSxcbiAgICAgICAgcmVzdWx0ID0gQXJyYXkobik7XG5cbiAgICB3aGlsZSAoKytpbmRleCA8IG4pIHtcbiAgICAgIHJlc3VsdFtpbmRleF0gPSBpdGVyYXRlZShpbmRleCk7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICAvKipcbiAgICogVGhlIGJhc2UgaW1wbGVtZW50YXRpb24gb2YgYF8udG9QYWlyc2AgYW5kIGBfLnRvUGFpcnNJbmAgd2hpY2ggY3JlYXRlcyBhbiBhcnJheVxuICAgKiBvZiBrZXktdmFsdWUgcGFpcnMgZm9yIGBvYmplY3RgIGNvcnJlc3BvbmRpbmcgdG8gdGhlIHByb3BlcnR5IG5hbWVzIG9mIGBwcm9wc2AuXG4gICAqXG4gICAqIEBwcml2YXRlXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIG9iamVjdCB0byBxdWVyeS5cbiAgICogQHBhcmFtIHtBcnJheX0gcHJvcHMgVGhlIHByb3BlcnR5IG5hbWVzIHRvIGdldCB2YWx1ZXMgZm9yLlxuICAgKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIHRoZSBrZXktdmFsdWUgcGFpcnMuXG4gICAqL1xuICBmdW5jdGlvbiBiYXNlVG9QYWlycyhvYmplY3QsIHByb3BzKSB7XG4gICAgcmV0dXJuIGFycmF5TWFwKHByb3BzLCBmdW5jdGlvbihrZXkpIHtcbiAgICAgIHJldHVybiBba2V5LCBvYmplY3Rba2V5XV07XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogVGhlIGJhc2UgaW1wbGVtZW50YXRpb24gb2YgYF8udW5hcnlgIHdpdGhvdXQgc3VwcG9ydCBmb3Igc3RvcmluZyBtZXRhZGF0YS5cbiAgICpcbiAgICogQHByaXZhdGVcbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gZnVuYyBUaGUgZnVuY3Rpb24gdG8gY2FwIGFyZ3VtZW50cyBmb3IuXG4gICAqIEByZXR1cm5zIHtGdW5jdGlvbn0gUmV0dXJucyB0aGUgbmV3IGNhcHBlZCBmdW5jdGlvbi5cbiAgICovXG4gIGZ1bmN0aW9uIGJhc2VVbmFyeShmdW5jKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICByZXR1cm4gZnVuYyh2YWx1ZSk7XG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBUaGUgYmFzZSBpbXBsZW1lbnRhdGlvbiBvZiBgXy52YWx1ZXNgIGFuZCBgXy52YWx1ZXNJbmAgd2hpY2ggY3JlYXRlcyBhblxuICAgKiBhcnJheSBvZiBgb2JqZWN0YCBwcm9wZXJ0eSB2YWx1ZXMgY29ycmVzcG9uZGluZyB0byB0aGUgcHJvcGVydHkgbmFtZXNcbiAgICogb2YgYHByb3BzYC5cbiAgICpcbiAgICogQHByaXZhdGVcbiAgICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgb2JqZWN0IHRvIHF1ZXJ5LlxuICAgKiBAcGFyYW0ge0FycmF5fSBwcm9wcyBUaGUgcHJvcGVydHkgbmFtZXMgdG8gZ2V0IHZhbHVlcyBmb3IuXG4gICAqIEByZXR1cm5zIHtPYmplY3R9IFJldHVybnMgdGhlIGFycmF5IG9mIHByb3BlcnR5IHZhbHVlcy5cbiAgICovXG4gIGZ1bmN0aW9uIGJhc2VWYWx1ZXMob2JqZWN0LCBwcm9wcykge1xuICAgIHJldHVybiBhcnJheU1hcChwcm9wcywgZnVuY3Rpb24oa2V5KSB7XG4gICAgICByZXR1cm4gb2JqZWN0W2tleV07XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogQ2hlY2tzIGlmIGEgYGNhY2hlYCB2YWx1ZSBmb3IgYGtleWAgZXhpc3RzLlxuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAcGFyYW0ge09iamVjdH0gY2FjaGUgVGhlIGNhY2hlIHRvIHF1ZXJ5LlxuICAgKiBAcGFyYW0ge3N0cmluZ30ga2V5IFRoZSBrZXkgb2YgdGhlIGVudHJ5IHRvIGNoZWNrLlxuICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYW4gZW50cnkgZm9yIGBrZXlgIGV4aXN0cywgZWxzZSBgZmFsc2VgLlxuICAgKi9cbiAgZnVuY3Rpb24gY2FjaGVIYXMoY2FjaGUsIGtleSkge1xuICAgIHJldHVybiBjYWNoZS5oYXMoa2V5KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVc2VkIGJ5IGBfLnRyaW1gIGFuZCBgXy50cmltU3RhcnRgIHRvIGdldCB0aGUgaW5kZXggb2YgdGhlIGZpcnN0IHN0cmluZyBzeW1ib2xcbiAgICogdGhhdCBpcyBub3QgZm91bmQgaW4gdGhlIGNoYXJhY3RlciBzeW1ib2xzLlxuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAcGFyYW0ge0FycmF5fSBzdHJTeW1ib2xzIFRoZSBzdHJpbmcgc3ltYm9scyB0byBpbnNwZWN0LlxuICAgKiBAcGFyYW0ge0FycmF5fSBjaHJTeW1ib2xzIFRoZSBjaGFyYWN0ZXIgc3ltYm9scyB0byBmaW5kLlxuICAgKiBAcmV0dXJucyB7bnVtYmVyfSBSZXR1cm5zIHRoZSBpbmRleCBvZiB0aGUgZmlyc3QgdW5tYXRjaGVkIHN0cmluZyBzeW1ib2wuXG4gICAqL1xuICBmdW5jdGlvbiBjaGFyc1N0YXJ0SW5kZXgoc3RyU3ltYm9scywgY2hyU3ltYm9scykge1xuICAgIHZhciBpbmRleCA9IC0xLFxuICAgICAgICBsZW5ndGggPSBzdHJTeW1ib2xzLmxlbmd0aDtcblxuICAgIHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoICYmIGJhc2VJbmRleE9mKGNoclN5bWJvbHMsIHN0clN5bWJvbHNbaW5kZXhdLCAwKSA+IC0xKSB7fVxuICAgIHJldHVybiBpbmRleDtcbiAgfVxuXG4gIC8qKlxuICAgKiBVc2VkIGJ5IGBfLnRyaW1gIGFuZCBgXy50cmltRW5kYCB0byBnZXQgdGhlIGluZGV4IG9mIHRoZSBsYXN0IHN0cmluZyBzeW1ib2xcbiAgICogdGhhdCBpcyBub3QgZm91bmQgaW4gdGhlIGNoYXJhY3RlciBzeW1ib2xzLlxuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAcGFyYW0ge0FycmF5fSBzdHJTeW1ib2xzIFRoZSBzdHJpbmcgc3ltYm9scyB0byBpbnNwZWN0LlxuICAgKiBAcGFyYW0ge0FycmF5fSBjaHJTeW1ib2xzIFRoZSBjaGFyYWN0ZXIgc3ltYm9scyB0byBmaW5kLlxuICAgKiBAcmV0dXJucyB7bnVtYmVyfSBSZXR1cm5zIHRoZSBpbmRleCBvZiB0aGUgbGFzdCB1bm1hdGNoZWQgc3RyaW5nIHN5bWJvbC5cbiAgICovXG4gIGZ1bmN0aW9uIGNoYXJzRW5kSW5kZXgoc3RyU3ltYm9scywgY2hyU3ltYm9scykge1xuICAgIHZhciBpbmRleCA9IHN0clN5bWJvbHMubGVuZ3RoO1xuXG4gICAgd2hpbGUgKGluZGV4LS0gJiYgYmFzZUluZGV4T2YoY2hyU3ltYm9scywgc3RyU3ltYm9sc1tpbmRleF0sIDApID4gLTEpIHt9XG4gICAgcmV0dXJuIGluZGV4O1xuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIG51bWJlciBvZiBgcGxhY2Vob2xkZXJgIG9jY3VycmVuY2VzIGluIGBhcnJheWAuXG4gICAqXG4gICAqIEBwcml2YXRlXG4gICAqIEBwYXJhbSB7QXJyYXl9IGFycmF5IFRoZSBhcnJheSB0byBpbnNwZWN0LlxuICAgKiBAcGFyYW0geyp9IHBsYWNlaG9sZGVyIFRoZSBwbGFjZWhvbGRlciB0byBzZWFyY2ggZm9yLlxuICAgKiBAcmV0dXJucyB7bnVtYmVyfSBSZXR1cm5zIHRoZSBwbGFjZWhvbGRlciBjb3VudC5cbiAgICovXG4gIGZ1bmN0aW9uIGNvdW50SG9sZGVycyhhcnJheSwgcGxhY2Vob2xkZXIpIHtcbiAgICB2YXIgbGVuZ3RoID0gYXJyYXkubGVuZ3RoLFxuICAgICAgICByZXN1bHQgPSAwO1xuXG4gICAgd2hpbGUgKGxlbmd0aC0tKSB7XG4gICAgICBpZiAoYXJyYXlbbGVuZ3RoXSA9PT0gcGxhY2Vob2xkZXIpIHtcbiAgICAgICAgKytyZXN1bHQ7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICAvKipcbiAgICogVXNlZCBieSBgXy5kZWJ1cnJgIHRvIGNvbnZlcnQgTGF0aW4tMSBTdXBwbGVtZW50IGFuZCBMYXRpbiBFeHRlbmRlZC1BXG4gICAqIGxldHRlcnMgdG8gYmFzaWMgTGF0aW4gbGV0dGVycy5cbiAgICpcbiAgICogQHByaXZhdGVcbiAgICogQHBhcmFtIHtzdHJpbmd9IGxldHRlciBUaGUgbWF0Y2hlZCBsZXR0ZXIgdG8gZGVidXJyLlxuICAgKiBAcmV0dXJucyB7c3RyaW5nfSBSZXR1cm5zIHRoZSBkZWJ1cnJlZCBsZXR0ZXIuXG4gICAqL1xuICB2YXIgZGVidXJyTGV0dGVyID0gYmFzZVByb3BlcnR5T2YoZGVidXJyZWRMZXR0ZXJzKTtcblxuICAvKipcbiAgICogVXNlZCBieSBgXy5lc2NhcGVgIHRvIGNvbnZlcnQgY2hhcmFjdGVycyB0byBIVE1MIGVudGl0aWVzLlxuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAcGFyYW0ge3N0cmluZ30gY2hyIFRoZSBtYXRjaGVkIGNoYXJhY3RlciB0byBlc2NhcGUuXG4gICAqIEByZXR1cm5zIHtzdHJpbmd9IFJldHVybnMgdGhlIGVzY2FwZWQgY2hhcmFjdGVyLlxuICAgKi9cbiAgdmFyIGVzY2FwZUh0bWxDaGFyID0gYmFzZVByb3BlcnR5T2YoaHRtbEVzY2FwZXMpO1xuXG4gIC8qKlxuICAgKiBVc2VkIGJ5IGBfLnRlbXBsYXRlYCB0byBlc2NhcGUgY2hhcmFjdGVycyBmb3IgaW5jbHVzaW9uIGluIGNvbXBpbGVkIHN0cmluZyBsaXRlcmFscy5cbiAgICpcbiAgICogQHByaXZhdGVcbiAgICogQHBhcmFtIHtzdHJpbmd9IGNociBUaGUgbWF0Y2hlZCBjaGFyYWN0ZXIgdG8gZXNjYXBlLlxuICAgKiBAcmV0dXJucyB7c3RyaW5nfSBSZXR1cm5zIHRoZSBlc2NhcGVkIGNoYXJhY3Rlci5cbiAgICovXG4gIGZ1bmN0aW9uIGVzY2FwZVN0cmluZ0NoYXIoY2hyKSB7XG4gICAgcmV0dXJuICdcXFxcJyArIHN0cmluZ0VzY2FwZXNbY2hyXTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSB2YWx1ZSBhdCBga2V5YCBvZiBgb2JqZWN0YC5cbiAgICpcbiAgICogQHByaXZhdGVcbiAgICogQHBhcmFtIHtPYmplY3R9IFtvYmplY3RdIFRoZSBvYmplY3QgdG8gcXVlcnkuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgVGhlIGtleSBvZiB0aGUgcHJvcGVydHkgdG8gZ2V0LlxuICAgKiBAcmV0dXJucyB7Kn0gUmV0dXJucyB0aGUgcHJvcGVydHkgdmFsdWUuXG4gICAqL1xuICBmdW5jdGlvbiBnZXRWYWx1ZShvYmplY3QsIGtleSkge1xuICAgIHJldHVybiBvYmplY3QgPT0gbnVsbCA/IHVuZGVmaW5lZCA6IG9iamVjdFtrZXldO1xuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrcyBpZiBgc3RyaW5nYCBjb250YWlucyBVbmljb2RlIHN5bWJvbHMuXG4gICAqXG4gICAqIEBwcml2YXRlXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBzdHJpbmcgVGhlIHN0cmluZyB0byBpbnNwZWN0LlxuICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYSBzeW1ib2wgaXMgZm91bmQsIGVsc2UgYGZhbHNlYC5cbiAgICovXG4gIGZ1bmN0aW9uIGhhc1VuaWNvZGUoc3RyaW5nKSB7XG4gICAgcmV0dXJuIHJlSGFzVW5pY29kZS50ZXN0KHN0cmluZyk7XG4gIH1cblxuICAvKipcbiAgICogQ2hlY2tzIGlmIGBzdHJpbmdgIGNvbnRhaW5zIGEgd29yZCBjb21wb3NlZCBvZiBVbmljb2RlIHN5bWJvbHMuXG4gICAqXG4gICAqIEBwcml2YXRlXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBzdHJpbmcgVGhlIHN0cmluZyB0byBpbnNwZWN0LlxuICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYSB3b3JkIGlzIGZvdW5kLCBlbHNlIGBmYWxzZWAuXG4gICAqL1xuICBmdW5jdGlvbiBoYXNVbmljb2RlV29yZChzdHJpbmcpIHtcbiAgICByZXR1cm4gcmVIYXNVbmljb2RlV29yZC50ZXN0KHN0cmluZyk7XG4gIH1cblxuICAvKipcbiAgICogQ29udmVydHMgYGl0ZXJhdG9yYCB0byBhbiBhcnJheS5cbiAgICpcbiAgICogQHByaXZhdGVcbiAgICogQHBhcmFtIHtPYmplY3R9IGl0ZXJhdG9yIFRoZSBpdGVyYXRvciB0byBjb252ZXJ0LlxuICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgdGhlIGNvbnZlcnRlZCBhcnJheS5cbiAgICovXG4gIGZ1bmN0aW9uIGl0ZXJhdG9yVG9BcnJheShpdGVyYXRvcikge1xuICAgIHZhciBkYXRhLFxuICAgICAgICByZXN1bHQgPSBbXTtcblxuICAgIHdoaWxlICghKGRhdGEgPSBpdGVyYXRvci5uZXh0KCkpLmRvbmUpIHtcbiAgICAgIHJlc3VsdC5wdXNoKGRhdGEudmFsdWUpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgLyoqXG4gICAqIENvbnZlcnRzIGBtYXBgIHRvIGl0cyBrZXktdmFsdWUgcGFpcnMuXG4gICAqXG4gICAqIEBwcml2YXRlXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBtYXAgVGhlIG1hcCB0byBjb252ZXJ0LlxuICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgdGhlIGtleS12YWx1ZSBwYWlycy5cbiAgICovXG4gIGZ1bmN0aW9uIG1hcFRvQXJyYXkobWFwKSB7XG4gICAgdmFyIGluZGV4ID0gLTEsXG4gICAgICAgIHJlc3VsdCA9IEFycmF5KG1hcC5zaXplKTtcblxuICAgIG1hcC5mb3JFYWNoKGZ1bmN0aW9uKHZhbHVlLCBrZXkpIHtcbiAgICAgIHJlc3VsdFsrK2luZGV4XSA9IFtrZXksIHZhbHVlXTtcbiAgICB9KTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYSB1bmFyeSBmdW5jdGlvbiB0aGF0IGludm9rZXMgYGZ1bmNgIHdpdGggaXRzIGFyZ3VtZW50IHRyYW5zZm9ybWVkLlxuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmdW5jIFRoZSBmdW5jdGlvbiB0byB3cmFwLlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSB0cmFuc2Zvcm0gVGhlIGFyZ3VtZW50IHRyYW5zZm9ybS5cbiAgICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIHRoZSBuZXcgZnVuY3Rpb24uXG4gICAqL1xuICBmdW5jdGlvbiBvdmVyQXJnKGZ1bmMsIHRyYW5zZm9ybSkge1xuICAgIHJldHVybiBmdW5jdGlvbihhcmcpIHtcbiAgICAgIHJldHVybiBmdW5jKHRyYW5zZm9ybShhcmcpKTtcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIFJlcGxhY2VzIGFsbCBgcGxhY2Vob2xkZXJgIGVsZW1lbnRzIGluIGBhcnJheWAgd2l0aCBhbiBpbnRlcm5hbCBwbGFjZWhvbGRlclxuICAgKiBhbmQgcmV0dXJucyBhbiBhcnJheSBvZiB0aGVpciBpbmRleGVzLlxuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAcGFyYW0ge0FycmF5fSBhcnJheSBUaGUgYXJyYXkgdG8gbW9kaWZ5LlxuICAgKiBAcGFyYW0geyp9IHBsYWNlaG9sZGVyIFRoZSBwbGFjZWhvbGRlciB0byByZXBsYWNlLlxuICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgdGhlIG5ldyBhcnJheSBvZiBwbGFjZWhvbGRlciBpbmRleGVzLlxuICAgKi9cbiAgZnVuY3Rpb24gcmVwbGFjZUhvbGRlcnMoYXJyYXksIHBsYWNlaG9sZGVyKSB7XG4gICAgdmFyIGluZGV4ID0gLTEsXG4gICAgICAgIGxlbmd0aCA9IGFycmF5Lmxlbmd0aCxcbiAgICAgICAgcmVzSW5kZXggPSAwLFxuICAgICAgICByZXN1bHQgPSBbXTtcblxuICAgIHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG4gICAgICB2YXIgdmFsdWUgPSBhcnJheVtpbmRleF07XG4gICAgICBpZiAodmFsdWUgPT09IHBsYWNlaG9sZGVyIHx8IHZhbHVlID09PSBQTEFDRUhPTERFUikge1xuICAgICAgICBhcnJheVtpbmRleF0gPSBQTEFDRUhPTERFUjtcbiAgICAgICAgcmVzdWx0W3Jlc0luZGV4KytdID0gaW5kZXg7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICAvKipcbiAgICogR2V0cyB0aGUgdmFsdWUgYXQgYGtleWAsIHVubGVzcyBga2V5YCBpcyBcIl9fcHJvdG9fX1wiLlxuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8gcXVlcnkuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgVGhlIGtleSBvZiB0aGUgcHJvcGVydHkgdG8gZ2V0LlxuICAgKiBAcmV0dXJucyB7Kn0gUmV0dXJucyB0aGUgcHJvcGVydHkgdmFsdWUuXG4gICAqL1xuICBmdW5jdGlvbiBzYWZlR2V0KG9iamVjdCwga2V5KSB7XG4gICAgcmV0dXJuIGtleSA9PSAnX19wcm90b19fJ1xuICAgICAgPyB1bmRlZmluZWRcbiAgICAgIDogb2JqZWN0W2tleV07XG4gIH1cblxuICAvKipcbiAgICogQ29udmVydHMgYHNldGAgdG8gYW4gYXJyYXkgb2YgaXRzIHZhbHVlcy5cbiAgICpcbiAgICogQHByaXZhdGVcbiAgICogQHBhcmFtIHtPYmplY3R9IHNldCBUaGUgc2V0IHRvIGNvbnZlcnQuXG4gICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgdmFsdWVzLlxuICAgKi9cbiAgZnVuY3Rpb24gc2V0VG9BcnJheShzZXQpIHtcbiAgICB2YXIgaW5kZXggPSAtMSxcbiAgICAgICAgcmVzdWx0ID0gQXJyYXkoc2V0LnNpemUpO1xuXG4gICAgc2V0LmZvckVhY2goZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgIHJlc3VsdFsrK2luZGV4XSA9IHZhbHVlO1xuICAgIH0pO1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICAvKipcbiAgICogQ29udmVydHMgYHNldGAgdG8gaXRzIHZhbHVlLXZhbHVlIHBhaXJzLlxuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAcGFyYW0ge09iamVjdH0gc2V0IFRoZSBzZXQgdG8gY29udmVydC5cbiAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIHRoZSB2YWx1ZS12YWx1ZSBwYWlycy5cbiAgICovXG4gIGZ1bmN0aW9uIHNldFRvUGFpcnMoc2V0KSB7XG4gICAgdmFyIGluZGV4ID0gLTEsXG4gICAgICAgIHJlc3VsdCA9IEFycmF5KHNldC5zaXplKTtcblxuICAgIHNldC5mb3JFYWNoKGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICByZXN1bHRbKytpbmRleF0gPSBbdmFsdWUsIHZhbHVlXTtcbiAgICB9KTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgLyoqXG4gICAqIEEgc3BlY2lhbGl6ZWQgdmVyc2lvbiBvZiBgXy5pbmRleE9mYCB3aGljaCBwZXJmb3JtcyBzdHJpY3QgZXF1YWxpdHlcbiAgICogY29tcGFyaXNvbnMgb2YgdmFsdWVzLCBpLmUuIGA9PT1gLlxuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAcGFyYW0ge0FycmF5fSBhcnJheSBUaGUgYXJyYXkgdG8gaW5zcGVjdC5cbiAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gc2VhcmNoIGZvci5cbiAgICogQHBhcmFtIHtudW1iZXJ9IGZyb21JbmRleCBUaGUgaW5kZXggdG8gc2VhcmNoIGZyb20uXG4gICAqIEByZXR1cm5zIHtudW1iZXJ9IFJldHVybnMgdGhlIGluZGV4IG9mIHRoZSBtYXRjaGVkIHZhbHVlLCBlbHNlIGAtMWAuXG4gICAqL1xuICBmdW5jdGlvbiBzdHJpY3RJbmRleE9mKGFycmF5LCB2YWx1ZSwgZnJvbUluZGV4KSB7XG4gICAgdmFyIGluZGV4ID0gZnJvbUluZGV4IC0gMSxcbiAgICAgICAgbGVuZ3RoID0gYXJyYXkubGVuZ3RoO1xuXG4gICAgd2hpbGUgKCsraW5kZXggPCBsZW5ndGgpIHtcbiAgICAgIGlmIChhcnJheVtpbmRleF0gPT09IHZhbHVlKSB7XG4gICAgICAgIHJldHVybiBpbmRleDtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIC0xO1xuICB9XG5cbiAgLyoqXG4gICAqIEEgc3BlY2lhbGl6ZWQgdmVyc2lvbiBvZiBgXy5sYXN0SW5kZXhPZmAgd2hpY2ggcGVyZm9ybXMgc3RyaWN0IGVxdWFsaXR5XG4gICAqIGNvbXBhcmlzb25zIG9mIHZhbHVlcywgaS5lLiBgPT09YC5cbiAgICpcbiAgICogQHByaXZhdGVcbiAgICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIGFycmF5IHRvIGluc3BlY3QuXG4gICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIHNlYXJjaCBmb3IuXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBmcm9tSW5kZXggVGhlIGluZGV4IHRvIHNlYXJjaCBmcm9tLlxuICAgKiBAcmV0dXJucyB7bnVtYmVyfSBSZXR1cm5zIHRoZSBpbmRleCBvZiB0aGUgbWF0Y2hlZCB2YWx1ZSwgZWxzZSBgLTFgLlxuICAgKi9cbiAgZnVuY3Rpb24gc3RyaWN0TGFzdEluZGV4T2YoYXJyYXksIHZhbHVlLCBmcm9tSW5kZXgpIHtcbiAgICB2YXIgaW5kZXggPSBmcm9tSW5kZXggKyAxO1xuICAgIHdoaWxlIChpbmRleC0tKSB7XG4gICAgICBpZiAoYXJyYXlbaW5kZXhdID09PSB2YWx1ZSkge1xuICAgICAgICByZXR1cm4gaW5kZXg7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBpbmRleDtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSBudW1iZXIgb2Ygc3ltYm9scyBpbiBgc3RyaW5nYC5cbiAgICpcbiAgICogQHByaXZhdGVcbiAgICogQHBhcmFtIHtzdHJpbmd9IHN0cmluZyBUaGUgc3RyaW5nIHRvIGluc3BlY3QuXG4gICAqIEByZXR1cm5zIHtudW1iZXJ9IFJldHVybnMgdGhlIHN0cmluZyBzaXplLlxuICAgKi9cbiAgZnVuY3Rpb24gc3RyaW5nU2l6ZShzdHJpbmcpIHtcbiAgICByZXR1cm4gaGFzVW5pY29kZShzdHJpbmcpXG4gICAgICA/IHVuaWNvZGVTaXplKHN0cmluZylcbiAgICAgIDogYXNjaWlTaXplKHN0cmluZyk7XG4gIH1cblxuICAvKipcbiAgICogQ29udmVydHMgYHN0cmluZ2AgdG8gYW4gYXJyYXkuXG4gICAqXG4gICAqIEBwcml2YXRlXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBzdHJpbmcgVGhlIHN0cmluZyB0byBjb252ZXJ0LlxuICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgdGhlIGNvbnZlcnRlZCBhcnJheS5cbiAgICovXG4gIGZ1bmN0aW9uIHN0cmluZ1RvQXJyYXkoc3RyaW5nKSB7XG4gICAgcmV0dXJuIGhhc1VuaWNvZGUoc3RyaW5nKVxuICAgICAgPyB1bmljb2RlVG9BcnJheShzdHJpbmcpXG4gICAgICA6IGFzY2lpVG9BcnJheShzdHJpbmcpO1xuICB9XG5cbiAgLyoqXG4gICAqIFVzZWQgYnkgYF8udW5lc2NhcGVgIHRvIGNvbnZlcnQgSFRNTCBlbnRpdGllcyB0byBjaGFyYWN0ZXJzLlxuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAcGFyYW0ge3N0cmluZ30gY2hyIFRoZSBtYXRjaGVkIGNoYXJhY3RlciB0byB1bmVzY2FwZS5cbiAgICogQHJldHVybnMge3N0cmluZ30gUmV0dXJucyB0aGUgdW5lc2NhcGVkIGNoYXJhY3Rlci5cbiAgICovXG4gIHZhciB1bmVzY2FwZUh0bWxDaGFyID0gYmFzZVByb3BlcnR5T2YoaHRtbFVuZXNjYXBlcyk7XG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIHNpemUgb2YgYSBVbmljb2RlIGBzdHJpbmdgLlxuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAcGFyYW0ge3N0cmluZ30gc3RyaW5nIFRoZSBzdHJpbmcgaW5zcGVjdC5cbiAgICogQHJldHVybnMge251bWJlcn0gUmV0dXJucyB0aGUgc3RyaW5nIHNpemUuXG4gICAqL1xuICBmdW5jdGlvbiB1bmljb2RlU2l6ZShzdHJpbmcpIHtcbiAgICB2YXIgcmVzdWx0ID0gcmVVbmljb2RlLmxhc3RJbmRleCA9IDA7XG4gICAgd2hpbGUgKHJlVW5pY29kZS50ZXN0KHN0cmluZykpIHtcbiAgICAgICsrcmVzdWx0O1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgLyoqXG4gICAqIENvbnZlcnRzIGEgVW5pY29kZSBgc3RyaW5nYCB0byBhbiBhcnJheS5cbiAgICpcbiAgICogQHByaXZhdGVcbiAgICogQHBhcmFtIHtzdHJpbmd9IHN0cmluZyBUaGUgc3RyaW5nIHRvIGNvbnZlcnQuXG4gICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgY29udmVydGVkIGFycmF5LlxuICAgKi9cbiAgZnVuY3Rpb24gdW5pY29kZVRvQXJyYXkoc3RyaW5nKSB7XG4gICAgcmV0dXJuIHN0cmluZy5tYXRjaChyZVVuaWNvZGUpIHx8IFtdO1xuICB9XG5cbiAgLyoqXG4gICAqIFNwbGl0cyBhIFVuaWNvZGUgYHN0cmluZ2AgaW50byBhbiBhcnJheSBvZiBpdHMgd29yZHMuXG4gICAqXG4gICAqIEBwcml2YXRlXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBUaGUgc3RyaW5nIHRvIGluc3BlY3QuXG4gICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgd29yZHMgb2YgYHN0cmluZ2AuXG4gICAqL1xuICBmdW5jdGlvbiB1bmljb2RlV29yZHMoc3RyaW5nKSB7XG4gICAgcmV0dXJuIHN0cmluZy5tYXRjaChyZVVuaWNvZGVXb3JkKSB8fCBbXTtcbiAgfVxuXG4gIC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG4gIC8qKlxuICAgKiBDcmVhdGUgYSBuZXcgcHJpc3RpbmUgYGxvZGFzaGAgZnVuY3Rpb24gdXNpbmcgdGhlIGBjb250ZXh0YCBvYmplY3QuXG4gICAqXG4gICAqIEBzdGF0aWNcbiAgICogQG1lbWJlck9mIF9cbiAgICogQHNpbmNlIDEuMS4wXG4gICAqIEBjYXRlZ29yeSBVdGlsXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBbY29udGV4dD1yb290XSBUaGUgY29udGV4dCBvYmplY3QuXG4gICAqIEByZXR1cm5zIHtGdW5jdGlvbn0gUmV0dXJucyBhIG5ldyBgbG9kYXNoYCBmdW5jdGlvbi5cbiAgICogQGV4YW1wbGVcbiAgICpcbiAgICogXy5taXhpbih7ICdmb28nOiBfLmNvbnN0YW50KCdmb28nKSB9KTtcbiAgICpcbiAgICogdmFyIGxvZGFzaCA9IF8ucnVuSW5Db250ZXh0KCk7XG4gICAqIGxvZGFzaC5taXhpbih7ICdiYXInOiBsb2Rhc2guY29uc3RhbnQoJ2JhcicpIH0pO1xuICAgKlxuICAgKiBfLmlzRnVuY3Rpb24oXy5mb28pO1xuICAgKiAvLyA9PiB0cnVlXG4gICAqIF8uaXNGdW5jdGlvbihfLmJhcik7XG4gICAqIC8vID0+IGZhbHNlXG4gICAqXG4gICAqIGxvZGFzaC5pc0Z1bmN0aW9uKGxvZGFzaC5mb28pO1xuICAgKiAvLyA9PiBmYWxzZVxuICAgKiBsb2Rhc2guaXNGdW5jdGlvbihsb2Rhc2guYmFyKTtcbiAgICogLy8gPT4gdHJ1ZVxuICAgKlxuICAgKiAvLyBDcmVhdGUgYSBzdXBlZC11cCBgZGVmZXJgIGluIE5vZGUuanMuXG4gICAqIHZhciBkZWZlciA9IF8ucnVuSW5Db250ZXh0KHsgJ3NldFRpbWVvdXQnOiBzZXRJbW1lZGlhdGUgfSkuZGVmZXI7XG4gICAqL1xuICB2YXIgcnVuSW5Db250ZXh0ID0gKGZ1bmN0aW9uIHJ1bkluQ29udGV4dChjb250ZXh0KSB7XG4gICAgY29udGV4dCA9IGNvbnRleHQgPT0gbnVsbCA/IHJvb3QgOiBfLmRlZmF1bHRzKHJvb3QuT2JqZWN0KCksIGNvbnRleHQsIF8ucGljayhyb290LCBjb250ZXh0UHJvcHMpKTtcblxuICAgIC8qKiBCdWlsdC1pbiBjb25zdHJ1Y3RvciByZWZlcmVuY2VzLiAqL1xuICAgIHZhciBBcnJheSA9IGNvbnRleHQuQXJyYXksXG4gICAgICAgIERhdGUgPSBjb250ZXh0LkRhdGUsXG4gICAgICAgIEVycm9yID0gY29udGV4dC5FcnJvcixcbiAgICAgICAgRnVuY3Rpb24gPSBjb250ZXh0LkZ1bmN0aW9uLFxuICAgICAgICBNYXRoID0gY29udGV4dC5NYXRoLFxuICAgICAgICBPYmplY3QgPSBjb250ZXh0Lk9iamVjdCxcbiAgICAgICAgUmVnRXhwID0gY29udGV4dC5SZWdFeHAsXG4gICAgICAgIFN0cmluZyA9IGNvbnRleHQuU3RyaW5nLFxuICAgICAgICBUeXBlRXJyb3IgPSBjb250ZXh0LlR5cGVFcnJvcjtcblxuICAgIC8qKiBVc2VkIGZvciBidWlsdC1pbiBtZXRob2QgcmVmZXJlbmNlcy4gKi9cbiAgICB2YXIgYXJyYXlQcm90byA9IEFycmF5LnByb3RvdHlwZSxcbiAgICAgICAgZnVuY1Byb3RvID0gRnVuY3Rpb24ucHJvdG90eXBlLFxuICAgICAgICBvYmplY3RQcm90byA9IE9iamVjdC5wcm90b3R5cGU7XG5cbiAgICAvKiogVXNlZCB0byBkZXRlY3Qgb3ZlcnJlYWNoaW5nIGNvcmUtanMgc2hpbXMuICovXG4gICAgdmFyIGNvcmVKc0RhdGEgPSBjb250ZXh0WydfX2NvcmUtanNfc2hhcmVkX18nXTtcblxuICAgIC8qKiBVc2VkIHRvIHJlc29sdmUgdGhlIGRlY29tcGlsZWQgc291cmNlIG9mIGZ1bmN0aW9ucy4gKi9cbiAgICB2YXIgZnVuY1RvU3RyaW5nID0gZnVuY1Byb3RvLnRvU3RyaW5nO1xuXG4gICAgLyoqIFVzZWQgdG8gY2hlY2sgb2JqZWN0cyBmb3Igb3duIHByb3BlcnRpZXMuICovXG4gICAgdmFyIGhhc093blByb3BlcnR5ID0gb2JqZWN0UHJvdG8uaGFzT3duUHJvcGVydHk7XG5cbiAgICAvKiogVXNlZCB0byBnZW5lcmF0ZSB1bmlxdWUgSURzLiAqL1xuICAgIHZhciBpZENvdW50ZXIgPSAwO1xuXG4gICAgLyoqIFVzZWQgdG8gZGV0ZWN0IG1ldGhvZHMgbWFzcXVlcmFkaW5nIGFzIG5hdGl2ZS4gKi9cbiAgICB2YXIgbWFza1NyY0tleSA9IChmdW5jdGlvbigpIHtcbiAgICAgIHZhciB1aWQgPSAvW14uXSskLy5leGVjKGNvcmVKc0RhdGEgJiYgY29yZUpzRGF0YS5rZXlzICYmIGNvcmVKc0RhdGEua2V5cy5JRV9QUk9UTyB8fCAnJyk7XG4gICAgICByZXR1cm4gdWlkID8gKCdTeW1ib2woc3JjKV8xLicgKyB1aWQpIDogJyc7XG4gICAgfSgpKTtcblxuICAgIC8qKlxuICAgICAqIFVzZWQgdG8gcmVzb2x2ZSB0aGVcbiAgICAgKiBbYHRvU3RyaW5nVGFnYF0oaHR0cDovL2VjbWEtaW50ZXJuYXRpb25hbC5vcmcvZWNtYS0yNjIvNy4wLyNzZWMtb2JqZWN0LnByb3RvdHlwZS50b3N0cmluZylcbiAgICAgKiBvZiB2YWx1ZXMuXG4gICAgICovXG4gICAgdmFyIG5hdGl2ZU9iamVjdFRvU3RyaW5nID0gb2JqZWN0UHJvdG8udG9TdHJpbmc7XG5cbiAgICAvKiogVXNlZCB0byBpbmZlciB0aGUgYE9iamVjdGAgY29uc3RydWN0b3IuICovXG4gICAgdmFyIG9iamVjdEN0b3JTdHJpbmcgPSBmdW5jVG9TdHJpbmcuY2FsbChPYmplY3QpO1xuXG4gICAgLyoqIFVzZWQgdG8gcmVzdG9yZSB0aGUgb3JpZ2luYWwgYF9gIHJlZmVyZW5jZSBpbiBgXy5ub0NvbmZsaWN0YC4gKi9cbiAgICB2YXIgb2xkRGFzaCA9IHJvb3QuXztcblxuICAgIC8qKiBVc2VkIHRvIGRldGVjdCBpZiBhIG1ldGhvZCBpcyBuYXRpdmUuICovXG4gICAgdmFyIHJlSXNOYXRpdmUgPSBSZWdFeHAoJ14nICtcbiAgICAgIGZ1bmNUb1N0cmluZy5jYWxsKGhhc093blByb3BlcnR5KS5yZXBsYWNlKHJlUmVnRXhwQ2hhciwgJ1xcXFwkJicpXG4gICAgICAucmVwbGFjZSgvaGFzT3duUHJvcGVydHl8KGZ1bmN0aW9uKS4qPyg/PVxcXFxcXCgpfCBmb3IgLis/KD89XFxcXFxcXSkvZywgJyQxLio/JykgKyAnJCdcbiAgICApO1xuXG4gICAgLyoqIEJ1aWx0LWluIHZhbHVlIHJlZmVyZW5jZXMuICovXG4gICAgdmFyIEJ1ZmZlciA9IG1vZHVsZUV4cG9ydHMgPyBjb250ZXh0LkJ1ZmZlciA6IHVuZGVmaW5lZCxcbiAgICAgICAgU3ltYm9sID0gY29udGV4dC5TeW1ib2wsXG4gICAgICAgIFVpbnQ4QXJyYXkgPSBjb250ZXh0LlVpbnQ4QXJyYXksXG4gICAgICAgIGFsbG9jVW5zYWZlID0gQnVmZmVyID8gQnVmZmVyLmFsbG9jVW5zYWZlIDogdW5kZWZpbmVkLFxuICAgICAgICBnZXRQcm90b3R5cGUgPSBvdmVyQXJnKE9iamVjdC5nZXRQcm90b3R5cGVPZiwgT2JqZWN0KSxcbiAgICAgICAgb2JqZWN0Q3JlYXRlID0gT2JqZWN0LmNyZWF0ZSxcbiAgICAgICAgcHJvcGVydHlJc0VudW1lcmFibGUgPSBvYmplY3RQcm90by5wcm9wZXJ0eUlzRW51bWVyYWJsZSxcbiAgICAgICAgc3BsaWNlID0gYXJyYXlQcm90by5zcGxpY2UsXG4gICAgICAgIHNwcmVhZGFibGVTeW1ib2wgPSBTeW1ib2wgPyBTeW1ib2wuaXNDb25jYXRTcHJlYWRhYmxlIDogdW5kZWZpbmVkLFxuICAgICAgICBzeW1JdGVyYXRvciA9IFN5bWJvbCA/IFN5bWJvbC5pdGVyYXRvciA6IHVuZGVmaW5lZCxcbiAgICAgICAgc3ltVG9TdHJpbmdUYWcgPSBTeW1ib2wgPyBTeW1ib2wudG9TdHJpbmdUYWcgOiB1bmRlZmluZWQ7XG5cbiAgICB2YXIgZGVmaW5lUHJvcGVydHkgPSAoZnVuY3Rpb24oKSB7XG4gICAgICB0cnkge1xuICAgICAgICB2YXIgZnVuYyA9IGdldE5hdGl2ZShPYmplY3QsICdkZWZpbmVQcm9wZXJ0eScpO1xuICAgICAgICBmdW5jKHt9LCAnJywge30pO1xuICAgICAgICByZXR1cm4gZnVuYztcbiAgICAgIH0gY2F0Y2ggKGUpIHt9XG4gICAgfSgpKTtcblxuICAgIC8qKiBNb2NrZWQgYnVpbHQtaW5zLiAqL1xuICAgIHZhciBjdHhDbGVhclRpbWVvdXQgPSBjb250ZXh0LmNsZWFyVGltZW91dCAhPT0gcm9vdC5jbGVhclRpbWVvdXQgJiYgY29udGV4dC5jbGVhclRpbWVvdXQsXG4gICAgICAgIGN0eE5vdyA9IERhdGUgJiYgRGF0ZS5ub3cgIT09IHJvb3QuRGF0ZS5ub3cgJiYgRGF0ZS5ub3csXG4gICAgICAgIGN0eFNldFRpbWVvdXQgPSBjb250ZXh0LnNldFRpbWVvdXQgIT09IHJvb3Quc2V0VGltZW91dCAmJiBjb250ZXh0LnNldFRpbWVvdXQ7XG5cbiAgICAvKiBCdWlsdC1pbiBtZXRob2QgcmVmZXJlbmNlcyBmb3IgdGhvc2Ugd2l0aCB0aGUgc2FtZSBuYW1lIGFzIG90aGVyIGBsb2Rhc2hgIG1ldGhvZHMuICovXG4gICAgdmFyIG5hdGl2ZUNlaWwgPSBNYXRoLmNlaWwsXG4gICAgICAgIG5hdGl2ZUZsb29yID0gTWF0aC5mbG9vcixcbiAgICAgICAgbmF0aXZlR2V0U3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMsXG4gICAgICAgIG5hdGl2ZUlzQnVmZmVyID0gQnVmZmVyID8gQnVmZmVyLmlzQnVmZmVyIDogdW5kZWZpbmVkLFxuICAgICAgICBuYXRpdmVJc0Zpbml0ZSA9IGNvbnRleHQuaXNGaW5pdGUsXG4gICAgICAgIG5hdGl2ZUpvaW4gPSBhcnJheVByb3RvLmpvaW4sXG4gICAgICAgIG5hdGl2ZUtleXMgPSBvdmVyQXJnKE9iamVjdC5rZXlzLCBPYmplY3QpLFxuICAgICAgICBuYXRpdmVNYXggPSBNYXRoLm1heCxcbiAgICAgICAgbmF0aXZlTWluID0gTWF0aC5taW4sXG4gICAgICAgIG5hdGl2ZU5vdyA9IERhdGUubm93LFxuICAgICAgICBuYXRpdmVQYXJzZUludCA9IGNvbnRleHQucGFyc2VJbnQsXG4gICAgICAgIG5hdGl2ZVJhbmRvbSA9IE1hdGgucmFuZG9tLFxuICAgICAgICBuYXRpdmVSZXZlcnNlID0gYXJyYXlQcm90by5yZXZlcnNlO1xuXG4gICAgLyogQnVpbHQtaW4gbWV0aG9kIHJlZmVyZW5jZXMgdGhhdCBhcmUgdmVyaWZpZWQgdG8gYmUgbmF0aXZlLiAqL1xuICAgIHZhciBEYXRhVmlldyA9IGdldE5hdGl2ZShjb250ZXh0LCAnRGF0YVZpZXcnKSxcbiAgICAgICAgTWFwID0gZ2V0TmF0aXZlKGNvbnRleHQsICdNYXAnKSxcbiAgICAgICAgUHJvbWlzZSA9IGdldE5hdGl2ZShjb250ZXh0LCAnUHJvbWlzZScpLFxuICAgICAgICBTZXQgPSBnZXROYXRpdmUoY29udGV4dCwgJ1NldCcpLFxuICAgICAgICBXZWFrTWFwID0gZ2V0TmF0aXZlKGNvbnRleHQsICdXZWFrTWFwJyksXG4gICAgICAgIG5hdGl2ZUNyZWF0ZSA9IGdldE5hdGl2ZShPYmplY3QsICdjcmVhdGUnKTtcblxuICAgIC8qKiBVc2VkIHRvIHN0b3JlIGZ1bmN0aW9uIG1ldGFkYXRhLiAqL1xuICAgIHZhciBtZXRhTWFwID0gV2Vha01hcCAmJiBuZXcgV2Vha01hcDtcblxuICAgIC8qKiBVc2VkIHRvIGxvb2t1cCB1bm1pbmlmaWVkIGZ1bmN0aW9uIG5hbWVzLiAqL1xuICAgIHZhciByZWFsTmFtZXMgPSB7fTtcblxuICAgIC8qKiBVc2VkIHRvIGRldGVjdCBtYXBzLCBzZXRzLCBhbmQgd2Vha21hcHMuICovXG4gICAgdmFyIGRhdGFWaWV3Q3RvclN0cmluZyA9IHRvU291cmNlKERhdGFWaWV3KSxcbiAgICAgICAgbWFwQ3RvclN0cmluZyA9IHRvU291cmNlKE1hcCksXG4gICAgICAgIHByb21pc2VDdG9yU3RyaW5nID0gdG9Tb3VyY2UoUHJvbWlzZSksXG4gICAgICAgIHNldEN0b3JTdHJpbmcgPSB0b1NvdXJjZShTZXQpLFxuICAgICAgICB3ZWFrTWFwQ3RvclN0cmluZyA9IHRvU291cmNlKFdlYWtNYXApO1xuXG4gICAgLyoqIFVzZWQgdG8gY29udmVydCBzeW1ib2xzIHRvIHByaW1pdGl2ZXMgYW5kIHN0cmluZ3MuICovXG4gICAgdmFyIHN5bWJvbFByb3RvID0gU3ltYm9sID8gU3ltYm9sLnByb3RvdHlwZSA6IHVuZGVmaW5lZCxcbiAgICAgICAgc3ltYm9sVmFsdWVPZiA9IHN5bWJvbFByb3RvID8gc3ltYm9sUHJvdG8udmFsdWVPZiA6IHVuZGVmaW5lZCxcbiAgICAgICAgc3ltYm9sVG9TdHJpbmcgPSBzeW1ib2xQcm90byA/IHN5bWJvbFByb3RvLnRvU3RyaW5nIDogdW5kZWZpbmVkO1xuXG4gICAgLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGBsb2Rhc2hgIG9iamVjdCB3aGljaCB3cmFwcyBgdmFsdWVgIHRvIGVuYWJsZSBpbXBsaWNpdCBtZXRob2RcbiAgICAgKiBjaGFpbiBzZXF1ZW5jZXMuIE1ldGhvZHMgdGhhdCBvcGVyYXRlIG9uIGFuZCByZXR1cm4gYXJyYXlzLCBjb2xsZWN0aW9ucyxcbiAgICAgKiBhbmQgZnVuY3Rpb25zIGNhbiBiZSBjaGFpbmVkIHRvZ2V0aGVyLiBNZXRob2RzIHRoYXQgcmV0cmlldmUgYSBzaW5nbGUgdmFsdWVcbiAgICAgKiBvciBtYXkgcmV0dXJuIGEgcHJpbWl0aXZlIHZhbHVlIHdpbGwgYXV0b21hdGljYWxseSBlbmQgdGhlIGNoYWluIHNlcXVlbmNlXG4gICAgICogYW5kIHJldHVybiB0aGUgdW53cmFwcGVkIHZhbHVlLiBPdGhlcndpc2UsIHRoZSB2YWx1ZSBtdXN0IGJlIHVud3JhcHBlZFxuICAgICAqIHdpdGggYF8jdmFsdWVgLlxuICAgICAqXG4gICAgICogRXhwbGljaXQgY2hhaW4gc2VxdWVuY2VzLCB3aGljaCBtdXN0IGJlIHVud3JhcHBlZCB3aXRoIGBfI3ZhbHVlYCwgbWF5IGJlXG4gICAgICogZW5hYmxlZCB1c2luZyBgXy5jaGFpbmAuXG4gICAgICpcbiAgICAgKiBUaGUgZXhlY3V0aW9uIG9mIGNoYWluZWQgbWV0aG9kcyBpcyBsYXp5LCB0aGF0IGlzLCBpdCdzIGRlZmVycmVkIHVudGlsXG4gICAgICogYF8jdmFsdWVgIGlzIGltcGxpY2l0bHkgb3IgZXhwbGljaXRseSBjYWxsZWQuXG4gICAgICpcbiAgICAgKiBMYXp5IGV2YWx1YXRpb24gYWxsb3dzIHNldmVyYWwgbWV0aG9kcyB0byBzdXBwb3J0IHNob3J0Y3V0IGZ1c2lvbi5cbiAgICAgKiBTaG9ydGN1dCBmdXNpb24gaXMgYW4gb3B0aW1pemF0aW9uIHRvIG1lcmdlIGl0ZXJhdGVlIGNhbGxzOyB0aGlzIGF2b2lkc1xuICAgICAqIHRoZSBjcmVhdGlvbiBvZiBpbnRlcm1lZGlhdGUgYXJyYXlzIGFuZCBjYW4gZ3JlYXRseSByZWR1Y2UgdGhlIG51bWJlciBvZlxuICAgICAqIGl0ZXJhdGVlIGV4ZWN1dGlvbnMuIFNlY3Rpb25zIG9mIGEgY2hhaW4gc2VxdWVuY2UgcXVhbGlmeSBmb3Igc2hvcnRjdXRcbiAgICAgKiBmdXNpb24gaWYgdGhlIHNlY3Rpb24gaXMgYXBwbGllZCB0byBhbiBhcnJheSBhbmQgaXRlcmF0ZWVzIGFjY2VwdCBvbmx5XG4gICAgICogb25lIGFyZ3VtZW50LiBUaGUgaGV1cmlzdGljIGZvciB3aGV0aGVyIGEgc2VjdGlvbiBxdWFsaWZpZXMgZm9yIHNob3J0Y3V0XG4gICAgICogZnVzaW9uIGlzIHN1YmplY3QgdG8gY2hhbmdlLlxuICAgICAqXG4gICAgICogQ2hhaW5pbmcgaXMgc3VwcG9ydGVkIGluIGN1c3RvbSBidWlsZHMgYXMgbG9uZyBhcyB0aGUgYF8jdmFsdWVgIG1ldGhvZCBpc1xuICAgICAqIGRpcmVjdGx5IG9yIGluZGlyZWN0bHkgaW5jbHVkZWQgaW4gdGhlIGJ1aWxkLlxuICAgICAqXG4gICAgICogSW4gYWRkaXRpb24gdG8gbG9kYXNoIG1ldGhvZHMsIHdyYXBwZXJzIGhhdmUgYEFycmF5YCBhbmQgYFN0cmluZ2AgbWV0aG9kcy5cbiAgICAgKlxuICAgICAqIFRoZSB3cmFwcGVyIGBBcnJheWAgbWV0aG9kcyBhcmU6XG4gICAgICogYGNvbmNhdGAsIGBqb2luYCwgYHBvcGAsIGBwdXNoYCwgYHNoaWZ0YCwgYHNvcnRgLCBgc3BsaWNlYCwgYW5kIGB1bnNoaWZ0YFxuICAgICAqXG4gICAgICogVGhlIHdyYXBwZXIgYFN0cmluZ2AgbWV0aG9kcyBhcmU6XG4gICAgICogYHJlcGxhY2VgIGFuZCBgc3BsaXRgXG4gICAgICpcbiAgICAgKiBUaGUgd3JhcHBlciBtZXRob2RzIHRoYXQgc3VwcG9ydCBzaG9ydGN1dCBmdXNpb24gYXJlOlxuICAgICAqIGBhdGAsIGBjb21wYWN0YCwgYGRyb3BgLCBgZHJvcFJpZ2h0YCwgYGRyb3BXaGlsZWAsIGBmaWx0ZXJgLCBgZmluZGAsXG4gICAgICogYGZpbmRMYXN0YCwgYGhlYWRgLCBgaW5pdGlhbGAsIGBsYXN0YCwgYG1hcGAsIGByZWplY3RgLCBgcmV2ZXJzZWAsIGBzbGljZWAsXG4gICAgICogYHRhaWxgLCBgdGFrZWAsIGB0YWtlUmlnaHRgLCBgdGFrZVJpZ2h0V2hpbGVgLCBgdGFrZVdoaWxlYCwgYW5kIGB0b0FycmF5YFxuICAgICAqXG4gICAgICogVGhlIGNoYWluYWJsZSB3cmFwcGVyIG1ldGhvZHMgYXJlOlxuICAgICAqIGBhZnRlcmAsIGBhcnlgLCBgYXNzaWduYCwgYGFzc2lnbkluYCwgYGFzc2lnbkluV2l0aGAsIGBhc3NpZ25XaXRoYCwgYGF0YCxcbiAgICAgKiBgYmVmb3JlYCwgYGJpbmRgLCBgYmluZEFsbGAsIGBiaW5kS2V5YCwgYGNhc3RBcnJheWAsIGBjaGFpbmAsIGBjaHVua2AsXG4gICAgICogYGNvbW1pdGAsIGBjb21wYWN0YCwgYGNvbmNhdGAsIGBjb25mb3Jtc2AsIGBjb25zdGFudGAsIGBjb3VudEJ5YCwgYGNyZWF0ZWAsXG4gICAgICogYGN1cnJ5YCwgYGRlYm91bmNlYCwgYGRlZmF1bHRzYCwgYGRlZmF1bHRzRGVlcGAsIGBkZWZlcmAsIGBkZWxheWAsXG4gICAgICogYGRpZmZlcmVuY2VgLCBgZGlmZmVyZW5jZUJ5YCwgYGRpZmZlcmVuY2VXaXRoYCwgYGRyb3BgLCBgZHJvcFJpZ2h0YCxcbiAgICAgKiBgZHJvcFJpZ2h0V2hpbGVgLCBgZHJvcFdoaWxlYCwgYGV4dGVuZGAsIGBleHRlbmRXaXRoYCwgYGZpbGxgLCBgZmlsdGVyYCxcbiAgICAgKiBgZmxhdE1hcGAsIGBmbGF0TWFwRGVlcGAsIGBmbGF0TWFwRGVwdGhgLCBgZmxhdHRlbmAsIGBmbGF0dGVuRGVlcGAsXG4gICAgICogYGZsYXR0ZW5EZXB0aGAsIGBmbGlwYCwgYGZsb3dgLCBgZmxvd1JpZ2h0YCwgYGZyb21QYWlyc2AsIGBmdW5jdGlvbnNgLFxuICAgICAqIGBmdW5jdGlvbnNJbmAsIGBncm91cEJ5YCwgYGluaXRpYWxgLCBgaW50ZXJzZWN0aW9uYCwgYGludGVyc2VjdGlvbkJ5YCxcbiAgICAgKiBgaW50ZXJzZWN0aW9uV2l0aGAsIGBpbnZlcnRgLCBgaW52ZXJ0QnlgLCBgaW52b2tlTWFwYCwgYGl0ZXJhdGVlYCwgYGtleUJ5YCxcbiAgICAgKiBga2V5c2AsIGBrZXlzSW5gLCBgbWFwYCwgYG1hcEtleXNgLCBgbWFwVmFsdWVzYCwgYG1hdGNoZXNgLCBgbWF0Y2hlc1Byb3BlcnR5YCxcbiAgICAgKiBgbWVtb2l6ZWAsIGBtZXJnZWAsIGBtZXJnZVdpdGhgLCBgbWV0aG9kYCwgYG1ldGhvZE9mYCwgYG1peGluYCwgYG5lZ2F0ZWAsXG4gICAgICogYG50aEFyZ2AsIGBvbWl0YCwgYG9taXRCeWAsIGBvbmNlYCwgYG9yZGVyQnlgLCBgb3ZlcmAsIGBvdmVyQXJnc2AsXG4gICAgICogYG92ZXJFdmVyeWAsIGBvdmVyU29tZWAsIGBwYXJ0aWFsYCwgYHBhcnRpYWxSaWdodGAsIGBwYXJ0aXRpb25gLCBgcGlja2AsXG4gICAgICogYHBpY2tCeWAsIGBwbGFudGAsIGBwcm9wZXJ0eWAsIGBwcm9wZXJ0eU9mYCwgYHB1bGxgLCBgcHVsbEFsbGAsIGBwdWxsQWxsQnlgLFxuICAgICAqIGBwdWxsQWxsV2l0aGAsIGBwdWxsQXRgLCBgcHVzaGAsIGByYW5nZWAsIGByYW5nZVJpZ2h0YCwgYHJlYXJnYCwgYHJlamVjdGAsXG4gICAgICogYHJlbW92ZWAsIGByZXN0YCwgYHJldmVyc2VgLCBgc2FtcGxlU2l6ZWAsIGBzZXRgLCBgc2V0V2l0aGAsIGBzaHVmZmxlYCxcbiAgICAgKiBgc2xpY2VgLCBgc29ydGAsIGBzb3J0QnlgLCBgc3BsaWNlYCwgYHNwcmVhZGAsIGB0YWlsYCwgYHRha2VgLCBgdGFrZVJpZ2h0YCxcbiAgICAgKiBgdGFrZVJpZ2h0V2hpbGVgLCBgdGFrZVdoaWxlYCwgYHRhcGAsIGB0aHJvdHRsZWAsIGB0aHJ1YCwgYHRvQXJyYXlgLFxuICAgICAqIGB0b1BhaXJzYCwgYHRvUGFpcnNJbmAsIGB0b1BhdGhgLCBgdG9QbGFpbk9iamVjdGAsIGB0cmFuc2Zvcm1gLCBgdW5hcnlgLFxuICAgICAqIGB1bmlvbmAsIGB1bmlvbkJ5YCwgYHVuaW9uV2l0aGAsIGB1bmlxYCwgYHVuaXFCeWAsIGB1bmlxV2l0aGAsIGB1bnNldGAsXG4gICAgICogYHVuc2hpZnRgLCBgdW56aXBgLCBgdW56aXBXaXRoYCwgYHVwZGF0ZWAsIGB1cGRhdGVXaXRoYCwgYHZhbHVlc2AsXG4gICAgICogYHZhbHVlc0luYCwgYHdpdGhvdXRgLCBgd3JhcGAsIGB4b3JgLCBgeG9yQnlgLCBgeG9yV2l0aGAsIGB6aXBgLFxuICAgICAqIGB6aXBPYmplY3RgLCBgemlwT2JqZWN0RGVlcGAsIGFuZCBgemlwV2l0aGBcbiAgICAgKlxuICAgICAqIFRoZSB3cmFwcGVyIG1ldGhvZHMgdGhhdCBhcmUgKipub3QqKiBjaGFpbmFibGUgYnkgZGVmYXVsdCBhcmU6XG4gICAgICogYGFkZGAsIGBhdHRlbXB0YCwgYGNhbWVsQ2FzZWAsIGBjYXBpdGFsaXplYCwgYGNlaWxgLCBgY2xhbXBgLCBgY2xvbmVgLFxuICAgICAqIGBjbG9uZURlZXBgLCBgY2xvbmVEZWVwV2l0aGAsIGBjbG9uZVdpdGhgLCBgY29uZm9ybXNUb2AsIGBkZWJ1cnJgLFxuICAgICAqIGBkZWZhdWx0VG9gLCBgZGl2aWRlYCwgYGVhY2hgLCBgZWFjaFJpZ2h0YCwgYGVuZHNXaXRoYCwgYGVxYCwgYGVzY2FwZWAsXG4gICAgICogYGVzY2FwZVJlZ0V4cGAsIGBldmVyeWAsIGBmaW5kYCwgYGZpbmRJbmRleGAsIGBmaW5kS2V5YCwgYGZpbmRMYXN0YCxcbiAgICAgKiBgZmluZExhc3RJbmRleGAsIGBmaW5kTGFzdEtleWAsIGBmaXJzdGAsIGBmbG9vcmAsIGBmb3JFYWNoYCwgYGZvckVhY2hSaWdodGAsXG4gICAgICogYGZvckluYCwgYGZvckluUmlnaHRgLCBgZm9yT3duYCwgYGZvck93blJpZ2h0YCwgYGdldGAsIGBndGAsIGBndGVgLCBgaGFzYCxcbiAgICAgKiBgaGFzSW5gLCBgaGVhZGAsIGBpZGVudGl0eWAsIGBpbmNsdWRlc2AsIGBpbmRleE9mYCwgYGluUmFuZ2VgLCBgaW52b2tlYCxcbiAgICAgKiBgaXNBcmd1bWVudHNgLCBgaXNBcnJheWAsIGBpc0FycmF5QnVmZmVyYCwgYGlzQXJyYXlMaWtlYCwgYGlzQXJyYXlMaWtlT2JqZWN0YCxcbiAgICAgKiBgaXNCb29sZWFuYCwgYGlzQnVmZmVyYCwgYGlzRGF0ZWAsIGBpc0VsZW1lbnRgLCBgaXNFbXB0eWAsIGBpc0VxdWFsYCxcbiAgICAgKiBgaXNFcXVhbFdpdGhgLCBgaXNFcnJvcmAsIGBpc0Zpbml0ZWAsIGBpc0Z1bmN0aW9uYCwgYGlzSW50ZWdlcmAsIGBpc0xlbmd0aGAsXG4gICAgICogYGlzTWFwYCwgYGlzTWF0Y2hgLCBgaXNNYXRjaFdpdGhgLCBgaXNOYU5gLCBgaXNOYXRpdmVgLCBgaXNOaWxgLCBgaXNOdWxsYCxcbiAgICAgKiBgaXNOdW1iZXJgLCBgaXNPYmplY3RgLCBgaXNPYmplY3RMaWtlYCwgYGlzUGxhaW5PYmplY3RgLCBgaXNSZWdFeHBgLFxuICAgICAqIGBpc1NhZmVJbnRlZ2VyYCwgYGlzU2V0YCwgYGlzU3RyaW5nYCwgYGlzVW5kZWZpbmVkYCwgYGlzVHlwZWRBcnJheWAsXG4gICAgICogYGlzV2Vha01hcGAsIGBpc1dlYWtTZXRgLCBgam9pbmAsIGBrZWJhYkNhc2VgLCBgbGFzdGAsIGBsYXN0SW5kZXhPZmAsXG4gICAgICogYGxvd2VyQ2FzZWAsIGBsb3dlckZpcnN0YCwgYGx0YCwgYGx0ZWAsIGBtYXhgLCBgbWF4QnlgLCBgbWVhbmAsIGBtZWFuQnlgLFxuICAgICAqIGBtaW5gLCBgbWluQnlgLCBgbXVsdGlwbHlgLCBgbm9Db25mbGljdGAsIGBub29wYCwgYG5vd2AsIGBudGhgLCBgcGFkYCxcbiAgICAgKiBgcGFkRW5kYCwgYHBhZFN0YXJ0YCwgYHBhcnNlSW50YCwgYHBvcGAsIGByYW5kb21gLCBgcmVkdWNlYCwgYHJlZHVjZVJpZ2h0YCxcbiAgICAgKiBgcmVwZWF0YCwgYHJlc3VsdGAsIGByb3VuZGAsIGBydW5JbkNvbnRleHRgLCBgc2FtcGxlYCwgYHNoaWZ0YCwgYHNpemVgLFxuICAgICAqIGBzbmFrZUNhc2VgLCBgc29tZWAsIGBzb3J0ZWRJbmRleGAsIGBzb3J0ZWRJbmRleEJ5YCwgYHNvcnRlZExhc3RJbmRleGAsXG4gICAgICogYHNvcnRlZExhc3RJbmRleEJ5YCwgYHN0YXJ0Q2FzZWAsIGBzdGFydHNXaXRoYCwgYHN0dWJBcnJheWAsIGBzdHViRmFsc2VgLFxuICAgICAqIGBzdHViT2JqZWN0YCwgYHN0dWJTdHJpbmdgLCBgc3R1YlRydWVgLCBgc3VidHJhY3RgLCBgc3VtYCwgYHN1bUJ5YCxcbiAgICAgKiBgdGVtcGxhdGVgLCBgdGltZXNgLCBgdG9GaW5pdGVgLCBgdG9JbnRlZ2VyYCwgYHRvSlNPTmAsIGB0b0xlbmd0aGAsXG4gICAgICogYHRvTG93ZXJgLCBgdG9OdW1iZXJgLCBgdG9TYWZlSW50ZWdlcmAsIGB0b1N0cmluZ2AsIGB0b1VwcGVyYCwgYHRyaW1gLFxuICAgICAqIGB0cmltRW5kYCwgYHRyaW1TdGFydGAsIGB0cnVuY2F0ZWAsIGB1bmVzY2FwZWAsIGB1bmlxdWVJZGAsIGB1cHBlckNhc2VgLFxuICAgICAqIGB1cHBlckZpcnN0YCwgYHZhbHVlYCwgYW5kIGB3b3Jkc2BcbiAgICAgKlxuICAgICAqIEBuYW1lIF9cbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAY2F0ZWdvcnkgU2VxXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gd3JhcCBpbiBhIGBsb2Rhc2hgIGluc3RhbmNlLlxuICAgICAqIEByZXR1cm5zIHtPYmplY3R9IFJldHVybnMgdGhlIG5ldyBgbG9kYXNoYCB3cmFwcGVyIGluc3RhbmNlLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBmdW5jdGlvbiBzcXVhcmUobikge1xuICAgICAqICAgcmV0dXJuIG4gKiBuO1xuICAgICAqIH1cbiAgICAgKlxuICAgICAqIHZhciB3cmFwcGVkID0gXyhbMSwgMiwgM10pO1xuICAgICAqXG4gICAgICogLy8gUmV0dXJucyBhbiB1bndyYXBwZWQgdmFsdWUuXG4gICAgICogd3JhcHBlZC5yZWR1Y2UoXy5hZGQpO1xuICAgICAqIC8vID0+IDZcbiAgICAgKlxuICAgICAqIC8vIFJldHVybnMgYSB3cmFwcGVkIHZhbHVlLlxuICAgICAqIHZhciBzcXVhcmVzID0gd3JhcHBlZC5tYXAoc3F1YXJlKTtcbiAgICAgKlxuICAgICAqIF8uaXNBcnJheShzcXVhcmVzKTtcbiAgICAgKiAvLyA9PiBmYWxzZVxuICAgICAqXG4gICAgICogXy5pc0FycmF5KHNxdWFyZXMudmFsdWUoKSk7XG4gICAgICogLy8gPT4gdHJ1ZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGxvZGFzaCh2YWx1ZSkge1xuICAgICAgaWYgKGlzT2JqZWN0TGlrZSh2YWx1ZSkgJiYgIWlzQXJyYXkodmFsdWUpICYmICEodmFsdWUgaW5zdGFuY2VvZiBMYXp5V3JhcHBlcikpIHtcbiAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgTG9kYXNoV3JhcHBlcikge1xuICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaGFzT3duUHJvcGVydHkuY2FsbCh2YWx1ZSwgJ19fd3JhcHBlZF9fJykpIHtcbiAgICAgICAgICByZXR1cm4gd3JhcHBlckNsb25lKHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIG5ldyBMb2Rhc2hXcmFwcGVyKHZhbHVlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgYmFzZSBpbXBsZW1lbnRhdGlvbiBvZiBgXy5jcmVhdGVgIHdpdGhvdXQgc3VwcG9ydCBmb3IgYXNzaWduaW5nXG4gICAgICogcHJvcGVydGllcyB0byB0aGUgY3JlYXRlZCBvYmplY3QuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBwcm90byBUaGUgb2JqZWN0IHRvIGluaGVyaXQgZnJvbS5cbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIHRoZSBuZXcgb2JqZWN0LlxuICAgICAqL1xuICAgIHZhciBiYXNlQ3JlYXRlID0gKGZ1bmN0aW9uKCkge1xuICAgICAgZnVuY3Rpb24gb2JqZWN0KCkge31cbiAgICAgIHJldHVybiBmdW5jdGlvbihwcm90bykge1xuICAgICAgICBpZiAoIWlzT2JqZWN0KHByb3RvKSkge1xuICAgICAgICAgIHJldHVybiB7fTtcbiAgICAgICAgfVxuICAgICAgICBpZiAob2JqZWN0Q3JlYXRlKSB7XG4gICAgICAgICAgcmV0dXJuIG9iamVjdENyZWF0ZShwcm90byk7XG4gICAgICAgIH1cbiAgICAgICAgb2JqZWN0LnByb3RvdHlwZSA9IHByb3RvO1xuICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IG9iamVjdDtcbiAgICAgICAgb2JqZWN0LnByb3RvdHlwZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgIH07XG4gICAgfSgpKTtcblxuICAgIC8qKlxuICAgICAqIFRoZSBmdW5jdGlvbiB3aG9zZSBwcm90b3R5cGUgY2hhaW4gc2VxdWVuY2Ugd3JhcHBlcnMgaW5oZXJpdCBmcm9tLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBiYXNlTG9kYXNoKCkge1xuICAgICAgLy8gTm8gb3BlcmF0aW9uIHBlcmZvcm1lZC5cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgYmFzZSBjb25zdHJ1Y3RvciBmb3IgY3JlYXRpbmcgYGxvZGFzaGAgd3JhcHBlciBvYmplY3RzLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byB3cmFwLlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW2NoYWluQWxsXSBFbmFibGUgZXhwbGljaXQgbWV0aG9kIGNoYWluIHNlcXVlbmNlcy5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBMb2Rhc2hXcmFwcGVyKHZhbHVlLCBjaGFpbkFsbCkge1xuICAgICAgdGhpcy5fX3dyYXBwZWRfXyA9IHZhbHVlO1xuICAgICAgdGhpcy5fX2FjdGlvbnNfXyA9IFtdO1xuICAgICAgdGhpcy5fX2NoYWluX18gPSAhIWNoYWluQWxsO1xuICAgICAgdGhpcy5fX2luZGV4X18gPSAwO1xuICAgICAgdGhpcy5fX3ZhbHVlc19fID0gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEJ5IGRlZmF1bHQsIHRoZSB0ZW1wbGF0ZSBkZWxpbWl0ZXJzIHVzZWQgYnkgbG9kYXNoIGFyZSBsaWtlIHRob3NlIGluXG4gICAgICogZW1iZWRkZWQgUnVieSAoRVJCKSBhcyB3ZWxsIGFzIEVTMjAxNSB0ZW1wbGF0ZSBzdHJpbmdzLiBDaGFuZ2UgdGhlXG4gICAgICogZm9sbG93aW5nIHRlbXBsYXRlIHNldHRpbmdzIHRvIHVzZSBhbHRlcm5hdGl2ZSBkZWxpbWl0ZXJzLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHR5cGUge09iamVjdH1cbiAgICAgKi9cbiAgICBsb2Rhc2gudGVtcGxhdGVTZXR0aW5ncyA9IHtcblxuICAgICAgLyoqXG4gICAgICAgKiBVc2VkIHRvIGRldGVjdCBgZGF0YWAgcHJvcGVydHkgdmFsdWVzIHRvIGJlIEhUTUwtZXNjYXBlZC5cbiAgICAgICAqXG4gICAgICAgKiBAbWVtYmVyT2YgXy50ZW1wbGF0ZVNldHRpbmdzXG4gICAgICAgKiBAdHlwZSB7UmVnRXhwfVxuICAgICAgICovXG4gICAgICAnZXNjYXBlJzogcmVFc2NhcGUsXG5cbiAgICAgIC8qKlxuICAgICAgICogVXNlZCB0byBkZXRlY3QgY29kZSB0byBiZSBldmFsdWF0ZWQuXG4gICAgICAgKlxuICAgICAgICogQG1lbWJlck9mIF8udGVtcGxhdGVTZXR0aW5nc1xuICAgICAgICogQHR5cGUge1JlZ0V4cH1cbiAgICAgICAqL1xuICAgICAgJ2V2YWx1YXRlJzogcmVFdmFsdWF0ZSxcblxuICAgICAgLyoqXG4gICAgICAgKiBVc2VkIHRvIGRldGVjdCBgZGF0YWAgcHJvcGVydHkgdmFsdWVzIHRvIGluamVjdC5cbiAgICAgICAqXG4gICAgICAgKiBAbWVtYmVyT2YgXy50ZW1wbGF0ZVNldHRpbmdzXG4gICAgICAgKiBAdHlwZSB7UmVnRXhwfVxuICAgICAgICovXG4gICAgICAnaW50ZXJwb2xhdGUnOiByZUludGVycG9sYXRlLFxuXG4gICAgICAvKipcbiAgICAgICAqIFVzZWQgdG8gcmVmZXJlbmNlIHRoZSBkYXRhIG9iamVjdCBpbiB0aGUgdGVtcGxhdGUgdGV4dC5cbiAgICAgICAqXG4gICAgICAgKiBAbWVtYmVyT2YgXy50ZW1wbGF0ZVNldHRpbmdzXG4gICAgICAgKiBAdHlwZSB7c3RyaW5nfVxuICAgICAgICovXG4gICAgICAndmFyaWFibGUnOiAnJyxcblxuICAgICAgLyoqXG4gICAgICAgKiBVc2VkIHRvIGltcG9ydCB2YXJpYWJsZXMgaW50byB0aGUgY29tcGlsZWQgdGVtcGxhdGUuXG4gICAgICAgKlxuICAgICAgICogQG1lbWJlck9mIF8udGVtcGxhdGVTZXR0aW5nc1xuICAgICAgICogQHR5cGUge09iamVjdH1cbiAgICAgICAqL1xuICAgICAgJ2ltcG9ydHMnOiB7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEEgcmVmZXJlbmNlIHRvIHRoZSBgbG9kYXNoYCBmdW5jdGlvbi5cbiAgICAgICAgICpcbiAgICAgICAgICogQG1lbWJlck9mIF8udGVtcGxhdGVTZXR0aW5ncy5pbXBvcnRzXG4gICAgICAgICAqIEB0eXBlIHtGdW5jdGlvbn1cbiAgICAgICAgICovXG4gICAgICAgICdfJzogbG9kYXNoXG4gICAgICB9XG4gICAgfTtcblxuICAgIC8vIEVuc3VyZSB3cmFwcGVycyBhcmUgaW5zdGFuY2VzIG9mIGBiYXNlTG9kYXNoYC5cbiAgICBsb2Rhc2gucHJvdG90eXBlID0gYmFzZUxvZGFzaC5wcm90b3R5cGU7XG4gICAgbG9kYXNoLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IGxvZGFzaDtcblxuICAgIExvZGFzaFdyYXBwZXIucHJvdG90eXBlID0gYmFzZUNyZWF0ZShiYXNlTG9kYXNoLnByb3RvdHlwZSk7XG4gICAgTG9kYXNoV3JhcHBlci5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBMb2Rhc2hXcmFwcGVyO1xuXG4gICAgLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGxhenkgd3JhcHBlciBvYmplY3Qgd2hpY2ggd3JhcHMgYHZhbHVlYCB0byBlbmFibGUgbGF6eSBldmFsdWF0aW9uLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byB3cmFwLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIExhenlXcmFwcGVyKHZhbHVlKSB7XG4gICAgICB0aGlzLl9fd3JhcHBlZF9fID0gdmFsdWU7XG4gICAgICB0aGlzLl9fYWN0aW9uc19fID0gW107XG4gICAgICB0aGlzLl9fZGlyX18gPSAxO1xuICAgICAgdGhpcy5fX2ZpbHRlcmVkX18gPSBmYWxzZTtcbiAgICAgIHRoaXMuX19pdGVyYXRlZXNfXyA9IFtdO1xuICAgICAgdGhpcy5fX3Rha2VDb3VudF9fID0gTUFYX0FSUkFZX0xFTkdUSDtcbiAgICAgIHRoaXMuX192aWV3c19fID0gW107XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGNsb25lIG9mIHRoZSBsYXp5IHdyYXBwZXIgb2JqZWN0LlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAbmFtZSBjbG9uZVxuICAgICAqIEBtZW1iZXJPZiBMYXp5V3JhcHBlclxuICAgICAqIEByZXR1cm5zIHtPYmplY3R9IFJldHVybnMgdGhlIGNsb25lZCBgTGF6eVdyYXBwZXJgIG9iamVjdC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBsYXp5Q2xvbmUoKSB7XG4gICAgICB2YXIgcmVzdWx0ID0gbmV3IExhenlXcmFwcGVyKHRoaXMuX193cmFwcGVkX18pO1xuICAgICAgcmVzdWx0Ll9fYWN0aW9uc19fID0gY29weUFycmF5KHRoaXMuX19hY3Rpb25zX18pO1xuICAgICAgcmVzdWx0Ll9fZGlyX18gPSB0aGlzLl9fZGlyX187XG4gICAgICByZXN1bHQuX19maWx0ZXJlZF9fID0gdGhpcy5fX2ZpbHRlcmVkX187XG4gICAgICByZXN1bHQuX19pdGVyYXRlZXNfXyA9IGNvcHlBcnJheSh0aGlzLl9faXRlcmF0ZWVzX18pO1xuICAgICAgcmVzdWx0Ll9fdGFrZUNvdW50X18gPSB0aGlzLl9fdGFrZUNvdW50X187XG4gICAgICByZXN1bHQuX192aWV3c19fID0gY29weUFycmF5KHRoaXMuX192aWV3c19fKTtcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV2ZXJzZXMgdGhlIGRpcmVjdGlvbiBvZiBsYXp5IGl0ZXJhdGlvbi5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQG5hbWUgcmV2ZXJzZVxuICAgICAqIEBtZW1iZXJPZiBMYXp5V3JhcHBlclxuICAgICAqIEByZXR1cm5zIHtPYmplY3R9IFJldHVybnMgdGhlIG5ldyByZXZlcnNlZCBgTGF6eVdyYXBwZXJgIG9iamVjdC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBsYXp5UmV2ZXJzZSgpIHtcbiAgICAgIGlmICh0aGlzLl9fZmlsdGVyZWRfXykge1xuICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IExhenlXcmFwcGVyKHRoaXMpO1xuICAgICAgICByZXN1bHQuX19kaXJfXyA9IC0xO1xuICAgICAgICByZXN1bHQuX19maWx0ZXJlZF9fID0gdHJ1ZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc3VsdCA9IHRoaXMuY2xvbmUoKTtcbiAgICAgICAgcmVzdWx0Ll9fZGlyX18gKj0gLTE7XG4gICAgICB9XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEV4dHJhY3RzIHRoZSB1bndyYXBwZWQgdmFsdWUgZnJvbSBpdHMgbGF6eSB3cmFwcGVyLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAbmFtZSB2YWx1ZVxuICAgICAqIEBtZW1iZXJPZiBMYXp5V3JhcHBlclxuICAgICAqIEByZXR1cm5zIHsqfSBSZXR1cm5zIHRoZSB1bndyYXBwZWQgdmFsdWUuXG4gICAgICovXG4gICAgZnVuY3Rpb24gbGF6eVZhbHVlKCkge1xuICAgICAgdmFyIGFycmF5ID0gdGhpcy5fX3dyYXBwZWRfXy52YWx1ZSgpLFxuICAgICAgICAgIGRpciA9IHRoaXMuX19kaXJfXyxcbiAgICAgICAgICBpc0FyciA9IGlzQXJyYXkoYXJyYXkpLFxuICAgICAgICAgIGlzUmlnaHQgPSBkaXIgPCAwLFxuICAgICAgICAgIGFyckxlbmd0aCA9IGlzQXJyID8gYXJyYXkubGVuZ3RoIDogMCxcbiAgICAgICAgICB2aWV3ID0gZ2V0VmlldygwLCBhcnJMZW5ndGgsIHRoaXMuX192aWV3c19fKSxcbiAgICAgICAgICBzdGFydCA9IHZpZXcuc3RhcnQsXG4gICAgICAgICAgZW5kID0gdmlldy5lbmQsXG4gICAgICAgICAgbGVuZ3RoID0gZW5kIC0gc3RhcnQsXG4gICAgICAgICAgaW5kZXggPSBpc1JpZ2h0ID8gZW5kIDogKHN0YXJ0IC0gMSksXG4gICAgICAgICAgaXRlcmF0ZWVzID0gdGhpcy5fX2l0ZXJhdGVlc19fLFxuICAgICAgICAgIGl0ZXJMZW5ndGggPSBpdGVyYXRlZXMubGVuZ3RoLFxuICAgICAgICAgIHJlc0luZGV4ID0gMCxcbiAgICAgICAgICB0YWtlQ291bnQgPSBuYXRpdmVNaW4obGVuZ3RoLCB0aGlzLl9fdGFrZUNvdW50X18pO1xuXG4gICAgICBpZiAoIWlzQXJyIHx8ICghaXNSaWdodCAmJiBhcnJMZW5ndGggPT0gbGVuZ3RoICYmIHRha2VDb3VudCA9PSBsZW5ndGgpKSB7XG4gICAgICAgIHJldHVybiBiYXNlV3JhcHBlclZhbHVlKGFycmF5LCB0aGlzLl9fYWN0aW9uc19fKTtcbiAgICAgIH1cbiAgICAgIHZhciByZXN1bHQgPSBbXTtcblxuICAgICAgb3V0ZXI6XG4gICAgICB3aGlsZSAobGVuZ3RoLS0gJiYgcmVzSW5kZXggPCB0YWtlQ291bnQpIHtcbiAgICAgICAgaW5kZXggKz0gZGlyO1xuXG4gICAgICAgIHZhciBpdGVySW5kZXggPSAtMSxcbiAgICAgICAgICAgIHZhbHVlID0gYXJyYXlbaW5kZXhdO1xuXG4gICAgICAgIHdoaWxlICgrK2l0ZXJJbmRleCA8IGl0ZXJMZW5ndGgpIHtcbiAgICAgICAgICB2YXIgZGF0YSA9IGl0ZXJhdGVlc1tpdGVySW5kZXhdLFxuICAgICAgICAgICAgICBpdGVyYXRlZSA9IGRhdGEuaXRlcmF0ZWUsXG4gICAgICAgICAgICAgIHR5cGUgPSBkYXRhLnR5cGUsXG4gICAgICAgICAgICAgIGNvbXB1dGVkID0gaXRlcmF0ZWUodmFsdWUpO1xuXG4gICAgICAgICAgaWYgKHR5cGUgPT0gTEFaWV9NQVBfRkxBRykge1xuICAgICAgICAgICAgdmFsdWUgPSBjb21wdXRlZDtcbiAgICAgICAgICB9IGVsc2UgaWYgKCFjb21wdXRlZCkge1xuICAgICAgICAgICAgaWYgKHR5cGUgPT0gTEFaWV9GSUxURVJfRkxBRykge1xuICAgICAgICAgICAgICBjb250aW51ZSBvdXRlcjtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGJyZWFrIG91dGVyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXN1bHRbcmVzSW5kZXgrK10gPSB2YWx1ZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuXG4gICAgLy8gRW5zdXJlIGBMYXp5V3JhcHBlcmAgaXMgYW4gaW5zdGFuY2Ugb2YgYGJhc2VMb2Rhc2hgLlxuICAgIExhenlXcmFwcGVyLnByb3RvdHlwZSA9IGJhc2VDcmVhdGUoYmFzZUxvZGFzaC5wcm90b3R5cGUpO1xuICAgIExhenlXcmFwcGVyLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IExhenlXcmFwcGVyO1xuXG4gICAgLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGhhc2ggb2JqZWN0LlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAY29uc3RydWN0b3JcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBbZW50cmllc10gVGhlIGtleS12YWx1ZSBwYWlycyB0byBjYWNoZS5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBIYXNoKGVudHJpZXMpIHtcbiAgICAgIHZhciBpbmRleCA9IC0xLFxuICAgICAgICAgIGxlbmd0aCA9IGVudHJpZXMgPT0gbnVsbCA/IDAgOiBlbnRyaWVzLmxlbmd0aDtcblxuICAgICAgdGhpcy5jbGVhcigpO1xuICAgICAgd2hpbGUgKCsraW5kZXggPCBsZW5ndGgpIHtcbiAgICAgICAgdmFyIGVudHJ5ID0gZW50cmllc1tpbmRleF07XG4gICAgICAgIHRoaXMuc2V0KGVudHJ5WzBdLCBlbnRyeVsxXSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVtb3ZlcyBhbGwga2V5LXZhbHVlIGVudHJpZXMgZnJvbSB0aGUgaGFzaC5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQG5hbWUgY2xlYXJcbiAgICAgKiBAbWVtYmVyT2YgSGFzaFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGhhc2hDbGVhcigpIHtcbiAgICAgIHRoaXMuX19kYXRhX18gPSBuYXRpdmVDcmVhdGUgPyBuYXRpdmVDcmVhdGUobnVsbCkgOiB7fTtcbiAgICAgIHRoaXMuc2l6ZSA9IDA7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVtb3ZlcyBga2V5YCBhbmQgaXRzIHZhbHVlIGZyb20gdGhlIGhhc2guXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBuYW1lIGRlbGV0ZVxuICAgICAqIEBtZW1iZXJPZiBIYXNoXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGhhc2ggVGhlIGhhc2ggdG8gbW9kaWZ5LlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgVGhlIGtleSBvZiB0aGUgdmFsdWUgdG8gcmVtb3ZlLlxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgZW50cnkgd2FzIHJlbW92ZWQsIGVsc2UgYGZhbHNlYC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBoYXNoRGVsZXRlKGtleSkge1xuICAgICAgdmFyIHJlc3VsdCA9IHRoaXMuaGFzKGtleSkgJiYgZGVsZXRlIHRoaXMuX19kYXRhX19ba2V5XTtcbiAgICAgIHRoaXMuc2l6ZSAtPSByZXN1bHQgPyAxIDogMDtcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgaGFzaCB2YWx1ZSBmb3IgYGtleWAuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBuYW1lIGdldFxuICAgICAqIEBtZW1iZXJPZiBIYXNoXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGtleSBUaGUga2V5IG9mIHRoZSB2YWx1ZSB0byBnZXQuXG4gICAgICogQHJldHVybnMgeyp9IFJldHVybnMgdGhlIGVudHJ5IHZhbHVlLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGhhc2hHZXQoa2V5KSB7XG4gICAgICB2YXIgZGF0YSA9IHRoaXMuX19kYXRhX187XG4gICAgICBpZiAobmF0aXZlQ3JlYXRlKSB7XG4gICAgICAgIHZhciByZXN1bHQgPSBkYXRhW2tleV07XG4gICAgICAgIHJldHVybiByZXN1bHQgPT09IEhBU0hfVU5ERUZJTkVEID8gdW5kZWZpbmVkIDogcmVzdWx0O1xuICAgICAgfVxuICAgICAgcmV0dXJuIGhhc093blByb3BlcnR5LmNhbGwoZGF0YSwga2V5KSA/IGRhdGFba2V5XSA6IHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVja3MgaWYgYSBoYXNoIHZhbHVlIGZvciBga2V5YCBleGlzdHMuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBuYW1lIGhhc1xuICAgICAqIEBtZW1iZXJPZiBIYXNoXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGtleSBUaGUga2V5IG9mIHRoZSBlbnRyeSB0byBjaGVjay5cbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYW4gZW50cnkgZm9yIGBrZXlgIGV4aXN0cywgZWxzZSBgZmFsc2VgLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGhhc2hIYXMoa2V5KSB7XG4gICAgICB2YXIgZGF0YSA9IHRoaXMuX19kYXRhX187XG4gICAgICByZXR1cm4gbmF0aXZlQ3JlYXRlID8gKGRhdGFba2V5XSAhPT0gdW5kZWZpbmVkKSA6IGhhc093blByb3BlcnR5LmNhbGwoZGF0YSwga2V5KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXRzIHRoZSBoYXNoIGBrZXlgIHRvIGB2YWx1ZWAuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBuYW1lIHNldFxuICAgICAqIEBtZW1iZXJPZiBIYXNoXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGtleSBUaGUga2V5IG9mIHRoZSB2YWx1ZSB0byBzZXQuXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gc2V0LlxuICAgICAqIEByZXR1cm5zIHtPYmplY3R9IFJldHVybnMgdGhlIGhhc2ggaW5zdGFuY2UuXG4gICAgICovXG4gICAgZnVuY3Rpb24gaGFzaFNldChrZXksIHZhbHVlKSB7XG4gICAgICB2YXIgZGF0YSA9IHRoaXMuX19kYXRhX187XG4gICAgICB0aGlzLnNpemUgKz0gdGhpcy5oYXMoa2V5KSA/IDAgOiAxO1xuICAgICAgZGF0YVtrZXldID0gKG5hdGl2ZUNyZWF0ZSAmJiB2YWx1ZSA9PT0gdW5kZWZpbmVkKSA/IEhBU0hfVU5ERUZJTkVEIDogdmFsdWU7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICAvLyBBZGQgbWV0aG9kcyB0byBgSGFzaGAuXG4gICAgSGFzaC5wcm90b3R5cGUuY2xlYXIgPSBoYXNoQ2xlYXI7XG4gICAgSGFzaC5wcm90b3R5cGVbJ2RlbGV0ZSddID0gaGFzaERlbGV0ZTtcbiAgICBIYXNoLnByb3RvdHlwZS5nZXQgPSBoYXNoR2V0O1xuICAgIEhhc2gucHJvdG90eXBlLmhhcyA9IGhhc2hIYXM7XG4gICAgSGFzaC5wcm90b3R5cGUuc2V0ID0gaGFzaFNldDtcblxuICAgIC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW4gbGlzdCBjYWNoZSBvYmplY3QuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBwYXJhbSB7QXJyYXl9IFtlbnRyaWVzXSBUaGUga2V5LXZhbHVlIHBhaXJzIHRvIGNhY2hlLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIExpc3RDYWNoZShlbnRyaWVzKSB7XG4gICAgICB2YXIgaW5kZXggPSAtMSxcbiAgICAgICAgICBsZW5ndGggPSBlbnRyaWVzID09IG51bGwgPyAwIDogZW50cmllcy5sZW5ndGg7XG5cbiAgICAgIHRoaXMuY2xlYXIoKTtcbiAgICAgIHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG4gICAgICAgIHZhciBlbnRyeSA9IGVudHJpZXNbaW5kZXhdO1xuICAgICAgICB0aGlzLnNldChlbnRyeVswXSwgZW50cnlbMV0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlbW92ZXMgYWxsIGtleS12YWx1ZSBlbnRyaWVzIGZyb20gdGhlIGxpc3QgY2FjaGUuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBuYW1lIGNsZWFyXG4gICAgICogQG1lbWJlck9mIExpc3RDYWNoZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGxpc3RDYWNoZUNsZWFyKCkge1xuICAgICAgdGhpcy5fX2RhdGFfXyA9IFtdO1xuICAgICAgdGhpcy5zaXplID0gMDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZW1vdmVzIGBrZXlgIGFuZCBpdHMgdmFsdWUgZnJvbSB0aGUgbGlzdCBjYWNoZS5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQG5hbWUgZGVsZXRlXG4gICAgICogQG1lbWJlck9mIExpc3RDYWNoZVxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgVGhlIGtleSBvZiB0aGUgdmFsdWUgdG8gcmVtb3ZlLlxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgZW50cnkgd2FzIHJlbW92ZWQsIGVsc2UgYGZhbHNlYC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBsaXN0Q2FjaGVEZWxldGUoa2V5KSB7XG4gICAgICB2YXIgZGF0YSA9IHRoaXMuX19kYXRhX18sXG4gICAgICAgICAgaW5kZXggPSBhc3NvY0luZGV4T2YoZGF0YSwga2V5KTtcblxuICAgICAgaWYgKGluZGV4IDwgMCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICB2YXIgbGFzdEluZGV4ID0gZGF0YS5sZW5ndGggLSAxO1xuICAgICAgaWYgKGluZGV4ID09IGxhc3RJbmRleCkge1xuICAgICAgICBkYXRhLnBvcCgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc3BsaWNlLmNhbGwoZGF0YSwgaW5kZXgsIDEpO1xuICAgICAgfVxuICAgICAgLS10aGlzLnNpemU7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBsaXN0IGNhY2hlIHZhbHVlIGZvciBga2V5YC5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQG5hbWUgZ2V0XG4gICAgICogQG1lbWJlck9mIExpc3RDYWNoZVxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgVGhlIGtleSBvZiB0aGUgdmFsdWUgdG8gZ2V0LlxuICAgICAqIEByZXR1cm5zIHsqfSBSZXR1cm5zIHRoZSBlbnRyeSB2YWx1ZS5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBsaXN0Q2FjaGVHZXQoa2V5KSB7XG4gICAgICB2YXIgZGF0YSA9IHRoaXMuX19kYXRhX18sXG4gICAgICAgICAgaW5kZXggPSBhc3NvY0luZGV4T2YoZGF0YSwga2V5KTtcblxuICAgICAgcmV0dXJuIGluZGV4IDwgMCA/IHVuZGVmaW5lZCA6IGRhdGFbaW5kZXhdWzFdO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrcyBpZiBhIGxpc3QgY2FjaGUgdmFsdWUgZm9yIGBrZXlgIGV4aXN0cy5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQG5hbWUgaGFzXG4gICAgICogQG1lbWJlck9mIExpc3RDYWNoZVxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgVGhlIGtleSBvZiB0aGUgZW50cnkgdG8gY2hlY2suXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGFuIGVudHJ5IGZvciBga2V5YCBleGlzdHMsIGVsc2UgYGZhbHNlYC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBsaXN0Q2FjaGVIYXMoa2V5KSB7XG4gICAgICByZXR1cm4gYXNzb2NJbmRleE9mKHRoaXMuX19kYXRhX18sIGtleSkgPiAtMTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXRzIHRoZSBsaXN0IGNhY2hlIGBrZXlgIHRvIGB2YWx1ZWAuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBuYW1lIHNldFxuICAgICAqIEBtZW1iZXJPZiBMaXN0Q2FjaGVcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30ga2V5IFRoZSBrZXkgb2YgdGhlIHZhbHVlIHRvIHNldC5cbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBzZXQuXG4gICAgICogQHJldHVybnMge09iamVjdH0gUmV0dXJucyB0aGUgbGlzdCBjYWNoZSBpbnN0YW5jZS5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBsaXN0Q2FjaGVTZXQoa2V5LCB2YWx1ZSkge1xuICAgICAgdmFyIGRhdGEgPSB0aGlzLl9fZGF0YV9fLFxuICAgICAgICAgIGluZGV4ID0gYXNzb2NJbmRleE9mKGRhdGEsIGtleSk7XG5cbiAgICAgIGlmIChpbmRleCA8IDApIHtcbiAgICAgICAgKyt0aGlzLnNpemU7XG4gICAgICAgIGRhdGEucHVzaChba2V5LCB2YWx1ZV0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZGF0YVtpbmRleF1bMV0gPSB2YWx1ZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIC8vIEFkZCBtZXRob2RzIHRvIGBMaXN0Q2FjaGVgLlxuICAgIExpc3RDYWNoZS5wcm90b3R5cGUuY2xlYXIgPSBsaXN0Q2FjaGVDbGVhcjtcbiAgICBMaXN0Q2FjaGUucHJvdG90eXBlWydkZWxldGUnXSA9IGxpc3RDYWNoZURlbGV0ZTtcbiAgICBMaXN0Q2FjaGUucHJvdG90eXBlLmdldCA9IGxpc3RDYWNoZUdldDtcbiAgICBMaXN0Q2FjaGUucHJvdG90eXBlLmhhcyA9IGxpc3RDYWNoZUhhcztcbiAgICBMaXN0Q2FjaGUucHJvdG90eXBlLnNldCA9IGxpc3RDYWNoZVNldDtcblxuICAgIC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBtYXAgY2FjaGUgb2JqZWN0IHRvIHN0b3JlIGtleS12YWx1ZSBwYWlycy5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQHBhcmFtIHtBcnJheX0gW2VudHJpZXNdIFRoZSBrZXktdmFsdWUgcGFpcnMgdG8gY2FjaGUuXG4gICAgICovXG4gICAgZnVuY3Rpb24gTWFwQ2FjaGUoZW50cmllcykge1xuICAgICAgdmFyIGluZGV4ID0gLTEsXG4gICAgICAgICAgbGVuZ3RoID0gZW50cmllcyA9PSBudWxsID8gMCA6IGVudHJpZXMubGVuZ3RoO1xuXG4gICAgICB0aGlzLmNsZWFyKCk7XG4gICAgICB3aGlsZSAoKytpbmRleCA8IGxlbmd0aCkge1xuICAgICAgICB2YXIgZW50cnkgPSBlbnRyaWVzW2luZGV4XTtcbiAgICAgICAgdGhpcy5zZXQoZW50cnlbMF0sIGVudHJ5WzFdKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZW1vdmVzIGFsbCBrZXktdmFsdWUgZW50cmllcyBmcm9tIHRoZSBtYXAuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBuYW1lIGNsZWFyXG4gICAgICogQG1lbWJlck9mIE1hcENhY2hlXG4gICAgICovXG4gICAgZnVuY3Rpb24gbWFwQ2FjaGVDbGVhcigpIHtcbiAgICAgIHRoaXMuc2l6ZSA9IDA7XG4gICAgICB0aGlzLl9fZGF0YV9fID0ge1xuICAgICAgICAnaGFzaCc6IG5ldyBIYXNoLFxuICAgICAgICAnbWFwJzogbmV3IChNYXAgfHwgTGlzdENhY2hlKSxcbiAgICAgICAgJ3N0cmluZyc6IG5ldyBIYXNoXG4gICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlbW92ZXMgYGtleWAgYW5kIGl0cyB2YWx1ZSBmcm9tIHRoZSBtYXAuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBuYW1lIGRlbGV0ZVxuICAgICAqIEBtZW1iZXJPZiBNYXBDYWNoZVxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgVGhlIGtleSBvZiB0aGUgdmFsdWUgdG8gcmVtb3ZlLlxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgZW50cnkgd2FzIHJlbW92ZWQsIGVsc2UgYGZhbHNlYC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBtYXBDYWNoZURlbGV0ZShrZXkpIHtcbiAgICAgIHZhciByZXN1bHQgPSBnZXRNYXBEYXRhKHRoaXMsIGtleSlbJ2RlbGV0ZSddKGtleSk7XG4gICAgICB0aGlzLnNpemUgLT0gcmVzdWx0ID8gMSA6IDA7XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIG1hcCB2YWx1ZSBmb3IgYGtleWAuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBuYW1lIGdldFxuICAgICAqIEBtZW1iZXJPZiBNYXBDYWNoZVxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgVGhlIGtleSBvZiB0aGUgdmFsdWUgdG8gZ2V0LlxuICAgICAqIEByZXR1cm5zIHsqfSBSZXR1cm5zIHRoZSBlbnRyeSB2YWx1ZS5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBtYXBDYWNoZUdldChrZXkpIHtcbiAgICAgIHJldHVybiBnZXRNYXBEYXRhKHRoaXMsIGtleSkuZ2V0KGtleSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2tzIGlmIGEgbWFwIHZhbHVlIGZvciBga2V5YCBleGlzdHMuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBuYW1lIGhhc1xuICAgICAqIEBtZW1iZXJPZiBNYXBDYWNoZVxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgVGhlIGtleSBvZiB0aGUgZW50cnkgdG8gY2hlY2suXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGFuIGVudHJ5IGZvciBga2V5YCBleGlzdHMsIGVsc2UgYGZhbHNlYC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBtYXBDYWNoZUhhcyhrZXkpIHtcbiAgICAgIHJldHVybiBnZXRNYXBEYXRhKHRoaXMsIGtleSkuaGFzKGtleSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgbWFwIGBrZXlgIHRvIGB2YWx1ZWAuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBuYW1lIHNldFxuICAgICAqIEBtZW1iZXJPZiBNYXBDYWNoZVxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgVGhlIGtleSBvZiB0aGUgdmFsdWUgdG8gc2V0LlxuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIHNldC5cbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIHRoZSBtYXAgY2FjaGUgaW5zdGFuY2UuXG4gICAgICovXG4gICAgZnVuY3Rpb24gbWFwQ2FjaGVTZXQoa2V5LCB2YWx1ZSkge1xuICAgICAgdmFyIGRhdGEgPSBnZXRNYXBEYXRhKHRoaXMsIGtleSksXG4gICAgICAgICAgc2l6ZSA9IGRhdGEuc2l6ZTtcblxuICAgICAgZGF0YS5zZXQoa2V5LCB2YWx1ZSk7XG4gICAgICB0aGlzLnNpemUgKz0gZGF0YS5zaXplID09IHNpemUgPyAwIDogMTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIC8vIEFkZCBtZXRob2RzIHRvIGBNYXBDYWNoZWAuXG4gICAgTWFwQ2FjaGUucHJvdG90eXBlLmNsZWFyID0gbWFwQ2FjaGVDbGVhcjtcbiAgICBNYXBDYWNoZS5wcm90b3R5cGVbJ2RlbGV0ZSddID0gbWFwQ2FjaGVEZWxldGU7XG4gICAgTWFwQ2FjaGUucHJvdG90eXBlLmdldCA9IG1hcENhY2hlR2V0O1xuICAgIE1hcENhY2hlLnByb3RvdHlwZS5oYXMgPSBtYXBDYWNoZUhhcztcbiAgICBNYXBDYWNoZS5wcm90b3R5cGUuc2V0ID0gbWFwQ2FjaGVTZXQ7XG5cbiAgICAvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cbiAgICAvKipcbiAgICAgKlxuICAgICAqIENyZWF0ZXMgYW4gYXJyYXkgY2FjaGUgb2JqZWN0IHRvIHN0b3JlIHVuaXF1ZSB2YWx1ZXMuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBjb25zdHJ1Y3RvclxuICAgICAqIEBwYXJhbSB7QXJyYXl9IFt2YWx1ZXNdIFRoZSB2YWx1ZXMgdG8gY2FjaGUuXG4gICAgICovXG4gICAgZnVuY3Rpb24gU2V0Q2FjaGUodmFsdWVzKSB7XG4gICAgICB2YXIgaW5kZXggPSAtMSxcbiAgICAgICAgICBsZW5ndGggPSB2YWx1ZXMgPT0gbnVsbCA/IDAgOiB2YWx1ZXMubGVuZ3RoO1xuXG4gICAgICB0aGlzLl9fZGF0YV9fID0gbmV3IE1hcENhY2hlO1xuICAgICAgd2hpbGUgKCsraW5kZXggPCBsZW5ndGgpIHtcbiAgICAgICAgdGhpcy5hZGQodmFsdWVzW2luZGV4XSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkcyBgdmFsdWVgIHRvIHRoZSBhcnJheSBjYWNoZS5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQG5hbWUgYWRkXG4gICAgICogQG1lbWJlck9mIFNldENhY2hlXG4gICAgICogQGFsaWFzIHB1c2hcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjYWNoZS5cbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIHRoZSBjYWNoZSBpbnN0YW5jZS5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBzZXRDYWNoZUFkZCh2YWx1ZSkge1xuICAgICAgdGhpcy5fX2RhdGFfXy5zZXQodmFsdWUsIEhBU0hfVU5ERUZJTkVEKTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrcyBpZiBgdmFsdWVgIGlzIGluIHRoZSBhcnJheSBjYWNoZS5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQG5hbWUgaGFzXG4gICAgICogQG1lbWJlck9mIFNldENhY2hlXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gc2VhcmNoIGZvci5cbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSBSZXR1cm5zIGB0cnVlYCBpZiBgdmFsdWVgIGlzIGZvdW5kLCBlbHNlIGBmYWxzZWAuXG4gICAgICovXG4gICAgZnVuY3Rpb24gc2V0Q2FjaGVIYXModmFsdWUpIHtcbiAgICAgIHJldHVybiB0aGlzLl9fZGF0YV9fLmhhcyh2YWx1ZSk7XG4gICAgfVxuXG4gICAgLy8gQWRkIG1ldGhvZHMgdG8gYFNldENhY2hlYC5cbiAgICBTZXRDYWNoZS5wcm90b3R5cGUuYWRkID0gU2V0Q2FjaGUucHJvdG90eXBlLnB1c2ggPSBzZXRDYWNoZUFkZDtcbiAgICBTZXRDYWNoZS5wcm90b3R5cGUuaGFzID0gc2V0Q2FjaGVIYXM7XG5cbiAgICAvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgc3RhY2sgY2FjaGUgb2JqZWN0IHRvIHN0b3JlIGtleS12YWx1ZSBwYWlycy5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQGNvbnN0cnVjdG9yXG4gICAgICogQHBhcmFtIHtBcnJheX0gW2VudHJpZXNdIFRoZSBrZXktdmFsdWUgcGFpcnMgdG8gY2FjaGUuXG4gICAgICovXG4gICAgZnVuY3Rpb24gU3RhY2soZW50cmllcykge1xuICAgICAgdmFyIGRhdGEgPSB0aGlzLl9fZGF0YV9fID0gbmV3IExpc3RDYWNoZShlbnRyaWVzKTtcbiAgICAgIHRoaXMuc2l6ZSA9IGRhdGEuc2l6ZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZW1vdmVzIGFsbCBrZXktdmFsdWUgZW50cmllcyBmcm9tIHRoZSBzdGFjay5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQG5hbWUgY2xlYXJcbiAgICAgKiBAbWVtYmVyT2YgU3RhY2tcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBzdGFja0NsZWFyKCkge1xuICAgICAgdGhpcy5fX2RhdGFfXyA9IG5ldyBMaXN0Q2FjaGU7XG4gICAgICB0aGlzLnNpemUgPSAwO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlbW92ZXMgYGtleWAgYW5kIGl0cyB2YWx1ZSBmcm9tIHRoZSBzdGFjay5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQG5hbWUgZGVsZXRlXG4gICAgICogQG1lbWJlck9mIFN0YWNrXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGtleSBUaGUga2V5IG9mIHRoZSB2YWx1ZSB0byByZW1vdmUuXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIHRoZSBlbnRyeSB3YXMgcmVtb3ZlZCwgZWxzZSBgZmFsc2VgLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHN0YWNrRGVsZXRlKGtleSkge1xuICAgICAgdmFyIGRhdGEgPSB0aGlzLl9fZGF0YV9fLFxuICAgICAgICAgIHJlc3VsdCA9IGRhdGFbJ2RlbGV0ZSddKGtleSk7XG5cbiAgICAgIHRoaXMuc2l6ZSA9IGRhdGEuc2l6ZTtcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgc3RhY2sgdmFsdWUgZm9yIGBrZXlgLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAbmFtZSBnZXRcbiAgICAgKiBAbWVtYmVyT2YgU3RhY2tcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30ga2V5IFRoZSBrZXkgb2YgdGhlIHZhbHVlIHRvIGdldC5cbiAgICAgKiBAcmV0dXJucyB7Kn0gUmV0dXJucyB0aGUgZW50cnkgdmFsdWUuXG4gICAgICovXG4gICAgZnVuY3Rpb24gc3RhY2tHZXQoa2V5KSB7XG4gICAgICByZXR1cm4gdGhpcy5fX2RhdGFfXy5nZXQoa2V5KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVja3MgaWYgYSBzdGFjayB2YWx1ZSBmb3IgYGtleWAgZXhpc3RzLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAbmFtZSBoYXNcbiAgICAgKiBAbWVtYmVyT2YgU3RhY2tcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30ga2V5IFRoZSBrZXkgb2YgdGhlIGVudHJ5IHRvIGNoZWNrLlxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBhbiBlbnRyeSBmb3IgYGtleWAgZXhpc3RzLCBlbHNlIGBmYWxzZWAuXG4gICAgICovXG4gICAgZnVuY3Rpb24gc3RhY2tIYXMoa2V5KSB7XG4gICAgICByZXR1cm4gdGhpcy5fX2RhdGFfXy5oYXMoa2V5KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXRzIHRoZSBzdGFjayBga2V5YCB0byBgdmFsdWVgLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAbmFtZSBzZXRcbiAgICAgKiBAbWVtYmVyT2YgU3RhY2tcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30ga2V5IFRoZSBrZXkgb2YgdGhlIHZhbHVlIHRvIHNldC5cbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBzZXQuXG4gICAgICogQHJldHVybnMge09iamVjdH0gUmV0dXJucyB0aGUgc3RhY2sgY2FjaGUgaW5zdGFuY2UuXG4gICAgICovXG4gICAgZnVuY3Rpb24gc3RhY2tTZXQoa2V5LCB2YWx1ZSkge1xuICAgICAgdmFyIGRhdGEgPSB0aGlzLl9fZGF0YV9fO1xuICAgICAgaWYgKGRhdGEgaW5zdGFuY2VvZiBMaXN0Q2FjaGUpIHtcbiAgICAgICAgdmFyIHBhaXJzID0gZGF0YS5fX2RhdGFfXztcbiAgICAgICAgaWYgKCFNYXAgfHwgKHBhaXJzLmxlbmd0aCA8IExBUkdFX0FSUkFZX1NJWkUgLSAxKSkge1xuICAgICAgICAgIHBhaXJzLnB1c2goW2tleSwgdmFsdWVdKTtcbiAgICAgICAgICB0aGlzLnNpemUgPSArK2RhdGEuc2l6ZTtcbiAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuICAgICAgICBkYXRhID0gdGhpcy5fX2RhdGFfXyA9IG5ldyBNYXBDYWNoZShwYWlycyk7XG4gICAgICB9XG4gICAgICBkYXRhLnNldChrZXksIHZhbHVlKTtcbiAgICAgIHRoaXMuc2l6ZSA9IGRhdGEuc2l6ZTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIC8vIEFkZCBtZXRob2RzIHRvIGBTdGFja2AuXG4gICAgU3RhY2sucHJvdG90eXBlLmNsZWFyID0gc3RhY2tDbGVhcjtcbiAgICBTdGFjay5wcm90b3R5cGVbJ2RlbGV0ZSddID0gc3RhY2tEZWxldGU7XG4gICAgU3RhY2sucHJvdG90eXBlLmdldCA9IHN0YWNrR2V0O1xuICAgIFN0YWNrLnByb3RvdHlwZS5oYXMgPSBzdGFja0hhcztcbiAgICBTdGFjay5wcm90b3R5cGUuc2V0ID0gc3RhY2tTZXQ7XG5cbiAgICAvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuIGFycmF5IG9mIHRoZSBlbnVtZXJhYmxlIHByb3BlcnR5IG5hbWVzIG9mIHRoZSBhcnJheS1saWtlIGB2YWx1ZWAuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIHF1ZXJ5LlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gaW5oZXJpdGVkIFNwZWNpZnkgcmV0dXJuaW5nIGluaGVyaXRlZCBwcm9wZXJ0eSBuYW1lcy5cbiAgICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgdGhlIGFycmF5IG9mIHByb3BlcnR5IG5hbWVzLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGFycmF5TGlrZUtleXModmFsdWUsIGluaGVyaXRlZCkge1xuICAgICAgdmFyIGlzQXJyID0gaXNBcnJheSh2YWx1ZSksXG4gICAgICAgICAgaXNBcmcgPSAhaXNBcnIgJiYgaXNBcmd1bWVudHModmFsdWUpLFxuICAgICAgICAgIGlzQnVmZiA9ICFpc0FyciAmJiAhaXNBcmcgJiYgaXNCdWZmZXIodmFsdWUpLFxuICAgICAgICAgIGlzVHlwZSA9ICFpc0FyciAmJiAhaXNBcmcgJiYgIWlzQnVmZiAmJiBpc1R5cGVkQXJyYXkodmFsdWUpLFxuICAgICAgICAgIHNraXBJbmRleGVzID0gaXNBcnIgfHwgaXNBcmcgfHwgaXNCdWZmIHx8IGlzVHlwZSxcbiAgICAgICAgICByZXN1bHQgPSBza2lwSW5kZXhlcyA/IGJhc2VUaW1lcyh2YWx1ZS5sZW5ndGgsIFN0cmluZykgOiBbXSxcbiAgICAgICAgICBsZW5ndGggPSByZXN1bHQubGVuZ3RoO1xuXG4gICAgICBmb3IgKHZhciBrZXkgaW4gdmFsdWUpIHtcbiAgICAgICAgaWYgKChpbmhlcml0ZWQgfHwgaGFzT3duUHJvcGVydHkuY2FsbCh2YWx1ZSwga2V5KSkgJiZcbiAgICAgICAgICAgICEoc2tpcEluZGV4ZXMgJiYgKFxuICAgICAgICAgICAgICAgLy8gU2FmYXJpIDkgaGFzIGVudW1lcmFibGUgYGFyZ3VtZW50cy5sZW5ndGhgIGluIHN0cmljdCBtb2RlLlxuICAgICAgICAgICAgICAga2V5ID09ICdsZW5ndGgnIHx8XG4gICAgICAgICAgICAgICAvLyBOb2RlLmpzIDAuMTAgaGFzIGVudW1lcmFibGUgbm9uLWluZGV4IHByb3BlcnRpZXMgb24gYnVmZmVycy5cbiAgICAgICAgICAgICAgIChpc0J1ZmYgJiYgKGtleSA9PSAnb2Zmc2V0JyB8fCBrZXkgPT0gJ3BhcmVudCcpKSB8fFxuICAgICAgICAgICAgICAgLy8gUGhhbnRvbUpTIDIgaGFzIGVudW1lcmFibGUgbm9uLWluZGV4IHByb3BlcnRpZXMgb24gdHlwZWQgYXJyYXlzLlxuICAgICAgICAgICAgICAgKGlzVHlwZSAmJiAoa2V5ID09ICdidWZmZXInIHx8IGtleSA9PSAnYnl0ZUxlbmd0aCcgfHwga2V5ID09ICdieXRlT2Zmc2V0JykpIHx8XG4gICAgICAgICAgICAgICAvLyBTa2lwIGluZGV4IHByb3BlcnRpZXMuXG4gICAgICAgICAgICAgICBpc0luZGV4KGtleSwgbGVuZ3RoKVxuICAgICAgICAgICAgKSkpIHtcbiAgICAgICAgICByZXN1bHQucHVzaChrZXkpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEEgc3BlY2lhbGl6ZWQgdmVyc2lvbiBvZiBgXy5zYW1wbGVgIGZvciBhcnJheXMuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGFycmF5IFRoZSBhcnJheSB0byBzYW1wbGUuXG4gICAgICogQHJldHVybnMgeyp9IFJldHVybnMgdGhlIHJhbmRvbSBlbGVtZW50LlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGFycmF5U2FtcGxlKGFycmF5KSB7XG4gICAgICB2YXIgbGVuZ3RoID0gYXJyYXkubGVuZ3RoO1xuICAgICAgcmV0dXJuIGxlbmd0aCA/IGFycmF5W2Jhc2VSYW5kb20oMCwgbGVuZ3RoIC0gMSldIDogdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEEgc3BlY2lhbGl6ZWQgdmVyc2lvbiBvZiBgXy5zYW1wbGVTaXplYCBmb3IgYXJyYXlzLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBhcnJheSBUaGUgYXJyYXkgdG8gc2FtcGxlLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBuIFRoZSBudW1iZXIgb2YgZWxlbWVudHMgdG8gc2FtcGxlLlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgcmFuZG9tIGVsZW1lbnRzLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGFycmF5U2FtcGxlU2l6ZShhcnJheSwgbikge1xuICAgICAgcmV0dXJuIHNodWZmbGVTZWxmKGNvcHlBcnJheShhcnJheSksIGJhc2VDbGFtcChuLCAwLCBhcnJheS5sZW5ndGgpKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBIHNwZWNpYWxpemVkIHZlcnNpb24gb2YgYF8uc2h1ZmZsZWAgZm9yIGFycmF5cy5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIGFycmF5IHRvIHNodWZmbGUuXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIHRoZSBuZXcgc2h1ZmZsZWQgYXJyYXkuXG4gICAgICovXG4gICAgZnVuY3Rpb24gYXJyYXlTaHVmZmxlKGFycmF5KSB7XG4gICAgICByZXR1cm4gc2h1ZmZsZVNlbGYoY29weUFycmF5KGFycmF5KSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhpcyBmdW5jdGlvbiBpcyBsaWtlIGBhc3NpZ25WYWx1ZWAgZXhjZXB0IHRoYXQgaXQgZG9lc24ndCBhc3NpZ25cbiAgICAgKiBgdW5kZWZpbmVkYCB2YWx1ZXMuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIG9iamVjdCB0byBtb2RpZnkuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGtleSBUaGUga2V5IG9mIHRoZSBwcm9wZXJ0eSB0byBhc3NpZ24uXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gYXNzaWduLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGFzc2lnbk1lcmdlVmFsdWUob2JqZWN0LCBrZXksIHZhbHVlKSB7XG4gICAgICBpZiAoKHZhbHVlICE9PSB1bmRlZmluZWQgJiYgIWVxKG9iamVjdFtrZXldLCB2YWx1ZSkpIHx8XG4gICAgICAgICAgKHZhbHVlID09PSB1bmRlZmluZWQgJiYgIShrZXkgaW4gb2JqZWN0KSkpIHtcbiAgICAgICAgYmFzZUFzc2lnblZhbHVlKG9iamVjdCwga2V5LCB2YWx1ZSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQXNzaWducyBgdmFsdWVgIHRvIGBrZXlgIG9mIGBvYmplY3RgIGlmIHRoZSBleGlzdGluZyB2YWx1ZSBpcyBub3QgZXF1aXZhbGVudFxuICAgICAqIHVzaW5nIFtgU2FtZVZhbHVlWmVyb2BdKGh0dHA6Ly9lY21hLWludGVybmF0aW9uYWwub3JnL2VjbWEtMjYyLzcuMC8jc2VjLXNhbWV2YWx1ZXplcm8pXG4gICAgICogZm9yIGVxdWFsaXR5IGNvbXBhcmlzb25zLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8gbW9kaWZ5LlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgVGhlIGtleSBvZiB0aGUgcHJvcGVydHkgdG8gYXNzaWduLlxuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGFzc2lnbi5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBhc3NpZ25WYWx1ZShvYmplY3QsIGtleSwgdmFsdWUpIHtcbiAgICAgIHZhciBvYmpWYWx1ZSA9IG9iamVjdFtrZXldO1xuICAgICAgaWYgKCEoaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIGtleSkgJiYgZXEob2JqVmFsdWUsIHZhbHVlKSkgfHxcbiAgICAgICAgICAodmFsdWUgPT09IHVuZGVmaW5lZCAmJiAhKGtleSBpbiBvYmplY3QpKSkge1xuICAgICAgICBiYXNlQXNzaWduVmFsdWUob2JqZWN0LCBrZXksIHZhbHVlKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBpbmRleCBhdCB3aGljaCB0aGUgYGtleWAgaXMgZm91bmQgaW4gYGFycmF5YCBvZiBrZXktdmFsdWUgcGFpcnMuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGFycmF5IFRoZSBhcnJheSB0byBpbnNwZWN0LlxuICAgICAqIEBwYXJhbSB7Kn0ga2V5IFRoZSBrZXkgdG8gc2VhcmNoIGZvci5cbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSBSZXR1cm5zIHRoZSBpbmRleCBvZiB0aGUgbWF0Y2hlZCB2YWx1ZSwgZWxzZSBgLTFgLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGFzc29jSW5kZXhPZihhcnJheSwga2V5KSB7XG4gICAgICB2YXIgbGVuZ3RoID0gYXJyYXkubGVuZ3RoO1xuICAgICAgd2hpbGUgKGxlbmd0aC0tKSB7XG4gICAgICAgIGlmIChlcShhcnJheVtsZW5ndGhdWzBdLCBrZXkpKSB7XG4gICAgICAgICAgcmV0dXJuIGxlbmd0aDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIC0xO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFnZ3JlZ2F0ZXMgZWxlbWVudHMgb2YgYGNvbGxlY3Rpb25gIG9uIGBhY2N1bXVsYXRvcmAgd2l0aCBrZXlzIHRyYW5zZm9ybWVkXG4gICAgICogYnkgYGl0ZXJhdGVlYCBhbmQgdmFsdWVzIHNldCBieSBgc2V0dGVyYC5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtBcnJheXxPYmplY3R9IGNvbGxlY3Rpb24gVGhlIGNvbGxlY3Rpb24gdG8gaXRlcmF0ZSBvdmVyLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IHNldHRlciBUaGUgZnVuY3Rpb24gdG8gc2V0IGBhY2N1bXVsYXRvcmAgdmFsdWVzLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGl0ZXJhdGVlIFRoZSBpdGVyYXRlZSB0byB0cmFuc2Zvcm0ga2V5cy5cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gYWNjdW11bGF0b3IgVGhlIGluaXRpYWwgYWdncmVnYXRlZCBvYmplY3QuXG4gICAgICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIGBhY2N1bXVsYXRvcmAuXG4gICAgICovXG4gICAgZnVuY3Rpb24gYmFzZUFnZ3JlZ2F0b3IoY29sbGVjdGlvbiwgc2V0dGVyLCBpdGVyYXRlZSwgYWNjdW11bGF0b3IpIHtcbiAgICAgIGJhc2VFYWNoKGNvbGxlY3Rpb24sIGZ1bmN0aW9uKHZhbHVlLCBrZXksIGNvbGxlY3Rpb24pIHtcbiAgICAgICAgc2V0dGVyKGFjY3VtdWxhdG9yLCB2YWx1ZSwgaXRlcmF0ZWUodmFsdWUpLCBjb2xsZWN0aW9uKTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGFjY3VtdWxhdG9yO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBfLmFzc2lnbmAgd2l0aG91dCBzdXBwb3J0IGZvciBtdWx0aXBsZSBzb3VyY2VzXG4gICAgICogb3IgYGN1c3RvbWl6ZXJgIGZ1bmN0aW9ucy5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgZGVzdGluYXRpb24gb2JqZWN0LlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBzb3VyY2UgVGhlIHNvdXJjZSBvYmplY3QuXG4gICAgICogQHJldHVybnMge09iamVjdH0gUmV0dXJucyBgb2JqZWN0YC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBiYXNlQXNzaWduKG9iamVjdCwgc291cmNlKSB7XG4gICAgICByZXR1cm4gb2JqZWN0ICYmIGNvcHlPYmplY3Qoc291cmNlLCBrZXlzKHNvdXJjZSksIG9iamVjdCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIGJhc2UgaW1wbGVtZW50YXRpb24gb2YgYF8uYXNzaWduSW5gIHdpdGhvdXQgc3VwcG9ydCBmb3IgbXVsdGlwbGUgc291cmNlc1xuICAgICAqIG9yIGBjdXN0b21pemVyYCBmdW5jdGlvbnMuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIGRlc3RpbmF0aW9uIG9iamVjdC5cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gc291cmNlIFRoZSBzb3VyY2Ugb2JqZWN0LlxuICAgICAqIEByZXR1cm5zIHtPYmplY3R9IFJldHVybnMgYG9iamVjdGAuXG4gICAgICovXG4gICAgZnVuY3Rpb24gYmFzZUFzc2lnbkluKG9iamVjdCwgc291cmNlKSB7XG4gICAgICByZXR1cm4gb2JqZWN0ICYmIGNvcHlPYmplY3Qoc291cmNlLCBrZXlzSW4oc291cmNlKSwgb2JqZWN0KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgYmFzZSBpbXBsZW1lbnRhdGlvbiBvZiBgYXNzaWduVmFsdWVgIGFuZCBgYXNzaWduTWVyZ2VWYWx1ZWAgd2l0aG91dFxuICAgICAqIHZhbHVlIGNoZWNrcy5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgb2JqZWN0IHRvIG1vZGlmeS5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30ga2V5IFRoZSBrZXkgb2YgdGhlIHByb3BlcnR5IHRvIGFzc2lnbi5cbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBhc3NpZ24uXG4gICAgICovXG4gICAgZnVuY3Rpb24gYmFzZUFzc2lnblZhbHVlKG9iamVjdCwga2V5LCB2YWx1ZSkge1xuICAgICAgaWYgKGtleSA9PSAnX19wcm90b19fJyAmJiBkZWZpbmVQcm9wZXJ0eSkge1xuICAgICAgICBkZWZpbmVQcm9wZXJ0eShvYmplY3QsIGtleSwge1xuICAgICAgICAgICdjb25maWd1cmFibGUnOiB0cnVlLFxuICAgICAgICAgICdlbnVtZXJhYmxlJzogdHJ1ZSxcbiAgICAgICAgICAndmFsdWUnOiB2YWx1ZSxcbiAgICAgICAgICAnd3JpdGFibGUnOiB0cnVlXG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgb2JqZWN0W2tleV0gPSB2YWx1ZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgYmFzZSBpbXBsZW1lbnRhdGlvbiBvZiBgXy5hdGAgd2l0aG91dCBzdXBwb3J0IGZvciBpbmRpdmlkdWFsIHBhdGhzLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8gaXRlcmF0ZSBvdmVyLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nW119IHBhdGhzIFRoZSBwcm9wZXJ0eSBwYXRocyB0byBwaWNrLlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgcGlja2VkIGVsZW1lbnRzLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGJhc2VBdChvYmplY3QsIHBhdGhzKSB7XG4gICAgICB2YXIgaW5kZXggPSAtMSxcbiAgICAgICAgICBsZW5ndGggPSBwYXRocy5sZW5ndGgsXG4gICAgICAgICAgcmVzdWx0ID0gQXJyYXkobGVuZ3RoKSxcbiAgICAgICAgICBza2lwID0gb2JqZWN0ID09IG51bGw7XG5cbiAgICAgIHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG4gICAgICAgIHJlc3VsdFtpbmRleF0gPSBza2lwID8gdW5kZWZpbmVkIDogZ2V0KG9iamVjdCwgcGF0aHNbaW5kZXhdKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIGJhc2UgaW1wbGVtZW50YXRpb24gb2YgYF8uY2xhbXBgIHdoaWNoIGRvZXNuJ3QgY29lcmNlIGFyZ3VtZW50cy5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IG51bWJlciBUaGUgbnVtYmVyIHRvIGNsYW1wLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbbG93ZXJdIFRoZSBsb3dlciBib3VuZC5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gdXBwZXIgVGhlIHVwcGVyIGJvdW5kLlxuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IFJldHVybnMgdGhlIGNsYW1wZWQgbnVtYmVyLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGJhc2VDbGFtcChudW1iZXIsIGxvd2VyLCB1cHBlcikge1xuICAgICAgaWYgKG51bWJlciA9PT0gbnVtYmVyKSB7XG4gICAgICAgIGlmICh1cHBlciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgbnVtYmVyID0gbnVtYmVyIDw9IHVwcGVyID8gbnVtYmVyIDogdXBwZXI7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGxvd2VyICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICBudW1iZXIgPSBudW1iZXIgPj0gbG93ZXIgPyBudW1iZXIgOiBsb3dlcjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIG51bWJlcjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgYmFzZSBpbXBsZW1lbnRhdGlvbiBvZiBgXy5jbG9uZWAgYW5kIGBfLmNsb25lRGVlcGAgd2hpY2ggdHJhY2tzXG4gICAgICogdHJhdmVyc2VkIG9iamVjdHMuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNsb25lLlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gYml0bWFzayBUaGUgYml0bWFzayBmbGFncy5cbiAgICAgKiAgMSAtIERlZXAgY2xvbmVcbiAgICAgKiAgMiAtIEZsYXR0ZW4gaW5oZXJpdGVkIHByb3BlcnRpZXNcbiAgICAgKiAgNCAtIENsb25lIHN5bWJvbHNcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbY3VzdG9taXplcl0gVGhlIGZ1bmN0aW9uIHRvIGN1c3RvbWl6ZSBjbG9uaW5nLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBba2V5XSBUaGUga2V5IG9mIGB2YWx1ZWAuXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtvYmplY3RdIFRoZSBwYXJlbnQgb2JqZWN0IG9mIGB2YWx1ZWAuXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtzdGFja10gVHJhY2tzIHRyYXZlcnNlZCBvYmplY3RzIGFuZCB0aGVpciBjbG9uZSBjb3VudGVycGFydHMuXG4gICAgICogQHJldHVybnMgeyp9IFJldHVybnMgdGhlIGNsb25lZCB2YWx1ZS5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBiYXNlQ2xvbmUodmFsdWUsIGJpdG1hc2ssIGN1c3RvbWl6ZXIsIGtleSwgb2JqZWN0LCBzdGFjaykge1xuICAgICAgdmFyIHJlc3VsdCxcbiAgICAgICAgICBpc0RlZXAgPSBiaXRtYXNrICYgQ0xPTkVfREVFUF9GTEFHLFxuICAgICAgICAgIGlzRmxhdCA9IGJpdG1hc2sgJiBDTE9ORV9GTEFUX0ZMQUcsXG4gICAgICAgICAgaXNGdWxsID0gYml0bWFzayAmIENMT05FX1NZTUJPTFNfRkxBRztcblxuICAgICAgaWYgKGN1c3RvbWl6ZXIpIHtcbiAgICAgICAgcmVzdWx0ID0gb2JqZWN0ID8gY3VzdG9taXplcih2YWx1ZSwga2V5LCBvYmplY3QsIHN0YWNrKSA6IGN1c3RvbWl6ZXIodmFsdWUpO1xuICAgICAgfVxuICAgICAgaWYgKHJlc3VsdCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICB9XG4gICAgICBpZiAoIWlzT2JqZWN0KHZhbHVlKSkge1xuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICB9XG4gICAgICB2YXIgaXNBcnIgPSBpc0FycmF5KHZhbHVlKTtcbiAgICAgIGlmIChpc0Fycikge1xuICAgICAgICByZXN1bHQgPSBpbml0Q2xvbmVBcnJheSh2YWx1ZSk7XG4gICAgICAgIGlmICghaXNEZWVwKSB7XG4gICAgICAgICAgcmV0dXJuIGNvcHlBcnJheSh2YWx1ZSwgcmVzdWx0KTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIHRhZyA9IGdldFRhZyh2YWx1ZSksXG4gICAgICAgICAgICBpc0Z1bmMgPSB0YWcgPT0gZnVuY1RhZyB8fCB0YWcgPT0gZ2VuVGFnO1xuXG4gICAgICAgIGlmIChpc0J1ZmZlcih2YWx1ZSkpIHtcbiAgICAgICAgICByZXR1cm4gY2xvbmVCdWZmZXIodmFsdWUsIGlzRGVlcCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRhZyA9PSBvYmplY3RUYWcgfHwgdGFnID09IGFyZ3NUYWcgfHwgKGlzRnVuYyAmJiAhb2JqZWN0KSkge1xuICAgICAgICAgIHJlc3VsdCA9IChpc0ZsYXQgfHwgaXNGdW5jKSA/IHt9IDogaW5pdENsb25lT2JqZWN0KHZhbHVlKTtcbiAgICAgICAgICBpZiAoIWlzRGVlcCkge1xuICAgICAgICAgICAgcmV0dXJuIGlzRmxhdFxuICAgICAgICAgICAgICA/IGNvcHlTeW1ib2xzSW4odmFsdWUsIGJhc2VBc3NpZ25JbihyZXN1bHQsIHZhbHVlKSlcbiAgICAgICAgICAgICAgOiBjb3B5U3ltYm9scyh2YWx1ZSwgYmFzZUFzc2lnbihyZXN1bHQsIHZhbHVlKSk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmICghY2xvbmVhYmxlVGFnc1t0YWddKSB7XG4gICAgICAgICAgICByZXR1cm4gb2JqZWN0ID8gdmFsdWUgOiB7fTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmVzdWx0ID0gaW5pdENsb25lQnlUYWcodmFsdWUsIHRhZywgaXNEZWVwKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgLy8gQ2hlY2sgZm9yIGNpcmN1bGFyIHJlZmVyZW5jZXMgYW5kIHJldHVybiBpdHMgY29ycmVzcG9uZGluZyBjbG9uZS5cbiAgICAgIHN0YWNrIHx8IChzdGFjayA9IG5ldyBTdGFjayk7XG4gICAgICB2YXIgc3RhY2tlZCA9IHN0YWNrLmdldCh2YWx1ZSk7XG4gICAgICBpZiAoc3RhY2tlZCkge1xuICAgICAgICByZXR1cm4gc3RhY2tlZDtcbiAgICAgIH1cbiAgICAgIHN0YWNrLnNldCh2YWx1ZSwgcmVzdWx0KTtcblxuICAgICAgaWYgKGlzU2V0KHZhbHVlKSkge1xuICAgICAgICB2YWx1ZS5mb3JFYWNoKGZ1bmN0aW9uKHN1YlZhbHVlKSB7XG4gICAgICAgICAgcmVzdWx0LmFkZChiYXNlQ2xvbmUoc3ViVmFsdWUsIGJpdG1hc2ssIGN1c3RvbWl6ZXIsIHN1YlZhbHVlLCB2YWx1ZSwgc3RhY2spKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgIH1cblxuICAgICAgaWYgKGlzTWFwKHZhbHVlKSkge1xuICAgICAgICB2YWx1ZS5mb3JFYWNoKGZ1bmN0aW9uKHN1YlZhbHVlLCBrZXkpIHtcbiAgICAgICAgICByZXN1bHQuc2V0KGtleSwgYmFzZUNsb25lKHN1YlZhbHVlLCBiaXRtYXNrLCBjdXN0b21pemVyLCBrZXksIHZhbHVlLCBzdGFjaykpO1xuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgfVxuXG4gICAgICB2YXIga2V5c0Z1bmMgPSBpc0Z1bGxcbiAgICAgICAgPyAoaXNGbGF0ID8gZ2V0QWxsS2V5c0luIDogZ2V0QWxsS2V5cylcbiAgICAgICAgOiAoaXNGbGF0ID8ga2V5c0luIDoga2V5cyk7XG5cbiAgICAgIHZhciBwcm9wcyA9IGlzQXJyID8gdW5kZWZpbmVkIDoga2V5c0Z1bmModmFsdWUpO1xuICAgICAgYXJyYXlFYWNoKHByb3BzIHx8IHZhbHVlLCBmdW5jdGlvbihzdWJWYWx1ZSwga2V5KSB7XG4gICAgICAgIGlmIChwcm9wcykge1xuICAgICAgICAgIGtleSA9IHN1YlZhbHVlO1xuICAgICAgICAgIHN1YlZhbHVlID0gdmFsdWVba2V5XTtcbiAgICAgICAgfVxuICAgICAgICAvLyBSZWN1cnNpdmVseSBwb3B1bGF0ZSBjbG9uZSAoc3VzY2VwdGlibGUgdG8gY2FsbCBzdGFjayBsaW1pdHMpLlxuICAgICAgICBhc3NpZ25WYWx1ZShyZXN1bHQsIGtleSwgYmFzZUNsb25lKHN1YlZhbHVlLCBiaXRtYXNrLCBjdXN0b21pemVyLCBrZXksIHZhbHVlLCBzdGFjaykpO1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBfLmNvbmZvcm1zYCB3aGljaCBkb2Vzbid0IGNsb25lIGBzb3VyY2VgLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gc291cmNlIFRoZSBvYmplY3Qgb2YgcHJvcGVydHkgcHJlZGljYXRlcyB0byBjb25mb3JtIHRvLlxuICAgICAqIEByZXR1cm5zIHtGdW5jdGlvbn0gUmV0dXJucyB0aGUgbmV3IHNwZWMgZnVuY3Rpb24uXG4gICAgICovXG4gICAgZnVuY3Rpb24gYmFzZUNvbmZvcm1zKHNvdXJjZSkge1xuICAgICAgdmFyIHByb3BzID0ga2V5cyhzb3VyY2UpO1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uKG9iamVjdCkge1xuICAgICAgICByZXR1cm4gYmFzZUNvbmZvcm1zVG8ob2JqZWN0LCBzb3VyY2UsIHByb3BzKTtcbiAgICAgIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIGJhc2UgaW1wbGVtZW50YXRpb24gb2YgYF8uY29uZm9ybXNUb2Agd2hpY2ggYWNjZXB0cyBgcHJvcHNgIHRvIGNoZWNrLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8gaW5zcGVjdC5cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gc291cmNlIFRoZSBvYmplY3Qgb2YgcHJvcGVydHkgcHJlZGljYXRlcyB0byBjb25mb3JtIHRvLlxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBgb2JqZWN0YCBjb25mb3JtcywgZWxzZSBgZmFsc2VgLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGJhc2VDb25mb3Jtc1RvKG9iamVjdCwgc291cmNlLCBwcm9wcykge1xuICAgICAgdmFyIGxlbmd0aCA9IHByb3BzLmxlbmd0aDtcbiAgICAgIGlmIChvYmplY3QgPT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gIWxlbmd0aDtcbiAgICAgIH1cbiAgICAgIG9iamVjdCA9IE9iamVjdChvYmplY3QpO1xuICAgICAgd2hpbGUgKGxlbmd0aC0tKSB7XG4gICAgICAgIHZhciBrZXkgPSBwcm9wc1tsZW5ndGhdLFxuICAgICAgICAgICAgcHJlZGljYXRlID0gc291cmNlW2tleV0sXG4gICAgICAgICAgICB2YWx1ZSA9IG9iamVjdFtrZXldO1xuXG4gICAgICAgIGlmICgodmFsdWUgPT09IHVuZGVmaW5lZCAmJiAhKGtleSBpbiBvYmplY3QpKSB8fCAhcHJlZGljYXRlKHZhbHVlKSkge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIGJhc2UgaW1wbGVtZW50YXRpb24gb2YgYF8uZGVsYXlgIGFuZCBgXy5kZWZlcmAgd2hpY2ggYWNjZXB0cyBgYXJnc2BcbiAgICAgKiB0byBwcm92aWRlIHRvIGBmdW5jYC5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZnVuYyBUaGUgZnVuY3Rpb24gdG8gZGVsYXkuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHdhaXQgVGhlIG51bWJlciBvZiBtaWxsaXNlY29uZHMgdG8gZGVsYXkgaW52b2NhdGlvbi5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBhcmdzIFRoZSBhcmd1bWVudHMgdG8gcHJvdmlkZSB0byBgZnVuY2AuXG4gICAgICogQHJldHVybnMge251bWJlcnxPYmplY3R9IFJldHVybnMgdGhlIHRpbWVyIGlkIG9yIHRpbWVvdXQgb2JqZWN0LlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGJhc2VEZWxheShmdW5jLCB3YWl0LCBhcmdzKSB7XG4gICAgICBpZiAodHlwZW9mIGZ1bmMgIT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKEZVTkNfRVJST1JfVEVYVCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gc2V0VGltZW91dChmdW5jdGlvbigpIHsgZnVuYy5hcHBseSh1bmRlZmluZWQsIGFyZ3MpOyB9LCB3YWl0KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgYmFzZSBpbXBsZW1lbnRhdGlvbiBvZiBtZXRob2RzIGxpa2UgYF8uZGlmZmVyZW5jZWAgd2l0aG91dCBzdXBwb3J0XG4gICAgICogZm9yIGV4Y2x1ZGluZyBtdWx0aXBsZSBhcnJheXMgb3IgaXRlcmF0ZWUgc2hvcnRoYW5kcy5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIGFycmF5IHRvIGluc3BlY3QuXG4gICAgICogQHBhcmFtIHtBcnJheX0gdmFsdWVzIFRoZSB2YWx1ZXMgdG8gZXhjbHVkZS5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbaXRlcmF0ZWVdIFRoZSBpdGVyYXRlZSBpbnZva2VkIHBlciBlbGVtZW50LlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtjb21wYXJhdG9yXSBUaGUgY29tcGFyYXRvciBpbnZva2VkIHBlciBlbGVtZW50LlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgbmV3IGFycmF5IG9mIGZpbHRlcmVkIHZhbHVlcy5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBiYXNlRGlmZmVyZW5jZShhcnJheSwgdmFsdWVzLCBpdGVyYXRlZSwgY29tcGFyYXRvcikge1xuICAgICAgdmFyIGluZGV4ID0gLTEsXG4gICAgICAgICAgaW5jbHVkZXMgPSBhcnJheUluY2x1ZGVzLFxuICAgICAgICAgIGlzQ29tbW9uID0gdHJ1ZSxcbiAgICAgICAgICBsZW5ndGggPSBhcnJheS5sZW5ndGgsXG4gICAgICAgICAgcmVzdWx0ID0gW10sXG4gICAgICAgICAgdmFsdWVzTGVuZ3RoID0gdmFsdWVzLmxlbmd0aDtcblxuICAgICAgaWYgKCFsZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgIH1cbiAgICAgIGlmIChpdGVyYXRlZSkge1xuICAgICAgICB2YWx1ZXMgPSBhcnJheU1hcCh2YWx1ZXMsIGJhc2VVbmFyeShpdGVyYXRlZSkpO1xuICAgICAgfVxuICAgICAgaWYgKGNvbXBhcmF0b3IpIHtcbiAgICAgICAgaW5jbHVkZXMgPSBhcnJheUluY2x1ZGVzV2l0aDtcbiAgICAgICAgaXNDb21tb24gPSBmYWxzZTtcbiAgICAgIH1cbiAgICAgIGVsc2UgaWYgKHZhbHVlcy5sZW5ndGggPj0gTEFSR0VfQVJSQVlfU0laRSkge1xuICAgICAgICBpbmNsdWRlcyA9IGNhY2hlSGFzO1xuICAgICAgICBpc0NvbW1vbiA9IGZhbHNlO1xuICAgICAgICB2YWx1ZXMgPSBuZXcgU2V0Q2FjaGUodmFsdWVzKTtcbiAgICAgIH1cbiAgICAgIG91dGVyOlxuICAgICAgd2hpbGUgKCsraW5kZXggPCBsZW5ndGgpIHtcbiAgICAgICAgdmFyIHZhbHVlID0gYXJyYXlbaW5kZXhdLFxuICAgICAgICAgICAgY29tcHV0ZWQgPSBpdGVyYXRlZSA9PSBudWxsID8gdmFsdWUgOiBpdGVyYXRlZSh2YWx1ZSk7XG5cbiAgICAgICAgdmFsdWUgPSAoY29tcGFyYXRvciB8fCB2YWx1ZSAhPT0gMCkgPyB2YWx1ZSA6IDA7XG4gICAgICAgIGlmIChpc0NvbW1vbiAmJiBjb21wdXRlZCA9PT0gY29tcHV0ZWQpIHtcbiAgICAgICAgICB2YXIgdmFsdWVzSW5kZXggPSB2YWx1ZXNMZW5ndGg7XG4gICAgICAgICAgd2hpbGUgKHZhbHVlc0luZGV4LS0pIHtcbiAgICAgICAgICAgIGlmICh2YWx1ZXNbdmFsdWVzSW5kZXhdID09PSBjb21wdXRlZCkge1xuICAgICAgICAgICAgICBjb250aW51ZSBvdXRlcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgcmVzdWx0LnB1c2godmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKCFpbmNsdWRlcyh2YWx1ZXMsIGNvbXB1dGVkLCBjb21wYXJhdG9yKSkge1xuICAgICAgICAgIHJlc3VsdC5wdXNoKHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgYmFzZSBpbXBsZW1lbnRhdGlvbiBvZiBgXy5mb3JFYWNoYCB3aXRob3V0IHN1cHBvcnQgZm9yIGl0ZXJhdGVlIHNob3J0aGFuZHMuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7QXJyYXl8T2JqZWN0fSBjb2xsZWN0aW9uIFRoZSBjb2xsZWN0aW9uIHRvIGl0ZXJhdGUgb3Zlci5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBpdGVyYXRlZSBUaGUgZnVuY3Rpb24gaW52b2tlZCBwZXIgaXRlcmF0aW9uLlxuICAgICAqIEByZXR1cm5zIHtBcnJheXxPYmplY3R9IFJldHVybnMgYGNvbGxlY3Rpb25gLlxuICAgICAqL1xuICAgIHZhciBiYXNlRWFjaCA9IGNyZWF0ZUJhc2VFYWNoKGJhc2VGb3JPd24pO1xuXG4gICAgLyoqXG4gICAgICogVGhlIGJhc2UgaW1wbGVtZW50YXRpb24gb2YgYF8uZm9yRWFjaFJpZ2h0YCB3aXRob3V0IHN1cHBvcnQgZm9yIGl0ZXJhdGVlIHNob3J0aGFuZHMuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7QXJyYXl8T2JqZWN0fSBjb2xsZWN0aW9uIFRoZSBjb2xsZWN0aW9uIHRvIGl0ZXJhdGUgb3Zlci5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBpdGVyYXRlZSBUaGUgZnVuY3Rpb24gaW52b2tlZCBwZXIgaXRlcmF0aW9uLlxuICAgICAqIEByZXR1cm5zIHtBcnJheXxPYmplY3R9IFJldHVybnMgYGNvbGxlY3Rpb25gLlxuICAgICAqL1xuICAgIHZhciBiYXNlRWFjaFJpZ2h0ID0gY3JlYXRlQmFzZUVhY2goYmFzZUZvck93blJpZ2h0LCB0cnVlKTtcblxuICAgIC8qKlxuICAgICAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBfLmV2ZXJ5YCB3aXRob3V0IHN1cHBvcnQgZm9yIGl0ZXJhdGVlIHNob3J0aGFuZHMuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7QXJyYXl8T2JqZWN0fSBjb2xsZWN0aW9uIFRoZSBjb2xsZWN0aW9uIHRvIGl0ZXJhdGUgb3Zlci5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBwcmVkaWNhdGUgVGhlIGZ1bmN0aW9uIGludm9rZWQgcGVyIGl0ZXJhdGlvbi5cbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYWxsIGVsZW1lbnRzIHBhc3MgdGhlIHByZWRpY2F0ZSBjaGVjayxcbiAgICAgKiAgZWxzZSBgZmFsc2VgXG4gICAgICovXG4gICAgZnVuY3Rpb24gYmFzZUV2ZXJ5KGNvbGxlY3Rpb24sIHByZWRpY2F0ZSkge1xuICAgICAgdmFyIHJlc3VsdCA9IHRydWU7XG4gICAgICBiYXNlRWFjaChjb2xsZWN0aW9uLCBmdW5jdGlvbih2YWx1ZSwgaW5kZXgsIGNvbGxlY3Rpb24pIHtcbiAgICAgICAgcmVzdWx0ID0gISFwcmVkaWNhdGUodmFsdWUsIGluZGV4LCBjb2xsZWN0aW9uKTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgYmFzZSBpbXBsZW1lbnRhdGlvbiBvZiBtZXRob2RzIGxpa2UgYF8ubWF4YCBhbmQgYF8ubWluYCB3aGljaCBhY2NlcHRzIGFcbiAgICAgKiBgY29tcGFyYXRvcmAgdG8gZGV0ZXJtaW5lIHRoZSBleHRyZW11bSB2YWx1ZS5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIGFycmF5IHRvIGl0ZXJhdGUgb3Zlci5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBpdGVyYXRlZSBUaGUgaXRlcmF0ZWUgaW52b2tlZCBwZXIgaXRlcmF0aW9uLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGNvbXBhcmF0b3IgVGhlIGNvbXBhcmF0b3IgdXNlZCB0byBjb21wYXJlIHZhbHVlcy5cbiAgICAgKiBAcmV0dXJucyB7Kn0gUmV0dXJucyB0aGUgZXh0cmVtdW0gdmFsdWUuXG4gICAgICovXG4gICAgZnVuY3Rpb24gYmFzZUV4dHJlbXVtKGFycmF5LCBpdGVyYXRlZSwgY29tcGFyYXRvcikge1xuICAgICAgdmFyIGluZGV4ID0gLTEsXG4gICAgICAgICAgbGVuZ3RoID0gYXJyYXkubGVuZ3RoO1xuXG4gICAgICB3aGlsZSAoKytpbmRleCA8IGxlbmd0aCkge1xuICAgICAgICB2YXIgdmFsdWUgPSBhcnJheVtpbmRleF0sXG4gICAgICAgICAgICBjdXJyZW50ID0gaXRlcmF0ZWUodmFsdWUpO1xuXG4gICAgICAgIGlmIChjdXJyZW50ICE9IG51bGwgJiYgKGNvbXB1dGVkID09PSB1bmRlZmluZWRcbiAgICAgICAgICAgICAgPyAoY3VycmVudCA9PT0gY3VycmVudCAmJiAhaXNTeW1ib2woY3VycmVudCkpXG4gICAgICAgICAgICAgIDogY29tcGFyYXRvcihjdXJyZW50LCBjb21wdXRlZClcbiAgICAgICAgICAgICkpIHtcbiAgICAgICAgICB2YXIgY29tcHV0ZWQgPSBjdXJyZW50LFxuICAgICAgICAgICAgICByZXN1bHQgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgYmFzZSBpbXBsZW1lbnRhdGlvbiBvZiBgXy5maWxsYCB3aXRob3V0IGFuIGl0ZXJhdGVlIGNhbGwgZ3VhcmQuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGFycmF5IFRoZSBhcnJheSB0byBmaWxsLlxuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGZpbGwgYGFycmF5YCB3aXRoLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbc3RhcnQ9MF0gVGhlIHN0YXJ0IHBvc2l0aW9uLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbZW5kPWFycmF5Lmxlbmd0aF0gVGhlIGVuZCBwb3NpdGlvbi5cbiAgICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgYGFycmF5YC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBiYXNlRmlsbChhcnJheSwgdmFsdWUsIHN0YXJ0LCBlbmQpIHtcbiAgICAgIHZhciBsZW5ndGggPSBhcnJheS5sZW5ndGg7XG5cbiAgICAgIHN0YXJ0ID0gdG9JbnRlZ2VyKHN0YXJ0KTtcbiAgICAgIGlmIChzdGFydCA8IDApIHtcbiAgICAgICAgc3RhcnQgPSAtc3RhcnQgPiBsZW5ndGggPyAwIDogKGxlbmd0aCArIHN0YXJ0KTtcbiAgICAgIH1cbiAgICAgIGVuZCA9IChlbmQgPT09IHVuZGVmaW5lZCB8fCBlbmQgPiBsZW5ndGgpID8gbGVuZ3RoIDogdG9JbnRlZ2VyKGVuZCk7XG4gICAgICBpZiAoZW5kIDwgMCkge1xuICAgICAgICBlbmQgKz0gbGVuZ3RoO1xuICAgICAgfVxuICAgICAgZW5kID0gc3RhcnQgPiBlbmQgPyAwIDogdG9MZW5ndGgoZW5kKTtcbiAgICAgIHdoaWxlIChzdGFydCA8IGVuZCkge1xuICAgICAgICBhcnJheVtzdGFydCsrXSA9IHZhbHVlO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGFycmF5O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBfLmZpbHRlcmAgd2l0aG91dCBzdXBwb3J0IGZvciBpdGVyYXRlZSBzaG9ydGhhbmRzLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge0FycmF5fE9iamVjdH0gY29sbGVjdGlvbiBUaGUgY29sbGVjdGlvbiB0byBpdGVyYXRlIG92ZXIuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gcHJlZGljYXRlIFRoZSBmdW5jdGlvbiBpbnZva2VkIHBlciBpdGVyYXRpb24uXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIHRoZSBuZXcgZmlsdGVyZWQgYXJyYXkuXG4gICAgICovXG4gICAgZnVuY3Rpb24gYmFzZUZpbHRlcihjb2xsZWN0aW9uLCBwcmVkaWNhdGUpIHtcbiAgICAgIHZhciByZXN1bHQgPSBbXTtcbiAgICAgIGJhc2VFYWNoKGNvbGxlY3Rpb24sIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgY29sbGVjdGlvbikge1xuICAgICAgICBpZiAocHJlZGljYXRlKHZhbHVlLCBpbmRleCwgY29sbGVjdGlvbikpIHtcbiAgICAgICAgICByZXN1bHQucHVzaCh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgYmFzZSBpbXBsZW1lbnRhdGlvbiBvZiBgXy5mbGF0dGVuYCB3aXRoIHN1cHBvcnQgZm9yIHJlc3RyaWN0aW5nIGZsYXR0ZW5pbmcuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGFycmF5IFRoZSBhcnJheSB0byBmbGF0dGVuLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBkZXB0aCBUaGUgbWF4aW11bSByZWN1cnNpb24gZGVwdGguXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbcHJlZGljYXRlPWlzRmxhdHRlbmFibGVdIFRoZSBmdW5jdGlvbiBpbnZva2VkIHBlciBpdGVyYXRpb24uXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbaXNTdHJpY3RdIFJlc3RyaWN0IHRvIHZhbHVlcyB0aGF0IHBhc3MgYHByZWRpY2F0ZWAgY2hlY2tzLlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IFtyZXN1bHQ9W11dIFRoZSBpbml0aWFsIHJlc3VsdCB2YWx1ZS5cbiAgICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgdGhlIG5ldyBmbGF0dGVuZWQgYXJyYXkuXG4gICAgICovXG4gICAgZnVuY3Rpb24gYmFzZUZsYXR0ZW4oYXJyYXksIGRlcHRoLCBwcmVkaWNhdGUsIGlzU3RyaWN0LCByZXN1bHQpIHtcbiAgICAgIHZhciBpbmRleCA9IC0xLFxuICAgICAgICAgIGxlbmd0aCA9IGFycmF5Lmxlbmd0aDtcblxuICAgICAgcHJlZGljYXRlIHx8IChwcmVkaWNhdGUgPSBpc0ZsYXR0ZW5hYmxlKTtcbiAgICAgIHJlc3VsdCB8fCAocmVzdWx0ID0gW10pO1xuXG4gICAgICB3aGlsZSAoKytpbmRleCA8IGxlbmd0aCkge1xuICAgICAgICB2YXIgdmFsdWUgPSBhcnJheVtpbmRleF07XG4gICAgICAgIGlmIChkZXB0aCA+IDAgJiYgcHJlZGljYXRlKHZhbHVlKSkge1xuICAgICAgICAgIGlmIChkZXB0aCA+IDEpIHtcbiAgICAgICAgICAgIC8vIFJlY3Vyc2l2ZWx5IGZsYXR0ZW4gYXJyYXlzIChzdXNjZXB0aWJsZSB0byBjYWxsIHN0YWNrIGxpbWl0cykuXG4gICAgICAgICAgICBiYXNlRmxhdHRlbih2YWx1ZSwgZGVwdGggLSAxLCBwcmVkaWNhdGUsIGlzU3RyaWN0LCByZXN1bHQpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBhcnJheVB1c2gocmVzdWx0LCB2YWx1ZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKCFpc1N0cmljdCkge1xuICAgICAgICAgIHJlc3VsdFtyZXN1bHQubGVuZ3RoXSA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBiYXNlRm9yT3duYCB3aGljaCBpdGVyYXRlcyBvdmVyIGBvYmplY3RgXG4gICAgICogcHJvcGVydGllcyByZXR1cm5lZCBieSBga2V5c0Z1bmNgIGFuZCBpbnZva2VzIGBpdGVyYXRlZWAgZm9yIGVhY2ggcHJvcGVydHkuXG4gICAgICogSXRlcmF0ZWUgZnVuY3Rpb25zIG1heSBleGl0IGl0ZXJhdGlvbiBlYXJseSBieSBleHBsaWNpdGx5IHJldHVybmluZyBgZmFsc2VgLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8gaXRlcmF0ZSBvdmVyLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGl0ZXJhdGVlIFRoZSBmdW5jdGlvbiBpbnZva2VkIHBlciBpdGVyYXRpb24uXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0ga2V5c0Z1bmMgVGhlIGZ1bmN0aW9uIHRvIGdldCB0aGUga2V5cyBvZiBgb2JqZWN0YC5cbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIGBvYmplY3RgLlxuICAgICAqL1xuICAgIHZhciBiYXNlRm9yID0gY3JlYXRlQmFzZUZvcigpO1xuXG4gICAgLyoqXG4gICAgICogVGhpcyBmdW5jdGlvbiBpcyBsaWtlIGBiYXNlRm9yYCBleGNlcHQgdGhhdCBpdCBpdGVyYXRlcyBvdmVyIHByb3BlcnRpZXNcbiAgICAgKiBpbiB0aGUgb3Bwb3NpdGUgb3JkZXIuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIG9iamVjdCB0byBpdGVyYXRlIG92ZXIuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gaXRlcmF0ZWUgVGhlIGZ1bmN0aW9uIGludm9rZWQgcGVyIGl0ZXJhdGlvbi5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBrZXlzRnVuYyBUaGUgZnVuY3Rpb24gdG8gZ2V0IHRoZSBrZXlzIG9mIGBvYmplY3RgLlxuICAgICAqIEByZXR1cm5zIHtPYmplY3R9IFJldHVybnMgYG9iamVjdGAuXG4gICAgICovXG4gICAgdmFyIGJhc2VGb3JSaWdodCA9IGNyZWF0ZUJhc2VGb3IodHJ1ZSk7XG5cbiAgICAvKipcbiAgICAgKiBUaGUgYmFzZSBpbXBsZW1lbnRhdGlvbiBvZiBgXy5mb3JPd25gIHdpdGhvdXQgc3VwcG9ydCBmb3IgaXRlcmF0ZWUgc2hvcnRoYW5kcy5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgb2JqZWN0IHRvIGl0ZXJhdGUgb3Zlci5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBpdGVyYXRlZSBUaGUgZnVuY3Rpb24gaW52b2tlZCBwZXIgaXRlcmF0aW9uLlxuICAgICAqIEByZXR1cm5zIHtPYmplY3R9IFJldHVybnMgYG9iamVjdGAuXG4gICAgICovXG4gICAgZnVuY3Rpb24gYmFzZUZvck93bihvYmplY3QsIGl0ZXJhdGVlKSB7XG4gICAgICByZXR1cm4gb2JqZWN0ICYmIGJhc2VGb3Iob2JqZWN0LCBpdGVyYXRlZSwga2V5cyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIGJhc2UgaW1wbGVtZW50YXRpb24gb2YgYF8uZm9yT3duUmlnaHRgIHdpdGhvdXQgc3VwcG9ydCBmb3IgaXRlcmF0ZWUgc2hvcnRoYW5kcy5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgb2JqZWN0IHRvIGl0ZXJhdGUgb3Zlci5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBpdGVyYXRlZSBUaGUgZnVuY3Rpb24gaW52b2tlZCBwZXIgaXRlcmF0aW9uLlxuICAgICAqIEByZXR1cm5zIHtPYmplY3R9IFJldHVybnMgYG9iamVjdGAuXG4gICAgICovXG4gICAgZnVuY3Rpb24gYmFzZUZvck93blJpZ2h0KG9iamVjdCwgaXRlcmF0ZWUpIHtcbiAgICAgIHJldHVybiBvYmplY3QgJiYgYmFzZUZvclJpZ2h0KG9iamVjdCwgaXRlcmF0ZWUsIGtleXMpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBfLmZ1bmN0aW9uc2Agd2hpY2ggY3JlYXRlcyBhbiBhcnJheSBvZlxuICAgICAqIGBvYmplY3RgIGZ1bmN0aW9uIHByb3BlcnR5IG5hbWVzIGZpbHRlcmVkIGZyb20gYHByb3BzYC5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgb2JqZWN0IHRvIGluc3BlY3QuXG4gICAgICogQHBhcmFtIHtBcnJheX0gcHJvcHMgVGhlIHByb3BlcnR5IG5hbWVzIHRvIGZpbHRlci5cbiAgICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgdGhlIGZ1bmN0aW9uIG5hbWVzLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGJhc2VGdW5jdGlvbnMob2JqZWN0LCBwcm9wcykge1xuICAgICAgcmV0dXJuIGFycmF5RmlsdGVyKHByb3BzLCBmdW5jdGlvbihrZXkpIHtcbiAgICAgICAgcmV0dXJuIGlzRnVuY3Rpb24ob2JqZWN0W2tleV0pO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIGJhc2UgaW1wbGVtZW50YXRpb24gb2YgYF8uZ2V0YCB3aXRob3V0IHN1cHBvcnQgZm9yIGRlZmF1bHQgdmFsdWVzLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8gcXVlcnkuXG4gICAgICogQHBhcmFtIHtBcnJheXxzdHJpbmd9IHBhdGggVGhlIHBhdGggb2YgdGhlIHByb3BlcnR5IHRvIGdldC5cbiAgICAgKiBAcmV0dXJucyB7Kn0gUmV0dXJucyB0aGUgcmVzb2x2ZWQgdmFsdWUuXG4gICAgICovXG4gICAgZnVuY3Rpb24gYmFzZUdldChvYmplY3QsIHBhdGgpIHtcbiAgICAgIHBhdGggPSBjYXN0UGF0aChwYXRoLCBvYmplY3QpO1xuXG4gICAgICB2YXIgaW5kZXggPSAwLFxuICAgICAgICAgIGxlbmd0aCA9IHBhdGgubGVuZ3RoO1xuXG4gICAgICB3aGlsZSAob2JqZWN0ICE9IG51bGwgJiYgaW5kZXggPCBsZW5ndGgpIHtcbiAgICAgICAgb2JqZWN0ID0gb2JqZWN0W3RvS2V5KHBhdGhbaW5kZXgrK10pXTtcbiAgICAgIH1cbiAgICAgIHJldHVybiAoaW5kZXggJiYgaW5kZXggPT0gbGVuZ3RoKSA/IG9iamVjdCA6IHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgYmFzZSBpbXBsZW1lbnRhdGlvbiBvZiBgZ2V0QWxsS2V5c2AgYW5kIGBnZXRBbGxLZXlzSW5gIHdoaWNoIHVzZXNcbiAgICAgKiBga2V5c0Z1bmNgIGFuZCBgc3ltYm9sc0Z1bmNgIHRvIGdldCB0aGUgZW51bWVyYWJsZSBwcm9wZXJ0eSBuYW1lcyBhbmRcbiAgICAgKiBzeW1ib2xzIG9mIGBvYmplY3RgLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8gcXVlcnkuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0ga2V5c0Z1bmMgVGhlIGZ1bmN0aW9uIHRvIGdldCB0aGUga2V5cyBvZiBgb2JqZWN0YC5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBzeW1ib2xzRnVuYyBUaGUgZnVuY3Rpb24gdG8gZ2V0IHRoZSBzeW1ib2xzIG9mIGBvYmplY3RgLlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgYXJyYXkgb2YgcHJvcGVydHkgbmFtZXMgYW5kIHN5bWJvbHMuXG4gICAgICovXG4gICAgZnVuY3Rpb24gYmFzZUdldEFsbEtleXMob2JqZWN0LCBrZXlzRnVuYywgc3ltYm9sc0Z1bmMpIHtcbiAgICAgIHZhciByZXN1bHQgPSBrZXlzRnVuYyhvYmplY3QpO1xuICAgICAgcmV0dXJuIGlzQXJyYXkob2JqZWN0KSA/IHJlc3VsdCA6IGFycmF5UHVzaChyZXN1bHQsIHN5bWJvbHNGdW5jKG9iamVjdCkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBnZXRUYWdgIHdpdGhvdXQgZmFsbGJhY2tzIGZvciBidWdneSBlbnZpcm9ubWVudHMuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIHF1ZXJ5LlxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IFJldHVybnMgdGhlIGB0b1N0cmluZ1RhZ2AuXG4gICAgICovXG4gICAgZnVuY3Rpb24gYmFzZUdldFRhZyh2YWx1ZSkge1xuICAgICAgaWYgKHZhbHVlID09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlID09PSB1bmRlZmluZWQgPyB1bmRlZmluZWRUYWcgOiBudWxsVGFnO1xuICAgICAgfVxuICAgICAgcmV0dXJuIChzeW1Ub1N0cmluZ1RhZyAmJiBzeW1Ub1N0cmluZ1RhZyBpbiBPYmplY3QodmFsdWUpKVxuICAgICAgICA/IGdldFJhd1RhZyh2YWx1ZSlcbiAgICAgICAgOiBvYmplY3RUb1N0cmluZyh2YWx1ZSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIGJhc2UgaW1wbGVtZW50YXRpb24gb2YgYF8uZ3RgIHdoaWNoIGRvZXNuJ3QgY29lcmNlIGFyZ3VtZW50cy5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY29tcGFyZS5cbiAgICAgKiBAcGFyYW0geyp9IG90aGVyIFRoZSBvdGhlciB2YWx1ZSB0byBjb21wYXJlLlxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBgdmFsdWVgIGlzIGdyZWF0ZXIgdGhhbiBgb3RoZXJgLFxuICAgICAqICBlbHNlIGBmYWxzZWAuXG4gICAgICovXG4gICAgZnVuY3Rpb24gYmFzZUd0KHZhbHVlLCBvdGhlcikge1xuICAgICAgcmV0dXJuIHZhbHVlID4gb3RoZXI7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIGJhc2UgaW1wbGVtZW50YXRpb24gb2YgYF8uaGFzYCB3aXRob3V0IHN1cHBvcnQgZm9yIGRlZXAgcGF0aHMuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbb2JqZWN0XSBUaGUgb2JqZWN0IHRvIHF1ZXJ5LlxuICAgICAqIEBwYXJhbSB7QXJyYXl8c3RyaW5nfSBrZXkgVGhlIGtleSB0byBjaGVjay5cbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYGtleWAgZXhpc3RzLCBlbHNlIGBmYWxzZWAuXG4gICAgICovXG4gICAgZnVuY3Rpb24gYmFzZUhhcyhvYmplY3QsIGtleSkge1xuICAgICAgcmV0dXJuIG9iamVjdCAhPSBudWxsICYmIGhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBrZXkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBfLmhhc0luYCB3aXRob3V0IHN1cHBvcnQgZm9yIGRlZXAgcGF0aHMuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbb2JqZWN0XSBUaGUgb2JqZWN0IHRvIHF1ZXJ5LlxuICAgICAqIEBwYXJhbSB7QXJyYXl8c3RyaW5nfSBrZXkgVGhlIGtleSB0byBjaGVjay5cbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYGtleWAgZXhpc3RzLCBlbHNlIGBmYWxzZWAuXG4gICAgICovXG4gICAgZnVuY3Rpb24gYmFzZUhhc0luKG9iamVjdCwga2V5KSB7XG4gICAgICByZXR1cm4gb2JqZWN0ICE9IG51bGwgJiYga2V5IGluIE9iamVjdChvYmplY3QpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBfLmluUmFuZ2VgIHdoaWNoIGRvZXNuJ3QgY29lcmNlIGFyZ3VtZW50cy5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IG51bWJlciBUaGUgbnVtYmVyIHRvIGNoZWNrLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBzdGFydCBUaGUgc3RhcnQgb2YgdGhlIHJhbmdlLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBlbmQgVGhlIGVuZCBvZiB0aGUgcmFuZ2UuXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGBudW1iZXJgIGlzIGluIHRoZSByYW5nZSwgZWxzZSBgZmFsc2VgLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGJhc2VJblJhbmdlKG51bWJlciwgc3RhcnQsIGVuZCkge1xuICAgICAgcmV0dXJuIG51bWJlciA+PSBuYXRpdmVNaW4oc3RhcnQsIGVuZCkgJiYgbnVtYmVyIDwgbmF0aXZlTWF4KHN0YXJ0LCBlbmQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIG1ldGhvZHMgbGlrZSBgXy5pbnRlcnNlY3Rpb25gLCB3aXRob3V0IHN1cHBvcnRcbiAgICAgKiBmb3IgaXRlcmF0ZWUgc2hvcnRoYW5kcywgdGhhdCBhY2NlcHRzIGFuIGFycmF5IG9mIGFycmF5cyB0byBpbnNwZWN0LlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBhcnJheXMgVGhlIGFycmF5cyB0byBpbnNwZWN0LlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtpdGVyYXRlZV0gVGhlIGl0ZXJhdGVlIGludm9rZWQgcGVyIGVsZW1lbnQuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gW2NvbXBhcmF0b3JdIFRoZSBjb21wYXJhdG9yIGludm9rZWQgcGVyIGVsZW1lbnQuXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIHRoZSBuZXcgYXJyYXkgb2Ygc2hhcmVkIHZhbHVlcy5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBiYXNlSW50ZXJzZWN0aW9uKGFycmF5cywgaXRlcmF0ZWUsIGNvbXBhcmF0b3IpIHtcbiAgICAgIHZhciBpbmNsdWRlcyA9IGNvbXBhcmF0b3IgPyBhcnJheUluY2x1ZGVzV2l0aCA6IGFycmF5SW5jbHVkZXMsXG4gICAgICAgICAgbGVuZ3RoID0gYXJyYXlzWzBdLmxlbmd0aCxcbiAgICAgICAgICBvdGhMZW5ndGggPSBhcnJheXMubGVuZ3RoLFxuICAgICAgICAgIG90aEluZGV4ID0gb3RoTGVuZ3RoLFxuICAgICAgICAgIGNhY2hlcyA9IEFycmF5KG90aExlbmd0aCksXG4gICAgICAgICAgbWF4TGVuZ3RoID0gSW5maW5pdHksXG4gICAgICAgICAgcmVzdWx0ID0gW107XG5cbiAgICAgIHdoaWxlIChvdGhJbmRleC0tKSB7XG4gICAgICAgIHZhciBhcnJheSA9IGFycmF5c1tvdGhJbmRleF07XG4gICAgICAgIGlmIChvdGhJbmRleCAmJiBpdGVyYXRlZSkge1xuICAgICAgICAgIGFycmF5ID0gYXJyYXlNYXAoYXJyYXksIGJhc2VVbmFyeShpdGVyYXRlZSkpO1xuICAgICAgICB9XG4gICAgICAgIG1heExlbmd0aCA9IG5hdGl2ZU1pbihhcnJheS5sZW5ndGgsIG1heExlbmd0aCk7XG4gICAgICAgIGNhY2hlc1tvdGhJbmRleF0gPSAhY29tcGFyYXRvciAmJiAoaXRlcmF0ZWUgfHwgKGxlbmd0aCA+PSAxMjAgJiYgYXJyYXkubGVuZ3RoID49IDEyMCkpXG4gICAgICAgICAgPyBuZXcgU2V0Q2FjaGUob3RoSW5kZXggJiYgYXJyYXkpXG4gICAgICAgICAgOiB1bmRlZmluZWQ7XG4gICAgICB9XG4gICAgICBhcnJheSA9IGFycmF5c1swXTtcblxuICAgICAgdmFyIGluZGV4ID0gLTEsXG4gICAgICAgICAgc2VlbiA9IGNhY2hlc1swXTtcblxuICAgICAgb3V0ZXI6XG4gICAgICB3aGlsZSAoKytpbmRleCA8IGxlbmd0aCAmJiByZXN1bHQubGVuZ3RoIDwgbWF4TGVuZ3RoKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IGFycmF5W2luZGV4XSxcbiAgICAgICAgICAgIGNvbXB1dGVkID0gaXRlcmF0ZWUgPyBpdGVyYXRlZSh2YWx1ZSkgOiB2YWx1ZTtcblxuICAgICAgICB2YWx1ZSA9IChjb21wYXJhdG9yIHx8IHZhbHVlICE9PSAwKSA/IHZhbHVlIDogMDtcbiAgICAgICAgaWYgKCEoc2VlblxuICAgICAgICAgICAgICA/IGNhY2hlSGFzKHNlZW4sIGNvbXB1dGVkKVxuICAgICAgICAgICAgICA6IGluY2x1ZGVzKHJlc3VsdCwgY29tcHV0ZWQsIGNvbXBhcmF0b3IpXG4gICAgICAgICAgICApKSB7XG4gICAgICAgICAgb3RoSW5kZXggPSBvdGhMZW5ndGg7XG4gICAgICAgICAgd2hpbGUgKC0tb3RoSW5kZXgpIHtcbiAgICAgICAgICAgIHZhciBjYWNoZSA9IGNhY2hlc1tvdGhJbmRleF07XG4gICAgICAgICAgICBpZiAoIShjYWNoZVxuICAgICAgICAgICAgICAgICAgPyBjYWNoZUhhcyhjYWNoZSwgY29tcHV0ZWQpXG4gICAgICAgICAgICAgICAgICA6IGluY2x1ZGVzKGFycmF5c1tvdGhJbmRleF0sIGNvbXB1dGVkLCBjb21wYXJhdG9yKSlcbiAgICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgY29udGludWUgb3V0ZXI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChzZWVuKSB7XG4gICAgICAgICAgICBzZWVuLnB1c2goY29tcHV0ZWQpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXN1bHQucHVzaCh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIGJhc2UgaW1wbGVtZW50YXRpb24gb2YgYF8uaW52ZXJ0YCBhbmQgYF8uaW52ZXJ0QnlgIHdoaWNoIGludmVydHNcbiAgICAgKiBgb2JqZWN0YCB3aXRoIHZhbHVlcyB0cmFuc2Zvcm1lZCBieSBgaXRlcmF0ZWVgIGFuZCBzZXQgYnkgYHNldHRlcmAuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIG9iamVjdCB0byBpdGVyYXRlIG92ZXIuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gc2V0dGVyIFRoZSBmdW5jdGlvbiB0byBzZXQgYGFjY3VtdWxhdG9yYCB2YWx1ZXMuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gaXRlcmF0ZWUgVGhlIGl0ZXJhdGVlIHRvIHRyYW5zZm9ybSB2YWx1ZXMuXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGFjY3VtdWxhdG9yIFRoZSBpbml0aWFsIGludmVydGVkIG9iamVjdC5cbiAgICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgYGFjY3VtdWxhdG9yYC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBiYXNlSW52ZXJ0ZXIob2JqZWN0LCBzZXR0ZXIsIGl0ZXJhdGVlLCBhY2N1bXVsYXRvcikge1xuICAgICAgYmFzZUZvck93bihvYmplY3QsIGZ1bmN0aW9uKHZhbHVlLCBrZXksIG9iamVjdCkge1xuICAgICAgICBzZXR0ZXIoYWNjdW11bGF0b3IsIGl0ZXJhdGVlKHZhbHVlKSwga2V5LCBvYmplY3QpO1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gYWNjdW11bGF0b3I7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIGJhc2UgaW1wbGVtZW50YXRpb24gb2YgYF8uaW52b2tlYCB3aXRob3V0IHN1cHBvcnQgZm9yIGluZGl2aWR1YWxcbiAgICAgKiBtZXRob2QgYXJndW1lbnRzLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8gcXVlcnkuXG4gICAgICogQHBhcmFtIHtBcnJheXxzdHJpbmd9IHBhdGggVGhlIHBhdGggb2YgdGhlIG1ldGhvZCB0byBpbnZva2UuXG4gICAgICogQHBhcmFtIHtBcnJheX0gYXJncyBUaGUgYXJndW1lbnRzIHRvIGludm9rZSB0aGUgbWV0aG9kIHdpdGguXG4gICAgICogQHJldHVybnMgeyp9IFJldHVybnMgdGhlIHJlc3VsdCBvZiB0aGUgaW52b2tlZCBtZXRob2QuXG4gICAgICovXG4gICAgZnVuY3Rpb24gYmFzZUludm9rZShvYmplY3QsIHBhdGgsIGFyZ3MpIHtcbiAgICAgIHBhdGggPSBjYXN0UGF0aChwYXRoLCBvYmplY3QpO1xuICAgICAgb2JqZWN0ID0gcGFyZW50KG9iamVjdCwgcGF0aCk7XG4gICAgICB2YXIgZnVuYyA9IG9iamVjdCA9PSBudWxsID8gb2JqZWN0IDogb2JqZWN0W3RvS2V5KGxhc3QocGF0aCkpXTtcbiAgICAgIHJldHVybiBmdW5jID09IG51bGwgPyB1bmRlZmluZWQgOiBhcHBseShmdW5jLCBvYmplY3QsIGFyZ3MpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBfLmlzQXJndW1lbnRzYC5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2hlY2suXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGB2YWx1ZWAgaXMgYW4gYGFyZ3VtZW50c2Agb2JqZWN0LFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGJhc2VJc0FyZ3VtZW50cyh2YWx1ZSkge1xuICAgICAgcmV0dXJuIGlzT2JqZWN0TGlrZSh2YWx1ZSkgJiYgYmFzZUdldFRhZyh2YWx1ZSkgPT0gYXJnc1RhZztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgYmFzZSBpbXBsZW1lbnRhdGlvbiBvZiBgXy5pc0FycmF5QnVmZmVyYCB3aXRob3V0IE5vZGUuanMgb3B0aW1pemF0aW9ucy5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2hlY2suXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGB2YWx1ZWAgaXMgYW4gYXJyYXkgYnVmZmVyLCBlbHNlIGBmYWxzZWAuXG4gICAgICovXG4gICAgZnVuY3Rpb24gYmFzZUlzQXJyYXlCdWZmZXIodmFsdWUpIHtcbiAgICAgIHJldHVybiBpc09iamVjdExpa2UodmFsdWUpICYmIGJhc2VHZXRUYWcodmFsdWUpID09IGFycmF5QnVmZmVyVGFnO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBfLmlzRGF0ZWAgd2l0aG91dCBOb2RlLmpzIG9wdGltaXphdGlvbnMuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNoZWNrLlxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBgdmFsdWVgIGlzIGEgZGF0ZSBvYmplY3QsIGVsc2UgYGZhbHNlYC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBiYXNlSXNEYXRlKHZhbHVlKSB7XG4gICAgICByZXR1cm4gaXNPYmplY3RMaWtlKHZhbHVlKSAmJiBiYXNlR2V0VGFnKHZhbHVlKSA9PSBkYXRlVGFnO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBfLmlzRXF1YWxgIHdoaWNoIHN1cHBvcnRzIHBhcnRpYWwgY29tcGFyaXNvbnNcbiAgICAgKiBhbmQgdHJhY2tzIHRyYXZlcnNlZCBvYmplY3RzLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjb21wYXJlLlxuICAgICAqIEBwYXJhbSB7Kn0gb3RoZXIgVGhlIG90aGVyIHZhbHVlIHRvIGNvbXBhcmUuXG4gICAgICogQHBhcmFtIHtib29sZWFufSBiaXRtYXNrIFRoZSBiaXRtYXNrIGZsYWdzLlxuICAgICAqICAxIC0gVW5vcmRlcmVkIGNvbXBhcmlzb25cbiAgICAgKiAgMiAtIFBhcnRpYWwgY29tcGFyaXNvblxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtjdXN0b21pemVyXSBUaGUgZnVuY3Rpb24gdG8gY3VzdG9taXplIGNvbXBhcmlzb25zLlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbc3RhY2tdIFRyYWNrcyB0cmF2ZXJzZWQgYHZhbHVlYCBhbmQgYG90aGVyYCBvYmplY3RzLlxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgdmFsdWVzIGFyZSBlcXVpdmFsZW50LCBlbHNlIGBmYWxzZWAuXG4gICAgICovXG4gICAgZnVuY3Rpb24gYmFzZUlzRXF1YWwodmFsdWUsIG90aGVyLCBiaXRtYXNrLCBjdXN0b21pemVyLCBzdGFjaykge1xuICAgICAgaWYgKHZhbHVlID09PSBvdGhlcikge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIGlmICh2YWx1ZSA9PSBudWxsIHx8IG90aGVyID09IG51bGwgfHwgKCFpc09iamVjdExpa2UodmFsdWUpICYmICFpc09iamVjdExpa2Uob3RoZXIpKSkge1xuICAgICAgICByZXR1cm4gdmFsdWUgIT09IHZhbHVlICYmIG90aGVyICE9PSBvdGhlcjtcbiAgICAgIH1cbiAgICAgIHJldHVybiBiYXNlSXNFcXVhbERlZXAodmFsdWUsIG90aGVyLCBiaXRtYXNrLCBjdXN0b21pemVyLCBiYXNlSXNFcXVhbCwgc3RhY2spO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEEgc3BlY2lhbGl6ZWQgdmVyc2lvbiBvZiBgYmFzZUlzRXF1YWxgIGZvciBhcnJheXMgYW5kIG9iamVjdHMgd2hpY2ggcGVyZm9ybXNcbiAgICAgKiBkZWVwIGNvbXBhcmlzb25zIGFuZCB0cmFja3MgdHJhdmVyc2VkIG9iamVjdHMgZW5hYmxpbmcgb2JqZWN0cyB3aXRoIGNpcmN1bGFyXG4gICAgICogcmVmZXJlbmNlcyB0byBiZSBjb21wYXJlZC5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgb2JqZWN0IHRvIGNvbXBhcmUuXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG90aGVyIFRoZSBvdGhlciBvYmplY3QgdG8gY29tcGFyZS5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gYml0bWFzayBUaGUgYml0bWFzayBmbGFncy4gU2VlIGBiYXNlSXNFcXVhbGAgZm9yIG1vcmUgZGV0YWlscy5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjdXN0b21pemVyIFRoZSBmdW5jdGlvbiB0byBjdXN0b21pemUgY29tcGFyaXNvbnMuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZXF1YWxGdW5jIFRoZSBmdW5jdGlvbiB0byBkZXRlcm1pbmUgZXF1aXZhbGVudHMgb2YgdmFsdWVzLlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbc3RhY2tdIFRyYWNrcyB0cmF2ZXJzZWQgYG9iamVjdGAgYW5kIGBvdGhlcmAgb2JqZWN0cy5cbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIG9iamVjdHMgYXJlIGVxdWl2YWxlbnQsIGVsc2UgYGZhbHNlYC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBiYXNlSXNFcXVhbERlZXAob2JqZWN0LCBvdGhlciwgYml0bWFzaywgY3VzdG9taXplciwgZXF1YWxGdW5jLCBzdGFjaykge1xuICAgICAgdmFyIG9iaklzQXJyID0gaXNBcnJheShvYmplY3QpLFxuICAgICAgICAgIG90aElzQXJyID0gaXNBcnJheShvdGhlciksXG4gICAgICAgICAgb2JqVGFnID0gb2JqSXNBcnIgPyBhcnJheVRhZyA6IGdldFRhZyhvYmplY3QpLFxuICAgICAgICAgIG90aFRhZyA9IG90aElzQXJyID8gYXJyYXlUYWcgOiBnZXRUYWcob3RoZXIpO1xuXG4gICAgICBvYmpUYWcgPSBvYmpUYWcgPT0gYXJnc1RhZyA/IG9iamVjdFRhZyA6IG9ialRhZztcbiAgICAgIG90aFRhZyA9IG90aFRhZyA9PSBhcmdzVGFnID8gb2JqZWN0VGFnIDogb3RoVGFnO1xuXG4gICAgICB2YXIgb2JqSXNPYmogPSBvYmpUYWcgPT0gb2JqZWN0VGFnLFxuICAgICAgICAgIG90aElzT2JqID0gb3RoVGFnID09IG9iamVjdFRhZyxcbiAgICAgICAgICBpc1NhbWVUYWcgPSBvYmpUYWcgPT0gb3RoVGFnO1xuXG4gICAgICBpZiAoaXNTYW1lVGFnICYmIGlzQnVmZmVyKG9iamVjdCkpIHtcbiAgICAgICAgaWYgKCFpc0J1ZmZlcihvdGhlcikpIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgb2JqSXNBcnIgPSB0cnVlO1xuICAgICAgICBvYmpJc09iaiA9IGZhbHNlO1xuICAgICAgfVxuICAgICAgaWYgKGlzU2FtZVRhZyAmJiAhb2JqSXNPYmopIHtcbiAgICAgICAgc3RhY2sgfHwgKHN0YWNrID0gbmV3IFN0YWNrKTtcbiAgICAgICAgcmV0dXJuIChvYmpJc0FyciB8fCBpc1R5cGVkQXJyYXkob2JqZWN0KSlcbiAgICAgICAgICA/IGVxdWFsQXJyYXlzKG9iamVjdCwgb3RoZXIsIGJpdG1hc2ssIGN1c3RvbWl6ZXIsIGVxdWFsRnVuYywgc3RhY2spXG4gICAgICAgICAgOiBlcXVhbEJ5VGFnKG9iamVjdCwgb3RoZXIsIG9ialRhZywgYml0bWFzaywgY3VzdG9taXplciwgZXF1YWxGdW5jLCBzdGFjayk7XG4gICAgICB9XG4gICAgICBpZiAoIShiaXRtYXNrICYgQ09NUEFSRV9QQVJUSUFMX0ZMQUcpKSB7XG4gICAgICAgIHZhciBvYmpJc1dyYXBwZWQgPSBvYmpJc09iaiAmJiBoYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgJ19fd3JhcHBlZF9fJyksXG4gICAgICAgICAgICBvdGhJc1dyYXBwZWQgPSBvdGhJc09iaiAmJiBoYXNPd25Qcm9wZXJ0eS5jYWxsKG90aGVyLCAnX193cmFwcGVkX18nKTtcblxuICAgICAgICBpZiAob2JqSXNXcmFwcGVkIHx8IG90aElzV3JhcHBlZCkge1xuICAgICAgICAgIHZhciBvYmpVbndyYXBwZWQgPSBvYmpJc1dyYXBwZWQgPyBvYmplY3QudmFsdWUoKSA6IG9iamVjdCxcbiAgICAgICAgICAgICAgb3RoVW53cmFwcGVkID0gb3RoSXNXcmFwcGVkID8gb3RoZXIudmFsdWUoKSA6IG90aGVyO1xuXG4gICAgICAgICAgc3RhY2sgfHwgKHN0YWNrID0gbmV3IFN0YWNrKTtcbiAgICAgICAgICByZXR1cm4gZXF1YWxGdW5jKG9ialVud3JhcHBlZCwgb3RoVW53cmFwcGVkLCBiaXRtYXNrLCBjdXN0b21pemVyLCBzdGFjayk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmICghaXNTYW1lVGFnKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIHN0YWNrIHx8IChzdGFjayA9IG5ldyBTdGFjayk7XG4gICAgICByZXR1cm4gZXF1YWxPYmplY3RzKG9iamVjdCwgb3RoZXIsIGJpdG1hc2ssIGN1c3RvbWl6ZXIsIGVxdWFsRnVuYywgc3RhY2spO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBfLmlzTWFwYCB3aXRob3V0IE5vZGUuanMgb3B0aW1pemF0aW9ucy5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2hlY2suXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGB2YWx1ZWAgaXMgYSBtYXAsIGVsc2UgYGZhbHNlYC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBiYXNlSXNNYXAodmFsdWUpIHtcbiAgICAgIHJldHVybiBpc09iamVjdExpa2UodmFsdWUpICYmIGdldFRhZyh2YWx1ZSkgPT0gbWFwVGFnO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBfLmlzTWF0Y2hgIHdpdGhvdXQgc3VwcG9ydCBmb3IgaXRlcmF0ZWUgc2hvcnRoYW5kcy5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgb2JqZWN0IHRvIGluc3BlY3QuXG4gICAgICogQHBhcmFtIHtPYmplY3R9IHNvdXJjZSBUaGUgb2JqZWN0IG9mIHByb3BlcnR5IHZhbHVlcyB0byBtYXRjaC5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBtYXRjaERhdGEgVGhlIHByb3BlcnR5IG5hbWVzLCB2YWx1ZXMsIGFuZCBjb21wYXJlIGZsYWdzIHRvIG1hdGNoLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtjdXN0b21pemVyXSBUaGUgZnVuY3Rpb24gdG8gY3VzdG9taXplIGNvbXBhcmlzb25zLlxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBgb2JqZWN0YCBpcyBhIG1hdGNoLCBlbHNlIGBmYWxzZWAuXG4gICAgICovXG4gICAgZnVuY3Rpb24gYmFzZUlzTWF0Y2gob2JqZWN0LCBzb3VyY2UsIG1hdGNoRGF0YSwgY3VzdG9taXplcikge1xuICAgICAgdmFyIGluZGV4ID0gbWF0Y2hEYXRhLmxlbmd0aCxcbiAgICAgICAgICBsZW5ndGggPSBpbmRleCxcbiAgICAgICAgICBub0N1c3RvbWl6ZXIgPSAhY3VzdG9taXplcjtcblxuICAgICAgaWYgKG9iamVjdCA9PSBudWxsKSB7XG4gICAgICAgIHJldHVybiAhbGVuZ3RoO1xuICAgICAgfVxuICAgICAgb2JqZWN0ID0gT2JqZWN0KG9iamVjdCk7XG4gICAgICB3aGlsZSAoaW5kZXgtLSkge1xuICAgICAgICB2YXIgZGF0YSA9IG1hdGNoRGF0YVtpbmRleF07XG4gICAgICAgIGlmICgobm9DdXN0b21pemVyICYmIGRhdGFbMl0pXG4gICAgICAgICAgICAgID8gZGF0YVsxXSAhPT0gb2JqZWN0W2RhdGFbMF1dXG4gICAgICAgICAgICAgIDogIShkYXRhWzBdIGluIG9iamVjdClcbiAgICAgICAgICAgICkge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgd2hpbGUgKCsraW5kZXggPCBsZW5ndGgpIHtcbiAgICAgICAgZGF0YSA9IG1hdGNoRGF0YVtpbmRleF07XG4gICAgICAgIHZhciBrZXkgPSBkYXRhWzBdLFxuICAgICAgICAgICAgb2JqVmFsdWUgPSBvYmplY3Rba2V5XSxcbiAgICAgICAgICAgIHNyY1ZhbHVlID0gZGF0YVsxXTtcblxuICAgICAgICBpZiAobm9DdXN0b21pemVyICYmIGRhdGFbMl0pIHtcbiAgICAgICAgICBpZiAob2JqVmFsdWUgPT09IHVuZGVmaW5lZCAmJiAhKGtleSBpbiBvYmplY3QpKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZhciBzdGFjayA9IG5ldyBTdGFjaztcbiAgICAgICAgICBpZiAoY3VzdG9taXplcikge1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IGN1c3RvbWl6ZXIob2JqVmFsdWUsIHNyY1ZhbHVlLCBrZXksIG9iamVjdCwgc291cmNlLCBzdGFjayk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICghKHJlc3VsdCA9PT0gdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgPyBiYXNlSXNFcXVhbChzcmNWYWx1ZSwgb2JqVmFsdWUsIENPTVBBUkVfUEFSVElBTF9GTEFHIHwgQ09NUEFSRV9VTk9SREVSRURfRkxBRywgY3VzdG9taXplciwgc3RhY2spXG4gICAgICAgICAgICAgICAgOiByZXN1bHRcbiAgICAgICAgICAgICAgKSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIGJhc2UgaW1wbGVtZW50YXRpb24gb2YgYF8uaXNOYXRpdmVgIHdpdGhvdXQgYmFkIHNoaW0gY2hlY2tzLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjaGVjay5cbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYHZhbHVlYCBpcyBhIG5hdGl2ZSBmdW5jdGlvbixcbiAgICAgKiAgZWxzZSBgZmFsc2VgLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGJhc2VJc05hdGl2ZSh2YWx1ZSkge1xuICAgICAgaWYgKCFpc09iamVjdCh2YWx1ZSkgfHwgaXNNYXNrZWQodmFsdWUpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIHZhciBwYXR0ZXJuID0gaXNGdW5jdGlvbih2YWx1ZSkgPyByZUlzTmF0aXZlIDogcmVJc0hvc3RDdG9yO1xuICAgICAgcmV0dXJuIHBhdHRlcm4udGVzdCh0b1NvdXJjZSh2YWx1ZSkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBfLmlzUmVnRXhwYCB3aXRob3V0IE5vZGUuanMgb3B0aW1pemF0aW9ucy5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2hlY2suXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGB2YWx1ZWAgaXMgYSByZWdleHAsIGVsc2UgYGZhbHNlYC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBiYXNlSXNSZWdFeHAodmFsdWUpIHtcbiAgICAgIHJldHVybiBpc09iamVjdExpa2UodmFsdWUpICYmIGJhc2VHZXRUYWcodmFsdWUpID09IHJlZ2V4cFRhZztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgYmFzZSBpbXBsZW1lbnRhdGlvbiBvZiBgXy5pc1NldGAgd2l0aG91dCBOb2RlLmpzIG9wdGltaXphdGlvbnMuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNoZWNrLlxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBgdmFsdWVgIGlzIGEgc2V0LCBlbHNlIGBmYWxzZWAuXG4gICAgICovXG4gICAgZnVuY3Rpb24gYmFzZUlzU2V0KHZhbHVlKSB7XG4gICAgICByZXR1cm4gaXNPYmplY3RMaWtlKHZhbHVlKSAmJiBnZXRUYWcodmFsdWUpID09IHNldFRhZztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgYmFzZSBpbXBsZW1lbnRhdGlvbiBvZiBgXy5pc1R5cGVkQXJyYXlgIHdpdGhvdXQgTm9kZS5qcyBvcHRpbWl6YXRpb25zLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjaGVjay5cbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYHZhbHVlYCBpcyBhIHR5cGVkIGFycmF5LCBlbHNlIGBmYWxzZWAuXG4gICAgICovXG4gICAgZnVuY3Rpb24gYmFzZUlzVHlwZWRBcnJheSh2YWx1ZSkge1xuICAgICAgcmV0dXJuIGlzT2JqZWN0TGlrZSh2YWx1ZSkgJiZcbiAgICAgICAgaXNMZW5ndGgodmFsdWUubGVuZ3RoKSAmJiAhIXR5cGVkQXJyYXlUYWdzW2Jhc2VHZXRUYWcodmFsdWUpXTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgYmFzZSBpbXBsZW1lbnRhdGlvbiBvZiBgXy5pdGVyYXRlZWAuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7Kn0gW3ZhbHVlPV8uaWRlbnRpdHldIFRoZSB2YWx1ZSB0byBjb252ZXJ0IHRvIGFuIGl0ZXJhdGVlLlxuICAgICAqIEByZXR1cm5zIHtGdW5jdGlvbn0gUmV0dXJucyB0aGUgaXRlcmF0ZWUuXG4gICAgICovXG4gICAgZnVuY3Rpb24gYmFzZUl0ZXJhdGVlKHZhbHVlKSB7XG4gICAgICAvLyBEb24ndCBzdG9yZSB0aGUgYHR5cGVvZmAgcmVzdWx0IGluIGEgdmFyaWFibGUgdG8gYXZvaWQgYSBKSVQgYnVnIGluIFNhZmFyaSA5LlxuICAgICAgLy8gU2VlIGh0dHBzOi8vYnVncy53ZWJraXQub3JnL3Nob3dfYnVnLmNnaT9pZD0xNTYwMzQgZm9yIG1vcmUgZGV0YWlscy5cbiAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICB9XG4gICAgICBpZiAodmFsdWUgPT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gaWRlbnRpdHk7XG4gICAgICB9XG4gICAgICBpZiAodHlwZW9mIHZhbHVlID09ICdvYmplY3QnKSB7XG4gICAgICAgIHJldHVybiBpc0FycmF5KHZhbHVlKVxuICAgICAgICAgID8gYmFzZU1hdGNoZXNQcm9wZXJ0eSh2YWx1ZVswXSwgdmFsdWVbMV0pXG4gICAgICAgICAgOiBiYXNlTWF0Y2hlcyh2YWx1ZSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gcHJvcGVydHkodmFsdWUpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBfLmtleXNgIHdoaWNoIGRvZXNuJ3QgdHJlYXQgc3BhcnNlIGFycmF5cyBhcyBkZW5zZS5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgb2JqZWN0IHRvIHF1ZXJ5LlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgYXJyYXkgb2YgcHJvcGVydHkgbmFtZXMuXG4gICAgICovXG4gICAgZnVuY3Rpb24gYmFzZUtleXMob2JqZWN0KSB7XG4gICAgICBpZiAoIWlzUHJvdG90eXBlKG9iamVjdCkpIHtcbiAgICAgICAgcmV0dXJuIG5hdGl2ZUtleXMob2JqZWN0KTtcbiAgICAgIH1cbiAgICAgIHZhciByZXN1bHQgPSBbXTtcbiAgICAgIGZvciAodmFyIGtleSBpbiBPYmplY3Qob2JqZWN0KSkge1xuICAgICAgICBpZiAoaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIGtleSkgJiYga2V5ICE9ICdjb25zdHJ1Y3RvcicpIHtcbiAgICAgICAgICByZXN1bHQucHVzaChrZXkpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBfLmtleXNJbmAgd2hpY2ggZG9lc24ndCB0cmVhdCBzcGFyc2UgYXJyYXlzIGFzIGRlbnNlLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8gcXVlcnkuXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIHRoZSBhcnJheSBvZiBwcm9wZXJ0eSBuYW1lcy5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBiYXNlS2V5c0luKG9iamVjdCkge1xuICAgICAgaWYgKCFpc09iamVjdChvYmplY3QpKSB7XG4gICAgICAgIHJldHVybiBuYXRpdmVLZXlzSW4ob2JqZWN0KTtcbiAgICAgIH1cbiAgICAgIHZhciBpc1Byb3RvID0gaXNQcm90b3R5cGUob2JqZWN0KSxcbiAgICAgICAgICByZXN1bHQgPSBbXTtcblxuICAgICAgZm9yICh2YXIga2V5IGluIG9iamVjdCkge1xuICAgICAgICBpZiAoIShrZXkgPT0gJ2NvbnN0cnVjdG9yJyAmJiAoaXNQcm90byB8fCAhaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIGtleSkpKSkge1xuICAgICAgICAgIHJlc3VsdC5wdXNoKGtleSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIGJhc2UgaW1wbGVtZW50YXRpb24gb2YgYF8ubHRgIHdoaWNoIGRvZXNuJ3QgY29lcmNlIGFyZ3VtZW50cy5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY29tcGFyZS5cbiAgICAgKiBAcGFyYW0geyp9IG90aGVyIFRoZSBvdGhlciB2YWx1ZSB0byBjb21wYXJlLlxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBgdmFsdWVgIGlzIGxlc3MgdGhhbiBgb3RoZXJgLFxuICAgICAqICBlbHNlIGBmYWxzZWAuXG4gICAgICovXG4gICAgZnVuY3Rpb24gYmFzZUx0KHZhbHVlLCBvdGhlcikge1xuICAgICAgcmV0dXJuIHZhbHVlIDwgb3RoZXI7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIGJhc2UgaW1wbGVtZW50YXRpb24gb2YgYF8ubWFwYCB3aXRob3V0IHN1cHBvcnQgZm9yIGl0ZXJhdGVlIHNob3J0aGFuZHMuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7QXJyYXl8T2JqZWN0fSBjb2xsZWN0aW9uIFRoZSBjb2xsZWN0aW9uIHRvIGl0ZXJhdGUgb3Zlci5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBpdGVyYXRlZSBUaGUgZnVuY3Rpb24gaW52b2tlZCBwZXIgaXRlcmF0aW9uLlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgbmV3IG1hcHBlZCBhcnJheS5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBiYXNlTWFwKGNvbGxlY3Rpb24sIGl0ZXJhdGVlKSB7XG4gICAgICB2YXIgaW5kZXggPSAtMSxcbiAgICAgICAgICByZXN1bHQgPSBpc0FycmF5TGlrZShjb2xsZWN0aW9uKSA/IEFycmF5KGNvbGxlY3Rpb24ubGVuZ3RoKSA6IFtdO1xuXG4gICAgICBiYXNlRWFjaChjb2xsZWN0aW9uLCBmdW5jdGlvbih2YWx1ZSwga2V5LCBjb2xsZWN0aW9uKSB7XG4gICAgICAgIHJlc3VsdFsrK2luZGV4XSA9IGl0ZXJhdGVlKHZhbHVlLCBrZXksIGNvbGxlY3Rpb24pO1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBfLm1hdGNoZXNgIHdoaWNoIGRvZXNuJ3QgY2xvbmUgYHNvdXJjZWAuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBzb3VyY2UgVGhlIG9iamVjdCBvZiBwcm9wZXJ0eSB2YWx1ZXMgdG8gbWF0Y2guXG4gICAgICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIHRoZSBuZXcgc3BlYyBmdW5jdGlvbi5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBiYXNlTWF0Y2hlcyhzb3VyY2UpIHtcbiAgICAgIHZhciBtYXRjaERhdGEgPSBnZXRNYXRjaERhdGEoc291cmNlKTtcbiAgICAgIGlmIChtYXRjaERhdGEubGVuZ3RoID09IDEgJiYgbWF0Y2hEYXRhWzBdWzJdKSB7XG4gICAgICAgIHJldHVybiBtYXRjaGVzU3RyaWN0Q29tcGFyYWJsZShtYXRjaERhdGFbMF1bMF0sIG1hdGNoRGF0YVswXVsxXSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gZnVuY3Rpb24ob2JqZWN0KSB7XG4gICAgICAgIHJldHVybiBvYmplY3QgPT09IHNvdXJjZSB8fCBiYXNlSXNNYXRjaChvYmplY3QsIHNvdXJjZSwgbWF0Y2hEYXRhKTtcbiAgICAgIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIGJhc2UgaW1wbGVtZW50YXRpb24gb2YgYF8ubWF0Y2hlc1Byb3BlcnR5YCB3aGljaCBkb2Vzbid0IGNsb25lIGBzcmNWYWx1ZWAuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBwYXRoIFRoZSBwYXRoIG9mIHRoZSBwcm9wZXJ0eSB0byBnZXQuXG4gICAgICogQHBhcmFtIHsqfSBzcmNWYWx1ZSBUaGUgdmFsdWUgdG8gbWF0Y2guXG4gICAgICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIHRoZSBuZXcgc3BlYyBmdW5jdGlvbi5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBiYXNlTWF0Y2hlc1Byb3BlcnR5KHBhdGgsIHNyY1ZhbHVlKSB7XG4gICAgICBpZiAoaXNLZXkocGF0aCkgJiYgaXNTdHJpY3RDb21wYXJhYmxlKHNyY1ZhbHVlKSkge1xuICAgICAgICByZXR1cm4gbWF0Y2hlc1N0cmljdENvbXBhcmFibGUodG9LZXkocGF0aCksIHNyY1ZhbHVlKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBmdW5jdGlvbihvYmplY3QpIHtcbiAgICAgICAgdmFyIG9ialZhbHVlID0gZ2V0KG9iamVjdCwgcGF0aCk7XG4gICAgICAgIHJldHVybiAob2JqVmFsdWUgPT09IHVuZGVmaW5lZCAmJiBvYmpWYWx1ZSA9PT0gc3JjVmFsdWUpXG4gICAgICAgICAgPyBoYXNJbihvYmplY3QsIHBhdGgpXG4gICAgICAgICAgOiBiYXNlSXNFcXVhbChzcmNWYWx1ZSwgb2JqVmFsdWUsIENPTVBBUkVfUEFSVElBTF9GTEFHIHwgQ09NUEFSRV9VTk9SREVSRURfRkxBRyk7XG4gICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBfLm1lcmdlYCB3aXRob3V0IHN1cHBvcnQgZm9yIG11bHRpcGxlIHNvdXJjZXMuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIGRlc3RpbmF0aW9uIG9iamVjdC5cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gc291cmNlIFRoZSBzb3VyY2Ugb2JqZWN0LlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBzcmNJbmRleCBUaGUgaW5kZXggb2YgYHNvdXJjZWAuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gW2N1c3RvbWl6ZXJdIFRoZSBmdW5jdGlvbiB0byBjdXN0b21pemUgbWVyZ2VkIHZhbHVlcy5cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW3N0YWNrXSBUcmFja3MgdHJhdmVyc2VkIHNvdXJjZSB2YWx1ZXMgYW5kIHRoZWlyIG1lcmdlZFxuICAgICAqICBjb3VudGVycGFydHMuXG4gICAgICovXG4gICAgZnVuY3Rpb24gYmFzZU1lcmdlKG9iamVjdCwgc291cmNlLCBzcmNJbmRleCwgY3VzdG9taXplciwgc3RhY2spIHtcbiAgICAgIGlmIChvYmplY3QgPT09IHNvdXJjZSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBiYXNlRm9yKHNvdXJjZSwgZnVuY3Rpb24oc3JjVmFsdWUsIGtleSkge1xuICAgICAgICBpZiAoaXNPYmplY3Qoc3JjVmFsdWUpKSB7XG4gICAgICAgICAgc3RhY2sgfHwgKHN0YWNrID0gbmV3IFN0YWNrKTtcbiAgICAgICAgICBiYXNlTWVyZ2VEZWVwKG9iamVjdCwgc291cmNlLCBrZXksIHNyY0luZGV4LCBiYXNlTWVyZ2UsIGN1c3RvbWl6ZXIsIHN0YWNrKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICB2YXIgbmV3VmFsdWUgPSBjdXN0b21pemVyXG4gICAgICAgICAgICA/IGN1c3RvbWl6ZXIoc2FmZUdldChvYmplY3QsIGtleSksIHNyY1ZhbHVlLCAoa2V5ICsgJycpLCBvYmplY3QsIHNvdXJjZSwgc3RhY2spXG4gICAgICAgICAgICA6IHVuZGVmaW5lZDtcblxuICAgICAgICAgIGlmIChuZXdWYWx1ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBuZXdWYWx1ZSA9IHNyY1ZhbHVlO1xuICAgICAgICAgIH1cbiAgICAgICAgICBhc3NpZ25NZXJnZVZhbHVlKG9iamVjdCwga2V5LCBuZXdWYWx1ZSk7XG4gICAgICAgIH1cbiAgICAgIH0sIGtleXNJbik7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQSBzcGVjaWFsaXplZCB2ZXJzaW9uIG9mIGBiYXNlTWVyZ2VgIGZvciBhcnJheXMgYW5kIG9iamVjdHMgd2hpY2ggcGVyZm9ybXNcbiAgICAgKiBkZWVwIG1lcmdlcyBhbmQgdHJhY2tzIHRyYXZlcnNlZCBvYmplY3RzIGVuYWJsaW5nIG9iamVjdHMgd2l0aCBjaXJjdWxhclxuICAgICAqIHJlZmVyZW5jZXMgdG8gYmUgbWVyZ2VkLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBkZXN0aW5hdGlvbiBvYmplY3QuXG4gICAgICogQHBhcmFtIHtPYmplY3R9IHNvdXJjZSBUaGUgc291cmNlIG9iamVjdC5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30ga2V5IFRoZSBrZXkgb2YgdGhlIHZhbHVlIHRvIG1lcmdlLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBzcmNJbmRleCBUaGUgaW5kZXggb2YgYHNvdXJjZWAuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gbWVyZ2VGdW5jIFRoZSBmdW5jdGlvbiB0byBtZXJnZSB2YWx1ZXMuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gW2N1c3RvbWl6ZXJdIFRoZSBmdW5jdGlvbiB0byBjdXN0b21pemUgYXNzaWduZWQgdmFsdWVzLlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbc3RhY2tdIFRyYWNrcyB0cmF2ZXJzZWQgc291cmNlIHZhbHVlcyBhbmQgdGhlaXIgbWVyZ2VkXG4gICAgICogIGNvdW50ZXJwYXJ0cy5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBiYXNlTWVyZ2VEZWVwKG9iamVjdCwgc291cmNlLCBrZXksIHNyY0luZGV4LCBtZXJnZUZ1bmMsIGN1c3RvbWl6ZXIsIHN0YWNrKSB7XG4gICAgICB2YXIgb2JqVmFsdWUgPSBzYWZlR2V0KG9iamVjdCwga2V5KSxcbiAgICAgICAgICBzcmNWYWx1ZSA9IHNhZmVHZXQoc291cmNlLCBrZXkpLFxuICAgICAgICAgIHN0YWNrZWQgPSBzdGFjay5nZXQoc3JjVmFsdWUpO1xuXG4gICAgICBpZiAoc3RhY2tlZCkge1xuICAgICAgICBhc3NpZ25NZXJnZVZhbHVlKG9iamVjdCwga2V5LCBzdGFja2VkKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdmFyIG5ld1ZhbHVlID0gY3VzdG9taXplclxuICAgICAgICA/IGN1c3RvbWl6ZXIob2JqVmFsdWUsIHNyY1ZhbHVlLCAoa2V5ICsgJycpLCBvYmplY3QsIHNvdXJjZSwgc3RhY2spXG4gICAgICAgIDogdW5kZWZpbmVkO1xuXG4gICAgICB2YXIgaXNDb21tb24gPSBuZXdWYWx1ZSA9PT0gdW5kZWZpbmVkO1xuXG4gICAgICBpZiAoaXNDb21tb24pIHtcbiAgICAgICAgdmFyIGlzQXJyID0gaXNBcnJheShzcmNWYWx1ZSksXG4gICAgICAgICAgICBpc0J1ZmYgPSAhaXNBcnIgJiYgaXNCdWZmZXIoc3JjVmFsdWUpLFxuICAgICAgICAgICAgaXNUeXBlZCA9ICFpc0FyciAmJiAhaXNCdWZmICYmIGlzVHlwZWRBcnJheShzcmNWYWx1ZSk7XG5cbiAgICAgICAgbmV3VmFsdWUgPSBzcmNWYWx1ZTtcbiAgICAgICAgaWYgKGlzQXJyIHx8IGlzQnVmZiB8fCBpc1R5cGVkKSB7XG4gICAgICAgICAgaWYgKGlzQXJyYXkob2JqVmFsdWUpKSB7XG4gICAgICAgICAgICBuZXdWYWx1ZSA9IG9ialZhbHVlO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbHNlIGlmIChpc0FycmF5TGlrZU9iamVjdChvYmpWYWx1ZSkpIHtcbiAgICAgICAgICAgIG5ld1ZhbHVlID0gY29weUFycmF5KG9ialZhbHVlKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSBpZiAoaXNCdWZmKSB7XG4gICAgICAgICAgICBpc0NvbW1vbiA9IGZhbHNlO1xuICAgICAgICAgICAgbmV3VmFsdWUgPSBjbG9uZUJ1ZmZlcihzcmNWYWx1ZSwgdHJ1ZSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2UgaWYgKGlzVHlwZWQpIHtcbiAgICAgICAgICAgIGlzQ29tbW9uID0gZmFsc2U7XG4gICAgICAgICAgICBuZXdWYWx1ZSA9IGNsb25lVHlwZWRBcnJheShzcmNWYWx1ZSwgdHJ1ZSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbmV3VmFsdWUgPSBbXTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoaXNQbGFpbk9iamVjdChzcmNWYWx1ZSkgfHwgaXNBcmd1bWVudHMoc3JjVmFsdWUpKSB7XG4gICAgICAgICAgbmV3VmFsdWUgPSBvYmpWYWx1ZTtcbiAgICAgICAgICBpZiAoaXNBcmd1bWVudHMob2JqVmFsdWUpKSB7XG4gICAgICAgICAgICBuZXdWYWx1ZSA9IHRvUGxhaW5PYmplY3Qob2JqVmFsdWUpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbHNlIGlmICghaXNPYmplY3Qob2JqVmFsdWUpIHx8IChzcmNJbmRleCAmJiBpc0Z1bmN0aW9uKG9ialZhbHVlKSkpIHtcbiAgICAgICAgICAgIG5ld1ZhbHVlID0gaW5pdENsb25lT2JqZWN0KHNyY1ZhbHVlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgaXNDb21tb24gPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKGlzQ29tbW9uKSB7XG4gICAgICAgIC8vIFJlY3Vyc2l2ZWx5IG1lcmdlIG9iamVjdHMgYW5kIGFycmF5cyAoc3VzY2VwdGlibGUgdG8gY2FsbCBzdGFjayBsaW1pdHMpLlxuICAgICAgICBzdGFjay5zZXQoc3JjVmFsdWUsIG5ld1ZhbHVlKTtcbiAgICAgICAgbWVyZ2VGdW5jKG5ld1ZhbHVlLCBzcmNWYWx1ZSwgc3JjSW5kZXgsIGN1c3RvbWl6ZXIsIHN0YWNrKTtcbiAgICAgICAgc3RhY2tbJ2RlbGV0ZSddKHNyY1ZhbHVlKTtcbiAgICAgIH1cbiAgICAgIGFzc2lnbk1lcmdlVmFsdWUob2JqZWN0LCBrZXksIG5ld1ZhbHVlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgYmFzZSBpbXBsZW1lbnRhdGlvbiBvZiBgXy5udGhgIHdoaWNoIGRvZXNuJ3QgY29lcmNlIGFyZ3VtZW50cy5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIGFycmF5IHRvIHF1ZXJ5LlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBuIFRoZSBpbmRleCBvZiB0aGUgZWxlbWVudCB0byByZXR1cm4uXG4gICAgICogQHJldHVybnMgeyp9IFJldHVybnMgdGhlIG50aCBlbGVtZW50IG9mIGBhcnJheWAuXG4gICAgICovXG4gICAgZnVuY3Rpb24gYmFzZU50aChhcnJheSwgbikge1xuICAgICAgdmFyIGxlbmd0aCA9IGFycmF5Lmxlbmd0aDtcbiAgICAgIGlmICghbGVuZ3RoKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIG4gKz0gbiA8IDAgPyBsZW5ndGggOiAwO1xuICAgICAgcmV0dXJuIGlzSW5kZXgobiwgbGVuZ3RoKSA/IGFycmF5W25dIDogdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBfLm9yZGVyQnlgIHdpdGhvdXQgcGFyYW0gZ3VhcmRzLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge0FycmF5fE9iamVjdH0gY29sbGVjdGlvbiBUaGUgY29sbGVjdGlvbiB0byBpdGVyYXRlIG92ZXIuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbltdfE9iamVjdFtdfHN0cmluZ1tdfSBpdGVyYXRlZXMgVGhlIGl0ZXJhdGVlcyB0byBzb3J0IGJ5LlxuICAgICAqIEBwYXJhbSB7c3RyaW5nW119IG9yZGVycyBUaGUgc29ydCBvcmRlcnMgb2YgYGl0ZXJhdGVlc2AuXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIHRoZSBuZXcgc29ydGVkIGFycmF5LlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGJhc2VPcmRlckJ5KGNvbGxlY3Rpb24sIGl0ZXJhdGVlcywgb3JkZXJzKSB7XG4gICAgICB2YXIgaW5kZXggPSAtMTtcbiAgICAgIGl0ZXJhdGVlcyA9IGFycmF5TWFwKGl0ZXJhdGVlcy5sZW5ndGggPyBpdGVyYXRlZXMgOiBbaWRlbnRpdHldLCBiYXNlVW5hcnkoZ2V0SXRlcmF0ZWUoKSkpO1xuXG4gICAgICB2YXIgcmVzdWx0ID0gYmFzZU1hcChjb2xsZWN0aW9uLCBmdW5jdGlvbih2YWx1ZSwga2V5LCBjb2xsZWN0aW9uKSB7XG4gICAgICAgIHZhciBjcml0ZXJpYSA9IGFycmF5TWFwKGl0ZXJhdGVlcywgZnVuY3Rpb24oaXRlcmF0ZWUpIHtcbiAgICAgICAgICByZXR1cm4gaXRlcmF0ZWUodmFsdWUpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHsgJ2NyaXRlcmlhJzogY3JpdGVyaWEsICdpbmRleCc6ICsraW5kZXgsICd2YWx1ZSc6IHZhbHVlIH07XG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIGJhc2VTb3J0QnkocmVzdWx0LCBmdW5jdGlvbihvYmplY3QsIG90aGVyKSB7XG4gICAgICAgIHJldHVybiBjb21wYXJlTXVsdGlwbGUob2JqZWN0LCBvdGhlciwgb3JkZXJzKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBfLnBpY2tgIHdpdGhvdXQgc3VwcG9ydCBmb3IgaW5kaXZpZHVhbFxuICAgICAqIHByb3BlcnR5IGlkZW50aWZpZXJzLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBzb3VyY2Ugb2JqZWN0LlxuICAgICAqIEBwYXJhbSB7c3RyaW5nW119IHBhdGhzIFRoZSBwcm9wZXJ0eSBwYXRocyB0byBwaWNrLlxuICAgICAqIEByZXR1cm5zIHtPYmplY3R9IFJldHVybnMgdGhlIG5ldyBvYmplY3QuXG4gICAgICovXG4gICAgZnVuY3Rpb24gYmFzZVBpY2sob2JqZWN0LCBwYXRocykge1xuICAgICAgcmV0dXJuIGJhc2VQaWNrQnkob2JqZWN0LCBwYXRocywgZnVuY3Rpb24odmFsdWUsIHBhdGgpIHtcbiAgICAgICAgcmV0dXJuIGhhc0luKG9iamVjdCwgcGF0aCk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgYmFzZSBpbXBsZW1lbnRhdGlvbiBvZiAgYF8ucGlja0J5YCB3aXRob3V0IHN1cHBvcnQgZm9yIGl0ZXJhdGVlIHNob3J0aGFuZHMuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIHNvdXJjZSBvYmplY3QuXG4gICAgICogQHBhcmFtIHtzdHJpbmdbXX0gcGF0aHMgVGhlIHByb3BlcnR5IHBhdGhzIHRvIHBpY2suXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gcHJlZGljYXRlIFRoZSBmdW5jdGlvbiBpbnZva2VkIHBlciBwcm9wZXJ0eS5cbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIHRoZSBuZXcgb2JqZWN0LlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGJhc2VQaWNrQnkob2JqZWN0LCBwYXRocywgcHJlZGljYXRlKSB7XG4gICAgICB2YXIgaW5kZXggPSAtMSxcbiAgICAgICAgICBsZW5ndGggPSBwYXRocy5sZW5ndGgsXG4gICAgICAgICAgcmVzdWx0ID0ge307XG5cbiAgICAgIHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG4gICAgICAgIHZhciBwYXRoID0gcGF0aHNbaW5kZXhdLFxuICAgICAgICAgICAgdmFsdWUgPSBiYXNlR2V0KG9iamVjdCwgcGF0aCk7XG5cbiAgICAgICAgaWYgKHByZWRpY2F0ZSh2YWx1ZSwgcGF0aCkpIHtcbiAgICAgICAgICBiYXNlU2V0KHJlc3VsdCwgY2FzdFBhdGgocGF0aCwgb2JqZWN0KSwgdmFsdWUpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEEgc3BlY2lhbGl6ZWQgdmVyc2lvbiBvZiBgYmFzZVByb3BlcnR5YCB3aGljaCBzdXBwb3J0cyBkZWVwIHBhdGhzLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge0FycmF5fHN0cmluZ30gcGF0aCBUaGUgcGF0aCBvZiB0aGUgcHJvcGVydHkgdG8gZ2V0LlxuICAgICAqIEByZXR1cm5zIHtGdW5jdGlvbn0gUmV0dXJucyB0aGUgbmV3IGFjY2Vzc29yIGZ1bmN0aW9uLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGJhc2VQcm9wZXJ0eURlZXAocGF0aCkge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uKG9iamVjdCkge1xuICAgICAgICByZXR1cm4gYmFzZUdldChvYmplY3QsIHBhdGgpO1xuICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgYmFzZSBpbXBsZW1lbnRhdGlvbiBvZiBgXy5wdWxsQWxsQnlgIHdpdGhvdXQgc3VwcG9ydCBmb3IgaXRlcmF0ZWVcbiAgICAgKiBzaG9ydGhhbmRzLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBhcnJheSBUaGUgYXJyYXkgdG8gbW9kaWZ5LlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IHZhbHVlcyBUaGUgdmFsdWVzIHRvIHJlbW92ZS5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbaXRlcmF0ZWVdIFRoZSBpdGVyYXRlZSBpbnZva2VkIHBlciBlbGVtZW50LlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtjb21wYXJhdG9yXSBUaGUgY29tcGFyYXRvciBpbnZva2VkIHBlciBlbGVtZW50LlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyBgYXJyYXlgLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGJhc2VQdWxsQWxsKGFycmF5LCB2YWx1ZXMsIGl0ZXJhdGVlLCBjb21wYXJhdG9yKSB7XG4gICAgICB2YXIgaW5kZXhPZiA9IGNvbXBhcmF0b3IgPyBiYXNlSW5kZXhPZldpdGggOiBiYXNlSW5kZXhPZixcbiAgICAgICAgICBpbmRleCA9IC0xLFxuICAgICAgICAgIGxlbmd0aCA9IHZhbHVlcy5sZW5ndGgsXG4gICAgICAgICAgc2VlbiA9IGFycmF5O1xuXG4gICAgICBpZiAoYXJyYXkgPT09IHZhbHVlcykge1xuICAgICAgICB2YWx1ZXMgPSBjb3B5QXJyYXkodmFsdWVzKTtcbiAgICAgIH1cbiAgICAgIGlmIChpdGVyYXRlZSkge1xuICAgICAgICBzZWVuID0gYXJyYXlNYXAoYXJyYXksIGJhc2VVbmFyeShpdGVyYXRlZSkpO1xuICAgICAgfVxuICAgICAgd2hpbGUgKCsraW5kZXggPCBsZW5ndGgpIHtcbiAgICAgICAgdmFyIGZyb21JbmRleCA9IDAsXG4gICAgICAgICAgICB2YWx1ZSA9IHZhbHVlc1tpbmRleF0sXG4gICAgICAgICAgICBjb21wdXRlZCA9IGl0ZXJhdGVlID8gaXRlcmF0ZWUodmFsdWUpIDogdmFsdWU7XG5cbiAgICAgICAgd2hpbGUgKChmcm9tSW5kZXggPSBpbmRleE9mKHNlZW4sIGNvbXB1dGVkLCBmcm9tSW5kZXgsIGNvbXBhcmF0b3IpKSA+IC0xKSB7XG4gICAgICAgICAgaWYgKHNlZW4gIT09IGFycmF5KSB7XG4gICAgICAgICAgICBzcGxpY2UuY2FsbChzZWVuLCBmcm9tSW5kZXgsIDEpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBzcGxpY2UuY2FsbChhcnJheSwgZnJvbUluZGV4LCAxKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIGFycmF5O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBfLnB1bGxBdGAgd2l0aG91dCBzdXBwb3J0IGZvciBpbmRpdmlkdWFsXG4gICAgICogaW5kZXhlcyBvciBjYXB0dXJpbmcgdGhlIHJlbW92ZWQgZWxlbWVudHMuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGFycmF5IFRoZSBhcnJheSB0byBtb2RpZnkuXG4gICAgICogQHBhcmFtIHtudW1iZXJbXX0gaW5kZXhlcyBUaGUgaW5kZXhlcyBvZiBlbGVtZW50cyB0byByZW1vdmUuXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIGBhcnJheWAuXG4gICAgICovXG4gICAgZnVuY3Rpb24gYmFzZVB1bGxBdChhcnJheSwgaW5kZXhlcykge1xuICAgICAgdmFyIGxlbmd0aCA9IGFycmF5ID8gaW5kZXhlcy5sZW5ndGggOiAwLFxuICAgICAgICAgIGxhc3RJbmRleCA9IGxlbmd0aCAtIDE7XG5cbiAgICAgIHdoaWxlIChsZW5ndGgtLSkge1xuICAgICAgICB2YXIgaW5kZXggPSBpbmRleGVzW2xlbmd0aF07XG4gICAgICAgIGlmIChsZW5ndGggPT0gbGFzdEluZGV4IHx8IGluZGV4ICE9PSBwcmV2aW91cykge1xuICAgICAgICAgIHZhciBwcmV2aW91cyA9IGluZGV4O1xuICAgICAgICAgIGlmIChpc0luZGV4KGluZGV4KSkge1xuICAgICAgICAgICAgc3BsaWNlLmNhbGwoYXJyYXksIGluZGV4LCAxKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYmFzZVVuc2V0KGFycmF5LCBpbmRleCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gYXJyYXk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIGJhc2UgaW1wbGVtZW50YXRpb24gb2YgYF8ucmFuZG9tYCB3aXRob3V0IHN1cHBvcnQgZm9yIHJldHVybmluZ1xuICAgICAqIGZsb2F0aW5nLXBvaW50IG51bWJlcnMuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBsb3dlciBUaGUgbG93ZXIgYm91bmQuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHVwcGVyIFRoZSB1cHBlciBib3VuZC5cbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSBSZXR1cm5zIHRoZSByYW5kb20gbnVtYmVyLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGJhc2VSYW5kb20obG93ZXIsIHVwcGVyKSB7XG4gICAgICByZXR1cm4gbG93ZXIgKyBuYXRpdmVGbG9vcihuYXRpdmVSYW5kb20oKSAqICh1cHBlciAtIGxvd2VyICsgMSkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBfLnJhbmdlYCBhbmQgYF8ucmFuZ2VSaWdodGAgd2hpY2ggZG9lc24ndFxuICAgICAqIGNvZXJjZSBhcmd1bWVudHMuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBzdGFydCBUaGUgc3RhcnQgb2YgdGhlIHJhbmdlLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBlbmQgVGhlIGVuZCBvZiB0aGUgcmFuZ2UuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHN0ZXAgVGhlIHZhbHVlIHRvIGluY3JlbWVudCBvciBkZWNyZW1lbnQgYnkuXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbZnJvbVJpZ2h0XSBTcGVjaWZ5IGl0ZXJhdGluZyBmcm9tIHJpZ2h0IHRvIGxlZnQuXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIHRoZSByYW5nZSBvZiBudW1iZXJzLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGJhc2VSYW5nZShzdGFydCwgZW5kLCBzdGVwLCBmcm9tUmlnaHQpIHtcbiAgICAgIHZhciBpbmRleCA9IC0xLFxuICAgICAgICAgIGxlbmd0aCA9IG5hdGl2ZU1heChuYXRpdmVDZWlsKChlbmQgLSBzdGFydCkgLyAoc3RlcCB8fCAxKSksIDApLFxuICAgICAgICAgIHJlc3VsdCA9IEFycmF5KGxlbmd0aCk7XG5cbiAgICAgIHdoaWxlIChsZW5ndGgtLSkge1xuICAgICAgICByZXN1bHRbZnJvbVJpZ2h0ID8gbGVuZ3RoIDogKytpbmRleF0gPSBzdGFydDtcbiAgICAgICAgc3RhcnQgKz0gc3RlcDtcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIGJhc2UgaW1wbGVtZW50YXRpb24gb2YgYF8ucmVwZWF0YCB3aGljaCBkb2Vzbid0IGNvZXJjZSBhcmd1bWVudHMuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBzdHJpbmcgVGhlIHN0cmluZyB0byByZXBlYXQuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IG4gVGhlIG51bWJlciBvZiB0aW1lcyB0byByZXBlYXQgdGhlIHN0cmluZy5cbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSBSZXR1cm5zIHRoZSByZXBlYXRlZCBzdHJpbmcuXG4gICAgICovXG4gICAgZnVuY3Rpb24gYmFzZVJlcGVhdChzdHJpbmcsIG4pIHtcbiAgICAgIHZhciByZXN1bHQgPSAnJztcbiAgICAgIGlmICghc3RyaW5nIHx8IG4gPCAxIHx8IG4gPiBNQVhfU0FGRV9JTlRFR0VSKSB7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICB9XG4gICAgICAvLyBMZXZlcmFnZSB0aGUgZXhwb25lbnRpYXRpb24gYnkgc3F1YXJpbmcgYWxnb3JpdGhtIGZvciBhIGZhc3RlciByZXBlYXQuXG4gICAgICAvLyBTZWUgaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvRXhwb25lbnRpYXRpb25fYnlfc3F1YXJpbmcgZm9yIG1vcmUgZGV0YWlscy5cbiAgICAgIGRvIHtcbiAgICAgICAgaWYgKG4gJSAyKSB7XG4gICAgICAgICAgcmVzdWx0ICs9IHN0cmluZztcbiAgICAgICAgfVxuICAgICAgICBuID0gbmF0aXZlRmxvb3IobiAvIDIpO1xuICAgICAgICBpZiAobikge1xuICAgICAgICAgIHN0cmluZyArPSBzdHJpbmc7XG4gICAgICAgIH1cbiAgICAgIH0gd2hpbGUgKG4pO1xuXG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBfLnJlc3RgIHdoaWNoIGRvZXNuJ3QgdmFsaWRhdGUgb3IgY29lcmNlIGFyZ3VtZW50cy5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZnVuYyBUaGUgZnVuY3Rpb24gdG8gYXBwbHkgYSByZXN0IHBhcmFtZXRlciB0by5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW3N0YXJ0PWZ1bmMubGVuZ3RoLTFdIFRoZSBzdGFydCBwb3NpdGlvbiBvZiB0aGUgcmVzdCBwYXJhbWV0ZXIuXG4gICAgICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIHRoZSBuZXcgZnVuY3Rpb24uXG4gICAgICovXG4gICAgZnVuY3Rpb24gYmFzZVJlc3QoZnVuYywgc3RhcnQpIHtcbiAgICAgIHJldHVybiBzZXRUb1N0cmluZyhvdmVyUmVzdChmdW5jLCBzdGFydCwgaWRlbnRpdHkpLCBmdW5jICsgJycpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBfLnNhbXBsZWAuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7QXJyYXl8T2JqZWN0fSBjb2xsZWN0aW9uIFRoZSBjb2xsZWN0aW9uIHRvIHNhbXBsZS5cbiAgICAgKiBAcmV0dXJucyB7Kn0gUmV0dXJucyB0aGUgcmFuZG9tIGVsZW1lbnQuXG4gICAgICovXG4gICAgZnVuY3Rpb24gYmFzZVNhbXBsZShjb2xsZWN0aW9uKSB7XG4gICAgICByZXR1cm4gYXJyYXlTYW1wbGUodmFsdWVzKGNvbGxlY3Rpb24pKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgYmFzZSBpbXBsZW1lbnRhdGlvbiBvZiBgXy5zYW1wbGVTaXplYCB3aXRob3V0IHBhcmFtIGd1YXJkcy5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtBcnJheXxPYmplY3R9IGNvbGxlY3Rpb24gVGhlIGNvbGxlY3Rpb24gdG8gc2FtcGxlLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBuIFRoZSBudW1iZXIgb2YgZWxlbWVudHMgdG8gc2FtcGxlLlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgcmFuZG9tIGVsZW1lbnRzLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGJhc2VTYW1wbGVTaXplKGNvbGxlY3Rpb24sIG4pIHtcbiAgICAgIHZhciBhcnJheSA9IHZhbHVlcyhjb2xsZWN0aW9uKTtcbiAgICAgIHJldHVybiBzaHVmZmxlU2VsZihhcnJheSwgYmFzZUNsYW1wKG4sIDAsIGFycmF5Lmxlbmd0aCkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBfLnNldGAuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIG9iamVjdCB0byBtb2RpZnkuXG4gICAgICogQHBhcmFtIHtBcnJheXxzdHJpbmd9IHBhdGggVGhlIHBhdGggb2YgdGhlIHByb3BlcnR5IHRvIHNldC5cbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBzZXQuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gW2N1c3RvbWl6ZXJdIFRoZSBmdW5jdGlvbiB0byBjdXN0b21pemUgcGF0aCBjcmVhdGlvbi5cbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIGBvYmplY3RgLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGJhc2VTZXQob2JqZWN0LCBwYXRoLCB2YWx1ZSwgY3VzdG9taXplcikge1xuICAgICAgaWYgKCFpc09iamVjdChvYmplY3QpKSB7XG4gICAgICAgIHJldHVybiBvYmplY3Q7XG4gICAgICB9XG4gICAgICBwYXRoID0gY2FzdFBhdGgocGF0aCwgb2JqZWN0KTtcblxuICAgICAgdmFyIGluZGV4ID0gLTEsXG4gICAgICAgICAgbGVuZ3RoID0gcGF0aC5sZW5ndGgsXG4gICAgICAgICAgbGFzdEluZGV4ID0gbGVuZ3RoIC0gMSxcbiAgICAgICAgICBuZXN0ZWQgPSBvYmplY3Q7XG5cbiAgICAgIHdoaWxlIChuZXN0ZWQgIT0gbnVsbCAmJiArK2luZGV4IDwgbGVuZ3RoKSB7XG4gICAgICAgIHZhciBrZXkgPSB0b0tleShwYXRoW2luZGV4XSksXG4gICAgICAgICAgICBuZXdWYWx1ZSA9IHZhbHVlO1xuXG4gICAgICAgIGlmIChpbmRleCAhPSBsYXN0SW5kZXgpIHtcbiAgICAgICAgICB2YXIgb2JqVmFsdWUgPSBuZXN0ZWRba2V5XTtcbiAgICAgICAgICBuZXdWYWx1ZSA9IGN1c3RvbWl6ZXIgPyBjdXN0b21pemVyKG9ialZhbHVlLCBrZXksIG5lc3RlZCkgOiB1bmRlZmluZWQ7XG4gICAgICAgICAgaWYgKG5ld1ZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIG5ld1ZhbHVlID0gaXNPYmplY3Qob2JqVmFsdWUpXG4gICAgICAgICAgICAgID8gb2JqVmFsdWVcbiAgICAgICAgICAgICAgOiAoaXNJbmRleChwYXRoW2luZGV4ICsgMV0pID8gW10gOiB7fSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGFzc2lnblZhbHVlKG5lc3RlZCwga2V5LCBuZXdWYWx1ZSk7XG4gICAgICAgIG5lc3RlZCA9IG5lc3RlZFtrZXldO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG9iamVjdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgYmFzZSBpbXBsZW1lbnRhdGlvbiBvZiBgc2V0RGF0YWAgd2l0aG91dCBzdXBwb3J0IGZvciBob3QgbG9vcCBzaG9ydGluZy5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZnVuYyBUaGUgZnVuY3Rpb24gdG8gYXNzb2NpYXRlIG1ldGFkYXRhIHdpdGguXG4gICAgICogQHBhcmFtIHsqfSBkYXRhIFRoZSBtZXRhZGF0YS5cbiAgICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgYGZ1bmNgLlxuICAgICAqL1xuICAgIHZhciBiYXNlU2V0RGF0YSA9ICFtZXRhTWFwID8gaWRlbnRpdHkgOiBmdW5jdGlvbihmdW5jLCBkYXRhKSB7XG4gICAgICBtZXRhTWFwLnNldChmdW5jLCBkYXRhKTtcbiAgICAgIHJldHVybiBmdW5jO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBUaGUgYmFzZSBpbXBsZW1lbnRhdGlvbiBvZiBgc2V0VG9TdHJpbmdgIHdpdGhvdXQgc3VwcG9ydCBmb3IgaG90IGxvb3Agc2hvcnRpbmcuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZ1bmMgVGhlIGZ1bmN0aW9uIHRvIG1vZGlmeS5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBzdHJpbmcgVGhlIGB0b1N0cmluZ2AgcmVzdWx0LlxuICAgICAqIEByZXR1cm5zIHtGdW5jdGlvbn0gUmV0dXJucyBgZnVuY2AuXG4gICAgICovXG4gICAgdmFyIGJhc2VTZXRUb1N0cmluZyA9ICFkZWZpbmVQcm9wZXJ0eSA/IGlkZW50aXR5IDogZnVuY3Rpb24oZnVuYywgc3RyaW5nKSB7XG4gICAgICByZXR1cm4gZGVmaW5lUHJvcGVydHkoZnVuYywgJ3RvU3RyaW5nJywge1xuICAgICAgICAnY29uZmlndXJhYmxlJzogdHJ1ZSxcbiAgICAgICAgJ2VudW1lcmFibGUnOiBmYWxzZSxcbiAgICAgICAgJ3ZhbHVlJzogY29uc3RhbnQoc3RyaW5nKSxcbiAgICAgICAgJ3dyaXRhYmxlJzogdHJ1ZVxuICAgICAgfSk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBfLnNodWZmbGVgLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge0FycmF5fE9iamVjdH0gY29sbGVjdGlvbiBUaGUgY29sbGVjdGlvbiB0byBzaHVmZmxlLlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgbmV3IHNodWZmbGVkIGFycmF5LlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGJhc2VTaHVmZmxlKGNvbGxlY3Rpb24pIHtcbiAgICAgIHJldHVybiBzaHVmZmxlU2VsZih2YWx1ZXMoY29sbGVjdGlvbikpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBfLnNsaWNlYCB3aXRob3V0IGFuIGl0ZXJhdGVlIGNhbGwgZ3VhcmQuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGFycmF5IFRoZSBhcnJheSB0byBzbGljZS5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW3N0YXJ0PTBdIFRoZSBzdGFydCBwb3NpdGlvbi5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW2VuZD1hcnJheS5sZW5ndGhdIFRoZSBlbmQgcG9zaXRpb24uXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIHRoZSBzbGljZSBvZiBgYXJyYXlgLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGJhc2VTbGljZShhcnJheSwgc3RhcnQsIGVuZCkge1xuICAgICAgdmFyIGluZGV4ID0gLTEsXG4gICAgICAgICAgbGVuZ3RoID0gYXJyYXkubGVuZ3RoO1xuXG4gICAgICBpZiAoc3RhcnQgPCAwKSB7XG4gICAgICAgIHN0YXJ0ID0gLXN0YXJ0ID4gbGVuZ3RoID8gMCA6IChsZW5ndGggKyBzdGFydCk7XG4gICAgICB9XG4gICAgICBlbmQgPSBlbmQgPiBsZW5ndGggPyBsZW5ndGggOiBlbmQ7XG4gICAgICBpZiAoZW5kIDwgMCkge1xuICAgICAgICBlbmQgKz0gbGVuZ3RoO1xuICAgICAgfVxuICAgICAgbGVuZ3RoID0gc3RhcnQgPiBlbmQgPyAwIDogKChlbmQgLSBzdGFydCkgPj4+IDApO1xuICAgICAgc3RhcnQgPj4+PSAwO1xuXG4gICAgICB2YXIgcmVzdWx0ID0gQXJyYXkobGVuZ3RoKTtcbiAgICAgIHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG4gICAgICAgIHJlc3VsdFtpbmRleF0gPSBhcnJheVtpbmRleCArIHN0YXJ0XTtcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIGJhc2UgaW1wbGVtZW50YXRpb24gb2YgYF8uc29tZWAgd2l0aG91dCBzdXBwb3J0IGZvciBpdGVyYXRlZSBzaG9ydGhhbmRzLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge0FycmF5fE9iamVjdH0gY29sbGVjdGlvbiBUaGUgY29sbGVjdGlvbiB0byBpdGVyYXRlIG92ZXIuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gcHJlZGljYXRlIFRoZSBmdW5jdGlvbiBpbnZva2VkIHBlciBpdGVyYXRpb24uXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGFueSBlbGVtZW50IHBhc3NlcyB0aGUgcHJlZGljYXRlIGNoZWNrLFxuICAgICAqICBlbHNlIGBmYWxzZWAuXG4gICAgICovXG4gICAgZnVuY3Rpb24gYmFzZVNvbWUoY29sbGVjdGlvbiwgcHJlZGljYXRlKSB7XG4gICAgICB2YXIgcmVzdWx0O1xuXG4gICAgICBiYXNlRWFjaChjb2xsZWN0aW9uLCBmdW5jdGlvbih2YWx1ZSwgaW5kZXgsIGNvbGxlY3Rpb24pIHtcbiAgICAgICAgcmVzdWx0ID0gcHJlZGljYXRlKHZhbHVlLCBpbmRleCwgY29sbGVjdGlvbik7XG4gICAgICAgIHJldHVybiAhcmVzdWx0O1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gISFyZXN1bHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIGJhc2UgaW1wbGVtZW50YXRpb24gb2YgYF8uc29ydGVkSW5kZXhgIGFuZCBgXy5zb3J0ZWRMYXN0SW5kZXhgIHdoaWNoXG4gICAgICogcGVyZm9ybXMgYSBiaW5hcnkgc2VhcmNoIG9mIGBhcnJheWAgdG8gZGV0ZXJtaW5lIHRoZSBpbmRleCBhdCB3aGljaCBgdmFsdWVgXG4gICAgICogc2hvdWxkIGJlIGluc2VydGVkIGludG8gYGFycmF5YCBpbiBvcmRlciB0byBtYWludGFpbiBpdHMgc29ydCBvcmRlci5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIHNvcnRlZCBhcnJheSB0byBpbnNwZWN0LlxuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGV2YWx1YXRlLlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW3JldEhpZ2hlc3RdIFNwZWNpZnkgcmV0dXJuaW5nIHRoZSBoaWdoZXN0IHF1YWxpZmllZCBpbmRleC5cbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSBSZXR1cm5zIHRoZSBpbmRleCBhdCB3aGljaCBgdmFsdWVgIHNob3VsZCBiZSBpbnNlcnRlZFxuICAgICAqICBpbnRvIGBhcnJheWAuXG4gICAgICovXG4gICAgZnVuY3Rpb24gYmFzZVNvcnRlZEluZGV4KGFycmF5LCB2YWx1ZSwgcmV0SGlnaGVzdCkge1xuICAgICAgdmFyIGxvdyA9IDAsXG4gICAgICAgICAgaGlnaCA9IGFycmF5ID09IG51bGwgPyBsb3cgOiBhcnJheS5sZW5ndGg7XG5cbiAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT0gJ251bWJlcicgJiYgdmFsdWUgPT09IHZhbHVlICYmIGhpZ2ggPD0gSEFMRl9NQVhfQVJSQVlfTEVOR1RIKSB7XG4gICAgICAgIHdoaWxlIChsb3cgPCBoaWdoKSB7XG4gICAgICAgICAgdmFyIG1pZCA9IChsb3cgKyBoaWdoKSA+Pj4gMSxcbiAgICAgICAgICAgICAgY29tcHV0ZWQgPSBhcnJheVttaWRdO1xuXG4gICAgICAgICAgaWYgKGNvbXB1dGVkICE9PSBudWxsICYmICFpc1N5bWJvbChjb21wdXRlZCkgJiZcbiAgICAgICAgICAgICAgKHJldEhpZ2hlc3QgPyAoY29tcHV0ZWQgPD0gdmFsdWUpIDogKGNvbXB1dGVkIDwgdmFsdWUpKSkge1xuICAgICAgICAgICAgbG93ID0gbWlkICsgMTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaGlnaCA9IG1pZDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGhpZ2g7XG4gICAgICB9XG4gICAgICByZXR1cm4gYmFzZVNvcnRlZEluZGV4QnkoYXJyYXksIHZhbHVlLCBpZGVudGl0eSwgcmV0SGlnaGVzdCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIGJhc2UgaW1wbGVtZW50YXRpb24gb2YgYF8uc29ydGVkSW5kZXhCeWAgYW5kIGBfLnNvcnRlZExhc3RJbmRleEJ5YFxuICAgICAqIHdoaWNoIGludm9rZXMgYGl0ZXJhdGVlYCBmb3IgYHZhbHVlYCBhbmQgZWFjaCBlbGVtZW50IG9mIGBhcnJheWAgdG8gY29tcHV0ZVxuICAgICAqIHRoZWlyIHNvcnQgcmFua2luZy4gVGhlIGl0ZXJhdGVlIGlzIGludm9rZWQgd2l0aCBvbmUgYXJndW1lbnQ7ICh2YWx1ZSkuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGFycmF5IFRoZSBzb3J0ZWQgYXJyYXkgdG8gaW5zcGVjdC5cbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBldmFsdWF0ZS5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBpdGVyYXRlZSBUaGUgaXRlcmF0ZWUgaW52b2tlZCBwZXIgZWxlbWVudC5cbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtyZXRIaWdoZXN0XSBTcGVjaWZ5IHJldHVybmluZyB0aGUgaGlnaGVzdCBxdWFsaWZpZWQgaW5kZXguXG4gICAgICogQHJldHVybnMge251bWJlcn0gUmV0dXJucyB0aGUgaW5kZXggYXQgd2hpY2ggYHZhbHVlYCBzaG91bGQgYmUgaW5zZXJ0ZWRcbiAgICAgKiAgaW50byBgYXJyYXlgLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGJhc2VTb3J0ZWRJbmRleEJ5KGFycmF5LCB2YWx1ZSwgaXRlcmF0ZWUsIHJldEhpZ2hlc3QpIHtcbiAgICAgIHZhbHVlID0gaXRlcmF0ZWUodmFsdWUpO1xuXG4gICAgICB2YXIgbG93ID0gMCxcbiAgICAgICAgICBoaWdoID0gYXJyYXkgPT0gbnVsbCA/IDAgOiBhcnJheS5sZW5ndGgsXG4gICAgICAgICAgdmFsSXNOYU4gPSB2YWx1ZSAhPT0gdmFsdWUsXG4gICAgICAgICAgdmFsSXNOdWxsID0gdmFsdWUgPT09IG51bGwsXG4gICAgICAgICAgdmFsSXNTeW1ib2wgPSBpc1N5bWJvbCh2YWx1ZSksXG4gICAgICAgICAgdmFsSXNVbmRlZmluZWQgPSB2YWx1ZSA9PT0gdW5kZWZpbmVkO1xuXG4gICAgICB3aGlsZSAobG93IDwgaGlnaCkge1xuICAgICAgICB2YXIgbWlkID0gbmF0aXZlRmxvb3IoKGxvdyArIGhpZ2gpIC8gMiksXG4gICAgICAgICAgICBjb21wdXRlZCA9IGl0ZXJhdGVlKGFycmF5W21pZF0pLFxuICAgICAgICAgICAgb3RoSXNEZWZpbmVkID0gY29tcHV0ZWQgIT09IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIG90aElzTnVsbCA9IGNvbXB1dGVkID09PSBudWxsLFxuICAgICAgICAgICAgb3RoSXNSZWZsZXhpdmUgPSBjb21wdXRlZCA9PT0gY29tcHV0ZWQsXG4gICAgICAgICAgICBvdGhJc1N5bWJvbCA9IGlzU3ltYm9sKGNvbXB1dGVkKTtcblxuICAgICAgICBpZiAodmFsSXNOYU4pIHtcbiAgICAgICAgICB2YXIgc2V0TG93ID0gcmV0SGlnaGVzdCB8fCBvdGhJc1JlZmxleGl2ZTtcbiAgICAgICAgfSBlbHNlIGlmICh2YWxJc1VuZGVmaW5lZCkge1xuICAgICAgICAgIHNldExvdyA9IG90aElzUmVmbGV4aXZlICYmIChyZXRIaWdoZXN0IHx8IG90aElzRGVmaW5lZCk7XG4gICAgICAgIH0gZWxzZSBpZiAodmFsSXNOdWxsKSB7XG4gICAgICAgICAgc2V0TG93ID0gb3RoSXNSZWZsZXhpdmUgJiYgb3RoSXNEZWZpbmVkICYmIChyZXRIaWdoZXN0IHx8ICFvdGhJc051bGwpO1xuICAgICAgICB9IGVsc2UgaWYgKHZhbElzU3ltYm9sKSB7XG4gICAgICAgICAgc2V0TG93ID0gb3RoSXNSZWZsZXhpdmUgJiYgb3RoSXNEZWZpbmVkICYmICFvdGhJc051bGwgJiYgKHJldEhpZ2hlc3QgfHwgIW90aElzU3ltYm9sKTtcbiAgICAgICAgfSBlbHNlIGlmIChvdGhJc051bGwgfHwgb3RoSXNTeW1ib2wpIHtcbiAgICAgICAgICBzZXRMb3cgPSBmYWxzZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzZXRMb3cgPSByZXRIaWdoZXN0ID8gKGNvbXB1dGVkIDw9IHZhbHVlKSA6IChjb21wdXRlZCA8IHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2V0TG93KSB7XG4gICAgICAgICAgbG93ID0gbWlkICsgMTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBoaWdoID0gbWlkO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gbmF0aXZlTWluKGhpZ2gsIE1BWF9BUlJBWV9JTkRFWCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIGJhc2UgaW1wbGVtZW50YXRpb24gb2YgYF8uc29ydGVkVW5pcWAgYW5kIGBfLnNvcnRlZFVuaXFCeWAgd2l0aG91dFxuICAgICAqIHN1cHBvcnQgZm9yIGl0ZXJhdGVlIHNob3J0aGFuZHMuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGFycmF5IFRoZSBhcnJheSB0byBpbnNwZWN0LlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtpdGVyYXRlZV0gVGhlIGl0ZXJhdGVlIGludm9rZWQgcGVyIGVsZW1lbnQuXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIHRoZSBuZXcgZHVwbGljYXRlIGZyZWUgYXJyYXkuXG4gICAgICovXG4gICAgZnVuY3Rpb24gYmFzZVNvcnRlZFVuaXEoYXJyYXksIGl0ZXJhdGVlKSB7XG4gICAgICB2YXIgaW5kZXggPSAtMSxcbiAgICAgICAgICBsZW5ndGggPSBhcnJheS5sZW5ndGgsXG4gICAgICAgICAgcmVzSW5kZXggPSAwLFxuICAgICAgICAgIHJlc3VsdCA9IFtdO1xuXG4gICAgICB3aGlsZSAoKytpbmRleCA8IGxlbmd0aCkge1xuICAgICAgICB2YXIgdmFsdWUgPSBhcnJheVtpbmRleF0sXG4gICAgICAgICAgICBjb21wdXRlZCA9IGl0ZXJhdGVlID8gaXRlcmF0ZWUodmFsdWUpIDogdmFsdWU7XG5cbiAgICAgICAgaWYgKCFpbmRleCB8fCAhZXEoY29tcHV0ZWQsIHNlZW4pKSB7XG4gICAgICAgICAgdmFyIHNlZW4gPSBjb21wdXRlZDtcbiAgICAgICAgICByZXN1bHRbcmVzSW5kZXgrK10gPSB2YWx1ZSA9PT0gMCA/IDAgOiB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgYmFzZSBpbXBsZW1lbnRhdGlvbiBvZiBgXy50b051bWJlcmAgd2hpY2ggZG9lc24ndCBlbnN1cmUgY29ycmVjdFxuICAgICAqIGNvbnZlcnNpb25zIG9mIGJpbmFyeSwgaGV4YWRlY2ltYWwsIG9yIG9jdGFsIHN0cmluZyB2YWx1ZXMuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIHByb2Nlc3MuXG4gICAgICogQHJldHVybnMge251bWJlcn0gUmV0dXJucyB0aGUgbnVtYmVyLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGJhc2VUb051bWJlcih2YWx1ZSkge1xuICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PSAnbnVtYmVyJykge1xuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICB9XG4gICAgICBpZiAoaXNTeW1ib2wodmFsdWUpKSB7XG4gICAgICAgIHJldHVybiBOQU47XG4gICAgICB9XG4gICAgICByZXR1cm4gK3ZhbHVlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBfLnRvU3RyaW5nYCB3aGljaCBkb2Vzbid0IGNvbnZlcnQgbnVsbGlzaFxuICAgICAqIHZhbHVlcyB0byBlbXB0eSBzdHJpbmdzLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBwcm9jZXNzLlxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IFJldHVybnMgdGhlIHN0cmluZy5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBiYXNlVG9TdHJpbmcodmFsdWUpIHtcbiAgICAgIC8vIEV4aXQgZWFybHkgZm9yIHN0cmluZ3MgdG8gYXZvaWQgYSBwZXJmb3JtYW5jZSBoaXQgaW4gc29tZSBlbnZpcm9ubWVudHMuXG4gICAgICBpZiAodHlwZW9mIHZhbHVlID09ICdzdHJpbmcnKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgIH1cbiAgICAgIGlmIChpc0FycmF5KHZhbHVlKSkge1xuICAgICAgICAvLyBSZWN1cnNpdmVseSBjb252ZXJ0IHZhbHVlcyAoc3VzY2VwdGlibGUgdG8gY2FsbCBzdGFjayBsaW1pdHMpLlxuICAgICAgICByZXR1cm4gYXJyYXlNYXAodmFsdWUsIGJhc2VUb1N0cmluZykgKyAnJztcbiAgICAgIH1cbiAgICAgIGlmIChpc1N5bWJvbCh2YWx1ZSkpIHtcbiAgICAgICAgcmV0dXJuIHN5bWJvbFRvU3RyaW5nID8gc3ltYm9sVG9TdHJpbmcuY2FsbCh2YWx1ZSkgOiAnJztcbiAgICAgIH1cbiAgICAgIHZhciByZXN1bHQgPSAodmFsdWUgKyAnJyk7XG4gICAgICByZXR1cm4gKHJlc3VsdCA9PSAnMCcgJiYgKDEgLyB2YWx1ZSkgPT0gLUlORklOSVRZKSA/ICctMCcgOiByZXN1bHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIGJhc2UgaW1wbGVtZW50YXRpb24gb2YgYF8udW5pcUJ5YCB3aXRob3V0IHN1cHBvcnQgZm9yIGl0ZXJhdGVlIHNob3J0aGFuZHMuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGFycmF5IFRoZSBhcnJheSB0byBpbnNwZWN0LlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtpdGVyYXRlZV0gVGhlIGl0ZXJhdGVlIGludm9rZWQgcGVyIGVsZW1lbnQuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gW2NvbXBhcmF0b3JdIFRoZSBjb21wYXJhdG9yIGludm9rZWQgcGVyIGVsZW1lbnQuXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIHRoZSBuZXcgZHVwbGljYXRlIGZyZWUgYXJyYXkuXG4gICAgICovXG4gICAgZnVuY3Rpb24gYmFzZVVuaXEoYXJyYXksIGl0ZXJhdGVlLCBjb21wYXJhdG9yKSB7XG4gICAgICB2YXIgaW5kZXggPSAtMSxcbiAgICAgICAgICBpbmNsdWRlcyA9IGFycmF5SW5jbHVkZXMsXG4gICAgICAgICAgbGVuZ3RoID0gYXJyYXkubGVuZ3RoLFxuICAgICAgICAgIGlzQ29tbW9uID0gdHJ1ZSxcbiAgICAgICAgICByZXN1bHQgPSBbXSxcbiAgICAgICAgICBzZWVuID0gcmVzdWx0O1xuXG4gICAgICBpZiAoY29tcGFyYXRvcikge1xuICAgICAgICBpc0NvbW1vbiA9IGZhbHNlO1xuICAgICAgICBpbmNsdWRlcyA9IGFycmF5SW5jbHVkZXNXaXRoO1xuICAgICAgfVxuICAgICAgZWxzZSBpZiAobGVuZ3RoID49IExBUkdFX0FSUkFZX1NJWkUpIHtcbiAgICAgICAgdmFyIHNldCA9IGl0ZXJhdGVlID8gbnVsbCA6IGNyZWF0ZVNldChhcnJheSk7XG4gICAgICAgIGlmIChzZXQpIHtcbiAgICAgICAgICByZXR1cm4gc2V0VG9BcnJheShzZXQpO1xuICAgICAgICB9XG4gICAgICAgIGlzQ29tbW9uID0gZmFsc2U7XG4gICAgICAgIGluY2x1ZGVzID0gY2FjaGVIYXM7XG4gICAgICAgIHNlZW4gPSBuZXcgU2V0Q2FjaGU7XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgc2VlbiA9IGl0ZXJhdGVlID8gW10gOiByZXN1bHQ7XG4gICAgICB9XG4gICAgICBvdXRlcjpcbiAgICAgIHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IGFycmF5W2luZGV4XSxcbiAgICAgICAgICAgIGNvbXB1dGVkID0gaXRlcmF0ZWUgPyBpdGVyYXRlZSh2YWx1ZSkgOiB2YWx1ZTtcblxuICAgICAgICB2YWx1ZSA9IChjb21wYXJhdG9yIHx8IHZhbHVlICE9PSAwKSA/IHZhbHVlIDogMDtcbiAgICAgICAgaWYgKGlzQ29tbW9uICYmIGNvbXB1dGVkID09PSBjb21wdXRlZCkge1xuICAgICAgICAgIHZhciBzZWVuSW5kZXggPSBzZWVuLmxlbmd0aDtcbiAgICAgICAgICB3aGlsZSAoc2VlbkluZGV4LS0pIHtcbiAgICAgICAgICAgIGlmIChzZWVuW3NlZW5JbmRleF0gPT09IGNvbXB1dGVkKSB7XG4gICAgICAgICAgICAgIGNvbnRpbnVlIG91dGVyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoaXRlcmF0ZWUpIHtcbiAgICAgICAgICAgIHNlZW4ucHVzaChjb21wdXRlZCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJlc3VsdC5wdXNoKHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICghaW5jbHVkZXMoc2VlbiwgY29tcHV0ZWQsIGNvbXBhcmF0b3IpKSB7XG4gICAgICAgICAgaWYgKHNlZW4gIT09IHJlc3VsdCkge1xuICAgICAgICAgICAgc2Vlbi5wdXNoKGNvbXB1dGVkKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmVzdWx0LnB1c2godmFsdWUpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBfLnVuc2V0YC5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgb2JqZWN0IHRvIG1vZGlmeS5cbiAgICAgKiBAcGFyYW0ge0FycmF5fHN0cmluZ30gcGF0aCBUaGUgcHJvcGVydHkgcGF0aCB0byB1bnNldC5cbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIHByb3BlcnR5IGlzIGRlbGV0ZWQsIGVsc2UgYGZhbHNlYC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBiYXNlVW5zZXQob2JqZWN0LCBwYXRoKSB7XG4gICAgICBwYXRoID0gY2FzdFBhdGgocGF0aCwgb2JqZWN0KTtcbiAgICAgIG9iamVjdCA9IHBhcmVudChvYmplY3QsIHBhdGgpO1xuICAgICAgcmV0dXJuIG9iamVjdCA9PSBudWxsIHx8IGRlbGV0ZSBvYmplY3RbdG9LZXkobGFzdChwYXRoKSldO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGBfLnVwZGF0ZWAuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIG9iamVjdCB0byBtb2RpZnkuXG4gICAgICogQHBhcmFtIHtBcnJheXxzdHJpbmd9IHBhdGggVGhlIHBhdGggb2YgdGhlIHByb3BlcnR5IHRvIHVwZGF0ZS5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSB1cGRhdGVyIFRoZSBmdW5jdGlvbiB0byBwcm9kdWNlIHRoZSB1cGRhdGVkIHZhbHVlLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtjdXN0b21pemVyXSBUaGUgZnVuY3Rpb24gdG8gY3VzdG9taXplIHBhdGggY3JlYXRpb24uXG4gICAgICogQHJldHVybnMge09iamVjdH0gUmV0dXJucyBgb2JqZWN0YC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBiYXNlVXBkYXRlKG9iamVjdCwgcGF0aCwgdXBkYXRlciwgY3VzdG9taXplcikge1xuICAgICAgcmV0dXJuIGJhc2VTZXQob2JqZWN0LCBwYXRoLCB1cGRhdGVyKGJhc2VHZXQob2JqZWN0LCBwYXRoKSksIGN1c3RvbWl6ZXIpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIG1ldGhvZHMgbGlrZSBgXy5kcm9wV2hpbGVgIGFuZCBgXy50YWtlV2hpbGVgXG4gICAgICogd2l0aG91dCBzdXBwb3J0IGZvciBpdGVyYXRlZSBzaG9ydGhhbmRzLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBhcnJheSBUaGUgYXJyYXkgdG8gcXVlcnkuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gcHJlZGljYXRlIFRoZSBmdW5jdGlvbiBpbnZva2VkIHBlciBpdGVyYXRpb24uXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbaXNEcm9wXSBTcGVjaWZ5IGRyb3BwaW5nIGVsZW1lbnRzIGluc3RlYWQgb2YgdGFraW5nIHRoZW0uXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbZnJvbVJpZ2h0XSBTcGVjaWZ5IGl0ZXJhdGluZyBmcm9tIHJpZ2h0IHRvIGxlZnQuXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIHRoZSBzbGljZSBvZiBgYXJyYXlgLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGJhc2VXaGlsZShhcnJheSwgcHJlZGljYXRlLCBpc0Ryb3AsIGZyb21SaWdodCkge1xuICAgICAgdmFyIGxlbmd0aCA9IGFycmF5Lmxlbmd0aCxcbiAgICAgICAgICBpbmRleCA9IGZyb21SaWdodCA/IGxlbmd0aCA6IC0xO1xuXG4gICAgICB3aGlsZSAoKGZyb21SaWdodCA/IGluZGV4LS0gOiArK2luZGV4IDwgbGVuZ3RoKSAmJlxuICAgICAgICBwcmVkaWNhdGUoYXJyYXlbaW5kZXhdLCBpbmRleCwgYXJyYXkpKSB7fVxuXG4gICAgICByZXR1cm4gaXNEcm9wXG4gICAgICAgID8gYmFzZVNsaWNlKGFycmF5LCAoZnJvbVJpZ2h0ID8gMCA6IGluZGV4KSwgKGZyb21SaWdodCA/IGluZGV4ICsgMSA6IGxlbmd0aCkpXG4gICAgICAgIDogYmFzZVNsaWNlKGFycmF5LCAoZnJvbVJpZ2h0ID8gaW5kZXggKyAxIDogMCksIChmcm9tUmlnaHQgPyBsZW5ndGggOiBpbmRleCkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIGB3cmFwcGVyVmFsdWVgIHdoaWNoIHJldHVybnMgdGhlIHJlc3VsdCBvZlxuICAgICAqIHBlcmZvcm1pbmcgYSBzZXF1ZW5jZSBvZiBhY3Rpb25zIG9uIHRoZSB1bndyYXBwZWQgYHZhbHVlYCwgd2hlcmUgZWFjaFxuICAgICAqIHN1Y2Nlc3NpdmUgYWN0aW9uIGlzIHN1cHBsaWVkIHRoZSByZXR1cm4gdmFsdWUgb2YgdGhlIHByZXZpb3VzLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB1bndyYXBwZWQgdmFsdWUuXG4gICAgICogQHBhcmFtIHtBcnJheX0gYWN0aW9ucyBBY3Rpb25zIHRvIHBlcmZvcm0gdG8gcmVzb2x2ZSB0aGUgdW53cmFwcGVkIHZhbHVlLlxuICAgICAqIEByZXR1cm5zIHsqfSBSZXR1cm5zIHRoZSByZXNvbHZlZCB2YWx1ZS5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBiYXNlV3JhcHBlclZhbHVlKHZhbHVlLCBhY3Rpb25zKSB7XG4gICAgICB2YXIgcmVzdWx0ID0gdmFsdWU7XG4gICAgICBpZiAocmVzdWx0IGluc3RhbmNlb2YgTGF6eVdyYXBwZXIpIHtcbiAgICAgICAgcmVzdWx0ID0gcmVzdWx0LnZhbHVlKCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gYXJyYXlSZWR1Y2UoYWN0aW9ucywgZnVuY3Rpb24ocmVzdWx0LCBhY3Rpb24pIHtcbiAgICAgICAgcmV0dXJuIGFjdGlvbi5mdW5jLmFwcGx5KGFjdGlvbi50aGlzQXJnLCBhcnJheVB1c2goW3Jlc3VsdF0sIGFjdGlvbi5hcmdzKSk7XG4gICAgICB9LCByZXN1bHQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBiYXNlIGltcGxlbWVudGF0aW9uIG9mIG1ldGhvZHMgbGlrZSBgXy54b3JgLCB3aXRob3V0IHN1cHBvcnQgZm9yXG4gICAgICogaXRlcmF0ZWUgc2hvcnRoYW5kcywgdGhhdCBhY2NlcHRzIGFuIGFycmF5IG9mIGFycmF5cyB0byBpbnNwZWN0LlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBhcnJheXMgVGhlIGFycmF5cyB0byBpbnNwZWN0LlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtpdGVyYXRlZV0gVGhlIGl0ZXJhdGVlIGludm9rZWQgcGVyIGVsZW1lbnQuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gW2NvbXBhcmF0b3JdIFRoZSBjb21wYXJhdG9yIGludm9rZWQgcGVyIGVsZW1lbnQuXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIHRoZSBuZXcgYXJyYXkgb2YgdmFsdWVzLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGJhc2VYb3IoYXJyYXlzLCBpdGVyYXRlZSwgY29tcGFyYXRvcikge1xuICAgICAgdmFyIGxlbmd0aCA9IGFycmF5cy5sZW5ndGg7XG4gICAgICBpZiAobGVuZ3RoIDwgMikge1xuICAgICAgICByZXR1cm4gbGVuZ3RoID8gYmFzZVVuaXEoYXJyYXlzWzBdKSA6IFtdO1xuICAgICAgfVxuICAgICAgdmFyIGluZGV4ID0gLTEsXG4gICAgICAgICAgcmVzdWx0ID0gQXJyYXkobGVuZ3RoKTtcblxuICAgICAgd2hpbGUgKCsraW5kZXggPCBsZW5ndGgpIHtcbiAgICAgICAgdmFyIGFycmF5ID0gYXJyYXlzW2luZGV4XSxcbiAgICAgICAgICAgIG90aEluZGV4ID0gLTE7XG5cbiAgICAgICAgd2hpbGUgKCsrb3RoSW5kZXggPCBsZW5ndGgpIHtcbiAgICAgICAgICBpZiAob3RoSW5kZXggIT0gaW5kZXgpIHtcbiAgICAgICAgICAgIHJlc3VsdFtpbmRleF0gPSBiYXNlRGlmZmVyZW5jZShyZXN1bHRbaW5kZXhdIHx8IGFycmF5LCBhcnJheXNbb3RoSW5kZXhdLCBpdGVyYXRlZSwgY29tcGFyYXRvcik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gYmFzZVVuaXEoYmFzZUZsYXR0ZW4ocmVzdWx0LCAxKSwgaXRlcmF0ZWUsIGNvbXBhcmF0b3IpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoaXMgYmFzZSBpbXBsZW1lbnRhdGlvbiBvZiBgXy56aXBPYmplY3RgIHdoaWNoIGFzc2lnbnMgdmFsdWVzIHVzaW5nIGBhc3NpZ25GdW5jYC5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtBcnJheX0gcHJvcHMgVGhlIHByb3BlcnR5IGlkZW50aWZpZXJzLlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IHZhbHVlcyBUaGUgcHJvcGVydHkgdmFsdWVzLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGFzc2lnbkZ1bmMgVGhlIGZ1bmN0aW9uIHRvIGFzc2lnbiB2YWx1ZXMuXG4gICAgICogQHJldHVybnMge09iamVjdH0gUmV0dXJucyB0aGUgbmV3IG9iamVjdC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBiYXNlWmlwT2JqZWN0KHByb3BzLCB2YWx1ZXMsIGFzc2lnbkZ1bmMpIHtcbiAgICAgIHZhciBpbmRleCA9IC0xLFxuICAgICAgICAgIGxlbmd0aCA9IHByb3BzLmxlbmd0aCxcbiAgICAgICAgICB2YWxzTGVuZ3RoID0gdmFsdWVzLmxlbmd0aCxcbiAgICAgICAgICByZXN1bHQgPSB7fTtcblxuICAgICAgd2hpbGUgKCsraW5kZXggPCBsZW5ndGgpIHtcbiAgICAgICAgdmFyIHZhbHVlID0gaW5kZXggPCB2YWxzTGVuZ3RoID8gdmFsdWVzW2luZGV4XSA6IHVuZGVmaW5lZDtcbiAgICAgICAgYXNzaWduRnVuYyhyZXN1bHQsIHByb3BzW2luZGV4XSwgdmFsdWUpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDYXN0cyBgdmFsdWVgIHRvIGFuIGVtcHR5IGFycmF5IGlmIGl0J3Mgbm90IGFuIGFycmF5IGxpa2Ugb2JqZWN0LlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBpbnNwZWN0LlxuICAgICAqIEByZXR1cm5zIHtBcnJheXxPYmplY3R9IFJldHVybnMgdGhlIGNhc3QgYXJyYXktbGlrZSBvYmplY3QuXG4gICAgICovXG4gICAgZnVuY3Rpb24gY2FzdEFycmF5TGlrZU9iamVjdCh2YWx1ZSkge1xuICAgICAgcmV0dXJuIGlzQXJyYXlMaWtlT2JqZWN0KHZhbHVlKSA/IHZhbHVlIDogW107XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2FzdHMgYHZhbHVlYCB0byBgaWRlbnRpdHlgIGlmIGl0J3Mgbm90IGEgZnVuY3Rpb24uXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGluc3BlY3QuXG4gICAgICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIGNhc3QgZnVuY3Rpb24uXG4gICAgICovXG4gICAgZnVuY3Rpb24gY2FzdEZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICByZXR1cm4gdHlwZW9mIHZhbHVlID09ICdmdW5jdGlvbicgPyB2YWx1ZSA6IGlkZW50aXR5O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENhc3RzIGB2YWx1ZWAgdG8gYSBwYXRoIGFycmF5IGlmIGl0J3Mgbm90IG9uZS5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gaW5zcGVjdC5cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW29iamVjdF0gVGhlIG9iamVjdCB0byBxdWVyeSBrZXlzIG9uLlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgY2FzdCBwcm9wZXJ0eSBwYXRoIGFycmF5LlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNhc3RQYXRoKHZhbHVlLCBvYmplY3QpIHtcbiAgICAgIGlmIChpc0FycmF5KHZhbHVlKSkge1xuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICB9XG4gICAgICByZXR1cm4gaXNLZXkodmFsdWUsIG9iamVjdCkgPyBbdmFsdWVdIDogc3RyaW5nVG9QYXRoKHRvU3RyaW5nKHZhbHVlKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQSBgYmFzZVJlc3RgIGFsaWFzIHdoaWNoIGNhbiBiZSByZXBsYWNlZCB3aXRoIGBpZGVudGl0eWAgYnkgbW9kdWxlXG4gICAgICogcmVwbGFjZW1lbnQgcGx1Z2lucy5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHR5cGUge0Z1bmN0aW9ufVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZ1bmMgVGhlIGZ1bmN0aW9uIHRvIGFwcGx5IGEgcmVzdCBwYXJhbWV0ZXIgdG8uXG4gICAgICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIHRoZSBuZXcgZnVuY3Rpb24uXG4gICAgICovXG4gICAgdmFyIGNhc3RSZXN0ID0gYmFzZVJlc3Q7XG5cbiAgICAvKipcbiAgICAgKiBDYXN0cyBgYXJyYXlgIHRvIGEgc2xpY2UgaWYgaXQncyBuZWVkZWQuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGFycmF5IFRoZSBhcnJheSB0byBpbnNwZWN0LlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBzdGFydCBUaGUgc3RhcnQgcG9zaXRpb24uXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtlbmQ9YXJyYXkubGVuZ3RoXSBUaGUgZW5kIHBvc2l0aW9uLlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgY2FzdCBzbGljZS5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjYXN0U2xpY2UoYXJyYXksIHN0YXJ0LCBlbmQpIHtcbiAgICAgIHZhciBsZW5ndGggPSBhcnJheS5sZW5ndGg7XG4gICAgICBlbmQgPSBlbmQgPT09IHVuZGVmaW5lZCA/IGxlbmd0aCA6IGVuZDtcbiAgICAgIHJldHVybiAoIXN0YXJ0ICYmIGVuZCA+PSBsZW5ndGgpID8gYXJyYXkgOiBiYXNlU2xpY2UoYXJyYXksIHN0YXJ0LCBlbmQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEEgc2ltcGxlIHdyYXBwZXIgYXJvdW5kIHRoZSBnbG9iYWwgW2BjbGVhclRpbWVvdXRgXShodHRwczovL21kbi5pby9jbGVhclRpbWVvdXQpLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge251bWJlcnxPYmplY3R9IGlkIFRoZSB0aW1lciBpZCBvciB0aW1lb3V0IG9iamVjdCBvZiB0aGUgdGltZXIgdG8gY2xlYXIuXG4gICAgICovXG4gICAgdmFyIGNsZWFyVGltZW91dCA9IGN0eENsZWFyVGltZW91dCB8fCBmdW5jdGlvbihpZCkge1xuICAgICAgcmV0dXJuIHJvb3QuY2xlYXJUaW1lb3V0KGlkKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGNsb25lIG9mICBgYnVmZmVyYC5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtCdWZmZXJ9IGJ1ZmZlciBUaGUgYnVmZmVyIHRvIGNsb25lLlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW2lzRGVlcF0gU3BlY2lmeSBhIGRlZXAgY2xvbmUuXG4gICAgICogQHJldHVybnMge0J1ZmZlcn0gUmV0dXJucyB0aGUgY2xvbmVkIGJ1ZmZlci5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjbG9uZUJ1ZmZlcihidWZmZXIsIGlzRGVlcCkge1xuICAgICAgaWYgKGlzRGVlcCkge1xuICAgICAgICByZXR1cm4gYnVmZmVyLnNsaWNlKCk7XG4gICAgICB9XG4gICAgICB2YXIgbGVuZ3RoID0gYnVmZmVyLmxlbmd0aCxcbiAgICAgICAgICByZXN1bHQgPSBhbGxvY1Vuc2FmZSA/IGFsbG9jVW5zYWZlKGxlbmd0aCkgOiBuZXcgYnVmZmVyLmNvbnN0cnVjdG9yKGxlbmd0aCk7XG5cbiAgICAgIGJ1ZmZlci5jb3B5KHJlc3VsdCk7XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBjbG9uZSBvZiBgYXJyYXlCdWZmZXJgLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge0FycmF5QnVmZmVyfSBhcnJheUJ1ZmZlciBUaGUgYXJyYXkgYnVmZmVyIHRvIGNsb25lLlxuICAgICAqIEByZXR1cm5zIHtBcnJheUJ1ZmZlcn0gUmV0dXJucyB0aGUgY2xvbmVkIGFycmF5IGJ1ZmZlci5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjbG9uZUFycmF5QnVmZmVyKGFycmF5QnVmZmVyKSB7XG4gICAgICB2YXIgcmVzdWx0ID0gbmV3IGFycmF5QnVmZmVyLmNvbnN0cnVjdG9yKGFycmF5QnVmZmVyLmJ5dGVMZW5ndGgpO1xuICAgICAgbmV3IFVpbnQ4QXJyYXkocmVzdWx0KS5zZXQobmV3IFVpbnQ4QXJyYXkoYXJyYXlCdWZmZXIpKTtcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGNsb25lIG9mIGBkYXRhVmlld2AuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBkYXRhVmlldyBUaGUgZGF0YSB2aWV3IHRvIGNsb25lLlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW2lzRGVlcF0gU3BlY2lmeSBhIGRlZXAgY2xvbmUuXG4gICAgICogQHJldHVybnMge09iamVjdH0gUmV0dXJucyB0aGUgY2xvbmVkIGRhdGEgdmlldy5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjbG9uZURhdGFWaWV3KGRhdGFWaWV3LCBpc0RlZXApIHtcbiAgICAgIHZhciBidWZmZXIgPSBpc0RlZXAgPyBjbG9uZUFycmF5QnVmZmVyKGRhdGFWaWV3LmJ1ZmZlcikgOiBkYXRhVmlldy5idWZmZXI7XG4gICAgICByZXR1cm4gbmV3IGRhdGFWaWV3LmNvbnN0cnVjdG9yKGJ1ZmZlciwgZGF0YVZpZXcuYnl0ZU9mZnNldCwgZGF0YVZpZXcuYnl0ZUxlbmd0aCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGNsb25lIG9mIGByZWdleHBgLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gcmVnZXhwIFRoZSByZWdleHAgdG8gY2xvbmUuXG4gICAgICogQHJldHVybnMge09iamVjdH0gUmV0dXJucyB0aGUgY2xvbmVkIHJlZ2V4cC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjbG9uZVJlZ0V4cChyZWdleHApIHtcbiAgICAgIHZhciByZXN1bHQgPSBuZXcgcmVnZXhwLmNvbnN0cnVjdG9yKHJlZ2V4cC5zb3VyY2UsIHJlRmxhZ3MuZXhlYyhyZWdleHApKTtcbiAgICAgIHJlc3VsdC5sYXN0SW5kZXggPSByZWdleHAubGFzdEluZGV4O1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgY2xvbmUgb2YgdGhlIGBzeW1ib2xgIG9iamVjdC5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtPYmplY3R9IHN5bWJvbCBUaGUgc3ltYm9sIG9iamVjdCB0byBjbG9uZS5cbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIHRoZSBjbG9uZWQgc3ltYm9sIG9iamVjdC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjbG9uZVN5bWJvbChzeW1ib2wpIHtcbiAgICAgIHJldHVybiBzeW1ib2xWYWx1ZU9mID8gT2JqZWN0KHN5bWJvbFZhbHVlT2YuY2FsbChzeW1ib2wpKSA6IHt9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBjbG9uZSBvZiBgdHlwZWRBcnJheWAuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSB0eXBlZEFycmF5IFRoZSB0eXBlZCBhcnJheSB0byBjbG9uZS5cbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtpc0RlZXBdIFNwZWNpZnkgYSBkZWVwIGNsb25lLlxuICAgICAqIEByZXR1cm5zIHtPYmplY3R9IFJldHVybnMgdGhlIGNsb25lZCB0eXBlZCBhcnJheS5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjbG9uZVR5cGVkQXJyYXkodHlwZWRBcnJheSwgaXNEZWVwKSB7XG4gICAgICB2YXIgYnVmZmVyID0gaXNEZWVwID8gY2xvbmVBcnJheUJ1ZmZlcih0eXBlZEFycmF5LmJ1ZmZlcikgOiB0eXBlZEFycmF5LmJ1ZmZlcjtcbiAgICAgIHJldHVybiBuZXcgdHlwZWRBcnJheS5jb25zdHJ1Y3RvcihidWZmZXIsIHR5cGVkQXJyYXkuYnl0ZU9mZnNldCwgdHlwZWRBcnJheS5sZW5ndGgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENvbXBhcmVzIHZhbHVlcyB0byBzb3J0IHRoZW0gaW4gYXNjZW5kaW5nIG9yZGVyLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjb21wYXJlLlxuICAgICAqIEBwYXJhbSB7Kn0gb3RoZXIgVGhlIG90aGVyIHZhbHVlIHRvIGNvbXBhcmUuXG4gICAgICogQHJldHVybnMge251bWJlcn0gUmV0dXJucyB0aGUgc29ydCBvcmRlciBpbmRpY2F0b3IgZm9yIGB2YWx1ZWAuXG4gICAgICovXG4gICAgZnVuY3Rpb24gY29tcGFyZUFzY2VuZGluZyh2YWx1ZSwgb3RoZXIpIHtcbiAgICAgIGlmICh2YWx1ZSAhPT0gb3RoZXIpIHtcbiAgICAgICAgdmFyIHZhbElzRGVmaW5lZCA9IHZhbHVlICE9PSB1bmRlZmluZWQsXG4gICAgICAgICAgICB2YWxJc051bGwgPSB2YWx1ZSA9PT0gbnVsbCxcbiAgICAgICAgICAgIHZhbElzUmVmbGV4aXZlID0gdmFsdWUgPT09IHZhbHVlLFxuICAgICAgICAgICAgdmFsSXNTeW1ib2wgPSBpc1N5bWJvbCh2YWx1ZSk7XG5cbiAgICAgICAgdmFyIG90aElzRGVmaW5lZCA9IG90aGVyICE9PSB1bmRlZmluZWQsXG4gICAgICAgICAgICBvdGhJc051bGwgPSBvdGhlciA9PT0gbnVsbCxcbiAgICAgICAgICAgIG90aElzUmVmbGV4aXZlID0gb3RoZXIgPT09IG90aGVyLFxuICAgICAgICAgICAgb3RoSXNTeW1ib2wgPSBpc1N5bWJvbChvdGhlcik7XG5cbiAgICAgICAgaWYgKCghb3RoSXNOdWxsICYmICFvdGhJc1N5bWJvbCAmJiAhdmFsSXNTeW1ib2wgJiYgdmFsdWUgPiBvdGhlcikgfHxcbiAgICAgICAgICAgICh2YWxJc1N5bWJvbCAmJiBvdGhJc0RlZmluZWQgJiYgb3RoSXNSZWZsZXhpdmUgJiYgIW90aElzTnVsbCAmJiAhb3RoSXNTeW1ib2wpIHx8XG4gICAgICAgICAgICAodmFsSXNOdWxsICYmIG90aElzRGVmaW5lZCAmJiBvdGhJc1JlZmxleGl2ZSkgfHxcbiAgICAgICAgICAgICghdmFsSXNEZWZpbmVkICYmIG90aElzUmVmbGV4aXZlKSB8fFxuICAgICAgICAgICAgIXZhbElzUmVmbGV4aXZlKSB7XG4gICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCghdmFsSXNOdWxsICYmICF2YWxJc1N5bWJvbCAmJiAhb3RoSXNTeW1ib2wgJiYgdmFsdWUgPCBvdGhlcikgfHxcbiAgICAgICAgICAgIChvdGhJc1N5bWJvbCAmJiB2YWxJc0RlZmluZWQgJiYgdmFsSXNSZWZsZXhpdmUgJiYgIXZhbElzTnVsbCAmJiAhdmFsSXNTeW1ib2wpIHx8XG4gICAgICAgICAgICAob3RoSXNOdWxsICYmIHZhbElzRGVmaW5lZCAmJiB2YWxJc1JlZmxleGl2ZSkgfHxcbiAgICAgICAgICAgICghb3RoSXNEZWZpbmVkICYmIHZhbElzUmVmbGV4aXZlKSB8fFxuICAgICAgICAgICAgIW90aElzUmVmbGV4aXZlKSB7XG4gICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gMDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVc2VkIGJ5IGBfLm9yZGVyQnlgIHRvIGNvbXBhcmUgbXVsdGlwbGUgcHJvcGVydGllcyBvZiBhIHZhbHVlIHRvIGFub3RoZXJcbiAgICAgKiBhbmQgc3RhYmxlIHNvcnQgdGhlbS5cbiAgICAgKlxuICAgICAqIElmIGBvcmRlcnNgIGlzIHVuc3BlY2lmaWVkLCBhbGwgdmFsdWVzIGFyZSBzb3J0ZWQgaW4gYXNjZW5kaW5nIG9yZGVyLiBPdGhlcndpc2UsXG4gICAgICogc3BlY2lmeSBhbiBvcmRlciBvZiBcImRlc2NcIiBmb3IgZGVzY2VuZGluZyBvciBcImFzY1wiIGZvciBhc2NlbmRpbmcgc29ydCBvcmRlclxuICAgICAqIG9mIGNvcnJlc3BvbmRpbmcgdmFsdWVzLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8gY29tcGFyZS5cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb3RoZXIgVGhlIG90aGVyIG9iamVjdCB0byBjb21wYXJlLlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbltdfHN0cmluZ1tdfSBvcmRlcnMgVGhlIG9yZGVyIHRvIHNvcnQgYnkgZm9yIGVhY2ggcHJvcGVydHkuXG4gICAgICogQHJldHVybnMge251bWJlcn0gUmV0dXJucyB0aGUgc29ydCBvcmRlciBpbmRpY2F0b3IgZm9yIGBvYmplY3RgLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNvbXBhcmVNdWx0aXBsZShvYmplY3QsIG90aGVyLCBvcmRlcnMpIHtcbiAgICAgIHZhciBpbmRleCA9IC0xLFxuICAgICAgICAgIG9iakNyaXRlcmlhID0gb2JqZWN0LmNyaXRlcmlhLFxuICAgICAgICAgIG90aENyaXRlcmlhID0gb3RoZXIuY3JpdGVyaWEsXG4gICAgICAgICAgbGVuZ3RoID0gb2JqQ3JpdGVyaWEubGVuZ3RoLFxuICAgICAgICAgIG9yZGVyc0xlbmd0aCA9IG9yZGVycy5sZW5ndGg7XG5cbiAgICAgIHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG4gICAgICAgIHZhciByZXN1bHQgPSBjb21wYXJlQXNjZW5kaW5nKG9iakNyaXRlcmlhW2luZGV4XSwgb3RoQ3JpdGVyaWFbaW5kZXhdKTtcbiAgICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICAgIGlmIChpbmRleCA+PSBvcmRlcnNMZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgfVxuICAgICAgICAgIHZhciBvcmRlciA9IG9yZGVyc1tpbmRleF07XG4gICAgICAgICAgcmV0dXJuIHJlc3VsdCAqIChvcmRlciA9PSAnZGVzYycgPyAtMSA6IDEpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICAvLyBGaXhlcyBhbiBgQXJyYXkjc29ydGAgYnVnIGluIHRoZSBKUyBlbmdpbmUgZW1iZWRkZWQgaW4gQWRvYmUgYXBwbGljYXRpb25zXG4gICAgICAvLyB0aGF0IGNhdXNlcyBpdCwgdW5kZXIgY2VydGFpbiBjaXJjdW1zdGFuY2VzLCB0byBwcm92aWRlIHRoZSBzYW1lIHZhbHVlIGZvclxuICAgICAgLy8gYG9iamVjdGAgYW5kIGBvdGhlcmAuIFNlZSBodHRwczovL2dpdGh1Yi5jb20vamFzaGtlbmFzL3VuZGVyc2NvcmUvcHVsbC8xMjQ3XG4gICAgICAvLyBmb3IgbW9yZSBkZXRhaWxzLlxuICAgICAgLy9cbiAgICAgIC8vIFRoaXMgYWxzbyBlbnN1cmVzIGEgc3RhYmxlIHNvcnQgaW4gVjggYW5kIG90aGVyIGVuZ2luZXMuXG4gICAgICAvLyBTZWUgaHR0cHM6Ly9idWdzLmNocm9taXVtLm9yZy9wL3Y4L2lzc3Vlcy9kZXRhaWw/aWQ9OTAgZm9yIG1vcmUgZGV0YWlscy5cbiAgICAgIHJldHVybiBvYmplY3QuaW5kZXggLSBvdGhlci5pbmRleDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuIGFycmF5IHRoYXQgaXMgdGhlIGNvbXBvc2l0aW9uIG9mIHBhcnRpYWxseSBhcHBsaWVkIGFyZ3VtZW50cyxcbiAgICAgKiBwbGFjZWhvbGRlcnMsIGFuZCBwcm92aWRlZCBhcmd1bWVudHMgaW50byBhIHNpbmdsZSBhcnJheSBvZiBhcmd1bWVudHMuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGFyZ3MgVGhlIHByb3ZpZGVkIGFyZ3VtZW50cy5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBwYXJ0aWFscyBUaGUgYXJndW1lbnRzIHRvIHByZXBlbmQgdG8gdGhvc2UgcHJvdmlkZWQuXG4gICAgICogQHBhcmFtIHtBcnJheX0gaG9sZGVycyBUaGUgYHBhcnRpYWxzYCBwbGFjZWhvbGRlciBpbmRleGVzLlxuICAgICAqIEBwYXJhbXMge2Jvb2xlYW59IFtpc0N1cnJpZWRdIFNwZWNpZnkgY29tcG9zaW5nIGZvciBhIGN1cnJpZWQgZnVuY3Rpb24uXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIHRoZSBuZXcgYXJyYXkgb2YgY29tcG9zZWQgYXJndW1lbnRzLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNvbXBvc2VBcmdzKGFyZ3MsIHBhcnRpYWxzLCBob2xkZXJzLCBpc0N1cnJpZWQpIHtcbiAgICAgIHZhciBhcmdzSW5kZXggPSAtMSxcbiAgICAgICAgICBhcmdzTGVuZ3RoID0gYXJncy5sZW5ndGgsXG4gICAgICAgICAgaG9sZGVyc0xlbmd0aCA9IGhvbGRlcnMubGVuZ3RoLFxuICAgICAgICAgIGxlZnRJbmRleCA9IC0xLFxuICAgICAgICAgIGxlZnRMZW5ndGggPSBwYXJ0aWFscy5sZW5ndGgsXG4gICAgICAgICAgcmFuZ2VMZW5ndGggPSBuYXRpdmVNYXgoYXJnc0xlbmd0aCAtIGhvbGRlcnNMZW5ndGgsIDApLFxuICAgICAgICAgIHJlc3VsdCA9IEFycmF5KGxlZnRMZW5ndGggKyByYW5nZUxlbmd0aCksXG4gICAgICAgICAgaXNVbmN1cnJpZWQgPSAhaXNDdXJyaWVkO1xuXG4gICAgICB3aGlsZSAoKytsZWZ0SW5kZXggPCBsZWZ0TGVuZ3RoKSB7XG4gICAgICAgIHJlc3VsdFtsZWZ0SW5kZXhdID0gcGFydGlhbHNbbGVmdEluZGV4XTtcbiAgICAgIH1cbiAgICAgIHdoaWxlICgrK2FyZ3NJbmRleCA8IGhvbGRlcnNMZW5ndGgpIHtcbiAgICAgICAgaWYgKGlzVW5jdXJyaWVkIHx8IGFyZ3NJbmRleCA8IGFyZ3NMZW5ndGgpIHtcbiAgICAgICAgICByZXN1bHRbaG9sZGVyc1thcmdzSW5kZXhdXSA9IGFyZ3NbYXJnc0luZGV4XTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgd2hpbGUgKHJhbmdlTGVuZ3RoLS0pIHtcbiAgICAgICAgcmVzdWx0W2xlZnRJbmRleCsrXSA9IGFyZ3NbYXJnc0luZGV4KytdO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGlzIGZ1bmN0aW9uIGlzIGxpa2UgYGNvbXBvc2VBcmdzYCBleGNlcHQgdGhhdCB0aGUgYXJndW1lbnRzIGNvbXBvc2l0aW9uXG4gICAgICogaXMgdGFpbG9yZWQgZm9yIGBfLnBhcnRpYWxSaWdodGAuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGFyZ3MgVGhlIHByb3ZpZGVkIGFyZ3VtZW50cy5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBwYXJ0aWFscyBUaGUgYXJndW1lbnRzIHRvIGFwcGVuZCB0byB0aG9zZSBwcm92aWRlZC5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBob2xkZXJzIFRoZSBgcGFydGlhbHNgIHBsYWNlaG9sZGVyIGluZGV4ZXMuXG4gICAgICogQHBhcmFtcyB7Ym9vbGVhbn0gW2lzQ3VycmllZF0gU3BlY2lmeSBjb21wb3NpbmcgZm9yIGEgY3VycmllZCBmdW5jdGlvbi5cbiAgICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgdGhlIG5ldyBhcnJheSBvZiBjb21wb3NlZCBhcmd1bWVudHMuXG4gICAgICovXG4gICAgZnVuY3Rpb24gY29tcG9zZUFyZ3NSaWdodChhcmdzLCBwYXJ0aWFscywgaG9sZGVycywgaXNDdXJyaWVkKSB7XG4gICAgICB2YXIgYXJnc0luZGV4ID0gLTEsXG4gICAgICAgICAgYXJnc0xlbmd0aCA9IGFyZ3MubGVuZ3RoLFxuICAgICAgICAgIGhvbGRlcnNJbmRleCA9IC0xLFxuICAgICAgICAgIGhvbGRlcnNMZW5ndGggPSBob2xkZXJzLmxlbmd0aCxcbiAgICAgICAgICByaWdodEluZGV4ID0gLTEsXG4gICAgICAgICAgcmlnaHRMZW5ndGggPSBwYXJ0aWFscy5sZW5ndGgsXG4gICAgICAgICAgcmFuZ2VMZW5ndGggPSBuYXRpdmVNYXgoYXJnc0xlbmd0aCAtIGhvbGRlcnNMZW5ndGgsIDApLFxuICAgICAgICAgIHJlc3VsdCA9IEFycmF5KHJhbmdlTGVuZ3RoICsgcmlnaHRMZW5ndGgpLFxuICAgICAgICAgIGlzVW5jdXJyaWVkID0gIWlzQ3VycmllZDtcblxuICAgICAgd2hpbGUgKCsrYXJnc0luZGV4IDwgcmFuZ2VMZW5ndGgpIHtcbiAgICAgICAgcmVzdWx0W2FyZ3NJbmRleF0gPSBhcmdzW2FyZ3NJbmRleF07XG4gICAgICB9XG4gICAgICB2YXIgb2Zmc2V0ID0gYXJnc0luZGV4O1xuICAgICAgd2hpbGUgKCsrcmlnaHRJbmRleCA8IHJpZ2h0TGVuZ3RoKSB7XG4gICAgICAgIHJlc3VsdFtvZmZzZXQgKyByaWdodEluZGV4XSA9IHBhcnRpYWxzW3JpZ2h0SW5kZXhdO1xuICAgICAgfVxuICAgICAgd2hpbGUgKCsraG9sZGVyc0luZGV4IDwgaG9sZGVyc0xlbmd0aCkge1xuICAgICAgICBpZiAoaXNVbmN1cnJpZWQgfHwgYXJnc0luZGV4IDwgYXJnc0xlbmd0aCkge1xuICAgICAgICAgIHJlc3VsdFtvZmZzZXQgKyBob2xkZXJzW2hvbGRlcnNJbmRleF1dID0gYXJnc1thcmdzSW5kZXgrK107XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ29waWVzIHRoZSB2YWx1ZXMgb2YgYHNvdXJjZWAgdG8gYGFycmF5YC5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtBcnJheX0gc291cmNlIFRoZSBhcnJheSB0byBjb3B5IHZhbHVlcyBmcm9tLlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IFthcnJheT1bXV0gVGhlIGFycmF5IHRvIGNvcHkgdmFsdWVzIHRvLlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyBgYXJyYXlgLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNvcHlBcnJheShzb3VyY2UsIGFycmF5KSB7XG4gICAgICB2YXIgaW5kZXggPSAtMSxcbiAgICAgICAgICBsZW5ndGggPSBzb3VyY2UubGVuZ3RoO1xuXG4gICAgICBhcnJheSB8fCAoYXJyYXkgPSBBcnJheShsZW5ndGgpKTtcbiAgICAgIHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG4gICAgICAgIGFycmF5W2luZGV4XSA9IHNvdXJjZVtpbmRleF07XG4gICAgICB9XG4gICAgICByZXR1cm4gYXJyYXk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ29waWVzIHByb3BlcnRpZXMgb2YgYHNvdXJjZWAgdG8gYG9iamVjdGAuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBzb3VyY2UgVGhlIG9iamVjdCB0byBjb3B5IHByb3BlcnRpZXMgZnJvbS5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBwcm9wcyBUaGUgcHJvcGVydHkgaWRlbnRpZmllcnMgdG8gY29weS5cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW29iamVjdD17fV0gVGhlIG9iamVjdCB0byBjb3B5IHByb3BlcnRpZXMgdG8uXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gW2N1c3RvbWl6ZXJdIFRoZSBmdW5jdGlvbiB0byBjdXN0b21pemUgY29waWVkIHZhbHVlcy5cbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIGBvYmplY3RgLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNvcHlPYmplY3Qoc291cmNlLCBwcm9wcywgb2JqZWN0LCBjdXN0b21pemVyKSB7XG4gICAgICB2YXIgaXNOZXcgPSAhb2JqZWN0O1xuICAgICAgb2JqZWN0IHx8IChvYmplY3QgPSB7fSk7XG5cbiAgICAgIHZhciBpbmRleCA9IC0xLFxuICAgICAgICAgIGxlbmd0aCA9IHByb3BzLmxlbmd0aDtcblxuICAgICAgd2hpbGUgKCsraW5kZXggPCBsZW5ndGgpIHtcbiAgICAgICAgdmFyIGtleSA9IHByb3BzW2luZGV4XTtcblxuICAgICAgICB2YXIgbmV3VmFsdWUgPSBjdXN0b21pemVyXG4gICAgICAgICAgPyBjdXN0b21pemVyKG9iamVjdFtrZXldLCBzb3VyY2Vba2V5XSwga2V5LCBvYmplY3QsIHNvdXJjZSlcbiAgICAgICAgICA6IHVuZGVmaW5lZDtcblxuICAgICAgICBpZiAobmV3VmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIG5ld1ZhbHVlID0gc291cmNlW2tleV07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlzTmV3KSB7XG4gICAgICAgICAgYmFzZUFzc2lnblZhbHVlKG9iamVjdCwga2V5LCBuZXdWYWx1ZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgYXNzaWduVmFsdWUob2JqZWN0LCBrZXksIG5ld1ZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIG9iamVjdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDb3BpZXMgb3duIHN5bWJvbHMgb2YgYHNvdXJjZWAgdG8gYG9iamVjdGAuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBzb3VyY2UgVGhlIG9iamVjdCB0byBjb3B5IHN5bWJvbHMgZnJvbS5cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW29iamVjdD17fV0gVGhlIG9iamVjdCB0byBjb3B5IHN5bWJvbHMgdG8uXG4gICAgICogQHJldHVybnMge09iamVjdH0gUmV0dXJucyBgb2JqZWN0YC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjb3B5U3ltYm9scyhzb3VyY2UsIG9iamVjdCkge1xuICAgICAgcmV0dXJuIGNvcHlPYmplY3Qoc291cmNlLCBnZXRTeW1ib2xzKHNvdXJjZSksIG9iamVjdCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ29waWVzIG93biBhbmQgaW5oZXJpdGVkIHN5bWJvbHMgb2YgYHNvdXJjZWAgdG8gYG9iamVjdGAuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBzb3VyY2UgVGhlIG9iamVjdCB0byBjb3B5IHN5bWJvbHMgZnJvbS5cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW29iamVjdD17fV0gVGhlIG9iamVjdCB0byBjb3B5IHN5bWJvbHMgdG8uXG4gICAgICogQHJldHVybnMge09iamVjdH0gUmV0dXJucyBgb2JqZWN0YC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjb3B5U3ltYm9sc0luKHNvdXJjZSwgb2JqZWN0KSB7XG4gICAgICByZXR1cm4gY29weU9iamVjdChzb3VyY2UsIGdldFN5bWJvbHNJbihzb3VyY2UpLCBvYmplY3QpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBmdW5jdGlvbiBsaWtlIGBfLmdyb3VwQnlgLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBzZXR0ZXIgVGhlIGZ1bmN0aW9uIHRvIHNldCBhY2N1bXVsYXRvciB2YWx1ZXMuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gW2luaXRpYWxpemVyXSBUaGUgYWNjdW11bGF0b3Igb2JqZWN0IGluaXRpYWxpemVyLlxuICAgICAqIEByZXR1cm5zIHtGdW5jdGlvbn0gUmV0dXJucyB0aGUgbmV3IGFnZ3JlZ2F0b3IgZnVuY3Rpb24uXG4gICAgICovXG4gICAgZnVuY3Rpb24gY3JlYXRlQWdncmVnYXRvcihzZXR0ZXIsIGluaXRpYWxpemVyKSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24oY29sbGVjdGlvbiwgaXRlcmF0ZWUpIHtcbiAgICAgICAgdmFyIGZ1bmMgPSBpc0FycmF5KGNvbGxlY3Rpb24pID8gYXJyYXlBZ2dyZWdhdG9yIDogYmFzZUFnZ3JlZ2F0b3IsXG4gICAgICAgICAgICBhY2N1bXVsYXRvciA9IGluaXRpYWxpemVyID8gaW5pdGlhbGl6ZXIoKSA6IHt9O1xuXG4gICAgICAgIHJldHVybiBmdW5jKGNvbGxlY3Rpb24sIHNldHRlciwgZ2V0SXRlcmF0ZWUoaXRlcmF0ZWUsIDIpLCBhY2N1bXVsYXRvcik7XG4gICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBmdW5jdGlvbiBsaWtlIGBfLmFzc2lnbmAuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGFzc2lnbmVyIFRoZSBmdW5jdGlvbiB0byBhc3NpZ24gdmFsdWVzLlxuICAgICAqIEByZXR1cm5zIHtGdW5jdGlvbn0gUmV0dXJucyB0aGUgbmV3IGFzc2lnbmVyIGZ1bmN0aW9uLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNyZWF0ZUFzc2lnbmVyKGFzc2lnbmVyKSB7XG4gICAgICByZXR1cm4gYmFzZVJlc3QoZnVuY3Rpb24ob2JqZWN0LCBzb3VyY2VzKSB7XG4gICAgICAgIHZhciBpbmRleCA9IC0xLFxuICAgICAgICAgICAgbGVuZ3RoID0gc291cmNlcy5sZW5ndGgsXG4gICAgICAgICAgICBjdXN0b21pemVyID0gbGVuZ3RoID4gMSA/IHNvdXJjZXNbbGVuZ3RoIC0gMV0gOiB1bmRlZmluZWQsXG4gICAgICAgICAgICBndWFyZCA9IGxlbmd0aCA+IDIgPyBzb3VyY2VzWzJdIDogdW5kZWZpbmVkO1xuXG4gICAgICAgIGN1c3RvbWl6ZXIgPSAoYXNzaWduZXIubGVuZ3RoID4gMyAmJiB0eXBlb2YgY3VzdG9taXplciA9PSAnZnVuY3Rpb24nKVxuICAgICAgICAgID8gKGxlbmd0aC0tLCBjdXN0b21pemVyKVxuICAgICAgICAgIDogdW5kZWZpbmVkO1xuXG4gICAgICAgIGlmIChndWFyZCAmJiBpc0l0ZXJhdGVlQ2FsbChzb3VyY2VzWzBdLCBzb3VyY2VzWzFdLCBndWFyZCkpIHtcbiAgICAgICAgICBjdXN0b21pemVyID0gbGVuZ3RoIDwgMyA/IHVuZGVmaW5lZCA6IGN1c3RvbWl6ZXI7XG4gICAgICAgICAgbGVuZ3RoID0gMTtcbiAgICAgICAgfVxuICAgICAgICBvYmplY3QgPSBPYmplY3Qob2JqZWN0KTtcbiAgICAgICAgd2hpbGUgKCsraW5kZXggPCBsZW5ndGgpIHtcbiAgICAgICAgICB2YXIgc291cmNlID0gc291cmNlc1tpbmRleF07XG4gICAgICAgICAgaWYgKHNvdXJjZSkge1xuICAgICAgICAgICAgYXNzaWduZXIob2JqZWN0LCBzb3VyY2UsIGluZGV4LCBjdXN0b21pemVyKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG9iamVjdDtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBgYmFzZUVhY2hgIG9yIGBiYXNlRWFjaFJpZ2h0YCBmdW5jdGlvbi5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZWFjaEZ1bmMgVGhlIGZ1bmN0aW9uIHRvIGl0ZXJhdGUgb3ZlciBhIGNvbGxlY3Rpb24uXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbZnJvbVJpZ2h0XSBTcGVjaWZ5IGl0ZXJhdGluZyBmcm9tIHJpZ2h0IHRvIGxlZnQuXG4gICAgICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIHRoZSBuZXcgYmFzZSBmdW5jdGlvbi5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjcmVhdGVCYXNlRWFjaChlYWNoRnVuYywgZnJvbVJpZ2h0KSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24oY29sbGVjdGlvbiwgaXRlcmF0ZWUpIHtcbiAgICAgICAgaWYgKGNvbGxlY3Rpb24gPT0gbnVsbCkge1xuICAgICAgICAgIHJldHVybiBjb2xsZWN0aW9uO1xuICAgICAgICB9XG4gICAgICAgIGlmICghaXNBcnJheUxpa2UoY29sbGVjdGlvbikpIHtcbiAgICAgICAgICByZXR1cm4gZWFjaEZ1bmMoY29sbGVjdGlvbiwgaXRlcmF0ZWUpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBsZW5ndGggPSBjb2xsZWN0aW9uLmxlbmd0aCxcbiAgICAgICAgICAgIGluZGV4ID0gZnJvbVJpZ2h0ID8gbGVuZ3RoIDogLTEsXG4gICAgICAgICAgICBpdGVyYWJsZSA9IE9iamVjdChjb2xsZWN0aW9uKTtcblxuICAgICAgICB3aGlsZSAoKGZyb21SaWdodCA/IGluZGV4LS0gOiArK2luZGV4IDwgbGVuZ3RoKSkge1xuICAgICAgICAgIGlmIChpdGVyYXRlZShpdGVyYWJsZVtpbmRleF0sIGluZGV4LCBpdGVyYWJsZSkgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNvbGxlY3Rpb247XG4gICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBiYXNlIGZ1bmN0aW9uIGZvciBtZXRob2RzIGxpa2UgYF8uZm9ySW5gIGFuZCBgXy5mb3JPd25gLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtmcm9tUmlnaHRdIFNwZWNpZnkgaXRlcmF0aW5nIGZyb20gcmlnaHQgdG8gbGVmdC5cbiAgICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgdGhlIG5ldyBiYXNlIGZ1bmN0aW9uLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNyZWF0ZUJhc2VGb3IoZnJvbVJpZ2h0KSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24ob2JqZWN0LCBpdGVyYXRlZSwga2V5c0Z1bmMpIHtcbiAgICAgICAgdmFyIGluZGV4ID0gLTEsXG4gICAgICAgICAgICBpdGVyYWJsZSA9IE9iamVjdChvYmplY3QpLFxuICAgICAgICAgICAgcHJvcHMgPSBrZXlzRnVuYyhvYmplY3QpLFxuICAgICAgICAgICAgbGVuZ3RoID0gcHJvcHMubGVuZ3RoO1xuXG4gICAgICAgIHdoaWxlIChsZW5ndGgtLSkge1xuICAgICAgICAgIHZhciBrZXkgPSBwcm9wc1tmcm9tUmlnaHQgPyBsZW5ndGggOiArK2luZGV4XTtcbiAgICAgICAgICBpZiAoaXRlcmF0ZWUoaXRlcmFibGVba2V5XSwga2V5LCBpdGVyYWJsZSkgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG9iamVjdDtcbiAgICAgIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGZ1bmN0aW9uIHRoYXQgd3JhcHMgYGZ1bmNgIHRvIGludm9rZSBpdCB3aXRoIHRoZSBvcHRpb25hbCBgdGhpc2BcbiAgICAgKiBiaW5kaW5nIG9mIGB0aGlzQXJnYC5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZnVuYyBUaGUgZnVuY3Rpb24gdG8gd3JhcC5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gYml0bWFzayBUaGUgYml0bWFzayBmbGFncy4gU2VlIGBjcmVhdGVXcmFwYCBmb3IgbW9yZSBkZXRhaWxzLlxuICAgICAqIEBwYXJhbSB7Kn0gW3RoaXNBcmddIFRoZSBgdGhpc2AgYmluZGluZyBvZiBgZnVuY2AuXG4gICAgICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIHRoZSBuZXcgd3JhcHBlZCBmdW5jdGlvbi5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjcmVhdGVCaW5kKGZ1bmMsIGJpdG1hc2ssIHRoaXNBcmcpIHtcbiAgICAgIHZhciBpc0JpbmQgPSBiaXRtYXNrICYgV1JBUF9CSU5EX0ZMQUcsXG4gICAgICAgICAgQ3RvciA9IGNyZWF0ZUN0b3IoZnVuYyk7XG5cbiAgICAgIGZ1bmN0aW9uIHdyYXBwZXIoKSB7XG4gICAgICAgIHZhciBmbiA9ICh0aGlzICYmIHRoaXMgIT09IHJvb3QgJiYgdGhpcyBpbnN0YW5jZW9mIHdyYXBwZXIpID8gQ3RvciA6IGZ1bmM7XG4gICAgICAgIHJldHVybiBmbi5hcHBseShpc0JpbmQgPyB0aGlzQXJnIDogdGhpcywgYXJndW1lbnRzKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB3cmFwcGVyO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBmdW5jdGlvbiBsaWtlIGBfLmxvd2VyRmlyc3RgLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbWV0aG9kTmFtZSBUaGUgbmFtZSBvZiB0aGUgYFN0cmluZ2AgY2FzZSBtZXRob2QgdG8gdXNlLlxuICAgICAqIEByZXR1cm5zIHtGdW5jdGlvbn0gUmV0dXJucyB0aGUgbmV3IGNhc2UgZnVuY3Rpb24uXG4gICAgICovXG4gICAgZnVuY3Rpb24gY3JlYXRlQ2FzZUZpcnN0KG1ldGhvZE5hbWUpIHtcbiAgICAgIHJldHVybiBmdW5jdGlvbihzdHJpbmcpIHtcbiAgICAgICAgc3RyaW5nID0gdG9TdHJpbmcoc3RyaW5nKTtcblxuICAgICAgICB2YXIgc3RyU3ltYm9scyA9IGhhc1VuaWNvZGUoc3RyaW5nKVxuICAgICAgICAgID8gc3RyaW5nVG9BcnJheShzdHJpbmcpXG4gICAgICAgICAgOiB1bmRlZmluZWQ7XG5cbiAgICAgICAgdmFyIGNociA9IHN0clN5bWJvbHNcbiAgICAgICAgICA/IHN0clN5bWJvbHNbMF1cbiAgICAgICAgICA6IHN0cmluZy5jaGFyQXQoMCk7XG5cbiAgICAgICAgdmFyIHRyYWlsaW5nID0gc3RyU3ltYm9sc1xuICAgICAgICAgID8gY2FzdFNsaWNlKHN0clN5bWJvbHMsIDEpLmpvaW4oJycpXG4gICAgICAgICAgOiBzdHJpbmcuc2xpY2UoMSk7XG5cbiAgICAgICAgcmV0dXJuIGNoclttZXRob2ROYW1lXSgpICsgdHJhaWxpbmc7XG4gICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBmdW5jdGlvbiBsaWtlIGBfLmNhbWVsQ2FzZWAuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrIFRoZSBmdW5jdGlvbiB0byBjb21iaW5lIGVhY2ggd29yZC5cbiAgICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgdGhlIG5ldyBjb21wb3VuZGVyIGZ1bmN0aW9uLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNyZWF0ZUNvbXBvdW5kZXIoY2FsbGJhY2spIHtcbiAgICAgIHJldHVybiBmdW5jdGlvbihzdHJpbmcpIHtcbiAgICAgICAgcmV0dXJuIGFycmF5UmVkdWNlKHdvcmRzKGRlYnVycihzdHJpbmcpLnJlcGxhY2UocmVBcG9zLCAnJykpLCBjYWxsYmFjaywgJycpO1xuICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgZnVuY3Rpb24gdGhhdCBwcm9kdWNlcyBhbiBpbnN0YW5jZSBvZiBgQ3RvcmAgcmVnYXJkbGVzcyBvZlxuICAgICAqIHdoZXRoZXIgaXQgd2FzIGludm9rZWQgYXMgcGFydCBvZiBhIGBuZXdgIGV4cHJlc3Npb24gb3IgYnkgYGNhbGxgIG9yIGBhcHBseWAuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IEN0b3IgVGhlIGNvbnN0cnVjdG9yIHRvIHdyYXAuXG4gICAgICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIHRoZSBuZXcgd3JhcHBlZCBmdW5jdGlvbi5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjcmVhdGVDdG9yKEN0b3IpIHtcbiAgICAgIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICAgICAgLy8gVXNlIGEgYHN3aXRjaGAgc3RhdGVtZW50IHRvIHdvcmsgd2l0aCBjbGFzcyBjb25zdHJ1Y3RvcnMuIFNlZVxuICAgICAgICAvLyBodHRwOi8vZWNtYS1pbnRlcm5hdGlvbmFsLm9yZy9lY21hLTI2Mi83LjAvI3NlYy1lY21hc2NyaXB0LWZ1bmN0aW9uLW9iamVjdHMtY2FsbC10aGlzYXJndW1lbnQtYXJndW1lbnRzbGlzdFxuICAgICAgICAvLyBmb3IgbW9yZSBkZXRhaWxzLlxuICAgICAgICB2YXIgYXJncyA9IGFyZ3VtZW50cztcbiAgICAgICAgc3dpdGNoIChhcmdzLmxlbmd0aCkge1xuICAgICAgICAgIGNhc2UgMDogcmV0dXJuIG5ldyBDdG9yO1xuICAgICAgICAgIGNhc2UgMTogcmV0dXJuIG5ldyBDdG9yKGFyZ3NbMF0pO1xuICAgICAgICAgIGNhc2UgMjogcmV0dXJuIG5ldyBDdG9yKGFyZ3NbMF0sIGFyZ3NbMV0pO1xuICAgICAgICAgIGNhc2UgMzogcmV0dXJuIG5ldyBDdG9yKGFyZ3NbMF0sIGFyZ3NbMV0sIGFyZ3NbMl0pO1xuICAgICAgICAgIGNhc2UgNDogcmV0dXJuIG5ldyBDdG9yKGFyZ3NbMF0sIGFyZ3NbMV0sIGFyZ3NbMl0sIGFyZ3NbM10pO1xuICAgICAgICAgIGNhc2UgNTogcmV0dXJuIG5ldyBDdG9yKGFyZ3NbMF0sIGFyZ3NbMV0sIGFyZ3NbMl0sIGFyZ3NbM10sIGFyZ3NbNF0pO1xuICAgICAgICAgIGNhc2UgNjogcmV0dXJuIG5ldyBDdG9yKGFyZ3NbMF0sIGFyZ3NbMV0sIGFyZ3NbMl0sIGFyZ3NbM10sIGFyZ3NbNF0sIGFyZ3NbNV0pO1xuICAgICAgICAgIGNhc2UgNzogcmV0dXJuIG5ldyBDdG9yKGFyZ3NbMF0sIGFyZ3NbMV0sIGFyZ3NbMl0sIGFyZ3NbM10sIGFyZ3NbNF0sIGFyZ3NbNV0sIGFyZ3NbNl0pO1xuICAgICAgICB9XG4gICAgICAgIHZhciB0aGlzQmluZGluZyA9IGJhc2VDcmVhdGUoQ3Rvci5wcm90b3R5cGUpLFxuICAgICAgICAgICAgcmVzdWx0ID0gQ3Rvci5hcHBseSh0aGlzQmluZGluZywgYXJncyk7XG5cbiAgICAgICAgLy8gTWltaWMgdGhlIGNvbnN0cnVjdG9yJ3MgYHJldHVybmAgYmVoYXZpb3IuXG4gICAgICAgIC8vIFNlZSBodHRwczovL2VzNS5naXRodWIuaW8vI3gxMy4yLjIgZm9yIG1vcmUgZGV0YWlscy5cbiAgICAgICAgcmV0dXJuIGlzT2JqZWN0KHJlc3VsdCkgPyByZXN1bHQgOiB0aGlzQmluZGluZztcbiAgICAgIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGZ1bmN0aW9uIHRoYXQgd3JhcHMgYGZ1bmNgIHRvIGVuYWJsZSBjdXJyeWluZy5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZnVuYyBUaGUgZnVuY3Rpb24gdG8gd3JhcC5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gYml0bWFzayBUaGUgYml0bWFzayBmbGFncy4gU2VlIGBjcmVhdGVXcmFwYCBmb3IgbW9yZSBkZXRhaWxzLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBhcml0eSBUaGUgYXJpdHkgb2YgYGZ1bmNgLlxuICAgICAqIEByZXR1cm5zIHtGdW5jdGlvbn0gUmV0dXJucyB0aGUgbmV3IHdyYXBwZWQgZnVuY3Rpb24uXG4gICAgICovXG4gICAgZnVuY3Rpb24gY3JlYXRlQ3VycnkoZnVuYywgYml0bWFzaywgYXJpdHkpIHtcbiAgICAgIHZhciBDdG9yID0gY3JlYXRlQ3RvcihmdW5jKTtcblxuICAgICAgZnVuY3Rpb24gd3JhcHBlcigpIHtcbiAgICAgICAgdmFyIGxlbmd0aCA9IGFyZ3VtZW50cy5sZW5ndGgsXG4gICAgICAgICAgICBhcmdzID0gQXJyYXkobGVuZ3RoKSxcbiAgICAgICAgICAgIGluZGV4ID0gbGVuZ3RoLFxuICAgICAgICAgICAgcGxhY2Vob2xkZXIgPSBnZXRIb2xkZXIod3JhcHBlcik7XG5cbiAgICAgICAgd2hpbGUgKGluZGV4LS0pIHtcbiAgICAgICAgICBhcmdzW2luZGV4XSA9IGFyZ3VtZW50c1tpbmRleF07XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGhvbGRlcnMgPSAobGVuZ3RoIDwgMyAmJiBhcmdzWzBdICE9PSBwbGFjZWhvbGRlciAmJiBhcmdzW2xlbmd0aCAtIDFdICE9PSBwbGFjZWhvbGRlcilcbiAgICAgICAgICA/IFtdXG4gICAgICAgICAgOiByZXBsYWNlSG9sZGVycyhhcmdzLCBwbGFjZWhvbGRlcik7XG5cbiAgICAgICAgbGVuZ3RoIC09IGhvbGRlcnMubGVuZ3RoO1xuICAgICAgICBpZiAobGVuZ3RoIDwgYXJpdHkpIHtcbiAgICAgICAgICByZXR1cm4gY3JlYXRlUmVjdXJyeShcbiAgICAgICAgICAgIGZ1bmMsIGJpdG1hc2ssIGNyZWF0ZUh5YnJpZCwgd3JhcHBlci5wbGFjZWhvbGRlciwgdW5kZWZpbmVkLFxuICAgICAgICAgICAgYXJncywgaG9sZGVycywgdW5kZWZpbmVkLCB1bmRlZmluZWQsIGFyaXR5IC0gbGVuZ3RoKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZm4gPSAodGhpcyAmJiB0aGlzICE9PSByb290ICYmIHRoaXMgaW5zdGFuY2VvZiB3cmFwcGVyKSA/IEN0b3IgOiBmdW5jO1xuICAgICAgICByZXR1cm4gYXBwbHkoZm4sIHRoaXMsIGFyZ3MpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHdyYXBwZXI7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGBfLmZpbmRgIG9yIGBfLmZpbmRMYXN0YCBmdW5jdGlvbi5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZmluZEluZGV4RnVuYyBUaGUgZnVuY3Rpb24gdG8gZmluZCB0aGUgY29sbGVjdGlvbiBpbmRleC5cbiAgICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgdGhlIG5ldyBmaW5kIGZ1bmN0aW9uLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNyZWF0ZUZpbmQoZmluZEluZGV4RnVuYykge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uKGNvbGxlY3Rpb24sIHByZWRpY2F0ZSwgZnJvbUluZGV4KSB7XG4gICAgICAgIHZhciBpdGVyYWJsZSA9IE9iamVjdChjb2xsZWN0aW9uKTtcbiAgICAgICAgaWYgKCFpc0FycmF5TGlrZShjb2xsZWN0aW9uKSkge1xuICAgICAgICAgIHZhciBpdGVyYXRlZSA9IGdldEl0ZXJhdGVlKHByZWRpY2F0ZSwgMyk7XG4gICAgICAgICAgY29sbGVjdGlvbiA9IGtleXMoY29sbGVjdGlvbik7XG4gICAgICAgICAgcHJlZGljYXRlID0gZnVuY3Rpb24oa2V5KSB7IHJldHVybiBpdGVyYXRlZShpdGVyYWJsZVtrZXldLCBrZXksIGl0ZXJhYmxlKTsgfTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaW5kZXggPSBmaW5kSW5kZXhGdW5jKGNvbGxlY3Rpb24sIHByZWRpY2F0ZSwgZnJvbUluZGV4KTtcbiAgICAgICAgcmV0dXJuIGluZGV4ID4gLTEgPyBpdGVyYWJsZVtpdGVyYXRlZSA/IGNvbGxlY3Rpb25baW5kZXhdIDogaW5kZXhdIDogdW5kZWZpbmVkO1xuICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgYF8uZmxvd2Agb3IgYF8uZmxvd1JpZ2h0YCBmdW5jdGlvbi5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbZnJvbVJpZ2h0XSBTcGVjaWZ5IGl0ZXJhdGluZyBmcm9tIHJpZ2h0IHRvIGxlZnQuXG4gICAgICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIHRoZSBuZXcgZmxvdyBmdW5jdGlvbi5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjcmVhdGVGbG93KGZyb21SaWdodCkge1xuICAgICAgcmV0dXJuIGZsYXRSZXN0KGZ1bmN0aW9uKGZ1bmNzKSB7XG4gICAgICAgIHZhciBsZW5ndGggPSBmdW5jcy5sZW5ndGgsXG4gICAgICAgICAgICBpbmRleCA9IGxlbmd0aCxcbiAgICAgICAgICAgIHByZXJlcSA9IExvZGFzaFdyYXBwZXIucHJvdG90eXBlLnRocnU7XG5cbiAgICAgICAgaWYgKGZyb21SaWdodCkge1xuICAgICAgICAgIGZ1bmNzLnJldmVyc2UoKTtcbiAgICAgICAgfVxuICAgICAgICB3aGlsZSAoaW5kZXgtLSkge1xuICAgICAgICAgIHZhciBmdW5jID0gZnVuY3NbaW5kZXhdO1xuICAgICAgICAgIGlmICh0eXBlb2YgZnVuYyAhPSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKEZVTkNfRVJST1JfVEVYVCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChwcmVyZXEgJiYgIXdyYXBwZXIgJiYgZ2V0RnVuY05hbWUoZnVuYykgPT0gJ3dyYXBwZXInKSB7XG4gICAgICAgICAgICB2YXIgd3JhcHBlciA9IG5ldyBMb2Rhc2hXcmFwcGVyKFtdLCB0cnVlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaW5kZXggPSB3cmFwcGVyID8gaW5kZXggOiBsZW5ndGg7XG4gICAgICAgIHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG4gICAgICAgICAgZnVuYyA9IGZ1bmNzW2luZGV4XTtcblxuICAgICAgICAgIHZhciBmdW5jTmFtZSA9IGdldEZ1bmNOYW1lKGZ1bmMpLFxuICAgICAgICAgICAgICBkYXRhID0gZnVuY05hbWUgPT0gJ3dyYXBwZXInID8gZ2V0RGF0YShmdW5jKSA6IHVuZGVmaW5lZDtcblxuICAgICAgICAgIGlmIChkYXRhICYmIGlzTGF6aWFibGUoZGF0YVswXSkgJiZcbiAgICAgICAgICAgICAgICBkYXRhWzFdID09IChXUkFQX0FSWV9GTEFHIHwgV1JBUF9DVVJSWV9GTEFHIHwgV1JBUF9QQVJUSUFMX0ZMQUcgfCBXUkFQX1JFQVJHX0ZMQUcpICYmXG4gICAgICAgICAgICAgICAgIWRhdGFbNF0ubGVuZ3RoICYmIGRhdGFbOV0gPT0gMVxuICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgIHdyYXBwZXIgPSB3cmFwcGVyW2dldEZ1bmNOYW1lKGRhdGFbMF0pXS5hcHBseSh3cmFwcGVyLCBkYXRhWzNdKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgd3JhcHBlciA9IChmdW5jLmxlbmd0aCA9PSAxICYmIGlzTGF6aWFibGUoZnVuYykpXG4gICAgICAgICAgICAgID8gd3JhcHBlcltmdW5jTmFtZV0oKVxuICAgICAgICAgICAgICA6IHdyYXBwZXIudGhydShmdW5jKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHZhciBhcmdzID0gYXJndW1lbnRzLFxuICAgICAgICAgICAgICB2YWx1ZSA9IGFyZ3NbMF07XG5cbiAgICAgICAgICBpZiAod3JhcHBlciAmJiBhcmdzLmxlbmd0aCA9PSAxICYmIGlzQXJyYXkodmFsdWUpKSB7XG4gICAgICAgICAgICByZXR1cm4gd3JhcHBlci5wbGFudCh2YWx1ZSkudmFsdWUoKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdmFyIGluZGV4ID0gMCxcbiAgICAgICAgICAgICAgcmVzdWx0ID0gbGVuZ3RoID8gZnVuY3NbaW5kZXhdLmFwcGx5KHRoaXMsIGFyZ3MpIDogdmFsdWU7XG5cbiAgICAgICAgICB3aGlsZSAoKytpbmRleCA8IGxlbmd0aCkge1xuICAgICAgICAgICAgcmVzdWx0ID0gZnVuY3NbaW5kZXhdLmNhbGwodGhpcywgcmVzdWx0KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBmdW5jdGlvbiB0aGF0IHdyYXBzIGBmdW5jYCB0byBpbnZva2UgaXQgd2l0aCBvcHRpb25hbCBgdGhpc2BcbiAgICAgKiBiaW5kaW5nIG9mIGB0aGlzQXJnYCwgcGFydGlhbCBhcHBsaWNhdGlvbiwgYW5kIGN1cnJ5aW5nLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufHN0cmluZ30gZnVuYyBUaGUgZnVuY3Rpb24gb3IgbWV0aG9kIG5hbWUgdG8gd3JhcC5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gYml0bWFzayBUaGUgYml0bWFzayBmbGFncy4gU2VlIGBjcmVhdGVXcmFwYCBmb3IgbW9yZSBkZXRhaWxzLlxuICAgICAqIEBwYXJhbSB7Kn0gW3RoaXNBcmddIFRoZSBgdGhpc2AgYmluZGluZyBvZiBgZnVuY2AuXG4gICAgICogQHBhcmFtIHtBcnJheX0gW3BhcnRpYWxzXSBUaGUgYXJndW1lbnRzIHRvIHByZXBlbmQgdG8gdGhvc2UgcHJvdmlkZWQgdG9cbiAgICAgKiAgdGhlIG5ldyBmdW5jdGlvbi5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBbaG9sZGVyc10gVGhlIGBwYXJ0aWFsc2AgcGxhY2Vob2xkZXIgaW5kZXhlcy5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBbcGFydGlhbHNSaWdodF0gVGhlIGFyZ3VtZW50cyB0byBhcHBlbmQgdG8gdGhvc2UgcHJvdmlkZWRcbiAgICAgKiAgdG8gdGhlIG5ldyBmdW5jdGlvbi5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBbaG9sZGVyc1JpZ2h0XSBUaGUgYHBhcnRpYWxzUmlnaHRgIHBsYWNlaG9sZGVyIGluZGV4ZXMuXG4gICAgICogQHBhcmFtIHtBcnJheX0gW2FyZ1Bvc10gVGhlIGFyZ3VtZW50IHBvc2l0aW9ucyBvZiB0aGUgbmV3IGZ1bmN0aW9uLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbYXJ5XSBUaGUgYXJpdHkgY2FwIG9mIGBmdW5jYC5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW2FyaXR5XSBUaGUgYXJpdHkgb2YgYGZ1bmNgLlxuICAgICAqIEByZXR1cm5zIHtGdW5jdGlvbn0gUmV0dXJucyB0aGUgbmV3IHdyYXBwZWQgZnVuY3Rpb24uXG4gICAgICovXG4gICAgZnVuY3Rpb24gY3JlYXRlSHlicmlkKGZ1bmMsIGJpdG1hc2ssIHRoaXNBcmcsIHBhcnRpYWxzLCBob2xkZXJzLCBwYXJ0aWFsc1JpZ2h0LCBob2xkZXJzUmlnaHQsIGFyZ1BvcywgYXJ5LCBhcml0eSkge1xuICAgICAgdmFyIGlzQXJ5ID0gYml0bWFzayAmIFdSQVBfQVJZX0ZMQUcsXG4gICAgICAgICAgaXNCaW5kID0gYml0bWFzayAmIFdSQVBfQklORF9GTEFHLFxuICAgICAgICAgIGlzQmluZEtleSA9IGJpdG1hc2sgJiBXUkFQX0JJTkRfS0VZX0ZMQUcsXG4gICAgICAgICAgaXNDdXJyaWVkID0gYml0bWFzayAmIChXUkFQX0NVUlJZX0ZMQUcgfCBXUkFQX0NVUlJZX1JJR0hUX0ZMQUcpLFxuICAgICAgICAgIGlzRmxpcCA9IGJpdG1hc2sgJiBXUkFQX0ZMSVBfRkxBRyxcbiAgICAgICAgICBDdG9yID0gaXNCaW5kS2V5ID8gdW5kZWZpbmVkIDogY3JlYXRlQ3RvcihmdW5jKTtcblxuICAgICAgZnVuY3Rpb24gd3JhcHBlcigpIHtcbiAgICAgICAgdmFyIGxlbmd0aCA9IGFyZ3VtZW50cy5sZW5ndGgsXG4gICAgICAgICAgICBhcmdzID0gQXJyYXkobGVuZ3RoKSxcbiAgICAgICAgICAgIGluZGV4ID0gbGVuZ3RoO1xuXG4gICAgICAgIHdoaWxlIChpbmRleC0tKSB7XG4gICAgICAgICAgYXJnc1tpbmRleF0gPSBhcmd1bWVudHNbaW5kZXhdO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpc0N1cnJpZWQpIHtcbiAgICAgICAgICB2YXIgcGxhY2Vob2xkZXIgPSBnZXRIb2xkZXIod3JhcHBlciksXG4gICAgICAgICAgICAgIGhvbGRlcnNDb3VudCA9IGNvdW50SG9sZGVycyhhcmdzLCBwbGFjZWhvbGRlcik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhcnRpYWxzKSB7XG4gICAgICAgICAgYXJncyA9IGNvbXBvc2VBcmdzKGFyZ3MsIHBhcnRpYWxzLCBob2xkZXJzLCBpc0N1cnJpZWQpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJ0aWFsc1JpZ2h0KSB7XG4gICAgICAgICAgYXJncyA9IGNvbXBvc2VBcmdzUmlnaHQoYXJncywgcGFydGlhbHNSaWdodCwgaG9sZGVyc1JpZ2h0LCBpc0N1cnJpZWQpO1xuICAgICAgICB9XG4gICAgICAgIGxlbmd0aCAtPSBob2xkZXJzQ291bnQ7XG4gICAgICAgIGlmIChpc0N1cnJpZWQgJiYgbGVuZ3RoIDwgYXJpdHkpIHtcbiAgICAgICAgICB2YXIgbmV3SG9sZGVycyA9IHJlcGxhY2VIb2xkZXJzKGFyZ3MsIHBsYWNlaG9sZGVyKTtcbiAgICAgICAgICByZXR1cm4gY3JlYXRlUmVjdXJyeShcbiAgICAgICAgICAgIGZ1bmMsIGJpdG1hc2ssIGNyZWF0ZUh5YnJpZCwgd3JhcHBlci5wbGFjZWhvbGRlciwgdGhpc0FyZyxcbiAgICAgICAgICAgIGFyZ3MsIG5ld0hvbGRlcnMsIGFyZ1BvcywgYXJ5LCBhcml0eSAtIGxlbmd0aFxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHRoaXNCaW5kaW5nID0gaXNCaW5kID8gdGhpc0FyZyA6IHRoaXMsXG4gICAgICAgICAgICBmbiA9IGlzQmluZEtleSA/IHRoaXNCaW5kaW5nW2Z1bmNdIDogZnVuYztcblxuICAgICAgICBsZW5ndGggPSBhcmdzLmxlbmd0aDtcbiAgICAgICAgaWYgKGFyZ1Bvcykge1xuICAgICAgICAgIGFyZ3MgPSByZW9yZGVyKGFyZ3MsIGFyZ1Bvcyk7XG4gICAgICAgIH0gZWxzZSBpZiAoaXNGbGlwICYmIGxlbmd0aCA+IDEpIHtcbiAgICAgICAgICBhcmdzLnJldmVyc2UoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaXNBcnkgJiYgYXJ5IDwgbGVuZ3RoKSB7XG4gICAgICAgICAgYXJncy5sZW5ndGggPSBhcnk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMgJiYgdGhpcyAhPT0gcm9vdCAmJiB0aGlzIGluc3RhbmNlb2Ygd3JhcHBlcikge1xuICAgICAgICAgIGZuID0gQ3RvciB8fCBjcmVhdGVDdG9yKGZuKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZm4uYXBwbHkodGhpc0JpbmRpbmcsIGFyZ3MpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHdyYXBwZXI7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGZ1bmN0aW9uIGxpa2UgYF8uaW52ZXJ0QnlgLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBzZXR0ZXIgVGhlIGZ1bmN0aW9uIHRvIHNldCBhY2N1bXVsYXRvciB2YWx1ZXMuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gdG9JdGVyYXRlZSBUaGUgZnVuY3Rpb24gdG8gcmVzb2x2ZSBpdGVyYXRlZXMuXG4gICAgICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIHRoZSBuZXcgaW52ZXJ0ZXIgZnVuY3Rpb24uXG4gICAgICovXG4gICAgZnVuY3Rpb24gY3JlYXRlSW52ZXJ0ZXIoc2V0dGVyLCB0b0l0ZXJhdGVlKSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24ob2JqZWN0LCBpdGVyYXRlZSkge1xuICAgICAgICByZXR1cm4gYmFzZUludmVydGVyKG9iamVjdCwgc2V0dGVyLCB0b0l0ZXJhdGVlKGl0ZXJhdGVlKSwge30pO1xuICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgZnVuY3Rpb24gdGhhdCBwZXJmb3JtcyBhIG1hdGhlbWF0aWNhbCBvcGVyYXRpb24gb24gdHdvIHZhbHVlcy5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gb3BlcmF0b3IgVGhlIGZ1bmN0aW9uIHRvIHBlcmZvcm0gdGhlIG9wZXJhdGlvbi5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW2RlZmF1bHRWYWx1ZV0gVGhlIHZhbHVlIHVzZWQgZm9yIGB1bmRlZmluZWRgIGFyZ3VtZW50cy5cbiAgICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgdGhlIG5ldyBtYXRoZW1hdGljYWwgb3BlcmF0aW9uIGZ1bmN0aW9uLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNyZWF0ZU1hdGhPcGVyYXRpb24ob3BlcmF0b3IsIGRlZmF1bHRWYWx1ZSkge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uKHZhbHVlLCBvdGhlcikge1xuICAgICAgICB2YXIgcmVzdWx0O1xuICAgICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCAmJiBvdGhlciA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgcmV0dXJuIGRlZmF1bHRWYWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodmFsdWUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIHJlc3VsdCA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChvdGhlciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgaWYgKHJlc3VsdCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gb3RoZXI7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT0gJ3N0cmluZycgfHwgdHlwZW9mIG90aGVyID09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICB2YWx1ZSA9IGJhc2VUb1N0cmluZyh2YWx1ZSk7XG4gICAgICAgICAgICBvdGhlciA9IGJhc2VUb1N0cmluZyhvdGhlcik7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHZhbHVlID0gYmFzZVRvTnVtYmVyKHZhbHVlKTtcbiAgICAgICAgICAgIG90aGVyID0gYmFzZVRvTnVtYmVyKG90aGVyKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmVzdWx0ID0gb3BlcmF0b3IodmFsdWUsIG90aGVyKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgZnVuY3Rpb24gbGlrZSBgXy5vdmVyYC5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gYXJyYXlGdW5jIFRoZSBmdW5jdGlvbiB0byBpdGVyYXRlIG92ZXIgaXRlcmF0ZWVzLlxuICAgICAqIEByZXR1cm5zIHtGdW5jdGlvbn0gUmV0dXJucyB0aGUgbmV3IG92ZXIgZnVuY3Rpb24uXG4gICAgICovXG4gICAgZnVuY3Rpb24gY3JlYXRlT3ZlcihhcnJheUZ1bmMpIHtcbiAgICAgIHJldHVybiBmbGF0UmVzdChmdW5jdGlvbihpdGVyYXRlZXMpIHtcbiAgICAgICAgaXRlcmF0ZWVzID0gYXJyYXlNYXAoaXRlcmF0ZWVzLCBiYXNlVW5hcnkoZ2V0SXRlcmF0ZWUoKSkpO1xuICAgICAgICByZXR1cm4gYmFzZVJlc3QoZnVuY3Rpb24oYXJncykge1xuICAgICAgICAgIHZhciB0aGlzQXJnID0gdGhpcztcbiAgICAgICAgICByZXR1cm4gYXJyYXlGdW5jKGl0ZXJhdGVlcywgZnVuY3Rpb24oaXRlcmF0ZWUpIHtcbiAgICAgICAgICAgIHJldHVybiBhcHBseShpdGVyYXRlZSwgdGhpc0FyZywgYXJncyk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyB0aGUgcGFkZGluZyBmb3IgYHN0cmluZ2AgYmFzZWQgb24gYGxlbmd0aGAuIFRoZSBgY2hhcnNgIHN0cmluZ1xuICAgICAqIGlzIHRydW5jYXRlZCBpZiB0aGUgbnVtYmVyIG9mIGNoYXJhY3RlcnMgZXhjZWVkcyBgbGVuZ3RoYC5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGxlbmd0aCBUaGUgcGFkZGluZyBsZW5ndGguXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IFtjaGFycz0nICddIFRoZSBzdHJpbmcgdXNlZCBhcyBwYWRkaW5nLlxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IFJldHVybnMgdGhlIHBhZGRpbmcgZm9yIGBzdHJpbmdgLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNyZWF0ZVBhZGRpbmcobGVuZ3RoLCBjaGFycykge1xuICAgICAgY2hhcnMgPSBjaGFycyA9PT0gdW5kZWZpbmVkID8gJyAnIDogYmFzZVRvU3RyaW5nKGNoYXJzKTtcblxuICAgICAgdmFyIGNoYXJzTGVuZ3RoID0gY2hhcnMubGVuZ3RoO1xuICAgICAgaWYgKGNoYXJzTGVuZ3RoIDwgMikge1xuICAgICAgICByZXR1cm4gY2hhcnNMZW5ndGggPyBiYXNlUmVwZWF0KGNoYXJzLCBsZW5ndGgpIDogY2hhcnM7XG4gICAgICB9XG4gICAgICB2YXIgcmVzdWx0ID0gYmFzZVJlcGVhdChjaGFycywgbmF0aXZlQ2VpbChsZW5ndGggLyBzdHJpbmdTaXplKGNoYXJzKSkpO1xuICAgICAgcmV0dXJuIGhhc1VuaWNvZGUoY2hhcnMpXG4gICAgICAgID8gY2FzdFNsaWNlKHN0cmluZ1RvQXJyYXkocmVzdWx0KSwgMCwgbGVuZ3RoKS5qb2luKCcnKVxuICAgICAgICA6IHJlc3VsdC5zbGljZSgwLCBsZW5ndGgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBmdW5jdGlvbiB0aGF0IHdyYXBzIGBmdW5jYCB0byBpbnZva2UgaXQgd2l0aCB0aGUgYHRoaXNgIGJpbmRpbmdcbiAgICAgKiBvZiBgdGhpc0FyZ2AgYW5kIGBwYXJ0aWFsc2AgcHJlcGVuZGVkIHRvIHRoZSBhcmd1bWVudHMgaXQgcmVjZWl2ZXMuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZ1bmMgVGhlIGZ1bmN0aW9uIHRvIHdyYXAuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGJpdG1hc2sgVGhlIGJpdG1hc2sgZmxhZ3MuIFNlZSBgY3JlYXRlV3JhcGAgZm9yIG1vcmUgZGV0YWlscy5cbiAgICAgKiBAcGFyYW0geyp9IHRoaXNBcmcgVGhlIGB0aGlzYCBiaW5kaW5nIG9mIGBmdW5jYC5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBwYXJ0aWFscyBUaGUgYXJndW1lbnRzIHRvIHByZXBlbmQgdG8gdGhvc2UgcHJvdmlkZWQgdG9cbiAgICAgKiAgdGhlIG5ldyBmdW5jdGlvbi5cbiAgICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgdGhlIG5ldyB3cmFwcGVkIGZ1bmN0aW9uLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNyZWF0ZVBhcnRpYWwoZnVuYywgYml0bWFzaywgdGhpc0FyZywgcGFydGlhbHMpIHtcbiAgICAgIHZhciBpc0JpbmQgPSBiaXRtYXNrICYgV1JBUF9CSU5EX0ZMQUcsXG4gICAgICAgICAgQ3RvciA9IGNyZWF0ZUN0b3IoZnVuYyk7XG5cbiAgICAgIGZ1bmN0aW9uIHdyYXBwZXIoKSB7XG4gICAgICAgIHZhciBhcmdzSW5kZXggPSAtMSxcbiAgICAgICAgICAgIGFyZ3NMZW5ndGggPSBhcmd1bWVudHMubGVuZ3RoLFxuICAgICAgICAgICAgbGVmdEluZGV4ID0gLTEsXG4gICAgICAgICAgICBsZWZ0TGVuZ3RoID0gcGFydGlhbHMubGVuZ3RoLFxuICAgICAgICAgICAgYXJncyA9IEFycmF5KGxlZnRMZW5ndGggKyBhcmdzTGVuZ3RoKSxcbiAgICAgICAgICAgIGZuID0gKHRoaXMgJiYgdGhpcyAhPT0gcm9vdCAmJiB0aGlzIGluc3RhbmNlb2Ygd3JhcHBlcikgPyBDdG9yIDogZnVuYztcblxuICAgICAgICB3aGlsZSAoKytsZWZ0SW5kZXggPCBsZWZ0TGVuZ3RoKSB7XG4gICAgICAgICAgYXJnc1tsZWZ0SW5kZXhdID0gcGFydGlhbHNbbGVmdEluZGV4XTtcbiAgICAgICAgfVxuICAgICAgICB3aGlsZSAoYXJnc0xlbmd0aC0tKSB7XG4gICAgICAgICAgYXJnc1tsZWZ0SW5kZXgrK10gPSBhcmd1bWVudHNbKythcmdzSW5kZXhdO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhcHBseShmbiwgaXNCaW5kID8gdGhpc0FyZyA6IHRoaXMsIGFyZ3MpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHdyYXBwZXI7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGBfLnJhbmdlYCBvciBgXy5yYW5nZVJpZ2h0YCBmdW5jdGlvbi5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbZnJvbVJpZ2h0XSBTcGVjaWZ5IGl0ZXJhdGluZyBmcm9tIHJpZ2h0IHRvIGxlZnQuXG4gICAgICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIHRoZSBuZXcgcmFuZ2UgZnVuY3Rpb24uXG4gICAgICovXG4gICAgZnVuY3Rpb24gY3JlYXRlUmFuZ2UoZnJvbVJpZ2h0KSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24oc3RhcnQsIGVuZCwgc3RlcCkge1xuICAgICAgICBpZiAoc3RlcCAmJiB0eXBlb2Ygc3RlcCAhPSAnbnVtYmVyJyAmJiBpc0l0ZXJhdGVlQ2FsbChzdGFydCwgZW5kLCBzdGVwKSkge1xuICAgICAgICAgIGVuZCA9IHN0ZXAgPSB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgICAgLy8gRW5zdXJlIHRoZSBzaWduIG9mIGAtMGAgaXMgcHJlc2VydmVkLlxuICAgICAgICBzdGFydCA9IHRvRmluaXRlKHN0YXJ0KTtcbiAgICAgICAgaWYgKGVuZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgZW5kID0gc3RhcnQ7XG4gICAgICAgICAgc3RhcnQgPSAwO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGVuZCA9IHRvRmluaXRlKGVuZCk7XG4gICAgICAgIH1cbiAgICAgICAgc3RlcCA9IHN0ZXAgPT09IHVuZGVmaW5lZCA/IChzdGFydCA8IGVuZCA/IDEgOiAtMSkgOiB0b0Zpbml0ZShzdGVwKTtcbiAgICAgICAgcmV0dXJuIGJhc2VSYW5nZShzdGFydCwgZW5kLCBzdGVwLCBmcm9tUmlnaHQpO1xuICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgZnVuY3Rpb24gdGhhdCBwZXJmb3JtcyBhIHJlbGF0aW9uYWwgb3BlcmF0aW9uIG9uIHR3byB2YWx1ZXMuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IG9wZXJhdG9yIFRoZSBmdW5jdGlvbiB0byBwZXJmb3JtIHRoZSBvcGVyYXRpb24uXG4gICAgICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIHRoZSBuZXcgcmVsYXRpb25hbCBvcGVyYXRpb24gZnVuY3Rpb24uXG4gICAgICovXG4gICAgZnVuY3Rpb24gY3JlYXRlUmVsYXRpb25hbE9wZXJhdGlvbihvcGVyYXRvcikge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uKHZhbHVlLCBvdGhlcikge1xuICAgICAgICBpZiAoISh0eXBlb2YgdmFsdWUgPT0gJ3N0cmluZycgJiYgdHlwZW9mIG90aGVyID09ICdzdHJpbmcnKSkge1xuICAgICAgICAgIHZhbHVlID0gdG9OdW1iZXIodmFsdWUpO1xuICAgICAgICAgIG90aGVyID0gdG9OdW1iZXIob3RoZXIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvcGVyYXRvcih2YWx1ZSwgb3RoZXIpO1xuICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgZnVuY3Rpb24gdGhhdCB3cmFwcyBgZnVuY2AgdG8gY29udGludWUgY3VycnlpbmcuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZ1bmMgVGhlIGZ1bmN0aW9uIHRvIHdyYXAuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGJpdG1hc2sgVGhlIGJpdG1hc2sgZmxhZ3MuIFNlZSBgY3JlYXRlV3JhcGAgZm9yIG1vcmUgZGV0YWlscy5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSB3cmFwRnVuYyBUaGUgZnVuY3Rpb24gdG8gY3JlYXRlIHRoZSBgZnVuY2Agd3JhcHBlci5cbiAgICAgKiBAcGFyYW0geyp9IHBsYWNlaG9sZGVyIFRoZSBwbGFjZWhvbGRlciB2YWx1ZS5cbiAgICAgKiBAcGFyYW0geyp9IFt0aGlzQXJnXSBUaGUgYHRoaXNgIGJpbmRpbmcgb2YgYGZ1bmNgLlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IFtwYXJ0aWFsc10gVGhlIGFyZ3VtZW50cyB0byBwcmVwZW5kIHRvIHRob3NlIHByb3ZpZGVkIHRvXG4gICAgICogIHRoZSBuZXcgZnVuY3Rpb24uXG4gICAgICogQHBhcmFtIHtBcnJheX0gW2hvbGRlcnNdIFRoZSBgcGFydGlhbHNgIHBsYWNlaG9sZGVyIGluZGV4ZXMuXG4gICAgICogQHBhcmFtIHtBcnJheX0gW2FyZ1Bvc10gVGhlIGFyZ3VtZW50IHBvc2l0aW9ucyBvZiB0aGUgbmV3IGZ1bmN0aW9uLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbYXJ5XSBUaGUgYXJpdHkgY2FwIG9mIGBmdW5jYC5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW2FyaXR5XSBUaGUgYXJpdHkgb2YgYGZ1bmNgLlxuICAgICAqIEByZXR1cm5zIHtGdW5jdGlvbn0gUmV0dXJucyB0aGUgbmV3IHdyYXBwZWQgZnVuY3Rpb24uXG4gICAgICovXG4gICAgZnVuY3Rpb24gY3JlYXRlUmVjdXJyeShmdW5jLCBiaXRtYXNrLCB3cmFwRnVuYywgcGxhY2Vob2xkZXIsIHRoaXNBcmcsIHBhcnRpYWxzLCBob2xkZXJzLCBhcmdQb3MsIGFyeSwgYXJpdHkpIHtcbiAgICAgIHZhciBpc0N1cnJ5ID0gYml0bWFzayAmIFdSQVBfQ1VSUllfRkxBRyxcbiAgICAgICAgICBuZXdIb2xkZXJzID0gaXNDdXJyeSA/IGhvbGRlcnMgOiB1bmRlZmluZWQsXG4gICAgICAgICAgbmV3SG9sZGVyc1JpZ2h0ID0gaXNDdXJyeSA/IHVuZGVmaW5lZCA6IGhvbGRlcnMsXG4gICAgICAgICAgbmV3UGFydGlhbHMgPSBpc0N1cnJ5ID8gcGFydGlhbHMgOiB1bmRlZmluZWQsXG4gICAgICAgICAgbmV3UGFydGlhbHNSaWdodCA9IGlzQ3VycnkgPyB1bmRlZmluZWQgOiBwYXJ0aWFscztcblxuICAgICAgYml0bWFzayB8PSAoaXNDdXJyeSA/IFdSQVBfUEFSVElBTF9GTEFHIDogV1JBUF9QQVJUSUFMX1JJR0hUX0ZMQUcpO1xuICAgICAgYml0bWFzayAmPSB+KGlzQ3VycnkgPyBXUkFQX1BBUlRJQUxfUklHSFRfRkxBRyA6IFdSQVBfUEFSVElBTF9GTEFHKTtcblxuICAgICAgaWYgKCEoYml0bWFzayAmIFdSQVBfQ1VSUllfQk9VTkRfRkxBRykpIHtcbiAgICAgICAgYml0bWFzayAmPSB+KFdSQVBfQklORF9GTEFHIHwgV1JBUF9CSU5EX0tFWV9GTEFHKTtcbiAgICAgIH1cbiAgICAgIHZhciBuZXdEYXRhID0gW1xuICAgICAgICBmdW5jLCBiaXRtYXNrLCB0aGlzQXJnLCBuZXdQYXJ0aWFscywgbmV3SG9sZGVycywgbmV3UGFydGlhbHNSaWdodCxcbiAgICAgICAgbmV3SG9sZGVyc1JpZ2h0LCBhcmdQb3MsIGFyeSwgYXJpdHlcbiAgICAgIF07XG5cbiAgICAgIHZhciByZXN1bHQgPSB3cmFwRnVuYy5hcHBseSh1bmRlZmluZWQsIG5ld0RhdGEpO1xuICAgICAgaWYgKGlzTGF6aWFibGUoZnVuYykpIHtcbiAgICAgICAgc2V0RGF0YShyZXN1bHQsIG5ld0RhdGEpO1xuICAgICAgfVxuICAgICAgcmVzdWx0LnBsYWNlaG9sZGVyID0gcGxhY2Vob2xkZXI7XG4gICAgICByZXR1cm4gc2V0V3JhcFRvU3RyaW5nKHJlc3VsdCwgZnVuYywgYml0bWFzayk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGZ1bmN0aW9uIGxpa2UgYF8ucm91bmRgLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbWV0aG9kTmFtZSBUaGUgbmFtZSBvZiB0aGUgYE1hdGhgIG1ldGhvZCB0byB1c2Ugd2hlbiByb3VuZGluZy5cbiAgICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgdGhlIG5ldyByb3VuZCBmdW5jdGlvbi5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjcmVhdGVSb3VuZChtZXRob2ROYW1lKSB7XG4gICAgICB2YXIgZnVuYyA9IE1hdGhbbWV0aG9kTmFtZV07XG4gICAgICByZXR1cm4gZnVuY3Rpb24obnVtYmVyLCBwcmVjaXNpb24pIHtcbiAgICAgICAgbnVtYmVyID0gdG9OdW1iZXIobnVtYmVyKTtcbiAgICAgICAgcHJlY2lzaW9uID0gcHJlY2lzaW9uID09IG51bGwgPyAwIDogbmF0aXZlTWluKHRvSW50ZWdlcihwcmVjaXNpb24pLCAyOTIpO1xuICAgICAgICBpZiAocHJlY2lzaW9uKSB7XG4gICAgICAgICAgLy8gU2hpZnQgd2l0aCBleHBvbmVudGlhbCBub3RhdGlvbiB0byBhdm9pZCBmbG9hdGluZy1wb2ludCBpc3N1ZXMuXG4gICAgICAgICAgLy8gU2VlIFtNRE5dKGh0dHBzOi8vbWRuLmlvL3JvdW5kI0V4YW1wbGVzKSBmb3IgbW9yZSBkZXRhaWxzLlxuICAgICAgICAgIHZhciBwYWlyID0gKHRvU3RyaW5nKG51bWJlcikgKyAnZScpLnNwbGl0KCdlJyksXG4gICAgICAgICAgICAgIHZhbHVlID0gZnVuYyhwYWlyWzBdICsgJ2UnICsgKCtwYWlyWzFdICsgcHJlY2lzaW9uKSk7XG5cbiAgICAgICAgICBwYWlyID0gKHRvU3RyaW5nKHZhbHVlKSArICdlJykuc3BsaXQoJ2UnKTtcbiAgICAgICAgICByZXR1cm4gKyhwYWlyWzBdICsgJ2UnICsgKCtwYWlyWzFdIC0gcHJlY2lzaW9uKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZ1bmMobnVtYmVyKTtcbiAgICAgIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIHNldCBvYmplY3Qgb2YgYHZhbHVlc2AuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IHZhbHVlcyBUaGUgdmFsdWVzIHRvIGFkZCB0byB0aGUgc2V0LlxuICAgICAqIEByZXR1cm5zIHtPYmplY3R9IFJldHVybnMgdGhlIG5ldyBzZXQuXG4gICAgICovXG4gICAgdmFyIGNyZWF0ZVNldCA9ICEoU2V0ICYmICgxIC8gc2V0VG9BcnJheShuZXcgU2V0KFssLTBdKSlbMV0pID09IElORklOSVRZKSA/IG5vb3AgOiBmdW5jdGlvbih2YWx1ZXMpIHtcbiAgICAgIHJldHVybiBuZXcgU2V0KHZhbHVlcyk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBgXy50b1BhaXJzYCBvciBgXy50b1BhaXJzSW5gIGZ1bmN0aW9uLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBrZXlzRnVuYyBUaGUgZnVuY3Rpb24gdG8gZ2V0IHRoZSBrZXlzIG9mIGEgZ2l2ZW4gb2JqZWN0LlxuICAgICAqIEByZXR1cm5zIHtGdW5jdGlvbn0gUmV0dXJucyB0aGUgbmV3IHBhaXJzIGZ1bmN0aW9uLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNyZWF0ZVRvUGFpcnMoa2V5c0Z1bmMpIHtcbiAgICAgIHJldHVybiBmdW5jdGlvbihvYmplY3QpIHtcbiAgICAgICAgdmFyIHRhZyA9IGdldFRhZyhvYmplY3QpO1xuICAgICAgICBpZiAodGFnID09IG1hcFRhZykge1xuICAgICAgICAgIHJldHVybiBtYXBUb0FycmF5KG9iamVjdCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRhZyA9PSBzZXRUYWcpIHtcbiAgICAgICAgICByZXR1cm4gc2V0VG9QYWlycyhvYmplY3QpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBiYXNlVG9QYWlycyhvYmplY3QsIGtleXNGdW5jKG9iamVjdCkpO1xuICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgZnVuY3Rpb24gdGhhdCBlaXRoZXIgY3VycmllcyBvciBpbnZva2VzIGBmdW5jYCB3aXRoIG9wdGlvbmFsXG4gICAgICogYHRoaXNgIGJpbmRpbmcgYW5kIHBhcnRpYWxseSBhcHBsaWVkIGFyZ3VtZW50cy5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbnxzdHJpbmd9IGZ1bmMgVGhlIGZ1bmN0aW9uIG9yIG1ldGhvZCBuYW1lIHRvIHdyYXAuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGJpdG1hc2sgVGhlIGJpdG1hc2sgZmxhZ3MuXG4gICAgICogICAgMSAtIGBfLmJpbmRgXG4gICAgICogICAgMiAtIGBfLmJpbmRLZXlgXG4gICAgICogICAgNCAtIGBfLmN1cnJ5YCBvciBgXy5jdXJyeVJpZ2h0YCBvZiBhIGJvdW5kIGZ1bmN0aW9uXG4gICAgICogICAgOCAtIGBfLmN1cnJ5YFxuICAgICAqICAgMTYgLSBgXy5jdXJyeVJpZ2h0YFxuICAgICAqICAgMzIgLSBgXy5wYXJ0aWFsYFxuICAgICAqICAgNjQgLSBgXy5wYXJ0aWFsUmlnaHRgXG4gICAgICogIDEyOCAtIGBfLnJlYXJnYFxuICAgICAqICAyNTYgLSBgXy5hcnlgXG4gICAgICogIDUxMiAtIGBfLmZsaXBgXG4gICAgICogQHBhcmFtIHsqfSBbdGhpc0FyZ10gVGhlIGB0aGlzYCBiaW5kaW5nIG9mIGBmdW5jYC5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBbcGFydGlhbHNdIFRoZSBhcmd1bWVudHMgdG8gYmUgcGFydGlhbGx5IGFwcGxpZWQuXG4gICAgICogQHBhcmFtIHtBcnJheX0gW2hvbGRlcnNdIFRoZSBgcGFydGlhbHNgIHBsYWNlaG9sZGVyIGluZGV4ZXMuXG4gICAgICogQHBhcmFtIHtBcnJheX0gW2FyZ1Bvc10gVGhlIGFyZ3VtZW50IHBvc2l0aW9ucyBvZiB0aGUgbmV3IGZ1bmN0aW9uLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbYXJ5XSBUaGUgYXJpdHkgY2FwIG9mIGBmdW5jYC5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW2FyaXR5XSBUaGUgYXJpdHkgb2YgYGZ1bmNgLlxuICAgICAqIEByZXR1cm5zIHtGdW5jdGlvbn0gUmV0dXJucyB0aGUgbmV3IHdyYXBwZWQgZnVuY3Rpb24uXG4gICAgICovXG4gICAgZnVuY3Rpb24gY3JlYXRlV3JhcChmdW5jLCBiaXRtYXNrLCB0aGlzQXJnLCBwYXJ0aWFscywgaG9sZGVycywgYXJnUG9zLCBhcnksIGFyaXR5KSB7XG4gICAgICB2YXIgaXNCaW5kS2V5ID0gYml0bWFzayAmIFdSQVBfQklORF9LRVlfRkxBRztcbiAgICAgIGlmICghaXNCaW5kS2V5ICYmIHR5cGVvZiBmdW5jICE9ICdmdW5jdGlvbicpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihGVU5DX0VSUk9SX1RFWFQpO1xuICAgICAgfVxuICAgICAgdmFyIGxlbmd0aCA9IHBhcnRpYWxzID8gcGFydGlhbHMubGVuZ3RoIDogMDtcbiAgICAgIGlmICghbGVuZ3RoKSB7XG4gICAgICAgIGJpdG1hc2sgJj0gfihXUkFQX1BBUlRJQUxfRkxBRyB8IFdSQVBfUEFSVElBTF9SSUdIVF9GTEFHKTtcbiAgICAgICAgcGFydGlhbHMgPSBob2xkZXJzID0gdW5kZWZpbmVkO1xuICAgICAgfVxuICAgICAgYXJ5ID0gYXJ5ID09PSB1bmRlZmluZWQgPyBhcnkgOiBuYXRpdmVNYXgodG9JbnRlZ2VyKGFyeSksIDApO1xuICAgICAgYXJpdHkgPSBhcml0eSA9PT0gdW5kZWZpbmVkID8gYXJpdHkgOiB0b0ludGVnZXIoYXJpdHkpO1xuICAgICAgbGVuZ3RoIC09IGhvbGRlcnMgPyBob2xkZXJzLmxlbmd0aCA6IDA7XG5cbiAgICAgIGlmIChiaXRtYXNrICYgV1JBUF9QQVJUSUFMX1JJR0hUX0ZMQUcpIHtcbiAgICAgICAgdmFyIHBhcnRpYWxzUmlnaHQgPSBwYXJ0aWFscyxcbiAgICAgICAgICAgIGhvbGRlcnNSaWdodCA9IGhvbGRlcnM7XG5cbiAgICAgICAgcGFydGlhbHMgPSBob2xkZXJzID0gdW5kZWZpbmVkO1xuICAgICAgfVxuICAgICAgdmFyIGRhdGEgPSBpc0JpbmRLZXkgPyB1bmRlZmluZWQgOiBnZXREYXRhKGZ1bmMpO1xuXG4gICAgICB2YXIgbmV3RGF0YSA9IFtcbiAgICAgICAgZnVuYywgYml0bWFzaywgdGhpc0FyZywgcGFydGlhbHMsIGhvbGRlcnMsIHBhcnRpYWxzUmlnaHQsIGhvbGRlcnNSaWdodCxcbiAgICAgICAgYXJnUG9zLCBhcnksIGFyaXR5XG4gICAgICBdO1xuXG4gICAgICBpZiAoZGF0YSkge1xuICAgICAgICBtZXJnZURhdGEobmV3RGF0YSwgZGF0YSk7XG4gICAgICB9XG4gICAgICBmdW5jID0gbmV3RGF0YVswXTtcbiAgICAgIGJpdG1hc2sgPSBuZXdEYXRhWzFdO1xuICAgICAgdGhpc0FyZyA9IG5ld0RhdGFbMl07XG4gICAgICBwYXJ0aWFscyA9IG5ld0RhdGFbM107XG4gICAgICBob2xkZXJzID0gbmV3RGF0YVs0XTtcbiAgICAgIGFyaXR5ID0gbmV3RGF0YVs5XSA9IG5ld0RhdGFbOV0gPT09IHVuZGVmaW5lZFxuICAgICAgICA/IChpc0JpbmRLZXkgPyAwIDogZnVuYy5sZW5ndGgpXG4gICAgICAgIDogbmF0aXZlTWF4KG5ld0RhdGFbOV0gLSBsZW5ndGgsIDApO1xuXG4gICAgICBpZiAoIWFyaXR5ICYmIGJpdG1hc2sgJiAoV1JBUF9DVVJSWV9GTEFHIHwgV1JBUF9DVVJSWV9SSUdIVF9GTEFHKSkge1xuICAgICAgICBiaXRtYXNrICY9IH4oV1JBUF9DVVJSWV9GTEFHIHwgV1JBUF9DVVJSWV9SSUdIVF9GTEFHKTtcbiAgICAgIH1cbiAgICAgIGlmICghYml0bWFzayB8fCBiaXRtYXNrID09IFdSQVBfQklORF9GTEFHKSB7XG4gICAgICAgIHZhciByZXN1bHQgPSBjcmVhdGVCaW5kKGZ1bmMsIGJpdG1hc2ssIHRoaXNBcmcpO1xuICAgICAgfSBlbHNlIGlmIChiaXRtYXNrID09IFdSQVBfQ1VSUllfRkxBRyB8fCBiaXRtYXNrID09IFdSQVBfQ1VSUllfUklHSFRfRkxBRykge1xuICAgICAgICByZXN1bHQgPSBjcmVhdGVDdXJyeShmdW5jLCBiaXRtYXNrLCBhcml0eSk7XG4gICAgICB9IGVsc2UgaWYgKChiaXRtYXNrID09IFdSQVBfUEFSVElBTF9GTEFHIHx8IGJpdG1hc2sgPT0gKFdSQVBfQklORF9GTEFHIHwgV1JBUF9QQVJUSUFMX0ZMQUcpKSAmJiAhaG9sZGVycy5sZW5ndGgpIHtcbiAgICAgICAgcmVzdWx0ID0gY3JlYXRlUGFydGlhbChmdW5jLCBiaXRtYXNrLCB0aGlzQXJnLCBwYXJ0aWFscyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXN1bHQgPSBjcmVhdGVIeWJyaWQuYXBwbHkodW5kZWZpbmVkLCBuZXdEYXRhKTtcbiAgICAgIH1cbiAgICAgIHZhciBzZXR0ZXIgPSBkYXRhID8gYmFzZVNldERhdGEgOiBzZXREYXRhO1xuICAgICAgcmV0dXJuIHNldFdyYXBUb1N0cmluZyhzZXR0ZXIocmVzdWx0LCBuZXdEYXRhKSwgZnVuYywgYml0bWFzayk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXNlZCBieSBgXy5kZWZhdWx0c2AgdG8gY3VzdG9taXplIGl0cyBgXy5hc3NpZ25JbmAgdXNlIHRvIGFzc2lnbiBwcm9wZXJ0aWVzXG4gICAgICogb2Ygc291cmNlIG9iamVjdHMgdG8gdGhlIGRlc3RpbmF0aW9uIG9iamVjdCBmb3IgYWxsIGRlc3RpbmF0aW9uIHByb3BlcnRpZXNcbiAgICAgKiB0aGF0IHJlc29sdmUgdG8gYHVuZGVmaW5lZGAuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7Kn0gb2JqVmFsdWUgVGhlIGRlc3RpbmF0aW9uIHZhbHVlLlxuICAgICAqIEBwYXJhbSB7Kn0gc3JjVmFsdWUgVGhlIHNvdXJjZSB2YWx1ZS5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30ga2V5IFRoZSBrZXkgb2YgdGhlIHByb3BlcnR5IHRvIGFzc2lnbi5cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBwYXJlbnQgb2JqZWN0IG9mIGBvYmpWYWx1ZWAuXG4gICAgICogQHJldHVybnMgeyp9IFJldHVybnMgdGhlIHZhbHVlIHRvIGFzc2lnbi5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjdXN0b21EZWZhdWx0c0Fzc2lnbkluKG9ialZhbHVlLCBzcmNWYWx1ZSwga2V5LCBvYmplY3QpIHtcbiAgICAgIGlmIChvYmpWYWx1ZSA9PT0gdW5kZWZpbmVkIHx8XG4gICAgICAgICAgKGVxKG9ialZhbHVlLCBvYmplY3RQcm90b1trZXldKSAmJiAhaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIGtleSkpKSB7XG4gICAgICAgIHJldHVybiBzcmNWYWx1ZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBvYmpWYWx1ZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVc2VkIGJ5IGBfLmRlZmF1bHRzRGVlcGAgdG8gY3VzdG9taXplIGl0cyBgXy5tZXJnZWAgdXNlIHRvIG1lcmdlIHNvdXJjZVxuICAgICAqIG9iamVjdHMgaW50byBkZXN0aW5hdGlvbiBvYmplY3RzIHRoYXQgYXJlIHBhc3NlZCB0aHJ1LlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0geyp9IG9ialZhbHVlIFRoZSBkZXN0aW5hdGlvbiB2YWx1ZS5cbiAgICAgKiBAcGFyYW0geyp9IHNyY1ZhbHVlIFRoZSBzb3VyY2UgdmFsdWUuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGtleSBUaGUga2V5IG9mIHRoZSBwcm9wZXJ0eSB0byBtZXJnZS5cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBwYXJlbnQgb2JqZWN0IG9mIGBvYmpWYWx1ZWAuXG4gICAgICogQHBhcmFtIHtPYmplY3R9IHNvdXJjZSBUaGUgcGFyZW50IG9iamVjdCBvZiBgc3JjVmFsdWVgLlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbc3RhY2tdIFRyYWNrcyB0cmF2ZXJzZWQgc291cmNlIHZhbHVlcyBhbmQgdGhlaXIgbWVyZ2VkXG4gICAgICogIGNvdW50ZXJwYXJ0cy5cbiAgICAgKiBAcmV0dXJucyB7Kn0gUmV0dXJucyB0aGUgdmFsdWUgdG8gYXNzaWduLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGN1c3RvbURlZmF1bHRzTWVyZ2Uob2JqVmFsdWUsIHNyY1ZhbHVlLCBrZXksIG9iamVjdCwgc291cmNlLCBzdGFjaykge1xuICAgICAgaWYgKGlzT2JqZWN0KG9ialZhbHVlKSAmJiBpc09iamVjdChzcmNWYWx1ZSkpIHtcbiAgICAgICAgLy8gUmVjdXJzaXZlbHkgbWVyZ2Ugb2JqZWN0cyBhbmQgYXJyYXlzIChzdXNjZXB0aWJsZSB0byBjYWxsIHN0YWNrIGxpbWl0cykuXG4gICAgICAgIHN0YWNrLnNldChzcmNWYWx1ZSwgb2JqVmFsdWUpO1xuICAgICAgICBiYXNlTWVyZ2Uob2JqVmFsdWUsIHNyY1ZhbHVlLCB1bmRlZmluZWQsIGN1c3RvbURlZmF1bHRzTWVyZ2UsIHN0YWNrKTtcbiAgICAgICAgc3RhY2tbJ2RlbGV0ZSddKHNyY1ZhbHVlKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBvYmpWYWx1ZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVc2VkIGJ5IGBfLm9taXRgIHRvIGN1c3RvbWl6ZSBpdHMgYF8uY2xvbmVEZWVwYCB1c2UgdG8gb25seSBjbG9uZSBwbGFpblxuICAgICAqIG9iamVjdHMuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGluc3BlY3QuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGtleSBUaGUga2V5IG9mIHRoZSBwcm9wZXJ0eSB0byBpbnNwZWN0LlxuICAgICAqIEByZXR1cm5zIHsqfSBSZXR1cm5zIHRoZSB1bmNsb25lZCB2YWx1ZSBvciBgdW5kZWZpbmVkYCB0byBkZWZlciBjbG9uaW5nIHRvIGBfLmNsb25lRGVlcGAuXG4gICAgICovXG4gICAgZnVuY3Rpb24gY3VzdG9tT21pdENsb25lKHZhbHVlKSB7XG4gICAgICByZXR1cm4gaXNQbGFpbk9iamVjdCh2YWx1ZSkgPyB1bmRlZmluZWQgOiB2YWx1ZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBIHNwZWNpYWxpemVkIHZlcnNpb24gb2YgYGJhc2VJc0VxdWFsRGVlcGAgZm9yIGFycmF5cyB3aXRoIHN1cHBvcnQgZm9yXG4gICAgICogcGFydGlhbCBkZWVwIGNvbXBhcmlzb25zLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBhcnJheSBUaGUgYXJyYXkgdG8gY29tcGFyZS5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBvdGhlciBUaGUgb3RoZXIgYXJyYXkgdG8gY29tcGFyZS5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gYml0bWFzayBUaGUgYml0bWFzayBmbGFncy4gU2VlIGBiYXNlSXNFcXVhbGAgZm9yIG1vcmUgZGV0YWlscy5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjdXN0b21pemVyIFRoZSBmdW5jdGlvbiB0byBjdXN0b21pemUgY29tcGFyaXNvbnMuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZXF1YWxGdW5jIFRoZSBmdW5jdGlvbiB0byBkZXRlcm1pbmUgZXF1aXZhbGVudHMgb2YgdmFsdWVzLlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBzdGFjayBUcmFja3MgdHJhdmVyc2VkIGBhcnJheWAgYW5kIGBvdGhlcmAgb2JqZWN0cy5cbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIGFycmF5cyBhcmUgZXF1aXZhbGVudCwgZWxzZSBgZmFsc2VgLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGVxdWFsQXJyYXlzKGFycmF5LCBvdGhlciwgYml0bWFzaywgY3VzdG9taXplciwgZXF1YWxGdW5jLCBzdGFjaykge1xuICAgICAgdmFyIGlzUGFydGlhbCA9IGJpdG1hc2sgJiBDT01QQVJFX1BBUlRJQUxfRkxBRyxcbiAgICAgICAgICBhcnJMZW5ndGggPSBhcnJheS5sZW5ndGgsXG4gICAgICAgICAgb3RoTGVuZ3RoID0gb3RoZXIubGVuZ3RoO1xuXG4gICAgICBpZiAoYXJyTGVuZ3RoICE9IG90aExlbmd0aCAmJiAhKGlzUGFydGlhbCAmJiBvdGhMZW5ndGggPiBhcnJMZW5ndGgpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIC8vIEFzc3VtZSBjeWNsaWMgdmFsdWVzIGFyZSBlcXVhbC5cbiAgICAgIHZhciBzdGFja2VkID0gc3RhY2suZ2V0KGFycmF5KTtcbiAgICAgIGlmIChzdGFja2VkICYmIHN0YWNrLmdldChvdGhlcikpIHtcbiAgICAgICAgcmV0dXJuIHN0YWNrZWQgPT0gb3RoZXI7XG4gICAgICB9XG4gICAgICB2YXIgaW5kZXggPSAtMSxcbiAgICAgICAgICByZXN1bHQgPSB0cnVlLFxuICAgICAgICAgIHNlZW4gPSAoYml0bWFzayAmIENPTVBBUkVfVU5PUkRFUkVEX0ZMQUcpID8gbmV3IFNldENhY2hlIDogdW5kZWZpbmVkO1xuXG4gICAgICBzdGFjay5zZXQoYXJyYXksIG90aGVyKTtcbiAgICAgIHN0YWNrLnNldChvdGhlciwgYXJyYXkpO1xuXG4gICAgICAvLyBJZ25vcmUgbm9uLWluZGV4IHByb3BlcnRpZXMuXG4gICAgICB3aGlsZSAoKytpbmRleCA8IGFyckxlbmd0aCkge1xuICAgICAgICB2YXIgYXJyVmFsdWUgPSBhcnJheVtpbmRleF0sXG4gICAgICAgICAgICBvdGhWYWx1ZSA9IG90aGVyW2luZGV4XTtcblxuICAgICAgICBpZiAoY3VzdG9taXplcikge1xuICAgICAgICAgIHZhciBjb21wYXJlZCA9IGlzUGFydGlhbFxuICAgICAgICAgICAgPyBjdXN0b21pemVyKG90aFZhbHVlLCBhcnJWYWx1ZSwgaW5kZXgsIG90aGVyLCBhcnJheSwgc3RhY2spXG4gICAgICAgICAgICA6IGN1c3RvbWl6ZXIoYXJyVmFsdWUsIG90aFZhbHVlLCBpbmRleCwgYXJyYXksIG90aGVyLCBzdGFjayk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNvbXBhcmVkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICBpZiAoY29tcGFyZWQpIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXN1bHQgPSBmYWxzZTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICAvLyBSZWN1cnNpdmVseSBjb21wYXJlIGFycmF5cyAoc3VzY2VwdGlibGUgdG8gY2FsbCBzdGFjayBsaW1pdHMpLlxuICAgICAgICBpZiAoc2Vlbikge1xuICAgICAgICAgIGlmICghYXJyYXlTb21lKG90aGVyLCBmdW5jdGlvbihvdGhWYWx1ZSwgb3RoSW5kZXgpIHtcbiAgICAgICAgICAgICAgICBpZiAoIWNhY2hlSGFzKHNlZW4sIG90aEluZGV4KSAmJlxuICAgICAgICAgICAgICAgICAgICAoYXJyVmFsdWUgPT09IG90aFZhbHVlIHx8IGVxdWFsRnVuYyhhcnJWYWx1ZSwgb3RoVmFsdWUsIGJpdG1hc2ssIGN1c3RvbWl6ZXIsIHN0YWNrKSkpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBzZWVuLnB1c2gob3RoSW5kZXgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSkpIHtcbiAgICAgICAgICAgIHJlc3VsdCA9IGZhbHNlO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKCEoXG4gICAgICAgICAgICAgIGFyclZhbHVlID09PSBvdGhWYWx1ZSB8fFxuICAgICAgICAgICAgICAgIGVxdWFsRnVuYyhhcnJWYWx1ZSwgb3RoVmFsdWUsIGJpdG1hc2ssIGN1c3RvbWl6ZXIsIHN0YWNrKVxuICAgICAgICAgICAgKSkge1xuICAgICAgICAgIHJlc3VsdCA9IGZhbHNlO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBzdGFja1snZGVsZXRlJ10oYXJyYXkpO1xuICAgICAgc3RhY2tbJ2RlbGV0ZSddKG90aGVyKTtcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQSBzcGVjaWFsaXplZCB2ZXJzaW9uIG9mIGBiYXNlSXNFcXVhbERlZXBgIGZvciBjb21wYXJpbmcgb2JqZWN0cyBvZlxuICAgICAqIHRoZSBzYW1lIGB0b1N0cmluZ1RhZ2AuXG4gICAgICpcbiAgICAgKiAqKk5vdGU6KiogVGhpcyBmdW5jdGlvbiBvbmx5IHN1cHBvcnRzIGNvbXBhcmluZyB2YWx1ZXMgd2l0aCB0YWdzIG9mXG4gICAgICogYEJvb2xlYW5gLCBgRGF0ZWAsIGBFcnJvcmAsIGBOdW1iZXJgLCBgUmVnRXhwYCwgb3IgYFN0cmluZ2AuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIG9iamVjdCB0byBjb21wYXJlLlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvdGhlciBUaGUgb3RoZXIgb2JqZWN0IHRvIGNvbXBhcmUuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHRhZyBUaGUgYHRvU3RyaW5nVGFnYCBvZiB0aGUgb2JqZWN0cyB0byBjb21wYXJlLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBiaXRtYXNrIFRoZSBiaXRtYXNrIGZsYWdzLiBTZWUgYGJhc2VJc0VxdWFsYCBmb3IgbW9yZSBkZXRhaWxzLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGN1c3RvbWl6ZXIgVGhlIGZ1bmN0aW9uIHRvIGN1c3RvbWl6ZSBjb21wYXJpc29ucy5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBlcXVhbEZ1bmMgVGhlIGZ1bmN0aW9uIHRvIGRldGVybWluZSBlcXVpdmFsZW50cyBvZiB2YWx1ZXMuXG4gICAgICogQHBhcmFtIHtPYmplY3R9IHN0YWNrIFRyYWNrcyB0cmF2ZXJzZWQgYG9iamVjdGAgYW5kIGBvdGhlcmAgb2JqZWN0cy5cbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIG9iamVjdHMgYXJlIGVxdWl2YWxlbnQsIGVsc2UgYGZhbHNlYC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBlcXVhbEJ5VGFnKG9iamVjdCwgb3RoZXIsIHRhZywgYml0bWFzaywgY3VzdG9taXplciwgZXF1YWxGdW5jLCBzdGFjaykge1xuICAgICAgc3dpdGNoICh0YWcpIHtcbiAgICAgICAgY2FzZSBkYXRhVmlld1RhZzpcbiAgICAgICAgICBpZiAoKG9iamVjdC5ieXRlTGVuZ3RoICE9IG90aGVyLmJ5dGVMZW5ndGgpIHx8XG4gICAgICAgICAgICAgIChvYmplY3QuYnl0ZU9mZnNldCAhPSBvdGhlci5ieXRlT2Zmc2V0KSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgICBvYmplY3QgPSBvYmplY3QuYnVmZmVyO1xuICAgICAgICAgIG90aGVyID0gb3RoZXIuYnVmZmVyO1xuXG4gICAgICAgIGNhc2UgYXJyYXlCdWZmZXJUYWc6XG4gICAgICAgICAgaWYgKChvYmplY3QuYnl0ZUxlbmd0aCAhPSBvdGhlci5ieXRlTGVuZ3RoKSB8fFxuICAgICAgICAgICAgICAhZXF1YWxGdW5jKG5ldyBVaW50OEFycmF5KG9iamVjdCksIG5ldyBVaW50OEFycmF5KG90aGVyKSkpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG5cbiAgICAgICAgY2FzZSBib29sVGFnOlxuICAgICAgICBjYXNlIGRhdGVUYWc6XG4gICAgICAgIGNhc2UgbnVtYmVyVGFnOlxuICAgICAgICAgIC8vIENvZXJjZSBib29sZWFucyB0byBgMWAgb3IgYDBgIGFuZCBkYXRlcyB0byBtaWxsaXNlY29uZHMuXG4gICAgICAgICAgLy8gSW52YWxpZCBkYXRlcyBhcmUgY29lcmNlZCB0byBgTmFOYC5cbiAgICAgICAgICByZXR1cm4gZXEoK29iamVjdCwgK290aGVyKTtcblxuICAgICAgICBjYXNlIGVycm9yVGFnOlxuICAgICAgICAgIHJldHVybiBvYmplY3QubmFtZSA9PSBvdGhlci5uYW1lICYmIG9iamVjdC5tZXNzYWdlID09IG90aGVyLm1lc3NhZ2U7XG5cbiAgICAgICAgY2FzZSByZWdleHBUYWc6XG4gICAgICAgIGNhc2Ugc3RyaW5nVGFnOlxuICAgICAgICAgIC8vIENvZXJjZSByZWdleGVzIHRvIHN0cmluZ3MgYW5kIHRyZWF0IHN0cmluZ3MsIHByaW1pdGl2ZXMgYW5kIG9iamVjdHMsXG4gICAgICAgICAgLy8gYXMgZXF1YWwuIFNlZSBodHRwOi8vd3d3LmVjbWEtaW50ZXJuYXRpb25hbC5vcmcvZWNtYS0yNjIvNy4wLyNzZWMtcmVnZXhwLnByb3RvdHlwZS50b3N0cmluZ1xuICAgICAgICAgIC8vIGZvciBtb3JlIGRldGFpbHMuXG4gICAgICAgICAgcmV0dXJuIG9iamVjdCA9PSAob3RoZXIgKyAnJyk7XG5cbiAgICAgICAgY2FzZSBtYXBUYWc6XG4gICAgICAgICAgdmFyIGNvbnZlcnQgPSBtYXBUb0FycmF5O1xuXG4gICAgICAgIGNhc2Ugc2V0VGFnOlxuICAgICAgICAgIHZhciBpc1BhcnRpYWwgPSBiaXRtYXNrICYgQ09NUEFSRV9QQVJUSUFMX0ZMQUc7XG4gICAgICAgICAgY29udmVydCB8fCAoY29udmVydCA9IHNldFRvQXJyYXkpO1xuXG4gICAgICAgICAgaWYgKG9iamVjdC5zaXplICE9IG90aGVyLnNpemUgJiYgIWlzUGFydGlhbCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgICAvLyBBc3N1bWUgY3ljbGljIHZhbHVlcyBhcmUgZXF1YWwuXG4gICAgICAgICAgdmFyIHN0YWNrZWQgPSBzdGFjay5nZXQob2JqZWN0KTtcbiAgICAgICAgICBpZiAoc3RhY2tlZCkge1xuICAgICAgICAgICAgcmV0dXJuIHN0YWNrZWQgPT0gb3RoZXI7XG4gICAgICAgICAgfVxuICAgICAgICAgIGJpdG1hc2sgfD0gQ09NUEFSRV9VTk9SREVSRURfRkxBRztcblxuICAgICAgICAgIC8vIFJlY3Vyc2l2ZWx5IGNvbXBhcmUgb2JqZWN0cyAoc3VzY2VwdGlibGUgdG8gY2FsbCBzdGFjayBsaW1pdHMpLlxuICAgICAgICAgIHN0YWNrLnNldChvYmplY3QsIG90aGVyKTtcbiAgICAgICAgICB2YXIgcmVzdWx0ID0gZXF1YWxBcnJheXMoY29udmVydChvYmplY3QpLCBjb252ZXJ0KG90aGVyKSwgYml0bWFzaywgY3VzdG9taXplciwgZXF1YWxGdW5jLCBzdGFjayk7XG4gICAgICAgICAgc3RhY2tbJ2RlbGV0ZSddKG9iamVjdCk7XG4gICAgICAgICAgcmV0dXJuIHJlc3VsdDtcblxuICAgICAgICBjYXNlIHN5bWJvbFRhZzpcbiAgICAgICAgICBpZiAoc3ltYm9sVmFsdWVPZikge1xuICAgICAgICAgICAgcmV0dXJuIHN5bWJvbFZhbHVlT2YuY2FsbChvYmplY3QpID09IHN5bWJvbFZhbHVlT2YuY2FsbChvdGhlcik7XG4gICAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEEgc3BlY2lhbGl6ZWQgdmVyc2lvbiBvZiBgYmFzZUlzRXF1YWxEZWVwYCBmb3Igb2JqZWN0cyB3aXRoIHN1cHBvcnQgZm9yXG4gICAgICogcGFydGlhbCBkZWVwIGNvbXBhcmlzb25zLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8gY29tcGFyZS5cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb3RoZXIgVGhlIG90aGVyIG9iamVjdCB0byBjb21wYXJlLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBiaXRtYXNrIFRoZSBiaXRtYXNrIGZsYWdzLiBTZWUgYGJhc2VJc0VxdWFsYCBmb3IgbW9yZSBkZXRhaWxzLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGN1c3RvbWl6ZXIgVGhlIGZ1bmN0aW9uIHRvIGN1c3RvbWl6ZSBjb21wYXJpc29ucy5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBlcXVhbEZ1bmMgVGhlIGZ1bmN0aW9uIHRvIGRldGVybWluZSBlcXVpdmFsZW50cyBvZiB2YWx1ZXMuXG4gICAgICogQHBhcmFtIHtPYmplY3R9IHN0YWNrIFRyYWNrcyB0cmF2ZXJzZWQgYG9iamVjdGAgYW5kIGBvdGhlcmAgb2JqZWN0cy5cbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIG9iamVjdHMgYXJlIGVxdWl2YWxlbnQsIGVsc2UgYGZhbHNlYC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBlcXVhbE9iamVjdHMob2JqZWN0LCBvdGhlciwgYml0bWFzaywgY3VzdG9taXplciwgZXF1YWxGdW5jLCBzdGFjaykge1xuICAgICAgdmFyIGlzUGFydGlhbCA9IGJpdG1hc2sgJiBDT01QQVJFX1BBUlRJQUxfRkxBRyxcbiAgICAgICAgICBvYmpQcm9wcyA9IGdldEFsbEtleXMob2JqZWN0KSxcbiAgICAgICAgICBvYmpMZW5ndGggPSBvYmpQcm9wcy5sZW5ndGgsXG4gICAgICAgICAgb3RoUHJvcHMgPSBnZXRBbGxLZXlzKG90aGVyKSxcbiAgICAgICAgICBvdGhMZW5ndGggPSBvdGhQcm9wcy5sZW5ndGg7XG5cbiAgICAgIGlmIChvYmpMZW5ndGggIT0gb3RoTGVuZ3RoICYmICFpc1BhcnRpYWwpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgdmFyIGluZGV4ID0gb2JqTGVuZ3RoO1xuICAgICAgd2hpbGUgKGluZGV4LS0pIHtcbiAgICAgICAgdmFyIGtleSA9IG9ialByb3BzW2luZGV4XTtcbiAgICAgICAgaWYgKCEoaXNQYXJ0aWFsID8ga2V5IGluIG90aGVyIDogaGFzT3duUHJvcGVydHkuY2FsbChvdGhlciwga2V5KSkpIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIC8vIEFzc3VtZSBjeWNsaWMgdmFsdWVzIGFyZSBlcXVhbC5cbiAgICAgIHZhciBzdGFja2VkID0gc3RhY2suZ2V0KG9iamVjdCk7XG4gICAgICBpZiAoc3RhY2tlZCAmJiBzdGFjay5nZXQob3RoZXIpKSB7XG4gICAgICAgIHJldHVybiBzdGFja2VkID09IG90aGVyO1xuICAgICAgfVxuICAgICAgdmFyIHJlc3VsdCA9IHRydWU7XG4gICAgICBzdGFjay5zZXQob2JqZWN0LCBvdGhlcik7XG4gICAgICBzdGFjay5zZXQob3RoZXIsIG9iamVjdCk7XG5cbiAgICAgIHZhciBza2lwQ3RvciA9IGlzUGFydGlhbDtcbiAgICAgIHdoaWxlICgrK2luZGV4IDwgb2JqTGVuZ3RoKSB7XG4gICAgICAgIGtleSA9IG9ialByb3BzW2luZGV4XTtcbiAgICAgICAgdmFyIG9ialZhbHVlID0gb2JqZWN0W2tleV0sXG4gICAgICAgICAgICBvdGhWYWx1ZSA9IG90aGVyW2tleV07XG5cbiAgICAgICAgaWYgKGN1c3RvbWl6ZXIpIHtcbiAgICAgICAgICB2YXIgY29tcGFyZWQgPSBpc1BhcnRpYWxcbiAgICAgICAgICAgID8gY3VzdG9taXplcihvdGhWYWx1ZSwgb2JqVmFsdWUsIGtleSwgb3RoZXIsIG9iamVjdCwgc3RhY2spXG4gICAgICAgICAgICA6IGN1c3RvbWl6ZXIob2JqVmFsdWUsIG90aFZhbHVlLCBrZXksIG9iamVjdCwgb3RoZXIsIHN0YWNrKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBSZWN1cnNpdmVseSBjb21wYXJlIG9iamVjdHMgKHN1c2NlcHRpYmxlIHRvIGNhbGwgc3RhY2sgbGltaXRzKS5cbiAgICAgICAgaWYgKCEoY29tcGFyZWQgPT09IHVuZGVmaW5lZFxuICAgICAgICAgICAgICA/IChvYmpWYWx1ZSA9PT0gb3RoVmFsdWUgfHwgZXF1YWxGdW5jKG9ialZhbHVlLCBvdGhWYWx1ZSwgYml0bWFzaywgY3VzdG9taXplciwgc3RhY2spKVxuICAgICAgICAgICAgICA6IGNvbXBhcmVkXG4gICAgICAgICAgICApKSB7XG4gICAgICAgICAgcmVzdWx0ID0gZmFsc2U7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgc2tpcEN0b3IgfHwgKHNraXBDdG9yID0ga2V5ID09ICdjb25zdHJ1Y3RvcicpO1xuICAgICAgfVxuICAgICAgaWYgKHJlc3VsdCAmJiAhc2tpcEN0b3IpIHtcbiAgICAgICAgdmFyIG9iakN0b3IgPSBvYmplY3QuY29uc3RydWN0b3IsXG4gICAgICAgICAgICBvdGhDdG9yID0gb3RoZXIuY29uc3RydWN0b3I7XG5cbiAgICAgICAgLy8gTm9uIGBPYmplY3RgIG9iamVjdCBpbnN0YW5jZXMgd2l0aCBkaWZmZXJlbnQgY29uc3RydWN0b3JzIGFyZSBub3QgZXF1YWwuXG4gICAgICAgIGlmIChvYmpDdG9yICE9IG90aEN0b3IgJiZcbiAgICAgICAgICAgICgnY29uc3RydWN0b3InIGluIG9iamVjdCAmJiAnY29uc3RydWN0b3InIGluIG90aGVyKSAmJlxuICAgICAgICAgICAgISh0eXBlb2Ygb2JqQ3RvciA9PSAnZnVuY3Rpb24nICYmIG9iakN0b3IgaW5zdGFuY2VvZiBvYmpDdG9yICYmXG4gICAgICAgICAgICAgIHR5cGVvZiBvdGhDdG9yID09ICdmdW5jdGlvbicgJiYgb3RoQ3RvciBpbnN0YW5jZW9mIG90aEN0b3IpKSB7XG4gICAgICAgICAgcmVzdWx0ID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHN0YWNrWydkZWxldGUnXShvYmplY3QpO1xuICAgICAgc3RhY2tbJ2RlbGV0ZSddKG90aGVyKTtcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQSBzcGVjaWFsaXplZCB2ZXJzaW9uIG9mIGBiYXNlUmVzdGAgd2hpY2ggZmxhdHRlbnMgdGhlIHJlc3QgYXJyYXkuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZ1bmMgVGhlIGZ1bmN0aW9uIHRvIGFwcGx5IGEgcmVzdCBwYXJhbWV0ZXIgdG8uXG4gICAgICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIHRoZSBuZXcgZnVuY3Rpb24uXG4gICAgICovXG4gICAgZnVuY3Rpb24gZmxhdFJlc3QoZnVuYykge1xuICAgICAgcmV0dXJuIHNldFRvU3RyaW5nKG92ZXJSZXN0KGZ1bmMsIHVuZGVmaW5lZCwgZmxhdHRlbiksIGZ1bmMgKyAnJyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbiBhcnJheSBvZiBvd24gZW51bWVyYWJsZSBwcm9wZXJ0eSBuYW1lcyBhbmQgc3ltYm9scyBvZiBgb2JqZWN0YC5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgb2JqZWN0IHRvIHF1ZXJ5LlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgYXJyYXkgb2YgcHJvcGVydHkgbmFtZXMgYW5kIHN5bWJvbHMuXG4gICAgICovXG4gICAgZnVuY3Rpb24gZ2V0QWxsS2V5cyhvYmplY3QpIHtcbiAgICAgIHJldHVybiBiYXNlR2V0QWxsS2V5cyhvYmplY3QsIGtleXMsIGdldFN5bWJvbHMpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW4gYXJyYXkgb2Ygb3duIGFuZCBpbmhlcml0ZWQgZW51bWVyYWJsZSBwcm9wZXJ0eSBuYW1lcyBhbmRcbiAgICAgKiBzeW1ib2xzIG9mIGBvYmplY3RgLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8gcXVlcnkuXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIHRoZSBhcnJheSBvZiBwcm9wZXJ0eSBuYW1lcyBhbmQgc3ltYm9scy5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBnZXRBbGxLZXlzSW4ob2JqZWN0KSB7XG4gICAgICByZXR1cm4gYmFzZUdldEFsbEtleXMob2JqZWN0LCBrZXlzSW4sIGdldFN5bWJvbHNJbik7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0cyBtZXRhZGF0YSBmb3IgYGZ1bmNgLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmdW5jIFRoZSBmdW5jdGlvbiB0byBxdWVyeS5cbiAgICAgKiBAcmV0dXJucyB7Kn0gUmV0dXJucyB0aGUgbWV0YWRhdGEgZm9yIGBmdW5jYC5cbiAgICAgKi9cbiAgICB2YXIgZ2V0RGF0YSA9ICFtZXRhTWFwID8gbm9vcCA6IGZ1bmN0aW9uKGZ1bmMpIHtcbiAgICAgIHJldHVybiBtZXRhTWFwLmdldChmdW5jKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgbmFtZSBvZiBgZnVuY2AuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZ1bmMgVGhlIGZ1bmN0aW9uIHRvIHF1ZXJ5LlxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IFJldHVybnMgdGhlIGZ1bmN0aW9uIG5hbWUuXG4gICAgICovXG4gICAgZnVuY3Rpb24gZ2V0RnVuY05hbWUoZnVuYykge1xuICAgICAgdmFyIHJlc3VsdCA9IChmdW5jLm5hbWUgKyAnJyksXG4gICAgICAgICAgYXJyYXkgPSByZWFsTmFtZXNbcmVzdWx0XSxcbiAgICAgICAgICBsZW5ndGggPSBoYXNPd25Qcm9wZXJ0eS5jYWxsKHJlYWxOYW1lcywgcmVzdWx0KSA/IGFycmF5Lmxlbmd0aCA6IDA7XG5cbiAgICAgIHdoaWxlIChsZW5ndGgtLSkge1xuICAgICAgICB2YXIgZGF0YSA9IGFycmF5W2xlbmd0aF0sXG4gICAgICAgICAgICBvdGhlckZ1bmMgPSBkYXRhLmZ1bmM7XG4gICAgICAgIGlmIChvdGhlckZ1bmMgPT0gbnVsbCB8fCBvdGhlckZ1bmMgPT0gZnVuYykge1xuICAgICAgICAgIHJldHVybiBkYXRhLm5hbWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgYXJndW1lbnQgcGxhY2Vob2xkZXIgdmFsdWUgZm9yIGBmdW5jYC5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZnVuYyBUaGUgZnVuY3Rpb24gdG8gaW5zcGVjdC5cbiAgICAgKiBAcmV0dXJucyB7Kn0gUmV0dXJucyB0aGUgcGxhY2Vob2xkZXIgdmFsdWUuXG4gICAgICovXG4gICAgZnVuY3Rpb24gZ2V0SG9sZGVyKGZ1bmMpIHtcbiAgICAgIHZhciBvYmplY3QgPSBoYXNPd25Qcm9wZXJ0eS5jYWxsKGxvZGFzaCwgJ3BsYWNlaG9sZGVyJykgPyBsb2Rhc2ggOiBmdW5jO1xuICAgICAgcmV0dXJuIG9iamVjdC5wbGFjZWhvbGRlcjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBhcHByb3ByaWF0ZSBcIml0ZXJhdGVlXCIgZnVuY3Rpb24uIElmIGBfLml0ZXJhdGVlYCBpcyBjdXN0b21pemVkLFxuICAgICAqIHRoaXMgZnVuY3Rpb24gcmV0dXJucyB0aGUgY3VzdG9tIG1ldGhvZCwgb3RoZXJ3aXNlIGl0IHJldHVybnMgYGJhc2VJdGVyYXRlZWAuXG4gICAgICogSWYgYXJndW1lbnRzIGFyZSBwcm92aWRlZCwgdGhlIGNob3NlbiBmdW5jdGlvbiBpcyBpbnZva2VkIHdpdGggdGhlbSBhbmRcbiAgICAgKiBpdHMgcmVzdWx0IGlzIHJldHVybmVkLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0geyp9IFt2YWx1ZV0gVGhlIHZhbHVlIHRvIGNvbnZlcnQgdG8gYW4gaXRlcmF0ZWUuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFthcml0eV0gVGhlIGFyaXR5IG9mIHRoZSBjcmVhdGVkIGl0ZXJhdGVlLlxuICAgICAqIEByZXR1cm5zIHtGdW5jdGlvbn0gUmV0dXJucyB0aGUgY2hvc2VuIGZ1bmN0aW9uIG9yIGl0cyByZXN1bHQuXG4gICAgICovXG4gICAgZnVuY3Rpb24gZ2V0SXRlcmF0ZWUoKSB7XG4gICAgICB2YXIgcmVzdWx0ID0gbG9kYXNoLml0ZXJhdGVlIHx8IGl0ZXJhdGVlO1xuICAgICAgcmVzdWx0ID0gcmVzdWx0ID09PSBpdGVyYXRlZSA/IGJhc2VJdGVyYXRlZSA6IHJlc3VsdDtcbiAgICAgIHJldHVybiBhcmd1bWVudHMubGVuZ3RoID8gcmVzdWx0KGFyZ3VtZW50c1swXSwgYXJndW1lbnRzWzFdKSA6IHJlc3VsdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBkYXRhIGZvciBgbWFwYC5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG1hcCBUaGUgbWFwIHRvIHF1ZXJ5LlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBrZXkgVGhlIHJlZmVyZW5jZSBrZXkuXG4gICAgICogQHJldHVybnMgeyp9IFJldHVybnMgdGhlIG1hcCBkYXRhLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGdldE1hcERhdGEobWFwLCBrZXkpIHtcbiAgICAgIHZhciBkYXRhID0gbWFwLl9fZGF0YV9fO1xuICAgICAgcmV0dXJuIGlzS2V5YWJsZShrZXkpXG4gICAgICAgID8gZGF0YVt0eXBlb2Yga2V5ID09ICdzdHJpbmcnID8gJ3N0cmluZycgOiAnaGFzaCddXG4gICAgICAgIDogZGF0YS5tYXA7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgcHJvcGVydHkgbmFtZXMsIHZhbHVlcywgYW5kIGNvbXBhcmUgZmxhZ3Mgb2YgYG9iamVjdGAuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIG9iamVjdCB0byBxdWVyeS5cbiAgICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgdGhlIG1hdGNoIGRhdGEgb2YgYG9iamVjdGAuXG4gICAgICovXG4gICAgZnVuY3Rpb24gZ2V0TWF0Y2hEYXRhKG9iamVjdCkge1xuICAgICAgdmFyIHJlc3VsdCA9IGtleXMob2JqZWN0KSxcbiAgICAgICAgICBsZW5ndGggPSByZXN1bHQubGVuZ3RoO1xuXG4gICAgICB3aGlsZSAobGVuZ3RoLS0pIHtcbiAgICAgICAgdmFyIGtleSA9IHJlc3VsdFtsZW5ndGhdLFxuICAgICAgICAgICAgdmFsdWUgPSBvYmplY3Rba2V5XTtcblxuICAgICAgICByZXN1bHRbbGVuZ3RoXSA9IFtrZXksIHZhbHVlLCBpc1N0cmljdENvbXBhcmFibGUodmFsdWUpXTtcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgbmF0aXZlIGZ1bmN0aW9uIGF0IGBrZXlgIG9mIGBvYmplY3RgLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8gcXVlcnkuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGtleSBUaGUga2V5IG9mIHRoZSBtZXRob2QgdG8gZ2V0LlxuICAgICAqIEByZXR1cm5zIHsqfSBSZXR1cm5zIHRoZSBmdW5jdGlvbiBpZiBpdCdzIG5hdGl2ZSwgZWxzZSBgdW5kZWZpbmVkYC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBnZXROYXRpdmUob2JqZWN0LCBrZXkpIHtcbiAgICAgIHZhciB2YWx1ZSA9IGdldFZhbHVlKG9iamVjdCwga2V5KTtcbiAgICAgIHJldHVybiBiYXNlSXNOYXRpdmUodmFsdWUpID8gdmFsdWUgOiB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQSBzcGVjaWFsaXplZCB2ZXJzaW9uIG9mIGBiYXNlR2V0VGFnYCB3aGljaCBpZ25vcmVzIGBTeW1ib2wudG9TdHJpbmdUYWdgIHZhbHVlcy5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gcXVlcnkuXG4gICAgICogQHJldHVybnMge3N0cmluZ30gUmV0dXJucyB0aGUgcmF3IGB0b1N0cmluZ1RhZ2AuXG4gICAgICovXG4gICAgZnVuY3Rpb24gZ2V0UmF3VGFnKHZhbHVlKSB7XG4gICAgICB2YXIgaXNPd24gPSBoYXNPd25Qcm9wZXJ0eS5jYWxsKHZhbHVlLCBzeW1Ub1N0cmluZ1RhZyksXG4gICAgICAgICAgdGFnID0gdmFsdWVbc3ltVG9TdHJpbmdUYWddO1xuXG4gICAgICB0cnkge1xuICAgICAgICB2YWx1ZVtzeW1Ub1N0cmluZ1RhZ10gPSB1bmRlZmluZWQ7XG4gICAgICAgIHZhciB1bm1hc2tlZCA9IHRydWU7XG4gICAgICB9IGNhdGNoIChlKSB7fVxuXG4gICAgICB2YXIgcmVzdWx0ID0gbmF0aXZlT2JqZWN0VG9TdHJpbmcuY2FsbCh2YWx1ZSk7XG4gICAgICBpZiAodW5tYXNrZWQpIHtcbiAgICAgICAgaWYgKGlzT3duKSB7XG4gICAgICAgICAgdmFsdWVbc3ltVG9TdHJpbmdUYWddID0gdGFnO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGRlbGV0ZSB2YWx1ZVtzeW1Ub1N0cmluZ1RhZ107XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbiBhcnJheSBvZiB0aGUgb3duIGVudW1lcmFibGUgc3ltYm9scyBvZiBgb2JqZWN0YC5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgb2JqZWN0IHRvIHF1ZXJ5LlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgYXJyYXkgb2Ygc3ltYm9scy5cbiAgICAgKi9cbiAgICB2YXIgZ2V0U3ltYm9scyA9ICFuYXRpdmVHZXRTeW1ib2xzID8gc3R1YkFycmF5IDogZnVuY3Rpb24ob2JqZWN0KSB7XG4gICAgICBpZiAob2JqZWN0ID09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgfVxuICAgICAgb2JqZWN0ID0gT2JqZWN0KG9iamVjdCk7XG4gICAgICByZXR1cm4gYXJyYXlGaWx0ZXIobmF0aXZlR2V0U3ltYm9scyhvYmplY3QpLCBmdW5jdGlvbihzeW1ib2wpIHtcbiAgICAgICAgcmV0dXJuIHByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwob2JqZWN0LCBzeW1ib2wpO1xuICAgICAgfSk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW4gYXJyYXkgb2YgdGhlIG93biBhbmQgaW5oZXJpdGVkIGVudW1lcmFibGUgc3ltYm9scyBvZiBgb2JqZWN0YC5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgb2JqZWN0IHRvIHF1ZXJ5LlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgYXJyYXkgb2Ygc3ltYm9scy5cbiAgICAgKi9cbiAgICB2YXIgZ2V0U3ltYm9sc0luID0gIW5hdGl2ZUdldFN5bWJvbHMgPyBzdHViQXJyYXkgOiBmdW5jdGlvbihvYmplY3QpIHtcbiAgICAgIHZhciByZXN1bHQgPSBbXTtcbiAgICAgIHdoaWxlIChvYmplY3QpIHtcbiAgICAgICAgYXJyYXlQdXNoKHJlc3VsdCwgZ2V0U3ltYm9scyhvYmplY3QpKTtcbiAgICAgICAgb2JqZWN0ID0gZ2V0UHJvdG90eXBlKG9iamVjdCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBgdG9TdHJpbmdUYWdgIG9mIGB2YWx1ZWAuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIHF1ZXJ5LlxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IFJldHVybnMgdGhlIGB0b1N0cmluZ1RhZ2AuXG4gICAgICovXG4gICAgdmFyIGdldFRhZyA9IGJhc2VHZXRUYWc7XG5cbiAgICAvLyBGYWxsYmFjayBmb3IgZGF0YSB2aWV3cywgbWFwcywgc2V0cywgYW5kIHdlYWsgbWFwcyBpbiBJRSAxMSBhbmQgcHJvbWlzZXMgaW4gTm9kZS5qcyA8IDYuXG4gICAgaWYgKChEYXRhVmlldyAmJiBnZXRUYWcobmV3IERhdGFWaWV3KG5ldyBBcnJheUJ1ZmZlcigxKSkpICE9IGRhdGFWaWV3VGFnKSB8fFxuICAgICAgICAoTWFwICYmIGdldFRhZyhuZXcgTWFwKSAhPSBtYXBUYWcpIHx8XG4gICAgICAgIChQcm9taXNlICYmIGdldFRhZyhQcm9taXNlLnJlc29sdmUoKSkgIT0gcHJvbWlzZVRhZykgfHxcbiAgICAgICAgKFNldCAmJiBnZXRUYWcobmV3IFNldCkgIT0gc2V0VGFnKSB8fFxuICAgICAgICAoV2Vha01hcCAmJiBnZXRUYWcobmV3IFdlYWtNYXApICE9IHdlYWtNYXBUYWcpKSB7XG4gICAgICBnZXRUYWcgPSBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICB2YXIgcmVzdWx0ID0gYmFzZUdldFRhZyh2YWx1ZSksXG4gICAgICAgICAgICBDdG9yID0gcmVzdWx0ID09IG9iamVjdFRhZyA/IHZhbHVlLmNvbnN0cnVjdG9yIDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgY3RvclN0cmluZyA9IEN0b3IgPyB0b1NvdXJjZShDdG9yKSA6ICcnO1xuXG4gICAgICAgIGlmIChjdG9yU3RyaW5nKSB7XG4gICAgICAgICAgc3dpdGNoIChjdG9yU3RyaW5nKSB7XG4gICAgICAgICAgICBjYXNlIGRhdGFWaWV3Q3RvclN0cmluZzogcmV0dXJuIGRhdGFWaWV3VGFnO1xuICAgICAgICAgICAgY2FzZSBtYXBDdG9yU3RyaW5nOiByZXR1cm4gbWFwVGFnO1xuICAgICAgICAgICAgY2FzZSBwcm9taXNlQ3RvclN0cmluZzogcmV0dXJuIHByb21pc2VUYWc7XG4gICAgICAgICAgICBjYXNlIHNldEN0b3JTdHJpbmc6IHJldHVybiBzZXRUYWc7XG4gICAgICAgICAgICBjYXNlIHdlYWtNYXBDdG9yU3RyaW5nOiByZXR1cm4gd2Vha01hcFRhZztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgdmlldywgYXBwbHlpbmcgYW55IGB0cmFuc2Zvcm1zYCB0byB0aGUgYHN0YXJ0YCBhbmQgYGVuZGAgcG9zaXRpb25zLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gc3RhcnQgVGhlIHN0YXJ0IG9mIHRoZSB2aWV3LlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBlbmQgVGhlIGVuZCBvZiB0aGUgdmlldy5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSB0cmFuc2Zvcm1zIFRoZSB0cmFuc2Zvcm1hdGlvbnMgdG8gYXBwbHkgdG8gdGhlIHZpZXcuXG4gICAgICogQHJldHVybnMge09iamVjdH0gUmV0dXJucyBhbiBvYmplY3QgY29udGFpbmluZyB0aGUgYHN0YXJ0YCBhbmQgYGVuZGBcbiAgICAgKiAgcG9zaXRpb25zIG9mIHRoZSB2aWV3LlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGdldFZpZXcoc3RhcnQsIGVuZCwgdHJhbnNmb3Jtcykge1xuICAgICAgdmFyIGluZGV4ID0gLTEsXG4gICAgICAgICAgbGVuZ3RoID0gdHJhbnNmb3Jtcy5sZW5ndGg7XG5cbiAgICAgIHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG4gICAgICAgIHZhciBkYXRhID0gdHJhbnNmb3Jtc1tpbmRleF0sXG4gICAgICAgICAgICBzaXplID0gZGF0YS5zaXplO1xuXG4gICAgICAgIHN3aXRjaCAoZGF0YS50eXBlKSB7XG4gICAgICAgICAgY2FzZSAnZHJvcCc6ICAgICAgc3RhcnQgKz0gc2l6ZTsgYnJlYWs7XG4gICAgICAgICAgY2FzZSAnZHJvcFJpZ2h0JzogZW5kIC09IHNpemU7IGJyZWFrO1xuICAgICAgICAgIGNhc2UgJ3Rha2UnOiAgICAgIGVuZCA9IG5hdGl2ZU1pbihlbmQsIHN0YXJ0ICsgc2l6ZSk7IGJyZWFrO1xuICAgICAgICAgIGNhc2UgJ3Rha2VSaWdodCc6IHN0YXJ0ID0gbmF0aXZlTWF4KHN0YXJ0LCBlbmQgLSBzaXplKTsgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiB7ICdzdGFydCc6IHN0YXJ0LCAnZW5kJzogZW5kIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXh0cmFjdHMgd3JhcHBlciBkZXRhaWxzIGZyb20gdGhlIGBzb3VyY2VgIGJvZHkgY29tbWVudC5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHNvdXJjZSBUaGUgc291cmNlIHRvIGluc3BlY3QuXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIHRoZSB3cmFwcGVyIGRldGFpbHMuXG4gICAgICovXG4gICAgZnVuY3Rpb24gZ2V0V3JhcERldGFpbHMoc291cmNlKSB7XG4gICAgICB2YXIgbWF0Y2ggPSBzb3VyY2UubWF0Y2gocmVXcmFwRGV0YWlscyk7XG4gICAgICByZXR1cm4gbWF0Y2ggPyBtYXRjaFsxXS5zcGxpdChyZVNwbGl0RGV0YWlscykgOiBbXTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVja3MgaWYgYHBhdGhgIGV4aXN0cyBvbiBgb2JqZWN0YC5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgb2JqZWN0IHRvIHF1ZXJ5LlxuICAgICAqIEBwYXJhbSB7QXJyYXl8c3RyaW5nfSBwYXRoIFRoZSBwYXRoIHRvIGNoZWNrLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGhhc0Z1bmMgVGhlIGZ1bmN0aW9uIHRvIGNoZWNrIHByb3BlcnRpZXMuXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGBwYXRoYCBleGlzdHMsIGVsc2UgYGZhbHNlYC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBoYXNQYXRoKG9iamVjdCwgcGF0aCwgaGFzRnVuYykge1xuICAgICAgcGF0aCA9IGNhc3RQYXRoKHBhdGgsIG9iamVjdCk7XG5cbiAgICAgIHZhciBpbmRleCA9IC0xLFxuICAgICAgICAgIGxlbmd0aCA9IHBhdGgubGVuZ3RoLFxuICAgICAgICAgIHJlc3VsdCA9IGZhbHNlO1xuXG4gICAgICB3aGlsZSAoKytpbmRleCA8IGxlbmd0aCkge1xuICAgICAgICB2YXIga2V5ID0gdG9LZXkocGF0aFtpbmRleF0pO1xuICAgICAgICBpZiAoIShyZXN1bHQgPSBvYmplY3QgIT0gbnVsbCAmJiBoYXNGdW5jKG9iamVjdCwga2V5KSkpIHtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBvYmplY3QgPSBvYmplY3Rba2V5XTtcbiAgICAgIH1cbiAgICAgIGlmIChyZXN1bHQgfHwgKytpbmRleCAhPSBsZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgIH1cbiAgICAgIGxlbmd0aCA9IG9iamVjdCA9PSBudWxsID8gMCA6IG9iamVjdC5sZW5ndGg7XG4gICAgICByZXR1cm4gISFsZW5ndGggJiYgaXNMZW5ndGgobGVuZ3RoKSAmJiBpc0luZGV4KGtleSwgbGVuZ3RoKSAmJlxuICAgICAgICAoaXNBcnJheShvYmplY3QpIHx8IGlzQXJndW1lbnRzKG9iamVjdCkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEluaXRpYWxpemVzIGFuIGFycmF5IGNsb25lLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBhcnJheSBUaGUgYXJyYXkgdG8gY2xvbmUuXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIHRoZSBpbml0aWFsaXplZCBjbG9uZS5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBpbml0Q2xvbmVBcnJheShhcnJheSkge1xuICAgICAgdmFyIGxlbmd0aCA9IGFycmF5Lmxlbmd0aCxcbiAgICAgICAgICByZXN1bHQgPSBuZXcgYXJyYXkuY29uc3RydWN0b3IobGVuZ3RoKTtcblxuICAgICAgLy8gQWRkIHByb3BlcnRpZXMgYXNzaWduZWQgYnkgYFJlZ0V4cCNleGVjYC5cbiAgICAgIGlmIChsZW5ndGggJiYgdHlwZW9mIGFycmF5WzBdID09ICdzdHJpbmcnICYmIGhhc093blByb3BlcnR5LmNhbGwoYXJyYXksICdpbmRleCcpKSB7XG4gICAgICAgIHJlc3VsdC5pbmRleCA9IGFycmF5LmluZGV4O1xuICAgICAgICByZXN1bHQuaW5wdXQgPSBhcnJheS5pbnB1dDtcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSW5pdGlhbGl6ZXMgYW4gb2JqZWN0IGNsb25lLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8gY2xvbmUuXG4gICAgICogQHJldHVybnMge09iamVjdH0gUmV0dXJucyB0aGUgaW5pdGlhbGl6ZWQgY2xvbmUuXG4gICAgICovXG4gICAgZnVuY3Rpb24gaW5pdENsb25lT2JqZWN0KG9iamVjdCkge1xuICAgICAgcmV0dXJuICh0eXBlb2Ygb2JqZWN0LmNvbnN0cnVjdG9yID09ICdmdW5jdGlvbicgJiYgIWlzUHJvdG90eXBlKG9iamVjdCkpXG4gICAgICAgID8gYmFzZUNyZWF0ZShnZXRQcm90b3R5cGUob2JqZWN0KSlcbiAgICAgICAgOiB7fTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBJbml0aWFsaXplcyBhbiBvYmplY3QgY2xvbmUgYmFzZWQgb24gaXRzIGB0b1N0cmluZ1RhZ2AuXG4gICAgICpcbiAgICAgKiAqKk5vdGU6KiogVGhpcyBmdW5jdGlvbiBvbmx5IHN1cHBvcnRzIGNsb25pbmcgdmFsdWVzIHdpdGggdGFncyBvZlxuICAgICAqIGBCb29sZWFuYCwgYERhdGVgLCBgRXJyb3JgLCBgTWFwYCwgYE51bWJlcmAsIGBSZWdFeHBgLCBgU2V0YCwgb3IgYFN0cmluZ2AuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIG9iamVjdCB0byBjbG9uZS5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdGFnIFRoZSBgdG9TdHJpbmdUYWdgIG9mIHRoZSBvYmplY3QgdG8gY2xvbmUuXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbaXNEZWVwXSBTcGVjaWZ5IGEgZGVlcCBjbG9uZS5cbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIHRoZSBpbml0aWFsaXplZCBjbG9uZS5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBpbml0Q2xvbmVCeVRhZyhvYmplY3QsIHRhZywgaXNEZWVwKSB7XG4gICAgICB2YXIgQ3RvciA9IG9iamVjdC5jb25zdHJ1Y3RvcjtcbiAgICAgIHN3aXRjaCAodGFnKSB7XG4gICAgICAgIGNhc2UgYXJyYXlCdWZmZXJUYWc6XG4gICAgICAgICAgcmV0dXJuIGNsb25lQXJyYXlCdWZmZXIob2JqZWN0KTtcblxuICAgICAgICBjYXNlIGJvb2xUYWc6XG4gICAgICAgIGNhc2UgZGF0ZVRhZzpcbiAgICAgICAgICByZXR1cm4gbmV3IEN0b3IoK29iamVjdCk7XG5cbiAgICAgICAgY2FzZSBkYXRhVmlld1RhZzpcbiAgICAgICAgICByZXR1cm4gY2xvbmVEYXRhVmlldyhvYmplY3QsIGlzRGVlcCk7XG5cbiAgICAgICAgY2FzZSBmbG9hdDMyVGFnOiBjYXNlIGZsb2F0NjRUYWc6XG4gICAgICAgIGNhc2UgaW50OFRhZzogY2FzZSBpbnQxNlRhZzogY2FzZSBpbnQzMlRhZzpcbiAgICAgICAgY2FzZSB1aW50OFRhZzogY2FzZSB1aW50OENsYW1wZWRUYWc6IGNhc2UgdWludDE2VGFnOiBjYXNlIHVpbnQzMlRhZzpcbiAgICAgICAgICByZXR1cm4gY2xvbmVUeXBlZEFycmF5KG9iamVjdCwgaXNEZWVwKTtcblxuICAgICAgICBjYXNlIG1hcFRhZzpcbiAgICAgICAgICByZXR1cm4gbmV3IEN0b3I7XG5cbiAgICAgICAgY2FzZSBudW1iZXJUYWc6XG4gICAgICAgIGNhc2Ugc3RyaW5nVGFnOlxuICAgICAgICAgIHJldHVybiBuZXcgQ3RvcihvYmplY3QpO1xuXG4gICAgICAgIGNhc2UgcmVnZXhwVGFnOlxuICAgICAgICAgIHJldHVybiBjbG9uZVJlZ0V4cChvYmplY3QpO1xuXG4gICAgICAgIGNhc2Ugc2V0VGFnOlxuICAgICAgICAgIHJldHVybiBuZXcgQ3RvcjtcblxuICAgICAgICBjYXNlIHN5bWJvbFRhZzpcbiAgICAgICAgICByZXR1cm4gY2xvbmVTeW1ib2wob2JqZWN0KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBJbnNlcnRzIHdyYXBwZXIgYGRldGFpbHNgIGluIGEgY29tbWVudCBhdCB0aGUgdG9wIG9mIHRoZSBgc291cmNlYCBib2R5LlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gc291cmNlIFRoZSBzb3VyY2UgdG8gbW9kaWZ5LlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gZGV0YWlscyBUaGUgZGV0YWlscyB0byBpbnNlcnQuXG4gICAgICogQHJldHVybnMge3N0cmluZ30gUmV0dXJucyB0aGUgbW9kaWZpZWQgc291cmNlLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGluc2VydFdyYXBEZXRhaWxzKHNvdXJjZSwgZGV0YWlscykge1xuICAgICAgdmFyIGxlbmd0aCA9IGRldGFpbHMubGVuZ3RoO1xuICAgICAgaWYgKCFsZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIHNvdXJjZTtcbiAgICAgIH1cbiAgICAgIHZhciBsYXN0SW5kZXggPSBsZW5ndGggLSAxO1xuICAgICAgZGV0YWlsc1tsYXN0SW5kZXhdID0gKGxlbmd0aCA+IDEgPyAnJiAnIDogJycpICsgZGV0YWlsc1tsYXN0SW5kZXhdO1xuICAgICAgZGV0YWlscyA9IGRldGFpbHMuam9pbihsZW5ndGggPiAyID8gJywgJyA6ICcgJyk7XG4gICAgICByZXR1cm4gc291cmNlLnJlcGxhY2UocmVXcmFwQ29tbWVudCwgJ3tcXG4vKiBbd3JhcHBlZCB3aXRoICcgKyBkZXRhaWxzICsgJ10gKi9cXG4nKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVja3MgaWYgYHZhbHVlYCBpcyBhIGZsYXR0ZW5hYmxlIGBhcmd1bWVudHNgIG9iamVjdCBvciBhcnJheS5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2hlY2suXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGB2YWx1ZWAgaXMgZmxhdHRlbmFibGUsIGVsc2UgYGZhbHNlYC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBpc0ZsYXR0ZW5hYmxlKHZhbHVlKSB7XG4gICAgICByZXR1cm4gaXNBcnJheSh2YWx1ZSkgfHwgaXNBcmd1bWVudHModmFsdWUpIHx8XG4gICAgICAgICEhKHNwcmVhZGFibGVTeW1ib2wgJiYgdmFsdWUgJiYgdmFsdWVbc3ByZWFkYWJsZVN5bWJvbF0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrcyBpZiBgdmFsdWVgIGlzIGEgdmFsaWQgYXJyYXktbGlrZSBpbmRleC5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2hlY2suXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtsZW5ndGg9TUFYX1NBRkVfSU5URUdFUl0gVGhlIHVwcGVyIGJvdW5kcyBvZiBhIHZhbGlkIGluZGV4LlxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBgdmFsdWVgIGlzIGEgdmFsaWQgaW5kZXgsIGVsc2UgYGZhbHNlYC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBpc0luZGV4KHZhbHVlLCBsZW5ndGgpIHtcbiAgICAgIHZhciB0eXBlID0gdHlwZW9mIHZhbHVlO1xuICAgICAgbGVuZ3RoID0gbGVuZ3RoID09IG51bGwgPyBNQVhfU0FGRV9JTlRFR0VSIDogbGVuZ3RoO1xuXG4gICAgICByZXR1cm4gISFsZW5ndGggJiZcbiAgICAgICAgKHR5cGUgPT0gJ251bWJlcicgfHxcbiAgICAgICAgICAodHlwZSAhPSAnc3ltYm9sJyAmJiByZUlzVWludC50ZXN0KHZhbHVlKSkpICYmXG4gICAgICAgICAgICAodmFsdWUgPiAtMSAmJiB2YWx1ZSAlIDEgPT0gMCAmJiB2YWx1ZSA8IGxlbmd0aCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2tzIGlmIHRoZSBnaXZlbiBhcmd1bWVudHMgYXJlIGZyb20gYW4gaXRlcmF0ZWUgY2FsbC5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgcG90ZW50aWFsIGl0ZXJhdGVlIHZhbHVlIGFyZ3VtZW50LlxuICAgICAqIEBwYXJhbSB7Kn0gaW5kZXggVGhlIHBvdGVudGlhbCBpdGVyYXRlZSBpbmRleCBvciBrZXkgYXJndW1lbnQuXG4gICAgICogQHBhcmFtIHsqfSBvYmplY3QgVGhlIHBvdGVudGlhbCBpdGVyYXRlZSBvYmplY3QgYXJndW1lbnQuXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIHRoZSBhcmd1bWVudHMgYXJlIGZyb20gYW4gaXRlcmF0ZWUgY2FsbCxcbiAgICAgKiAgZWxzZSBgZmFsc2VgLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGlzSXRlcmF0ZWVDYWxsKHZhbHVlLCBpbmRleCwgb2JqZWN0KSB7XG4gICAgICBpZiAoIWlzT2JqZWN0KG9iamVjdCkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgdmFyIHR5cGUgPSB0eXBlb2YgaW5kZXg7XG4gICAgICBpZiAodHlwZSA9PSAnbnVtYmVyJ1xuICAgICAgICAgICAgPyAoaXNBcnJheUxpa2Uob2JqZWN0KSAmJiBpc0luZGV4KGluZGV4LCBvYmplY3QubGVuZ3RoKSlcbiAgICAgICAgICAgIDogKHR5cGUgPT0gJ3N0cmluZycgJiYgaW5kZXggaW4gb2JqZWN0KVxuICAgICAgICAgICkge1xuICAgICAgICByZXR1cm4gZXEob2JqZWN0W2luZGV4XSwgdmFsdWUpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrcyBpZiBgdmFsdWVgIGlzIGEgcHJvcGVydHkgbmFtZSBhbmQgbm90IGEgcHJvcGVydHkgcGF0aC5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2hlY2suXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtvYmplY3RdIFRoZSBvYmplY3QgdG8gcXVlcnkga2V5cyBvbi5cbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYHZhbHVlYCBpcyBhIHByb3BlcnR5IG5hbWUsIGVsc2UgYGZhbHNlYC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBpc0tleSh2YWx1ZSwgb2JqZWN0KSB7XG4gICAgICBpZiAoaXNBcnJheSh2YWx1ZSkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgdmFyIHR5cGUgPSB0eXBlb2YgdmFsdWU7XG4gICAgICBpZiAodHlwZSA9PSAnbnVtYmVyJyB8fCB0eXBlID09ICdzeW1ib2wnIHx8IHR5cGUgPT0gJ2Jvb2xlYW4nIHx8XG4gICAgICAgICAgdmFsdWUgPT0gbnVsbCB8fCBpc1N5bWJvbCh2YWx1ZSkpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG4gICAgICByZXR1cm4gcmVJc1BsYWluUHJvcC50ZXN0KHZhbHVlKSB8fCAhcmVJc0RlZXBQcm9wLnRlc3QodmFsdWUpIHx8XG4gICAgICAgIChvYmplY3QgIT0gbnVsbCAmJiB2YWx1ZSBpbiBPYmplY3Qob2JqZWN0KSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2tzIGlmIGB2YWx1ZWAgaXMgc3VpdGFibGUgZm9yIHVzZSBhcyB1bmlxdWUgb2JqZWN0IGtleS5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2hlY2suXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGB2YWx1ZWAgaXMgc3VpdGFibGUsIGVsc2UgYGZhbHNlYC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBpc0tleWFibGUodmFsdWUpIHtcbiAgICAgIHZhciB0eXBlID0gdHlwZW9mIHZhbHVlO1xuICAgICAgcmV0dXJuICh0eXBlID09ICdzdHJpbmcnIHx8IHR5cGUgPT0gJ251bWJlcicgfHwgdHlwZSA9PSAnc3ltYm9sJyB8fCB0eXBlID09ICdib29sZWFuJylcbiAgICAgICAgPyAodmFsdWUgIT09ICdfX3Byb3RvX18nKVxuICAgICAgICA6ICh2YWx1ZSA9PT0gbnVsbCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2tzIGlmIGBmdW5jYCBoYXMgYSBsYXp5IGNvdW50ZXJwYXJ0LlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmdW5jIFRoZSBmdW5jdGlvbiB0byBjaGVjay5cbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYGZ1bmNgIGhhcyBhIGxhenkgY291bnRlcnBhcnQsXG4gICAgICogIGVsc2UgYGZhbHNlYC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBpc0xhemlhYmxlKGZ1bmMpIHtcbiAgICAgIHZhciBmdW5jTmFtZSA9IGdldEZ1bmNOYW1lKGZ1bmMpLFxuICAgICAgICAgIG90aGVyID0gbG9kYXNoW2Z1bmNOYW1lXTtcblxuICAgICAgaWYgKHR5cGVvZiBvdGhlciAhPSAnZnVuY3Rpb24nIHx8ICEoZnVuY05hbWUgaW4gTGF6eVdyYXBwZXIucHJvdG90eXBlKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICBpZiAoZnVuYyA9PT0gb3RoZXIpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG4gICAgICB2YXIgZGF0YSA9IGdldERhdGEob3RoZXIpO1xuICAgICAgcmV0dXJuICEhZGF0YSAmJiBmdW5jID09PSBkYXRhWzBdO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrcyBpZiBgZnVuY2AgaGFzIGl0cyBzb3VyY2UgbWFza2VkLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmdW5jIFRoZSBmdW5jdGlvbiB0byBjaGVjay5cbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYGZ1bmNgIGlzIG1hc2tlZCwgZWxzZSBgZmFsc2VgLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGlzTWFza2VkKGZ1bmMpIHtcbiAgICAgIHJldHVybiAhIW1hc2tTcmNLZXkgJiYgKG1hc2tTcmNLZXkgaW4gZnVuYyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2tzIGlmIGBmdW5jYCBpcyBjYXBhYmxlIG9mIGJlaW5nIG1hc2tlZC5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2hlY2suXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGBmdW5jYCBpcyBtYXNrYWJsZSwgZWxzZSBgZmFsc2VgLlxuICAgICAqL1xuICAgIHZhciBpc01hc2thYmxlID0gY29yZUpzRGF0YSA/IGlzRnVuY3Rpb24gOiBzdHViRmFsc2U7XG5cbiAgICAvKipcbiAgICAgKiBDaGVja3MgaWYgYHZhbHVlYCBpcyBsaWtlbHkgYSBwcm90b3R5cGUgb2JqZWN0LlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjaGVjay5cbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYHZhbHVlYCBpcyBhIHByb3RvdHlwZSwgZWxzZSBgZmFsc2VgLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGlzUHJvdG90eXBlKHZhbHVlKSB7XG4gICAgICB2YXIgQ3RvciA9IHZhbHVlICYmIHZhbHVlLmNvbnN0cnVjdG9yLFxuICAgICAgICAgIHByb3RvID0gKHR5cGVvZiBDdG9yID09ICdmdW5jdGlvbicgJiYgQ3Rvci5wcm90b3R5cGUpIHx8IG9iamVjdFByb3RvO1xuXG4gICAgICByZXR1cm4gdmFsdWUgPT09IHByb3RvO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrcyBpZiBgdmFsdWVgIGlzIHN1aXRhYmxlIGZvciBzdHJpY3QgZXF1YWxpdHkgY29tcGFyaXNvbnMsIGkuZS4gYD09PWAuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNoZWNrLlxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBgdmFsdWVgIGlmIHN1aXRhYmxlIGZvciBzdHJpY3RcbiAgICAgKiAgZXF1YWxpdHkgY29tcGFyaXNvbnMsIGVsc2UgYGZhbHNlYC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBpc1N0cmljdENvbXBhcmFibGUodmFsdWUpIHtcbiAgICAgIHJldHVybiB2YWx1ZSA9PT0gdmFsdWUgJiYgIWlzT2JqZWN0KHZhbHVlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBIHNwZWNpYWxpemVkIHZlcnNpb24gb2YgYG1hdGNoZXNQcm9wZXJ0eWAgZm9yIHNvdXJjZSB2YWx1ZXMgc3VpdGFibGVcbiAgICAgKiBmb3Igc3RyaWN0IGVxdWFsaXR5IGNvbXBhcmlzb25zLCBpLmUuIGA9PT1gLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30ga2V5IFRoZSBrZXkgb2YgdGhlIHByb3BlcnR5IHRvIGdldC5cbiAgICAgKiBAcGFyYW0geyp9IHNyY1ZhbHVlIFRoZSB2YWx1ZSB0byBtYXRjaC5cbiAgICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgdGhlIG5ldyBzcGVjIGZ1bmN0aW9uLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIG1hdGNoZXNTdHJpY3RDb21wYXJhYmxlKGtleSwgc3JjVmFsdWUpIHtcbiAgICAgIHJldHVybiBmdW5jdGlvbihvYmplY3QpIHtcbiAgICAgICAgaWYgKG9iamVjdCA9PSBudWxsKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvYmplY3Rba2V5XSA9PT0gc3JjVmFsdWUgJiZcbiAgICAgICAgICAoc3JjVmFsdWUgIT09IHVuZGVmaW5lZCB8fCAoa2V5IGluIE9iamVjdChvYmplY3QpKSk7XG4gICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEEgc3BlY2lhbGl6ZWQgdmVyc2lvbiBvZiBgXy5tZW1vaXplYCB3aGljaCBjbGVhcnMgdGhlIG1lbW9pemVkIGZ1bmN0aW9uJ3NcbiAgICAgKiBjYWNoZSB3aGVuIGl0IGV4Y2VlZHMgYE1BWF9NRU1PSVpFX1NJWkVgLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmdW5jIFRoZSBmdW5jdGlvbiB0byBoYXZlIGl0cyBvdXRwdXQgbWVtb2l6ZWQuXG4gICAgICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIHRoZSBuZXcgbWVtb2l6ZWQgZnVuY3Rpb24uXG4gICAgICovXG4gICAgZnVuY3Rpb24gbWVtb2l6ZUNhcHBlZChmdW5jKSB7XG4gICAgICB2YXIgcmVzdWx0ID0gbWVtb2l6ZShmdW5jLCBmdW5jdGlvbihrZXkpIHtcbiAgICAgICAgaWYgKGNhY2hlLnNpemUgPT09IE1BWF9NRU1PSVpFX1NJWkUpIHtcbiAgICAgICAgICBjYWNoZS5jbGVhcigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBrZXk7XG4gICAgICB9KTtcblxuICAgICAgdmFyIGNhY2hlID0gcmVzdWx0LmNhY2hlO1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBNZXJnZXMgdGhlIGZ1bmN0aW9uIG1ldGFkYXRhIG9mIGBzb3VyY2VgIGludG8gYGRhdGFgLlxuICAgICAqXG4gICAgICogTWVyZ2luZyBtZXRhZGF0YSByZWR1Y2VzIHRoZSBudW1iZXIgb2Ygd3JhcHBlcnMgdXNlZCB0byBpbnZva2UgYSBmdW5jdGlvbi5cbiAgICAgKiBUaGlzIGlzIHBvc3NpYmxlIGJlY2F1c2UgbWV0aG9kcyBsaWtlIGBfLmJpbmRgLCBgXy5jdXJyeWAsIGFuZCBgXy5wYXJ0aWFsYFxuICAgICAqIG1heSBiZSBhcHBsaWVkIHJlZ2FyZGxlc3Mgb2YgZXhlY3V0aW9uIG9yZGVyLiBNZXRob2RzIGxpa2UgYF8uYXJ5YCBhbmRcbiAgICAgKiBgXy5yZWFyZ2AgbW9kaWZ5IGZ1bmN0aW9uIGFyZ3VtZW50cywgbWFraW5nIHRoZSBvcmRlciBpbiB3aGljaCB0aGV5IGFyZVxuICAgICAqIGV4ZWN1dGVkIGltcG9ydGFudCwgcHJldmVudGluZyB0aGUgbWVyZ2luZyBvZiBtZXRhZGF0YS4gSG93ZXZlciwgd2UgbWFrZVxuICAgICAqIGFuIGV4Y2VwdGlvbiBmb3IgYSBzYWZlIGNvbWJpbmVkIGNhc2Ugd2hlcmUgY3VycmllZCBmdW5jdGlvbnMgaGF2ZSBgXy5hcnlgXG4gICAgICogYW5kIG9yIGBfLnJlYXJnYCBhcHBsaWVkLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBkYXRhIFRoZSBkZXN0aW5hdGlvbiBtZXRhZGF0YS5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBzb3VyY2UgVGhlIHNvdXJjZSBtZXRhZGF0YS5cbiAgICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgYGRhdGFgLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIG1lcmdlRGF0YShkYXRhLCBzb3VyY2UpIHtcbiAgICAgIHZhciBiaXRtYXNrID0gZGF0YVsxXSxcbiAgICAgICAgICBzcmNCaXRtYXNrID0gc291cmNlWzFdLFxuICAgICAgICAgIG5ld0JpdG1hc2sgPSBiaXRtYXNrIHwgc3JjQml0bWFzayxcbiAgICAgICAgICBpc0NvbW1vbiA9IG5ld0JpdG1hc2sgPCAoV1JBUF9CSU5EX0ZMQUcgfCBXUkFQX0JJTkRfS0VZX0ZMQUcgfCBXUkFQX0FSWV9GTEFHKTtcblxuICAgICAgdmFyIGlzQ29tYm8gPVxuICAgICAgICAoKHNyY0JpdG1hc2sgPT0gV1JBUF9BUllfRkxBRykgJiYgKGJpdG1hc2sgPT0gV1JBUF9DVVJSWV9GTEFHKSkgfHxcbiAgICAgICAgKChzcmNCaXRtYXNrID09IFdSQVBfQVJZX0ZMQUcpICYmIChiaXRtYXNrID09IFdSQVBfUkVBUkdfRkxBRykgJiYgKGRhdGFbN10ubGVuZ3RoIDw9IHNvdXJjZVs4XSkpIHx8XG4gICAgICAgICgoc3JjQml0bWFzayA9PSAoV1JBUF9BUllfRkxBRyB8IFdSQVBfUkVBUkdfRkxBRykpICYmIChzb3VyY2VbN10ubGVuZ3RoIDw9IHNvdXJjZVs4XSkgJiYgKGJpdG1hc2sgPT0gV1JBUF9DVVJSWV9GTEFHKSk7XG5cbiAgICAgIC8vIEV4aXQgZWFybHkgaWYgbWV0YWRhdGEgY2FuJ3QgYmUgbWVyZ2VkLlxuICAgICAgaWYgKCEoaXNDb21tb24gfHwgaXNDb21ibykpIHtcbiAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICB9XG4gICAgICAvLyBVc2Ugc291cmNlIGB0aGlzQXJnYCBpZiBhdmFpbGFibGUuXG4gICAgICBpZiAoc3JjQml0bWFzayAmIFdSQVBfQklORF9GTEFHKSB7XG4gICAgICAgIGRhdGFbMl0gPSBzb3VyY2VbMl07XG4gICAgICAgIC8vIFNldCB3aGVuIGN1cnJ5aW5nIGEgYm91bmQgZnVuY3Rpb24uXG4gICAgICAgIG5ld0JpdG1hc2sgfD0gYml0bWFzayAmIFdSQVBfQklORF9GTEFHID8gMCA6IFdSQVBfQ1VSUllfQk9VTkRfRkxBRztcbiAgICAgIH1cbiAgICAgIC8vIENvbXBvc2UgcGFydGlhbCBhcmd1bWVudHMuXG4gICAgICB2YXIgdmFsdWUgPSBzb3VyY2VbM107XG4gICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgdmFyIHBhcnRpYWxzID0gZGF0YVszXTtcbiAgICAgICAgZGF0YVszXSA9IHBhcnRpYWxzID8gY29tcG9zZUFyZ3MocGFydGlhbHMsIHZhbHVlLCBzb3VyY2VbNF0pIDogdmFsdWU7XG4gICAgICAgIGRhdGFbNF0gPSBwYXJ0aWFscyA/IHJlcGxhY2VIb2xkZXJzKGRhdGFbM10sIFBMQUNFSE9MREVSKSA6IHNvdXJjZVs0XTtcbiAgICAgIH1cbiAgICAgIC8vIENvbXBvc2UgcGFydGlhbCByaWdodCBhcmd1bWVudHMuXG4gICAgICB2YWx1ZSA9IHNvdXJjZVs1XTtcbiAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICBwYXJ0aWFscyA9IGRhdGFbNV07XG4gICAgICAgIGRhdGFbNV0gPSBwYXJ0aWFscyA/IGNvbXBvc2VBcmdzUmlnaHQocGFydGlhbHMsIHZhbHVlLCBzb3VyY2VbNl0pIDogdmFsdWU7XG4gICAgICAgIGRhdGFbNl0gPSBwYXJ0aWFscyA/IHJlcGxhY2VIb2xkZXJzKGRhdGFbNV0sIFBMQUNFSE9MREVSKSA6IHNvdXJjZVs2XTtcbiAgICAgIH1cbiAgICAgIC8vIFVzZSBzb3VyY2UgYGFyZ1Bvc2AgaWYgYXZhaWxhYmxlLlxuICAgICAgdmFsdWUgPSBzb3VyY2VbN107XG4gICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgZGF0YVs3XSA9IHZhbHVlO1xuICAgICAgfVxuICAgICAgLy8gVXNlIHNvdXJjZSBgYXJ5YCBpZiBpdCdzIHNtYWxsZXIuXG4gICAgICBpZiAoc3JjQml0bWFzayAmIFdSQVBfQVJZX0ZMQUcpIHtcbiAgICAgICAgZGF0YVs4XSA9IGRhdGFbOF0gPT0gbnVsbCA/IHNvdXJjZVs4XSA6IG5hdGl2ZU1pbihkYXRhWzhdLCBzb3VyY2VbOF0pO1xuICAgICAgfVxuICAgICAgLy8gVXNlIHNvdXJjZSBgYXJpdHlgIGlmIG9uZSBpcyBub3QgcHJvdmlkZWQuXG4gICAgICBpZiAoZGF0YVs5XSA9PSBudWxsKSB7XG4gICAgICAgIGRhdGFbOV0gPSBzb3VyY2VbOV07XG4gICAgICB9XG4gICAgICAvLyBVc2Ugc291cmNlIGBmdW5jYCBhbmQgbWVyZ2UgYml0bWFza3MuXG4gICAgICBkYXRhWzBdID0gc291cmNlWzBdO1xuICAgICAgZGF0YVsxXSA9IG5ld0JpdG1hc2s7XG5cbiAgICAgIHJldHVybiBkYXRhO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoaXMgZnVuY3Rpb24gaXMgbGlrZVxuICAgICAqIFtgT2JqZWN0LmtleXNgXShodHRwOi8vZWNtYS1pbnRlcm5hdGlvbmFsLm9yZy9lY21hLTI2Mi83LjAvI3NlYy1vYmplY3Qua2V5cylcbiAgICAgKiBleGNlcHQgdGhhdCBpdCBpbmNsdWRlcyBpbmhlcml0ZWQgZW51bWVyYWJsZSBwcm9wZXJ0aWVzLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8gcXVlcnkuXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIHRoZSBhcnJheSBvZiBwcm9wZXJ0eSBuYW1lcy5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBuYXRpdmVLZXlzSW4ob2JqZWN0KSB7XG4gICAgICB2YXIgcmVzdWx0ID0gW107XG4gICAgICBpZiAob2JqZWN0ICE9IG51bGwpIHtcbiAgICAgICAgZm9yICh2YXIga2V5IGluIE9iamVjdChvYmplY3QpKSB7XG4gICAgICAgICAgcmVzdWx0LnB1c2goa2V5KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDb252ZXJ0cyBgdmFsdWVgIHRvIGEgc3RyaW5nIHVzaW5nIGBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nYC5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY29udmVydC5cbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSBSZXR1cm5zIHRoZSBjb252ZXJ0ZWQgc3RyaW5nLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIG9iamVjdFRvU3RyaW5nKHZhbHVlKSB7XG4gICAgICByZXR1cm4gbmF0aXZlT2JqZWN0VG9TdHJpbmcuY2FsbCh2YWx1ZSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQSBzcGVjaWFsaXplZCB2ZXJzaW9uIG9mIGBiYXNlUmVzdGAgd2hpY2ggdHJhbnNmb3JtcyB0aGUgcmVzdCBhcnJheS5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZnVuYyBUaGUgZnVuY3Rpb24gdG8gYXBwbHkgYSByZXN0IHBhcmFtZXRlciB0by5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW3N0YXJ0PWZ1bmMubGVuZ3RoLTFdIFRoZSBzdGFydCBwb3NpdGlvbiBvZiB0aGUgcmVzdCBwYXJhbWV0ZXIuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gdHJhbnNmb3JtIFRoZSByZXN0IGFycmF5IHRyYW5zZm9ybS5cbiAgICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgdGhlIG5ldyBmdW5jdGlvbi5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBvdmVyUmVzdChmdW5jLCBzdGFydCwgdHJhbnNmb3JtKSB7XG4gICAgICBzdGFydCA9IG5hdGl2ZU1heChzdGFydCA9PT0gdW5kZWZpbmVkID8gKGZ1bmMubGVuZ3RoIC0gMSkgOiBzdGFydCwgMCk7XG4gICAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBhcmdzID0gYXJndW1lbnRzLFxuICAgICAgICAgICAgaW5kZXggPSAtMSxcbiAgICAgICAgICAgIGxlbmd0aCA9IG5hdGl2ZU1heChhcmdzLmxlbmd0aCAtIHN0YXJ0LCAwKSxcbiAgICAgICAgICAgIGFycmF5ID0gQXJyYXkobGVuZ3RoKTtcblxuICAgICAgICB3aGlsZSAoKytpbmRleCA8IGxlbmd0aCkge1xuICAgICAgICAgIGFycmF5W2luZGV4XSA9IGFyZ3Nbc3RhcnQgKyBpbmRleF07XG4gICAgICAgIH1cbiAgICAgICAgaW5kZXggPSAtMTtcbiAgICAgICAgdmFyIG90aGVyQXJncyA9IEFycmF5KHN0YXJ0ICsgMSk7XG4gICAgICAgIHdoaWxlICgrK2luZGV4IDwgc3RhcnQpIHtcbiAgICAgICAgICBvdGhlckFyZ3NbaW5kZXhdID0gYXJnc1tpbmRleF07XG4gICAgICAgIH1cbiAgICAgICAgb3RoZXJBcmdzW3N0YXJ0XSA9IHRyYW5zZm9ybShhcnJheSk7XG4gICAgICAgIHJldHVybiBhcHBseShmdW5jLCB0aGlzLCBvdGhlckFyZ3MpO1xuICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBwYXJlbnQgdmFsdWUgYXQgYHBhdGhgIG9mIGBvYmplY3RgLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8gcXVlcnkuXG4gICAgICogQHBhcmFtIHtBcnJheX0gcGF0aCBUaGUgcGF0aCB0byBnZXQgdGhlIHBhcmVudCB2YWx1ZSBvZi5cbiAgICAgKiBAcmV0dXJucyB7Kn0gUmV0dXJucyB0aGUgcGFyZW50IHZhbHVlLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHBhcmVudChvYmplY3QsIHBhdGgpIHtcbiAgICAgIHJldHVybiBwYXRoLmxlbmd0aCA8IDIgPyBvYmplY3QgOiBiYXNlR2V0KG9iamVjdCwgYmFzZVNsaWNlKHBhdGgsIDAsIC0xKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVvcmRlciBgYXJyYXlgIGFjY29yZGluZyB0byB0aGUgc3BlY2lmaWVkIGluZGV4ZXMgd2hlcmUgdGhlIGVsZW1lbnQgYXRcbiAgICAgKiB0aGUgZmlyc3QgaW5kZXggaXMgYXNzaWduZWQgYXMgdGhlIGZpcnN0IGVsZW1lbnQsIHRoZSBlbGVtZW50IGF0XG4gICAgICogdGhlIHNlY29uZCBpbmRleCBpcyBhc3NpZ25lZCBhcyB0aGUgc2Vjb25kIGVsZW1lbnQsIGFuZCBzbyBvbi5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIGFycmF5IHRvIHJlb3JkZXIuXG4gICAgICogQHBhcmFtIHtBcnJheX0gaW5kZXhlcyBUaGUgYXJyYW5nZWQgYXJyYXkgaW5kZXhlcy5cbiAgICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgYGFycmF5YC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiByZW9yZGVyKGFycmF5LCBpbmRleGVzKSB7XG4gICAgICB2YXIgYXJyTGVuZ3RoID0gYXJyYXkubGVuZ3RoLFxuICAgICAgICAgIGxlbmd0aCA9IG5hdGl2ZU1pbihpbmRleGVzLmxlbmd0aCwgYXJyTGVuZ3RoKSxcbiAgICAgICAgICBvbGRBcnJheSA9IGNvcHlBcnJheShhcnJheSk7XG5cbiAgICAgIHdoaWxlIChsZW5ndGgtLSkge1xuICAgICAgICB2YXIgaW5kZXggPSBpbmRleGVzW2xlbmd0aF07XG4gICAgICAgIGFycmF5W2xlbmd0aF0gPSBpc0luZGV4KGluZGV4LCBhcnJMZW5ndGgpID8gb2xkQXJyYXlbaW5kZXhdIDogdW5kZWZpbmVkO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGFycmF5O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNldHMgbWV0YWRhdGEgZm9yIGBmdW5jYC5cbiAgICAgKlxuICAgICAqICoqTm90ZToqKiBJZiB0aGlzIGZ1bmN0aW9uIGJlY29tZXMgaG90LCBpLmUuIGlzIGludm9rZWQgYSBsb3QgaW4gYSBzaG9ydFxuICAgICAqIHBlcmlvZCBvZiB0aW1lLCBpdCB3aWxsIHRyaXAgaXRzIGJyZWFrZXIgYW5kIHRyYW5zaXRpb24gdG8gYW4gaWRlbnRpdHlcbiAgICAgKiBmdW5jdGlvbiB0byBhdm9pZCBnYXJiYWdlIGNvbGxlY3Rpb24gcGF1c2VzIGluIFY4LiBTZWVcbiAgICAgKiBbVjggaXNzdWUgMjA3MF0oaHR0cHM6Ly9idWdzLmNocm9taXVtLm9yZy9wL3Y4L2lzc3Vlcy9kZXRhaWw/aWQ9MjA3MClcbiAgICAgKiBmb3IgbW9yZSBkZXRhaWxzLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmdW5jIFRoZSBmdW5jdGlvbiB0byBhc3NvY2lhdGUgbWV0YWRhdGEgd2l0aC5cbiAgICAgKiBAcGFyYW0geyp9IGRhdGEgVGhlIG1ldGFkYXRhLlxuICAgICAqIEByZXR1cm5zIHtGdW5jdGlvbn0gUmV0dXJucyBgZnVuY2AuXG4gICAgICovXG4gICAgdmFyIHNldERhdGEgPSBzaG9ydE91dChiYXNlU2V0RGF0YSk7XG5cbiAgICAvKipcbiAgICAgKiBBIHNpbXBsZSB3cmFwcGVyIGFyb3VuZCB0aGUgZ2xvYmFsIFtgc2V0VGltZW91dGBdKGh0dHBzOi8vbWRuLmlvL3NldFRpbWVvdXQpLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmdW5jIFRoZSBmdW5jdGlvbiB0byBkZWxheS5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gd2FpdCBUaGUgbnVtYmVyIG9mIG1pbGxpc2Vjb25kcyB0byBkZWxheSBpbnZvY2F0aW9uLlxuICAgICAqIEByZXR1cm5zIHtudW1iZXJ8T2JqZWN0fSBSZXR1cm5zIHRoZSB0aW1lciBpZCBvciB0aW1lb3V0IG9iamVjdC5cbiAgICAgKi9cbiAgICB2YXIgc2V0VGltZW91dCA9IGN0eFNldFRpbWVvdXQgfHwgZnVuY3Rpb24oZnVuYywgd2FpdCkge1xuICAgICAgcmV0dXJuIHJvb3Quc2V0VGltZW91dChmdW5jLCB3YWl0KTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgYHRvU3RyaW5nYCBtZXRob2Qgb2YgYGZ1bmNgIHRvIHJldHVybiBgc3RyaW5nYC5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZnVuYyBUaGUgZnVuY3Rpb24gdG8gbW9kaWZ5LlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IHN0cmluZyBUaGUgYHRvU3RyaW5nYCByZXN1bHQuXG4gICAgICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIGBmdW5jYC5cbiAgICAgKi9cbiAgICB2YXIgc2V0VG9TdHJpbmcgPSBzaG9ydE91dChiYXNlU2V0VG9TdHJpbmcpO1xuXG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgYHRvU3RyaW5nYCBtZXRob2Qgb2YgYHdyYXBwZXJgIHRvIG1pbWljIHRoZSBzb3VyY2Ugb2YgYHJlZmVyZW5jZWBcbiAgICAgKiB3aXRoIHdyYXBwZXIgZGV0YWlscyBpbiBhIGNvbW1lbnQgYXQgdGhlIHRvcCBvZiB0aGUgc291cmNlIGJvZHkuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IHdyYXBwZXIgVGhlIGZ1bmN0aW9uIHRvIG1vZGlmeS5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSByZWZlcmVuY2UgVGhlIHJlZmVyZW5jZSBmdW5jdGlvbi5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gYml0bWFzayBUaGUgYml0bWFzayBmbGFncy4gU2VlIGBjcmVhdGVXcmFwYCBmb3IgbW9yZSBkZXRhaWxzLlxuICAgICAqIEByZXR1cm5zIHtGdW5jdGlvbn0gUmV0dXJucyBgd3JhcHBlcmAuXG4gICAgICovXG4gICAgZnVuY3Rpb24gc2V0V3JhcFRvU3RyaW5nKHdyYXBwZXIsIHJlZmVyZW5jZSwgYml0bWFzaykge1xuICAgICAgdmFyIHNvdXJjZSA9IChyZWZlcmVuY2UgKyAnJyk7XG4gICAgICByZXR1cm4gc2V0VG9TdHJpbmcod3JhcHBlciwgaW5zZXJ0V3JhcERldGFpbHMoc291cmNlLCB1cGRhdGVXcmFwRGV0YWlscyhnZXRXcmFwRGV0YWlscyhzb3VyY2UpLCBiaXRtYXNrKSkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBmdW5jdGlvbiB0aGF0J2xsIHNob3J0IG91dCBhbmQgaW52b2tlIGBpZGVudGl0eWAgaW5zdGVhZFxuICAgICAqIG9mIGBmdW5jYCB3aGVuIGl0J3MgY2FsbGVkIGBIT1RfQ09VTlRgIG9yIG1vcmUgdGltZXMgaW4gYEhPVF9TUEFOYFxuICAgICAqIG1pbGxpc2Vjb25kcy5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZnVuYyBUaGUgZnVuY3Rpb24gdG8gcmVzdHJpY3QuXG4gICAgICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIHRoZSBuZXcgc2hvcnRhYmxlIGZ1bmN0aW9uLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHNob3J0T3V0KGZ1bmMpIHtcbiAgICAgIHZhciBjb3VudCA9IDAsXG4gICAgICAgICAgbGFzdENhbGxlZCA9IDA7XG5cbiAgICAgIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHN0YW1wID0gbmF0aXZlTm93KCksXG4gICAgICAgICAgICByZW1haW5pbmcgPSBIT1RfU1BBTiAtIChzdGFtcCAtIGxhc3RDYWxsZWQpO1xuXG4gICAgICAgIGxhc3RDYWxsZWQgPSBzdGFtcDtcbiAgICAgICAgaWYgKHJlbWFpbmluZyA+IDApIHtcbiAgICAgICAgICBpZiAoKytjb3VudCA+PSBIT1RfQ09VTlQpIHtcbiAgICAgICAgICAgIHJldHVybiBhcmd1bWVudHNbMF07XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvdW50ID0gMDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZnVuYy5hcHBseSh1bmRlZmluZWQsIGFyZ3VtZW50cyk7XG4gICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEEgc3BlY2lhbGl6ZWQgdmVyc2lvbiBvZiBgXy5zaHVmZmxlYCB3aGljaCBtdXRhdGVzIGFuZCBzZXRzIHRoZSBzaXplIG9mIGBhcnJheWAuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGFycmF5IFRoZSBhcnJheSB0byBzaHVmZmxlLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbc2l6ZT1hcnJheS5sZW5ndGhdIFRoZSBzaXplIG9mIGBhcnJheWAuXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIGBhcnJheWAuXG4gICAgICovXG4gICAgZnVuY3Rpb24gc2h1ZmZsZVNlbGYoYXJyYXksIHNpemUpIHtcbiAgICAgIHZhciBpbmRleCA9IC0xLFxuICAgICAgICAgIGxlbmd0aCA9IGFycmF5Lmxlbmd0aCxcbiAgICAgICAgICBsYXN0SW5kZXggPSBsZW5ndGggLSAxO1xuXG4gICAgICBzaXplID0gc2l6ZSA9PT0gdW5kZWZpbmVkID8gbGVuZ3RoIDogc2l6ZTtcbiAgICAgIHdoaWxlICgrK2luZGV4IDwgc2l6ZSkge1xuICAgICAgICB2YXIgcmFuZCA9IGJhc2VSYW5kb20oaW5kZXgsIGxhc3RJbmRleCksXG4gICAgICAgICAgICB2YWx1ZSA9IGFycmF5W3JhbmRdO1xuXG4gICAgICAgIGFycmF5W3JhbmRdID0gYXJyYXlbaW5kZXhdO1xuICAgICAgICBhcnJheVtpbmRleF0gPSB2YWx1ZTtcbiAgICAgIH1cbiAgICAgIGFycmF5Lmxlbmd0aCA9IHNpemU7XG4gICAgICByZXR1cm4gYXJyYXk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ29udmVydHMgYHN0cmluZ2AgdG8gYSBwcm9wZXJ0eSBwYXRoIGFycmF5LlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gc3RyaW5nIFRoZSBzdHJpbmcgdG8gY29udmVydC5cbiAgICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgdGhlIHByb3BlcnR5IHBhdGggYXJyYXkuXG4gICAgICovXG4gICAgdmFyIHN0cmluZ1RvUGF0aCA9IG1lbW9pemVDYXBwZWQoZnVuY3Rpb24oc3RyaW5nKSB7XG4gICAgICB2YXIgcmVzdWx0ID0gW107XG4gICAgICBpZiAoc3RyaW5nLmNoYXJDb2RlQXQoMCkgPT09IDQ2IC8qIC4gKi8pIHtcbiAgICAgICAgcmVzdWx0LnB1c2goJycpO1xuICAgICAgfVxuICAgICAgc3RyaW5nLnJlcGxhY2UocmVQcm9wTmFtZSwgZnVuY3Rpb24obWF0Y2gsIG51bWJlciwgcXVvdGUsIHN1YlN0cmluZykge1xuICAgICAgICByZXN1bHQucHVzaChxdW90ZSA/IHN1YlN0cmluZy5yZXBsYWNlKHJlRXNjYXBlQ2hhciwgJyQxJykgOiAobnVtYmVyIHx8IG1hdGNoKSk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBDb252ZXJ0cyBgdmFsdWVgIHRvIGEgc3RyaW5nIGtleSBpZiBpdCdzIG5vdCBhIHN0cmluZyBvciBzeW1ib2wuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGluc3BlY3QuXG4gICAgICogQHJldHVybnMge3N0cmluZ3xzeW1ib2x9IFJldHVybnMgdGhlIGtleS5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiB0b0tleSh2YWx1ZSkge1xuICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PSAnc3RyaW5nJyB8fCBpc1N5bWJvbCh2YWx1ZSkpIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgfVxuICAgICAgdmFyIHJlc3VsdCA9ICh2YWx1ZSArICcnKTtcbiAgICAgIHJldHVybiAocmVzdWx0ID09ICcwJyAmJiAoMSAvIHZhbHVlKSA9PSAtSU5GSU5JVFkpID8gJy0wJyA6IHJlc3VsdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDb252ZXJ0cyBgZnVuY2AgdG8gaXRzIHNvdXJjZSBjb2RlLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmdW5jIFRoZSBmdW5jdGlvbiB0byBjb252ZXJ0LlxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IFJldHVybnMgdGhlIHNvdXJjZSBjb2RlLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHRvU291cmNlKGZ1bmMpIHtcbiAgICAgIGlmIChmdW5jICE9IG51bGwpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICByZXR1cm4gZnVuY1RvU3RyaW5nLmNhbGwoZnVuYyk7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHt9XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgcmV0dXJuIChmdW5jICsgJycpO1xuICAgICAgICB9IGNhdGNoIChlKSB7fVxuICAgICAgfVxuICAgICAgcmV0dXJuICcnO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZXMgd3JhcHBlciBgZGV0YWlsc2AgYmFzZWQgb24gYGJpdG1hc2tgIGZsYWdzLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcmV0dXJucyB7QXJyYXl9IGRldGFpbHMgVGhlIGRldGFpbHMgdG8gbW9kaWZ5LlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBiaXRtYXNrIFRoZSBiaXRtYXNrIGZsYWdzLiBTZWUgYGNyZWF0ZVdyYXBgIGZvciBtb3JlIGRldGFpbHMuXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIGBkZXRhaWxzYC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiB1cGRhdGVXcmFwRGV0YWlscyhkZXRhaWxzLCBiaXRtYXNrKSB7XG4gICAgICBhcnJheUVhY2god3JhcEZsYWdzLCBmdW5jdGlvbihwYWlyKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9ICdfLicgKyBwYWlyWzBdO1xuICAgICAgICBpZiAoKGJpdG1hc2sgJiBwYWlyWzFdKSAmJiAhYXJyYXlJbmNsdWRlcyhkZXRhaWxzLCB2YWx1ZSkpIHtcbiAgICAgICAgICBkZXRhaWxzLnB1c2godmFsdWUpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBkZXRhaWxzLnNvcnQoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgY2xvbmUgb2YgYHdyYXBwZXJgLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gd3JhcHBlciBUaGUgd3JhcHBlciB0byBjbG9uZS5cbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIHRoZSBjbG9uZWQgd3JhcHBlci5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiB3cmFwcGVyQ2xvbmUod3JhcHBlcikge1xuICAgICAgaWYgKHdyYXBwZXIgaW5zdGFuY2VvZiBMYXp5V3JhcHBlcikge1xuICAgICAgICByZXR1cm4gd3JhcHBlci5jbG9uZSgpO1xuICAgICAgfVxuICAgICAgdmFyIHJlc3VsdCA9IG5ldyBMb2Rhc2hXcmFwcGVyKHdyYXBwZXIuX193cmFwcGVkX18sIHdyYXBwZXIuX19jaGFpbl9fKTtcbiAgICAgIHJlc3VsdC5fX2FjdGlvbnNfXyA9IGNvcHlBcnJheSh3cmFwcGVyLl9fYWN0aW9uc19fKTtcbiAgICAgIHJlc3VsdC5fX2luZGV4X18gID0gd3JhcHBlci5fX2luZGV4X187XG4gICAgICByZXN1bHQuX192YWx1ZXNfXyA9IHdyYXBwZXIuX192YWx1ZXNfXztcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuXG4gICAgLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbiBhcnJheSBvZiBlbGVtZW50cyBzcGxpdCBpbnRvIGdyb3VwcyB0aGUgbGVuZ3RoIG9mIGBzaXplYC5cbiAgICAgKiBJZiBgYXJyYXlgIGNhbid0IGJlIHNwbGl0IGV2ZW5seSwgdGhlIGZpbmFsIGNodW5rIHdpbGwgYmUgdGhlIHJlbWFpbmluZ1xuICAgICAqIGVsZW1lbnRzLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDMuMC4wXG4gICAgICogQGNhdGVnb3J5IEFycmF5XG4gICAgICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIGFycmF5IHRvIHByb2Nlc3MuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtzaXplPTFdIFRoZSBsZW5ndGggb2YgZWFjaCBjaHVua1xuICAgICAqIEBwYXJhbS0ge09iamVjdH0gW2d1YXJkXSBFbmFibGVzIHVzZSBhcyBhbiBpdGVyYXRlZSBmb3IgbWV0aG9kcyBsaWtlIGBfLm1hcGAuXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIHRoZSBuZXcgYXJyYXkgb2YgY2h1bmtzLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLmNodW5rKFsnYScsICdiJywgJ2MnLCAnZCddLCAyKTtcbiAgICAgKiAvLyA9PiBbWydhJywgJ2InXSwgWydjJywgJ2QnXV1cbiAgICAgKlxuICAgICAqIF8uY2h1bmsoWydhJywgJ2InLCAnYycsICdkJ10sIDMpO1xuICAgICAqIC8vID0+IFtbJ2EnLCAnYicsICdjJ10sIFsnZCddXVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNodW5rKGFycmF5LCBzaXplLCBndWFyZCkge1xuICAgICAgaWYgKChndWFyZCA/IGlzSXRlcmF0ZWVDYWxsKGFycmF5LCBzaXplLCBndWFyZCkgOiBzaXplID09PSB1bmRlZmluZWQpKSB7XG4gICAgICAgIHNpemUgPSAxO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2l6ZSA9IG5hdGl2ZU1heCh0b0ludGVnZXIoc2l6ZSksIDApO1xuICAgICAgfVxuICAgICAgdmFyIGxlbmd0aCA9IGFycmF5ID09IG51bGwgPyAwIDogYXJyYXkubGVuZ3RoO1xuICAgICAgaWYgKCFsZW5ndGggfHwgc2l6ZSA8IDEpIHtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgfVxuICAgICAgdmFyIGluZGV4ID0gMCxcbiAgICAgICAgICByZXNJbmRleCA9IDAsXG4gICAgICAgICAgcmVzdWx0ID0gQXJyYXkobmF0aXZlQ2VpbChsZW5ndGggLyBzaXplKSk7XG5cbiAgICAgIHdoaWxlIChpbmRleCA8IGxlbmd0aCkge1xuICAgICAgICByZXN1bHRbcmVzSW5kZXgrK10gPSBiYXNlU2xpY2UoYXJyYXksIGluZGV4LCAoaW5kZXggKz0gc2l6ZSkpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuIGFycmF5IHdpdGggYWxsIGZhbHNleSB2YWx1ZXMgcmVtb3ZlZC4gVGhlIHZhbHVlcyBgZmFsc2VgLCBgbnVsbGAsXG4gICAgICogYDBgLCBgXCJcImAsIGB1bmRlZmluZWRgLCBhbmQgYE5hTmAgYXJlIGZhbHNleS5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAwLjEuMFxuICAgICAqIEBjYXRlZ29yeSBBcnJheVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGFycmF5IFRoZSBhcnJheSB0byBjb21wYWN0LlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgbmV3IGFycmF5IG9mIGZpbHRlcmVkIHZhbHVlcy5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5jb21wYWN0KFswLCAxLCBmYWxzZSwgMiwgJycsIDNdKTtcbiAgICAgKiAvLyA9PiBbMSwgMiwgM11cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjb21wYWN0KGFycmF5KSB7XG4gICAgICB2YXIgaW5kZXggPSAtMSxcbiAgICAgICAgICBsZW5ndGggPSBhcnJheSA9PSBudWxsID8gMCA6IGFycmF5Lmxlbmd0aCxcbiAgICAgICAgICByZXNJbmRleCA9IDAsXG4gICAgICAgICAgcmVzdWx0ID0gW107XG5cbiAgICAgIHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IGFycmF5W2luZGV4XTtcbiAgICAgICAgaWYgKHZhbHVlKSB7XG4gICAgICAgICAgcmVzdWx0W3Jlc0luZGV4KytdID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIG5ldyBhcnJheSBjb25jYXRlbmF0aW5nIGBhcnJheWAgd2l0aCBhbnkgYWRkaXRpb25hbCBhcnJheXNcbiAgICAgKiBhbmQvb3IgdmFsdWVzLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDQuMC4wXG4gICAgICogQGNhdGVnb3J5IEFycmF5XG4gICAgICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIGFycmF5IHRvIGNvbmNhdGVuYXRlLlxuICAgICAqIEBwYXJhbSB7Li4uKn0gW3ZhbHVlc10gVGhlIHZhbHVlcyB0byBjb25jYXRlbmF0ZS5cbiAgICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgdGhlIG5ldyBjb25jYXRlbmF0ZWQgYXJyYXkuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciBhcnJheSA9IFsxXTtcbiAgICAgKiB2YXIgb3RoZXIgPSBfLmNvbmNhdChhcnJheSwgMiwgWzNdLCBbWzRdXSk7XG4gICAgICpcbiAgICAgKiBjb25zb2xlLmxvZyhvdGhlcik7XG4gICAgICogLy8gPT4gWzEsIDIsIDMsIFs0XV1cbiAgICAgKlxuICAgICAqIGNvbnNvbGUubG9nKGFycmF5KTtcbiAgICAgKiAvLyA9PiBbMV1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjb25jYXQoKSB7XG4gICAgICB2YXIgbGVuZ3RoID0gYXJndW1lbnRzLmxlbmd0aDtcbiAgICAgIGlmICghbGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBbXTtcbiAgICAgIH1cbiAgICAgIHZhciBhcmdzID0gQXJyYXkobGVuZ3RoIC0gMSksXG4gICAgICAgICAgYXJyYXkgPSBhcmd1bWVudHNbMF0sXG4gICAgICAgICAgaW5kZXggPSBsZW5ndGg7XG5cbiAgICAgIHdoaWxlIChpbmRleC0tKSB7XG4gICAgICAgIGFyZ3NbaW5kZXggLSAxXSA9IGFyZ3VtZW50c1tpbmRleF07XG4gICAgICB9XG4gICAgICByZXR1cm4gYXJyYXlQdXNoKGlzQXJyYXkoYXJyYXkpID8gY29weUFycmF5KGFycmF5KSA6IFthcnJheV0sIGJhc2VGbGF0dGVuKGFyZ3MsIDEpKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuIGFycmF5IG9mIGBhcnJheWAgdmFsdWVzIG5vdCBpbmNsdWRlZCBpbiB0aGUgb3RoZXIgZ2l2ZW4gYXJyYXlzXG4gICAgICogdXNpbmcgW2BTYW1lVmFsdWVaZXJvYF0oaHR0cDovL2VjbWEtaW50ZXJuYXRpb25hbC5vcmcvZWNtYS0yNjIvNy4wLyNzZWMtc2FtZXZhbHVlemVybylcbiAgICAgKiBmb3IgZXF1YWxpdHkgY29tcGFyaXNvbnMuIFRoZSBvcmRlciBhbmQgcmVmZXJlbmNlcyBvZiByZXN1bHQgdmFsdWVzIGFyZVxuICAgICAqIGRldGVybWluZWQgYnkgdGhlIGZpcnN0IGFycmF5LlxuICAgICAqXG4gICAgICogKipOb3RlOioqIFVubGlrZSBgXy5wdWxsQWxsYCwgdGhpcyBtZXRob2QgcmV0dXJucyBhIG5ldyBhcnJheS5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAwLjEuMFxuICAgICAqIEBjYXRlZ29yeSBBcnJheVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGFycmF5IFRoZSBhcnJheSB0byBpbnNwZWN0LlxuICAgICAqIEBwYXJhbSB7Li4uQXJyYXl9IFt2YWx1ZXNdIFRoZSB2YWx1ZXMgdG8gZXhjbHVkZS5cbiAgICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgdGhlIG5ldyBhcnJheSBvZiBmaWx0ZXJlZCB2YWx1ZXMuXG4gICAgICogQHNlZSBfLndpdGhvdXQsIF8ueG9yXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8uZGlmZmVyZW5jZShbMiwgMV0sIFsyLCAzXSk7XG4gICAgICogLy8gPT4gWzFdXG4gICAgICovXG4gICAgdmFyIGRpZmZlcmVuY2UgPSBiYXNlUmVzdChmdW5jdGlvbihhcnJheSwgdmFsdWVzKSB7XG4gICAgICByZXR1cm4gaXNBcnJheUxpa2VPYmplY3QoYXJyYXkpXG4gICAgICAgID8gYmFzZURpZmZlcmVuY2UoYXJyYXksIGJhc2VGbGF0dGVuKHZhbHVlcywgMSwgaXNBcnJheUxpa2VPYmplY3QsIHRydWUpKVxuICAgICAgICA6IFtdO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogVGhpcyBtZXRob2QgaXMgbGlrZSBgXy5kaWZmZXJlbmNlYCBleGNlcHQgdGhhdCBpdCBhY2NlcHRzIGBpdGVyYXRlZWAgd2hpY2hcbiAgICAgKiBpcyBpbnZva2VkIGZvciBlYWNoIGVsZW1lbnQgb2YgYGFycmF5YCBhbmQgYHZhbHVlc2AgdG8gZ2VuZXJhdGUgdGhlIGNyaXRlcmlvblxuICAgICAqIGJ5IHdoaWNoIHRoZXkncmUgY29tcGFyZWQuIFRoZSBvcmRlciBhbmQgcmVmZXJlbmNlcyBvZiByZXN1bHQgdmFsdWVzIGFyZVxuICAgICAqIGRldGVybWluZWQgYnkgdGhlIGZpcnN0IGFycmF5LiBUaGUgaXRlcmF0ZWUgaXMgaW52b2tlZCB3aXRoIG9uZSBhcmd1bWVudDpcbiAgICAgKiAodmFsdWUpLlxuICAgICAqXG4gICAgICogKipOb3RlOioqIFVubGlrZSBgXy5wdWxsQWxsQnlgLCB0aGlzIG1ldGhvZCByZXR1cm5zIGEgbmV3IGFycmF5LlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDQuMC4wXG4gICAgICogQGNhdGVnb3J5IEFycmF5XG4gICAgICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIGFycmF5IHRvIGluc3BlY3QuXG4gICAgICogQHBhcmFtIHsuLi5BcnJheX0gW3ZhbHVlc10gVGhlIHZhbHVlcyB0byBleGNsdWRlLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtpdGVyYXRlZT1fLmlkZW50aXR5XSBUaGUgaXRlcmF0ZWUgaW52b2tlZCBwZXIgZWxlbWVudC5cbiAgICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgdGhlIG5ldyBhcnJheSBvZiBmaWx0ZXJlZCB2YWx1ZXMuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8uZGlmZmVyZW5jZUJ5KFsyLjEsIDEuMl0sIFsyLjMsIDMuNF0sIE1hdGguZmxvb3IpO1xuICAgICAqIC8vID0+IFsxLjJdXG4gICAgICpcbiAgICAgKiAvLyBUaGUgYF8ucHJvcGVydHlgIGl0ZXJhdGVlIHNob3J0aGFuZC5cbiAgICAgKiBfLmRpZmZlcmVuY2VCeShbeyAneCc6IDIgfSwgeyAneCc6IDEgfV0sIFt7ICd4JzogMSB9XSwgJ3gnKTtcbiAgICAgKiAvLyA9PiBbeyAneCc6IDIgfV1cbiAgICAgKi9cbiAgICB2YXIgZGlmZmVyZW5jZUJ5ID0gYmFzZVJlc3QoZnVuY3Rpb24oYXJyYXksIHZhbHVlcykge1xuICAgICAgdmFyIGl0ZXJhdGVlID0gbGFzdCh2YWx1ZXMpO1xuICAgICAgaWYgKGlzQXJyYXlMaWtlT2JqZWN0KGl0ZXJhdGVlKSkge1xuICAgICAgICBpdGVyYXRlZSA9IHVuZGVmaW5lZDtcbiAgICAgIH1cbiAgICAgIHJldHVybiBpc0FycmF5TGlrZU9iamVjdChhcnJheSlcbiAgICAgICAgPyBiYXNlRGlmZmVyZW5jZShhcnJheSwgYmFzZUZsYXR0ZW4odmFsdWVzLCAxLCBpc0FycmF5TGlrZU9iamVjdCwgdHJ1ZSksIGdldEl0ZXJhdGVlKGl0ZXJhdGVlLCAyKSlcbiAgICAgICAgOiBbXTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFRoaXMgbWV0aG9kIGlzIGxpa2UgYF8uZGlmZmVyZW5jZWAgZXhjZXB0IHRoYXQgaXQgYWNjZXB0cyBgY29tcGFyYXRvcmBcbiAgICAgKiB3aGljaCBpcyBpbnZva2VkIHRvIGNvbXBhcmUgZWxlbWVudHMgb2YgYGFycmF5YCB0byBgdmFsdWVzYC4gVGhlIG9yZGVyIGFuZFxuICAgICAqIHJlZmVyZW5jZXMgb2YgcmVzdWx0IHZhbHVlcyBhcmUgZGV0ZXJtaW5lZCBieSB0aGUgZmlyc3QgYXJyYXkuIFRoZSBjb21wYXJhdG9yXG4gICAgICogaXMgaW52b2tlZCB3aXRoIHR3byBhcmd1bWVudHM6IChhcnJWYWwsIG90aFZhbCkuXG4gICAgICpcbiAgICAgKiAqKk5vdGU6KiogVW5saWtlIGBfLnB1bGxBbGxXaXRoYCwgdGhpcyBtZXRob2QgcmV0dXJucyBhIG5ldyBhcnJheS5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSA0LjAuMFxuICAgICAqIEBjYXRlZ29yeSBBcnJheVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGFycmF5IFRoZSBhcnJheSB0byBpbnNwZWN0LlxuICAgICAqIEBwYXJhbSB7Li4uQXJyYXl9IFt2YWx1ZXNdIFRoZSB2YWx1ZXMgdG8gZXhjbHVkZS5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbY29tcGFyYXRvcl0gVGhlIGNvbXBhcmF0b3IgaW52b2tlZCBwZXIgZWxlbWVudC5cbiAgICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgdGhlIG5ldyBhcnJheSBvZiBmaWx0ZXJlZCB2YWx1ZXMuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciBvYmplY3RzID0gW3sgJ3gnOiAxLCAneSc6IDIgfSwgeyAneCc6IDIsICd5JzogMSB9XTtcbiAgICAgKlxuICAgICAqIF8uZGlmZmVyZW5jZVdpdGgob2JqZWN0cywgW3sgJ3gnOiAxLCAneSc6IDIgfV0sIF8uaXNFcXVhbCk7XG4gICAgICogLy8gPT4gW3sgJ3gnOiAyLCAneSc6IDEgfV1cbiAgICAgKi9cbiAgICB2YXIgZGlmZmVyZW5jZVdpdGggPSBiYXNlUmVzdChmdW5jdGlvbihhcnJheSwgdmFsdWVzKSB7XG4gICAgICB2YXIgY29tcGFyYXRvciA9IGxhc3QodmFsdWVzKTtcbiAgICAgIGlmIChpc0FycmF5TGlrZU9iamVjdChjb21wYXJhdG9yKSkge1xuICAgICAgICBjb21wYXJhdG9yID0gdW5kZWZpbmVkO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGlzQXJyYXlMaWtlT2JqZWN0KGFycmF5KVxuICAgICAgICA/IGJhc2VEaWZmZXJlbmNlKGFycmF5LCBiYXNlRmxhdHRlbih2YWx1ZXMsIDEsIGlzQXJyYXlMaWtlT2JqZWN0LCB0cnVlKSwgdW5kZWZpbmVkLCBjb21wYXJhdG9yKVxuICAgICAgICA6IFtdO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIHNsaWNlIG9mIGBhcnJheWAgd2l0aCBgbmAgZWxlbWVudHMgZHJvcHBlZCBmcm9tIHRoZSBiZWdpbm5pbmcuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMC41LjBcbiAgICAgKiBAY2F0ZWdvcnkgQXJyYXlcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBhcnJheSBUaGUgYXJyYXkgdG8gcXVlcnkuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtuPTFdIFRoZSBudW1iZXIgb2YgZWxlbWVudHMgdG8gZHJvcC5cbiAgICAgKiBAcGFyYW0tIHtPYmplY3R9IFtndWFyZF0gRW5hYmxlcyB1c2UgYXMgYW4gaXRlcmF0ZWUgZm9yIG1ldGhvZHMgbGlrZSBgXy5tYXBgLlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgc2xpY2Ugb2YgYGFycmF5YC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5kcm9wKFsxLCAyLCAzXSk7XG4gICAgICogLy8gPT4gWzIsIDNdXG4gICAgICpcbiAgICAgKiBfLmRyb3AoWzEsIDIsIDNdLCAyKTtcbiAgICAgKiAvLyA9PiBbM11cbiAgICAgKlxuICAgICAqIF8uZHJvcChbMSwgMiwgM10sIDUpO1xuICAgICAqIC8vID0+IFtdXG4gICAgICpcbiAgICAgKiBfLmRyb3AoWzEsIDIsIDNdLCAwKTtcbiAgICAgKiAvLyA9PiBbMSwgMiwgM11cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBkcm9wKGFycmF5LCBuLCBndWFyZCkge1xuICAgICAgdmFyIGxlbmd0aCA9IGFycmF5ID09IG51bGwgPyAwIDogYXJyYXkubGVuZ3RoO1xuICAgICAgaWYgKCFsZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgfVxuICAgICAgbiA9IChndWFyZCB8fCBuID09PSB1bmRlZmluZWQpID8gMSA6IHRvSW50ZWdlcihuKTtcbiAgICAgIHJldHVybiBiYXNlU2xpY2UoYXJyYXksIG4gPCAwID8gMCA6IG4sIGxlbmd0aCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIHNsaWNlIG9mIGBhcnJheWAgd2l0aCBgbmAgZWxlbWVudHMgZHJvcHBlZCBmcm9tIHRoZSBlbmQuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMy4wLjBcbiAgICAgKiBAY2F0ZWdvcnkgQXJyYXlcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBhcnJheSBUaGUgYXJyYXkgdG8gcXVlcnkuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtuPTFdIFRoZSBudW1iZXIgb2YgZWxlbWVudHMgdG8gZHJvcC5cbiAgICAgKiBAcGFyYW0tIHtPYmplY3R9IFtndWFyZF0gRW5hYmxlcyB1c2UgYXMgYW4gaXRlcmF0ZWUgZm9yIG1ldGhvZHMgbGlrZSBgXy5tYXBgLlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgc2xpY2Ugb2YgYGFycmF5YC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5kcm9wUmlnaHQoWzEsIDIsIDNdKTtcbiAgICAgKiAvLyA9PiBbMSwgMl1cbiAgICAgKlxuICAgICAqIF8uZHJvcFJpZ2h0KFsxLCAyLCAzXSwgMik7XG4gICAgICogLy8gPT4gWzFdXG4gICAgICpcbiAgICAgKiBfLmRyb3BSaWdodChbMSwgMiwgM10sIDUpO1xuICAgICAqIC8vID0+IFtdXG4gICAgICpcbiAgICAgKiBfLmRyb3BSaWdodChbMSwgMiwgM10sIDApO1xuICAgICAqIC8vID0+IFsxLCAyLCAzXVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGRyb3BSaWdodChhcnJheSwgbiwgZ3VhcmQpIHtcbiAgICAgIHZhciBsZW5ndGggPSBhcnJheSA9PSBudWxsID8gMCA6IGFycmF5Lmxlbmd0aDtcbiAgICAgIGlmICghbGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBbXTtcbiAgICAgIH1cbiAgICAgIG4gPSAoZ3VhcmQgfHwgbiA9PT0gdW5kZWZpbmVkKSA/IDEgOiB0b0ludGVnZXIobik7XG4gICAgICBuID0gbGVuZ3RoIC0gbjtcbiAgICAgIHJldHVybiBiYXNlU2xpY2UoYXJyYXksIDAsIG4gPCAwID8gMCA6IG4pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBzbGljZSBvZiBgYXJyYXlgIGV4Y2x1ZGluZyBlbGVtZW50cyBkcm9wcGVkIGZyb20gdGhlIGVuZC5cbiAgICAgKiBFbGVtZW50cyBhcmUgZHJvcHBlZCB1bnRpbCBgcHJlZGljYXRlYCByZXR1cm5zIGZhbHNleS4gVGhlIHByZWRpY2F0ZSBpc1xuICAgICAqIGludm9rZWQgd2l0aCB0aHJlZSBhcmd1bWVudHM6ICh2YWx1ZSwgaW5kZXgsIGFycmF5KS5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAzLjAuMFxuICAgICAqIEBjYXRlZ29yeSBBcnJheVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGFycmF5IFRoZSBhcnJheSB0byBxdWVyeS5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbcHJlZGljYXRlPV8uaWRlbnRpdHldIFRoZSBmdW5jdGlvbiBpbnZva2VkIHBlciBpdGVyYXRpb24uXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIHRoZSBzbGljZSBvZiBgYXJyYXlgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiB2YXIgdXNlcnMgPSBbXG4gICAgICogICB7ICd1c2VyJzogJ2Jhcm5leScsICAnYWN0aXZlJzogdHJ1ZSB9LFxuICAgICAqICAgeyAndXNlcic6ICdmcmVkJywgICAgJ2FjdGl2ZSc6IGZhbHNlIH0sXG4gICAgICogICB7ICd1c2VyJzogJ3BlYmJsZXMnLCAnYWN0aXZlJzogZmFsc2UgfVxuICAgICAqIF07XG4gICAgICpcbiAgICAgKiBfLmRyb3BSaWdodFdoaWxlKHVzZXJzLCBmdW5jdGlvbihvKSB7IHJldHVybiAhby5hY3RpdmU7IH0pO1xuICAgICAqIC8vID0+IG9iamVjdHMgZm9yIFsnYmFybmV5J11cbiAgICAgKlxuICAgICAqIC8vIFRoZSBgXy5tYXRjaGVzYCBpdGVyYXRlZSBzaG9ydGhhbmQuXG4gICAgICogXy5kcm9wUmlnaHRXaGlsZSh1c2VycywgeyAndXNlcic6ICdwZWJibGVzJywgJ2FjdGl2ZSc6IGZhbHNlIH0pO1xuICAgICAqIC8vID0+IG9iamVjdHMgZm9yIFsnYmFybmV5JywgJ2ZyZWQnXVxuICAgICAqXG4gICAgICogLy8gVGhlIGBfLm1hdGNoZXNQcm9wZXJ0eWAgaXRlcmF0ZWUgc2hvcnRoYW5kLlxuICAgICAqIF8uZHJvcFJpZ2h0V2hpbGUodXNlcnMsIFsnYWN0aXZlJywgZmFsc2VdKTtcbiAgICAgKiAvLyA9PiBvYmplY3RzIGZvciBbJ2Jhcm5leSddXG4gICAgICpcbiAgICAgKiAvLyBUaGUgYF8ucHJvcGVydHlgIGl0ZXJhdGVlIHNob3J0aGFuZC5cbiAgICAgKiBfLmRyb3BSaWdodFdoaWxlKHVzZXJzLCAnYWN0aXZlJyk7XG4gICAgICogLy8gPT4gb2JqZWN0cyBmb3IgWydiYXJuZXknLCAnZnJlZCcsICdwZWJibGVzJ11cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBkcm9wUmlnaHRXaGlsZShhcnJheSwgcHJlZGljYXRlKSB7XG4gICAgICByZXR1cm4gKGFycmF5ICYmIGFycmF5Lmxlbmd0aClcbiAgICAgICAgPyBiYXNlV2hpbGUoYXJyYXksIGdldEl0ZXJhdGVlKHByZWRpY2F0ZSwgMyksIHRydWUsIHRydWUpXG4gICAgICAgIDogW107XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIHNsaWNlIG9mIGBhcnJheWAgZXhjbHVkaW5nIGVsZW1lbnRzIGRyb3BwZWQgZnJvbSB0aGUgYmVnaW5uaW5nLlxuICAgICAqIEVsZW1lbnRzIGFyZSBkcm9wcGVkIHVudGlsIGBwcmVkaWNhdGVgIHJldHVybnMgZmFsc2V5LiBUaGUgcHJlZGljYXRlIGlzXG4gICAgICogaW52b2tlZCB3aXRoIHRocmVlIGFyZ3VtZW50czogKHZhbHVlLCBpbmRleCwgYXJyYXkpLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDMuMC4wXG4gICAgICogQGNhdGVnb3J5IEFycmF5XG4gICAgICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIGFycmF5IHRvIHF1ZXJ5LlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtwcmVkaWNhdGU9Xy5pZGVudGl0eV0gVGhlIGZ1bmN0aW9uIGludm9rZWQgcGVyIGl0ZXJhdGlvbi5cbiAgICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgdGhlIHNsaWNlIG9mIGBhcnJheWAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciB1c2VycyA9IFtcbiAgICAgKiAgIHsgJ3VzZXInOiAnYmFybmV5JywgICdhY3RpdmUnOiBmYWxzZSB9LFxuICAgICAqICAgeyAndXNlcic6ICdmcmVkJywgICAgJ2FjdGl2ZSc6IGZhbHNlIH0sXG4gICAgICogICB7ICd1c2VyJzogJ3BlYmJsZXMnLCAnYWN0aXZlJzogdHJ1ZSB9XG4gICAgICogXTtcbiAgICAgKlxuICAgICAqIF8uZHJvcFdoaWxlKHVzZXJzLCBmdW5jdGlvbihvKSB7IHJldHVybiAhby5hY3RpdmU7IH0pO1xuICAgICAqIC8vID0+IG9iamVjdHMgZm9yIFsncGViYmxlcyddXG4gICAgICpcbiAgICAgKiAvLyBUaGUgYF8ubWF0Y2hlc2AgaXRlcmF0ZWUgc2hvcnRoYW5kLlxuICAgICAqIF8uZHJvcFdoaWxlKHVzZXJzLCB7ICd1c2VyJzogJ2Jhcm5leScsICdhY3RpdmUnOiBmYWxzZSB9KTtcbiAgICAgKiAvLyA9PiBvYmplY3RzIGZvciBbJ2ZyZWQnLCAncGViYmxlcyddXG4gICAgICpcbiAgICAgKiAvLyBUaGUgYF8ubWF0Y2hlc1Byb3BlcnR5YCBpdGVyYXRlZSBzaG9ydGhhbmQuXG4gICAgICogXy5kcm9wV2hpbGUodXNlcnMsIFsnYWN0aXZlJywgZmFsc2VdKTtcbiAgICAgKiAvLyA9PiBvYmplY3RzIGZvciBbJ3BlYmJsZXMnXVxuICAgICAqXG4gICAgICogLy8gVGhlIGBfLnByb3BlcnR5YCBpdGVyYXRlZSBzaG9ydGhhbmQuXG4gICAgICogXy5kcm9wV2hpbGUodXNlcnMsICdhY3RpdmUnKTtcbiAgICAgKiAvLyA9PiBvYmplY3RzIGZvciBbJ2Jhcm5leScsICdmcmVkJywgJ3BlYmJsZXMnXVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGRyb3BXaGlsZShhcnJheSwgcHJlZGljYXRlKSB7XG4gICAgICByZXR1cm4gKGFycmF5ICYmIGFycmF5Lmxlbmd0aClcbiAgICAgICAgPyBiYXNlV2hpbGUoYXJyYXksIGdldEl0ZXJhdGVlKHByZWRpY2F0ZSwgMyksIHRydWUpXG4gICAgICAgIDogW107XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRmlsbHMgZWxlbWVudHMgb2YgYGFycmF5YCB3aXRoIGB2YWx1ZWAgZnJvbSBgc3RhcnRgIHVwIHRvLCBidXQgbm90XG4gICAgICogaW5jbHVkaW5nLCBgZW5kYC5cbiAgICAgKlxuICAgICAqICoqTm90ZToqKiBUaGlzIG1ldGhvZCBtdXRhdGVzIGBhcnJheWAuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMy4yLjBcbiAgICAgKiBAY2F0ZWdvcnkgQXJyYXlcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBhcnJheSBUaGUgYXJyYXkgdG8gZmlsbC5cbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBmaWxsIGBhcnJheWAgd2l0aC5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW3N0YXJ0PTBdIFRoZSBzdGFydCBwb3NpdGlvbi5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW2VuZD1hcnJheS5sZW5ndGhdIFRoZSBlbmQgcG9zaXRpb24uXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIGBhcnJheWAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciBhcnJheSA9IFsxLCAyLCAzXTtcbiAgICAgKlxuICAgICAqIF8uZmlsbChhcnJheSwgJ2EnKTtcbiAgICAgKiBjb25zb2xlLmxvZyhhcnJheSk7XG4gICAgICogLy8gPT4gWydhJywgJ2EnLCAnYSddXG4gICAgICpcbiAgICAgKiBfLmZpbGwoQXJyYXkoMyksIDIpO1xuICAgICAqIC8vID0+IFsyLCAyLCAyXVxuICAgICAqXG4gICAgICogXy5maWxsKFs0LCA2LCA4LCAxMF0sICcqJywgMSwgMyk7XG4gICAgICogLy8gPT4gWzQsICcqJywgJyonLCAxMF1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBmaWxsKGFycmF5LCB2YWx1ZSwgc3RhcnQsIGVuZCkge1xuICAgICAgdmFyIGxlbmd0aCA9IGFycmF5ID09IG51bGwgPyAwIDogYXJyYXkubGVuZ3RoO1xuICAgICAgaWYgKCFsZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgfVxuICAgICAgaWYgKHN0YXJ0ICYmIHR5cGVvZiBzdGFydCAhPSAnbnVtYmVyJyAmJiBpc0l0ZXJhdGVlQ2FsbChhcnJheSwgdmFsdWUsIHN0YXJ0KSkge1xuICAgICAgICBzdGFydCA9IDA7XG4gICAgICAgIGVuZCA9IGxlbmd0aDtcbiAgICAgIH1cbiAgICAgIHJldHVybiBiYXNlRmlsbChhcnJheSwgdmFsdWUsIHN0YXJ0LCBlbmQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoaXMgbWV0aG9kIGlzIGxpa2UgYF8uZmluZGAgZXhjZXB0IHRoYXQgaXQgcmV0dXJucyB0aGUgaW5kZXggb2YgdGhlIGZpcnN0XG4gICAgICogZWxlbWVudCBgcHJlZGljYXRlYCByZXR1cm5zIHRydXRoeSBmb3IgaW5zdGVhZCBvZiB0aGUgZWxlbWVudCBpdHNlbGYuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMS4xLjBcbiAgICAgKiBAY2F0ZWdvcnkgQXJyYXlcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBhcnJheSBUaGUgYXJyYXkgdG8gaW5zcGVjdC5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbcHJlZGljYXRlPV8uaWRlbnRpdHldIFRoZSBmdW5jdGlvbiBpbnZva2VkIHBlciBpdGVyYXRpb24uXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtmcm9tSW5kZXg9MF0gVGhlIGluZGV4IHRvIHNlYXJjaCBmcm9tLlxuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IFJldHVybnMgdGhlIGluZGV4IG9mIHRoZSBmb3VuZCBlbGVtZW50LCBlbHNlIGAtMWAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciB1c2VycyA9IFtcbiAgICAgKiAgIHsgJ3VzZXInOiAnYmFybmV5JywgICdhY3RpdmUnOiBmYWxzZSB9LFxuICAgICAqICAgeyAndXNlcic6ICdmcmVkJywgICAgJ2FjdGl2ZSc6IGZhbHNlIH0sXG4gICAgICogICB7ICd1c2VyJzogJ3BlYmJsZXMnLCAnYWN0aXZlJzogdHJ1ZSB9XG4gICAgICogXTtcbiAgICAgKlxuICAgICAqIF8uZmluZEluZGV4KHVzZXJzLCBmdW5jdGlvbihvKSB7IHJldHVybiBvLnVzZXIgPT0gJ2Jhcm5leSc7IH0pO1xuICAgICAqIC8vID0+IDBcbiAgICAgKlxuICAgICAqIC8vIFRoZSBgXy5tYXRjaGVzYCBpdGVyYXRlZSBzaG9ydGhhbmQuXG4gICAgICogXy5maW5kSW5kZXgodXNlcnMsIHsgJ3VzZXInOiAnZnJlZCcsICdhY3RpdmUnOiBmYWxzZSB9KTtcbiAgICAgKiAvLyA9PiAxXG4gICAgICpcbiAgICAgKiAvLyBUaGUgYF8ubWF0Y2hlc1Byb3BlcnR5YCBpdGVyYXRlZSBzaG9ydGhhbmQuXG4gICAgICogXy5maW5kSW5kZXgodXNlcnMsIFsnYWN0aXZlJywgZmFsc2VdKTtcbiAgICAgKiAvLyA9PiAwXG4gICAgICpcbiAgICAgKiAvLyBUaGUgYF8ucHJvcGVydHlgIGl0ZXJhdGVlIHNob3J0aGFuZC5cbiAgICAgKiBfLmZpbmRJbmRleCh1c2VycywgJ2FjdGl2ZScpO1xuICAgICAqIC8vID0+IDJcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBmaW5kSW5kZXgoYXJyYXksIHByZWRpY2F0ZSwgZnJvbUluZGV4KSB7XG4gICAgICB2YXIgbGVuZ3RoID0gYXJyYXkgPT0gbnVsbCA/IDAgOiBhcnJheS5sZW5ndGg7XG4gICAgICBpZiAoIWxlbmd0aCkge1xuICAgICAgICByZXR1cm4gLTE7XG4gICAgICB9XG4gICAgICB2YXIgaW5kZXggPSBmcm9tSW5kZXggPT0gbnVsbCA/IDAgOiB0b0ludGVnZXIoZnJvbUluZGV4KTtcbiAgICAgIGlmIChpbmRleCA8IDApIHtcbiAgICAgICAgaW5kZXggPSBuYXRpdmVNYXgobGVuZ3RoICsgaW5kZXgsIDApO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGJhc2VGaW5kSW5kZXgoYXJyYXksIGdldEl0ZXJhdGVlKHByZWRpY2F0ZSwgMyksIGluZGV4KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGlzIG1ldGhvZCBpcyBsaWtlIGBfLmZpbmRJbmRleGAgZXhjZXB0IHRoYXQgaXQgaXRlcmF0ZXMgb3ZlciBlbGVtZW50c1xuICAgICAqIG9mIGBjb2xsZWN0aW9uYCBmcm9tIHJpZ2h0IHRvIGxlZnQuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMi4wLjBcbiAgICAgKiBAY2F0ZWdvcnkgQXJyYXlcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBhcnJheSBUaGUgYXJyYXkgdG8gaW5zcGVjdC5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbcHJlZGljYXRlPV8uaWRlbnRpdHldIFRoZSBmdW5jdGlvbiBpbnZva2VkIHBlciBpdGVyYXRpb24uXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtmcm9tSW5kZXg9YXJyYXkubGVuZ3RoLTFdIFRoZSBpbmRleCB0byBzZWFyY2ggZnJvbS5cbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSBSZXR1cm5zIHRoZSBpbmRleCBvZiB0aGUgZm91bmQgZWxlbWVudCwgZWxzZSBgLTFgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiB2YXIgdXNlcnMgPSBbXG4gICAgICogICB7ICd1c2VyJzogJ2Jhcm5leScsICAnYWN0aXZlJzogdHJ1ZSB9LFxuICAgICAqICAgeyAndXNlcic6ICdmcmVkJywgICAgJ2FjdGl2ZSc6IGZhbHNlIH0sXG4gICAgICogICB7ICd1c2VyJzogJ3BlYmJsZXMnLCAnYWN0aXZlJzogZmFsc2UgfVxuICAgICAqIF07XG4gICAgICpcbiAgICAgKiBfLmZpbmRMYXN0SW5kZXgodXNlcnMsIGZ1bmN0aW9uKG8pIHsgcmV0dXJuIG8udXNlciA9PSAncGViYmxlcyc7IH0pO1xuICAgICAqIC8vID0+IDJcbiAgICAgKlxuICAgICAqIC8vIFRoZSBgXy5tYXRjaGVzYCBpdGVyYXRlZSBzaG9ydGhhbmQuXG4gICAgICogXy5maW5kTGFzdEluZGV4KHVzZXJzLCB7ICd1c2VyJzogJ2Jhcm5leScsICdhY3RpdmUnOiB0cnVlIH0pO1xuICAgICAqIC8vID0+IDBcbiAgICAgKlxuICAgICAqIC8vIFRoZSBgXy5tYXRjaGVzUHJvcGVydHlgIGl0ZXJhdGVlIHNob3J0aGFuZC5cbiAgICAgKiBfLmZpbmRMYXN0SW5kZXgodXNlcnMsIFsnYWN0aXZlJywgZmFsc2VdKTtcbiAgICAgKiAvLyA9PiAyXG4gICAgICpcbiAgICAgKiAvLyBUaGUgYF8ucHJvcGVydHlgIGl0ZXJhdGVlIHNob3J0aGFuZC5cbiAgICAgKiBfLmZpbmRMYXN0SW5kZXgodXNlcnMsICdhY3RpdmUnKTtcbiAgICAgKiAvLyA9PiAwXG4gICAgICovXG4gICAgZnVuY3Rpb24gZmluZExhc3RJbmRleChhcnJheSwgcHJlZGljYXRlLCBmcm9tSW5kZXgpIHtcbiAgICAgIHZhciBsZW5ndGggPSBhcnJheSA9PSBudWxsID8gMCA6IGFycmF5Lmxlbmd0aDtcbiAgICAgIGlmICghbGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICAgIH1cbiAgICAgIHZhciBpbmRleCA9IGxlbmd0aCAtIDE7XG4gICAgICBpZiAoZnJvbUluZGV4ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgaW5kZXggPSB0b0ludGVnZXIoZnJvbUluZGV4KTtcbiAgICAgICAgaW5kZXggPSBmcm9tSW5kZXggPCAwXG4gICAgICAgICAgPyBuYXRpdmVNYXgobGVuZ3RoICsgaW5kZXgsIDApXG4gICAgICAgICAgOiBuYXRpdmVNaW4oaW5kZXgsIGxlbmd0aCAtIDEpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGJhc2VGaW5kSW5kZXgoYXJyYXksIGdldEl0ZXJhdGVlKHByZWRpY2F0ZSwgMyksIGluZGV4LCB0cnVlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBGbGF0dGVucyBgYXJyYXlgIGEgc2luZ2xlIGxldmVsIGRlZXAuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMC4xLjBcbiAgICAgKiBAY2F0ZWdvcnkgQXJyYXlcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBhcnJheSBUaGUgYXJyYXkgdG8gZmxhdHRlbi5cbiAgICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgdGhlIG5ldyBmbGF0dGVuZWQgYXJyYXkuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8uZmxhdHRlbihbMSwgWzIsIFszLCBbNF1dLCA1XV0pO1xuICAgICAqIC8vID0+IFsxLCAyLCBbMywgWzRdXSwgNV1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBmbGF0dGVuKGFycmF5KSB7XG4gICAgICB2YXIgbGVuZ3RoID0gYXJyYXkgPT0gbnVsbCA/IDAgOiBhcnJheS5sZW5ndGg7XG4gICAgICByZXR1cm4gbGVuZ3RoID8gYmFzZUZsYXR0ZW4oYXJyYXksIDEpIDogW107XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVjdXJzaXZlbHkgZmxhdHRlbnMgYGFycmF5YC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAzLjAuMFxuICAgICAqIEBjYXRlZ29yeSBBcnJheVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGFycmF5IFRoZSBhcnJheSB0byBmbGF0dGVuLlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgbmV3IGZsYXR0ZW5lZCBhcnJheS5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5mbGF0dGVuRGVlcChbMSwgWzIsIFszLCBbNF1dLCA1XV0pO1xuICAgICAqIC8vID0+IFsxLCAyLCAzLCA0LCA1XVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGZsYXR0ZW5EZWVwKGFycmF5KSB7XG4gICAgICB2YXIgbGVuZ3RoID0gYXJyYXkgPT0gbnVsbCA/IDAgOiBhcnJheS5sZW5ndGg7XG4gICAgICByZXR1cm4gbGVuZ3RoID8gYmFzZUZsYXR0ZW4oYXJyYXksIElORklOSVRZKSA6IFtdO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlY3Vyc2l2ZWx5IGZsYXR0ZW4gYGFycmF5YCB1cCB0byBgZGVwdGhgIHRpbWVzLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDQuNC4wXG4gICAgICogQGNhdGVnb3J5IEFycmF5XG4gICAgICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIGFycmF5IHRvIGZsYXR0ZW4uXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtkZXB0aD0xXSBUaGUgbWF4aW11bSByZWN1cnNpb24gZGVwdGguXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIHRoZSBuZXcgZmxhdHRlbmVkIGFycmF5LlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiB2YXIgYXJyYXkgPSBbMSwgWzIsIFszLCBbNF1dLCA1XV07XG4gICAgICpcbiAgICAgKiBfLmZsYXR0ZW5EZXB0aChhcnJheSwgMSk7XG4gICAgICogLy8gPT4gWzEsIDIsIFszLCBbNF1dLCA1XVxuICAgICAqXG4gICAgICogXy5mbGF0dGVuRGVwdGgoYXJyYXksIDIpO1xuICAgICAqIC8vID0+IFsxLCAyLCAzLCBbNF0sIDVdXG4gICAgICovXG4gICAgZnVuY3Rpb24gZmxhdHRlbkRlcHRoKGFycmF5LCBkZXB0aCkge1xuICAgICAgdmFyIGxlbmd0aCA9IGFycmF5ID09IG51bGwgPyAwIDogYXJyYXkubGVuZ3RoO1xuICAgICAgaWYgKCFsZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgfVxuICAgICAgZGVwdGggPSBkZXB0aCA9PT0gdW5kZWZpbmVkID8gMSA6IHRvSW50ZWdlcihkZXB0aCk7XG4gICAgICByZXR1cm4gYmFzZUZsYXR0ZW4oYXJyYXksIGRlcHRoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgaW52ZXJzZSBvZiBgXy50b1BhaXJzYDsgdGhpcyBtZXRob2QgcmV0dXJucyBhbiBvYmplY3QgY29tcG9zZWRcbiAgICAgKiBmcm9tIGtleS12YWx1ZSBgcGFpcnNgLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDQuMC4wXG4gICAgICogQGNhdGVnb3J5IEFycmF5XG4gICAgICogQHBhcmFtIHtBcnJheX0gcGFpcnMgVGhlIGtleS12YWx1ZSBwYWlycy5cbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIHRoZSBuZXcgb2JqZWN0LlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLmZyb21QYWlycyhbWydhJywgMV0sIFsnYicsIDJdXSk7XG4gICAgICogLy8gPT4geyAnYSc6IDEsICdiJzogMiB9XG4gICAgICovXG4gICAgZnVuY3Rpb24gZnJvbVBhaXJzKHBhaXJzKSB7XG4gICAgICB2YXIgaW5kZXggPSAtMSxcbiAgICAgICAgICBsZW5ndGggPSBwYWlycyA9PSBudWxsID8gMCA6IHBhaXJzLmxlbmd0aCxcbiAgICAgICAgICByZXN1bHQgPSB7fTtcblxuICAgICAgd2hpbGUgKCsraW5kZXggPCBsZW5ndGgpIHtcbiAgICAgICAgdmFyIHBhaXIgPSBwYWlyc1tpbmRleF07XG4gICAgICAgIHJlc3VsdFtwYWlyWzBdXSA9IHBhaXJbMV07XG4gICAgICB9XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIGZpcnN0IGVsZW1lbnQgb2YgYGFycmF5YC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAwLjEuMFxuICAgICAqIEBhbGlhcyBmaXJzdFxuICAgICAqIEBjYXRlZ29yeSBBcnJheVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGFycmF5IFRoZSBhcnJheSB0byBxdWVyeS5cbiAgICAgKiBAcmV0dXJucyB7Kn0gUmV0dXJucyB0aGUgZmlyc3QgZWxlbWVudCBvZiBgYXJyYXlgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLmhlYWQoWzEsIDIsIDNdKTtcbiAgICAgKiAvLyA9PiAxXG4gICAgICpcbiAgICAgKiBfLmhlYWQoW10pO1xuICAgICAqIC8vID0+IHVuZGVmaW5lZFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGhlYWQoYXJyYXkpIHtcbiAgICAgIHJldHVybiAoYXJyYXkgJiYgYXJyYXkubGVuZ3RoKSA/IGFycmF5WzBdIDogdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIGluZGV4IGF0IHdoaWNoIHRoZSBmaXJzdCBvY2N1cnJlbmNlIG9mIGB2YWx1ZWAgaXMgZm91bmQgaW4gYGFycmF5YFxuICAgICAqIHVzaW5nIFtgU2FtZVZhbHVlWmVyb2BdKGh0dHA6Ly9lY21hLWludGVybmF0aW9uYWwub3JnL2VjbWEtMjYyLzcuMC8jc2VjLXNhbWV2YWx1ZXplcm8pXG4gICAgICogZm9yIGVxdWFsaXR5IGNvbXBhcmlzb25zLiBJZiBgZnJvbUluZGV4YCBpcyBuZWdhdGl2ZSwgaXQncyB1c2VkIGFzIHRoZVxuICAgICAqIG9mZnNldCBmcm9tIHRoZSBlbmQgb2YgYGFycmF5YC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAwLjEuMFxuICAgICAqIEBjYXRlZ29yeSBBcnJheVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGFycmF5IFRoZSBhcnJheSB0byBpbnNwZWN0LlxuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIHNlYXJjaCBmb3IuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtmcm9tSW5kZXg9MF0gVGhlIGluZGV4IHRvIHNlYXJjaCBmcm9tLlxuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IFJldHVybnMgdGhlIGluZGV4IG9mIHRoZSBtYXRjaGVkIHZhbHVlLCBlbHNlIGAtMWAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8uaW5kZXhPZihbMSwgMiwgMSwgMl0sIDIpO1xuICAgICAqIC8vID0+IDFcbiAgICAgKlxuICAgICAqIC8vIFNlYXJjaCBmcm9tIHRoZSBgZnJvbUluZGV4YC5cbiAgICAgKiBfLmluZGV4T2YoWzEsIDIsIDEsIDJdLCAyLCAyKTtcbiAgICAgKiAvLyA9PiAzXG4gICAgICovXG4gICAgZnVuY3Rpb24gaW5kZXhPZihhcnJheSwgdmFsdWUsIGZyb21JbmRleCkge1xuICAgICAgdmFyIGxlbmd0aCA9IGFycmF5ID09IG51bGwgPyAwIDogYXJyYXkubGVuZ3RoO1xuICAgICAgaWYgKCFsZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgfVxuICAgICAgdmFyIGluZGV4ID0gZnJvbUluZGV4ID09IG51bGwgPyAwIDogdG9JbnRlZ2VyKGZyb21JbmRleCk7XG4gICAgICBpZiAoaW5kZXggPCAwKSB7XG4gICAgICAgIGluZGV4ID0gbmF0aXZlTWF4KGxlbmd0aCArIGluZGV4LCAwKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBiYXNlSW5kZXhPZihhcnJheSwgdmFsdWUsIGluZGV4KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXRzIGFsbCBidXQgdGhlIGxhc3QgZWxlbWVudCBvZiBgYXJyYXlgLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDAuMS4wXG4gICAgICogQGNhdGVnb3J5IEFycmF5XG4gICAgICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIGFycmF5IHRvIHF1ZXJ5LlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgc2xpY2Ugb2YgYGFycmF5YC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5pbml0aWFsKFsxLCAyLCAzXSk7XG4gICAgICogLy8gPT4gWzEsIDJdXG4gICAgICovXG4gICAgZnVuY3Rpb24gaW5pdGlhbChhcnJheSkge1xuICAgICAgdmFyIGxlbmd0aCA9IGFycmF5ID09IG51bGwgPyAwIDogYXJyYXkubGVuZ3RoO1xuICAgICAgcmV0dXJuIGxlbmd0aCA/IGJhc2VTbGljZShhcnJheSwgMCwgLTEpIDogW107XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbiBhcnJheSBvZiB1bmlxdWUgdmFsdWVzIHRoYXQgYXJlIGluY2x1ZGVkIGluIGFsbCBnaXZlbiBhcnJheXNcbiAgICAgKiB1c2luZyBbYFNhbWVWYWx1ZVplcm9gXShodHRwOi8vZWNtYS1pbnRlcm5hdGlvbmFsLm9yZy9lY21hLTI2Mi83LjAvI3NlYy1zYW1ldmFsdWV6ZXJvKVxuICAgICAqIGZvciBlcXVhbGl0eSBjb21wYXJpc29ucy4gVGhlIG9yZGVyIGFuZCByZWZlcmVuY2VzIG9mIHJlc3VsdCB2YWx1ZXMgYXJlXG4gICAgICogZGV0ZXJtaW5lZCBieSB0aGUgZmlyc3QgYXJyYXkuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMC4xLjBcbiAgICAgKiBAY2F0ZWdvcnkgQXJyYXlcbiAgICAgKiBAcGFyYW0gey4uLkFycmF5fSBbYXJyYXlzXSBUaGUgYXJyYXlzIHRvIGluc3BlY3QuXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIHRoZSBuZXcgYXJyYXkgb2YgaW50ZXJzZWN0aW5nIHZhbHVlcy5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5pbnRlcnNlY3Rpb24oWzIsIDFdLCBbMiwgM10pO1xuICAgICAqIC8vID0+IFsyXVxuICAgICAqL1xuICAgIHZhciBpbnRlcnNlY3Rpb24gPSBiYXNlUmVzdChmdW5jdGlvbihhcnJheXMpIHtcbiAgICAgIHZhciBtYXBwZWQgPSBhcnJheU1hcChhcnJheXMsIGNhc3RBcnJheUxpa2VPYmplY3QpO1xuICAgICAgcmV0dXJuIChtYXBwZWQubGVuZ3RoICYmIG1hcHBlZFswXSA9PT0gYXJyYXlzWzBdKVxuICAgICAgICA/IGJhc2VJbnRlcnNlY3Rpb24obWFwcGVkKVxuICAgICAgICA6IFtdO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogVGhpcyBtZXRob2QgaXMgbGlrZSBgXy5pbnRlcnNlY3Rpb25gIGV4Y2VwdCB0aGF0IGl0IGFjY2VwdHMgYGl0ZXJhdGVlYFxuICAgICAqIHdoaWNoIGlzIGludm9rZWQgZm9yIGVhY2ggZWxlbWVudCBvZiBlYWNoIGBhcnJheXNgIHRvIGdlbmVyYXRlIHRoZSBjcml0ZXJpb25cbiAgICAgKiBieSB3aGljaCB0aGV5J3JlIGNvbXBhcmVkLiBUaGUgb3JkZXIgYW5kIHJlZmVyZW5jZXMgb2YgcmVzdWx0IHZhbHVlcyBhcmVcbiAgICAgKiBkZXRlcm1pbmVkIGJ5IHRoZSBmaXJzdCBhcnJheS4gVGhlIGl0ZXJhdGVlIGlzIGludm9rZWQgd2l0aCBvbmUgYXJndW1lbnQ6XG4gICAgICogKHZhbHVlKS5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSA0LjAuMFxuICAgICAqIEBjYXRlZ29yeSBBcnJheVxuICAgICAqIEBwYXJhbSB7Li4uQXJyYXl9IFthcnJheXNdIFRoZSBhcnJheXMgdG8gaW5zcGVjdC5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbaXRlcmF0ZWU9Xy5pZGVudGl0eV0gVGhlIGl0ZXJhdGVlIGludm9rZWQgcGVyIGVsZW1lbnQuXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIHRoZSBuZXcgYXJyYXkgb2YgaW50ZXJzZWN0aW5nIHZhbHVlcy5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5pbnRlcnNlY3Rpb25CeShbMi4xLCAxLjJdLCBbMi4zLCAzLjRdLCBNYXRoLmZsb29yKTtcbiAgICAgKiAvLyA9PiBbMi4xXVxuICAgICAqXG4gICAgICogLy8gVGhlIGBfLnByb3BlcnR5YCBpdGVyYXRlZSBzaG9ydGhhbmQuXG4gICAgICogXy5pbnRlcnNlY3Rpb25CeShbeyAneCc6IDEgfV0sIFt7ICd4JzogMiB9LCB7ICd4JzogMSB9XSwgJ3gnKTtcbiAgICAgKiAvLyA9PiBbeyAneCc6IDEgfV1cbiAgICAgKi9cbiAgICB2YXIgaW50ZXJzZWN0aW9uQnkgPSBiYXNlUmVzdChmdW5jdGlvbihhcnJheXMpIHtcbiAgICAgIHZhciBpdGVyYXRlZSA9IGxhc3QoYXJyYXlzKSxcbiAgICAgICAgICBtYXBwZWQgPSBhcnJheU1hcChhcnJheXMsIGNhc3RBcnJheUxpa2VPYmplY3QpO1xuXG4gICAgICBpZiAoaXRlcmF0ZWUgPT09IGxhc3QobWFwcGVkKSkge1xuICAgICAgICBpdGVyYXRlZSA9IHVuZGVmaW5lZDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG1hcHBlZC5wb3AoKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiAobWFwcGVkLmxlbmd0aCAmJiBtYXBwZWRbMF0gPT09IGFycmF5c1swXSlcbiAgICAgICAgPyBiYXNlSW50ZXJzZWN0aW9uKG1hcHBlZCwgZ2V0SXRlcmF0ZWUoaXRlcmF0ZWUsIDIpKVxuICAgICAgICA6IFtdO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogVGhpcyBtZXRob2QgaXMgbGlrZSBgXy5pbnRlcnNlY3Rpb25gIGV4Y2VwdCB0aGF0IGl0IGFjY2VwdHMgYGNvbXBhcmF0b3JgXG4gICAgICogd2hpY2ggaXMgaW52b2tlZCB0byBjb21wYXJlIGVsZW1lbnRzIG9mIGBhcnJheXNgLiBUaGUgb3JkZXIgYW5kIHJlZmVyZW5jZXNcbiAgICAgKiBvZiByZXN1bHQgdmFsdWVzIGFyZSBkZXRlcm1pbmVkIGJ5IHRoZSBmaXJzdCBhcnJheS4gVGhlIGNvbXBhcmF0b3IgaXNcbiAgICAgKiBpbnZva2VkIHdpdGggdHdvIGFyZ3VtZW50czogKGFyclZhbCwgb3RoVmFsKS5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSA0LjAuMFxuICAgICAqIEBjYXRlZ29yeSBBcnJheVxuICAgICAqIEBwYXJhbSB7Li4uQXJyYXl9IFthcnJheXNdIFRoZSBhcnJheXMgdG8gaW5zcGVjdC5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbY29tcGFyYXRvcl0gVGhlIGNvbXBhcmF0b3IgaW52b2tlZCBwZXIgZWxlbWVudC5cbiAgICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgdGhlIG5ldyBhcnJheSBvZiBpbnRlcnNlY3RpbmcgdmFsdWVzLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiB2YXIgb2JqZWN0cyA9IFt7ICd4JzogMSwgJ3knOiAyIH0sIHsgJ3gnOiAyLCAneSc6IDEgfV07XG4gICAgICogdmFyIG90aGVycyA9IFt7ICd4JzogMSwgJ3knOiAxIH0sIHsgJ3gnOiAxLCAneSc6IDIgfV07XG4gICAgICpcbiAgICAgKiBfLmludGVyc2VjdGlvbldpdGgob2JqZWN0cywgb3RoZXJzLCBfLmlzRXF1YWwpO1xuICAgICAqIC8vID0+IFt7ICd4JzogMSwgJ3knOiAyIH1dXG4gICAgICovXG4gICAgdmFyIGludGVyc2VjdGlvbldpdGggPSBiYXNlUmVzdChmdW5jdGlvbihhcnJheXMpIHtcbiAgICAgIHZhciBjb21wYXJhdG9yID0gbGFzdChhcnJheXMpLFxuICAgICAgICAgIG1hcHBlZCA9IGFycmF5TWFwKGFycmF5cywgY2FzdEFycmF5TGlrZU9iamVjdCk7XG5cbiAgICAgIGNvbXBhcmF0b3IgPSB0eXBlb2YgY29tcGFyYXRvciA9PSAnZnVuY3Rpb24nID8gY29tcGFyYXRvciA6IHVuZGVmaW5lZDtcbiAgICAgIGlmIChjb21wYXJhdG9yKSB7XG4gICAgICAgIG1hcHBlZC5wb3AoKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiAobWFwcGVkLmxlbmd0aCAmJiBtYXBwZWRbMF0gPT09IGFycmF5c1swXSlcbiAgICAgICAgPyBiYXNlSW50ZXJzZWN0aW9uKG1hcHBlZCwgdW5kZWZpbmVkLCBjb21wYXJhdG9yKVxuICAgICAgICA6IFtdO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogQ29udmVydHMgYWxsIGVsZW1lbnRzIGluIGBhcnJheWAgaW50byBhIHN0cmluZyBzZXBhcmF0ZWQgYnkgYHNlcGFyYXRvcmAuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgNC4wLjBcbiAgICAgKiBAY2F0ZWdvcnkgQXJyYXlcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBhcnJheSBUaGUgYXJyYXkgdG8gY29udmVydC5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gW3NlcGFyYXRvcj0nLCddIFRoZSBlbGVtZW50IHNlcGFyYXRvci5cbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSBSZXR1cm5zIHRoZSBqb2luZWQgc3RyaW5nLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLmpvaW4oWydhJywgJ2InLCAnYyddLCAnficpO1xuICAgICAqIC8vID0+ICdhfmJ+YydcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBqb2luKGFycmF5LCBzZXBhcmF0b3IpIHtcbiAgICAgIHJldHVybiBhcnJheSA9PSBudWxsID8gJycgOiBuYXRpdmVKb2luLmNhbGwoYXJyYXksIHNlcGFyYXRvcik7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgbGFzdCBlbGVtZW50IG9mIGBhcnJheWAuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMC4xLjBcbiAgICAgKiBAY2F0ZWdvcnkgQXJyYXlcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBhcnJheSBUaGUgYXJyYXkgdG8gcXVlcnkuXG4gICAgICogQHJldHVybnMgeyp9IFJldHVybnMgdGhlIGxhc3QgZWxlbWVudCBvZiBgYXJyYXlgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLmxhc3QoWzEsIDIsIDNdKTtcbiAgICAgKiAvLyA9PiAzXG4gICAgICovXG4gICAgZnVuY3Rpb24gbGFzdChhcnJheSkge1xuICAgICAgdmFyIGxlbmd0aCA9IGFycmF5ID09IG51bGwgPyAwIDogYXJyYXkubGVuZ3RoO1xuICAgICAgcmV0dXJuIGxlbmd0aCA/IGFycmF5W2xlbmd0aCAtIDFdIDogdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoaXMgbWV0aG9kIGlzIGxpa2UgYF8uaW5kZXhPZmAgZXhjZXB0IHRoYXQgaXQgaXRlcmF0ZXMgb3ZlciBlbGVtZW50cyBvZlxuICAgICAqIGBhcnJheWAgZnJvbSByaWdodCB0byBsZWZ0LlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDAuMS4wXG4gICAgICogQGNhdGVnb3J5IEFycmF5XG4gICAgICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIGFycmF5IHRvIGluc3BlY3QuXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gc2VhcmNoIGZvci5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW2Zyb21JbmRleD1hcnJheS5sZW5ndGgtMV0gVGhlIGluZGV4IHRvIHNlYXJjaCBmcm9tLlxuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IFJldHVybnMgdGhlIGluZGV4IG9mIHRoZSBtYXRjaGVkIHZhbHVlLCBlbHNlIGAtMWAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8ubGFzdEluZGV4T2YoWzEsIDIsIDEsIDJdLCAyKTtcbiAgICAgKiAvLyA9PiAzXG4gICAgICpcbiAgICAgKiAvLyBTZWFyY2ggZnJvbSB0aGUgYGZyb21JbmRleGAuXG4gICAgICogXy5sYXN0SW5kZXhPZihbMSwgMiwgMSwgMl0sIDIsIDIpO1xuICAgICAqIC8vID0+IDFcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBsYXN0SW5kZXhPZihhcnJheSwgdmFsdWUsIGZyb21JbmRleCkge1xuICAgICAgdmFyIGxlbmd0aCA9IGFycmF5ID09IG51bGwgPyAwIDogYXJyYXkubGVuZ3RoO1xuICAgICAgaWYgKCFsZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgfVxuICAgICAgdmFyIGluZGV4ID0gbGVuZ3RoO1xuICAgICAgaWYgKGZyb21JbmRleCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGluZGV4ID0gdG9JbnRlZ2VyKGZyb21JbmRleCk7XG4gICAgICAgIGluZGV4ID0gaW5kZXggPCAwID8gbmF0aXZlTWF4KGxlbmd0aCArIGluZGV4LCAwKSA6IG5hdGl2ZU1pbihpbmRleCwgbGVuZ3RoIC0gMSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gdmFsdWUgPT09IHZhbHVlXG4gICAgICAgID8gc3RyaWN0TGFzdEluZGV4T2YoYXJyYXksIHZhbHVlLCBpbmRleClcbiAgICAgICAgOiBiYXNlRmluZEluZGV4KGFycmF5LCBiYXNlSXNOYU4sIGluZGV4LCB0cnVlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBlbGVtZW50IGF0IGluZGV4IGBuYCBvZiBgYXJyYXlgLiBJZiBgbmAgaXMgbmVnYXRpdmUsIHRoZSBudGhcbiAgICAgKiBlbGVtZW50IGZyb20gdGhlIGVuZCBpcyByZXR1cm5lZC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSA0LjExLjBcbiAgICAgKiBAY2F0ZWdvcnkgQXJyYXlcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBhcnJheSBUaGUgYXJyYXkgdG8gcXVlcnkuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtuPTBdIFRoZSBpbmRleCBvZiB0aGUgZWxlbWVudCB0byByZXR1cm4uXG4gICAgICogQHJldHVybnMgeyp9IFJldHVybnMgdGhlIG50aCBlbGVtZW50IG9mIGBhcnJheWAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciBhcnJheSA9IFsnYScsICdiJywgJ2MnLCAnZCddO1xuICAgICAqXG4gICAgICogXy5udGgoYXJyYXksIDEpO1xuICAgICAqIC8vID0+ICdiJ1xuICAgICAqXG4gICAgICogXy5udGgoYXJyYXksIC0yKTtcbiAgICAgKiAvLyA9PiAnYyc7XG4gICAgICovXG4gICAgZnVuY3Rpb24gbnRoKGFycmF5LCBuKSB7XG4gICAgICByZXR1cm4gKGFycmF5ICYmIGFycmF5Lmxlbmd0aCkgPyBiYXNlTnRoKGFycmF5LCB0b0ludGVnZXIobikpIDogdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlbW92ZXMgYWxsIGdpdmVuIHZhbHVlcyBmcm9tIGBhcnJheWAgdXNpbmdcbiAgICAgKiBbYFNhbWVWYWx1ZVplcm9gXShodHRwOi8vZWNtYS1pbnRlcm5hdGlvbmFsLm9yZy9lY21hLTI2Mi83LjAvI3NlYy1zYW1ldmFsdWV6ZXJvKVxuICAgICAqIGZvciBlcXVhbGl0eSBjb21wYXJpc29ucy5cbiAgICAgKlxuICAgICAqICoqTm90ZToqKiBVbmxpa2UgYF8ud2l0aG91dGAsIHRoaXMgbWV0aG9kIG11dGF0ZXMgYGFycmF5YC4gVXNlIGBfLnJlbW92ZWBcbiAgICAgKiB0byByZW1vdmUgZWxlbWVudHMgZnJvbSBhbiBhcnJheSBieSBwcmVkaWNhdGUuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMi4wLjBcbiAgICAgKiBAY2F0ZWdvcnkgQXJyYXlcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBhcnJheSBUaGUgYXJyYXkgdG8gbW9kaWZ5LlxuICAgICAqIEBwYXJhbSB7Li4uKn0gW3ZhbHVlc10gVGhlIHZhbHVlcyB0byByZW1vdmUuXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIGBhcnJheWAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciBhcnJheSA9IFsnYScsICdiJywgJ2MnLCAnYScsICdiJywgJ2MnXTtcbiAgICAgKlxuICAgICAqIF8ucHVsbChhcnJheSwgJ2EnLCAnYycpO1xuICAgICAqIGNvbnNvbGUubG9nKGFycmF5KTtcbiAgICAgKiAvLyA9PiBbJ2InLCAnYiddXG4gICAgICovXG4gICAgdmFyIHB1bGwgPSBiYXNlUmVzdChwdWxsQWxsKTtcblxuICAgIC8qKlxuICAgICAqIFRoaXMgbWV0aG9kIGlzIGxpa2UgYF8ucHVsbGAgZXhjZXB0IHRoYXQgaXQgYWNjZXB0cyBhbiBhcnJheSBvZiB2YWx1ZXMgdG8gcmVtb3ZlLlxuICAgICAqXG4gICAgICogKipOb3RlOioqIFVubGlrZSBgXy5kaWZmZXJlbmNlYCwgdGhpcyBtZXRob2QgbXV0YXRlcyBgYXJyYXlgLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDQuMC4wXG4gICAgICogQGNhdGVnb3J5IEFycmF5XG4gICAgICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIGFycmF5IHRvIG1vZGlmeS5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSB2YWx1ZXMgVGhlIHZhbHVlcyB0byByZW1vdmUuXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIGBhcnJheWAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciBhcnJheSA9IFsnYScsICdiJywgJ2MnLCAnYScsICdiJywgJ2MnXTtcbiAgICAgKlxuICAgICAqIF8ucHVsbEFsbChhcnJheSwgWydhJywgJ2MnXSk7XG4gICAgICogY29uc29sZS5sb2coYXJyYXkpO1xuICAgICAqIC8vID0+IFsnYicsICdiJ11cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBwdWxsQWxsKGFycmF5LCB2YWx1ZXMpIHtcbiAgICAgIHJldHVybiAoYXJyYXkgJiYgYXJyYXkubGVuZ3RoICYmIHZhbHVlcyAmJiB2YWx1ZXMubGVuZ3RoKVxuICAgICAgICA/IGJhc2VQdWxsQWxsKGFycmF5LCB2YWx1ZXMpXG4gICAgICAgIDogYXJyYXk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhpcyBtZXRob2QgaXMgbGlrZSBgXy5wdWxsQWxsYCBleGNlcHQgdGhhdCBpdCBhY2NlcHRzIGBpdGVyYXRlZWAgd2hpY2ggaXNcbiAgICAgKiBpbnZva2VkIGZvciBlYWNoIGVsZW1lbnQgb2YgYGFycmF5YCBhbmQgYHZhbHVlc2AgdG8gZ2VuZXJhdGUgdGhlIGNyaXRlcmlvblxuICAgICAqIGJ5IHdoaWNoIHRoZXkncmUgY29tcGFyZWQuIFRoZSBpdGVyYXRlZSBpcyBpbnZva2VkIHdpdGggb25lIGFyZ3VtZW50OiAodmFsdWUpLlxuICAgICAqXG4gICAgICogKipOb3RlOioqIFVubGlrZSBgXy5kaWZmZXJlbmNlQnlgLCB0aGlzIG1ldGhvZCBtdXRhdGVzIGBhcnJheWAuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgNC4wLjBcbiAgICAgKiBAY2F0ZWdvcnkgQXJyYXlcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBhcnJheSBUaGUgYXJyYXkgdG8gbW9kaWZ5LlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IHZhbHVlcyBUaGUgdmFsdWVzIHRvIHJlbW92ZS5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbaXRlcmF0ZWU9Xy5pZGVudGl0eV0gVGhlIGl0ZXJhdGVlIGludm9rZWQgcGVyIGVsZW1lbnQuXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIGBhcnJheWAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciBhcnJheSA9IFt7ICd4JzogMSB9LCB7ICd4JzogMiB9LCB7ICd4JzogMyB9LCB7ICd4JzogMSB9XTtcbiAgICAgKlxuICAgICAqIF8ucHVsbEFsbEJ5KGFycmF5LCBbeyAneCc6IDEgfSwgeyAneCc6IDMgfV0sICd4Jyk7XG4gICAgICogY29uc29sZS5sb2coYXJyYXkpO1xuICAgICAqIC8vID0+IFt7ICd4JzogMiB9XVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHB1bGxBbGxCeShhcnJheSwgdmFsdWVzLCBpdGVyYXRlZSkge1xuICAgICAgcmV0dXJuIChhcnJheSAmJiBhcnJheS5sZW5ndGggJiYgdmFsdWVzICYmIHZhbHVlcy5sZW5ndGgpXG4gICAgICAgID8gYmFzZVB1bGxBbGwoYXJyYXksIHZhbHVlcywgZ2V0SXRlcmF0ZWUoaXRlcmF0ZWUsIDIpKVxuICAgICAgICA6IGFycmF5O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoaXMgbWV0aG9kIGlzIGxpa2UgYF8ucHVsbEFsbGAgZXhjZXB0IHRoYXQgaXQgYWNjZXB0cyBgY29tcGFyYXRvcmAgd2hpY2hcbiAgICAgKiBpcyBpbnZva2VkIHRvIGNvbXBhcmUgZWxlbWVudHMgb2YgYGFycmF5YCB0byBgdmFsdWVzYC4gVGhlIGNvbXBhcmF0b3IgaXNcbiAgICAgKiBpbnZva2VkIHdpdGggdHdvIGFyZ3VtZW50czogKGFyclZhbCwgb3RoVmFsKS5cbiAgICAgKlxuICAgICAqICoqTm90ZToqKiBVbmxpa2UgYF8uZGlmZmVyZW5jZVdpdGhgLCB0aGlzIG1ldGhvZCBtdXRhdGVzIGBhcnJheWAuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgNC42LjBcbiAgICAgKiBAY2F0ZWdvcnkgQXJyYXlcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBhcnJheSBUaGUgYXJyYXkgdG8gbW9kaWZ5LlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IHZhbHVlcyBUaGUgdmFsdWVzIHRvIHJlbW92ZS5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbY29tcGFyYXRvcl0gVGhlIGNvbXBhcmF0b3IgaW52b2tlZCBwZXIgZWxlbWVudC5cbiAgICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgYGFycmF5YC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogdmFyIGFycmF5ID0gW3sgJ3gnOiAxLCAneSc6IDIgfSwgeyAneCc6IDMsICd5JzogNCB9LCB7ICd4JzogNSwgJ3knOiA2IH1dO1xuICAgICAqXG4gICAgICogXy5wdWxsQWxsV2l0aChhcnJheSwgW3sgJ3gnOiAzLCAneSc6IDQgfV0sIF8uaXNFcXVhbCk7XG4gICAgICogY29uc29sZS5sb2coYXJyYXkpO1xuICAgICAqIC8vID0+IFt7ICd4JzogMSwgJ3knOiAyIH0sIHsgJ3gnOiA1LCAneSc6IDYgfV1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBwdWxsQWxsV2l0aChhcnJheSwgdmFsdWVzLCBjb21wYXJhdG9yKSB7XG4gICAgICByZXR1cm4gKGFycmF5ICYmIGFycmF5Lmxlbmd0aCAmJiB2YWx1ZXMgJiYgdmFsdWVzLmxlbmd0aClcbiAgICAgICAgPyBiYXNlUHVsbEFsbChhcnJheSwgdmFsdWVzLCB1bmRlZmluZWQsIGNvbXBhcmF0b3IpXG4gICAgICAgIDogYXJyYXk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVtb3ZlcyBlbGVtZW50cyBmcm9tIGBhcnJheWAgY29ycmVzcG9uZGluZyB0byBgaW5kZXhlc2AgYW5kIHJldHVybnMgYW5cbiAgICAgKiBhcnJheSBvZiByZW1vdmVkIGVsZW1lbnRzLlxuICAgICAqXG4gICAgICogKipOb3RlOioqIFVubGlrZSBgXy5hdGAsIHRoaXMgbWV0aG9kIG11dGF0ZXMgYGFycmF5YC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAzLjAuMFxuICAgICAqIEBjYXRlZ29yeSBBcnJheVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGFycmF5IFRoZSBhcnJheSB0byBtb2RpZnkuXG4gICAgICogQHBhcmFtIHsuLi4obnVtYmVyfG51bWJlcltdKX0gW2luZGV4ZXNdIFRoZSBpbmRleGVzIG9mIGVsZW1lbnRzIHRvIHJlbW92ZS5cbiAgICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgdGhlIG5ldyBhcnJheSBvZiByZW1vdmVkIGVsZW1lbnRzLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiB2YXIgYXJyYXkgPSBbJ2EnLCAnYicsICdjJywgJ2QnXTtcbiAgICAgKiB2YXIgcHVsbGVkID0gXy5wdWxsQXQoYXJyYXksIFsxLCAzXSk7XG4gICAgICpcbiAgICAgKiBjb25zb2xlLmxvZyhhcnJheSk7XG4gICAgICogLy8gPT4gWydhJywgJ2MnXVxuICAgICAqXG4gICAgICogY29uc29sZS5sb2cocHVsbGVkKTtcbiAgICAgKiAvLyA9PiBbJ2InLCAnZCddXG4gICAgICovXG4gICAgdmFyIHB1bGxBdCA9IGZsYXRSZXN0KGZ1bmN0aW9uKGFycmF5LCBpbmRleGVzKSB7XG4gICAgICB2YXIgbGVuZ3RoID0gYXJyYXkgPT0gbnVsbCA/IDAgOiBhcnJheS5sZW5ndGgsXG4gICAgICAgICAgcmVzdWx0ID0gYmFzZUF0KGFycmF5LCBpbmRleGVzKTtcblxuICAgICAgYmFzZVB1bGxBdChhcnJheSwgYXJyYXlNYXAoaW5kZXhlcywgZnVuY3Rpb24oaW5kZXgpIHtcbiAgICAgICAgcmV0dXJuIGlzSW5kZXgoaW5kZXgsIGxlbmd0aCkgPyAraW5kZXggOiBpbmRleDtcbiAgICAgIH0pLnNvcnQoY29tcGFyZUFzY2VuZGluZykpO1xuXG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogUmVtb3ZlcyBhbGwgZWxlbWVudHMgZnJvbSBgYXJyYXlgIHRoYXQgYHByZWRpY2F0ZWAgcmV0dXJucyB0cnV0aHkgZm9yXG4gICAgICogYW5kIHJldHVybnMgYW4gYXJyYXkgb2YgdGhlIHJlbW92ZWQgZWxlbWVudHMuIFRoZSBwcmVkaWNhdGUgaXMgaW52b2tlZFxuICAgICAqIHdpdGggdGhyZWUgYXJndW1lbnRzOiAodmFsdWUsIGluZGV4LCBhcnJheSkuXG4gICAgICpcbiAgICAgKiAqKk5vdGU6KiogVW5saWtlIGBfLmZpbHRlcmAsIHRoaXMgbWV0aG9kIG11dGF0ZXMgYGFycmF5YC4gVXNlIGBfLnB1bGxgXG4gICAgICogdG8gcHVsbCBlbGVtZW50cyBmcm9tIGFuIGFycmF5IGJ5IHZhbHVlLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDIuMC4wXG4gICAgICogQGNhdGVnb3J5IEFycmF5XG4gICAgICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIGFycmF5IHRvIG1vZGlmeS5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbcHJlZGljYXRlPV8uaWRlbnRpdHldIFRoZSBmdW5jdGlvbiBpbnZva2VkIHBlciBpdGVyYXRpb24uXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIHRoZSBuZXcgYXJyYXkgb2YgcmVtb3ZlZCBlbGVtZW50cy5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogdmFyIGFycmF5ID0gWzEsIDIsIDMsIDRdO1xuICAgICAqIHZhciBldmVucyA9IF8ucmVtb3ZlKGFycmF5LCBmdW5jdGlvbihuKSB7XG4gICAgICogICByZXR1cm4gbiAlIDIgPT0gMDtcbiAgICAgKiB9KTtcbiAgICAgKlxuICAgICAqIGNvbnNvbGUubG9nKGFycmF5KTtcbiAgICAgKiAvLyA9PiBbMSwgM11cbiAgICAgKlxuICAgICAqIGNvbnNvbGUubG9nKGV2ZW5zKTtcbiAgICAgKiAvLyA9PiBbMiwgNF1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiByZW1vdmUoYXJyYXksIHByZWRpY2F0ZSkge1xuICAgICAgdmFyIHJlc3VsdCA9IFtdO1xuICAgICAgaWYgKCEoYXJyYXkgJiYgYXJyYXkubGVuZ3RoKSkge1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgfVxuICAgICAgdmFyIGluZGV4ID0gLTEsXG4gICAgICAgICAgaW5kZXhlcyA9IFtdLFxuICAgICAgICAgIGxlbmd0aCA9IGFycmF5Lmxlbmd0aDtcblxuICAgICAgcHJlZGljYXRlID0gZ2V0SXRlcmF0ZWUocHJlZGljYXRlLCAzKTtcbiAgICAgIHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IGFycmF5W2luZGV4XTtcbiAgICAgICAgaWYgKHByZWRpY2F0ZSh2YWx1ZSwgaW5kZXgsIGFycmF5KSkge1xuICAgICAgICAgIHJlc3VsdC5wdXNoKHZhbHVlKTtcbiAgICAgICAgICBpbmRleGVzLnB1c2goaW5kZXgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBiYXNlUHVsbEF0KGFycmF5LCBpbmRleGVzKTtcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV2ZXJzZXMgYGFycmF5YCBzbyB0aGF0IHRoZSBmaXJzdCBlbGVtZW50IGJlY29tZXMgdGhlIGxhc3QsIHRoZSBzZWNvbmRcbiAgICAgKiBlbGVtZW50IGJlY29tZXMgdGhlIHNlY29uZCB0byBsYXN0LCBhbmQgc28gb24uXG4gICAgICpcbiAgICAgKiAqKk5vdGU6KiogVGhpcyBtZXRob2QgbXV0YXRlcyBgYXJyYXlgIGFuZCBpcyBiYXNlZCBvblxuICAgICAqIFtgQXJyYXkjcmV2ZXJzZWBdKGh0dHBzOi8vbWRuLmlvL0FycmF5L3JldmVyc2UpLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDQuMC4wXG4gICAgICogQGNhdGVnb3J5IEFycmF5XG4gICAgICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIGFycmF5IHRvIG1vZGlmeS5cbiAgICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgYGFycmF5YC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogdmFyIGFycmF5ID0gWzEsIDIsIDNdO1xuICAgICAqXG4gICAgICogXy5yZXZlcnNlKGFycmF5KTtcbiAgICAgKiAvLyA9PiBbMywgMiwgMV1cbiAgICAgKlxuICAgICAqIGNvbnNvbGUubG9nKGFycmF5KTtcbiAgICAgKiAvLyA9PiBbMywgMiwgMV1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiByZXZlcnNlKGFycmF5KSB7XG4gICAgICByZXR1cm4gYXJyYXkgPT0gbnVsbCA/IGFycmF5IDogbmF0aXZlUmV2ZXJzZS5jYWxsKGFycmF5KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgc2xpY2Ugb2YgYGFycmF5YCBmcm9tIGBzdGFydGAgdXAgdG8sIGJ1dCBub3QgaW5jbHVkaW5nLCBgZW5kYC5cbiAgICAgKlxuICAgICAqICoqTm90ZToqKiBUaGlzIG1ldGhvZCBpcyB1c2VkIGluc3RlYWQgb2ZcbiAgICAgKiBbYEFycmF5I3NsaWNlYF0oaHR0cHM6Ly9tZG4uaW8vQXJyYXkvc2xpY2UpIHRvIGVuc3VyZSBkZW5zZSBhcnJheXMgYXJlXG4gICAgICogcmV0dXJuZWQuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMy4wLjBcbiAgICAgKiBAY2F0ZWdvcnkgQXJyYXlcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBhcnJheSBUaGUgYXJyYXkgdG8gc2xpY2UuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtzdGFydD0wXSBUaGUgc3RhcnQgcG9zaXRpb24uXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtlbmQ9YXJyYXkubGVuZ3RoXSBUaGUgZW5kIHBvc2l0aW9uLlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgc2xpY2Ugb2YgYGFycmF5YC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBzbGljZShhcnJheSwgc3RhcnQsIGVuZCkge1xuICAgICAgdmFyIGxlbmd0aCA9IGFycmF5ID09IG51bGwgPyAwIDogYXJyYXkubGVuZ3RoO1xuICAgICAgaWYgKCFsZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgfVxuICAgICAgaWYgKGVuZCAmJiB0eXBlb2YgZW5kICE9ICdudW1iZXInICYmIGlzSXRlcmF0ZWVDYWxsKGFycmF5LCBzdGFydCwgZW5kKSkge1xuICAgICAgICBzdGFydCA9IDA7XG4gICAgICAgIGVuZCA9IGxlbmd0aDtcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICBzdGFydCA9IHN0YXJ0ID09IG51bGwgPyAwIDogdG9JbnRlZ2VyKHN0YXJ0KTtcbiAgICAgICAgZW5kID0gZW5kID09PSB1bmRlZmluZWQgPyBsZW5ndGggOiB0b0ludGVnZXIoZW5kKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBiYXNlU2xpY2UoYXJyYXksIHN0YXJ0LCBlbmQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVzZXMgYSBiaW5hcnkgc2VhcmNoIHRvIGRldGVybWluZSB0aGUgbG93ZXN0IGluZGV4IGF0IHdoaWNoIGB2YWx1ZWBcbiAgICAgKiBzaG91bGQgYmUgaW5zZXJ0ZWQgaW50byBgYXJyYXlgIGluIG9yZGVyIHRvIG1haW50YWluIGl0cyBzb3J0IG9yZGVyLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDAuMS4wXG4gICAgICogQGNhdGVnb3J5IEFycmF5XG4gICAgICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIHNvcnRlZCBhcnJheSB0byBpbnNwZWN0LlxuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGV2YWx1YXRlLlxuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IFJldHVybnMgdGhlIGluZGV4IGF0IHdoaWNoIGB2YWx1ZWAgc2hvdWxkIGJlIGluc2VydGVkXG4gICAgICogIGludG8gYGFycmF5YC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5zb3J0ZWRJbmRleChbMzAsIDUwXSwgNDApO1xuICAgICAqIC8vID0+IDFcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBzb3J0ZWRJbmRleChhcnJheSwgdmFsdWUpIHtcbiAgICAgIHJldHVybiBiYXNlU29ydGVkSW5kZXgoYXJyYXksIHZhbHVlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGlzIG1ldGhvZCBpcyBsaWtlIGBfLnNvcnRlZEluZGV4YCBleGNlcHQgdGhhdCBpdCBhY2NlcHRzIGBpdGVyYXRlZWBcbiAgICAgKiB3aGljaCBpcyBpbnZva2VkIGZvciBgdmFsdWVgIGFuZCBlYWNoIGVsZW1lbnQgb2YgYGFycmF5YCB0byBjb21wdXRlIHRoZWlyXG4gICAgICogc29ydCByYW5raW5nLiBUaGUgaXRlcmF0ZWUgaXMgaW52b2tlZCB3aXRoIG9uZSBhcmd1bWVudDogKHZhbHVlKS5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSA0LjAuMFxuICAgICAqIEBjYXRlZ29yeSBBcnJheVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGFycmF5IFRoZSBzb3J0ZWQgYXJyYXkgdG8gaW5zcGVjdC5cbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBldmFsdWF0ZS5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbaXRlcmF0ZWU9Xy5pZGVudGl0eV0gVGhlIGl0ZXJhdGVlIGludm9rZWQgcGVyIGVsZW1lbnQuXG4gICAgICogQHJldHVybnMge251bWJlcn0gUmV0dXJucyB0aGUgaW5kZXggYXQgd2hpY2ggYHZhbHVlYCBzaG91bGQgYmUgaW5zZXJ0ZWRcbiAgICAgKiAgaW50byBgYXJyYXlgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiB2YXIgb2JqZWN0cyA9IFt7ICd4JzogNCB9LCB7ICd4JzogNSB9XTtcbiAgICAgKlxuICAgICAqIF8uc29ydGVkSW5kZXhCeShvYmplY3RzLCB7ICd4JzogNCB9LCBmdW5jdGlvbihvKSB7IHJldHVybiBvLng7IH0pO1xuICAgICAqIC8vID0+IDBcbiAgICAgKlxuICAgICAqIC8vIFRoZSBgXy5wcm9wZXJ0eWAgaXRlcmF0ZWUgc2hvcnRoYW5kLlxuICAgICAqIF8uc29ydGVkSW5kZXhCeShvYmplY3RzLCB7ICd4JzogNCB9LCAneCcpO1xuICAgICAqIC8vID0+IDBcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBzb3J0ZWRJbmRleEJ5KGFycmF5LCB2YWx1ZSwgaXRlcmF0ZWUpIHtcbiAgICAgIHJldHVybiBiYXNlU29ydGVkSW5kZXhCeShhcnJheSwgdmFsdWUsIGdldEl0ZXJhdGVlKGl0ZXJhdGVlLCAyKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhpcyBtZXRob2QgaXMgbGlrZSBgXy5pbmRleE9mYCBleGNlcHQgdGhhdCBpdCBwZXJmb3JtcyBhIGJpbmFyeVxuICAgICAqIHNlYXJjaCBvbiBhIHNvcnRlZCBgYXJyYXlgLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDQuMC4wXG4gICAgICogQGNhdGVnb3J5IEFycmF5XG4gICAgICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIGFycmF5IHRvIGluc3BlY3QuXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gc2VhcmNoIGZvci5cbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSBSZXR1cm5zIHRoZSBpbmRleCBvZiB0aGUgbWF0Y2hlZCB2YWx1ZSwgZWxzZSBgLTFgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLnNvcnRlZEluZGV4T2YoWzQsIDUsIDUsIDUsIDZdLCA1KTtcbiAgICAgKiAvLyA9PiAxXG4gICAgICovXG4gICAgZnVuY3Rpb24gc29ydGVkSW5kZXhPZihhcnJheSwgdmFsdWUpIHtcbiAgICAgIHZhciBsZW5ndGggPSBhcnJheSA9PSBudWxsID8gMCA6IGFycmF5Lmxlbmd0aDtcbiAgICAgIGlmIChsZW5ndGgpIHtcbiAgICAgICAgdmFyIGluZGV4ID0gYmFzZVNvcnRlZEluZGV4KGFycmF5LCB2YWx1ZSk7XG4gICAgICAgIGlmIChpbmRleCA8IGxlbmd0aCAmJiBlcShhcnJheVtpbmRleF0sIHZhbHVlKSkge1xuICAgICAgICAgIHJldHVybiBpbmRleDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIC0xO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoaXMgbWV0aG9kIGlzIGxpa2UgYF8uc29ydGVkSW5kZXhgIGV4Y2VwdCB0aGF0IGl0IHJldHVybnMgdGhlIGhpZ2hlc3RcbiAgICAgKiBpbmRleCBhdCB3aGljaCBgdmFsdWVgIHNob3VsZCBiZSBpbnNlcnRlZCBpbnRvIGBhcnJheWAgaW4gb3JkZXIgdG9cbiAgICAgKiBtYWludGFpbiBpdHMgc29ydCBvcmRlci5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAzLjAuMFxuICAgICAqIEBjYXRlZ29yeSBBcnJheVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGFycmF5IFRoZSBzb3J0ZWQgYXJyYXkgdG8gaW5zcGVjdC5cbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBldmFsdWF0ZS5cbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSBSZXR1cm5zIHRoZSBpbmRleCBhdCB3aGljaCBgdmFsdWVgIHNob3VsZCBiZSBpbnNlcnRlZFxuICAgICAqICBpbnRvIGBhcnJheWAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8uc29ydGVkTGFzdEluZGV4KFs0LCA1LCA1LCA1LCA2XSwgNSk7XG4gICAgICogLy8gPT4gNFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHNvcnRlZExhc3RJbmRleChhcnJheSwgdmFsdWUpIHtcbiAgICAgIHJldHVybiBiYXNlU29ydGVkSW5kZXgoYXJyYXksIHZhbHVlLCB0cnVlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGlzIG1ldGhvZCBpcyBsaWtlIGBfLnNvcnRlZExhc3RJbmRleGAgZXhjZXB0IHRoYXQgaXQgYWNjZXB0cyBgaXRlcmF0ZWVgXG4gICAgICogd2hpY2ggaXMgaW52b2tlZCBmb3IgYHZhbHVlYCBhbmQgZWFjaCBlbGVtZW50IG9mIGBhcnJheWAgdG8gY29tcHV0ZSB0aGVpclxuICAgICAqIHNvcnQgcmFua2luZy4gVGhlIGl0ZXJhdGVlIGlzIGludm9rZWQgd2l0aCBvbmUgYXJndW1lbnQ6ICh2YWx1ZSkuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgNC4wLjBcbiAgICAgKiBAY2F0ZWdvcnkgQXJyYXlcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBhcnJheSBUaGUgc29ydGVkIGFycmF5IHRvIGluc3BlY3QuXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gZXZhbHVhdGUuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gW2l0ZXJhdGVlPV8uaWRlbnRpdHldIFRoZSBpdGVyYXRlZSBpbnZva2VkIHBlciBlbGVtZW50LlxuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IFJldHVybnMgdGhlIGluZGV4IGF0IHdoaWNoIGB2YWx1ZWAgc2hvdWxkIGJlIGluc2VydGVkXG4gICAgICogIGludG8gYGFycmF5YC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogdmFyIG9iamVjdHMgPSBbeyAneCc6IDQgfSwgeyAneCc6IDUgfV07XG4gICAgICpcbiAgICAgKiBfLnNvcnRlZExhc3RJbmRleEJ5KG9iamVjdHMsIHsgJ3gnOiA0IH0sIGZ1bmN0aW9uKG8pIHsgcmV0dXJuIG8ueDsgfSk7XG4gICAgICogLy8gPT4gMVxuICAgICAqXG4gICAgICogLy8gVGhlIGBfLnByb3BlcnR5YCBpdGVyYXRlZSBzaG9ydGhhbmQuXG4gICAgICogXy5zb3J0ZWRMYXN0SW5kZXhCeShvYmplY3RzLCB7ICd4JzogNCB9LCAneCcpO1xuICAgICAqIC8vID0+IDFcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBzb3J0ZWRMYXN0SW5kZXhCeShhcnJheSwgdmFsdWUsIGl0ZXJhdGVlKSB7XG4gICAgICByZXR1cm4gYmFzZVNvcnRlZEluZGV4QnkoYXJyYXksIHZhbHVlLCBnZXRJdGVyYXRlZShpdGVyYXRlZSwgMiksIHRydWUpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoaXMgbWV0aG9kIGlzIGxpa2UgYF8ubGFzdEluZGV4T2ZgIGV4Y2VwdCB0aGF0IGl0IHBlcmZvcm1zIGEgYmluYXJ5XG4gICAgICogc2VhcmNoIG9uIGEgc29ydGVkIGBhcnJheWAuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgNC4wLjBcbiAgICAgKiBAY2F0ZWdvcnkgQXJyYXlcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBhcnJheSBUaGUgYXJyYXkgdG8gaW5zcGVjdC5cbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBzZWFyY2ggZm9yLlxuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IFJldHVybnMgdGhlIGluZGV4IG9mIHRoZSBtYXRjaGVkIHZhbHVlLCBlbHNlIGAtMWAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8uc29ydGVkTGFzdEluZGV4T2YoWzQsIDUsIDUsIDUsIDZdLCA1KTtcbiAgICAgKiAvLyA9PiAzXG4gICAgICovXG4gICAgZnVuY3Rpb24gc29ydGVkTGFzdEluZGV4T2YoYXJyYXksIHZhbHVlKSB7XG4gICAgICB2YXIgbGVuZ3RoID0gYXJyYXkgPT0gbnVsbCA/IDAgOiBhcnJheS5sZW5ndGg7XG4gICAgICBpZiAobGVuZ3RoKSB7XG4gICAgICAgIHZhciBpbmRleCA9IGJhc2VTb3J0ZWRJbmRleChhcnJheSwgdmFsdWUsIHRydWUpIC0gMTtcbiAgICAgICAgaWYgKGVxKGFycmF5W2luZGV4XSwgdmFsdWUpKSB7XG4gICAgICAgICAgcmV0dXJuIGluZGV4O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gLTE7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhpcyBtZXRob2QgaXMgbGlrZSBgXy51bmlxYCBleGNlcHQgdGhhdCBpdCdzIGRlc2lnbmVkIGFuZCBvcHRpbWl6ZWRcbiAgICAgKiBmb3Igc29ydGVkIGFycmF5cy5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSA0LjAuMFxuICAgICAqIEBjYXRlZ29yeSBBcnJheVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGFycmF5IFRoZSBhcnJheSB0byBpbnNwZWN0LlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgbmV3IGR1cGxpY2F0ZSBmcmVlIGFycmF5LlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLnNvcnRlZFVuaXEoWzEsIDEsIDJdKTtcbiAgICAgKiAvLyA9PiBbMSwgMl1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBzb3J0ZWRVbmlxKGFycmF5KSB7XG4gICAgICByZXR1cm4gKGFycmF5ICYmIGFycmF5Lmxlbmd0aClcbiAgICAgICAgPyBiYXNlU29ydGVkVW5pcShhcnJheSlcbiAgICAgICAgOiBbXTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGlzIG1ldGhvZCBpcyBsaWtlIGBfLnVuaXFCeWAgZXhjZXB0IHRoYXQgaXQncyBkZXNpZ25lZCBhbmQgb3B0aW1pemVkXG4gICAgICogZm9yIHNvcnRlZCBhcnJheXMuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgNC4wLjBcbiAgICAgKiBAY2F0ZWdvcnkgQXJyYXlcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBhcnJheSBUaGUgYXJyYXkgdG8gaW5zcGVjdC5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbaXRlcmF0ZWVdIFRoZSBpdGVyYXRlZSBpbnZva2VkIHBlciBlbGVtZW50LlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgbmV3IGR1cGxpY2F0ZSBmcmVlIGFycmF5LlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLnNvcnRlZFVuaXFCeShbMS4xLCAxLjIsIDIuMywgMi40XSwgTWF0aC5mbG9vcik7XG4gICAgICogLy8gPT4gWzEuMSwgMi4zXVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHNvcnRlZFVuaXFCeShhcnJheSwgaXRlcmF0ZWUpIHtcbiAgICAgIHJldHVybiAoYXJyYXkgJiYgYXJyYXkubGVuZ3RoKVxuICAgICAgICA/IGJhc2VTb3J0ZWRVbmlxKGFycmF5LCBnZXRJdGVyYXRlZShpdGVyYXRlZSwgMikpXG4gICAgICAgIDogW107XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0cyBhbGwgYnV0IHRoZSBmaXJzdCBlbGVtZW50IG9mIGBhcnJheWAuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgNC4wLjBcbiAgICAgKiBAY2F0ZWdvcnkgQXJyYXlcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBhcnJheSBUaGUgYXJyYXkgdG8gcXVlcnkuXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIHRoZSBzbGljZSBvZiBgYXJyYXlgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLnRhaWwoWzEsIDIsIDNdKTtcbiAgICAgKiAvLyA9PiBbMiwgM11cbiAgICAgKi9cbiAgICBmdW5jdGlvbiB0YWlsKGFycmF5KSB7XG4gICAgICB2YXIgbGVuZ3RoID0gYXJyYXkgPT0gbnVsbCA/IDAgOiBhcnJheS5sZW5ndGg7XG4gICAgICByZXR1cm4gbGVuZ3RoID8gYmFzZVNsaWNlKGFycmF5LCAxLCBsZW5ndGgpIDogW107XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIHNsaWNlIG9mIGBhcnJheWAgd2l0aCBgbmAgZWxlbWVudHMgdGFrZW4gZnJvbSB0aGUgYmVnaW5uaW5nLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDAuMS4wXG4gICAgICogQGNhdGVnb3J5IEFycmF5XG4gICAgICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIGFycmF5IHRvIHF1ZXJ5LlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbbj0xXSBUaGUgbnVtYmVyIG9mIGVsZW1lbnRzIHRvIHRha2UuXG4gICAgICogQHBhcmFtLSB7T2JqZWN0fSBbZ3VhcmRdIEVuYWJsZXMgdXNlIGFzIGFuIGl0ZXJhdGVlIGZvciBtZXRob2RzIGxpa2UgYF8ubWFwYC5cbiAgICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgdGhlIHNsaWNlIG9mIGBhcnJheWAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8udGFrZShbMSwgMiwgM10pO1xuICAgICAqIC8vID0+IFsxXVxuICAgICAqXG4gICAgICogXy50YWtlKFsxLCAyLCAzXSwgMik7XG4gICAgICogLy8gPT4gWzEsIDJdXG4gICAgICpcbiAgICAgKiBfLnRha2UoWzEsIDIsIDNdLCA1KTtcbiAgICAgKiAvLyA9PiBbMSwgMiwgM11cbiAgICAgKlxuICAgICAqIF8udGFrZShbMSwgMiwgM10sIDApO1xuICAgICAqIC8vID0+IFtdXG4gICAgICovXG4gICAgZnVuY3Rpb24gdGFrZShhcnJheSwgbiwgZ3VhcmQpIHtcbiAgICAgIGlmICghKGFycmF5ICYmIGFycmF5Lmxlbmd0aCkpIHtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgfVxuICAgICAgbiA9IChndWFyZCB8fCBuID09PSB1bmRlZmluZWQpID8gMSA6IHRvSW50ZWdlcihuKTtcbiAgICAgIHJldHVybiBiYXNlU2xpY2UoYXJyYXksIDAsIG4gPCAwID8gMCA6IG4pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBzbGljZSBvZiBgYXJyYXlgIHdpdGggYG5gIGVsZW1lbnRzIHRha2VuIGZyb20gdGhlIGVuZC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAzLjAuMFxuICAgICAqIEBjYXRlZ29yeSBBcnJheVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGFycmF5IFRoZSBhcnJheSB0byBxdWVyeS5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW249MV0gVGhlIG51bWJlciBvZiBlbGVtZW50cyB0byB0YWtlLlxuICAgICAqIEBwYXJhbS0ge09iamVjdH0gW2d1YXJkXSBFbmFibGVzIHVzZSBhcyBhbiBpdGVyYXRlZSBmb3IgbWV0aG9kcyBsaWtlIGBfLm1hcGAuXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIHRoZSBzbGljZSBvZiBgYXJyYXlgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLnRha2VSaWdodChbMSwgMiwgM10pO1xuICAgICAqIC8vID0+IFszXVxuICAgICAqXG4gICAgICogXy50YWtlUmlnaHQoWzEsIDIsIDNdLCAyKTtcbiAgICAgKiAvLyA9PiBbMiwgM11cbiAgICAgKlxuICAgICAqIF8udGFrZVJpZ2h0KFsxLCAyLCAzXSwgNSk7XG4gICAgICogLy8gPT4gWzEsIDIsIDNdXG4gICAgICpcbiAgICAgKiBfLnRha2VSaWdodChbMSwgMiwgM10sIDApO1xuICAgICAqIC8vID0+IFtdXG4gICAgICovXG4gICAgZnVuY3Rpb24gdGFrZVJpZ2h0KGFycmF5LCBuLCBndWFyZCkge1xuICAgICAgdmFyIGxlbmd0aCA9IGFycmF5ID09IG51bGwgPyAwIDogYXJyYXkubGVuZ3RoO1xuICAgICAgaWYgKCFsZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgfVxuICAgICAgbiA9IChndWFyZCB8fCBuID09PSB1bmRlZmluZWQpID8gMSA6IHRvSW50ZWdlcihuKTtcbiAgICAgIG4gPSBsZW5ndGggLSBuO1xuICAgICAgcmV0dXJuIGJhc2VTbGljZShhcnJheSwgbiA8IDAgPyAwIDogbiwgbGVuZ3RoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgc2xpY2Ugb2YgYGFycmF5YCB3aXRoIGVsZW1lbnRzIHRha2VuIGZyb20gdGhlIGVuZC4gRWxlbWVudHMgYXJlXG4gICAgICogdGFrZW4gdW50aWwgYHByZWRpY2F0ZWAgcmV0dXJucyBmYWxzZXkuIFRoZSBwcmVkaWNhdGUgaXMgaW52b2tlZCB3aXRoXG4gICAgICogdGhyZWUgYXJndW1lbnRzOiAodmFsdWUsIGluZGV4LCBhcnJheSkuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMy4wLjBcbiAgICAgKiBAY2F0ZWdvcnkgQXJyYXlcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBhcnJheSBUaGUgYXJyYXkgdG8gcXVlcnkuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gW3ByZWRpY2F0ZT1fLmlkZW50aXR5XSBUaGUgZnVuY3Rpb24gaW52b2tlZCBwZXIgaXRlcmF0aW9uLlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgc2xpY2Ugb2YgYGFycmF5YC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogdmFyIHVzZXJzID0gW1xuICAgICAqICAgeyAndXNlcic6ICdiYXJuZXknLCAgJ2FjdGl2ZSc6IHRydWUgfSxcbiAgICAgKiAgIHsgJ3VzZXInOiAnZnJlZCcsICAgICdhY3RpdmUnOiBmYWxzZSB9LFxuICAgICAqICAgeyAndXNlcic6ICdwZWJibGVzJywgJ2FjdGl2ZSc6IGZhbHNlIH1cbiAgICAgKiBdO1xuICAgICAqXG4gICAgICogXy50YWtlUmlnaHRXaGlsZSh1c2VycywgZnVuY3Rpb24obykgeyByZXR1cm4gIW8uYWN0aXZlOyB9KTtcbiAgICAgKiAvLyA9PiBvYmplY3RzIGZvciBbJ2ZyZWQnLCAncGViYmxlcyddXG4gICAgICpcbiAgICAgKiAvLyBUaGUgYF8ubWF0Y2hlc2AgaXRlcmF0ZWUgc2hvcnRoYW5kLlxuICAgICAqIF8udGFrZVJpZ2h0V2hpbGUodXNlcnMsIHsgJ3VzZXInOiAncGViYmxlcycsICdhY3RpdmUnOiBmYWxzZSB9KTtcbiAgICAgKiAvLyA9PiBvYmplY3RzIGZvciBbJ3BlYmJsZXMnXVxuICAgICAqXG4gICAgICogLy8gVGhlIGBfLm1hdGNoZXNQcm9wZXJ0eWAgaXRlcmF0ZWUgc2hvcnRoYW5kLlxuICAgICAqIF8udGFrZVJpZ2h0V2hpbGUodXNlcnMsIFsnYWN0aXZlJywgZmFsc2VdKTtcbiAgICAgKiAvLyA9PiBvYmplY3RzIGZvciBbJ2ZyZWQnLCAncGViYmxlcyddXG4gICAgICpcbiAgICAgKiAvLyBUaGUgYF8ucHJvcGVydHlgIGl0ZXJhdGVlIHNob3J0aGFuZC5cbiAgICAgKiBfLnRha2VSaWdodFdoaWxlKHVzZXJzLCAnYWN0aXZlJyk7XG4gICAgICogLy8gPT4gW11cbiAgICAgKi9cbiAgICBmdW5jdGlvbiB0YWtlUmlnaHRXaGlsZShhcnJheSwgcHJlZGljYXRlKSB7XG4gICAgICByZXR1cm4gKGFycmF5ICYmIGFycmF5Lmxlbmd0aClcbiAgICAgICAgPyBiYXNlV2hpbGUoYXJyYXksIGdldEl0ZXJhdGVlKHByZWRpY2F0ZSwgMyksIGZhbHNlLCB0cnVlKVxuICAgICAgICA6IFtdO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBzbGljZSBvZiBgYXJyYXlgIHdpdGggZWxlbWVudHMgdGFrZW4gZnJvbSB0aGUgYmVnaW5uaW5nLiBFbGVtZW50c1xuICAgICAqIGFyZSB0YWtlbiB1bnRpbCBgcHJlZGljYXRlYCByZXR1cm5zIGZhbHNleS4gVGhlIHByZWRpY2F0ZSBpcyBpbnZva2VkIHdpdGhcbiAgICAgKiB0aHJlZSBhcmd1bWVudHM6ICh2YWx1ZSwgaW5kZXgsIGFycmF5KS5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAzLjAuMFxuICAgICAqIEBjYXRlZ29yeSBBcnJheVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGFycmF5IFRoZSBhcnJheSB0byBxdWVyeS5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbcHJlZGljYXRlPV8uaWRlbnRpdHldIFRoZSBmdW5jdGlvbiBpbnZva2VkIHBlciBpdGVyYXRpb24uXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIHRoZSBzbGljZSBvZiBgYXJyYXlgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiB2YXIgdXNlcnMgPSBbXG4gICAgICogICB7ICd1c2VyJzogJ2Jhcm5leScsICAnYWN0aXZlJzogZmFsc2UgfSxcbiAgICAgKiAgIHsgJ3VzZXInOiAnZnJlZCcsICAgICdhY3RpdmUnOiBmYWxzZSB9LFxuICAgICAqICAgeyAndXNlcic6ICdwZWJibGVzJywgJ2FjdGl2ZSc6IHRydWUgfVxuICAgICAqIF07XG4gICAgICpcbiAgICAgKiBfLnRha2VXaGlsZSh1c2VycywgZnVuY3Rpb24obykgeyByZXR1cm4gIW8uYWN0aXZlOyB9KTtcbiAgICAgKiAvLyA9PiBvYmplY3RzIGZvciBbJ2Jhcm5leScsICdmcmVkJ11cbiAgICAgKlxuICAgICAqIC8vIFRoZSBgXy5tYXRjaGVzYCBpdGVyYXRlZSBzaG9ydGhhbmQuXG4gICAgICogXy50YWtlV2hpbGUodXNlcnMsIHsgJ3VzZXInOiAnYmFybmV5JywgJ2FjdGl2ZSc6IGZhbHNlIH0pO1xuICAgICAqIC8vID0+IG9iamVjdHMgZm9yIFsnYmFybmV5J11cbiAgICAgKlxuICAgICAqIC8vIFRoZSBgXy5tYXRjaGVzUHJvcGVydHlgIGl0ZXJhdGVlIHNob3J0aGFuZC5cbiAgICAgKiBfLnRha2VXaGlsZSh1c2VycywgWydhY3RpdmUnLCBmYWxzZV0pO1xuICAgICAqIC8vID0+IG9iamVjdHMgZm9yIFsnYmFybmV5JywgJ2ZyZWQnXVxuICAgICAqXG4gICAgICogLy8gVGhlIGBfLnByb3BlcnR5YCBpdGVyYXRlZSBzaG9ydGhhbmQuXG4gICAgICogXy50YWtlV2hpbGUodXNlcnMsICdhY3RpdmUnKTtcbiAgICAgKiAvLyA9PiBbXVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHRha2VXaGlsZShhcnJheSwgcHJlZGljYXRlKSB7XG4gICAgICByZXR1cm4gKGFycmF5ICYmIGFycmF5Lmxlbmd0aClcbiAgICAgICAgPyBiYXNlV2hpbGUoYXJyYXksIGdldEl0ZXJhdGVlKHByZWRpY2F0ZSwgMykpXG4gICAgICAgIDogW107XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbiBhcnJheSBvZiB1bmlxdWUgdmFsdWVzLCBpbiBvcmRlciwgZnJvbSBhbGwgZ2l2ZW4gYXJyYXlzIHVzaW5nXG4gICAgICogW2BTYW1lVmFsdWVaZXJvYF0oaHR0cDovL2VjbWEtaW50ZXJuYXRpb25hbC5vcmcvZWNtYS0yNjIvNy4wLyNzZWMtc2FtZXZhbHVlemVybylcbiAgICAgKiBmb3IgZXF1YWxpdHkgY29tcGFyaXNvbnMuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMC4xLjBcbiAgICAgKiBAY2F0ZWdvcnkgQXJyYXlcbiAgICAgKiBAcGFyYW0gey4uLkFycmF5fSBbYXJyYXlzXSBUaGUgYXJyYXlzIHRvIGluc3BlY3QuXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIHRoZSBuZXcgYXJyYXkgb2YgY29tYmluZWQgdmFsdWVzLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLnVuaW9uKFsyXSwgWzEsIDJdKTtcbiAgICAgKiAvLyA9PiBbMiwgMV1cbiAgICAgKi9cbiAgICB2YXIgdW5pb24gPSBiYXNlUmVzdChmdW5jdGlvbihhcnJheXMpIHtcbiAgICAgIHJldHVybiBiYXNlVW5pcShiYXNlRmxhdHRlbihhcnJheXMsIDEsIGlzQXJyYXlMaWtlT2JqZWN0LCB0cnVlKSk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBUaGlzIG1ldGhvZCBpcyBsaWtlIGBfLnVuaW9uYCBleGNlcHQgdGhhdCBpdCBhY2NlcHRzIGBpdGVyYXRlZWAgd2hpY2ggaXNcbiAgICAgKiBpbnZva2VkIGZvciBlYWNoIGVsZW1lbnQgb2YgZWFjaCBgYXJyYXlzYCB0byBnZW5lcmF0ZSB0aGUgY3JpdGVyaW9uIGJ5XG4gICAgICogd2hpY2ggdW5pcXVlbmVzcyBpcyBjb21wdXRlZC4gUmVzdWx0IHZhbHVlcyBhcmUgY2hvc2VuIGZyb20gdGhlIGZpcnN0XG4gICAgICogYXJyYXkgaW4gd2hpY2ggdGhlIHZhbHVlIG9jY3Vycy4gVGhlIGl0ZXJhdGVlIGlzIGludm9rZWQgd2l0aCBvbmUgYXJndW1lbnQ6XG4gICAgICogKHZhbHVlKS5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSA0LjAuMFxuICAgICAqIEBjYXRlZ29yeSBBcnJheVxuICAgICAqIEBwYXJhbSB7Li4uQXJyYXl9IFthcnJheXNdIFRoZSBhcnJheXMgdG8gaW5zcGVjdC5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbaXRlcmF0ZWU9Xy5pZGVudGl0eV0gVGhlIGl0ZXJhdGVlIGludm9rZWQgcGVyIGVsZW1lbnQuXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIHRoZSBuZXcgYXJyYXkgb2YgY29tYmluZWQgdmFsdWVzLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLnVuaW9uQnkoWzIuMV0sIFsxLjIsIDIuM10sIE1hdGguZmxvb3IpO1xuICAgICAqIC8vID0+IFsyLjEsIDEuMl1cbiAgICAgKlxuICAgICAqIC8vIFRoZSBgXy5wcm9wZXJ0eWAgaXRlcmF0ZWUgc2hvcnRoYW5kLlxuICAgICAqIF8udW5pb25CeShbeyAneCc6IDEgfV0sIFt7ICd4JzogMiB9LCB7ICd4JzogMSB9XSwgJ3gnKTtcbiAgICAgKiAvLyA9PiBbeyAneCc6IDEgfSwgeyAneCc6IDIgfV1cbiAgICAgKi9cbiAgICB2YXIgdW5pb25CeSA9IGJhc2VSZXN0KGZ1bmN0aW9uKGFycmF5cykge1xuICAgICAgdmFyIGl0ZXJhdGVlID0gbGFzdChhcnJheXMpO1xuICAgICAgaWYgKGlzQXJyYXlMaWtlT2JqZWN0KGl0ZXJhdGVlKSkge1xuICAgICAgICBpdGVyYXRlZSA9IHVuZGVmaW5lZDtcbiAgICAgIH1cbiAgICAgIHJldHVybiBiYXNlVW5pcShiYXNlRmxhdHRlbihhcnJheXMsIDEsIGlzQXJyYXlMaWtlT2JqZWN0LCB0cnVlKSwgZ2V0SXRlcmF0ZWUoaXRlcmF0ZWUsIDIpKTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFRoaXMgbWV0aG9kIGlzIGxpa2UgYF8udW5pb25gIGV4Y2VwdCB0aGF0IGl0IGFjY2VwdHMgYGNvbXBhcmF0b3JgIHdoaWNoXG4gICAgICogaXMgaW52b2tlZCB0byBjb21wYXJlIGVsZW1lbnRzIG9mIGBhcnJheXNgLiBSZXN1bHQgdmFsdWVzIGFyZSBjaG9zZW4gZnJvbVxuICAgICAqIHRoZSBmaXJzdCBhcnJheSBpbiB3aGljaCB0aGUgdmFsdWUgb2NjdXJzLiBUaGUgY29tcGFyYXRvciBpcyBpbnZva2VkXG4gICAgICogd2l0aCB0d28gYXJndW1lbnRzOiAoYXJyVmFsLCBvdGhWYWwpLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDQuMC4wXG4gICAgICogQGNhdGVnb3J5IEFycmF5XG4gICAgICogQHBhcmFtIHsuLi5BcnJheX0gW2FycmF5c10gVGhlIGFycmF5cyB0byBpbnNwZWN0LlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtjb21wYXJhdG9yXSBUaGUgY29tcGFyYXRvciBpbnZva2VkIHBlciBlbGVtZW50LlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgbmV3IGFycmF5IG9mIGNvbWJpbmVkIHZhbHVlcy5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogdmFyIG9iamVjdHMgPSBbeyAneCc6IDEsICd5JzogMiB9LCB7ICd4JzogMiwgJ3knOiAxIH1dO1xuICAgICAqIHZhciBvdGhlcnMgPSBbeyAneCc6IDEsICd5JzogMSB9LCB7ICd4JzogMSwgJ3knOiAyIH1dO1xuICAgICAqXG4gICAgICogXy51bmlvbldpdGgob2JqZWN0cywgb3RoZXJzLCBfLmlzRXF1YWwpO1xuICAgICAqIC8vID0+IFt7ICd4JzogMSwgJ3knOiAyIH0sIHsgJ3gnOiAyLCAneSc6IDEgfSwgeyAneCc6IDEsICd5JzogMSB9XVxuICAgICAqL1xuICAgIHZhciB1bmlvbldpdGggPSBiYXNlUmVzdChmdW5jdGlvbihhcnJheXMpIHtcbiAgICAgIHZhciBjb21wYXJhdG9yID0gbGFzdChhcnJheXMpO1xuICAgICAgY29tcGFyYXRvciA9IHR5cGVvZiBjb21wYXJhdG9yID09ICdmdW5jdGlvbicgPyBjb21wYXJhdG9yIDogdW5kZWZpbmVkO1xuICAgICAgcmV0dXJuIGJhc2VVbmlxKGJhc2VGbGF0dGVuKGFycmF5cywgMSwgaXNBcnJheUxpa2VPYmplY3QsIHRydWUpLCB1bmRlZmluZWQsIGNvbXBhcmF0b3IpO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGR1cGxpY2F0ZS1mcmVlIHZlcnNpb24gb2YgYW4gYXJyYXksIHVzaW5nXG4gICAgICogW2BTYW1lVmFsdWVaZXJvYF0oaHR0cDovL2VjbWEtaW50ZXJuYXRpb25hbC5vcmcvZWNtYS0yNjIvNy4wLyNzZWMtc2FtZXZhbHVlemVybylcbiAgICAgKiBmb3IgZXF1YWxpdHkgY29tcGFyaXNvbnMsIGluIHdoaWNoIG9ubHkgdGhlIGZpcnN0IG9jY3VycmVuY2Ugb2YgZWFjaCBlbGVtZW50XG4gICAgICogaXMga2VwdC4gVGhlIG9yZGVyIG9mIHJlc3VsdCB2YWx1ZXMgaXMgZGV0ZXJtaW5lZCBieSB0aGUgb3JkZXIgdGhleSBvY2N1clxuICAgICAqIGluIHRoZSBhcnJheS5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAwLjEuMFxuICAgICAqIEBjYXRlZ29yeSBBcnJheVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGFycmF5IFRoZSBhcnJheSB0byBpbnNwZWN0LlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgbmV3IGR1cGxpY2F0ZSBmcmVlIGFycmF5LlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLnVuaXEoWzIsIDEsIDJdKTtcbiAgICAgKiAvLyA9PiBbMiwgMV1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiB1bmlxKGFycmF5KSB7XG4gICAgICByZXR1cm4gKGFycmF5ICYmIGFycmF5Lmxlbmd0aCkgPyBiYXNlVW5pcShhcnJheSkgOiBbXTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGlzIG1ldGhvZCBpcyBsaWtlIGBfLnVuaXFgIGV4Y2VwdCB0aGF0IGl0IGFjY2VwdHMgYGl0ZXJhdGVlYCB3aGljaCBpc1xuICAgICAqIGludm9rZWQgZm9yIGVhY2ggZWxlbWVudCBpbiBgYXJyYXlgIHRvIGdlbmVyYXRlIHRoZSBjcml0ZXJpb24gYnkgd2hpY2hcbiAgICAgKiB1bmlxdWVuZXNzIGlzIGNvbXB1dGVkLiBUaGUgb3JkZXIgb2YgcmVzdWx0IHZhbHVlcyBpcyBkZXRlcm1pbmVkIGJ5IHRoZVxuICAgICAqIG9yZGVyIHRoZXkgb2NjdXIgaW4gdGhlIGFycmF5LiBUaGUgaXRlcmF0ZWUgaXMgaW52b2tlZCB3aXRoIG9uZSBhcmd1bWVudDpcbiAgICAgKiAodmFsdWUpLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDQuMC4wXG4gICAgICogQGNhdGVnb3J5IEFycmF5XG4gICAgICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIGFycmF5IHRvIGluc3BlY3QuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gW2l0ZXJhdGVlPV8uaWRlbnRpdHldIFRoZSBpdGVyYXRlZSBpbnZva2VkIHBlciBlbGVtZW50LlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgbmV3IGR1cGxpY2F0ZSBmcmVlIGFycmF5LlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLnVuaXFCeShbMi4xLCAxLjIsIDIuM10sIE1hdGguZmxvb3IpO1xuICAgICAqIC8vID0+IFsyLjEsIDEuMl1cbiAgICAgKlxuICAgICAqIC8vIFRoZSBgXy5wcm9wZXJ0eWAgaXRlcmF0ZWUgc2hvcnRoYW5kLlxuICAgICAqIF8udW5pcUJ5KFt7ICd4JzogMSB9LCB7ICd4JzogMiB9LCB7ICd4JzogMSB9XSwgJ3gnKTtcbiAgICAgKiAvLyA9PiBbeyAneCc6IDEgfSwgeyAneCc6IDIgfV1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiB1bmlxQnkoYXJyYXksIGl0ZXJhdGVlKSB7XG4gICAgICByZXR1cm4gKGFycmF5ICYmIGFycmF5Lmxlbmd0aCkgPyBiYXNlVW5pcShhcnJheSwgZ2V0SXRlcmF0ZWUoaXRlcmF0ZWUsIDIpKSA6IFtdO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoaXMgbWV0aG9kIGlzIGxpa2UgYF8udW5pcWAgZXhjZXB0IHRoYXQgaXQgYWNjZXB0cyBgY29tcGFyYXRvcmAgd2hpY2hcbiAgICAgKiBpcyBpbnZva2VkIHRvIGNvbXBhcmUgZWxlbWVudHMgb2YgYGFycmF5YC4gVGhlIG9yZGVyIG9mIHJlc3VsdCB2YWx1ZXMgaXNcbiAgICAgKiBkZXRlcm1pbmVkIGJ5IHRoZSBvcmRlciB0aGV5IG9jY3VyIGluIHRoZSBhcnJheS5UaGUgY29tcGFyYXRvciBpcyBpbnZva2VkXG4gICAgICogd2l0aCB0d28gYXJndW1lbnRzOiAoYXJyVmFsLCBvdGhWYWwpLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDQuMC4wXG4gICAgICogQGNhdGVnb3J5IEFycmF5XG4gICAgICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIGFycmF5IHRvIGluc3BlY3QuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gW2NvbXBhcmF0b3JdIFRoZSBjb21wYXJhdG9yIGludm9rZWQgcGVyIGVsZW1lbnQuXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIHRoZSBuZXcgZHVwbGljYXRlIGZyZWUgYXJyYXkuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciBvYmplY3RzID0gW3sgJ3gnOiAxLCAneSc6IDIgfSwgeyAneCc6IDIsICd5JzogMSB9LCB7ICd4JzogMSwgJ3knOiAyIH1dO1xuICAgICAqXG4gICAgICogXy51bmlxV2l0aChvYmplY3RzLCBfLmlzRXF1YWwpO1xuICAgICAqIC8vID0+IFt7ICd4JzogMSwgJ3knOiAyIH0sIHsgJ3gnOiAyLCAneSc6IDEgfV1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiB1bmlxV2l0aChhcnJheSwgY29tcGFyYXRvcikge1xuICAgICAgY29tcGFyYXRvciA9IHR5cGVvZiBjb21wYXJhdG9yID09ICdmdW5jdGlvbicgPyBjb21wYXJhdG9yIDogdW5kZWZpbmVkO1xuICAgICAgcmV0dXJuIChhcnJheSAmJiBhcnJheS5sZW5ndGgpID8gYmFzZVVuaXEoYXJyYXksIHVuZGVmaW5lZCwgY29tcGFyYXRvcikgOiBbXTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGlzIG1ldGhvZCBpcyBsaWtlIGBfLnppcGAgZXhjZXB0IHRoYXQgaXQgYWNjZXB0cyBhbiBhcnJheSBvZiBncm91cGVkXG4gICAgICogZWxlbWVudHMgYW5kIGNyZWF0ZXMgYW4gYXJyYXkgcmVncm91cGluZyB0aGUgZWxlbWVudHMgdG8gdGhlaXIgcHJlLXppcFxuICAgICAqIGNvbmZpZ3VyYXRpb24uXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMS4yLjBcbiAgICAgKiBAY2F0ZWdvcnkgQXJyYXlcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBhcnJheSBUaGUgYXJyYXkgb2YgZ3JvdXBlZCBlbGVtZW50cyB0byBwcm9jZXNzLlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgbmV3IGFycmF5IG9mIHJlZ3JvdXBlZCBlbGVtZW50cy5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogdmFyIHppcHBlZCA9IF8uemlwKFsnYScsICdiJ10sIFsxLCAyXSwgW3RydWUsIGZhbHNlXSk7XG4gICAgICogLy8gPT4gW1snYScsIDEsIHRydWVdLCBbJ2InLCAyLCBmYWxzZV1dXG4gICAgICpcbiAgICAgKiBfLnVuemlwKHppcHBlZCk7XG4gICAgICogLy8gPT4gW1snYScsICdiJ10sIFsxLCAyXSwgW3RydWUsIGZhbHNlXV1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiB1bnppcChhcnJheSkge1xuICAgICAgaWYgKCEoYXJyYXkgJiYgYXJyYXkubGVuZ3RoKSkge1xuICAgICAgICByZXR1cm4gW107XG4gICAgICB9XG4gICAgICB2YXIgbGVuZ3RoID0gMDtcbiAgICAgIGFycmF5ID0gYXJyYXlGaWx0ZXIoYXJyYXksIGZ1bmN0aW9uKGdyb3VwKSB7XG4gICAgICAgIGlmIChpc0FycmF5TGlrZU9iamVjdChncm91cCkpIHtcbiAgICAgICAgICBsZW5ndGggPSBuYXRpdmVNYXgoZ3JvdXAubGVuZ3RoLCBsZW5ndGgpO1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBiYXNlVGltZXMobGVuZ3RoLCBmdW5jdGlvbihpbmRleCkge1xuICAgICAgICByZXR1cm4gYXJyYXlNYXAoYXJyYXksIGJhc2VQcm9wZXJ0eShpbmRleCkpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhpcyBtZXRob2QgaXMgbGlrZSBgXy51bnppcGAgZXhjZXB0IHRoYXQgaXQgYWNjZXB0cyBgaXRlcmF0ZWVgIHRvIHNwZWNpZnlcbiAgICAgKiBob3cgcmVncm91cGVkIHZhbHVlcyBzaG91bGQgYmUgY29tYmluZWQuIFRoZSBpdGVyYXRlZSBpcyBpbnZva2VkIHdpdGggdGhlXG4gICAgICogZWxlbWVudHMgb2YgZWFjaCBncm91cDogKC4uLmdyb3VwKS5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAzLjguMFxuICAgICAqIEBjYXRlZ29yeSBBcnJheVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGFycmF5IFRoZSBhcnJheSBvZiBncm91cGVkIGVsZW1lbnRzIHRvIHByb2Nlc3MuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gW2l0ZXJhdGVlPV8uaWRlbnRpdHldIFRoZSBmdW5jdGlvbiB0byBjb21iaW5lXG4gICAgICogIHJlZ3JvdXBlZCB2YWx1ZXMuXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIHRoZSBuZXcgYXJyYXkgb2YgcmVncm91cGVkIGVsZW1lbnRzLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiB2YXIgemlwcGVkID0gXy56aXAoWzEsIDJdLCBbMTAsIDIwXSwgWzEwMCwgMjAwXSk7XG4gICAgICogLy8gPT4gW1sxLCAxMCwgMTAwXSwgWzIsIDIwLCAyMDBdXVxuICAgICAqXG4gICAgICogXy51bnppcFdpdGgoemlwcGVkLCBfLmFkZCk7XG4gICAgICogLy8gPT4gWzMsIDMwLCAzMDBdXG4gICAgICovXG4gICAgZnVuY3Rpb24gdW56aXBXaXRoKGFycmF5LCBpdGVyYXRlZSkge1xuICAgICAgaWYgKCEoYXJyYXkgJiYgYXJyYXkubGVuZ3RoKSkge1xuICAgICAgICByZXR1cm4gW107XG4gICAgICB9XG4gICAgICB2YXIgcmVzdWx0ID0gdW56aXAoYXJyYXkpO1xuICAgICAgaWYgKGl0ZXJhdGVlID09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgIH1cbiAgICAgIHJldHVybiBhcnJheU1hcChyZXN1bHQsIGZ1bmN0aW9uKGdyb3VwKSB7XG4gICAgICAgIHJldHVybiBhcHBseShpdGVyYXRlZSwgdW5kZWZpbmVkLCBncm91cCk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuIGFycmF5IGV4Y2x1ZGluZyBhbGwgZ2l2ZW4gdmFsdWVzIHVzaW5nXG4gICAgICogW2BTYW1lVmFsdWVaZXJvYF0oaHR0cDovL2VjbWEtaW50ZXJuYXRpb25hbC5vcmcvZWNtYS0yNjIvNy4wLyNzZWMtc2FtZXZhbHVlemVybylcbiAgICAgKiBmb3IgZXF1YWxpdHkgY29tcGFyaXNvbnMuXG4gICAgICpcbiAgICAgKiAqKk5vdGU6KiogVW5saWtlIGBfLnB1bGxgLCB0aGlzIG1ldGhvZCByZXR1cm5zIGEgbmV3IGFycmF5LlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDAuMS4wXG4gICAgICogQGNhdGVnb3J5IEFycmF5XG4gICAgICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIGFycmF5IHRvIGluc3BlY3QuXG4gICAgICogQHBhcmFtIHsuLi4qfSBbdmFsdWVzXSBUaGUgdmFsdWVzIHRvIGV4Y2x1ZGUuXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIHRoZSBuZXcgYXJyYXkgb2YgZmlsdGVyZWQgdmFsdWVzLlxuICAgICAqIEBzZWUgXy5kaWZmZXJlbmNlLCBfLnhvclxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLndpdGhvdXQoWzIsIDEsIDIsIDNdLCAxLCAyKTtcbiAgICAgKiAvLyA9PiBbM11cbiAgICAgKi9cbiAgICB2YXIgd2l0aG91dCA9IGJhc2VSZXN0KGZ1bmN0aW9uKGFycmF5LCB2YWx1ZXMpIHtcbiAgICAgIHJldHVybiBpc0FycmF5TGlrZU9iamVjdChhcnJheSlcbiAgICAgICAgPyBiYXNlRGlmZmVyZW5jZShhcnJheSwgdmFsdWVzKVxuICAgICAgICA6IFtdO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbiBhcnJheSBvZiB1bmlxdWUgdmFsdWVzIHRoYXQgaXMgdGhlXG4gICAgICogW3N5bW1ldHJpYyBkaWZmZXJlbmNlXShodHRwczovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9TeW1tZXRyaWNfZGlmZmVyZW5jZSlcbiAgICAgKiBvZiB0aGUgZ2l2ZW4gYXJyYXlzLiBUaGUgb3JkZXIgb2YgcmVzdWx0IHZhbHVlcyBpcyBkZXRlcm1pbmVkIGJ5IHRoZSBvcmRlclxuICAgICAqIHRoZXkgb2NjdXIgaW4gdGhlIGFycmF5cy5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAyLjQuMFxuICAgICAqIEBjYXRlZ29yeSBBcnJheVxuICAgICAqIEBwYXJhbSB7Li4uQXJyYXl9IFthcnJheXNdIFRoZSBhcnJheXMgdG8gaW5zcGVjdC5cbiAgICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgdGhlIG5ldyBhcnJheSBvZiBmaWx0ZXJlZCB2YWx1ZXMuXG4gICAgICogQHNlZSBfLmRpZmZlcmVuY2UsIF8ud2l0aG91dFxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLnhvcihbMiwgMV0sIFsyLCAzXSk7XG4gICAgICogLy8gPT4gWzEsIDNdXG4gICAgICovXG4gICAgdmFyIHhvciA9IGJhc2VSZXN0KGZ1bmN0aW9uKGFycmF5cykge1xuICAgICAgcmV0dXJuIGJhc2VYb3IoYXJyYXlGaWx0ZXIoYXJyYXlzLCBpc0FycmF5TGlrZU9iamVjdCkpO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogVGhpcyBtZXRob2QgaXMgbGlrZSBgXy54b3JgIGV4Y2VwdCB0aGF0IGl0IGFjY2VwdHMgYGl0ZXJhdGVlYCB3aGljaCBpc1xuICAgICAqIGludm9rZWQgZm9yIGVhY2ggZWxlbWVudCBvZiBlYWNoIGBhcnJheXNgIHRvIGdlbmVyYXRlIHRoZSBjcml0ZXJpb24gYnlcbiAgICAgKiB3aGljaCBieSB3aGljaCB0aGV5J3JlIGNvbXBhcmVkLiBUaGUgb3JkZXIgb2YgcmVzdWx0IHZhbHVlcyBpcyBkZXRlcm1pbmVkXG4gICAgICogYnkgdGhlIG9yZGVyIHRoZXkgb2NjdXIgaW4gdGhlIGFycmF5cy4gVGhlIGl0ZXJhdGVlIGlzIGludm9rZWQgd2l0aCBvbmVcbiAgICAgKiBhcmd1bWVudDogKHZhbHVlKS5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSA0LjAuMFxuICAgICAqIEBjYXRlZ29yeSBBcnJheVxuICAgICAqIEBwYXJhbSB7Li4uQXJyYXl9IFthcnJheXNdIFRoZSBhcnJheXMgdG8gaW5zcGVjdC5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbaXRlcmF0ZWU9Xy5pZGVudGl0eV0gVGhlIGl0ZXJhdGVlIGludm9rZWQgcGVyIGVsZW1lbnQuXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIHRoZSBuZXcgYXJyYXkgb2YgZmlsdGVyZWQgdmFsdWVzLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLnhvckJ5KFsyLjEsIDEuMl0sIFsyLjMsIDMuNF0sIE1hdGguZmxvb3IpO1xuICAgICAqIC8vID0+IFsxLjIsIDMuNF1cbiAgICAgKlxuICAgICAqIC8vIFRoZSBgXy5wcm9wZXJ0eWAgaXRlcmF0ZWUgc2hvcnRoYW5kLlxuICAgICAqIF8ueG9yQnkoW3sgJ3gnOiAxIH1dLCBbeyAneCc6IDIgfSwgeyAneCc6IDEgfV0sICd4Jyk7XG4gICAgICogLy8gPT4gW3sgJ3gnOiAyIH1dXG4gICAgICovXG4gICAgdmFyIHhvckJ5ID0gYmFzZVJlc3QoZnVuY3Rpb24oYXJyYXlzKSB7XG4gICAgICB2YXIgaXRlcmF0ZWUgPSBsYXN0KGFycmF5cyk7XG4gICAgICBpZiAoaXNBcnJheUxpa2VPYmplY3QoaXRlcmF0ZWUpKSB7XG4gICAgICAgIGl0ZXJhdGVlID0gdW5kZWZpbmVkO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGJhc2VYb3IoYXJyYXlGaWx0ZXIoYXJyYXlzLCBpc0FycmF5TGlrZU9iamVjdCksIGdldEl0ZXJhdGVlKGl0ZXJhdGVlLCAyKSk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBUaGlzIG1ldGhvZCBpcyBsaWtlIGBfLnhvcmAgZXhjZXB0IHRoYXQgaXQgYWNjZXB0cyBgY29tcGFyYXRvcmAgd2hpY2ggaXNcbiAgICAgKiBpbnZva2VkIHRvIGNvbXBhcmUgZWxlbWVudHMgb2YgYGFycmF5c2AuIFRoZSBvcmRlciBvZiByZXN1bHQgdmFsdWVzIGlzXG4gICAgICogZGV0ZXJtaW5lZCBieSB0aGUgb3JkZXIgdGhleSBvY2N1ciBpbiB0aGUgYXJyYXlzLiBUaGUgY29tcGFyYXRvciBpcyBpbnZva2VkXG4gICAgICogd2l0aCB0d28gYXJndW1lbnRzOiAoYXJyVmFsLCBvdGhWYWwpLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDQuMC4wXG4gICAgICogQGNhdGVnb3J5IEFycmF5XG4gICAgICogQHBhcmFtIHsuLi5BcnJheX0gW2FycmF5c10gVGhlIGFycmF5cyB0byBpbnNwZWN0LlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtjb21wYXJhdG9yXSBUaGUgY29tcGFyYXRvciBpbnZva2VkIHBlciBlbGVtZW50LlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgbmV3IGFycmF5IG9mIGZpbHRlcmVkIHZhbHVlcy5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogdmFyIG9iamVjdHMgPSBbeyAneCc6IDEsICd5JzogMiB9LCB7ICd4JzogMiwgJ3knOiAxIH1dO1xuICAgICAqIHZhciBvdGhlcnMgPSBbeyAneCc6IDEsICd5JzogMSB9LCB7ICd4JzogMSwgJ3knOiAyIH1dO1xuICAgICAqXG4gICAgICogXy54b3JXaXRoKG9iamVjdHMsIG90aGVycywgXy5pc0VxdWFsKTtcbiAgICAgKiAvLyA9PiBbeyAneCc6IDIsICd5JzogMSB9LCB7ICd4JzogMSwgJ3knOiAxIH1dXG4gICAgICovXG4gICAgdmFyIHhvcldpdGggPSBiYXNlUmVzdChmdW5jdGlvbihhcnJheXMpIHtcbiAgICAgIHZhciBjb21wYXJhdG9yID0gbGFzdChhcnJheXMpO1xuICAgICAgY29tcGFyYXRvciA9IHR5cGVvZiBjb21wYXJhdG9yID09ICdmdW5jdGlvbicgPyBjb21wYXJhdG9yIDogdW5kZWZpbmVkO1xuICAgICAgcmV0dXJuIGJhc2VYb3IoYXJyYXlGaWx0ZXIoYXJyYXlzLCBpc0FycmF5TGlrZU9iamVjdCksIHVuZGVmaW5lZCwgY29tcGFyYXRvcik7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuIGFycmF5IG9mIGdyb3VwZWQgZWxlbWVudHMsIHRoZSBmaXJzdCBvZiB3aGljaCBjb250YWlucyB0aGVcbiAgICAgKiBmaXJzdCBlbGVtZW50cyBvZiB0aGUgZ2l2ZW4gYXJyYXlzLCB0aGUgc2Vjb25kIG9mIHdoaWNoIGNvbnRhaW5zIHRoZVxuICAgICAqIHNlY29uZCBlbGVtZW50cyBvZiB0aGUgZ2l2ZW4gYXJyYXlzLCBhbmQgc28gb24uXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMC4xLjBcbiAgICAgKiBAY2F0ZWdvcnkgQXJyYXlcbiAgICAgKiBAcGFyYW0gey4uLkFycmF5fSBbYXJyYXlzXSBUaGUgYXJyYXlzIHRvIHByb2Nlc3MuXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIHRoZSBuZXcgYXJyYXkgb2YgZ3JvdXBlZCBlbGVtZW50cy5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy56aXAoWydhJywgJ2InXSwgWzEsIDJdLCBbdHJ1ZSwgZmFsc2VdKTtcbiAgICAgKiAvLyA9PiBbWydhJywgMSwgdHJ1ZV0sIFsnYicsIDIsIGZhbHNlXV1cbiAgICAgKi9cbiAgICB2YXIgemlwID0gYmFzZVJlc3QodW56aXApO1xuXG4gICAgLyoqXG4gICAgICogVGhpcyBtZXRob2QgaXMgbGlrZSBgXy5mcm9tUGFpcnNgIGV4Y2VwdCB0aGF0IGl0IGFjY2VwdHMgdHdvIGFycmF5cyxcbiAgICAgKiBvbmUgb2YgcHJvcGVydHkgaWRlbnRpZmllcnMgYW5kIG9uZSBvZiBjb3JyZXNwb25kaW5nIHZhbHVlcy5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAwLjQuMFxuICAgICAqIEBjYXRlZ29yeSBBcnJheVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IFtwcm9wcz1bXV0gVGhlIHByb3BlcnR5IGlkZW50aWZpZXJzLlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IFt2YWx1ZXM9W11dIFRoZSBwcm9wZXJ0eSB2YWx1ZXMuXG4gICAgICogQHJldHVybnMge09iamVjdH0gUmV0dXJucyB0aGUgbmV3IG9iamVjdC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy56aXBPYmplY3QoWydhJywgJ2InXSwgWzEsIDJdKTtcbiAgICAgKiAvLyA9PiB7ICdhJzogMSwgJ2InOiAyIH1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiB6aXBPYmplY3QocHJvcHMsIHZhbHVlcykge1xuICAgICAgcmV0dXJuIGJhc2VaaXBPYmplY3QocHJvcHMgfHwgW10sIHZhbHVlcyB8fCBbXSwgYXNzaWduVmFsdWUpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoaXMgbWV0aG9kIGlzIGxpa2UgYF8uemlwT2JqZWN0YCBleGNlcHQgdGhhdCBpdCBzdXBwb3J0cyBwcm9wZXJ0eSBwYXRocy5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSA0LjEuMFxuICAgICAqIEBjYXRlZ29yeSBBcnJheVxuICAgICAqIEBwYXJhbSB7QXJyYXl9IFtwcm9wcz1bXV0gVGhlIHByb3BlcnR5IGlkZW50aWZpZXJzLlxuICAgICAqIEBwYXJhbSB7QXJyYXl9IFt2YWx1ZXM9W11dIFRoZSBwcm9wZXJ0eSB2YWx1ZXMuXG4gICAgICogQHJldHVybnMge09iamVjdH0gUmV0dXJucyB0aGUgbmV3IG9iamVjdC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy56aXBPYmplY3REZWVwKFsnYS5iWzBdLmMnLCAnYS5iWzFdLmQnXSwgWzEsIDJdKTtcbiAgICAgKiAvLyA9PiB7ICdhJzogeyAnYic6IFt7ICdjJzogMSB9LCB7ICdkJzogMiB9XSB9IH1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiB6aXBPYmplY3REZWVwKHByb3BzLCB2YWx1ZXMpIHtcbiAgICAgIHJldHVybiBiYXNlWmlwT2JqZWN0KHByb3BzIHx8IFtdLCB2YWx1ZXMgfHwgW10sIGJhc2VTZXQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoaXMgbWV0aG9kIGlzIGxpa2UgYF8uemlwYCBleGNlcHQgdGhhdCBpdCBhY2NlcHRzIGBpdGVyYXRlZWAgdG8gc3BlY2lmeVxuICAgICAqIGhvdyBncm91cGVkIHZhbHVlcyBzaG91bGQgYmUgY29tYmluZWQuIFRoZSBpdGVyYXRlZSBpcyBpbnZva2VkIHdpdGggdGhlXG4gICAgICogZWxlbWVudHMgb2YgZWFjaCBncm91cDogKC4uLmdyb3VwKS5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAzLjguMFxuICAgICAqIEBjYXRlZ29yeSBBcnJheVxuICAgICAqIEBwYXJhbSB7Li4uQXJyYXl9IFthcnJheXNdIFRoZSBhcnJheXMgdG8gcHJvY2Vzcy5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbaXRlcmF0ZWU9Xy5pZGVudGl0eV0gVGhlIGZ1bmN0aW9uIHRvIGNvbWJpbmVcbiAgICAgKiAgZ3JvdXBlZCB2YWx1ZXMuXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIHRoZSBuZXcgYXJyYXkgb2YgZ3JvdXBlZCBlbGVtZW50cy5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy56aXBXaXRoKFsxLCAyXSwgWzEwLCAyMF0sIFsxMDAsIDIwMF0sIGZ1bmN0aW9uKGEsIGIsIGMpIHtcbiAgICAgKiAgIHJldHVybiBhICsgYiArIGM7XG4gICAgICogfSk7XG4gICAgICogLy8gPT4gWzExMSwgMjIyXVxuICAgICAqL1xuICAgIHZhciB6aXBXaXRoID0gYmFzZVJlc3QoZnVuY3Rpb24oYXJyYXlzKSB7XG4gICAgICB2YXIgbGVuZ3RoID0gYXJyYXlzLmxlbmd0aCxcbiAgICAgICAgICBpdGVyYXRlZSA9IGxlbmd0aCA+IDEgPyBhcnJheXNbbGVuZ3RoIC0gMV0gOiB1bmRlZmluZWQ7XG5cbiAgICAgIGl0ZXJhdGVlID0gdHlwZW9mIGl0ZXJhdGVlID09ICdmdW5jdGlvbicgPyAoYXJyYXlzLnBvcCgpLCBpdGVyYXRlZSkgOiB1bmRlZmluZWQ7XG4gICAgICByZXR1cm4gdW56aXBXaXRoKGFycmF5cywgaXRlcmF0ZWUpO1xuICAgIH0pO1xuXG4gICAgLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGBsb2Rhc2hgIHdyYXBwZXIgaW5zdGFuY2UgdGhhdCB3cmFwcyBgdmFsdWVgIHdpdGggZXhwbGljaXQgbWV0aG9kXG4gICAgICogY2hhaW4gc2VxdWVuY2VzIGVuYWJsZWQuIFRoZSByZXN1bHQgb2Ygc3VjaCBzZXF1ZW5jZXMgbXVzdCBiZSB1bndyYXBwZWRcbiAgICAgKiB3aXRoIGBfI3ZhbHVlYC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAxLjMuMFxuICAgICAqIEBjYXRlZ29yeSBTZXFcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byB3cmFwLlxuICAgICAqIEByZXR1cm5zIHtPYmplY3R9IFJldHVybnMgdGhlIG5ldyBgbG9kYXNoYCB3cmFwcGVyIGluc3RhbmNlLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiB2YXIgdXNlcnMgPSBbXG4gICAgICogICB7ICd1c2VyJzogJ2Jhcm5leScsICAnYWdlJzogMzYgfSxcbiAgICAgKiAgIHsgJ3VzZXInOiAnZnJlZCcsICAgICdhZ2UnOiA0MCB9LFxuICAgICAqICAgeyAndXNlcic6ICdwZWJibGVzJywgJ2FnZSc6IDEgfVxuICAgICAqIF07XG4gICAgICpcbiAgICAgKiB2YXIgeW91bmdlc3QgPSBfXG4gICAgICogICAuY2hhaW4odXNlcnMpXG4gICAgICogICAuc29ydEJ5KCdhZ2UnKVxuICAgICAqICAgLm1hcChmdW5jdGlvbihvKSB7XG4gICAgICogICAgIHJldHVybiBvLnVzZXIgKyAnIGlzICcgKyBvLmFnZTtcbiAgICAgKiAgIH0pXG4gICAgICogICAuaGVhZCgpXG4gICAgICogICAudmFsdWUoKTtcbiAgICAgKiAvLyA9PiAncGViYmxlcyBpcyAxJ1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNoYWluKHZhbHVlKSB7XG4gICAgICB2YXIgcmVzdWx0ID0gbG9kYXNoKHZhbHVlKTtcbiAgICAgIHJlc3VsdC5fX2NoYWluX18gPSB0cnVlO1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGlzIG1ldGhvZCBpbnZva2VzIGBpbnRlcmNlcHRvcmAgYW5kIHJldHVybnMgYHZhbHVlYC4gVGhlIGludGVyY2VwdG9yXG4gICAgICogaXMgaW52b2tlZCB3aXRoIG9uZSBhcmd1bWVudDsgKHZhbHVlKS4gVGhlIHB1cnBvc2Ugb2YgdGhpcyBtZXRob2QgaXMgdG9cbiAgICAgKiBcInRhcCBpbnRvXCIgYSBtZXRob2QgY2hhaW4gc2VxdWVuY2UgaW4gb3JkZXIgdG8gbW9kaWZ5IGludGVybWVkaWF0ZSByZXN1bHRzLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDAuMS4wXG4gICAgICogQGNhdGVnb3J5IFNlcVxuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIHByb3ZpZGUgdG8gYGludGVyY2VwdG9yYC5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBpbnRlcmNlcHRvciBUaGUgZnVuY3Rpb24gdG8gaW52b2tlLlxuICAgICAqIEByZXR1cm5zIHsqfSBSZXR1cm5zIGB2YWx1ZWAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8oWzEsIDIsIDNdKVxuICAgICAqICAudGFwKGZ1bmN0aW9uKGFycmF5KSB7XG4gICAgICogICAgLy8gTXV0YXRlIGlucHV0IGFycmF5LlxuICAgICAqICAgIGFycmF5LnBvcCgpO1xuICAgICAqICB9KVxuICAgICAqICAucmV2ZXJzZSgpXG4gICAgICogIC52YWx1ZSgpO1xuICAgICAqIC8vID0+IFsyLCAxXVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHRhcCh2YWx1ZSwgaW50ZXJjZXB0b3IpIHtcbiAgICAgIGludGVyY2VwdG9yKHZhbHVlKTtcbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGlzIG1ldGhvZCBpcyBsaWtlIGBfLnRhcGAgZXhjZXB0IHRoYXQgaXQgcmV0dXJucyB0aGUgcmVzdWx0IG9mIGBpbnRlcmNlcHRvcmAuXG4gICAgICogVGhlIHB1cnBvc2Ugb2YgdGhpcyBtZXRob2QgaXMgdG8gXCJwYXNzIHRocnVcIiB2YWx1ZXMgcmVwbGFjaW5nIGludGVybWVkaWF0ZVxuICAgICAqIHJlc3VsdHMgaW4gYSBtZXRob2QgY2hhaW4gc2VxdWVuY2UuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMy4wLjBcbiAgICAgKiBAY2F0ZWdvcnkgU2VxXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gcHJvdmlkZSB0byBgaW50ZXJjZXB0b3JgLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGludGVyY2VwdG9yIFRoZSBmdW5jdGlvbiB0byBpbnZva2UuXG4gICAgICogQHJldHVybnMgeyp9IFJldHVybnMgdGhlIHJlc3VsdCBvZiBgaW50ZXJjZXB0b3JgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfKCcgIGFiYyAgJylcbiAgICAgKiAgLmNoYWluKClcbiAgICAgKiAgLnRyaW0oKVxuICAgICAqICAudGhydShmdW5jdGlvbih2YWx1ZSkge1xuICAgICAqICAgIHJldHVybiBbdmFsdWVdO1xuICAgICAqICB9KVxuICAgICAqICAudmFsdWUoKTtcbiAgICAgKiAvLyA9PiBbJ2FiYyddXG4gICAgICovXG4gICAgZnVuY3Rpb24gdGhydSh2YWx1ZSwgaW50ZXJjZXB0b3IpIHtcbiAgICAgIHJldHVybiBpbnRlcmNlcHRvcih2YWx1ZSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhpcyBtZXRob2QgaXMgdGhlIHdyYXBwZXIgdmVyc2lvbiBvZiBgXy5hdGAuXG4gICAgICpcbiAgICAgKiBAbmFtZSBhdFxuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDEuMC4wXG4gICAgICogQGNhdGVnb3J5IFNlcVxuICAgICAqIEBwYXJhbSB7Li4uKHN0cmluZ3xzdHJpbmdbXSl9IFtwYXRoc10gVGhlIHByb3BlcnR5IHBhdGhzIHRvIHBpY2suXG4gICAgICogQHJldHVybnMge09iamVjdH0gUmV0dXJucyB0aGUgbmV3IGBsb2Rhc2hgIHdyYXBwZXIgaW5zdGFuY2UuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciBvYmplY3QgPSB7ICdhJzogW3sgJ2InOiB7ICdjJzogMyB9IH0sIDRdIH07XG4gICAgICpcbiAgICAgKiBfKG9iamVjdCkuYXQoWydhWzBdLmIuYycsICdhWzFdJ10pLnZhbHVlKCk7XG4gICAgICogLy8gPT4gWzMsIDRdXG4gICAgICovXG4gICAgdmFyIHdyYXBwZXJBdCA9IGZsYXRSZXN0KGZ1bmN0aW9uKHBhdGhzKSB7XG4gICAgICB2YXIgbGVuZ3RoID0gcGF0aHMubGVuZ3RoLFxuICAgICAgICAgIHN0YXJ0ID0gbGVuZ3RoID8gcGF0aHNbMF0gOiAwLFxuICAgICAgICAgIHZhbHVlID0gdGhpcy5fX3dyYXBwZWRfXyxcbiAgICAgICAgICBpbnRlcmNlcHRvciA9IGZ1bmN0aW9uKG9iamVjdCkgeyByZXR1cm4gYmFzZUF0KG9iamVjdCwgcGF0aHMpOyB9O1xuXG4gICAgICBpZiAobGVuZ3RoID4gMSB8fCB0aGlzLl9fYWN0aW9uc19fLmxlbmd0aCB8fFxuICAgICAgICAgICEodmFsdWUgaW5zdGFuY2VvZiBMYXp5V3JhcHBlcikgfHwgIWlzSW5kZXgoc3RhcnQpKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnRocnUoaW50ZXJjZXB0b3IpO1xuICAgICAgfVxuICAgICAgdmFsdWUgPSB2YWx1ZS5zbGljZShzdGFydCwgK3N0YXJ0ICsgKGxlbmd0aCA/IDEgOiAwKSk7XG4gICAgICB2YWx1ZS5fX2FjdGlvbnNfXy5wdXNoKHtcbiAgICAgICAgJ2Z1bmMnOiB0aHJ1LFxuICAgICAgICAnYXJncyc6IFtpbnRlcmNlcHRvcl0sXG4gICAgICAgICd0aGlzQXJnJzogdW5kZWZpbmVkXG4gICAgICB9KTtcbiAgICAgIHJldHVybiBuZXcgTG9kYXNoV3JhcHBlcih2YWx1ZSwgdGhpcy5fX2NoYWluX18pLnRocnUoZnVuY3Rpb24oYXJyYXkpIHtcbiAgICAgICAgaWYgKGxlbmd0aCAmJiAhYXJyYXkubGVuZ3RoKSB7XG4gICAgICAgICAgYXJyYXkucHVzaCh1bmRlZmluZWQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhcnJheTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGBsb2Rhc2hgIHdyYXBwZXIgaW5zdGFuY2Ugd2l0aCBleHBsaWNpdCBtZXRob2QgY2hhaW4gc2VxdWVuY2VzIGVuYWJsZWQuXG4gICAgICpcbiAgICAgKiBAbmFtZSBjaGFpblxuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDAuMS4wXG4gICAgICogQGNhdGVnb3J5IFNlcVxuICAgICAqIEByZXR1cm5zIHtPYmplY3R9IFJldHVybnMgdGhlIG5ldyBgbG9kYXNoYCB3cmFwcGVyIGluc3RhbmNlLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiB2YXIgdXNlcnMgPSBbXG4gICAgICogICB7ICd1c2VyJzogJ2Jhcm5leScsICdhZ2UnOiAzNiB9LFxuICAgICAqICAgeyAndXNlcic6ICdmcmVkJywgICAnYWdlJzogNDAgfVxuICAgICAqIF07XG4gICAgICpcbiAgICAgKiAvLyBBIHNlcXVlbmNlIHdpdGhvdXQgZXhwbGljaXQgY2hhaW5pbmcuXG4gICAgICogXyh1c2VycykuaGVhZCgpO1xuICAgICAqIC8vID0+IHsgJ3VzZXInOiAnYmFybmV5JywgJ2FnZSc6IDM2IH1cbiAgICAgKlxuICAgICAqIC8vIEEgc2VxdWVuY2Ugd2l0aCBleHBsaWNpdCBjaGFpbmluZy5cbiAgICAgKiBfKHVzZXJzKVxuICAgICAqICAgLmNoYWluKClcbiAgICAgKiAgIC5oZWFkKClcbiAgICAgKiAgIC5waWNrKCd1c2VyJylcbiAgICAgKiAgIC52YWx1ZSgpO1xuICAgICAqIC8vID0+IHsgJ3VzZXInOiAnYmFybmV5JyB9XG4gICAgICovXG4gICAgZnVuY3Rpb24gd3JhcHBlckNoYWluKCkge1xuICAgICAgcmV0dXJuIGNoYWluKHRoaXMpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEV4ZWN1dGVzIHRoZSBjaGFpbiBzZXF1ZW5jZSBhbmQgcmV0dXJucyB0aGUgd3JhcHBlZCByZXN1bHQuXG4gICAgICpcbiAgICAgKiBAbmFtZSBjb21taXRcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAzLjIuMFxuICAgICAqIEBjYXRlZ29yeSBTZXFcbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIHRoZSBuZXcgYGxvZGFzaGAgd3JhcHBlciBpbnN0YW5jZS5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogdmFyIGFycmF5ID0gWzEsIDJdO1xuICAgICAqIHZhciB3cmFwcGVkID0gXyhhcnJheSkucHVzaCgzKTtcbiAgICAgKlxuICAgICAqIGNvbnNvbGUubG9nKGFycmF5KTtcbiAgICAgKiAvLyA9PiBbMSwgMl1cbiAgICAgKlxuICAgICAqIHdyYXBwZWQgPSB3cmFwcGVkLmNvbW1pdCgpO1xuICAgICAqIGNvbnNvbGUubG9nKGFycmF5KTtcbiAgICAgKiAvLyA9PiBbMSwgMiwgM11cbiAgICAgKlxuICAgICAqIHdyYXBwZWQubGFzdCgpO1xuICAgICAqIC8vID0+IDNcbiAgICAgKlxuICAgICAqIGNvbnNvbGUubG9nKGFycmF5KTtcbiAgICAgKiAvLyA9PiBbMSwgMiwgM11cbiAgICAgKi9cbiAgICBmdW5jdGlvbiB3cmFwcGVyQ29tbWl0KCkge1xuICAgICAgcmV0dXJuIG5ldyBMb2Rhc2hXcmFwcGVyKHRoaXMudmFsdWUoKSwgdGhpcy5fX2NoYWluX18pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIG5leHQgdmFsdWUgb24gYSB3cmFwcGVkIG9iamVjdCBmb2xsb3dpbmcgdGhlXG4gICAgICogW2l0ZXJhdG9yIHByb3RvY29sXShodHRwczovL21kbi5pby9pdGVyYXRpb25fcHJvdG9jb2xzI2l0ZXJhdG9yKS5cbiAgICAgKlxuICAgICAqIEBuYW1lIG5leHRcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSA0LjAuMFxuICAgICAqIEBjYXRlZ29yeSBTZXFcbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIHRoZSBuZXh0IGl0ZXJhdG9yIHZhbHVlLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiB2YXIgd3JhcHBlZCA9IF8oWzEsIDJdKTtcbiAgICAgKlxuICAgICAqIHdyYXBwZWQubmV4dCgpO1xuICAgICAqIC8vID0+IHsgJ2RvbmUnOiBmYWxzZSwgJ3ZhbHVlJzogMSB9XG4gICAgICpcbiAgICAgKiB3cmFwcGVkLm5leHQoKTtcbiAgICAgKiAvLyA9PiB7ICdkb25lJzogZmFsc2UsICd2YWx1ZSc6IDIgfVxuICAgICAqXG4gICAgICogd3JhcHBlZC5uZXh0KCk7XG4gICAgICogLy8gPT4geyAnZG9uZSc6IHRydWUsICd2YWx1ZSc6IHVuZGVmaW5lZCB9XG4gICAgICovXG4gICAgZnVuY3Rpb24gd3JhcHBlck5leHQoKSB7XG4gICAgICBpZiAodGhpcy5fX3ZhbHVlc19fID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdGhpcy5fX3ZhbHVlc19fID0gdG9BcnJheSh0aGlzLnZhbHVlKCkpO1xuICAgICAgfVxuICAgICAgdmFyIGRvbmUgPSB0aGlzLl9faW5kZXhfXyA+PSB0aGlzLl9fdmFsdWVzX18ubGVuZ3RoLFxuICAgICAgICAgIHZhbHVlID0gZG9uZSA/IHVuZGVmaW5lZCA6IHRoaXMuX192YWx1ZXNfX1t0aGlzLl9faW5kZXhfXysrXTtcblxuICAgICAgcmV0dXJuIHsgJ2RvbmUnOiBkb25lLCAndmFsdWUnOiB2YWx1ZSB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEVuYWJsZXMgdGhlIHdyYXBwZXIgdG8gYmUgaXRlcmFibGUuXG4gICAgICpcbiAgICAgKiBAbmFtZSBTeW1ib2wuaXRlcmF0b3JcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSA0LjAuMFxuICAgICAqIEBjYXRlZ29yeSBTZXFcbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIHRoZSB3cmFwcGVyIG9iamVjdC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogdmFyIHdyYXBwZWQgPSBfKFsxLCAyXSk7XG4gICAgICpcbiAgICAgKiB3cmFwcGVkW1N5bWJvbC5pdGVyYXRvcl0oKSA9PT0gd3JhcHBlZDtcbiAgICAgKiAvLyA9PiB0cnVlXG4gICAgICpcbiAgICAgKiBBcnJheS5mcm9tKHdyYXBwZWQpO1xuICAgICAqIC8vID0+IFsxLCAyXVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHdyYXBwZXJUb0l0ZXJhdG9yKCkge1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGNsb25lIG9mIHRoZSBjaGFpbiBzZXF1ZW5jZSBwbGFudGluZyBgdmFsdWVgIGFzIHRoZSB3cmFwcGVkIHZhbHVlLlxuICAgICAqXG4gICAgICogQG5hbWUgcGxhbnRcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAzLjIuMFxuICAgICAqIEBjYXRlZ29yeSBTZXFcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBwbGFudC5cbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIHRoZSBuZXcgYGxvZGFzaGAgd3JhcHBlciBpbnN0YW5jZS5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogZnVuY3Rpb24gc3F1YXJlKG4pIHtcbiAgICAgKiAgIHJldHVybiBuICogbjtcbiAgICAgKiB9XG4gICAgICpcbiAgICAgKiB2YXIgd3JhcHBlZCA9IF8oWzEsIDJdKS5tYXAoc3F1YXJlKTtcbiAgICAgKiB2YXIgb3RoZXIgPSB3cmFwcGVkLnBsYW50KFszLCA0XSk7XG4gICAgICpcbiAgICAgKiBvdGhlci52YWx1ZSgpO1xuICAgICAqIC8vID0+IFs5LCAxNl1cbiAgICAgKlxuICAgICAqIHdyYXBwZWQudmFsdWUoKTtcbiAgICAgKiAvLyA9PiBbMSwgNF1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiB3cmFwcGVyUGxhbnQodmFsdWUpIHtcbiAgICAgIHZhciByZXN1bHQsXG4gICAgICAgICAgcGFyZW50ID0gdGhpcztcblxuICAgICAgd2hpbGUgKHBhcmVudCBpbnN0YW5jZW9mIGJhc2VMb2Rhc2gpIHtcbiAgICAgICAgdmFyIGNsb25lID0gd3JhcHBlckNsb25lKHBhcmVudCk7XG4gICAgICAgIGNsb25lLl9faW5kZXhfXyA9IDA7XG4gICAgICAgIGNsb25lLl9fdmFsdWVzX18gPSB1bmRlZmluZWQ7XG4gICAgICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgICBwcmV2aW91cy5fX3dyYXBwZWRfXyA9IGNsb25lO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJlc3VsdCA9IGNsb25lO1xuICAgICAgICB9XG4gICAgICAgIHZhciBwcmV2aW91cyA9IGNsb25lO1xuICAgICAgICBwYXJlbnQgPSBwYXJlbnQuX193cmFwcGVkX187XG4gICAgICB9XG4gICAgICBwcmV2aW91cy5fX3dyYXBwZWRfXyA9IHZhbHVlO1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGlzIG1ldGhvZCBpcyB0aGUgd3JhcHBlciB2ZXJzaW9uIG9mIGBfLnJldmVyc2VgLlxuICAgICAqXG4gICAgICogKipOb3RlOioqIFRoaXMgbWV0aG9kIG11dGF0ZXMgdGhlIHdyYXBwZWQgYXJyYXkuXG4gICAgICpcbiAgICAgKiBAbmFtZSByZXZlcnNlXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMC4xLjBcbiAgICAgKiBAY2F0ZWdvcnkgU2VxXG4gICAgICogQHJldHVybnMge09iamVjdH0gUmV0dXJucyB0aGUgbmV3IGBsb2Rhc2hgIHdyYXBwZXIgaW5zdGFuY2UuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciBhcnJheSA9IFsxLCAyLCAzXTtcbiAgICAgKlxuICAgICAqIF8oYXJyYXkpLnJldmVyc2UoKS52YWx1ZSgpXG4gICAgICogLy8gPT4gWzMsIDIsIDFdXG4gICAgICpcbiAgICAgKiBjb25zb2xlLmxvZyhhcnJheSk7XG4gICAgICogLy8gPT4gWzMsIDIsIDFdXG4gICAgICovXG4gICAgZnVuY3Rpb24gd3JhcHBlclJldmVyc2UoKSB7XG4gICAgICB2YXIgdmFsdWUgPSB0aGlzLl9fd3JhcHBlZF9fO1xuICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgTGF6eVdyYXBwZXIpIHtcbiAgICAgICAgdmFyIHdyYXBwZWQgPSB2YWx1ZTtcbiAgICAgICAgaWYgKHRoaXMuX19hY3Rpb25zX18ubGVuZ3RoKSB7XG4gICAgICAgICAgd3JhcHBlZCA9IG5ldyBMYXp5V3JhcHBlcih0aGlzKTtcbiAgICAgICAgfVxuICAgICAgICB3cmFwcGVkID0gd3JhcHBlZC5yZXZlcnNlKCk7XG4gICAgICAgIHdyYXBwZWQuX19hY3Rpb25zX18ucHVzaCh7XG4gICAgICAgICAgJ2Z1bmMnOiB0aHJ1LFxuICAgICAgICAgICdhcmdzJzogW3JldmVyc2VdLFxuICAgICAgICAgICd0aGlzQXJnJzogdW5kZWZpbmVkXG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gbmV3IExvZGFzaFdyYXBwZXIod3JhcHBlZCwgdGhpcy5fX2NoYWluX18pO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXMudGhydShyZXZlcnNlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBFeGVjdXRlcyB0aGUgY2hhaW4gc2VxdWVuY2UgdG8gcmVzb2x2ZSB0aGUgdW53cmFwcGVkIHZhbHVlLlxuICAgICAqXG4gICAgICogQG5hbWUgdmFsdWVcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAwLjEuMFxuICAgICAqIEBhbGlhcyB0b0pTT04sIHZhbHVlT2ZcbiAgICAgKiBAY2F0ZWdvcnkgU2VxXG4gICAgICogQHJldHVybnMgeyp9IFJldHVybnMgdGhlIHJlc29sdmVkIHVud3JhcHBlZCB2YWx1ZS5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXyhbMSwgMiwgM10pLnZhbHVlKCk7XG4gICAgICogLy8gPT4gWzEsIDIsIDNdXG4gICAgICovXG4gICAgZnVuY3Rpb24gd3JhcHBlclZhbHVlKCkge1xuICAgICAgcmV0dXJuIGJhc2VXcmFwcGVyVmFsdWUodGhpcy5fX3dyYXBwZWRfXywgdGhpcy5fX2FjdGlvbnNfXyk7XG4gICAgfVxuXG4gICAgLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbiBvYmplY3QgY29tcG9zZWQgb2Yga2V5cyBnZW5lcmF0ZWQgZnJvbSB0aGUgcmVzdWx0cyBvZiBydW5uaW5nXG4gICAgICogZWFjaCBlbGVtZW50IG9mIGBjb2xsZWN0aW9uYCB0aHJ1IGBpdGVyYXRlZWAuIFRoZSBjb3JyZXNwb25kaW5nIHZhbHVlIG9mXG4gICAgICogZWFjaCBrZXkgaXMgdGhlIG51bWJlciBvZiB0aW1lcyB0aGUga2V5IHdhcyByZXR1cm5lZCBieSBgaXRlcmF0ZWVgLiBUaGVcbiAgICAgKiBpdGVyYXRlZSBpcyBpbnZva2VkIHdpdGggb25lIGFyZ3VtZW50OiAodmFsdWUpLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDAuNS4wXG4gICAgICogQGNhdGVnb3J5IENvbGxlY3Rpb25cbiAgICAgKiBAcGFyYW0ge0FycmF5fE9iamVjdH0gY29sbGVjdGlvbiBUaGUgY29sbGVjdGlvbiB0byBpdGVyYXRlIG92ZXIuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gW2l0ZXJhdGVlPV8uaWRlbnRpdHldIFRoZSBpdGVyYXRlZSB0byB0cmFuc2Zvcm0ga2V5cy5cbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIHRoZSBjb21wb3NlZCBhZ2dyZWdhdGUgb2JqZWN0LlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLmNvdW50QnkoWzYuMSwgNC4yLCA2LjNdLCBNYXRoLmZsb29yKTtcbiAgICAgKiAvLyA9PiB7ICc0JzogMSwgJzYnOiAyIH1cbiAgICAgKlxuICAgICAqIC8vIFRoZSBgXy5wcm9wZXJ0eWAgaXRlcmF0ZWUgc2hvcnRoYW5kLlxuICAgICAqIF8uY291bnRCeShbJ29uZScsICd0d28nLCAndGhyZWUnXSwgJ2xlbmd0aCcpO1xuICAgICAqIC8vID0+IHsgJzMnOiAyLCAnNSc6IDEgfVxuICAgICAqL1xuICAgIHZhciBjb3VudEJ5ID0gY3JlYXRlQWdncmVnYXRvcihmdW5jdGlvbihyZXN1bHQsIHZhbHVlLCBrZXkpIHtcbiAgICAgIGlmIChoYXNPd25Qcm9wZXJ0eS5jYWxsKHJlc3VsdCwga2V5KSkge1xuICAgICAgICArK3Jlc3VsdFtrZXldO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYmFzZUFzc2lnblZhbHVlKHJlc3VsdCwga2V5LCAxKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIENoZWNrcyBpZiBgcHJlZGljYXRlYCByZXR1cm5zIHRydXRoeSBmb3IgKiphbGwqKiBlbGVtZW50cyBvZiBgY29sbGVjdGlvbmAuXG4gICAgICogSXRlcmF0aW9uIGlzIHN0b3BwZWQgb25jZSBgcHJlZGljYXRlYCByZXR1cm5zIGZhbHNleS4gVGhlIHByZWRpY2F0ZSBpc1xuICAgICAqIGludm9rZWQgd2l0aCB0aHJlZSBhcmd1bWVudHM6ICh2YWx1ZSwgaW5kZXh8a2V5LCBjb2xsZWN0aW9uKS5cbiAgICAgKlxuICAgICAqICoqTm90ZToqKiBUaGlzIG1ldGhvZCByZXR1cm5zIGB0cnVlYCBmb3JcbiAgICAgKiBbZW1wdHkgY29sbGVjdGlvbnNdKGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0VtcHR5X3NldCkgYmVjYXVzZVxuICAgICAqIFtldmVyeXRoaW5nIGlzIHRydWVdKGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL1ZhY3VvdXNfdHJ1dGgpIG9mXG4gICAgICogZWxlbWVudHMgb2YgZW1wdHkgY29sbGVjdGlvbnMuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMC4xLjBcbiAgICAgKiBAY2F0ZWdvcnkgQ29sbGVjdGlvblxuICAgICAqIEBwYXJhbSB7QXJyYXl8T2JqZWN0fSBjb2xsZWN0aW9uIFRoZSBjb2xsZWN0aW9uIHRvIGl0ZXJhdGUgb3Zlci5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbcHJlZGljYXRlPV8uaWRlbnRpdHldIFRoZSBmdW5jdGlvbiBpbnZva2VkIHBlciBpdGVyYXRpb24uXG4gICAgICogQHBhcmFtLSB7T2JqZWN0fSBbZ3VhcmRdIEVuYWJsZXMgdXNlIGFzIGFuIGl0ZXJhdGVlIGZvciBtZXRob2RzIGxpa2UgYF8ubWFwYC5cbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYWxsIGVsZW1lbnRzIHBhc3MgdGhlIHByZWRpY2F0ZSBjaGVjayxcbiAgICAgKiAgZWxzZSBgZmFsc2VgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLmV2ZXJ5KFt0cnVlLCAxLCBudWxsLCAneWVzJ10sIEJvb2xlYW4pO1xuICAgICAqIC8vID0+IGZhbHNlXG4gICAgICpcbiAgICAgKiB2YXIgdXNlcnMgPSBbXG4gICAgICogICB7ICd1c2VyJzogJ2Jhcm5leScsICdhZ2UnOiAzNiwgJ2FjdGl2ZSc6IGZhbHNlIH0sXG4gICAgICogICB7ICd1c2VyJzogJ2ZyZWQnLCAgICdhZ2UnOiA0MCwgJ2FjdGl2ZSc6IGZhbHNlIH1cbiAgICAgKiBdO1xuICAgICAqXG4gICAgICogLy8gVGhlIGBfLm1hdGNoZXNgIGl0ZXJhdGVlIHNob3J0aGFuZC5cbiAgICAgKiBfLmV2ZXJ5KHVzZXJzLCB7ICd1c2VyJzogJ2Jhcm5leScsICdhY3RpdmUnOiBmYWxzZSB9KTtcbiAgICAgKiAvLyA9PiBmYWxzZVxuICAgICAqXG4gICAgICogLy8gVGhlIGBfLm1hdGNoZXNQcm9wZXJ0eWAgaXRlcmF0ZWUgc2hvcnRoYW5kLlxuICAgICAqIF8uZXZlcnkodXNlcnMsIFsnYWN0aXZlJywgZmFsc2VdKTtcbiAgICAgKiAvLyA9PiB0cnVlXG4gICAgICpcbiAgICAgKiAvLyBUaGUgYF8ucHJvcGVydHlgIGl0ZXJhdGVlIHNob3J0aGFuZC5cbiAgICAgKiBfLmV2ZXJ5KHVzZXJzLCAnYWN0aXZlJyk7XG4gICAgICogLy8gPT4gZmFsc2VcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBldmVyeShjb2xsZWN0aW9uLCBwcmVkaWNhdGUsIGd1YXJkKSB7XG4gICAgICB2YXIgZnVuYyA9IGlzQXJyYXkoY29sbGVjdGlvbikgPyBhcnJheUV2ZXJ5IDogYmFzZUV2ZXJ5O1xuICAgICAgaWYgKGd1YXJkICYmIGlzSXRlcmF0ZWVDYWxsKGNvbGxlY3Rpb24sIHByZWRpY2F0ZSwgZ3VhcmQpKSB7XG4gICAgICAgIHByZWRpY2F0ZSA9IHVuZGVmaW5lZDtcbiAgICAgIH1cbiAgICAgIHJldHVybiBmdW5jKGNvbGxlY3Rpb24sIGdldEl0ZXJhdGVlKHByZWRpY2F0ZSwgMykpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEl0ZXJhdGVzIG92ZXIgZWxlbWVudHMgb2YgYGNvbGxlY3Rpb25gLCByZXR1cm5pbmcgYW4gYXJyYXkgb2YgYWxsIGVsZW1lbnRzXG4gICAgICogYHByZWRpY2F0ZWAgcmV0dXJucyB0cnV0aHkgZm9yLiBUaGUgcHJlZGljYXRlIGlzIGludm9rZWQgd2l0aCB0aHJlZVxuICAgICAqIGFyZ3VtZW50czogKHZhbHVlLCBpbmRleHxrZXksIGNvbGxlY3Rpb24pLlxuICAgICAqXG4gICAgICogKipOb3RlOioqIFVubGlrZSBgXy5yZW1vdmVgLCB0aGlzIG1ldGhvZCByZXR1cm5zIGEgbmV3IGFycmF5LlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDAuMS4wXG4gICAgICogQGNhdGVnb3J5IENvbGxlY3Rpb25cbiAgICAgKiBAcGFyYW0ge0FycmF5fE9iamVjdH0gY29sbGVjdGlvbiBUaGUgY29sbGVjdGlvbiB0byBpdGVyYXRlIG92ZXIuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gW3ByZWRpY2F0ZT1fLmlkZW50aXR5XSBUaGUgZnVuY3Rpb24gaW52b2tlZCBwZXIgaXRlcmF0aW9uLlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgbmV3IGZpbHRlcmVkIGFycmF5LlxuICAgICAqIEBzZWUgXy5yZWplY3RcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogdmFyIHVzZXJzID0gW1xuICAgICAqICAgeyAndXNlcic6ICdiYXJuZXknLCAnYWdlJzogMzYsICdhY3RpdmUnOiB0cnVlIH0sXG4gICAgICogICB7ICd1c2VyJzogJ2ZyZWQnLCAgICdhZ2UnOiA0MCwgJ2FjdGl2ZSc6IGZhbHNlIH1cbiAgICAgKiBdO1xuICAgICAqXG4gICAgICogXy5maWx0ZXIodXNlcnMsIGZ1bmN0aW9uKG8pIHsgcmV0dXJuICFvLmFjdGl2ZTsgfSk7XG4gICAgICogLy8gPT4gb2JqZWN0cyBmb3IgWydmcmVkJ11cbiAgICAgKlxuICAgICAqIC8vIFRoZSBgXy5tYXRjaGVzYCBpdGVyYXRlZSBzaG9ydGhhbmQuXG4gICAgICogXy5maWx0ZXIodXNlcnMsIHsgJ2FnZSc6IDM2LCAnYWN0aXZlJzogdHJ1ZSB9KTtcbiAgICAgKiAvLyA9PiBvYmplY3RzIGZvciBbJ2Jhcm5leSddXG4gICAgICpcbiAgICAgKiAvLyBUaGUgYF8ubWF0Y2hlc1Byb3BlcnR5YCBpdGVyYXRlZSBzaG9ydGhhbmQuXG4gICAgICogXy5maWx0ZXIodXNlcnMsIFsnYWN0aXZlJywgZmFsc2VdKTtcbiAgICAgKiAvLyA9PiBvYmplY3RzIGZvciBbJ2ZyZWQnXVxuICAgICAqXG4gICAgICogLy8gVGhlIGBfLnByb3BlcnR5YCBpdGVyYXRlZSBzaG9ydGhhbmQuXG4gICAgICogXy5maWx0ZXIodXNlcnMsICdhY3RpdmUnKTtcbiAgICAgKiAvLyA9PiBvYmplY3RzIGZvciBbJ2Jhcm5leSddXG4gICAgICovXG4gICAgZnVuY3Rpb24gZmlsdGVyKGNvbGxlY3Rpb24sIHByZWRpY2F0ZSkge1xuICAgICAgdmFyIGZ1bmMgPSBpc0FycmF5KGNvbGxlY3Rpb24pID8gYXJyYXlGaWx0ZXIgOiBiYXNlRmlsdGVyO1xuICAgICAgcmV0dXJuIGZ1bmMoY29sbGVjdGlvbiwgZ2V0SXRlcmF0ZWUocHJlZGljYXRlLCAzKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSXRlcmF0ZXMgb3ZlciBlbGVtZW50cyBvZiBgY29sbGVjdGlvbmAsIHJldHVybmluZyB0aGUgZmlyc3QgZWxlbWVudFxuICAgICAqIGBwcmVkaWNhdGVgIHJldHVybnMgdHJ1dGh5IGZvci4gVGhlIHByZWRpY2F0ZSBpcyBpbnZva2VkIHdpdGggdGhyZWVcbiAgICAgKiBhcmd1bWVudHM6ICh2YWx1ZSwgaW5kZXh8a2V5LCBjb2xsZWN0aW9uKS5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAwLjEuMFxuICAgICAqIEBjYXRlZ29yeSBDb2xsZWN0aW9uXG4gICAgICogQHBhcmFtIHtBcnJheXxPYmplY3R9IGNvbGxlY3Rpb24gVGhlIGNvbGxlY3Rpb24gdG8gaW5zcGVjdC5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbcHJlZGljYXRlPV8uaWRlbnRpdHldIFRoZSBmdW5jdGlvbiBpbnZva2VkIHBlciBpdGVyYXRpb24uXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtmcm9tSW5kZXg9MF0gVGhlIGluZGV4IHRvIHNlYXJjaCBmcm9tLlxuICAgICAqIEByZXR1cm5zIHsqfSBSZXR1cm5zIHRoZSBtYXRjaGVkIGVsZW1lbnQsIGVsc2UgYHVuZGVmaW5lZGAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciB1c2VycyA9IFtcbiAgICAgKiAgIHsgJ3VzZXInOiAnYmFybmV5JywgICdhZ2UnOiAzNiwgJ2FjdGl2ZSc6IHRydWUgfSxcbiAgICAgKiAgIHsgJ3VzZXInOiAnZnJlZCcsICAgICdhZ2UnOiA0MCwgJ2FjdGl2ZSc6IGZhbHNlIH0sXG4gICAgICogICB7ICd1c2VyJzogJ3BlYmJsZXMnLCAnYWdlJzogMSwgICdhY3RpdmUnOiB0cnVlIH1cbiAgICAgKiBdO1xuICAgICAqXG4gICAgICogXy5maW5kKHVzZXJzLCBmdW5jdGlvbihvKSB7IHJldHVybiBvLmFnZSA8IDQwOyB9KTtcbiAgICAgKiAvLyA9PiBvYmplY3QgZm9yICdiYXJuZXknXG4gICAgICpcbiAgICAgKiAvLyBUaGUgYF8ubWF0Y2hlc2AgaXRlcmF0ZWUgc2hvcnRoYW5kLlxuICAgICAqIF8uZmluZCh1c2VycywgeyAnYWdlJzogMSwgJ2FjdGl2ZSc6IHRydWUgfSk7XG4gICAgICogLy8gPT4gb2JqZWN0IGZvciAncGViYmxlcydcbiAgICAgKlxuICAgICAqIC8vIFRoZSBgXy5tYXRjaGVzUHJvcGVydHlgIGl0ZXJhdGVlIHNob3J0aGFuZC5cbiAgICAgKiBfLmZpbmQodXNlcnMsIFsnYWN0aXZlJywgZmFsc2VdKTtcbiAgICAgKiAvLyA9PiBvYmplY3QgZm9yICdmcmVkJ1xuICAgICAqXG4gICAgICogLy8gVGhlIGBfLnByb3BlcnR5YCBpdGVyYXRlZSBzaG9ydGhhbmQuXG4gICAgICogXy5maW5kKHVzZXJzLCAnYWN0aXZlJyk7XG4gICAgICogLy8gPT4gb2JqZWN0IGZvciAnYmFybmV5J1xuICAgICAqL1xuICAgIHZhciBmaW5kID0gY3JlYXRlRmluZChmaW5kSW5kZXgpO1xuXG4gICAgLyoqXG4gICAgICogVGhpcyBtZXRob2QgaXMgbGlrZSBgXy5maW5kYCBleGNlcHQgdGhhdCBpdCBpdGVyYXRlcyBvdmVyIGVsZW1lbnRzIG9mXG4gICAgICogYGNvbGxlY3Rpb25gIGZyb20gcmlnaHQgdG8gbGVmdC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAyLjAuMFxuICAgICAqIEBjYXRlZ29yeSBDb2xsZWN0aW9uXG4gICAgICogQHBhcmFtIHtBcnJheXxPYmplY3R9IGNvbGxlY3Rpb24gVGhlIGNvbGxlY3Rpb24gdG8gaW5zcGVjdC5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbcHJlZGljYXRlPV8uaWRlbnRpdHldIFRoZSBmdW5jdGlvbiBpbnZva2VkIHBlciBpdGVyYXRpb24uXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtmcm9tSW5kZXg9Y29sbGVjdGlvbi5sZW5ndGgtMV0gVGhlIGluZGV4IHRvIHNlYXJjaCBmcm9tLlxuICAgICAqIEByZXR1cm5zIHsqfSBSZXR1cm5zIHRoZSBtYXRjaGVkIGVsZW1lbnQsIGVsc2UgYHVuZGVmaW5lZGAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8uZmluZExhc3QoWzEsIDIsIDMsIDRdLCBmdW5jdGlvbihuKSB7XG4gICAgICogICByZXR1cm4gbiAlIDIgPT0gMTtcbiAgICAgKiB9KTtcbiAgICAgKiAvLyA9PiAzXG4gICAgICovXG4gICAgdmFyIGZpbmRMYXN0ID0gY3JlYXRlRmluZChmaW5kTGFzdEluZGV4KTtcblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBmbGF0dGVuZWQgYXJyYXkgb2YgdmFsdWVzIGJ5IHJ1bm5pbmcgZWFjaCBlbGVtZW50IGluIGBjb2xsZWN0aW9uYFxuICAgICAqIHRocnUgYGl0ZXJhdGVlYCBhbmQgZmxhdHRlbmluZyB0aGUgbWFwcGVkIHJlc3VsdHMuIFRoZSBpdGVyYXRlZSBpcyBpbnZva2VkXG4gICAgICogd2l0aCB0aHJlZSBhcmd1bWVudHM6ICh2YWx1ZSwgaW5kZXh8a2V5LCBjb2xsZWN0aW9uKS5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSA0LjAuMFxuICAgICAqIEBjYXRlZ29yeSBDb2xsZWN0aW9uXG4gICAgICogQHBhcmFtIHtBcnJheXxPYmplY3R9IGNvbGxlY3Rpb24gVGhlIGNvbGxlY3Rpb24gdG8gaXRlcmF0ZSBvdmVyLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtpdGVyYXRlZT1fLmlkZW50aXR5XSBUaGUgZnVuY3Rpb24gaW52b2tlZCBwZXIgaXRlcmF0aW9uLlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgbmV3IGZsYXR0ZW5lZCBhcnJheS5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogZnVuY3Rpb24gZHVwbGljYXRlKG4pIHtcbiAgICAgKiAgIHJldHVybiBbbiwgbl07XG4gICAgICogfVxuICAgICAqXG4gICAgICogXy5mbGF0TWFwKFsxLCAyXSwgZHVwbGljYXRlKTtcbiAgICAgKiAvLyA9PiBbMSwgMSwgMiwgMl1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBmbGF0TWFwKGNvbGxlY3Rpb24sIGl0ZXJhdGVlKSB7XG4gICAgICByZXR1cm4gYmFzZUZsYXR0ZW4obWFwKGNvbGxlY3Rpb24sIGl0ZXJhdGVlKSwgMSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhpcyBtZXRob2QgaXMgbGlrZSBgXy5mbGF0TWFwYCBleGNlcHQgdGhhdCBpdCByZWN1cnNpdmVseSBmbGF0dGVucyB0aGVcbiAgICAgKiBtYXBwZWQgcmVzdWx0cy5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSA0LjcuMFxuICAgICAqIEBjYXRlZ29yeSBDb2xsZWN0aW9uXG4gICAgICogQHBhcmFtIHtBcnJheXxPYmplY3R9IGNvbGxlY3Rpb24gVGhlIGNvbGxlY3Rpb24gdG8gaXRlcmF0ZSBvdmVyLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtpdGVyYXRlZT1fLmlkZW50aXR5XSBUaGUgZnVuY3Rpb24gaW52b2tlZCBwZXIgaXRlcmF0aW9uLlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgbmV3IGZsYXR0ZW5lZCBhcnJheS5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogZnVuY3Rpb24gZHVwbGljYXRlKG4pIHtcbiAgICAgKiAgIHJldHVybiBbW1tuLCBuXV1dO1xuICAgICAqIH1cbiAgICAgKlxuICAgICAqIF8uZmxhdE1hcERlZXAoWzEsIDJdLCBkdXBsaWNhdGUpO1xuICAgICAqIC8vID0+IFsxLCAxLCAyLCAyXVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGZsYXRNYXBEZWVwKGNvbGxlY3Rpb24sIGl0ZXJhdGVlKSB7XG4gICAgICByZXR1cm4gYmFzZUZsYXR0ZW4obWFwKGNvbGxlY3Rpb24sIGl0ZXJhdGVlKSwgSU5GSU5JVFkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoaXMgbWV0aG9kIGlzIGxpa2UgYF8uZmxhdE1hcGAgZXhjZXB0IHRoYXQgaXQgcmVjdXJzaXZlbHkgZmxhdHRlbnMgdGhlXG4gICAgICogbWFwcGVkIHJlc3VsdHMgdXAgdG8gYGRlcHRoYCB0aW1lcy5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSA0LjcuMFxuICAgICAqIEBjYXRlZ29yeSBDb2xsZWN0aW9uXG4gICAgICogQHBhcmFtIHtBcnJheXxPYmplY3R9IGNvbGxlY3Rpb24gVGhlIGNvbGxlY3Rpb24gdG8gaXRlcmF0ZSBvdmVyLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtpdGVyYXRlZT1fLmlkZW50aXR5XSBUaGUgZnVuY3Rpb24gaW52b2tlZCBwZXIgaXRlcmF0aW9uLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbZGVwdGg9MV0gVGhlIG1heGltdW0gcmVjdXJzaW9uIGRlcHRoLlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgbmV3IGZsYXR0ZW5lZCBhcnJheS5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogZnVuY3Rpb24gZHVwbGljYXRlKG4pIHtcbiAgICAgKiAgIHJldHVybiBbW1tuLCBuXV1dO1xuICAgICAqIH1cbiAgICAgKlxuICAgICAqIF8uZmxhdE1hcERlcHRoKFsxLCAyXSwgZHVwbGljYXRlLCAyKTtcbiAgICAgKiAvLyA9PiBbWzEsIDFdLCBbMiwgMl1dXG4gICAgICovXG4gICAgZnVuY3Rpb24gZmxhdE1hcERlcHRoKGNvbGxlY3Rpb24sIGl0ZXJhdGVlLCBkZXB0aCkge1xuICAgICAgZGVwdGggPSBkZXB0aCA9PT0gdW5kZWZpbmVkID8gMSA6IHRvSW50ZWdlcihkZXB0aCk7XG4gICAgICByZXR1cm4gYmFzZUZsYXR0ZW4obWFwKGNvbGxlY3Rpb24sIGl0ZXJhdGVlKSwgZGVwdGgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEl0ZXJhdGVzIG92ZXIgZWxlbWVudHMgb2YgYGNvbGxlY3Rpb25gIGFuZCBpbnZva2VzIGBpdGVyYXRlZWAgZm9yIGVhY2ggZWxlbWVudC5cbiAgICAgKiBUaGUgaXRlcmF0ZWUgaXMgaW52b2tlZCB3aXRoIHRocmVlIGFyZ3VtZW50czogKHZhbHVlLCBpbmRleHxrZXksIGNvbGxlY3Rpb24pLlxuICAgICAqIEl0ZXJhdGVlIGZ1bmN0aW9ucyBtYXkgZXhpdCBpdGVyYXRpb24gZWFybHkgYnkgZXhwbGljaXRseSByZXR1cm5pbmcgYGZhbHNlYC5cbiAgICAgKlxuICAgICAqICoqTm90ZToqKiBBcyB3aXRoIG90aGVyIFwiQ29sbGVjdGlvbnNcIiBtZXRob2RzLCBvYmplY3RzIHdpdGggYSBcImxlbmd0aFwiXG4gICAgICogcHJvcGVydHkgYXJlIGl0ZXJhdGVkIGxpa2UgYXJyYXlzLiBUbyBhdm9pZCB0aGlzIGJlaGF2aW9yIHVzZSBgXy5mb3JJbmBcbiAgICAgKiBvciBgXy5mb3JPd25gIGZvciBvYmplY3QgaXRlcmF0aW9uLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDAuMS4wXG4gICAgICogQGFsaWFzIGVhY2hcbiAgICAgKiBAY2F0ZWdvcnkgQ29sbGVjdGlvblxuICAgICAqIEBwYXJhbSB7QXJyYXl8T2JqZWN0fSBjb2xsZWN0aW9uIFRoZSBjb2xsZWN0aW9uIHRvIGl0ZXJhdGUgb3Zlci5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbaXRlcmF0ZWU9Xy5pZGVudGl0eV0gVGhlIGZ1bmN0aW9uIGludm9rZWQgcGVyIGl0ZXJhdGlvbi5cbiAgICAgKiBAcmV0dXJucyB7QXJyYXl8T2JqZWN0fSBSZXR1cm5zIGBjb2xsZWN0aW9uYC5cbiAgICAgKiBAc2VlIF8uZm9yRWFjaFJpZ2h0XG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8uZm9yRWFjaChbMSwgMl0sIGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICogICBjb25zb2xlLmxvZyh2YWx1ZSk7XG4gICAgICogfSk7XG4gICAgICogLy8gPT4gTG9ncyBgMWAgdGhlbiBgMmAuXG4gICAgICpcbiAgICAgKiBfLmZvckVhY2goeyAnYSc6IDEsICdiJzogMiB9LCBmdW5jdGlvbih2YWx1ZSwga2V5KSB7XG4gICAgICogICBjb25zb2xlLmxvZyhrZXkpO1xuICAgICAqIH0pO1xuICAgICAqIC8vID0+IExvZ3MgJ2EnIHRoZW4gJ2InIChpdGVyYXRpb24gb3JkZXIgaXMgbm90IGd1YXJhbnRlZWQpLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGZvckVhY2goY29sbGVjdGlvbiwgaXRlcmF0ZWUpIHtcbiAgICAgIHZhciBmdW5jID0gaXNBcnJheShjb2xsZWN0aW9uKSA/IGFycmF5RWFjaCA6IGJhc2VFYWNoO1xuICAgICAgcmV0dXJuIGZ1bmMoY29sbGVjdGlvbiwgZ2V0SXRlcmF0ZWUoaXRlcmF0ZWUsIDMpKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGlzIG1ldGhvZCBpcyBsaWtlIGBfLmZvckVhY2hgIGV4Y2VwdCB0aGF0IGl0IGl0ZXJhdGVzIG92ZXIgZWxlbWVudHMgb2ZcbiAgICAgKiBgY29sbGVjdGlvbmAgZnJvbSByaWdodCB0byBsZWZ0LlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDIuMC4wXG4gICAgICogQGFsaWFzIGVhY2hSaWdodFxuICAgICAqIEBjYXRlZ29yeSBDb2xsZWN0aW9uXG4gICAgICogQHBhcmFtIHtBcnJheXxPYmplY3R9IGNvbGxlY3Rpb24gVGhlIGNvbGxlY3Rpb24gdG8gaXRlcmF0ZSBvdmVyLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtpdGVyYXRlZT1fLmlkZW50aXR5XSBUaGUgZnVuY3Rpb24gaW52b2tlZCBwZXIgaXRlcmF0aW9uLlxuICAgICAqIEByZXR1cm5zIHtBcnJheXxPYmplY3R9IFJldHVybnMgYGNvbGxlY3Rpb25gLlxuICAgICAqIEBzZWUgXy5mb3JFYWNoXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8uZm9yRWFjaFJpZ2h0KFsxLCAyXSwgZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgKiAgIGNvbnNvbGUubG9nKHZhbHVlKTtcbiAgICAgKiB9KTtcbiAgICAgKiAvLyA9PiBMb2dzIGAyYCB0aGVuIGAxYC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBmb3JFYWNoUmlnaHQoY29sbGVjdGlvbiwgaXRlcmF0ZWUpIHtcbiAgICAgIHZhciBmdW5jID0gaXNBcnJheShjb2xsZWN0aW9uKSA/IGFycmF5RWFjaFJpZ2h0IDogYmFzZUVhY2hSaWdodDtcbiAgICAgIHJldHVybiBmdW5jKGNvbGxlY3Rpb24sIGdldEl0ZXJhdGVlKGl0ZXJhdGVlLCAzKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbiBvYmplY3QgY29tcG9zZWQgb2Yga2V5cyBnZW5lcmF0ZWQgZnJvbSB0aGUgcmVzdWx0cyBvZiBydW5uaW5nXG4gICAgICogZWFjaCBlbGVtZW50IG9mIGBjb2xsZWN0aW9uYCB0aHJ1IGBpdGVyYXRlZWAuIFRoZSBvcmRlciBvZiBncm91cGVkIHZhbHVlc1xuICAgICAqIGlzIGRldGVybWluZWQgYnkgdGhlIG9yZGVyIHRoZXkgb2NjdXIgaW4gYGNvbGxlY3Rpb25gLiBUaGUgY29ycmVzcG9uZGluZ1xuICAgICAqIHZhbHVlIG9mIGVhY2gga2V5IGlzIGFuIGFycmF5IG9mIGVsZW1lbnRzIHJlc3BvbnNpYmxlIGZvciBnZW5lcmF0aW5nIHRoZVxuICAgICAqIGtleS4gVGhlIGl0ZXJhdGVlIGlzIGludm9rZWQgd2l0aCBvbmUgYXJndW1lbnQ6ICh2YWx1ZSkuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMC4xLjBcbiAgICAgKiBAY2F0ZWdvcnkgQ29sbGVjdGlvblxuICAgICAqIEBwYXJhbSB7QXJyYXl8T2JqZWN0fSBjb2xsZWN0aW9uIFRoZSBjb2xsZWN0aW9uIHRvIGl0ZXJhdGUgb3Zlci5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbaXRlcmF0ZWU9Xy5pZGVudGl0eV0gVGhlIGl0ZXJhdGVlIHRvIHRyYW5zZm9ybSBrZXlzLlxuICAgICAqIEByZXR1cm5zIHtPYmplY3R9IFJldHVybnMgdGhlIGNvbXBvc2VkIGFnZ3JlZ2F0ZSBvYmplY3QuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8uZ3JvdXBCeShbNi4xLCA0LjIsIDYuM10sIE1hdGguZmxvb3IpO1xuICAgICAqIC8vID0+IHsgJzQnOiBbNC4yXSwgJzYnOiBbNi4xLCA2LjNdIH1cbiAgICAgKlxuICAgICAqIC8vIFRoZSBgXy5wcm9wZXJ0eWAgaXRlcmF0ZWUgc2hvcnRoYW5kLlxuICAgICAqIF8uZ3JvdXBCeShbJ29uZScsICd0d28nLCAndGhyZWUnXSwgJ2xlbmd0aCcpO1xuICAgICAqIC8vID0+IHsgJzMnOiBbJ29uZScsICd0d28nXSwgJzUnOiBbJ3RocmVlJ10gfVxuICAgICAqL1xuICAgIHZhciBncm91cEJ5ID0gY3JlYXRlQWdncmVnYXRvcihmdW5jdGlvbihyZXN1bHQsIHZhbHVlLCBrZXkpIHtcbiAgICAgIGlmIChoYXNPd25Qcm9wZXJ0eS5jYWxsKHJlc3VsdCwga2V5KSkge1xuICAgICAgICByZXN1bHRba2V5XS5wdXNoKHZhbHVlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGJhc2VBc3NpZ25WYWx1ZShyZXN1bHQsIGtleSwgW3ZhbHVlXSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBDaGVja3MgaWYgYHZhbHVlYCBpcyBpbiBgY29sbGVjdGlvbmAuIElmIGBjb2xsZWN0aW9uYCBpcyBhIHN0cmluZywgaXQnc1xuICAgICAqIGNoZWNrZWQgZm9yIGEgc3Vic3RyaW5nIG9mIGB2YWx1ZWAsIG90aGVyd2lzZVxuICAgICAqIFtgU2FtZVZhbHVlWmVyb2BdKGh0dHA6Ly9lY21hLWludGVybmF0aW9uYWwub3JnL2VjbWEtMjYyLzcuMC8jc2VjLXNhbWV2YWx1ZXplcm8pXG4gICAgICogaXMgdXNlZCBmb3IgZXF1YWxpdHkgY29tcGFyaXNvbnMuIElmIGBmcm9tSW5kZXhgIGlzIG5lZ2F0aXZlLCBpdCdzIHVzZWQgYXNcbiAgICAgKiB0aGUgb2Zmc2V0IGZyb20gdGhlIGVuZCBvZiBgY29sbGVjdGlvbmAuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMC4xLjBcbiAgICAgKiBAY2F0ZWdvcnkgQ29sbGVjdGlvblxuICAgICAqIEBwYXJhbSB7QXJyYXl8T2JqZWN0fHN0cmluZ30gY29sbGVjdGlvbiBUaGUgY29sbGVjdGlvbiB0byBpbnNwZWN0LlxuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIHNlYXJjaCBmb3IuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtmcm9tSW5kZXg9MF0gVGhlIGluZGV4IHRvIHNlYXJjaCBmcm9tLlxuICAgICAqIEBwYXJhbS0ge09iamVjdH0gW2d1YXJkXSBFbmFibGVzIHVzZSBhcyBhbiBpdGVyYXRlZSBmb3IgbWV0aG9kcyBsaWtlIGBfLnJlZHVjZWAuXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGB2YWx1ZWAgaXMgZm91bmQsIGVsc2UgYGZhbHNlYC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5pbmNsdWRlcyhbMSwgMiwgM10sIDEpO1xuICAgICAqIC8vID0+IHRydWVcbiAgICAgKlxuICAgICAqIF8uaW5jbHVkZXMoWzEsIDIsIDNdLCAxLCAyKTtcbiAgICAgKiAvLyA9PiBmYWxzZVxuICAgICAqXG4gICAgICogXy5pbmNsdWRlcyh7ICdhJzogMSwgJ2InOiAyIH0sIDEpO1xuICAgICAqIC8vID0+IHRydWVcbiAgICAgKlxuICAgICAqIF8uaW5jbHVkZXMoJ2FiY2QnLCAnYmMnKTtcbiAgICAgKiAvLyA9PiB0cnVlXG4gICAgICovXG4gICAgZnVuY3Rpb24gaW5jbHVkZXMoY29sbGVjdGlvbiwgdmFsdWUsIGZyb21JbmRleCwgZ3VhcmQpIHtcbiAgICAgIGNvbGxlY3Rpb24gPSBpc0FycmF5TGlrZShjb2xsZWN0aW9uKSA/IGNvbGxlY3Rpb24gOiB2YWx1ZXMoY29sbGVjdGlvbik7XG4gICAgICBmcm9tSW5kZXggPSAoZnJvbUluZGV4ICYmICFndWFyZCkgPyB0b0ludGVnZXIoZnJvbUluZGV4KSA6IDA7XG5cbiAgICAgIHZhciBsZW5ndGggPSBjb2xsZWN0aW9uLmxlbmd0aDtcbiAgICAgIGlmIChmcm9tSW5kZXggPCAwKSB7XG4gICAgICAgIGZyb21JbmRleCA9IG5hdGl2ZU1heChsZW5ndGggKyBmcm9tSW5kZXgsIDApO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGlzU3RyaW5nKGNvbGxlY3Rpb24pXG4gICAgICAgID8gKGZyb21JbmRleCA8PSBsZW5ndGggJiYgY29sbGVjdGlvbi5pbmRleE9mKHZhbHVlLCBmcm9tSW5kZXgpID4gLTEpXG4gICAgICAgIDogKCEhbGVuZ3RoICYmIGJhc2VJbmRleE9mKGNvbGxlY3Rpb24sIHZhbHVlLCBmcm9tSW5kZXgpID4gLTEpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEludm9rZXMgdGhlIG1ldGhvZCBhdCBgcGF0aGAgb2YgZWFjaCBlbGVtZW50IGluIGBjb2xsZWN0aW9uYCwgcmV0dXJuaW5nXG4gICAgICogYW4gYXJyYXkgb2YgdGhlIHJlc3VsdHMgb2YgZWFjaCBpbnZva2VkIG1ldGhvZC4gQW55IGFkZGl0aW9uYWwgYXJndW1lbnRzXG4gICAgICogYXJlIHByb3ZpZGVkIHRvIGVhY2ggaW52b2tlZCBtZXRob2QuIElmIGBwYXRoYCBpcyBhIGZ1bmN0aW9uLCBpdCdzIGludm9rZWRcbiAgICAgKiBmb3IsIGFuZCBgdGhpc2AgYm91bmQgdG8sIGVhY2ggZWxlbWVudCBpbiBgY29sbGVjdGlvbmAuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgNC4wLjBcbiAgICAgKiBAY2F0ZWdvcnkgQ29sbGVjdGlvblxuICAgICAqIEBwYXJhbSB7QXJyYXl8T2JqZWN0fSBjb2xsZWN0aW9uIFRoZSBjb2xsZWN0aW9uIHRvIGl0ZXJhdGUgb3Zlci5cbiAgICAgKiBAcGFyYW0ge0FycmF5fEZ1bmN0aW9ufHN0cmluZ30gcGF0aCBUaGUgcGF0aCBvZiB0aGUgbWV0aG9kIHRvIGludm9rZSBvclxuICAgICAqICB0aGUgZnVuY3Rpb24gaW52b2tlZCBwZXIgaXRlcmF0aW9uLlxuICAgICAqIEBwYXJhbSB7Li4uKn0gW2FyZ3NdIFRoZSBhcmd1bWVudHMgdG8gaW52b2tlIGVhY2ggbWV0aG9kIHdpdGguXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIHRoZSBhcnJheSBvZiByZXN1bHRzLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLmludm9rZU1hcChbWzUsIDEsIDddLCBbMywgMiwgMV1dLCAnc29ydCcpO1xuICAgICAqIC8vID0+IFtbMSwgNSwgN10sIFsxLCAyLCAzXV1cbiAgICAgKlxuICAgICAqIF8uaW52b2tlTWFwKFsxMjMsIDQ1Nl0sIFN0cmluZy5wcm90b3R5cGUuc3BsaXQsICcnKTtcbiAgICAgKiAvLyA9PiBbWycxJywgJzInLCAnMyddLCBbJzQnLCAnNScsICc2J11dXG4gICAgICovXG4gICAgdmFyIGludm9rZU1hcCA9IGJhc2VSZXN0KGZ1bmN0aW9uKGNvbGxlY3Rpb24sIHBhdGgsIGFyZ3MpIHtcbiAgICAgIHZhciBpbmRleCA9IC0xLFxuICAgICAgICAgIGlzRnVuYyA9IHR5cGVvZiBwYXRoID09ICdmdW5jdGlvbicsXG4gICAgICAgICAgcmVzdWx0ID0gaXNBcnJheUxpa2UoY29sbGVjdGlvbikgPyBBcnJheShjb2xsZWN0aW9uLmxlbmd0aCkgOiBbXTtcblxuICAgICAgYmFzZUVhY2goY29sbGVjdGlvbiwgZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgcmVzdWx0WysraW5kZXhdID0gaXNGdW5jID8gYXBwbHkocGF0aCwgdmFsdWUsIGFyZ3MpIDogYmFzZUludm9rZSh2YWx1ZSwgcGF0aCwgYXJncyk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuIG9iamVjdCBjb21wb3NlZCBvZiBrZXlzIGdlbmVyYXRlZCBmcm9tIHRoZSByZXN1bHRzIG9mIHJ1bm5pbmdcbiAgICAgKiBlYWNoIGVsZW1lbnQgb2YgYGNvbGxlY3Rpb25gIHRocnUgYGl0ZXJhdGVlYC4gVGhlIGNvcnJlc3BvbmRpbmcgdmFsdWUgb2ZcbiAgICAgKiBlYWNoIGtleSBpcyB0aGUgbGFzdCBlbGVtZW50IHJlc3BvbnNpYmxlIGZvciBnZW5lcmF0aW5nIHRoZSBrZXkuIFRoZVxuICAgICAqIGl0ZXJhdGVlIGlzIGludm9rZWQgd2l0aCBvbmUgYXJndW1lbnQ6ICh2YWx1ZSkuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgNC4wLjBcbiAgICAgKiBAY2F0ZWdvcnkgQ29sbGVjdGlvblxuICAgICAqIEBwYXJhbSB7QXJyYXl8T2JqZWN0fSBjb2xsZWN0aW9uIFRoZSBjb2xsZWN0aW9uIHRvIGl0ZXJhdGUgb3Zlci5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbaXRlcmF0ZWU9Xy5pZGVudGl0eV0gVGhlIGl0ZXJhdGVlIHRvIHRyYW5zZm9ybSBrZXlzLlxuICAgICAqIEByZXR1cm5zIHtPYmplY3R9IFJldHVybnMgdGhlIGNvbXBvc2VkIGFnZ3JlZ2F0ZSBvYmplY3QuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciBhcnJheSA9IFtcbiAgICAgKiAgIHsgJ2Rpcic6ICdsZWZ0JywgJ2NvZGUnOiA5NyB9LFxuICAgICAqICAgeyAnZGlyJzogJ3JpZ2h0JywgJ2NvZGUnOiAxMDAgfVxuICAgICAqIF07XG4gICAgICpcbiAgICAgKiBfLmtleUJ5KGFycmF5LCBmdW5jdGlvbihvKSB7XG4gICAgICogICByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZShvLmNvZGUpO1xuICAgICAqIH0pO1xuICAgICAqIC8vID0+IHsgJ2EnOiB7ICdkaXInOiAnbGVmdCcsICdjb2RlJzogOTcgfSwgJ2QnOiB7ICdkaXInOiAncmlnaHQnLCAnY29kZSc6IDEwMCB9IH1cbiAgICAgKlxuICAgICAqIF8ua2V5QnkoYXJyYXksICdkaXInKTtcbiAgICAgKiAvLyA9PiB7ICdsZWZ0JzogeyAnZGlyJzogJ2xlZnQnLCAnY29kZSc6IDk3IH0sICdyaWdodCc6IHsgJ2Rpcic6ICdyaWdodCcsICdjb2RlJzogMTAwIH0gfVxuICAgICAqL1xuICAgIHZhciBrZXlCeSA9IGNyZWF0ZUFnZ3JlZ2F0b3IoZnVuY3Rpb24ocmVzdWx0LCB2YWx1ZSwga2V5KSB7XG4gICAgICBiYXNlQXNzaWduVmFsdWUocmVzdWx0LCBrZXksIHZhbHVlKTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW4gYXJyYXkgb2YgdmFsdWVzIGJ5IHJ1bm5pbmcgZWFjaCBlbGVtZW50IGluIGBjb2xsZWN0aW9uYCB0aHJ1XG4gICAgICogYGl0ZXJhdGVlYC4gVGhlIGl0ZXJhdGVlIGlzIGludm9rZWQgd2l0aCB0aHJlZSBhcmd1bWVudHM6XG4gICAgICogKHZhbHVlLCBpbmRleHxrZXksIGNvbGxlY3Rpb24pLlxuICAgICAqXG4gICAgICogTWFueSBsb2Rhc2ggbWV0aG9kcyBhcmUgZ3VhcmRlZCB0byB3b3JrIGFzIGl0ZXJhdGVlcyBmb3IgbWV0aG9kcyBsaWtlXG4gICAgICogYF8uZXZlcnlgLCBgXy5maWx0ZXJgLCBgXy5tYXBgLCBgXy5tYXBWYWx1ZXNgLCBgXy5yZWplY3RgLCBhbmQgYF8uc29tZWAuXG4gICAgICpcbiAgICAgKiBUaGUgZ3VhcmRlZCBtZXRob2RzIGFyZTpcbiAgICAgKiBgYXJ5YCwgYGNodW5rYCwgYGN1cnJ5YCwgYGN1cnJ5UmlnaHRgLCBgZHJvcGAsIGBkcm9wUmlnaHRgLCBgZXZlcnlgLFxuICAgICAqIGBmaWxsYCwgYGludmVydGAsIGBwYXJzZUludGAsIGByYW5kb21gLCBgcmFuZ2VgLCBgcmFuZ2VSaWdodGAsIGByZXBlYXRgLFxuICAgICAqIGBzYW1wbGVTaXplYCwgYHNsaWNlYCwgYHNvbWVgLCBgc29ydEJ5YCwgYHNwbGl0YCwgYHRha2VgLCBgdGFrZVJpZ2h0YCxcbiAgICAgKiBgdGVtcGxhdGVgLCBgdHJpbWAsIGB0cmltRW5kYCwgYHRyaW1TdGFydGAsIGFuZCBgd29yZHNgXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMC4xLjBcbiAgICAgKiBAY2F0ZWdvcnkgQ29sbGVjdGlvblxuICAgICAqIEBwYXJhbSB7QXJyYXl8T2JqZWN0fSBjb2xsZWN0aW9uIFRoZSBjb2xsZWN0aW9uIHRvIGl0ZXJhdGUgb3Zlci5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbaXRlcmF0ZWU9Xy5pZGVudGl0eV0gVGhlIGZ1bmN0aW9uIGludm9rZWQgcGVyIGl0ZXJhdGlvbi5cbiAgICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgdGhlIG5ldyBtYXBwZWQgYXJyYXkuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIGZ1bmN0aW9uIHNxdWFyZShuKSB7XG4gICAgICogICByZXR1cm4gbiAqIG47XG4gICAgICogfVxuICAgICAqXG4gICAgICogXy5tYXAoWzQsIDhdLCBzcXVhcmUpO1xuICAgICAqIC8vID0+IFsxNiwgNjRdXG4gICAgICpcbiAgICAgKiBfLm1hcCh7ICdhJzogNCwgJ2InOiA4IH0sIHNxdWFyZSk7XG4gICAgICogLy8gPT4gWzE2LCA2NF0gKGl0ZXJhdGlvbiBvcmRlciBpcyBub3QgZ3VhcmFudGVlZClcbiAgICAgKlxuICAgICAqIHZhciB1c2VycyA9IFtcbiAgICAgKiAgIHsgJ3VzZXInOiAnYmFybmV5JyB9LFxuICAgICAqICAgeyAndXNlcic6ICdmcmVkJyB9XG4gICAgICogXTtcbiAgICAgKlxuICAgICAqIC8vIFRoZSBgXy5wcm9wZXJ0eWAgaXRlcmF0ZWUgc2hvcnRoYW5kLlxuICAgICAqIF8ubWFwKHVzZXJzLCAndXNlcicpO1xuICAgICAqIC8vID0+IFsnYmFybmV5JywgJ2ZyZWQnXVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIG1hcChjb2xsZWN0aW9uLCBpdGVyYXRlZSkge1xuICAgICAgdmFyIGZ1bmMgPSBpc0FycmF5KGNvbGxlY3Rpb24pID8gYXJyYXlNYXAgOiBiYXNlTWFwO1xuICAgICAgcmV0dXJuIGZ1bmMoY29sbGVjdGlvbiwgZ2V0SXRlcmF0ZWUoaXRlcmF0ZWUsIDMpKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGlzIG1ldGhvZCBpcyBsaWtlIGBfLnNvcnRCeWAgZXhjZXB0IHRoYXQgaXQgYWxsb3dzIHNwZWNpZnlpbmcgdGhlIHNvcnRcbiAgICAgKiBvcmRlcnMgb2YgdGhlIGl0ZXJhdGVlcyB0byBzb3J0IGJ5LiBJZiBgb3JkZXJzYCBpcyB1bnNwZWNpZmllZCwgYWxsIHZhbHVlc1xuICAgICAqIGFyZSBzb3J0ZWQgaW4gYXNjZW5kaW5nIG9yZGVyLiBPdGhlcndpc2UsIHNwZWNpZnkgYW4gb3JkZXIgb2YgXCJkZXNjXCIgZm9yXG4gICAgICogZGVzY2VuZGluZyBvciBcImFzY1wiIGZvciBhc2NlbmRpbmcgc29ydCBvcmRlciBvZiBjb3JyZXNwb25kaW5nIHZhbHVlcy5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSA0LjAuMFxuICAgICAqIEBjYXRlZ29yeSBDb2xsZWN0aW9uXG4gICAgICogQHBhcmFtIHtBcnJheXxPYmplY3R9IGNvbGxlY3Rpb24gVGhlIGNvbGxlY3Rpb24gdG8gaXRlcmF0ZSBvdmVyLlxuICAgICAqIEBwYXJhbSB7QXJyYXlbXXxGdW5jdGlvbltdfE9iamVjdFtdfHN0cmluZ1tdfSBbaXRlcmF0ZWVzPVtfLmlkZW50aXR5XV1cbiAgICAgKiAgVGhlIGl0ZXJhdGVlcyB0byBzb3J0IGJ5LlxuICAgICAqIEBwYXJhbSB7c3RyaW5nW119IFtvcmRlcnNdIFRoZSBzb3J0IG9yZGVycyBvZiBgaXRlcmF0ZWVzYC5cbiAgICAgKiBAcGFyYW0tIHtPYmplY3R9IFtndWFyZF0gRW5hYmxlcyB1c2UgYXMgYW4gaXRlcmF0ZWUgZm9yIG1ldGhvZHMgbGlrZSBgXy5yZWR1Y2VgLlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgbmV3IHNvcnRlZCBhcnJheS5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogdmFyIHVzZXJzID0gW1xuICAgICAqICAgeyAndXNlcic6ICdmcmVkJywgICAnYWdlJzogNDggfSxcbiAgICAgKiAgIHsgJ3VzZXInOiAnYmFybmV5JywgJ2FnZSc6IDM0IH0sXG4gICAgICogICB7ICd1c2VyJzogJ2ZyZWQnLCAgICdhZ2UnOiA0MCB9LFxuICAgICAqICAgeyAndXNlcic6ICdiYXJuZXknLCAnYWdlJzogMzYgfVxuICAgICAqIF07XG4gICAgICpcbiAgICAgKiAvLyBTb3J0IGJ5IGB1c2VyYCBpbiBhc2NlbmRpbmcgb3JkZXIgYW5kIGJ5IGBhZ2VgIGluIGRlc2NlbmRpbmcgb3JkZXIuXG4gICAgICogXy5vcmRlckJ5KHVzZXJzLCBbJ3VzZXInLCAnYWdlJ10sIFsnYXNjJywgJ2Rlc2MnXSk7XG4gICAgICogLy8gPT4gb2JqZWN0cyBmb3IgW1snYmFybmV5JywgMzZdLCBbJ2Jhcm5leScsIDM0XSwgWydmcmVkJywgNDhdLCBbJ2ZyZWQnLCA0MF1dXG4gICAgICovXG4gICAgZnVuY3Rpb24gb3JkZXJCeShjb2xsZWN0aW9uLCBpdGVyYXRlZXMsIG9yZGVycywgZ3VhcmQpIHtcbiAgICAgIGlmIChjb2xsZWN0aW9uID09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgfVxuICAgICAgaWYgKCFpc0FycmF5KGl0ZXJhdGVlcykpIHtcbiAgICAgICAgaXRlcmF0ZWVzID0gaXRlcmF0ZWVzID09IG51bGwgPyBbXSA6IFtpdGVyYXRlZXNdO1xuICAgICAgfVxuICAgICAgb3JkZXJzID0gZ3VhcmQgPyB1bmRlZmluZWQgOiBvcmRlcnM7XG4gICAgICBpZiAoIWlzQXJyYXkob3JkZXJzKSkge1xuICAgICAgICBvcmRlcnMgPSBvcmRlcnMgPT0gbnVsbCA/IFtdIDogW29yZGVyc107XG4gICAgICB9XG4gICAgICByZXR1cm4gYmFzZU9yZGVyQnkoY29sbGVjdGlvbiwgaXRlcmF0ZWVzLCBvcmRlcnMpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW4gYXJyYXkgb2YgZWxlbWVudHMgc3BsaXQgaW50byB0d28gZ3JvdXBzLCB0aGUgZmlyc3Qgb2Ygd2hpY2hcbiAgICAgKiBjb250YWlucyBlbGVtZW50cyBgcHJlZGljYXRlYCByZXR1cm5zIHRydXRoeSBmb3IsIHRoZSBzZWNvbmQgb2Ygd2hpY2hcbiAgICAgKiBjb250YWlucyBlbGVtZW50cyBgcHJlZGljYXRlYCByZXR1cm5zIGZhbHNleSBmb3IuIFRoZSBwcmVkaWNhdGUgaXNcbiAgICAgKiBpbnZva2VkIHdpdGggb25lIGFyZ3VtZW50OiAodmFsdWUpLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDMuMC4wXG4gICAgICogQGNhdGVnb3J5IENvbGxlY3Rpb25cbiAgICAgKiBAcGFyYW0ge0FycmF5fE9iamVjdH0gY29sbGVjdGlvbiBUaGUgY29sbGVjdGlvbiB0byBpdGVyYXRlIG92ZXIuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gW3ByZWRpY2F0ZT1fLmlkZW50aXR5XSBUaGUgZnVuY3Rpb24gaW52b2tlZCBwZXIgaXRlcmF0aW9uLlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgYXJyYXkgb2YgZ3JvdXBlZCBlbGVtZW50cy5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogdmFyIHVzZXJzID0gW1xuICAgICAqICAgeyAndXNlcic6ICdiYXJuZXknLCAgJ2FnZSc6IDM2LCAnYWN0aXZlJzogZmFsc2UgfSxcbiAgICAgKiAgIHsgJ3VzZXInOiAnZnJlZCcsICAgICdhZ2UnOiA0MCwgJ2FjdGl2ZSc6IHRydWUgfSxcbiAgICAgKiAgIHsgJ3VzZXInOiAncGViYmxlcycsICdhZ2UnOiAxLCAgJ2FjdGl2ZSc6IGZhbHNlIH1cbiAgICAgKiBdO1xuICAgICAqXG4gICAgICogXy5wYXJ0aXRpb24odXNlcnMsIGZ1bmN0aW9uKG8pIHsgcmV0dXJuIG8uYWN0aXZlOyB9KTtcbiAgICAgKiAvLyA9PiBvYmplY3RzIGZvciBbWydmcmVkJ10sIFsnYmFybmV5JywgJ3BlYmJsZXMnXV1cbiAgICAgKlxuICAgICAqIC8vIFRoZSBgXy5tYXRjaGVzYCBpdGVyYXRlZSBzaG9ydGhhbmQuXG4gICAgICogXy5wYXJ0aXRpb24odXNlcnMsIHsgJ2FnZSc6IDEsICdhY3RpdmUnOiBmYWxzZSB9KTtcbiAgICAgKiAvLyA9PiBvYmplY3RzIGZvciBbWydwZWJibGVzJ10sIFsnYmFybmV5JywgJ2ZyZWQnXV1cbiAgICAgKlxuICAgICAqIC8vIFRoZSBgXy5tYXRjaGVzUHJvcGVydHlgIGl0ZXJhdGVlIHNob3J0aGFuZC5cbiAgICAgKiBfLnBhcnRpdGlvbih1c2VycywgWydhY3RpdmUnLCBmYWxzZV0pO1xuICAgICAqIC8vID0+IG9iamVjdHMgZm9yIFtbJ2Jhcm5leScsICdwZWJibGVzJ10sIFsnZnJlZCddXVxuICAgICAqXG4gICAgICogLy8gVGhlIGBfLnByb3BlcnR5YCBpdGVyYXRlZSBzaG9ydGhhbmQuXG4gICAgICogXy5wYXJ0aXRpb24odXNlcnMsICdhY3RpdmUnKTtcbiAgICAgKiAvLyA9PiBvYmplY3RzIGZvciBbWydmcmVkJ10sIFsnYmFybmV5JywgJ3BlYmJsZXMnXV1cbiAgICAgKi9cbiAgICB2YXIgcGFydGl0aW9uID0gY3JlYXRlQWdncmVnYXRvcihmdW5jdGlvbihyZXN1bHQsIHZhbHVlLCBrZXkpIHtcbiAgICAgIHJlc3VsdFtrZXkgPyAwIDogMV0ucHVzaCh2YWx1ZSk7XG4gICAgfSwgZnVuY3Rpb24oKSB7IHJldHVybiBbW10sIFtdXTsgfSk7XG5cbiAgICAvKipcbiAgICAgKiBSZWR1Y2VzIGBjb2xsZWN0aW9uYCB0byBhIHZhbHVlIHdoaWNoIGlzIHRoZSBhY2N1bXVsYXRlZCByZXN1bHQgb2YgcnVubmluZ1xuICAgICAqIGVhY2ggZWxlbWVudCBpbiBgY29sbGVjdGlvbmAgdGhydSBgaXRlcmF0ZWVgLCB3aGVyZSBlYWNoIHN1Y2Nlc3NpdmVcbiAgICAgKiBpbnZvY2F0aW9uIGlzIHN1cHBsaWVkIHRoZSByZXR1cm4gdmFsdWUgb2YgdGhlIHByZXZpb3VzLiBJZiBgYWNjdW11bGF0b3JgXG4gICAgICogaXMgbm90IGdpdmVuLCB0aGUgZmlyc3QgZWxlbWVudCBvZiBgY29sbGVjdGlvbmAgaXMgdXNlZCBhcyB0aGUgaW5pdGlhbFxuICAgICAqIHZhbHVlLiBUaGUgaXRlcmF0ZWUgaXMgaW52b2tlZCB3aXRoIGZvdXIgYXJndW1lbnRzOlxuICAgICAqIChhY2N1bXVsYXRvciwgdmFsdWUsIGluZGV4fGtleSwgY29sbGVjdGlvbikuXG4gICAgICpcbiAgICAgKiBNYW55IGxvZGFzaCBtZXRob2RzIGFyZSBndWFyZGVkIHRvIHdvcmsgYXMgaXRlcmF0ZWVzIGZvciBtZXRob2RzIGxpa2VcbiAgICAgKiBgXy5yZWR1Y2VgLCBgXy5yZWR1Y2VSaWdodGAsIGFuZCBgXy50cmFuc2Zvcm1gLlxuICAgICAqXG4gICAgICogVGhlIGd1YXJkZWQgbWV0aG9kcyBhcmU6XG4gICAgICogYGFzc2lnbmAsIGBkZWZhdWx0c2AsIGBkZWZhdWx0c0RlZXBgLCBgaW5jbHVkZXNgLCBgbWVyZ2VgLCBgb3JkZXJCeWAsXG4gICAgICogYW5kIGBzb3J0QnlgXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMC4xLjBcbiAgICAgKiBAY2F0ZWdvcnkgQ29sbGVjdGlvblxuICAgICAqIEBwYXJhbSB7QXJyYXl8T2JqZWN0fSBjb2xsZWN0aW9uIFRoZSBjb2xsZWN0aW9uIHRvIGl0ZXJhdGUgb3Zlci5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbaXRlcmF0ZWU9Xy5pZGVudGl0eV0gVGhlIGZ1bmN0aW9uIGludm9rZWQgcGVyIGl0ZXJhdGlvbi5cbiAgICAgKiBAcGFyYW0geyp9IFthY2N1bXVsYXRvcl0gVGhlIGluaXRpYWwgdmFsdWUuXG4gICAgICogQHJldHVybnMgeyp9IFJldHVybnMgdGhlIGFjY3VtdWxhdGVkIHZhbHVlLlxuICAgICAqIEBzZWUgXy5yZWR1Y2VSaWdodFxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLnJlZHVjZShbMSwgMl0sIGZ1bmN0aW9uKHN1bSwgbikge1xuICAgICAqICAgcmV0dXJuIHN1bSArIG47XG4gICAgICogfSwgMCk7XG4gICAgICogLy8gPT4gM1xuICAgICAqXG4gICAgICogXy5yZWR1Y2UoeyAnYSc6IDEsICdiJzogMiwgJ2MnOiAxIH0sIGZ1bmN0aW9uKHJlc3VsdCwgdmFsdWUsIGtleSkge1xuICAgICAqICAgKHJlc3VsdFt2YWx1ZV0gfHwgKHJlc3VsdFt2YWx1ZV0gPSBbXSkpLnB1c2goa2V5KTtcbiAgICAgKiAgIHJldHVybiByZXN1bHQ7XG4gICAgICogfSwge30pO1xuICAgICAqIC8vID0+IHsgJzEnOiBbJ2EnLCAnYyddLCAnMic6IFsnYiddIH0gKGl0ZXJhdGlvbiBvcmRlciBpcyBub3QgZ3VhcmFudGVlZClcbiAgICAgKi9cbiAgICBmdW5jdGlvbiByZWR1Y2UoY29sbGVjdGlvbiwgaXRlcmF0ZWUsIGFjY3VtdWxhdG9yKSB7XG4gICAgICB2YXIgZnVuYyA9IGlzQXJyYXkoY29sbGVjdGlvbikgPyBhcnJheVJlZHVjZSA6IGJhc2VSZWR1Y2UsXG4gICAgICAgICAgaW5pdEFjY3VtID0gYXJndW1lbnRzLmxlbmd0aCA8IDM7XG5cbiAgICAgIHJldHVybiBmdW5jKGNvbGxlY3Rpb24sIGdldEl0ZXJhdGVlKGl0ZXJhdGVlLCA0KSwgYWNjdW11bGF0b3IsIGluaXRBY2N1bSwgYmFzZUVhY2gpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoaXMgbWV0aG9kIGlzIGxpa2UgYF8ucmVkdWNlYCBleGNlcHQgdGhhdCBpdCBpdGVyYXRlcyBvdmVyIGVsZW1lbnRzIG9mXG4gICAgICogYGNvbGxlY3Rpb25gIGZyb20gcmlnaHQgdG8gbGVmdC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAwLjEuMFxuICAgICAqIEBjYXRlZ29yeSBDb2xsZWN0aW9uXG4gICAgICogQHBhcmFtIHtBcnJheXxPYmplY3R9IGNvbGxlY3Rpb24gVGhlIGNvbGxlY3Rpb24gdG8gaXRlcmF0ZSBvdmVyLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtpdGVyYXRlZT1fLmlkZW50aXR5XSBUaGUgZnVuY3Rpb24gaW52b2tlZCBwZXIgaXRlcmF0aW9uLlxuICAgICAqIEBwYXJhbSB7Kn0gW2FjY3VtdWxhdG9yXSBUaGUgaW5pdGlhbCB2YWx1ZS5cbiAgICAgKiBAcmV0dXJucyB7Kn0gUmV0dXJucyB0aGUgYWNjdW11bGF0ZWQgdmFsdWUuXG4gICAgICogQHNlZSBfLnJlZHVjZVxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiB2YXIgYXJyYXkgPSBbWzAsIDFdLCBbMiwgM10sIFs0LCA1XV07XG4gICAgICpcbiAgICAgKiBfLnJlZHVjZVJpZ2h0KGFycmF5LCBmdW5jdGlvbihmbGF0dGVuZWQsIG90aGVyKSB7XG4gICAgICogICByZXR1cm4gZmxhdHRlbmVkLmNvbmNhdChvdGhlcik7XG4gICAgICogfSwgW10pO1xuICAgICAqIC8vID0+IFs0LCA1LCAyLCAzLCAwLCAxXVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHJlZHVjZVJpZ2h0KGNvbGxlY3Rpb24sIGl0ZXJhdGVlLCBhY2N1bXVsYXRvcikge1xuICAgICAgdmFyIGZ1bmMgPSBpc0FycmF5KGNvbGxlY3Rpb24pID8gYXJyYXlSZWR1Y2VSaWdodCA6IGJhc2VSZWR1Y2UsXG4gICAgICAgICAgaW5pdEFjY3VtID0gYXJndW1lbnRzLmxlbmd0aCA8IDM7XG5cbiAgICAgIHJldHVybiBmdW5jKGNvbGxlY3Rpb24sIGdldEl0ZXJhdGVlKGl0ZXJhdGVlLCA0KSwgYWNjdW11bGF0b3IsIGluaXRBY2N1bSwgYmFzZUVhY2hSaWdodCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIG9wcG9zaXRlIG9mIGBfLmZpbHRlcmA7IHRoaXMgbWV0aG9kIHJldHVybnMgdGhlIGVsZW1lbnRzIG9mIGBjb2xsZWN0aW9uYFxuICAgICAqIHRoYXQgYHByZWRpY2F0ZWAgZG9lcyAqKm5vdCoqIHJldHVybiB0cnV0aHkgZm9yLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDAuMS4wXG4gICAgICogQGNhdGVnb3J5IENvbGxlY3Rpb25cbiAgICAgKiBAcGFyYW0ge0FycmF5fE9iamVjdH0gY29sbGVjdGlvbiBUaGUgY29sbGVjdGlvbiB0byBpdGVyYXRlIG92ZXIuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gW3ByZWRpY2F0ZT1fLmlkZW50aXR5XSBUaGUgZnVuY3Rpb24gaW52b2tlZCBwZXIgaXRlcmF0aW9uLlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgbmV3IGZpbHRlcmVkIGFycmF5LlxuICAgICAqIEBzZWUgXy5maWx0ZXJcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogdmFyIHVzZXJzID0gW1xuICAgICAqICAgeyAndXNlcic6ICdiYXJuZXknLCAnYWdlJzogMzYsICdhY3RpdmUnOiBmYWxzZSB9LFxuICAgICAqICAgeyAndXNlcic6ICdmcmVkJywgICAnYWdlJzogNDAsICdhY3RpdmUnOiB0cnVlIH1cbiAgICAgKiBdO1xuICAgICAqXG4gICAgICogXy5yZWplY3QodXNlcnMsIGZ1bmN0aW9uKG8pIHsgcmV0dXJuICFvLmFjdGl2ZTsgfSk7XG4gICAgICogLy8gPT4gb2JqZWN0cyBmb3IgWydmcmVkJ11cbiAgICAgKlxuICAgICAqIC8vIFRoZSBgXy5tYXRjaGVzYCBpdGVyYXRlZSBzaG9ydGhhbmQuXG4gICAgICogXy5yZWplY3QodXNlcnMsIHsgJ2FnZSc6IDQwLCAnYWN0aXZlJzogdHJ1ZSB9KTtcbiAgICAgKiAvLyA9PiBvYmplY3RzIGZvciBbJ2Jhcm5leSddXG4gICAgICpcbiAgICAgKiAvLyBUaGUgYF8ubWF0Y2hlc1Byb3BlcnR5YCBpdGVyYXRlZSBzaG9ydGhhbmQuXG4gICAgICogXy5yZWplY3QodXNlcnMsIFsnYWN0aXZlJywgZmFsc2VdKTtcbiAgICAgKiAvLyA9PiBvYmplY3RzIGZvciBbJ2ZyZWQnXVxuICAgICAqXG4gICAgICogLy8gVGhlIGBfLnByb3BlcnR5YCBpdGVyYXRlZSBzaG9ydGhhbmQuXG4gICAgICogXy5yZWplY3QodXNlcnMsICdhY3RpdmUnKTtcbiAgICAgKiAvLyA9PiBvYmplY3RzIGZvciBbJ2Jhcm5leSddXG4gICAgICovXG4gICAgZnVuY3Rpb24gcmVqZWN0KGNvbGxlY3Rpb24sIHByZWRpY2F0ZSkge1xuICAgICAgdmFyIGZ1bmMgPSBpc0FycmF5KGNvbGxlY3Rpb24pID8gYXJyYXlGaWx0ZXIgOiBiYXNlRmlsdGVyO1xuICAgICAgcmV0dXJuIGZ1bmMoY29sbGVjdGlvbiwgbmVnYXRlKGdldEl0ZXJhdGVlKHByZWRpY2F0ZSwgMykpKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXRzIGEgcmFuZG9tIGVsZW1lbnQgZnJvbSBgY29sbGVjdGlvbmAuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMi4wLjBcbiAgICAgKiBAY2F0ZWdvcnkgQ29sbGVjdGlvblxuICAgICAqIEBwYXJhbSB7QXJyYXl8T2JqZWN0fSBjb2xsZWN0aW9uIFRoZSBjb2xsZWN0aW9uIHRvIHNhbXBsZS5cbiAgICAgKiBAcmV0dXJucyB7Kn0gUmV0dXJucyB0aGUgcmFuZG9tIGVsZW1lbnQuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8uc2FtcGxlKFsxLCAyLCAzLCA0XSk7XG4gICAgICogLy8gPT4gMlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHNhbXBsZShjb2xsZWN0aW9uKSB7XG4gICAgICB2YXIgZnVuYyA9IGlzQXJyYXkoY29sbGVjdGlvbikgPyBhcnJheVNhbXBsZSA6IGJhc2VTYW1wbGU7XG4gICAgICByZXR1cm4gZnVuYyhjb2xsZWN0aW9uKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXRzIGBuYCByYW5kb20gZWxlbWVudHMgYXQgdW5pcXVlIGtleXMgZnJvbSBgY29sbGVjdGlvbmAgdXAgdG8gdGhlXG4gICAgICogc2l6ZSBvZiBgY29sbGVjdGlvbmAuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgNC4wLjBcbiAgICAgKiBAY2F0ZWdvcnkgQ29sbGVjdGlvblxuICAgICAqIEBwYXJhbSB7QXJyYXl8T2JqZWN0fSBjb2xsZWN0aW9uIFRoZSBjb2xsZWN0aW9uIHRvIHNhbXBsZS5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW249MV0gVGhlIG51bWJlciBvZiBlbGVtZW50cyB0byBzYW1wbGUuXG4gICAgICogQHBhcmFtLSB7T2JqZWN0fSBbZ3VhcmRdIEVuYWJsZXMgdXNlIGFzIGFuIGl0ZXJhdGVlIGZvciBtZXRob2RzIGxpa2UgYF8ubWFwYC5cbiAgICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgdGhlIHJhbmRvbSBlbGVtZW50cy5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5zYW1wbGVTaXplKFsxLCAyLCAzXSwgMik7XG4gICAgICogLy8gPT4gWzMsIDFdXG4gICAgICpcbiAgICAgKiBfLnNhbXBsZVNpemUoWzEsIDIsIDNdLCA0KTtcbiAgICAgKiAvLyA9PiBbMiwgMywgMV1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBzYW1wbGVTaXplKGNvbGxlY3Rpb24sIG4sIGd1YXJkKSB7XG4gICAgICBpZiAoKGd1YXJkID8gaXNJdGVyYXRlZUNhbGwoY29sbGVjdGlvbiwgbiwgZ3VhcmQpIDogbiA9PT0gdW5kZWZpbmVkKSkge1xuICAgICAgICBuID0gMTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG4gPSB0b0ludGVnZXIobik7XG4gICAgICB9XG4gICAgICB2YXIgZnVuYyA9IGlzQXJyYXkoY29sbGVjdGlvbikgPyBhcnJheVNhbXBsZVNpemUgOiBiYXNlU2FtcGxlU2l6ZTtcbiAgICAgIHJldHVybiBmdW5jKGNvbGxlY3Rpb24sIG4pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW4gYXJyYXkgb2Ygc2h1ZmZsZWQgdmFsdWVzLCB1c2luZyBhIHZlcnNpb24gb2YgdGhlXG4gICAgICogW0Zpc2hlci1ZYXRlcyBzaHVmZmxlXShodHRwczovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9GaXNoZXItWWF0ZXNfc2h1ZmZsZSkuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMC4xLjBcbiAgICAgKiBAY2F0ZWdvcnkgQ29sbGVjdGlvblxuICAgICAqIEBwYXJhbSB7QXJyYXl8T2JqZWN0fSBjb2xsZWN0aW9uIFRoZSBjb2xsZWN0aW9uIHRvIHNodWZmbGUuXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIHRoZSBuZXcgc2h1ZmZsZWQgYXJyYXkuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8uc2h1ZmZsZShbMSwgMiwgMywgNF0pO1xuICAgICAqIC8vID0+IFs0LCAxLCAzLCAyXVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHNodWZmbGUoY29sbGVjdGlvbikge1xuICAgICAgdmFyIGZ1bmMgPSBpc0FycmF5KGNvbGxlY3Rpb24pID8gYXJyYXlTaHVmZmxlIDogYmFzZVNodWZmbGU7XG4gICAgICByZXR1cm4gZnVuYyhjb2xsZWN0aW9uKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBzaXplIG9mIGBjb2xsZWN0aW9uYCBieSByZXR1cm5pbmcgaXRzIGxlbmd0aCBmb3IgYXJyYXktbGlrZVxuICAgICAqIHZhbHVlcyBvciB0aGUgbnVtYmVyIG9mIG93biBlbnVtZXJhYmxlIHN0cmluZyBrZXllZCBwcm9wZXJ0aWVzIGZvciBvYmplY3RzLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDAuMS4wXG4gICAgICogQGNhdGVnb3J5IENvbGxlY3Rpb25cbiAgICAgKiBAcGFyYW0ge0FycmF5fE9iamVjdHxzdHJpbmd9IGNvbGxlY3Rpb24gVGhlIGNvbGxlY3Rpb24gdG8gaW5zcGVjdC5cbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSBSZXR1cm5zIHRoZSBjb2xsZWN0aW9uIHNpemUuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8uc2l6ZShbMSwgMiwgM10pO1xuICAgICAqIC8vID0+IDNcbiAgICAgKlxuICAgICAqIF8uc2l6ZSh7ICdhJzogMSwgJ2InOiAyIH0pO1xuICAgICAqIC8vID0+IDJcbiAgICAgKlxuICAgICAqIF8uc2l6ZSgncGViYmxlcycpO1xuICAgICAqIC8vID0+IDdcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBzaXplKGNvbGxlY3Rpb24pIHtcbiAgICAgIGlmIChjb2xsZWN0aW9uID09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgICB9XG4gICAgICBpZiAoaXNBcnJheUxpa2UoY29sbGVjdGlvbikpIHtcbiAgICAgICAgcmV0dXJuIGlzU3RyaW5nKGNvbGxlY3Rpb24pID8gc3RyaW5nU2l6ZShjb2xsZWN0aW9uKSA6IGNvbGxlY3Rpb24ubGVuZ3RoO1xuICAgICAgfVxuICAgICAgdmFyIHRhZyA9IGdldFRhZyhjb2xsZWN0aW9uKTtcbiAgICAgIGlmICh0YWcgPT0gbWFwVGFnIHx8IHRhZyA9PSBzZXRUYWcpIHtcbiAgICAgICAgcmV0dXJuIGNvbGxlY3Rpb24uc2l6ZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBiYXNlS2V5cyhjb2xsZWN0aW9uKS5sZW5ndGg7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2tzIGlmIGBwcmVkaWNhdGVgIHJldHVybnMgdHJ1dGh5IGZvciAqKmFueSoqIGVsZW1lbnQgb2YgYGNvbGxlY3Rpb25gLlxuICAgICAqIEl0ZXJhdGlvbiBpcyBzdG9wcGVkIG9uY2UgYHByZWRpY2F0ZWAgcmV0dXJucyB0cnV0aHkuIFRoZSBwcmVkaWNhdGUgaXNcbiAgICAgKiBpbnZva2VkIHdpdGggdGhyZWUgYXJndW1lbnRzOiAodmFsdWUsIGluZGV4fGtleSwgY29sbGVjdGlvbikuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMC4xLjBcbiAgICAgKiBAY2F0ZWdvcnkgQ29sbGVjdGlvblxuICAgICAqIEBwYXJhbSB7QXJyYXl8T2JqZWN0fSBjb2xsZWN0aW9uIFRoZSBjb2xsZWN0aW9uIHRvIGl0ZXJhdGUgb3Zlci5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbcHJlZGljYXRlPV8uaWRlbnRpdHldIFRoZSBmdW5jdGlvbiBpbnZva2VkIHBlciBpdGVyYXRpb24uXG4gICAgICogQHBhcmFtLSB7T2JqZWN0fSBbZ3VhcmRdIEVuYWJsZXMgdXNlIGFzIGFuIGl0ZXJhdGVlIGZvciBtZXRob2RzIGxpa2UgYF8ubWFwYC5cbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYW55IGVsZW1lbnQgcGFzc2VzIHRoZSBwcmVkaWNhdGUgY2hlY2ssXG4gICAgICogIGVsc2UgYGZhbHNlYC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5zb21lKFtudWxsLCAwLCAneWVzJywgZmFsc2VdLCBCb29sZWFuKTtcbiAgICAgKiAvLyA9PiB0cnVlXG4gICAgICpcbiAgICAgKiB2YXIgdXNlcnMgPSBbXG4gICAgICogICB7ICd1c2VyJzogJ2Jhcm5leScsICdhY3RpdmUnOiB0cnVlIH0sXG4gICAgICogICB7ICd1c2VyJzogJ2ZyZWQnLCAgICdhY3RpdmUnOiBmYWxzZSB9XG4gICAgICogXTtcbiAgICAgKlxuICAgICAqIC8vIFRoZSBgXy5tYXRjaGVzYCBpdGVyYXRlZSBzaG9ydGhhbmQuXG4gICAgICogXy5zb21lKHVzZXJzLCB7ICd1c2VyJzogJ2Jhcm5leScsICdhY3RpdmUnOiBmYWxzZSB9KTtcbiAgICAgKiAvLyA9PiBmYWxzZVxuICAgICAqXG4gICAgICogLy8gVGhlIGBfLm1hdGNoZXNQcm9wZXJ0eWAgaXRlcmF0ZWUgc2hvcnRoYW5kLlxuICAgICAqIF8uc29tZSh1c2VycywgWydhY3RpdmUnLCBmYWxzZV0pO1xuICAgICAqIC8vID0+IHRydWVcbiAgICAgKlxuICAgICAqIC8vIFRoZSBgXy5wcm9wZXJ0eWAgaXRlcmF0ZWUgc2hvcnRoYW5kLlxuICAgICAqIF8uc29tZSh1c2VycywgJ2FjdGl2ZScpO1xuICAgICAqIC8vID0+IHRydWVcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBzb21lKGNvbGxlY3Rpb24sIHByZWRpY2F0ZSwgZ3VhcmQpIHtcbiAgICAgIHZhciBmdW5jID0gaXNBcnJheShjb2xsZWN0aW9uKSA/IGFycmF5U29tZSA6IGJhc2VTb21lO1xuICAgICAgaWYgKGd1YXJkICYmIGlzSXRlcmF0ZWVDYWxsKGNvbGxlY3Rpb24sIHByZWRpY2F0ZSwgZ3VhcmQpKSB7XG4gICAgICAgIHByZWRpY2F0ZSA9IHVuZGVmaW5lZDtcbiAgICAgIH1cbiAgICAgIHJldHVybiBmdW5jKGNvbGxlY3Rpb24sIGdldEl0ZXJhdGVlKHByZWRpY2F0ZSwgMykpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW4gYXJyYXkgb2YgZWxlbWVudHMsIHNvcnRlZCBpbiBhc2NlbmRpbmcgb3JkZXIgYnkgdGhlIHJlc3VsdHMgb2ZcbiAgICAgKiBydW5uaW5nIGVhY2ggZWxlbWVudCBpbiBhIGNvbGxlY3Rpb24gdGhydSBlYWNoIGl0ZXJhdGVlLiBUaGlzIG1ldGhvZFxuICAgICAqIHBlcmZvcm1zIGEgc3RhYmxlIHNvcnQsIHRoYXQgaXMsIGl0IHByZXNlcnZlcyB0aGUgb3JpZ2luYWwgc29ydCBvcmRlciBvZlxuICAgICAqIGVxdWFsIGVsZW1lbnRzLiBUaGUgaXRlcmF0ZWVzIGFyZSBpbnZva2VkIHdpdGggb25lIGFyZ3VtZW50OiAodmFsdWUpLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDAuMS4wXG4gICAgICogQGNhdGVnb3J5IENvbGxlY3Rpb25cbiAgICAgKiBAcGFyYW0ge0FycmF5fE9iamVjdH0gY29sbGVjdGlvbiBUaGUgY29sbGVjdGlvbiB0byBpdGVyYXRlIG92ZXIuXG4gICAgICogQHBhcmFtIHsuLi4oRnVuY3Rpb258RnVuY3Rpb25bXSl9IFtpdGVyYXRlZXM9W18uaWRlbnRpdHldXVxuICAgICAqICBUaGUgaXRlcmF0ZWVzIHRvIHNvcnQgYnkuXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIHRoZSBuZXcgc29ydGVkIGFycmF5LlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiB2YXIgdXNlcnMgPSBbXG4gICAgICogICB7ICd1c2VyJzogJ2ZyZWQnLCAgICdhZ2UnOiA0OCB9LFxuICAgICAqICAgeyAndXNlcic6ICdiYXJuZXknLCAnYWdlJzogMzYgfSxcbiAgICAgKiAgIHsgJ3VzZXInOiAnZnJlZCcsICAgJ2FnZSc6IDQwIH0sXG4gICAgICogICB7ICd1c2VyJzogJ2Jhcm5leScsICdhZ2UnOiAzNCB9XG4gICAgICogXTtcbiAgICAgKlxuICAgICAqIF8uc29ydEJ5KHVzZXJzLCBbZnVuY3Rpb24obykgeyByZXR1cm4gby51c2VyOyB9XSk7XG4gICAgICogLy8gPT4gb2JqZWN0cyBmb3IgW1snYmFybmV5JywgMzZdLCBbJ2Jhcm5leScsIDM0XSwgWydmcmVkJywgNDhdLCBbJ2ZyZWQnLCA0MF1dXG4gICAgICpcbiAgICAgKiBfLnNvcnRCeSh1c2VycywgWyd1c2VyJywgJ2FnZSddKTtcbiAgICAgKiAvLyA9PiBvYmplY3RzIGZvciBbWydiYXJuZXknLCAzNF0sIFsnYmFybmV5JywgMzZdLCBbJ2ZyZWQnLCA0MF0sIFsnZnJlZCcsIDQ4XV1cbiAgICAgKi9cbiAgICB2YXIgc29ydEJ5ID0gYmFzZVJlc3QoZnVuY3Rpb24oY29sbGVjdGlvbiwgaXRlcmF0ZWVzKSB7XG4gICAgICBpZiAoY29sbGVjdGlvbiA9PSBudWxsKSB7XG4gICAgICAgIHJldHVybiBbXTtcbiAgICAgIH1cbiAgICAgIHZhciBsZW5ndGggPSBpdGVyYXRlZXMubGVuZ3RoO1xuICAgICAgaWYgKGxlbmd0aCA+IDEgJiYgaXNJdGVyYXRlZUNhbGwoY29sbGVjdGlvbiwgaXRlcmF0ZWVzWzBdLCBpdGVyYXRlZXNbMV0pKSB7XG4gICAgICAgIGl0ZXJhdGVlcyA9IFtdO1xuICAgICAgfSBlbHNlIGlmIChsZW5ndGggPiAyICYmIGlzSXRlcmF0ZWVDYWxsKGl0ZXJhdGVlc1swXSwgaXRlcmF0ZWVzWzFdLCBpdGVyYXRlZXNbMl0pKSB7XG4gICAgICAgIGl0ZXJhdGVlcyA9IFtpdGVyYXRlZXNbMF1dO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGJhc2VPcmRlckJ5KGNvbGxlY3Rpb24sIGJhc2VGbGF0dGVuKGl0ZXJhdGVlcywgMSksIFtdKTtcbiAgICB9KTtcblxuICAgIC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIHRpbWVzdGFtcCBvZiB0aGUgbnVtYmVyIG9mIG1pbGxpc2Vjb25kcyB0aGF0IGhhdmUgZWxhcHNlZCBzaW5jZVxuICAgICAqIHRoZSBVbml4IGVwb2NoICgxIEphbnVhcnkgMTk3MCAwMDowMDowMCBVVEMpLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDIuNC4wXG4gICAgICogQGNhdGVnb3J5IERhdGVcbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSBSZXR1cm5zIHRoZSB0aW1lc3RhbXAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8uZGVmZXIoZnVuY3Rpb24oc3RhbXApIHtcbiAgICAgKiAgIGNvbnNvbGUubG9nKF8ubm93KCkgLSBzdGFtcCk7XG4gICAgICogfSwgXy5ub3coKSk7XG4gICAgICogLy8gPT4gTG9ncyB0aGUgbnVtYmVyIG9mIG1pbGxpc2Vjb25kcyBpdCB0b29rIGZvciB0aGUgZGVmZXJyZWQgaW52b2NhdGlvbi5cbiAgICAgKi9cbiAgICB2YXIgbm93ID0gY3R4Tm93IHx8IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHJvb3QuRGF0ZS5ub3coKTtcbiAgICB9O1xuXG4gICAgLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG4gICAgLyoqXG4gICAgICogVGhlIG9wcG9zaXRlIG9mIGBfLmJlZm9yZWA7IHRoaXMgbWV0aG9kIGNyZWF0ZXMgYSBmdW5jdGlvbiB0aGF0IGludm9rZXNcbiAgICAgKiBgZnVuY2Agb25jZSBpdCdzIGNhbGxlZCBgbmAgb3IgbW9yZSB0aW1lcy5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAwLjEuMFxuICAgICAqIEBjYXRlZ29yeSBGdW5jdGlvblxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBuIFRoZSBudW1iZXIgb2YgY2FsbHMgYmVmb3JlIGBmdW5jYCBpcyBpbnZva2VkLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZ1bmMgVGhlIGZ1bmN0aW9uIHRvIHJlc3RyaWN0LlxuICAgICAqIEByZXR1cm5zIHtGdW5jdGlvbn0gUmV0dXJucyB0aGUgbmV3IHJlc3RyaWN0ZWQgZnVuY3Rpb24uXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciBzYXZlcyA9IFsncHJvZmlsZScsICdzZXR0aW5ncyddO1xuICAgICAqXG4gICAgICogdmFyIGRvbmUgPSBfLmFmdGVyKHNhdmVzLmxlbmd0aCwgZnVuY3Rpb24oKSB7XG4gICAgICogICBjb25zb2xlLmxvZygnZG9uZSBzYXZpbmchJyk7XG4gICAgICogfSk7XG4gICAgICpcbiAgICAgKiBfLmZvckVhY2goc2F2ZXMsIGZ1bmN0aW9uKHR5cGUpIHtcbiAgICAgKiAgIGFzeW5jU2F2ZSh7ICd0eXBlJzogdHlwZSwgJ2NvbXBsZXRlJzogZG9uZSB9KTtcbiAgICAgKiB9KTtcbiAgICAgKiAvLyA9PiBMb2dzICdkb25lIHNhdmluZyEnIGFmdGVyIHRoZSB0d28gYXN5bmMgc2F2ZXMgaGF2ZSBjb21wbGV0ZWQuXG4gICAgICovXG4gICAgZnVuY3Rpb24gYWZ0ZXIobiwgZnVuYykge1xuICAgICAgaWYgKHR5cGVvZiBmdW5jICE9ICdmdW5jdGlvbicpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihGVU5DX0VSUk9SX1RFWFQpO1xuICAgICAgfVxuICAgICAgbiA9IHRvSW50ZWdlcihuKTtcbiAgICAgIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKC0tbiA8IDEpIHtcbiAgICAgICAgICByZXR1cm4gZnVuYy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBmdW5jdGlvbiB0aGF0IGludm9rZXMgYGZ1bmNgLCB3aXRoIHVwIHRvIGBuYCBhcmd1bWVudHMsXG4gICAgICogaWdub3JpbmcgYW55IGFkZGl0aW9uYWwgYXJndW1lbnRzLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDMuMC4wXG4gICAgICogQGNhdGVnb3J5IEZ1bmN0aW9uXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZnVuYyBUaGUgZnVuY3Rpb24gdG8gY2FwIGFyZ3VtZW50cyBmb3IuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtuPWZ1bmMubGVuZ3RoXSBUaGUgYXJpdHkgY2FwLlxuICAgICAqIEBwYXJhbS0ge09iamVjdH0gW2d1YXJkXSBFbmFibGVzIHVzZSBhcyBhbiBpdGVyYXRlZSBmb3IgbWV0aG9kcyBsaWtlIGBfLm1hcGAuXG4gICAgICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIHRoZSBuZXcgY2FwcGVkIGZ1bmN0aW9uLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLm1hcChbJzYnLCAnOCcsICcxMCddLCBfLmFyeShwYXJzZUludCwgMSkpO1xuICAgICAqIC8vID0+IFs2LCA4LCAxMF1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBhcnkoZnVuYywgbiwgZ3VhcmQpIHtcbiAgICAgIG4gPSBndWFyZCA/IHVuZGVmaW5lZCA6IG47XG4gICAgICBuID0gKGZ1bmMgJiYgbiA9PSBudWxsKSA/IGZ1bmMubGVuZ3RoIDogbjtcbiAgICAgIHJldHVybiBjcmVhdGVXcmFwKGZ1bmMsIFdSQVBfQVJZX0ZMQUcsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgbik7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGZ1bmN0aW9uIHRoYXQgaW52b2tlcyBgZnVuY2AsIHdpdGggdGhlIGB0aGlzYCBiaW5kaW5nIGFuZCBhcmd1bWVudHNcbiAgICAgKiBvZiB0aGUgY3JlYXRlZCBmdW5jdGlvbiwgd2hpbGUgaXQncyBjYWxsZWQgbGVzcyB0aGFuIGBuYCB0aW1lcy4gU3Vic2VxdWVudFxuICAgICAqIGNhbGxzIHRvIHRoZSBjcmVhdGVkIGZ1bmN0aW9uIHJldHVybiB0aGUgcmVzdWx0IG9mIHRoZSBsYXN0IGBmdW5jYCBpbnZvY2F0aW9uLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDMuMC4wXG4gICAgICogQGNhdGVnb3J5IEZ1bmN0aW9uXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IG4gVGhlIG51bWJlciBvZiBjYWxscyBhdCB3aGljaCBgZnVuY2AgaXMgbm8gbG9uZ2VyIGludm9rZWQuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZnVuYyBUaGUgZnVuY3Rpb24gdG8gcmVzdHJpY3QuXG4gICAgICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIHRoZSBuZXcgcmVzdHJpY3RlZCBmdW5jdGlvbi5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogalF1ZXJ5KGVsZW1lbnQpLm9uKCdjbGljaycsIF8uYmVmb3JlKDUsIGFkZENvbnRhY3RUb0xpc3QpKTtcbiAgICAgKiAvLyA9PiBBbGxvd3MgYWRkaW5nIHVwIHRvIDQgY29udGFjdHMgdG8gdGhlIGxpc3QuXG4gICAgICovXG4gICAgZnVuY3Rpb24gYmVmb3JlKG4sIGZ1bmMpIHtcbiAgICAgIHZhciByZXN1bHQ7XG4gICAgICBpZiAodHlwZW9mIGZ1bmMgIT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKEZVTkNfRVJST1JfVEVYVCk7XG4gICAgICB9XG4gICAgICBuID0gdG9JbnRlZ2VyKG4pO1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoLS1uID4gMCkge1xuICAgICAgICAgIHJlc3VsdCA9IGZ1bmMuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobiA8PSAxKSB7XG4gICAgICAgICAgZnVuYyA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgZnVuY3Rpb24gdGhhdCBpbnZva2VzIGBmdW5jYCB3aXRoIHRoZSBgdGhpc2AgYmluZGluZyBvZiBgdGhpc0FyZ2BcbiAgICAgKiBhbmQgYHBhcnRpYWxzYCBwcmVwZW5kZWQgdG8gdGhlIGFyZ3VtZW50cyBpdCByZWNlaXZlcy5cbiAgICAgKlxuICAgICAqIFRoZSBgXy5iaW5kLnBsYWNlaG9sZGVyYCB2YWx1ZSwgd2hpY2ggZGVmYXVsdHMgdG8gYF9gIGluIG1vbm9saXRoaWMgYnVpbGRzLFxuICAgICAqIG1heSBiZSB1c2VkIGFzIGEgcGxhY2Vob2xkZXIgZm9yIHBhcnRpYWxseSBhcHBsaWVkIGFyZ3VtZW50cy5cbiAgICAgKlxuICAgICAqICoqTm90ZToqKiBVbmxpa2UgbmF0aXZlIGBGdW5jdGlvbiNiaW5kYCwgdGhpcyBtZXRob2QgZG9lc24ndCBzZXQgdGhlIFwibGVuZ3RoXCJcbiAgICAgKiBwcm9wZXJ0eSBvZiBib3VuZCBmdW5jdGlvbnMuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMC4xLjBcbiAgICAgKiBAY2F0ZWdvcnkgRnVuY3Rpb25cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmdW5jIFRoZSBmdW5jdGlvbiB0byBiaW5kLlxuICAgICAqIEBwYXJhbSB7Kn0gdGhpc0FyZyBUaGUgYHRoaXNgIGJpbmRpbmcgb2YgYGZ1bmNgLlxuICAgICAqIEBwYXJhbSB7Li4uKn0gW3BhcnRpYWxzXSBUaGUgYXJndW1lbnRzIHRvIGJlIHBhcnRpYWxseSBhcHBsaWVkLlxuICAgICAqIEByZXR1cm5zIHtGdW5jdGlvbn0gUmV0dXJucyB0aGUgbmV3IGJvdW5kIGZ1bmN0aW9uLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBmdW5jdGlvbiBncmVldChncmVldGluZywgcHVuY3R1YXRpb24pIHtcbiAgICAgKiAgIHJldHVybiBncmVldGluZyArICcgJyArIHRoaXMudXNlciArIHB1bmN0dWF0aW9uO1xuICAgICAqIH1cbiAgICAgKlxuICAgICAqIHZhciBvYmplY3QgPSB7ICd1c2VyJzogJ2ZyZWQnIH07XG4gICAgICpcbiAgICAgKiB2YXIgYm91bmQgPSBfLmJpbmQoZ3JlZXQsIG9iamVjdCwgJ2hpJyk7XG4gICAgICogYm91bmQoJyEnKTtcbiAgICAgKiAvLyA9PiAnaGkgZnJlZCEnXG4gICAgICpcbiAgICAgKiAvLyBCb3VuZCB3aXRoIHBsYWNlaG9sZGVycy5cbiAgICAgKiB2YXIgYm91bmQgPSBfLmJpbmQoZ3JlZXQsIG9iamVjdCwgXywgJyEnKTtcbiAgICAgKiBib3VuZCgnaGknKTtcbiAgICAgKiAvLyA9PiAnaGkgZnJlZCEnXG4gICAgICovXG4gICAgdmFyIGJpbmQgPSBiYXNlUmVzdChmdW5jdGlvbihmdW5jLCB0aGlzQXJnLCBwYXJ0aWFscykge1xuICAgICAgdmFyIGJpdG1hc2sgPSBXUkFQX0JJTkRfRkxBRztcbiAgICAgIGlmIChwYXJ0aWFscy5sZW5ndGgpIHtcbiAgICAgICAgdmFyIGhvbGRlcnMgPSByZXBsYWNlSG9sZGVycyhwYXJ0aWFscywgZ2V0SG9sZGVyKGJpbmQpKTtcbiAgICAgICAgYml0bWFzayB8PSBXUkFQX1BBUlRJQUxfRkxBRztcbiAgICAgIH1cbiAgICAgIHJldHVybiBjcmVhdGVXcmFwKGZ1bmMsIGJpdG1hc2ssIHRoaXNBcmcsIHBhcnRpYWxzLCBob2xkZXJzKTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBmdW5jdGlvbiB0aGF0IGludm9rZXMgdGhlIG1ldGhvZCBhdCBgb2JqZWN0W2tleV1gIHdpdGggYHBhcnRpYWxzYFxuICAgICAqIHByZXBlbmRlZCB0byB0aGUgYXJndW1lbnRzIGl0IHJlY2VpdmVzLlxuICAgICAqXG4gICAgICogVGhpcyBtZXRob2QgZGlmZmVycyBmcm9tIGBfLmJpbmRgIGJ5IGFsbG93aW5nIGJvdW5kIGZ1bmN0aW9ucyB0byByZWZlcmVuY2VcbiAgICAgKiBtZXRob2RzIHRoYXQgbWF5IGJlIHJlZGVmaW5lZCBvciBkb24ndCB5ZXQgZXhpc3QuIFNlZVxuICAgICAqIFtQZXRlciBNaWNoYXV4J3MgYXJ0aWNsZV0oaHR0cDovL3BldGVyLm1pY2hhdXguY2EvYXJ0aWNsZXMvbGF6eS1mdW5jdGlvbi1kZWZpbml0aW9uLXBhdHRlcm4pXG4gICAgICogZm9yIG1vcmUgZGV0YWlscy5cbiAgICAgKlxuICAgICAqIFRoZSBgXy5iaW5kS2V5LnBsYWNlaG9sZGVyYCB2YWx1ZSwgd2hpY2ggZGVmYXVsdHMgdG8gYF9gIGluIG1vbm9saXRoaWNcbiAgICAgKiBidWlsZHMsIG1heSBiZSB1c2VkIGFzIGEgcGxhY2Vob2xkZXIgZm9yIHBhcnRpYWxseSBhcHBsaWVkIGFyZ3VtZW50cy5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAwLjEwLjBcbiAgICAgKiBAY2F0ZWdvcnkgRnVuY3Rpb25cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8gaW52b2tlIHRoZSBtZXRob2Qgb24uXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IGtleSBUaGUga2V5IG9mIHRoZSBtZXRob2QuXG4gICAgICogQHBhcmFtIHsuLi4qfSBbcGFydGlhbHNdIFRoZSBhcmd1bWVudHMgdG8gYmUgcGFydGlhbGx5IGFwcGxpZWQuXG4gICAgICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIHRoZSBuZXcgYm91bmQgZnVuY3Rpb24uXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciBvYmplY3QgPSB7XG4gICAgICogICAndXNlcic6ICdmcmVkJyxcbiAgICAgKiAgICdncmVldCc6IGZ1bmN0aW9uKGdyZWV0aW5nLCBwdW5jdHVhdGlvbikge1xuICAgICAqICAgICByZXR1cm4gZ3JlZXRpbmcgKyAnICcgKyB0aGlzLnVzZXIgKyBwdW5jdHVhdGlvbjtcbiAgICAgKiAgIH1cbiAgICAgKiB9O1xuICAgICAqXG4gICAgICogdmFyIGJvdW5kID0gXy5iaW5kS2V5KG9iamVjdCwgJ2dyZWV0JywgJ2hpJyk7XG4gICAgICogYm91bmQoJyEnKTtcbiAgICAgKiAvLyA9PiAnaGkgZnJlZCEnXG4gICAgICpcbiAgICAgKiBvYmplY3QuZ3JlZXQgPSBmdW5jdGlvbihncmVldGluZywgcHVuY3R1YXRpb24pIHtcbiAgICAgKiAgIHJldHVybiBncmVldGluZyArICd5YSAnICsgdGhpcy51c2VyICsgcHVuY3R1YXRpb247XG4gICAgICogfTtcbiAgICAgKlxuICAgICAqIGJvdW5kKCchJyk7XG4gICAgICogLy8gPT4gJ2hpeWEgZnJlZCEnXG4gICAgICpcbiAgICAgKiAvLyBCb3VuZCB3aXRoIHBsYWNlaG9sZGVycy5cbiAgICAgKiB2YXIgYm91bmQgPSBfLmJpbmRLZXkob2JqZWN0LCAnZ3JlZXQnLCBfLCAnIScpO1xuICAgICAqIGJvdW5kKCdoaScpO1xuICAgICAqIC8vID0+ICdoaXlhIGZyZWQhJ1xuICAgICAqL1xuICAgIHZhciBiaW5kS2V5ID0gYmFzZVJlc3QoZnVuY3Rpb24ob2JqZWN0LCBrZXksIHBhcnRpYWxzKSB7XG4gICAgICB2YXIgYml0bWFzayA9IFdSQVBfQklORF9GTEFHIHwgV1JBUF9CSU5EX0tFWV9GTEFHO1xuICAgICAgaWYgKHBhcnRpYWxzLmxlbmd0aCkge1xuICAgICAgICB2YXIgaG9sZGVycyA9IHJlcGxhY2VIb2xkZXJzKHBhcnRpYWxzLCBnZXRIb2xkZXIoYmluZEtleSkpO1xuICAgICAgICBiaXRtYXNrIHw9IFdSQVBfUEFSVElBTF9GTEFHO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGNyZWF0ZVdyYXAoa2V5LCBiaXRtYXNrLCBvYmplY3QsIHBhcnRpYWxzLCBob2xkZXJzKTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBmdW5jdGlvbiB0aGF0IGFjY2VwdHMgYXJndW1lbnRzIG9mIGBmdW5jYCBhbmQgZWl0aGVyIGludm9rZXNcbiAgICAgKiBgZnVuY2AgcmV0dXJuaW5nIGl0cyByZXN1bHQsIGlmIGF0IGxlYXN0IGBhcml0eWAgbnVtYmVyIG9mIGFyZ3VtZW50cyBoYXZlXG4gICAgICogYmVlbiBwcm92aWRlZCwgb3IgcmV0dXJucyBhIGZ1bmN0aW9uIHRoYXQgYWNjZXB0cyB0aGUgcmVtYWluaW5nIGBmdW5jYFxuICAgICAqIGFyZ3VtZW50cywgYW5kIHNvIG9uLiBUaGUgYXJpdHkgb2YgYGZ1bmNgIG1heSBiZSBzcGVjaWZpZWQgaWYgYGZ1bmMubGVuZ3RoYFxuICAgICAqIGlzIG5vdCBzdWZmaWNpZW50LlxuICAgICAqXG4gICAgICogVGhlIGBfLmN1cnJ5LnBsYWNlaG9sZGVyYCB2YWx1ZSwgd2hpY2ggZGVmYXVsdHMgdG8gYF9gIGluIG1vbm9saXRoaWMgYnVpbGRzLFxuICAgICAqIG1heSBiZSB1c2VkIGFzIGEgcGxhY2Vob2xkZXIgZm9yIHByb3ZpZGVkIGFyZ3VtZW50cy5cbiAgICAgKlxuICAgICAqICoqTm90ZToqKiBUaGlzIG1ldGhvZCBkb2Vzbid0IHNldCB0aGUgXCJsZW5ndGhcIiBwcm9wZXJ0eSBvZiBjdXJyaWVkIGZ1bmN0aW9ucy5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAyLjAuMFxuICAgICAqIEBjYXRlZ29yeSBGdW5jdGlvblxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZ1bmMgVGhlIGZ1bmN0aW9uIHRvIGN1cnJ5LlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbYXJpdHk9ZnVuYy5sZW5ndGhdIFRoZSBhcml0eSBvZiBgZnVuY2AuXG4gICAgICogQHBhcmFtLSB7T2JqZWN0fSBbZ3VhcmRdIEVuYWJsZXMgdXNlIGFzIGFuIGl0ZXJhdGVlIGZvciBtZXRob2RzIGxpa2UgYF8ubWFwYC5cbiAgICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgdGhlIG5ldyBjdXJyaWVkIGZ1bmN0aW9uLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiB2YXIgYWJjID0gZnVuY3Rpb24oYSwgYiwgYykge1xuICAgICAqICAgcmV0dXJuIFthLCBiLCBjXTtcbiAgICAgKiB9O1xuICAgICAqXG4gICAgICogdmFyIGN1cnJpZWQgPSBfLmN1cnJ5KGFiYyk7XG4gICAgICpcbiAgICAgKiBjdXJyaWVkKDEpKDIpKDMpO1xuICAgICAqIC8vID0+IFsxLCAyLCAzXVxuICAgICAqXG4gICAgICogY3VycmllZCgxLCAyKSgzKTtcbiAgICAgKiAvLyA9PiBbMSwgMiwgM11cbiAgICAgKlxuICAgICAqIGN1cnJpZWQoMSwgMiwgMyk7XG4gICAgICogLy8gPT4gWzEsIDIsIDNdXG4gICAgICpcbiAgICAgKiAvLyBDdXJyaWVkIHdpdGggcGxhY2Vob2xkZXJzLlxuICAgICAqIGN1cnJpZWQoMSkoXywgMykoMik7XG4gICAgICogLy8gPT4gWzEsIDIsIDNdXG4gICAgICovXG4gICAgZnVuY3Rpb24gY3VycnkoZnVuYywgYXJpdHksIGd1YXJkKSB7XG4gICAgICBhcml0eSA9IGd1YXJkID8gdW5kZWZpbmVkIDogYXJpdHk7XG4gICAgICB2YXIgcmVzdWx0ID0gY3JlYXRlV3JhcChmdW5jLCBXUkFQX0NVUlJZX0ZMQUcsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCBhcml0eSk7XG4gICAgICByZXN1bHQucGxhY2Vob2xkZXIgPSBjdXJyeS5wbGFjZWhvbGRlcjtcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhpcyBtZXRob2QgaXMgbGlrZSBgXy5jdXJyeWAgZXhjZXB0IHRoYXQgYXJndW1lbnRzIGFyZSBhcHBsaWVkIHRvIGBmdW5jYFxuICAgICAqIGluIHRoZSBtYW5uZXIgb2YgYF8ucGFydGlhbFJpZ2h0YCBpbnN0ZWFkIG9mIGBfLnBhcnRpYWxgLlxuICAgICAqXG4gICAgICogVGhlIGBfLmN1cnJ5UmlnaHQucGxhY2Vob2xkZXJgIHZhbHVlLCB3aGljaCBkZWZhdWx0cyB0byBgX2AgaW4gbW9ub2xpdGhpY1xuICAgICAqIGJ1aWxkcywgbWF5IGJlIHVzZWQgYXMgYSBwbGFjZWhvbGRlciBmb3IgcHJvdmlkZWQgYXJndW1lbnRzLlxuICAgICAqXG4gICAgICogKipOb3RlOioqIFRoaXMgbWV0aG9kIGRvZXNuJ3Qgc2V0IHRoZSBcImxlbmd0aFwiIHByb3BlcnR5IG9mIGN1cnJpZWQgZnVuY3Rpb25zLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDMuMC4wXG4gICAgICogQGNhdGVnb3J5IEZ1bmN0aW9uXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZnVuYyBUaGUgZnVuY3Rpb24gdG8gY3VycnkuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFthcml0eT1mdW5jLmxlbmd0aF0gVGhlIGFyaXR5IG9mIGBmdW5jYC5cbiAgICAgKiBAcGFyYW0tIHtPYmplY3R9IFtndWFyZF0gRW5hYmxlcyB1c2UgYXMgYW4gaXRlcmF0ZWUgZm9yIG1ldGhvZHMgbGlrZSBgXy5tYXBgLlxuICAgICAqIEByZXR1cm5zIHtGdW5jdGlvbn0gUmV0dXJucyB0aGUgbmV3IGN1cnJpZWQgZnVuY3Rpb24uXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciBhYmMgPSBmdW5jdGlvbihhLCBiLCBjKSB7XG4gICAgICogICByZXR1cm4gW2EsIGIsIGNdO1xuICAgICAqIH07XG4gICAgICpcbiAgICAgKiB2YXIgY3VycmllZCA9IF8uY3VycnlSaWdodChhYmMpO1xuICAgICAqXG4gICAgICogY3VycmllZCgzKSgyKSgxKTtcbiAgICAgKiAvLyA9PiBbMSwgMiwgM11cbiAgICAgKlxuICAgICAqIGN1cnJpZWQoMiwgMykoMSk7XG4gICAgICogLy8gPT4gWzEsIDIsIDNdXG4gICAgICpcbiAgICAgKiBjdXJyaWVkKDEsIDIsIDMpO1xuICAgICAqIC8vID0+IFsxLCAyLCAzXVxuICAgICAqXG4gICAgICogLy8gQ3VycmllZCB3aXRoIHBsYWNlaG9sZGVycy5cbiAgICAgKiBjdXJyaWVkKDMpKDEsIF8pKDIpO1xuICAgICAqIC8vID0+IFsxLCAyLCAzXVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGN1cnJ5UmlnaHQoZnVuYywgYXJpdHksIGd1YXJkKSB7XG4gICAgICBhcml0eSA9IGd1YXJkID8gdW5kZWZpbmVkIDogYXJpdHk7XG4gICAgICB2YXIgcmVzdWx0ID0gY3JlYXRlV3JhcChmdW5jLCBXUkFQX0NVUlJZX1JJR0hUX0ZMQUcsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCBhcml0eSk7XG4gICAgICByZXN1bHQucGxhY2Vob2xkZXIgPSBjdXJyeVJpZ2h0LnBsYWNlaG9sZGVyO1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgZGVib3VuY2VkIGZ1bmN0aW9uIHRoYXQgZGVsYXlzIGludm9raW5nIGBmdW5jYCB1bnRpbCBhZnRlciBgd2FpdGBcbiAgICAgKiBtaWxsaXNlY29uZHMgaGF2ZSBlbGFwc2VkIHNpbmNlIHRoZSBsYXN0IHRpbWUgdGhlIGRlYm91bmNlZCBmdW5jdGlvbiB3YXNcbiAgICAgKiBpbnZva2VkLiBUaGUgZGVib3VuY2VkIGZ1bmN0aW9uIGNvbWVzIHdpdGggYSBgY2FuY2VsYCBtZXRob2QgdG8gY2FuY2VsXG4gICAgICogZGVsYXllZCBgZnVuY2AgaW52b2NhdGlvbnMgYW5kIGEgYGZsdXNoYCBtZXRob2QgdG8gaW1tZWRpYXRlbHkgaW52b2tlIHRoZW0uXG4gICAgICogUHJvdmlkZSBgb3B0aW9uc2AgdG8gaW5kaWNhdGUgd2hldGhlciBgZnVuY2Agc2hvdWxkIGJlIGludm9rZWQgb24gdGhlXG4gICAgICogbGVhZGluZyBhbmQvb3IgdHJhaWxpbmcgZWRnZSBvZiB0aGUgYHdhaXRgIHRpbWVvdXQuIFRoZSBgZnVuY2AgaXMgaW52b2tlZFxuICAgICAqIHdpdGggdGhlIGxhc3QgYXJndW1lbnRzIHByb3ZpZGVkIHRvIHRoZSBkZWJvdW5jZWQgZnVuY3Rpb24uIFN1YnNlcXVlbnRcbiAgICAgKiBjYWxscyB0byB0aGUgZGVib3VuY2VkIGZ1bmN0aW9uIHJldHVybiB0aGUgcmVzdWx0IG9mIHRoZSBsYXN0IGBmdW5jYFxuICAgICAqIGludm9jYXRpb24uXG4gICAgICpcbiAgICAgKiAqKk5vdGU6KiogSWYgYGxlYWRpbmdgIGFuZCBgdHJhaWxpbmdgIG9wdGlvbnMgYXJlIGB0cnVlYCwgYGZ1bmNgIGlzXG4gICAgICogaW52b2tlZCBvbiB0aGUgdHJhaWxpbmcgZWRnZSBvZiB0aGUgdGltZW91dCBvbmx5IGlmIHRoZSBkZWJvdW5jZWQgZnVuY3Rpb25cbiAgICAgKiBpcyBpbnZva2VkIG1vcmUgdGhhbiBvbmNlIGR1cmluZyB0aGUgYHdhaXRgIHRpbWVvdXQuXG4gICAgICpcbiAgICAgKiBJZiBgd2FpdGAgaXMgYDBgIGFuZCBgbGVhZGluZ2AgaXMgYGZhbHNlYCwgYGZ1bmNgIGludm9jYXRpb24gaXMgZGVmZXJyZWRcbiAgICAgKiB1bnRpbCB0byB0aGUgbmV4dCB0aWNrLCBzaW1pbGFyIHRvIGBzZXRUaW1lb3V0YCB3aXRoIGEgdGltZW91dCBvZiBgMGAuXG4gICAgICpcbiAgICAgKiBTZWUgW0RhdmlkIENvcmJhY2hvJ3MgYXJ0aWNsZV0oaHR0cHM6Ly9jc3MtdHJpY2tzLmNvbS9kZWJvdW5jaW5nLXRocm90dGxpbmctZXhwbGFpbmVkLWV4YW1wbGVzLylcbiAgICAgKiBmb3IgZGV0YWlscyBvdmVyIHRoZSBkaWZmZXJlbmNlcyBiZXR3ZWVuIGBfLmRlYm91bmNlYCBhbmQgYF8udGhyb3R0bGVgLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDAuMS4wXG4gICAgICogQGNhdGVnb3J5IEZ1bmN0aW9uXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZnVuYyBUaGUgZnVuY3Rpb24gdG8gZGVib3VuY2UuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFt3YWl0PTBdIFRoZSBudW1iZXIgb2YgbWlsbGlzZWNvbmRzIHRvIGRlbGF5LlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9ucz17fV0gVGhlIG9wdGlvbnMgb2JqZWN0LlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW29wdGlvbnMubGVhZGluZz1mYWxzZV1cbiAgICAgKiAgU3BlY2lmeSBpbnZva2luZyBvbiB0aGUgbGVhZGluZyBlZGdlIG9mIHRoZSB0aW1lb3V0LlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbb3B0aW9ucy5tYXhXYWl0XVxuICAgICAqICBUaGUgbWF4aW11bSB0aW1lIGBmdW5jYCBpcyBhbGxvd2VkIHRvIGJlIGRlbGF5ZWQgYmVmb3JlIGl0J3MgaW52b2tlZC5cbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtvcHRpb25zLnRyYWlsaW5nPXRydWVdXG4gICAgICogIFNwZWNpZnkgaW52b2tpbmcgb24gdGhlIHRyYWlsaW5nIGVkZ2Ugb2YgdGhlIHRpbWVvdXQuXG4gICAgICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIHRoZSBuZXcgZGVib3VuY2VkIGZ1bmN0aW9uLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAvLyBBdm9pZCBjb3N0bHkgY2FsY3VsYXRpb25zIHdoaWxlIHRoZSB3aW5kb3cgc2l6ZSBpcyBpbiBmbHV4LlxuICAgICAqIGpRdWVyeSh3aW5kb3cpLm9uKCdyZXNpemUnLCBfLmRlYm91bmNlKGNhbGN1bGF0ZUxheW91dCwgMTUwKSk7XG4gICAgICpcbiAgICAgKiAvLyBJbnZva2UgYHNlbmRNYWlsYCB3aGVuIGNsaWNrZWQsIGRlYm91bmNpbmcgc3Vic2VxdWVudCBjYWxscy5cbiAgICAgKiBqUXVlcnkoZWxlbWVudCkub24oJ2NsaWNrJywgXy5kZWJvdW5jZShzZW5kTWFpbCwgMzAwLCB7XG4gICAgICogICAnbGVhZGluZyc6IHRydWUsXG4gICAgICogICAndHJhaWxpbmcnOiBmYWxzZVxuICAgICAqIH0pKTtcbiAgICAgKlxuICAgICAqIC8vIEVuc3VyZSBgYmF0Y2hMb2dgIGlzIGludm9rZWQgb25jZSBhZnRlciAxIHNlY29uZCBvZiBkZWJvdW5jZWQgY2FsbHMuXG4gICAgICogdmFyIGRlYm91bmNlZCA9IF8uZGVib3VuY2UoYmF0Y2hMb2csIDI1MCwgeyAnbWF4V2FpdCc6IDEwMDAgfSk7XG4gICAgICogdmFyIHNvdXJjZSA9IG5ldyBFdmVudFNvdXJjZSgnL3N0cmVhbScpO1xuICAgICAqIGpRdWVyeShzb3VyY2UpLm9uKCdtZXNzYWdlJywgZGVib3VuY2VkKTtcbiAgICAgKlxuICAgICAqIC8vIENhbmNlbCB0aGUgdHJhaWxpbmcgZGVib3VuY2VkIGludm9jYXRpb24uXG4gICAgICogalF1ZXJ5KHdpbmRvdykub24oJ3BvcHN0YXRlJywgZGVib3VuY2VkLmNhbmNlbCk7XG4gICAgICovXG4gICAgZnVuY3Rpb24gZGVib3VuY2UoZnVuYywgd2FpdCwgb3B0aW9ucykge1xuICAgICAgdmFyIGxhc3RBcmdzLFxuICAgICAgICAgIGxhc3RUaGlzLFxuICAgICAgICAgIG1heFdhaXQsXG4gICAgICAgICAgcmVzdWx0LFxuICAgICAgICAgIHRpbWVySWQsXG4gICAgICAgICAgbGFzdENhbGxUaW1lLFxuICAgICAgICAgIGxhc3RJbnZva2VUaW1lID0gMCxcbiAgICAgICAgICBsZWFkaW5nID0gZmFsc2UsXG4gICAgICAgICAgbWF4aW5nID0gZmFsc2UsXG4gICAgICAgICAgdHJhaWxpbmcgPSB0cnVlO1xuXG4gICAgICBpZiAodHlwZW9mIGZ1bmMgIT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKEZVTkNfRVJST1JfVEVYVCk7XG4gICAgICB9XG4gICAgICB3YWl0ID0gdG9OdW1iZXIod2FpdCkgfHwgMDtcbiAgICAgIGlmIChpc09iamVjdChvcHRpb25zKSkge1xuICAgICAgICBsZWFkaW5nID0gISFvcHRpb25zLmxlYWRpbmc7XG4gICAgICAgIG1heGluZyA9ICdtYXhXYWl0JyBpbiBvcHRpb25zO1xuICAgICAgICBtYXhXYWl0ID0gbWF4aW5nID8gbmF0aXZlTWF4KHRvTnVtYmVyKG9wdGlvbnMubWF4V2FpdCkgfHwgMCwgd2FpdCkgOiBtYXhXYWl0O1xuICAgICAgICB0cmFpbGluZyA9ICd0cmFpbGluZycgaW4gb3B0aW9ucyA/ICEhb3B0aW9ucy50cmFpbGluZyA6IHRyYWlsaW5nO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBpbnZva2VGdW5jKHRpbWUpIHtcbiAgICAgICAgdmFyIGFyZ3MgPSBsYXN0QXJncyxcbiAgICAgICAgICAgIHRoaXNBcmcgPSBsYXN0VGhpcztcblxuICAgICAgICBsYXN0QXJncyA9IGxhc3RUaGlzID0gdW5kZWZpbmVkO1xuICAgICAgICBsYXN0SW52b2tlVGltZSA9IHRpbWU7XG4gICAgICAgIHJlc3VsdCA9IGZ1bmMuYXBwbHkodGhpc0FyZywgYXJncyk7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGxlYWRpbmdFZGdlKHRpbWUpIHtcbiAgICAgICAgLy8gUmVzZXQgYW55IGBtYXhXYWl0YCB0aW1lci5cbiAgICAgICAgbGFzdEludm9rZVRpbWUgPSB0aW1lO1xuICAgICAgICAvLyBTdGFydCB0aGUgdGltZXIgZm9yIHRoZSB0cmFpbGluZyBlZGdlLlxuICAgICAgICB0aW1lcklkID0gc2V0VGltZW91dCh0aW1lckV4cGlyZWQsIHdhaXQpO1xuICAgICAgICAvLyBJbnZva2UgdGhlIGxlYWRpbmcgZWRnZS5cbiAgICAgICAgcmV0dXJuIGxlYWRpbmcgPyBpbnZva2VGdW5jKHRpbWUpIDogcmVzdWx0O1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiByZW1haW5pbmdXYWl0KHRpbWUpIHtcbiAgICAgICAgdmFyIHRpbWVTaW5jZUxhc3RDYWxsID0gdGltZSAtIGxhc3RDYWxsVGltZSxcbiAgICAgICAgICAgIHRpbWVTaW5jZUxhc3RJbnZva2UgPSB0aW1lIC0gbGFzdEludm9rZVRpbWUsXG4gICAgICAgICAgICB0aW1lV2FpdGluZyA9IHdhaXQgLSB0aW1lU2luY2VMYXN0Q2FsbDtcblxuICAgICAgICByZXR1cm4gbWF4aW5nXG4gICAgICAgICAgPyBuYXRpdmVNaW4odGltZVdhaXRpbmcsIG1heFdhaXQgLSB0aW1lU2luY2VMYXN0SW52b2tlKVxuICAgICAgICAgIDogdGltZVdhaXRpbmc7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIHNob3VsZEludm9rZSh0aW1lKSB7XG4gICAgICAgIHZhciB0aW1lU2luY2VMYXN0Q2FsbCA9IHRpbWUgLSBsYXN0Q2FsbFRpbWUsXG4gICAgICAgICAgICB0aW1lU2luY2VMYXN0SW52b2tlID0gdGltZSAtIGxhc3RJbnZva2VUaW1lO1xuXG4gICAgICAgIC8vIEVpdGhlciB0aGlzIGlzIHRoZSBmaXJzdCBjYWxsLCBhY3Rpdml0eSBoYXMgc3RvcHBlZCBhbmQgd2UncmUgYXQgdGhlXG4gICAgICAgIC8vIHRyYWlsaW5nIGVkZ2UsIHRoZSBzeXN0ZW0gdGltZSBoYXMgZ29uZSBiYWNrd2FyZHMgYW5kIHdlJ3JlIHRyZWF0aW5nXG4gICAgICAgIC8vIGl0IGFzIHRoZSB0cmFpbGluZyBlZGdlLCBvciB3ZSd2ZSBoaXQgdGhlIGBtYXhXYWl0YCBsaW1pdC5cbiAgICAgICAgcmV0dXJuIChsYXN0Q2FsbFRpbWUgPT09IHVuZGVmaW5lZCB8fCAodGltZVNpbmNlTGFzdENhbGwgPj0gd2FpdCkgfHxcbiAgICAgICAgICAodGltZVNpbmNlTGFzdENhbGwgPCAwKSB8fCAobWF4aW5nICYmIHRpbWVTaW5jZUxhc3RJbnZva2UgPj0gbWF4V2FpdCkpO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiB0aW1lckV4cGlyZWQoKSB7XG4gICAgICAgIHZhciB0aW1lID0gbm93KCk7XG4gICAgICAgIGlmIChzaG91bGRJbnZva2UodGltZSkpIHtcbiAgICAgICAgICByZXR1cm4gdHJhaWxpbmdFZGdlKHRpbWUpO1xuICAgICAgICB9XG4gICAgICAgIC8vIFJlc3RhcnQgdGhlIHRpbWVyLlxuICAgICAgICB0aW1lcklkID0gc2V0VGltZW91dCh0aW1lckV4cGlyZWQsIHJlbWFpbmluZ1dhaXQodGltZSkpO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiB0cmFpbGluZ0VkZ2UodGltZSkge1xuICAgICAgICB0aW1lcklkID0gdW5kZWZpbmVkO1xuXG4gICAgICAgIC8vIE9ubHkgaW52b2tlIGlmIHdlIGhhdmUgYGxhc3RBcmdzYCB3aGljaCBtZWFucyBgZnVuY2AgaGFzIGJlZW5cbiAgICAgICAgLy8gZGVib3VuY2VkIGF0IGxlYXN0IG9uY2UuXG4gICAgICAgIGlmICh0cmFpbGluZyAmJiBsYXN0QXJncykge1xuICAgICAgICAgIHJldHVybiBpbnZva2VGdW5jKHRpbWUpO1xuICAgICAgICB9XG4gICAgICAgIGxhc3RBcmdzID0gbGFzdFRoaXMgPSB1bmRlZmluZWQ7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGNhbmNlbCgpIHtcbiAgICAgICAgaWYgKHRpbWVySWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lcklkKTtcbiAgICAgICAgfVxuICAgICAgICBsYXN0SW52b2tlVGltZSA9IDA7XG4gICAgICAgIGxhc3RBcmdzID0gbGFzdENhbGxUaW1lID0gbGFzdFRoaXMgPSB0aW1lcklkID0gdW5kZWZpbmVkO1xuICAgICAgfVxuXG4gICAgICBmdW5jdGlvbiBmbHVzaCgpIHtcbiAgICAgICAgcmV0dXJuIHRpbWVySWQgPT09IHVuZGVmaW5lZCA/IHJlc3VsdCA6IHRyYWlsaW5nRWRnZShub3coKSk7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGRlYm91bmNlZCgpIHtcbiAgICAgICAgdmFyIHRpbWUgPSBub3coKSxcbiAgICAgICAgICAgIGlzSW52b2tpbmcgPSBzaG91bGRJbnZva2UodGltZSk7XG5cbiAgICAgICAgbGFzdEFyZ3MgPSBhcmd1bWVudHM7XG4gICAgICAgIGxhc3RUaGlzID0gdGhpcztcbiAgICAgICAgbGFzdENhbGxUaW1lID0gdGltZTtcblxuICAgICAgICBpZiAoaXNJbnZva2luZykge1xuICAgICAgICAgIGlmICh0aW1lcklkID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJldHVybiBsZWFkaW5nRWRnZShsYXN0Q2FsbFRpbWUpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAobWF4aW5nKSB7XG4gICAgICAgICAgICAvLyBIYW5kbGUgaW52b2NhdGlvbnMgaW4gYSB0aWdodCBsb29wLlxuICAgICAgICAgICAgdGltZXJJZCA9IHNldFRpbWVvdXQodGltZXJFeHBpcmVkLCB3YWl0KTtcbiAgICAgICAgICAgIHJldHVybiBpbnZva2VGdW5jKGxhc3RDYWxsVGltZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0aW1lcklkID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICB0aW1lcklkID0gc2V0VGltZW91dCh0aW1lckV4cGlyZWQsIHdhaXQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICB9XG4gICAgICBkZWJvdW5jZWQuY2FuY2VsID0gY2FuY2VsO1xuICAgICAgZGVib3VuY2VkLmZsdXNoID0gZmx1c2g7XG4gICAgICByZXR1cm4gZGVib3VuY2VkO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERlZmVycyBpbnZva2luZyB0aGUgYGZ1bmNgIHVudGlsIHRoZSBjdXJyZW50IGNhbGwgc3RhY2sgaGFzIGNsZWFyZWQuIEFueVxuICAgICAqIGFkZGl0aW9uYWwgYXJndW1lbnRzIGFyZSBwcm92aWRlZCB0byBgZnVuY2Agd2hlbiBpdCdzIGludm9rZWQuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMC4xLjBcbiAgICAgKiBAY2F0ZWdvcnkgRnVuY3Rpb25cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmdW5jIFRoZSBmdW5jdGlvbiB0byBkZWZlci5cbiAgICAgKiBAcGFyYW0gey4uLip9IFthcmdzXSBUaGUgYXJndW1lbnRzIHRvIGludm9rZSBgZnVuY2Agd2l0aC5cbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSBSZXR1cm5zIHRoZSB0aW1lciBpZC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5kZWZlcihmdW5jdGlvbih0ZXh0KSB7XG4gICAgICogICBjb25zb2xlLmxvZyh0ZXh0KTtcbiAgICAgKiB9LCAnZGVmZXJyZWQnKTtcbiAgICAgKiAvLyA9PiBMb2dzICdkZWZlcnJlZCcgYWZ0ZXIgb25lIG1pbGxpc2Vjb25kLlxuICAgICAqL1xuICAgIHZhciBkZWZlciA9IGJhc2VSZXN0KGZ1bmN0aW9uKGZ1bmMsIGFyZ3MpIHtcbiAgICAgIHJldHVybiBiYXNlRGVsYXkoZnVuYywgMSwgYXJncyk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBJbnZva2VzIGBmdW5jYCBhZnRlciBgd2FpdGAgbWlsbGlzZWNvbmRzLiBBbnkgYWRkaXRpb25hbCBhcmd1bWVudHMgYXJlXG4gICAgICogcHJvdmlkZWQgdG8gYGZ1bmNgIHdoZW4gaXQncyBpbnZva2VkLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDAuMS4wXG4gICAgICogQGNhdGVnb3J5IEZ1bmN0aW9uXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZnVuYyBUaGUgZnVuY3Rpb24gdG8gZGVsYXkuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHdhaXQgVGhlIG51bWJlciBvZiBtaWxsaXNlY29uZHMgdG8gZGVsYXkgaW52b2NhdGlvbi5cbiAgICAgKiBAcGFyYW0gey4uLip9IFthcmdzXSBUaGUgYXJndW1lbnRzIHRvIGludm9rZSBgZnVuY2Agd2l0aC5cbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSBSZXR1cm5zIHRoZSB0aW1lciBpZC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5kZWxheShmdW5jdGlvbih0ZXh0KSB7XG4gICAgICogICBjb25zb2xlLmxvZyh0ZXh0KTtcbiAgICAgKiB9LCAxMDAwLCAnbGF0ZXInKTtcbiAgICAgKiAvLyA9PiBMb2dzICdsYXRlcicgYWZ0ZXIgb25lIHNlY29uZC5cbiAgICAgKi9cbiAgICB2YXIgZGVsYXkgPSBiYXNlUmVzdChmdW5jdGlvbihmdW5jLCB3YWl0LCBhcmdzKSB7XG4gICAgICByZXR1cm4gYmFzZURlbGF5KGZ1bmMsIHRvTnVtYmVyKHdhaXQpIHx8IDAsIGFyZ3MpO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGZ1bmN0aW9uIHRoYXQgaW52b2tlcyBgZnVuY2Agd2l0aCBhcmd1bWVudHMgcmV2ZXJzZWQuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgNC4wLjBcbiAgICAgKiBAY2F0ZWdvcnkgRnVuY3Rpb25cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmdW5jIFRoZSBmdW5jdGlvbiB0byBmbGlwIGFyZ3VtZW50cyBmb3IuXG4gICAgICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIHRoZSBuZXcgZmxpcHBlZCBmdW5jdGlvbi5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogdmFyIGZsaXBwZWQgPSBfLmZsaXAoZnVuY3Rpb24oKSB7XG4gICAgICogICByZXR1cm4gXy50b0FycmF5KGFyZ3VtZW50cyk7XG4gICAgICogfSk7XG4gICAgICpcbiAgICAgKiBmbGlwcGVkKCdhJywgJ2InLCAnYycsICdkJyk7XG4gICAgICogLy8gPT4gWydkJywgJ2MnLCAnYicsICdhJ11cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBmbGlwKGZ1bmMpIHtcbiAgICAgIHJldHVybiBjcmVhdGVXcmFwKGZ1bmMsIFdSQVBfRkxJUF9GTEFHKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgZnVuY3Rpb24gdGhhdCBtZW1vaXplcyB0aGUgcmVzdWx0IG9mIGBmdW5jYC4gSWYgYHJlc29sdmVyYCBpc1xuICAgICAqIHByb3ZpZGVkLCBpdCBkZXRlcm1pbmVzIHRoZSBjYWNoZSBrZXkgZm9yIHN0b3JpbmcgdGhlIHJlc3VsdCBiYXNlZCBvbiB0aGVcbiAgICAgKiBhcmd1bWVudHMgcHJvdmlkZWQgdG8gdGhlIG1lbW9pemVkIGZ1bmN0aW9uLiBCeSBkZWZhdWx0LCB0aGUgZmlyc3QgYXJndW1lbnRcbiAgICAgKiBwcm92aWRlZCB0byB0aGUgbWVtb2l6ZWQgZnVuY3Rpb24gaXMgdXNlZCBhcyB0aGUgbWFwIGNhY2hlIGtleS4gVGhlIGBmdW5jYFxuICAgICAqIGlzIGludm9rZWQgd2l0aCB0aGUgYHRoaXNgIGJpbmRpbmcgb2YgdGhlIG1lbW9pemVkIGZ1bmN0aW9uLlxuICAgICAqXG4gICAgICogKipOb3RlOioqIFRoZSBjYWNoZSBpcyBleHBvc2VkIGFzIHRoZSBgY2FjaGVgIHByb3BlcnR5IG9uIHRoZSBtZW1vaXplZFxuICAgICAqIGZ1bmN0aW9uLiBJdHMgY3JlYXRpb24gbWF5IGJlIGN1c3RvbWl6ZWQgYnkgcmVwbGFjaW5nIHRoZSBgXy5tZW1vaXplLkNhY2hlYFxuICAgICAqIGNvbnN0cnVjdG9yIHdpdGggb25lIHdob3NlIGluc3RhbmNlcyBpbXBsZW1lbnQgdGhlXG4gICAgICogW2BNYXBgXShodHRwOi8vZWNtYS1pbnRlcm5hdGlvbmFsLm9yZy9lY21hLTI2Mi83LjAvI3NlYy1wcm9wZXJ0aWVzLW9mLXRoZS1tYXAtcHJvdG90eXBlLW9iamVjdClcbiAgICAgKiBtZXRob2QgaW50ZXJmYWNlIG9mIGBjbGVhcmAsIGBkZWxldGVgLCBgZ2V0YCwgYGhhc2AsIGFuZCBgc2V0YC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAwLjEuMFxuICAgICAqIEBjYXRlZ29yeSBGdW5jdGlvblxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZ1bmMgVGhlIGZ1bmN0aW9uIHRvIGhhdmUgaXRzIG91dHB1dCBtZW1vaXplZC5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbcmVzb2x2ZXJdIFRoZSBmdW5jdGlvbiB0byByZXNvbHZlIHRoZSBjYWNoZSBrZXkuXG4gICAgICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIHRoZSBuZXcgbWVtb2l6ZWQgZnVuY3Rpb24uXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciBvYmplY3QgPSB7ICdhJzogMSwgJ2InOiAyIH07XG4gICAgICogdmFyIG90aGVyID0geyAnYyc6IDMsICdkJzogNCB9O1xuICAgICAqXG4gICAgICogdmFyIHZhbHVlcyA9IF8ubWVtb2l6ZShfLnZhbHVlcyk7XG4gICAgICogdmFsdWVzKG9iamVjdCk7XG4gICAgICogLy8gPT4gWzEsIDJdXG4gICAgICpcbiAgICAgKiB2YWx1ZXMob3RoZXIpO1xuICAgICAqIC8vID0+IFszLCA0XVxuICAgICAqXG4gICAgICogb2JqZWN0LmEgPSAyO1xuICAgICAqIHZhbHVlcyhvYmplY3QpO1xuICAgICAqIC8vID0+IFsxLCAyXVxuICAgICAqXG4gICAgICogLy8gTW9kaWZ5IHRoZSByZXN1bHQgY2FjaGUuXG4gICAgICogdmFsdWVzLmNhY2hlLnNldChvYmplY3QsIFsnYScsICdiJ10pO1xuICAgICAqIHZhbHVlcyhvYmplY3QpO1xuICAgICAqIC8vID0+IFsnYScsICdiJ11cbiAgICAgKlxuICAgICAqIC8vIFJlcGxhY2UgYF8ubWVtb2l6ZS5DYWNoZWAuXG4gICAgICogXy5tZW1vaXplLkNhY2hlID0gV2Vha01hcDtcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBtZW1vaXplKGZ1bmMsIHJlc29sdmVyKSB7XG4gICAgICBpZiAodHlwZW9mIGZ1bmMgIT0gJ2Z1bmN0aW9uJyB8fCAocmVzb2x2ZXIgIT0gbnVsbCAmJiB0eXBlb2YgcmVzb2x2ZXIgIT0gJ2Z1bmN0aW9uJykpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihGVU5DX0VSUk9SX1RFWFQpO1xuICAgICAgfVxuICAgICAgdmFyIG1lbW9pemVkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBhcmdzID0gYXJndW1lbnRzLFxuICAgICAgICAgICAga2V5ID0gcmVzb2x2ZXIgPyByZXNvbHZlci5hcHBseSh0aGlzLCBhcmdzKSA6IGFyZ3NbMF0sXG4gICAgICAgICAgICBjYWNoZSA9IG1lbW9pemVkLmNhY2hlO1xuXG4gICAgICAgIGlmIChjYWNoZS5oYXMoa2V5KSkge1xuICAgICAgICAgIHJldHVybiBjYWNoZS5nZXQoa2V5KTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcmVzdWx0ID0gZnVuYy5hcHBseSh0aGlzLCBhcmdzKTtcbiAgICAgICAgbWVtb2l6ZWQuY2FjaGUgPSBjYWNoZS5zZXQoa2V5LCByZXN1bHQpIHx8IGNhY2hlO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgfTtcbiAgICAgIG1lbW9pemVkLmNhY2hlID0gbmV3IChtZW1vaXplLkNhY2hlIHx8IE1hcENhY2hlKTtcbiAgICAgIHJldHVybiBtZW1vaXplZDtcbiAgICB9XG5cbiAgICAvLyBFeHBvc2UgYE1hcENhY2hlYC5cbiAgICBtZW1vaXplLkNhY2hlID0gTWFwQ2FjaGU7XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgZnVuY3Rpb24gdGhhdCBuZWdhdGVzIHRoZSByZXN1bHQgb2YgdGhlIHByZWRpY2F0ZSBgZnVuY2AuIFRoZVxuICAgICAqIGBmdW5jYCBwcmVkaWNhdGUgaXMgaW52b2tlZCB3aXRoIHRoZSBgdGhpc2AgYmluZGluZyBhbmQgYXJndW1lbnRzIG9mIHRoZVxuICAgICAqIGNyZWF0ZWQgZnVuY3Rpb24uXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMy4wLjBcbiAgICAgKiBAY2F0ZWdvcnkgRnVuY3Rpb25cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBwcmVkaWNhdGUgVGhlIHByZWRpY2F0ZSB0byBuZWdhdGUuXG4gICAgICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIHRoZSBuZXcgbmVnYXRlZCBmdW5jdGlvbi5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogZnVuY3Rpb24gaXNFdmVuKG4pIHtcbiAgICAgKiAgIHJldHVybiBuICUgMiA9PSAwO1xuICAgICAqIH1cbiAgICAgKlxuICAgICAqIF8uZmlsdGVyKFsxLCAyLCAzLCA0LCA1LCA2XSwgXy5uZWdhdGUoaXNFdmVuKSk7XG4gICAgICogLy8gPT4gWzEsIDMsIDVdXG4gICAgICovXG4gICAgZnVuY3Rpb24gbmVnYXRlKHByZWRpY2F0ZSkge1xuICAgICAgaWYgKHR5cGVvZiBwcmVkaWNhdGUgIT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKEZVTkNfRVJST1JfVEVYVCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBhcmdzID0gYXJndW1lbnRzO1xuICAgICAgICBzd2l0Y2ggKGFyZ3MubGVuZ3RoKSB7XG4gICAgICAgICAgY2FzZSAwOiByZXR1cm4gIXByZWRpY2F0ZS5jYWxsKHRoaXMpO1xuICAgICAgICAgIGNhc2UgMTogcmV0dXJuICFwcmVkaWNhdGUuY2FsbCh0aGlzLCBhcmdzWzBdKTtcbiAgICAgICAgICBjYXNlIDI6IHJldHVybiAhcHJlZGljYXRlLmNhbGwodGhpcywgYXJnc1swXSwgYXJnc1sxXSk7XG4gICAgICAgICAgY2FzZSAzOiByZXR1cm4gIXByZWRpY2F0ZS5jYWxsKHRoaXMsIGFyZ3NbMF0sIGFyZ3NbMV0sIGFyZ3NbMl0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAhcHJlZGljYXRlLmFwcGx5KHRoaXMsIGFyZ3MpO1xuICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgZnVuY3Rpb24gdGhhdCBpcyByZXN0cmljdGVkIHRvIGludm9raW5nIGBmdW5jYCBvbmNlLiBSZXBlYXQgY2FsbHNcbiAgICAgKiB0byB0aGUgZnVuY3Rpb24gcmV0dXJuIHRoZSB2YWx1ZSBvZiB0aGUgZmlyc3QgaW52b2NhdGlvbi4gVGhlIGBmdW5jYCBpc1xuICAgICAqIGludm9rZWQgd2l0aCB0aGUgYHRoaXNgIGJpbmRpbmcgYW5kIGFyZ3VtZW50cyBvZiB0aGUgY3JlYXRlZCBmdW5jdGlvbi5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAwLjEuMFxuICAgICAqIEBjYXRlZ29yeSBGdW5jdGlvblxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZ1bmMgVGhlIGZ1bmN0aW9uIHRvIHJlc3RyaWN0LlxuICAgICAqIEByZXR1cm5zIHtGdW5jdGlvbn0gUmV0dXJucyB0aGUgbmV3IHJlc3RyaWN0ZWQgZnVuY3Rpb24uXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciBpbml0aWFsaXplID0gXy5vbmNlKGNyZWF0ZUFwcGxpY2F0aW9uKTtcbiAgICAgKiBpbml0aWFsaXplKCk7XG4gICAgICogaW5pdGlhbGl6ZSgpO1xuICAgICAqIC8vID0+IGBjcmVhdGVBcHBsaWNhdGlvbmAgaXMgaW52b2tlZCBvbmNlXG4gICAgICovXG4gICAgZnVuY3Rpb24gb25jZShmdW5jKSB7XG4gICAgICByZXR1cm4gYmVmb3JlKDIsIGZ1bmMpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBmdW5jdGlvbiB0aGF0IGludm9rZXMgYGZ1bmNgIHdpdGggaXRzIGFyZ3VtZW50cyB0cmFuc2Zvcm1lZC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAc2luY2UgNC4wLjBcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBjYXRlZ29yeSBGdW5jdGlvblxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZ1bmMgVGhlIGZ1bmN0aW9uIHRvIHdyYXAuXG4gICAgICogQHBhcmFtIHsuLi4oRnVuY3Rpb258RnVuY3Rpb25bXSl9IFt0cmFuc2Zvcm1zPVtfLmlkZW50aXR5XV1cbiAgICAgKiAgVGhlIGFyZ3VtZW50IHRyYW5zZm9ybXMuXG4gICAgICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIHRoZSBuZXcgZnVuY3Rpb24uXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIGZ1bmN0aW9uIGRvdWJsZWQobikge1xuICAgICAqICAgcmV0dXJuIG4gKiAyO1xuICAgICAqIH1cbiAgICAgKlxuICAgICAqIGZ1bmN0aW9uIHNxdWFyZShuKSB7XG4gICAgICogICByZXR1cm4gbiAqIG47XG4gICAgICogfVxuICAgICAqXG4gICAgICogdmFyIGZ1bmMgPSBfLm92ZXJBcmdzKGZ1bmN0aW9uKHgsIHkpIHtcbiAgICAgKiAgIHJldHVybiBbeCwgeV07XG4gICAgICogfSwgW3NxdWFyZSwgZG91YmxlZF0pO1xuICAgICAqXG4gICAgICogZnVuYyg5LCAzKTtcbiAgICAgKiAvLyA9PiBbODEsIDZdXG4gICAgICpcbiAgICAgKiBmdW5jKDEwLCA1KTtcbiAgICAgKiAvLyA9PiBbMTAwLCAxMF1cbiAgICAgKi9cbiAgICB2YXIgb3ZlckFyZ3MgPSBjYXN0UmVzdChmdW5jdGlvbihmdW5jLCB0cmFuc2Zvcm1zKSB7XG4gICAgICB0cmFuc2Zvcm1zID0gKHRyYW5zZm9ybXMubGVuZ3RoID09IDEgJiYgaXNBcnJheSh0cmFuc2Zvcm1zWzBdKSlcbiAgICAgICAgPyBhcnJheU1hcCh0cmFuc2Zvcm1zWzBdLCBiYXNlVW5hcnkoZ2V0SXRlcmF0ZWUoKSkpXG4gICAgICAgIDogYXJyYXlNYXAoYmFzZUZsYXR0ZW4odHJhbnNmb3JtcywgMSksIGJhc2VVbmFyeShnZXRJdGVyYXRlZSgpKSk7XG5cbiAgICAgIHZhciBmdW5jc0xlbmd0aCA9IHRyYW5zZm9ybXMubGVuZ3RoO1xuICAgICAgcmV0dXJuIGJhc2VSZXN0KGZ1bmN0aW9uKGFyZ3MpIHtcbiAgICAgICAgdmFyIGluZGV4ID0gLTEsXG4gICAgICAgICAgICBsZW5ndGggPSBuYXRpdmVNaW4oYXJncy5sZW5ndGgsIGZ1bmNzTGVuZ3RoKTtcblxuICAgICAgICB3aGlsZSAoKytpbmRleCA8IGxlbmd0aCkge1xuICAgICAgICAgIGFyZ3NbaW5kZXhdID0gdHJhbnNmb3Jtc1tpbmRleF0uY2FsbCh0aGlzLCBhcmdzW2luZGV4XSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFwcGx5KGZ1bmMsIHRoaXMsIGFyZ3MpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgZnVuY3Rpb24gdGhhdCBpbnZva2VzIGBmdW5jYCB3aXRoIGBwYXJ0aWFsc2AgcHJlcGVuZGVkIHRvIHRoZVxuICAgICAqIGFyZ3VtZW50cyBpdCByZWNlaXZlcy4gVGhpcyBtZXRob2QgaXMgbGlrZSBgXy5iaW5kYCBleGNlcHQgaXQgZG9lcyAqKm5vdCoqXG4gICAgICogYWx0ZXIgdGhlIGB0aGlzYCBiaW5kaW5nLlxuICAgICAqXG4gICAgICogVGhlIGBfLnBhcnRpYWwucGxhY2Vob2xkZXJgIHZhbHVlLCB3aGljaCBkZWZhdWx0cyB0byBgX2AgaW4gbW9ub2xpdGhpY1xuICAgICAqIGJ1aWxkcywgbWF5IGJlIHVzZWQgYXMgYSBwbGFjZWhvbGRlciBmb3IgcGFydGlhbGx5IGFwcGxpZWQgYXJndW1lbnRzLlxuICAgICAqXG4gICAgICogKipOb3RlOioqIFRoaXMgbWV0aG9kIGRvZXNuJ3Qgc2V0IHRoZSBcImxlbmd0aFwiIHByb3BlcnR5IG9mIHBhcnRpYWxseVxuICAgICAqIGFwcGxpZWQgZnVuY3Rpb25zLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDAuMi4wXG4gICAgICogQGNhdGVnb3J5IEZ1bmN0aW9uXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gZnVuYyBUaGUgZnVuY3Rpb24gdG8gcGFydGlhbGx5IGFwcGx5IGFyZ3VtZW50cyB0by5cbiAgICAgKiBAcGFyYW0gey4uLip9IFtwYXJ0aWFsc10gVGhlIGFyZ3VtZW50cyB0byBiZSBwYXJ0aWFsbHkgYXBwbGllZC5cbiAgICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgdGhlIG5ldyBwYXJ0aWFsbHkgYXBwbGllZCBmdW5jdGlvbi5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogZnVuY3Rpb24gZ3JlZXQoZ3JlZXRpbmcsIG5hbWUpIHtcbiAgICAgKiAgIHJldHVybiBncmVldGluZyArICcgJyArIG5hbWU7XG4gICAgICogfVxuICAgICAqXG4gICAgICogdmFyIHNheUhlbGxvVG8gPSBfLnBhcnRpYWwoZ3JlZXQsICdoZWxsbycpO1xuICAgICAqIHNheUhlbGxvVG8oJ2ZyZWQnKTtcbiAgICAgKiAvLyA9PiAnaGVsbG8gZnJlZCdcbiAgICAgKlxuICAgICAqIC8vIFBhcnRpYWxseSBhcHBsaWVkIHdpdGggcGxhY2Vob2xkZXJzLlxuICAgICAqIHZhciBncmVldEZyZWQgPSBfLnBhcnRpYWwoZ3JlZXQsIF8sICdmcmVkJyk7XG4gICAgICogZ3JlZXRGcmVkKCdoaScpO1xuICAgICAqIC8vID0+ICdoaSBmcmVkJ1xuICAgICAqL1xuICAgIHZhciBwYXJ0aWFsID0gYmFzZVJlc3QoZnVuY3Rpb24oZnVuYywgcGFydGlhbHMpIHtcbiAgICAgIHZhciBob2xkZXJzID0gcmVwbGFjZUhvbGRlcnMocGFydGlhbHMsIGdldEhvbGRlcihwYXJ0aWFsKSk7XG4gICAgICByZXR1cm4gY3JlYXRlV3JhcChmdW5jLCBXUkFQX1BBUlRJQUxfRkxBRywgdW5kZWZpbmVkLCBwYXJ0aWFscywgaG9sZGVycyk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBUaGlzIG1ldGhvZCBpcyBsaWtlIGBfLnBhcnRpYWxgIGV4Y2VwdCB0aGF0IHBhcnRpYWxseSBhcHBsaWVkIGFyZ3VtZW50c1xuICAgICAqIGFyZSBhcHBlbmRlZCB0byB0aGUgYXJndW1lbnRzIGl0IHJlY2VpdmVzLlxuICAgICAqXG4gICAgICogVGhlIGBfLnBhcnRpYWxSaWdodC5wbGFjZWhvbGRlcmAgdmFsdWUsIHdoaWNoIGRlZmF1bHRzIHRvIGBfYCBpbiBtb25vbGl0aGljXG4gICAgICogYnVpbGRzLCBtYXkgYmUgdXNlZCBhcyBhIHBsYWNlaG9sZGVyIGZvciBwYXJ0aWFsbHkgYXBwbGllZCBhcmd1bWVudHMuXG4gICAgICpcbiAgICAgKiAqKk5vdGU6KiogVGhpcyBtZXRob2QgZG9lc24ndCBzZXQgdGhlIFwibGVuZ3RoXCIgcHJvcGVydHkgb2YgcGFydGlhbGx5XG4gICAgICogYXBwbGllZCBmdW5jdGlvbnMuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMS4wLjBcbiAgICAgKiBAY2F0ZWdvcnkgRnVuY3Rpb25cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmdW5jIFRoZSBmdW5jdGlvbiB0byBwYXJ0aWFsbHkgYXBwbHkgYXJndW1lbnRzIHRvLlxuICAgICAqIEBwYXJhbSB7Li4uKn0gW3BhcnRpYWxzXSBUaGUgYXJndW1lbnRzIHRvIGJlIHBhcnRpYWxseSBhcHBsaWVkLlxuICAgICAqIEByZXR1cm5zIHtGdW5jdGlvbn0gUmV0dXJucyB0aGUgbmV3IHBhcnRpYWxseSBhcHBsaWVkIGZ1bmN0aW9uLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBmdW5jdGlvbiBncmVldChncmVldGluZywgbmFtZSkge1xuICAgICAqICAgcmV0dXJuIGdyZWV0aW5nICsgJyAnICsgbmFtZTtcbiAgICAgKiB9XG4gICAgICpcbiAgICAgKiB2YXIgZ3JlZXRGcmVkID0gXy5wYXJ0aWFsUmlnaHQoZ3JlZXQsICdmcmVkJyk7XG4gICAgICogZ3JlZXRGcmVkKCdoaScpO1xuICAgICAqIC8vID0+ICdoaSBmcmVkJ1xuICAgICAqXG4gICAgICogLy8gUGFydGlhbGx5IGFwcGxpZWQgd2l0aCBwbGFjZWhvbGRlcnMuXG4gICAgICogdmFyIHNheUhlbGxvVG8gPSBfLnBhcnRpYWxSaWdodChncmVldCwgJ2hlbGxvJywgXyk7XG4gICAgICogc2F5SGVsbG9UbygnZnJlZCcpO1xuICAgICAqIC8vID0+ICdoZWxsbyBmcmVkJ1xuICAgICAqL1xuICAgIHZhciBwYXJ0aWFsUmlnaHQgPSBiYXNlUmVzdChmdW5jdGlvbihmdW5jLCBwYXJ0aWFscykge1xuICAgICAgdmFyIGhvbGRlcnMgPSByZXBsYWNlSG9sZGVycyhwYXJ0aWFscywgZ2V0SG9sZGVyKHBhcnRpYWxSaWdodCkpO1xuICAgICAgcmV0dXJuIGNyZWF0ZVdyYXAoZnVuYywgV1JBUF9QQVJUSUFMX1JJR0hUX0ZMQUcsIHVuZGVmaW5lZCwgcGFydGlhbHMsIGhvbGRlcnMpO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGZ1bmN0aW9uIHRoYXQgaW52b2tlcyBgZnVuY2Agd2l0aCBhcmd1bWVudHMgYXJyYW5nZWQgYWNjb3JkaW5nXG4gICAgICogdG8gdGhlIHNwZWNpZmllZCBgaW5kZXhlc2Agd2hlcmUgdGhlIGFyZ3VtZW50IHZhbHVlIGF0IHRoZSBmaXJzdCBpbmRleCBpc1xuICAgICAqIHByb3ZpZGVkIGFzIHRoZSBmaXJzdCBhcmd1bWVudCwgdGhlIGFyZ3VtZW50IHZhbHVlIGF0IHRoZSBzZWNvbmQgaW5kZXggaXNcbiAgICAgKiBwcm92aWRlZCBhcyB0aGUgc2Vjb25kIGFyZ3VtZW50LCBhbmQgc28gb24uXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMy4wLjBcbiAgICAgKiBAY2F0ZWdvcnkgRnVuY3Rpb25cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmdW5jIFRoZSBmdW5jdGlvbiB0byByZWFycmFuZ2UgYXJndW1lbnRzIGZvci5cbiAgICAgKiBAcGFyYW0gey4uLihudW1iZXJ8bnVtYmVyW10pfSBpbmRleGVzIFRoZSBhcnJhbmdlZCBhcmd1bWVudCBpbmRleGVzLlxuICAgICAqIEByZXR1cm5zIHtGdW5jdGlvbn0gUmV0dXJucyB0aGUgbmV3IGZ1bmN0aW9uLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiB2YXIgcmVhcmdlZCA9IF8ucmVhcmcoZnVuY3Rpb24oYSwgYiwgYykge1xuICAgICAqICAgcmV0dXJuIFthLCBiLCBjXTtcbiAgICAgKiB9LCBbMiwgMCwgMV0pO1xuICAgICAqXG4gICAgICogcmVhcmdlZCgnYicsICdjJywgJ2EnKVxuICAgICAqIC8vID0+IFsnYScsICdiJywgJ2MnXVxuICAgICAqL1xuICAgIHZhciByZWFyZyA9IGZsYXRSZXN0KGZ1bmN0aW9uKGZ1bmMsIGluZGV4ZXMpIHtcbiAgICAgIHJldHVybiBjcmVhdGVXcmFwKGZ1bmMsIFdSQVBfUkVBUkdfRkxBRywgdW5kZWZpbmVkLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgaW5kZXhlcyk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgZnVuY3Rpb24gdGhhdCBpbnZva2VzIGBmdW5jYCB3aXRoIHRoZSBgdGhpc2AgYmluZGluZyBvZiB0aGVcbiAgICAgKiBjcmVhdGVkIGZ1bmN0aW9uIGFuZCBhcmd1bWVudHMgZnJvbSBgc3RhcnRgIGFuZCBiZXlvbmQgcHJvdmlkZWQgYXNcbiAgICAgKiBhbiBhcnJheS5cbiAgICAgKlxuICAgICAqICoqTm90ZToqKiBUaGlzIG1ldGhvZCBpcyBiYXNlZCBvbiB0aGVcbiAgICAgKiBbcmVzdCBwYXJhbWV0ZXJdKGh0dHBzOi8vbWRuLmlvL3Jlc3RfcGFyYW1ldGVycykuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgNC4wLjBcbiAgICAgKiBAY2F0ZWdvcnkgRnVuY3Rpb25cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmdW5jIFRoZSBmdW5jdGlvbiB0byBhcHBseSBhIHJlc3QgcGFyYW1ldGVyIHRvLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbc3RhcnQ9ZnVuYy5sZW5ndGgtMV0gVGhlIHN0YXJ0IHBvc2l0aW9uIG9mIHRoZSByZXN0IHBhcmFtZXRlci5cbiAgICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgdGhlIG5ldyBmdW5jdGlvbi5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogdmFyIHNheSA9IF8ucmVzdChmdW5jdGlvbih3aGF0LCBuYW1lcykge1xuICAgICAqICAgcmV0dXJuIHdoYXQgKyAnICcgKyBfLmluaXRpYWwobmFtZXMpLmpvaW4oJywgJykgK1xuICAgICAqICAgICAoXy5zaXplKG5hbWVzKSA+IDEgPyAnLCAmICcgOiAnJykgKyBfLmxhc3QobmFtZXMpO1xuICAgICAqIH0pO1xuICAgICAqXG4gICAgICogc2F5KCdoZWxsbycsICdmcmVkJywgJ2Jhcm5leScsICdwZWJibGVzJyk7XG4gICAgICogLy8gPT4gJ2hlbGxvIGZyZWQsIGJhcm5leSwgJiBwZWJibGVzJ1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIHJlc3QoZnVuYywgc3RhcnQpIHtcbiAgICAgIGlmICh0eXBlb2YgZnVuYyAhPSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoRlVOQ19FUlJPUl9URVhUKTtcbiAgICAgIH1cbiAgICAgIHN0YXJ0ID0gc3RhcnQgPT09IHVuZGVmaW5lZCA/IHN0YXJ0IDogdG9JbnRlZ2VyKHN0YXJ0KTtcbiAgICAgIHJldHVybiBiYXNlUmVzdChmdW5jLCBzdGFydCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGZ1bmN0aW9uIHRoYXQgaW52b2tlcyBgZnVuY2Agd2l0aCB0aGUgYHRoaXNgIGJpbmRpbmcgb2YgdGhlXG4gICAgICogY3JlYXRlIGZ1bmN0aW9uIGFuZCBhbiBhcnJheSBvZiBhcmd1bWVudHMgbXVjaCBsaWtlXG4gICAgICogW2BGdW5jdGlvbiNhcHBseWBdKGh0dHA6Ly93d3cuZWNtYS1pbnRlcm5hdGlvbmFsLm9yZy9lY21hLTI2Mi83LjAvI3NlYy1mdW5jdGlvbi5wcm90b3R5cGUuYXBwbHkpLlxuICAgICAqXG4gICAgICogKipOb3RlOioqIFRoaXMgbWV0aG9kIGlzIGJhc2VkIG9uIHRoZVxuICAgICAqIFtzcHJlYWQgb3BlcmF0b3JdKGh0dHBzOi8vbWRuLmlvL3NwcmVhZF9vcGVyYXRvcikuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMy4yLjBcbiAgICAgKiBAY2F0ZWdvcnkgRnVuY3Rpb25cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmdW5jIFRoZSBmdW5jdGlvbiB0byBzcHJlYWQgYXJndW1lbnRzIG92ZXIuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtzdGFydD0wXSBUaGUgc3RhcnQgcG9zaXRpb24gb2YgdGhlIHNwcmVhZC5cbiAgICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgdGhlIG5ldyBmdW5jdGlvbi5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogdmFyIHNheSA9IF8uc3ByZWFkKGZ1bmN0aW9uKHdobywgd2hhdCkge1xuICAgICAqICAgcmV0dXJuIHdobyArICcgc2F5cyAnICsgd2hhdDtcbiAgICAgKiB9KTtcbiAgICAgKlxuICAgICAqIHNheShbJ2ZyZWQnLCAnaGVsbG8nXSk7XG4gICAgICogLy8gPT4gJ2ZyZWQgc2F5cyBoZWxsbydcbiAgICAgKlxuICAgICAqIHZhciBudW1iZXJzID0gUHJvbWlzZS5hbGwoW1xuICAgICAqICAgUHJvbWlzZS5yZXNvbHZlKDQwKSxcbiAgICAgKiAgIFByb21pc2UucmVzb2x2ZSgzNilcbiAgICAgKiBdKTtcbiAgICAgKlxuICAgICAqIG51bWJlcnMudGhlbihfLnNwcmVhZChmdW5jdGlvbih4LCB5KSB7XG4gICAgICogICByZXR1cm4geCArIHk7XG4gICAgICogfSkpO1xuICAgICAqIC8vID0+IGEgUHJvbWlzZSBvZiA3NlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHNwcmVhZChmdW5jLCBzdGFydCkge1xuICAgICAgaWYgKHR5cGVvZiBmdW5jICE9ICdmdW5jdGlvbicpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihGVU5DX0VSUk9SX1RFWFQpO1xuICAgICAgfVxuICAgICAgc3RhcnQgPSBzdGFydCA9PSBudWxsID8gMCA6IG5hdGl2ZU1heCh0b0ludGVnZXIoc3RhcnQpLCAwKTtcbiAgICAgIHJldHVybiBiYXNlUmVzdChmdW5jdGlvbihhcmdzKSB7XG4gICAgICAgIHZhciBhcnJheSA9IGFyZ3Nbc3RhcnRdLFxuICAgICAgICAgICAgb3RoZXJBcmdzID0gY2FzdFNsaWNlKGFyZ3MsIDAsIHN0YXJ0KTtcblxuICAgICAgICBpZiAoYXJyYXkpIHtcbiAgICAgICAgICBhcnJheVB1c2gob3RoZXJBcmdzLCBhcnJheSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFwcGx5KGZ1bmMsIHRoaXMsIG90aGVyQXJncyk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgdGhyb3R0bGVkIGZ1bmN0aW9uIHRoYXQgb25seSBpbnZva2VzIGBmdW5jYCBhdCBtb3N0IG9uY2UgcGVyXG4gICAgICogZXZlcnkgYHdhaXRgIG1pbGxpc2Vjb25kcy4gVGhlIHRocm90dGxlZCBmdW5jdGlvbiBjb21lcyB3aXRoIGEgYGNhbmNlbGBcbiAgICAgKiBtZXRob2QgdG8gY2FuY2VsIGRlbGF5ZWQgYGZ1bmNgIGludm9jYXRpb25zIGFuZCBhIGBmbHVzaGAgbWV0aG9kIHRvXG4gICAgICogaW1tZWRpYXRlbHkgaW52b2tlIHRoZW0uIFByb3ZpZGUgYG9wdGlvbnNgIHRvIGluZGljYXRlIHdoZXRoZXIgYGZ1bmNgXG4gICAgICogc2hvdWxkIGJlIGludm9rZWQgb24gdGhlIGxlYWRpbmcgYW5kL29yIHRyYWlsaW5nIGVkZ2Ugb2YgdGhlIGB3YWl0YFxuICAgICAqIHRpbWVvdXQuIFRoZSBgZnVuY2AgaXMgaW52b2tlZCB3aXRoIHRoZSBsYXN0IGFyZ3VtZW50cyBwcm92aWRlZCB0byB0aGVcbiAgICAgKiB0aHJvdHRsZWQgZnVuY3Rpb24uIFN1YnNlcXVlbnQgY2FsbHMgdG8gdGhlIHRocm90dGxlZCBmdW5jdGlvbiByZXR1cm4gdGhlXG4gICAgICogcmVzdWx0IG9mIHRoZSBsYXN0IGBmdW5jYCBpbnZvY2F0aW9uLlxuICAgICAqXG4gICAgICogKipOb3RlOioqIElmIGBsZWFkaW5nYCBhbmQgYHRyYWlsaW5nYCBvcHRpb25zIGFyZSBgdHJ1ZWAsIGBmdW5jYCBpc1xuICAgICAqIGludm9rZWQgb24gdGhlIHRyYWlsaW5nIGVkZ2Ugb2YgdGhlIHRpbWVvdXQgb25seSBpZiB0aGUgdGhyb3R0bGVkIGZ1bmN0aW9uXG4gICAgICogaXMgaW52b2tlZCBtb3JlIHRoYW4gb25jZSBkdXJpbmcgdGhlIGB3YWl0YCB0aW1lb3V0LlxuICAgICAqXG4gICAgICogSWYgYHdhaXRgIGlzIGAwYCBhbmQgYGxlYWRpbmdgIGlzIGBmYWxzZWAsIGBmdW5jYCBpbnZvY2F0aW9uIGlzIGRlZmVycmVkXG4gICAgICogdW50aWwgdG8gdGhlIG5leHQgdGljaywgc2ltaWxhciB0byBgc2V0VGltZW91dGAgd2l0aCBhIHRpbWVvdXQgb2YgYDBgLlxuICAgICAqXG4gICAgICogU2VlIFtEYXZpZCBDb3JiYWNobydzIGFydGljbGVdKGh0dHBzOi8vY3NzLXRyaWNrcy5jb20vZGVib3VuY2luZy10aHJvdHRsaW5nLWV4cGxhaW5lZC1leGFtcGxlcy8pXG4gICAgICogZm9yIGRldGFpbHMgb3ZlciB0aGUgZGlmZmVyZW5jZXMgYmV0d2VlbiBgXy50aHJvdHRsZWAgYW5kIGBfLmRlYm91bmNlYC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAwLjEuMFxuICAgICAqIEBjYXRlZ29yeSBGdW5jdGlvblxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZ1bmMgVGhlIGZ1bmN0aW9uIHRvIHRocm90dGxlLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbd2FpdD0wXSBUaGUgbnVtYmVyIG9mIG1pbGxpc2Vjb25kcyB0byB0aHJvdHRsZSBpbnZvY2F0aW9ucyB0by5cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnM9e31dIFRoZSBvcHRpb25zIG9iamVjdC5cbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtvcHRpb25zLmxlYWRpbmc9dHJ1ZV1cbiAgICAgKiAgU3BlY2lmeSBpbnZva2luZyBvbiB0aGUgbGVhZGluZyBlZGdlIG9mIHRoZSB0aW1lb3V0LlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW29wdGlvbnMudHJhaWxpbmc9dHJ1ZV1cbiAgICAgKiAgU3BlY2lmeSBpbnZva2luZyBvbiB0aGUgdHJhaWxpbmcgZWRnZSBvZiB0aGUgdGltZW91dC5cbiAgICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgdGhlIG5ldyB0aHJvdHRsZWQgZnVuY3Rpb24uXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIC8vIEF2b2lkIGV4Y2Vzc2l2ZWx5IHVwZGF0aW5nIHRoZSBwb3NpdGlvbiB3aGlsZSBzY3JvbGxpbmcuXG4gICAgICogalF1ZXJ5KHdpbmRvdykub24oJ3Njcm9sbCcsIF8udGhyb3R0bGUodXBkYXRlUG9zaXRpb24sIDEwMCkpO1xuICAgICAqXG4gICAgICogLy8gSW52b2tlIGByZW5ld1Rva2VuYCB3aGVuIHRoZSBjbGljayBldmVudCBpcyBmaXJlZCwgYnV0IG5vdCBtb3JlIHRoYW4gb25jZSBldmVyeSA1IG1pbnV0ZXMuXG4gICAgICogdmFyIHRocm90dGxlZCA9IF8udGhyb3R0bGUocmVuZXdUb2tlbiwgMzAwMDAwLCB7ICd0cmFpbGluZyc6IGZhbHNlIH0pO1xuICAgICAqIGpRdWVyeShlbGVtZW50KS5vbignY2xpY2snLCB0aHJvdHRsZWQpO1xuICAgICAqXG4gICAgICogLy8gQ2FuY2VsIHRoZSB0cmFpbGluZyB0aHJvdHRsZWQgaW52b2NhdGlvbi5cbiAgICAgKiBqUXVlcnkod2luZG93KS5vbigncG9wc3RhdGUnLCB0aHJvdHRsZWQuY2FuY2VsKTtcbiAgICAgKi9cbiAgICBmdW5jdGlvbiB0aHJvdHRsZShmdW5jLCB3YWl0LCBvcHRpb25zKSB7XG4gICAgICB2YXIgbGVhZGluZyA9IHRydWUsXG4gICAgICAgICAgdHJhaWxpbmcgPSB0cnVlO1xuXG4gICAgICBpZiAodHlwZW9mIGZ1bmMgIT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKEZVTkNfRVJST1JfVEVYVCk7XG4gICAgICB9XG4gICAgICBpZiAoaXNPYmplY3Qob3B0aW9ucykpIHtcbiAgICAgICAgbGVhZGluZyA9ICdsZWFkaW5nJyBpbiBvcHRpb25zID8gISFvcHRpb25zLmxlYWRpbmcgOiBsZWFkaW5nO1xuICAgICAgICB0cmFpbGluZyA9ICd0cmFpbGluZycgaW4gb3B0aW9ucyA/ICEhb3B0aW9ucy50cmFpbGluZyA6IHRyYWlsaW5nO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGRlYm91bmNlKGZ1bmMsIHdhaXQsIHtcbiAgICAgICAgJ2xlYWRpbmcnOiBsZWFkaW5nLFxuICAgICAgICAnbWF4V2FpdCc6IHdhaXQsXG4gICAgICAgICd0cmFpbGluZyc6IHRyYWlsaW5nXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgZnVuY3Rpb24gdGhhdCBhY2NlcHRzIHVwIHRvIG9uZSBhcmd1bWVudCwgaWdub3JpbmcgYW55XG4gICAgICogYWRkaXRpb25hbCBhcmd1bWVudHMuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgNC4wLjBcbiAgICAgKiBAY2F0ZWdvcnkgRnVuY3Rpb25cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmdW5jIFRoZSBmdW5jdGlvbiB0byBjYXAgYXJndW1lbnRzIGZvci5cbiAgICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgdGhlIG5ldyBjYXBwZWQgZnVuY3Rpb24uXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8ubWFwKFsnNicsICc4JywgJzEwJ10sIF8udW5hcnkocGFyc2VJbnQpKTtcbiAgICAgKiAvLyA9PiBbNiwgOCwgMTBdXG4gICAgICovXG4gICAgZnVuY3Rpb24gdW5hcnkoZnVuYykge1xuICAgICAgcmV0dXJuIGFyeShmdW5jLCAxKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgZnVuY3Rpb24gdGhhdCBwcm92aWRlcyBgdmFsdWVgIHRvIGB3cmFwcGVyYCBhcyBpdHMgZmlyc3RcbiAgICAgKiBhcmd1bWVudC4gQW55IGFkZGl0aW9uYWwgYXJndW1lbnRzIHByb3ZpZGVkIHRvIHRoZSBmdW5jdGlvbiBhcmUgYXBwZW5kZWRcbiAgICAgKiB0byB0aG9zZSBwcm92aWRlZCB0byB0aGUgYHdyYXBwZXJgLiBUaGUgd3JhcHBlciBpcyBpbnZva2VkIHdpdGggdGhlIGB0aGlzYFxuICAgICAqIGJpbmRpbmcgb2YgdGhlIGNyZWF0ZWQgZnVuY3Rpb24uXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMC4xLjBcbiAgICAgKiBAY2F0ZWdvcnkgRnVuY3Rpb25cbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byB3cmFwLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IFt3cmFwcGVyPWlkZW50aXR5XSBUaGUgd3JhcHBlciBmdW5jdGlvbi5cbiAgICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgdGhlIG5ldyBmdW5jdGlvbi5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogdmFyIHAgPSBfLndyYXAoXy5lc2NhcGUsIGZ1bmN0aW9uKGZ1bmMsIHRleHQpIHtcbiAgICAgKiAgIHJldHVybiAnPHA+JyArIGZ1bmModGV4dCkgKyAnPC9wPic7XG4gICAgICogfSk7XG4gICAgICpcbiAgICAgKiBwKCdmcmVkLCBiYXJuZXksICYgcGViYmxlcycpO1xuICAgICAqIC8vID0+ICc8cD5mcmVkLCBiYXJuZXksICZhbXA7IHBlYmJsZXM8L3A+J1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIHdyYXAodmFsdWUsIHdyYXBwZXIpIHtcbiAgICAgIHJldHVybiBwYXJ0aWFsKGNhc3RGdW5jdGlvbih3cmFwcGVyKSwgdmFsdWUpO1xuICAgIH1cblxuICAgIC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuICAgIC8qKlxuICAgICAqIENhc3RzIGB2YWx1ZWAgYXMgYW4gYXJyYXkgaWYgaXQncyBub3Qgb25lLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDQuNC4wXG4gICAgICogQGNhdGVnb3J5IExhbmdcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBpbnNwZWN0LlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgY2FzdCBhcnJheS5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5jYXN0QXJyYXkoMSk7XG4gICAgICogLy8gPT4gWzFdXG4gICAgICpcbiAgICAgKiBfLmNhc3RBcnJheSh7ICdhJzogMSB9KTtcbiAgICAgKiAvLyA9PiBbeyAnYSc6IDEgfV1cbiAgICAgKlxuICAgICAqIF8uY2FzdEFycmF5KCdhYmMnKTtcbiAgICAgKiAvLyA9PiBbJ2FiYyddXG4gICAgICpcbiAgICAgKiBfLmNhc3RBcnJheShudWxsKTtcbiAgICAgKiAvLyA9PiBbbnVsbF1cbiAgICAgKlxuICAgICAqIF8uY2FzdEFycmF5KHVuZGVmaW5lZCk7XG4gICAgICogLy8gPT4gW3VuZGVmaW5lZF1cbiAgICAgKlxuICAgICAqIF8uY2FzdEFycmF5KCk7XG4gICAgICogLy8gPT4gW11cbiAgICAgKlxuICAgICAqIHZhciBhcnJheSA9IFsxLCAyLCAzXTtcbiAgICAgKiBjb25zb2xlLmxvZyhfLmNhc3RBcnJheShhcnJheSkgPT09IGFycmF5KTtcbiAgICAgKiAvLyA9PiB0cnVlXG4gICAgICovXG4gICAgZnVuY3Rpb24gY2FzdEFycmF5KCkge1xuICAgICAgaWYgKCFhcmd1bWVudHMubGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBbXTtcbiAgICAgIH1cbiAgICAgIHZhciB2YWx1ZSA9IGFyZ3VtZW50c1swXTtcbiAgICAgIHJldHVybiBpc0FycmF5KHZhbHVlKSA/IHZhbHVlIDogW3ZhbHVlXTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgc2hhbGxvdyBjbG9uZSBvZiBgdmFsdWVgLlxuICAgICAqXG4gICAgICogKipOb3RlOioqIFRoaXMgbWV0aG9kIGlzIGxvb3NlbHkgYmFzZWQgb24gdGhlXG4gICAgICogW3N0cnVjdHVyZWQgY2xvbmUgYWxnb3JpdGhtXShodHRwczovL21kbi5pby9TdHJ1Y3R1cmVkX2Nsb25lX2FsZ29yaXRobSlcbiAgICAgKiBhbmQgc3VwcG9ydHMgY2xvbmluZyBhcnJheXMsIGFycmF5IGJ1ZmZlcnMsIGJvb2xlYW5zLCBkYXRlIG9iamVjdHMsIG1hcHMsXG4gICAgICogbnVtYmVycywgYE9iamVjdGAgb2JqZWN0cywgcmVnZXhlcywgc2V0cywgc3RyaW5ncywgc3ltYm9scywgYW5kIHR5cGVkXG4gICAgICogYXJyYXlzLiBUaGUgb3duIGVudW1lcmFibGUgcHJvcGVydGllcyBvZiBgYXJndW1lbnRzYCBvYmplY3RzIGFyZSBjbG9uZWRcbiAgICAgKiBhcyBwbGFpbiBvYmplY3RzLiBBbiBlbXB0eSBvYmplY3QgaXMgcmV0dXJuZWQgZm9yIHVuY2xvbmVhYmxlIHZhbHVlcyBzdWNoXG4gICAgICogYXMgZXJyb3Igb2JqZWN0cywgZnVuY3Rpb25zLCBET00gbm9kZXMsIGFuZCBXZWFrTWFwcy5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAwLjEuMFxuICAgICAqIEBjYXRlZ29yeSBMYW5nXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2xvbmUuXG4gICAgICogQHJldHVybnMgeyp9IFJldHVybnMgdGhlIGNsb25lZCB2YWx1ZS5cbiAgICAgKiBAc2VlIF8uY2xvbmVEZWVwXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciBvYmplY3RzID0gW3sgJ2EnOiAxIH0sIHsgJ2InOiAyIH1dO1xuICAgICAqXG4gICAgICogdmFyIHNoYWxsb3cgPSBfLmNsb25lKG9iamVjdHMpO1xuICAgICAqIGNvbnNvbGUubG9nKHNoYWxsb3dbMF0gPT09IG9iamVjdHNbMF0pO1xuICAgICAqIC8vID0+IHRydWVcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjbG9uZSh2YWx1ZSkge1xuICAgICAgcmV0dXJuIGJhc2VDbG9uZSh2YWx1ZSwgQ0xPTkVfU1lNQk9MU19GTEFHKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGlzIG1ldGhvZCBpcyBsaWtlIGBfLmNsb25lYCBleGNlcHQgdGhhdCBpdCBhY2NlcHRzIGBjdXN0b21pemVyYCB3aGljaFxuICAgICAqIGlzIGludm9rZWQgdG8gcHJvZHVjZSB0aGUgY2xvbmVkIHZhbHVlLiBJZiBgY3VzdG9taXplcmAgcmV0dXJucyBgdW5kZWZpbmVkYCxcbiAgICAgKiBjbG9uaW5nIGlzIGhhbmRsZWQgYnkgdGhlIG1ldGhvZCBpbnN0ZWFkLiBUaGUgYGN1c3RvbWl6ZXJgIGlzIGludm9rZWQgd2l0aFxuICAgICAqIHVwIHRvIGZvdXIgYXJndW1lbnRzOyAodmFsdWUgWywgaW5kZXh8a2V5LCBvYmplY3QsIHN0YWNrXSkuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgNC4wLjBcbiAgICAgKiBAY2F0ZWdvcnkgTGFuZ1xuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNsb25lLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtjdXN0b21pemVyXSBUaGUgZnVuY3Rpb24gdG8gY3VzdG9taXplIGNsb25pbmcuXG4gICAgICogQHJldHVybnMgeyp9IFJldHVybnMgdGhlIGNsb25lZCB2YWx1ZS5cbiAgICAgKiBAc2VlIF8uY2xvbmVEZWVwV2l0aFxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBmdW5jdGlvbiBjdXN0b21pemVyKHZhbHVlKSB7XG4gICAgICogICBpZiAoXy5pc0VsZW1lbnQodmFsdWUpKSB7XG4gICAgICogICAgIHJldHVybiB2YWx1ZS5jbG9uZU5vZGUoZmFsc2UpO1xuICAgICAqICAgfVxuICAgICAqIH1cbiAgICAgKlxuICAgICAqIHZhciBlbCA9IF8uY2xvbmVXaXRoKGRvY3VtZW50LmJvZHksIGN1c3RvbWl6ZXIpO1xuICAgICAqXG4gICAgICogY29uc29sZS5sb2coZWwgPT09IGRvY3VtZW50LmJvZHkpO1xuICAgICAqIC8vID0+IGZhbHNlXG4gICAgICogY29uc29sZS5sb2coZWwubm9kZU5hbWUpO1xuICAgICAqIC8vID0+ICdCT0RZJ1xuICAgICAqIGNvbnNvbGUubG9nKGVsLmNoaWxkTm9kZXMubGVuZ3RoKTtcbiAgICAgKiAvLyA9PiAwXG4gICAgICovXG4gICAgZnVuY3Rpb24gY2xvbmVXaXRoKHZhbHVlLCBjdXN0b21pemVyKSB7XG4gICAgICBjdXN0b21pemVyID0gdHlwZW9mIGN1c3RvbWl6ZXIgPT0gJ2Z1bmN0aW9uJyA/IGN1c3RvbWl6ZXIgOiB1bmRlZmluZWQ7XG4gICAgICByZXR1cm4gYmFzZUNsb25lKHZhbHVlLCBDTE9ORV9TWU1CT0xTX0ZMQUcsIGN1c3RvbWl6ZXIpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoaXMgbWV0aG9kIGlzIGxpa2UgYF8uY2xvbmVgIGV4Y2VwdCB0aGF0IGl0IHJlY3Vyc2l2ZWx5IGNsb25lcyBgdmFsdWVgLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDEuMC4wXG4gICAgICogQGNhdGVnb3J5IExhbmdcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byByZWN1cnNpdmVseSBjbG9uZS5cbiAgICAgKiBAcmV0dXJucyB7Kn0gUmV0dXJucyB0aGUgZGVlcCBjbG9uZWQgdmFsdWUuXG4gICAgICogQHNlZSBfLmNsb25lXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciBvYmplY3RzID0gW3sgJ2EnOiAxIH0sIHsgJ2InOiAyIH1dO1xuICAgICAqXG4gICAgICogdmFyIGRlZXAgPSBfLmNsb25lRGVlcChvYmplY3RzKTtcbiAgICAgKiBjb25zb2xlLmxvZyhkZWVwWzBdID09PSBvYmplY3RzWzBdKTtcbiAgICAgKiAvLyA9PiBmYWxzZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNsb25lRGVlcCh2YWx1ZSkge1xuICAgICAgcmV0dXJuIGJhc2VDbG9uZSh2YWx1ZSwgQ0xPTkVfREVFUF9GTEFHIHwgQ0xPTkVfU1lNQk9MU19GTEFHKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGlzIG1ldGhvZCBpcyBsaWtlIGBfLmNsb25lV2l0aGAgZXhjZXB0IHRoYXQgaXQgcmVjdXJzaXZlbHkgY2xvbmVzIGB2YWx1ZWAuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgNC4wLjBcbiAgICAgKiBAY2F0ZWdvcnkgTGFuZ1xuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIHJlY3Vyc2l2ZWx5IGNsb25lLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtjdXN0b21pemVyXSBUaGUgZnVuY3Rpb24gdG8gY3VzdG9taXplIGNsb25pbmcuXG4gICAgICogQHJldHVybnMgeyp9IFJldHVybnMgdGhlIGRlZXAgY2xvbmVkIHZhbHVlLlxuICAgICAqIEBzZWUgXy5jbG9uZVdpdGhcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogZnVuY3Rpb24gY3VzdG9taXplcih2YWx1ZSkge1xuICAgICAqICAgaWYgKF8uaXNFbGVtZW50KHZhbHVlKSkge1xuICAgICAqICAgICByZXR1cm4gdmFsdWUuY2xvbmVOb2RlKHRydWUpO1xuICAgICAqICAgfVxuICAgICAqIH1cbiAgICAgKlxuICAgICAqIHZhciBlbCA9IF8uY2xvbmVEZWVwV2l0aChkb2N1bWVudC5ib2R5LCBjdXN0b21pemVyKTtcbiAgICAgKlxuICAgICAqIGNvbnNvbGUubG9nKGVsID09PSBkb2N1bWVudC5ib2R5KTtcbiAgICAgKiAvLyA9PiBmYWxzZVxuICAgICAqIGNvbnNvbGUubG9nKGVsLm5vZGVOYW1lKTtcbiAgICAgKiAvLyA9PiAnQk9EWSdcbiAgICAgKiBjb25zb2xlLmxvZyhlbC5jaGlsZE5vZGVzLmxlbmd0aCk7XG4gICAgICogLy8gPT4gMjBcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjbG9uZURlZXBXaXRoKHZhbHVlLCBjdXN0b21pemVyKSB7XG4gICAgICBjdXN0b21pemVyID0gdHlwZW9mIGN1c3RvbWl6ZXIgPT0gJ2Z1bmN0aW9uJyA/IGN1c3RvbWl6ZXIgOiB1bmRlZmluZWQ7XG4gICAgICByZXR1cm4gYmFzZUNsb25lKHZhbHVlLCBDTE9ORV9ERUVQX0ZMQUcgfCBDTE9ORV9TWU1CT0xTX0ZMQUcsIGN1c3RvbWl6ZXIpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrcyBpZiBgb2JqZWN0YCBjb25mb3JtcyB0byBgc291cmNlYCBieSBpbnZva2luZyB0aGUgcHJlZGljYXRlXG4gICAgICogcHJvcGVydGllcyBvZiBgc291cmNlYCB3aXRoIHRoZSBjb3JyZXNwb25kaW5nIHByb3BlcnR5IHZhbHVlcyBvZiBgb2JqZWN0YC5cbiAgICAgKlxuICAgICAqICoqTm90ZToqKiBUaGlzIG1ldGhvZCBpcyBlcXVpdmFsZW50IHRvIGBfLmNvbmZvcm1zYCB3aGVuIGBzb3VyY2VgIGlzXG4gICAgICogcGFydGlhbGx5IGFwcGxpZWQuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgNC4xNC4wXG4gICAgICogQGNhdGVnb3J5IExhbmdcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8gaW5zcGVjdC5cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gc291cmNlIFRoZSBvYmplY3Qgb2YgcHJvcGVydHkgcHJlZGljYXRlcyB0byBjb25mb3JtIHRvLlxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBgb2JqZWN0YCBjb25mb3JtcywgZWxzZSBgZmFsc2VgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiB2YXIgb2JqZWN0ID0geyAnYSc6IDEsICdiJzogMiB9O1xuICAgICAqXG4gICAgICogXy5jb25mb3Jtc1RvKG9iamVjdCwgeyAnYic6IGZ1bmN0aW9uKG4pIHsgcmV0dXJuIG4gPiAxOyB9IH0pO1xuICAgICAqIC8vID0+IHRydWVcbiAgICAgKlxuICAgICAqIF8uY29uZm9ybXNUbyhvYmplY3QsIHsgJ2InOiBmdW5jdGlvbihuKSB7IHJldHVybiBuID4gMjsgfSB9KTtcbiAgICAgKiAvLyA9PiBmYWxzZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNvbmZvcm1zVG8ob2JqZWN0LCBzb3VyY2UpIHtcbiAgICAgIHJldHVybiBzb3VyY2UgPT0gbnVsbCB8fCBiYXNlQ29uZm9ybXNUbyhvYmplY3QsIHNvdXJjZSwga2V5cyhzb3VyY2UpKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQZXJmb3JtcyBhXG4gICAgICogW2BTYW1lVmFsdWVaZXJvYF0oaHR0cDovL2VjbWEtaW50ZXJuYXRpb25hbC5vcmcvZWNtYS0yNjIvNy4wLyNzZWMtc2FtZXZhbHVlemVybylcbiAgICAgKiBjb21wYXJpc29uIGJldHdlZW4gdHdvIHZhbHVlcyB0byBkZXRlcm1pbmUgaWYgdGhleSBhcmUgZXF1aXZhbGVudC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSA0LjAuMFxuICAgICAqIEBjYXRlZ29yeSBMYW5nXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY29tcGFyZS5cbiAgICAgKiBAcGFyYW0geyp9IG90aGVyIFRoZSBvdGhlciB2YWx1ZSB0byBjb21wYXJlLlxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgdmFsdWVzIGFyZSBlcXVpdmFsZW50LCBlbHNlIGBmYWxzZWAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciBvYmplY3QgPSB7ICdhJzogMSB9O1xuICAgICAqIHZhciBvdGhlciA9IHsgJ2EnOiAxIH07XG4gICAgICpcbiAgICAgKiBfLmVxKG9iamVjdCwgb2JqZWN0KTtcbiAgICAgKiAvLyA9PiB0cnVlXG4gICAgICpcbiAgICAgKiBfLmVxKG9iamVjdCwgb3RoZXIpO1xuICAgICAqIC8vID0+IGZhbHNlXG4gICAgICpcbiAgICAgKiBfLmVxKCdhJywgJ2EnKTtcbiAgICAgKiAvLyA9PiB0cnVlXG4gICAgICpcbiAgICAgKiBfLmVxKCdhJywgT2JqZWN0KCdhJykpO1xuICAgICAqIC8vID0+IGZhbHNlXG4gICAgICpcbiAgICAgKiBfLmVxKE5hTiwgTmFOKTtcbiAgICAgKiAvLyA9PiB0cnVlXG4gICAgICovXG4gICAgZnVuY3Rpb24gZXEodmFsdWUsIG90aGVyKSB7XG4gICAgICByZXR1cm4gdmFsdWUgPT09IG90aGVyIHx8ICh2YWx1ZSAhPT0gdmFsdWUgJiYgb3RoZXIgIT09IG90aGVyKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVja3MgaWYgYHZhbHVlYCBpcyBncmVhdGVyIHRoYW4gYG90aGVyYC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAzLjkuMFxuICAgICAqIEBjYXRlZ29yeSBMYW5nXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY29tcGFyZS5cbiAgICAgKiBAcGFyYW0geyp9IG90aGVyIFRoZSBvdGhlciB2YWx1ZSB0byBjb21wYXJlLlxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBgdmFsdWVgIGlzIGdyZWF0ZXIgdGhhbiBgb3RoZXJgLFxuICAgICAqICBlbHNlIGBmYWxzZWAuXG4gICAgICogQHNlZSBfLmx0XG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8uZ3QoMywgMSk7XG4gICAgICogLy8gPT4gdHJ1ZVxuICAgICAqXG4gICAgICogXy5ndCgzLCAzKTtcbiAgICAgKiAvLyA9PiBmYWxzZVxuICAgICAqXG4gICAgICogXy5ndCgxLCAzKTtcbiAgICAgKiAvLyA9PiBmYWxzZVxuICAgICAqL1xuICAgIHZhciBndCA9IGNyZWF0ZVJlbGF0aW9uYWxPcGVyYXRpb24oYmFzZUd0KTtcblxuICAgIC8qKlxuICAgICAqIENoZWNrcyBpZiBgdmFsdWVgIGlzIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byBgb3RoZXJgLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDMuOS4wXG4gICAgICogQGNhdGVnb3J5IExhbmdcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjb21wYXJlLlxuICAgICAqIEBwYXJhbSB7Kn0gb3RoZXIgVGhlIG90aGVyIHZhbHVlIHRvIGNvbXBhcmUuXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGB2YWx1ZWAgaXMgZ3JlYXRlciB0aGFuIG9yIGVxdWFsIHRvXG4gICAgICogIGBvdGhlcmAsIGVsc2UgYGZhbHNlYC5cbiAgICAgKiBAc2VlIF8ubHRlXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8uZ3RlKDMsIDEpO1xuICAgICAqIC8vID0+IHRydWVcbiAgICAgKlxuICAgICAqIF8uZ3RlKDMsIDMpO1xuICAgICAqIC8vID0+IHRydWVcbiAgICAgKlxuICAgICAqIF8uZ3RlKDEsIDMpO1xuICAgICAqIC8vID0+IGZhbHNlXG4gICAgICovXG4gICAgdmFyIGd0ZSA9IGNyZWF0ZVJlbGF0aW9uYWxPcGVyYXRpb24oZnVuY3Rpb24odmFsdWUsIG90aGVyKSB7XG4gICAgICByZXR1cm4gdmFsdWUgPj0gb3RoZXI7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBDaGVja3MgaWYgYHZhbHVlYCBpcyBsaWtlbHkgYW4gYGFyZ3VtZW50c2Agb2JqZWN0LlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDAuMS4wXG4gICAgICogQGNhdGVnb3J5IExhbmdcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjaGVjay5cbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYHZhbHVlYCBpcyBhbiBgYXJndW1lbnRzYCBvYmplY3QsXG4gICAgICogIGVsc2UgYGZhbHNlYC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5pc0FyZ3VtZW50cyhmdW5jdGlvbigpIHsgcmV0dXJuIGFyZ3VtZW50czsgfSgpKTtcbiAgICAgKiAvLyA9PiB0cnVlXG4gICAgICpcbiAgICAgKiBfLmlzQXJndW1lbnRzKFsxLCAyLCAzXSk7XG4gICAgICogLy8gPT4gZmFsc2VcbiAgICAgKi9cbiAgICB2YXIgaXNBcmd1bWVudHMgPSBiYXNlSXNBcmd1bWVudHMoZnVuY3Rpb24oKSB7IHJldHVybiBhcmd1bWVudHM7IH0oKSkgPyBiYXNlSXNBcmd1bWVudHMgOiBmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgcmV0dXJuIGlzT2JqZWN0TGlrZSh2YWx1ZSkgJiYgaGFzT3duUHJvcGVydHkuY2FsbCh2YWx1ZSwgJ2NhbGxlZScpICYmXG4gICAgICAgICFwcm9wZXJ0eUlzRW51bWVyYWJsZS5jYWxsKHZhbHVlLCAnY2FsbGVlJyk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIENoZWNrcyBpZiBgdmFsdWVgIGlzIGNsYXNzaWZpZWQgYXMgYW4gYEFycmF5YCBvYmplY3QuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMC4xLjBcbiAgICAgKiBAY2F0ZWdvcnkgTGFuZ1xuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNoZWNrLlxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBgdmFsdWVgIGlzIGFuIGFycmF5LCBlbHNlIGBmYWxzZWAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8uaXNBcnJheShbMSwgMiwgM10pO1xuICAgICAqIC8vID0+IHRydWVcbiAgICAgKlxuICAgICAqIF8uaXNBcnJheShkb2N1bWVudC5ib2R5LmNoaWxkcmVuKTtcbiAgICAgKiAvLyA9PiBmYWxzZVxuICAgICAqXG4gICAgICogXy5pc0FycmF5KCdhYmMnKTtcbiAgICAgKiAvLyA9PiBmYWxzZVxuICAgICAqXG4gICAgICogXy5pc0FycmF5KF8ubm9vcCk7XG4gICAgICogLy8gPT4gZmFsc2VcbiAgICAgKi9cbiAgICB2YXIgaXNBcnJheSA9IEFycmF5LmlzQXJyYXk7XG5cbiAgICAvKipcbiAgICAgKiBDaGVja3MgaWYgYHZhbHVlYCBpcyBjbGFzc2lmaWVkIGFzIGFuIGBBcnJheUJ1ZmZlcmAgb2JqZWN0LlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDQuMy4wXG4gICAgICogQGNhdGVnb3J5IExhbmdcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjaGVjay5cbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYHZhbHVlYCBpcyBhbiBhcnJheSBidWZmZXIsIGVsc2UgYGZhbHNlYC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5pc0FycmF5QnVmZmVyKG5ldyBBcnJheUJ1ZmZlcigyKSk7XG4gICAgICogLy8gPT4gdHJ1ZVxuICAgICAqXG4gICAgICogXy5pc0FycmF5QnVmZmVyKG5ldyBBcnJheSgyKSk7XG4gICAgICogLy8gPT4gZmFsc2VcbiAgICAgKi9cbiAgICB2YXIgaXNBcnJheUJ1ZmZlciA9IG5vZGVJc0FycmF5QnVmZmVyID8gYmFzZVVuYXJ5KG5vZGVJc0FycmF5QnVmZmVyKSA6IGJhc2VJc0FycmF5QnVmZmVyO1xuXG4gICAgLyoqXG4gICAgICogQ2hlY2tzIGlmIGB2YWx1ZWAgaXMgYXJyYXktbGlrZS4gQSB2YWx1ZSBpcyBjb25zaWRlcmVkIGFycmF5LWxpa2UgaWYgaXQnc1xuICAgICAqIG5vdCBhIGZ1bmN0aW9uIGFuZCBoYXMgYSBgdmFsdWUubGVuZ3RoYCB0aGF0J3MgYW4gaW50ZWdlciBncmVhdGVyIHRoYW4gb3JcbiAgICAgKiBlcXVhbCB0byBgMGAgYW5kIGxlc3MgdGhhbiBvciBlcXVhbCB0byBgTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVJgLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDQuMC4wXG4gICAgICogQGNhdGVnb3J5IExhbmdcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjaGVjay5cbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYHZhbHVlYCBpcyBhcnJheS1saWtlLCBlbHNlIGBmYWxzZWAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8uaXNBcnJheUxpa2UoWzEsIDIsIDNdKTtcbiAgICAgKiAvLyA9PiB0cnVlXG4gICAgICpcbiAgICAgKiBfLmlzQXJyYXlMaWtlKGRvY3VtZW50LmJvZHkuY2hpbGRyZW4pO1xuICAgICAqIC8vID0+IHRydWVcbiAgICAgKlxuICAgICAqIF8uaXNBcnJheUxpa2UoJ2FiYycpO1xuICAgICAqIC8vID0+IHRydWVcbiAgICAgKlxuICAgICAqIF8uaXNBcnJheUxpa2UoXy5ub29wKTtcbiAgICAgKiAvLyA9PiBmYWxzZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGlzQXJyYXlMaWtlKHZhbHVlKSB7XG4gICAgICByZXR1cm4gdmFsdWUgIT0gbnVsbCAmJiBpc0xlbmd0aCh2YWx1ZS5sZW5ndGgpICYmICFpc0Z1bmN0aW9uKHZhbHVlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGlzIG1ldGhvZCBpcyBsaWtlIGBfLmlzQXJyYXlMaWtlYCBleGNlcHQgdGhhdCBpdCBhbHNvIGNoZWNrcyBpZiBgdmFsdWVgXG4gICAgICogaXMgYW4gb2JqZWN0LlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDQuMC4wXG4gICAgICogQGNhdGVnb3J5IExhbmdcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjaGVjay5cbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYHZhbHVlYCBpcyBhbiBhcnJheS1saWtlIG9iamVjdCxcbiAgICAgKiAgZWxzZSBgZmFsc2VgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLmlzQXJyYXlMaWtlT2JqZWN0KFsxLCAyLCAzXSk7XG4gICAgICogLy8gPT4gdHJ1ZVxuICAgICAqXG4gICAgICogXy5pc0FycmF5TGlrZU9iamVjdChkb2N1bWVudC5ib2R5LmNoaWxkcmVuKTtcbiAgICAgKiAvLyA9PiB0cnVlXG4gICAgICpcbiAgICAgKiBfLmlzQXJyYXlMaWtlT2JqZWN0KCdhYmMnKTtcbiAgICAgKiAvLyA9PiBmYWxzZVxuICAgICAqXG4gICAgICogXy5pc0FycmF5TGlrZU9iamVjdChfLm5vb3ApO1xuICAgICAqIC8vID0+IGZhbHNlXG4gICAgICovXG4gICAgZnVuY3Rpb24gaXNBcnJheUxpa2VPYmplY3QodmFsdWUpIHtcbiAgICAgIHJldHVybiBpc09iamVjdExpa2UodmFsdWUpICYmIGlzQXJyYXlMaWtlKHZhbHVlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVja3MgaWYgYHZhbHVlYCBpcyBjbGFzc2lmaWVkIGFzIGEgYm9vbGVhbiBwcmltaXRpdmUgb3Igb2JqZWN0LlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDAuMS4wXG4gICAgICogQGNhdGVnb3J5IExhbmdcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjaGVjay5cbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYHZhbHVlYCBpcyBhIGJvb2xlYW4sIGVsc2UgYGZhbHNlYC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5pc0Jvb2xlYW4oZmFsc2UpO1xuICAgICAqIC8vID0+IHRydWVcbiAgICAgKlxuICAgICAqIF8uaXNCb29sZWFuKG51bGwpO1xuICAgICAqIC8vID0+IGZhbHNlXG4gICAgICovXG4gICAgZnVuY3Rpb24gaXNCb29sZWFuKHZhbHVlKSB7XG4gICAgICByZXR1cm4gdmFsdWUgPT09IHRydWUgfHwgdmFsdWUgPT09IGZhbHNlIHx8XG4gICAgICAgIChpc09iamVjdExpa2UodmFsdWUpICYmIGJhc2VHZXRUYWcodmFsdWUpID09IGJvb2xUYWcpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrcyBpZiBgdmFsdWVgIGlzIGEgYnVmZmVyLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDQuMy4wXG4gICAgICogQGNhdGVnb3J5IExhbmdcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjaGVjay5cbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYHZhbHVlYCBpcyBhIGJ1ZmZlciwgZWxzZSBgZmFsc2VgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLmlzQnVmZmVyKG5ldyBCdWZmZXIoMikpO1xuICAgICAqIC8vID0+IHRydWVcbiAgICAgKlxuICAgICAqIF8uaXNCdWZmZXIobmV3IFVpbnQ4QXJyYXkoMikpO1xuICAgICAqIC8vID0+IGZhbHNlXG4gICAgICovXG4gICAgdmFyIGlzQnVmZmVyID0gbmF0aXZlSXNCdWZmZXIgfHwgc3R1YkZhbHNlO1xuXG4gICAgLyoqXG4gICAgICogQ2hlY2tzIGlmIGB2YWx1ZWAgaXMgY2xhc3NpZmllZCBhcyBhIGBEYXRlYCBvYmplY3QuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMC4xLjBcbiAgICAgKiBAY2F0ZWdvcnkgTGFuZ1xuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNoZWNrLlxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBgdmFsdWVgIGlzIGEgZGF0ZSBvYmplY3QsIGVsc2UgYGZhbHNlYC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5pc0RhdGUobmV3IERhdGUpO1xuICAgICAqIC8vID0+IHRydWVcbiAgICAgKlxuICAgICAqIF8uaXNEYXRlKCdNb24gQXByaWwgMjMgMjAxMicpO1xuICAgICAqIC8vID0+IGZhbHNlXG4gICAgICovXG4gICAgdmFyIGlzRGF0ZSA9IG5vZGVJc0RhdGUgPyBiYXNlVW5hcnkobm9kZUlzRGF0ZSkgOiBiYXNlSXNEYXRlO1xuXG4gICAgLyoqXG4gICAgICogQ2hlY2tzIGlmIGB2YWx1ZWAgaXMgbGlrZWx5IGEgRE9NIGVsZW1lbnQuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMC4xLjBcbiAgICAgKiBAY2F0ZWdvcnkgTGFuZ1xuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNoZWNrLlxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBgdmFsdWVgIGlzIGEgRE9NIGVsZW1lbnQsIGVsc2UgYGZhbHNlYC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5pc0VsZW1lbnQoZG9jdW1lbnQuYm9keSk7XG4gICAgICogLy8gPT4gdHJ1ZVxuICAgICAqXG4gICAgICogXy5pc0VsZW1lbnQoJzxib2R5PicpO1xuICAgICAqIC8vID0+IGZhbHNlXG4gICAgICovXG4gICAgZnVuY3Rpb24gaXNFbGVtZW50KHZhbHVlKSB7XG4gICAgICByZXR1cm4gaXNPYmplY3RMaWtlKHZhbHVlKSAmJiB2YWx1ZS5ub2RlVHlwZSA9PT0gMSAmJiAhaXNQbGFpbk9iamVjdCh2YWx1ZSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2tzIGlmIGB2YWx1ZWAgaXMgYW4gZW1wdHkgb2JqZWN0LCBjb2xsZWN0aW9uLCBtYXAsIG9yIHNldC5cbiAgICAgKlxuICAgICAqIE9iamVjdHMgYXJlIGNvbnNpZGVyZWQgZW1wdHkgaWYgdGhleSBoYXZlIG5vIG93biBlbnVtZXJhYmxlIHN0cmluZyBrZXllZFxuICAgICAqIHByb3BlcnRpZXMuXG4gICAgICpcbiAgICAgKiBBcnJheS1saWtlIHZhbHVlcyBzdWNoIGFzIGBhcmd1bWVudHNgIG9iamVjdHMsIGFycmF5cywgYnVmZmVycywgc3RyaW5ncywgb3JcbiAgICAgKiBqUXVlcnktbGlrZSBjb2xsZWN0aW9ucyBhcmUgY29uc2lkZXJlZCBlbXB0eSBpZiB0aGV5IGhhdmUgYSBgbGVuZ3RoYCBvZiBgMGAuXG4gICAgICogU2ltaWxhcmx5LCBtYXBzIGFuZCBzZXRzIGFyZSBjb25zaWRlcmVkIGVtcHR5IGlmIHRoZXkgaGF2ZSBhIGBzaXplYCBvZiBgMGAuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMC4xLjBcbiAgICAgKiBAY2F0ZWdvcnkgTGFuZ1xuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNoZWNrLlxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBgdmFsdWVgIGlzIGVtcHR5LCBlbHNlIGBmYWxzZWAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8uaXNFbXB0eShudWxsKTtcbiAgICAgKiAvLyA9PiB0cnVlXG4gICAgICpcbiAgICAgKiBfLmlzRW1wdHkodHJ1ZSk7XG4gICAgICogLy8gPT4gdHJ1ZVxuICAgICAqXG4gICAgICogXy5pc0VtcHR5KDEpO1xuICAgICAqIC8vID0+IHRydWVcbiAgICAgKlxuICAgICAqIF8uaXNFbXB0eShbMSwgMiwgM10pO1xuICAgICAqIC8vID0+IGZhbHNlXG4gICAgICpcbiAgICAgKiBfLmlzRW1wdHkoeyAnYSc6IDEgfSk7XG4gICAgICogLy8gPT4gZmFsc2VcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBpc0VtcHR5KHZhbHVlKSB7XG4gICAgICBpZiAodmFsdWUgPT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIGlmIChpc0FycmF5TGlrZSh2YWx1ZSkgJiZcbiAgICAgICAgICAoaXNBcnJheSh2YWx1ZSkgfHwgdHlwZW9mIHZhbHVlID09ICdzdHJpbmcnIHx8IHR5cGVvZiB2YWx1ZS5zcGxpY2UgPT0gJ2Z1bmN0aW9uJyB8fFxuICAgICAgICAgICAgaXNCdWZmZXIodmFsdWUpIHx8IGlzVHlwZWRBcnJheSh2YWx1ZSkgfHwgaXNBcmd1bWVudHModmFsdWUpKSkge1xuICAgICAgICByZXR1cm4gIXZhbHVlLmxlbmd0aDtcbiAgICAgIH1cbiAgICAgIHZhciB0YWcgPSBnZXRUYWcodmFsdWUpO1xuICAgICAgaWYgKHRhZyA9PSBtYXBUYWcgfHwgdGFnID09IHNldFRhZykge1xuICAgICAgICByZXR1cm4gIXZhbHVlLnNpemU7XG4gICAgICB9XG4gICAgICBpZiAoaXNQcm90b3R5cGUodmFsdWUpKSB7XG4gICAgICAgIHJldHVybiAhYmFzZUtleXModmFsdWUpLmxlbmd0aDtcbiAgICAgIH1cbiAgICAgIGZvciAodmFyIGtleSBpbiB2YWx1ZSkge1xuICAgICAgICBpZiAoaGFzT3duUHJvcGVydHkuY2FsbCh2YWx1ZSwga2V5KSkge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUGVyZm9ybXMgYSBkZWVwIGNvbXBhcmlzb24gYmV0d2VlbiB0d28gdmFsdWVzIHRvIGRldGVybWluZSBpZiB0aGV5IGFyZVxuICAgICAqIGVxdWl2YWxlbnQuXG4gICAgICpcbiAgICAgKiAqKk5vdGU6KiogVGhpcyBtZXRob2Qgc3VwcG9ydHMgY29tcGFyaW5nIGFycmF5cywgYXJyYXkgYnVmZmVycywgYm9vbGVhbnMsXG4gICAgICogZGF0ZSBvYmplY3RzLCBlcnJvciBvYmplY3RzLCBtYXBzLCBudW1iZXJzLCBgT2JqZWN0YCBvYmplY3RzLCByZWdleGVzLFxuICAgICAqIHNldHMsIHN0cmluZ3MsIHN5bWJvbHMsIGFuZCB0eXBlZCBhcnJheXMuIGBPYmplY3RgIG9iamVjdHMgYXJlIGNvbXBhcmVkXG4gICAgICogYnkgdGhlaXIgb3duLCBub3QgaW5oZXJpdGVkLCBlbnVtZXJhYmxlIHByb3BlcnRpZXMuIEZ1bmN0aW9ucyBhbmQgRE9NXG4gICAgICogbm9kZXMgYXJlIGNvbXBhcmVkIGJ5IHN0cmljdCBlcXVhbGl0eSwgaS5lLiBgPT09YC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAwLjEuMFxuICAgICAqIEBjYXRlZ29yeSBMYW5nXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY29tcGFyZS5cbiAgICAgKiBAcGFyYW0geyp9IG90aGVyIFRoZSBvdGhlciB2YWx1ZSB0byBjb21wYXJlLlxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgdmFsdWVzIGFyZSBlcXVpdmFsZW50LCBlbHNlIGBmYWxzZWAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciBvYmplY3QgPSB7ICdhJzogMSB9O1xuICAgICAqIHZhciBvdGhlciA9IHsgJ2EnOiAxIH07XG4gICAgICpcbiAgICAgKiBfLmlzRXF1YWwob2JqZWN0LCBvdGhlcik7XG4gICAgICogLy8gPT4gdHJ1ZVxuICAgICAqXG4gICAgICogb2JqZWN0ID09PSBvdGhlcjtcbiAgICAgKiAvLyA9PiBmYWxzZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGlzRXF1YWwodmFsdWUsIG90aGVyKSB7XG4gICAgICByZXR1cm4gYmFzZUlzRXF1YWwodmFsdWUsIG90aGVyKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGlzIG1ldGhvZCBpcyBsaWtlIGBfLmlzRXF1YWxgIGV4Y2VwdCB0aGF0IGl0IGFjY2VwdHMgYGN1c3RvbWl6ZXJgIHdoaWNoXG4gICAgICogaXMgaW52b2tlZCB0byBjb21wYXJlIHZhbHVlcy4gSWYgYGN1c3RvbWl6ZXJgIHJldHVybnMgYHVuZGVmaW5lZGAsIGNvbXBhcmlzb25zXG4gICAgICogYXJlIGhhbmRsZWQgYnkgdGhlIG1ldGhvZCBpbnN0ZWFkLiBUaGUgYGN1c3RvbWl6ZXJgIGlzIGludm9rZWQgd2l0aCB1cCB0b1xuICAgICAqIHNpeCBhcmd1bWVudHM6IChvYmpWYWx1ZSwgb3RoVmFsdWUgWywgaW5kZXh8a2V5LCBvYmplY3QsIG90aGVyLCBzdGFja10pLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDQuMC4wXG4gICAgICogQGNhdGVnb3J5IExhbmdcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjb21wYXJlLlxuICAgICAqIEBwYXJhbSB7Kn0gb3RoZXIgVGhlIG90aGVyIHZhbHVlIHRvIGNvbXBhcmUuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gW2N1c3RvbWl6ZXJdIFRoZSBmdW5jdGlvbiB0byBjdXN0b21pemUgY29tcGFyaXNvbnMuXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIHRoZSB2YWx1ZXMgYXJlIGVxdWl2YWxlbnQsIGVsc2UgYGZhbHNlYC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogZnVuY3Rpb24gaXNHcmVldGluZyh2YWx1ZSkge1xuICAgICAqICAgcmV0dXJuIC9eaCg/Oml8ZWxsbykkLy50ZXN0KHZhbHVlKTtcbiAgICAgKiB9XG4gICAgICpcbiAgICAgKiBmdW5jdGlvbiBjdXN0b21pemVyKG9ialZhbHVlLCBvdGhWYWx1ZSkge1xuICAgICAqICAgaWYgKGlzR3JlZXRpbmcob2JqVmFsdWUpICYmIGlzR3JlZXRpbmcob3RoVmFsdWUpKSB7XG4gICAgICogICAgIHJldHVybiB0cnVlO1xuICAgICAqICAgfVxuICAgICAqIH1cbiAgICAgKlxuICAgICAqIHZhciBhcnJheSA9IFsnaGVsbG8nLCAnZ29vZGJ5ZSddO1xuICAgICAqIHZhciBvdGhlciA9IFsnaGknLCAnZ29vZGJ5ZSddO1xuICAgICAqXG4gICAgICogXy5pc0VxdWFsV2l0aChhcnJheSwgb3RoZXIsIGN1c3RvbWl6ZXIpO1xuICAgICAqIC8vID0+IHRydWVcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBpc0VxdWFsV2l0aCh2YWx1ZSwgb3RoZXIsIGN1c3RvbWl6ZXIpIHtcbiAgICAgIGN1c3RvbWl6ZXIgPSB0eXBlb2YgY3VzdG9taXplciA9PSAnZnVuY3Rpb24nID8gY3VzdG9taXplciA6IHVuZGVmaW5lZDtcbiAgICAgIHZhciByZXN1bHQgPSBjdXN0b21pemVyID8gY3VzdG9taXplcih2YWx1ZSwgb3RoZXIpIDogdW5kZWZpbmVkO1xuICAgICAgcmV0dXJuIHJlc3VsdCA9PT0gdW5kZWZpbmVkID8gYmFzZUlzRXF1YWwodmFsdWUsIG90aGVyLCB1bmRlZmluZWQsIGN1c3RvbWl6ZXIpIDogISFyZXN1bHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2tzIGlmIGB2YWx1ZWAgaXMgYW4gYEVycm9yYCwgYEV2YWxFcnJvcmAsIGBSYW5nZUVycm9yYCwgYFJlZmVyZW5jZUVycm9yYCxcbiAgICAgKiBgU3ludGF4RXJyb3JgLCBgVHlwZUVycm9yYCwgb3IgYFVSSUVycm9yYCBvYmplY3QuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMy4wLjBcbiAgICAgKiBAY2F0ZWdvcnkgTGFuZ1xuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNoZWNrLlxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBgdmFsdWVgIGlzIGFuIGVycm9yIG9iamVjdCwgZWxzZSBgZmFsc2VgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLmlzRXJyb3IobmV3IEVycm9yKTtcbiAgICAgKiAvLyA9PiB0cnVlXG4gICAgICpcbiAgICAgKiBfLmlzRXJyb3IoRXJyb3IpO1xuICAgICAqIC8vID0+IGZhbHNlXG4gICAgICovXG4gICAgZnVuY3Rpb24gaXNFcnJvcih2YWx1ZSkge1xuICAgICAgaWYgKCFpc09iamVjdExpa2UodmFsdWUpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIHZhciB0YWcgPSBiYXNlR2V0VGFnKHZhbHVlKTtcbiAgICAgIHJldHVybiB0YWcgPT0gZXJyb3JUYWcgfHwgdGFnID09IGRvbUV4Y1RhZyB8fFxuICAgICAgICAodHlwZW9mIHZhbHVlLm1lc3NhZ2UgPT0gJ3N0cmluZycgJiYgdHlwZW9mIHZhbHVlLm5hbWUgPT0gJ3N0cmluZycgJiYgIWlzUGxhaW5PYmplY3QodmFsdWUpKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVja3MgaWYgYHZhbHVlYCBpcyBhIGZpbml0ZSBwcmltaXRpdmUgbnVtYmVyLlxuICAgICAqXG4gICAgICogKipOb3RlOioqIFRoaXMgbWV0aG9kIGlzIGJhc2VkIG9uXG4gICAgICogW2BOdW1iZXIuaXNGaW5pdGVgXShodHRwczovL21kbi5pby9OdW1iZXIvaXNGaW5pdGUpLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDAuMS4wXG4gICAgICogQGNhdGVnb3J5IExhbmdcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjaGVjay5cbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYHZhbHVlYCBpcyBhIGZpbml0ZSBudW1iZXIsIGVsc2UgYGZhbHNlYC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5pc0Zpbml0ZSgzKTtcbiAgICAgKiAvLyA9PiB0cnVlXG4gICAgICpcbiAgICAgKiBfLmlzRmluaXRlKE51bWJlci5NSU5fVkFMVUUpO1xuICAgICAqIC8vID0+IHRydWVcbiAgICAgKlxuICAgICAqIF8uaXNGaW5pdGUoSW5maW5pdHkpO1xuICAgICAqIC8vID0+IGZhbHNlXG4gICAgICpcbiAgICAgKiBfLmlzRmluaXRlKCczJyk7XG4gICAgICogLy8gPT4gZmFsc2VcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBpc0Zpbml0ZSh2YWx1ZSkge1xuICAgICAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PSAnbnVtYmVyJyAmJiBuYXRpdmVJc0Zpbml0ZSh2YWx1ZSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2tzIGlmIGB2YWx1ZWAgaXMgY2xhc3NpZmllZCBhcyBhIGBGdW5jdGlvbmAgb2JqZWN0LlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDAuMS4wXG4gICAgICogQGNhdGVnb3J5IExhbmdcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjaGVjay5cbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYHZhbHVlYCBpcyBhIGZ1bmN0aW9uLCBlbHNlIGBmYWxzZWAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8uaXNGdW5jdGlvbihfKTtcbiAgICAgKiAvLyA9PiB0cnVlXG4gICAgICpcbiAgICAgKiBfLmlzRnVuY3Rpb24oL2FiYy8pO1xuICAgICAqIC8vID0+IGZhbHNlXG4gICAgICovXG4gICAgZnVuY3Rpb24gaXNGdW5jdGlvbih2YWx1ZSkge1xuICAgICAgaWYgKCFpc09iamVjdCh2YWx1ZSkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgLy8gVGhlIHVzZSBvZiBgT2JqZWN0I3RvU3RyaW5nYCBhdm9pZHMgaXNzdWVzIHdpdGggdGhlIGB0eXBlb2ZgIG9wZXJhdG9yXG4gICAgICAvLyBpbiBTYWZhcmkgOSB3aGljaCByZXR1cm5zICdvYmplY3QnIGZvciB0eXBlZCBhcnJheXMgYW5kIG90aGVyIGNvbnN0cnVjdG9ycy5cbiAgICAgIHZhciB0YWcgPSBiYXNlR2V0VGFnKHZhbHVlKTtcbiAgICAgIHJldHVybiB0YWcgPT0gZnVuY1RhZyB8fCB0YWcgPT0gZ2VuVGFnIHx8IHRhZyA9PSBhc3luY1RhZyB8fCB0YWcgPT0gcHJveHlUYWc7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2tzIGlmIGB2YWx1ZWAgaXMgYW4gaW50ZWdlci5cbiAgICAgKlxuICAgICAqICoqTm90ZToqKiBUaGlzIG1ldGhvZCBpcyBiYXNlZCBvblxuICAgICAqIFtgTnVtYmVyLmlzSW50ZWdlcmBdKGh0dHBzOi8vbWRuLmlvL051bWJlci9pc0ludGVnZXIpLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDQuMC4wXG4gICAgICogQGNhdGVnb3J5IExhbmdcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjaGVjay5cbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYHZhbHVlYCBpcyBhbiBpbnRlZ2VyLCBlbHNlIGBmYWxzZWAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8uaXNJbnRlZ2VyKDMpO1xuICAgICAqIC8vID0+IHRydWVcbiAgICAgKlxuICAgICAqIF8uaXNJbnRlZ2VyKE51bWJlci5NSU5fVkFMVUUpO1xuICAgICAqIC8vID0+IGZhbHNlXG4gICAgICpcbiAgICAgKiBfLmlzSW50ZWdlcihJbmZpbml0eSk7XG4gICAgICogLy8gPT4gZmFsc2VcbiAgICAgKlxuICAgICAqIF8uaXNJbnRlZ2VyKCczJyk7XG4gICAgICogLy8gPT4gZmFsc2VcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBpc0ludGVnZXIodmFsdWUpIHtcbiAgICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT0gJ251bWJlcicgJiYgdmFsdWUgPT0gdG9JbnRlZ2VyKHZhbHVlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVja3MgaWYgYHZhbHVlYCBpcyBhIHZhbGlkIGFycmF5LWxpa2UgbGVuZ3RoLlxuICAgICAqXG4gICAgICogKipOb3RlOioqIFRoaXMgbWV0aG9kIGlzIGxvb3NlbHkgYmFzZWQgb25cbiAgICAgKiBbYFRvTGVuZ3RoYF0oaHR0cDovL2VjbWEtaW50ZXJuYXRpb25hbC5vcmcvZWNtYS0yNjIvNy4wLyNzZWMtdG9sZW5ndGgpLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDQuMC4wXG4gICAgICogQGNhdGVnb3J5IExhbmdcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjaGVjay5cbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYHZhbHVlYCBpcyBhIHZhbGlkIGxlbmd0aCwgZWxzZSBgZmFsc2VgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLmlzTGVuZ3RoKDMpO1xuICAgICAqIC8vID0+IHRydWVcbiAgICAgKlxuICAgICAqIF8uaXNMZW5ndGgoTnVtYmVyLk1JTl9WQUxVRSk7XG4gICAgICogLy8gPT4gZmFsc2VcbiAgICAgKlxuICAgICAqIF8uaXNMZW5ndGgoSW5maW5pdHkpO1xuICAgICAqIC8vID0+IGZhbHNlXG4gICAgICpcbiAgICAgKiBfLmlzTGVuZ3RoKCczJyk7XG4gICAgICogLy8gPT4gZmFsc2VcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBpc0xlbmd0aCh2YWx1ZSkge1xuICAgICAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PSAnbnVtYmVyJyAmJlxuICAgICAgICB2YWx1ZSA+IC0xICYmIHZhbHVlICUgMSA9PSAwICYmIHZhbHVlIDw9IE1BWF9TQUZFX0lOVEVHRVI7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2tzIGlmIGB2YWx1ZWAgaXMgdGhlXG4gICAgICogW2xhbmd1YWdlIHR5cGVdKGh0dHA6Ly93d3cuZWNtYS1pbnRlcm5hdGlvbmFsLm9yZy9lY21hLTI2Mi83LjAvI3NlYy1lY21hc2NyaXB0LWxhbmd1YWdlLXR5cGVzKVxuICAgICAqIG9mIGBPYmplY3RgLiAoZS5nLiBhcnJheXMsIGZ1bmN0aW9ucywgb2JqZWN0cywgcmVnZXhlcywgYG5ldyBOdW1iZXIoMClgLCBhbmQgYG5ldyBTdHJpbmcoJycpYClcbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAwLjEuMFxuICAgICAqIEBjYXRlZ29yeSBMYW5nXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2hlY2suXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGB2YWx1ZWAgaXMgYW4gb2JqZWN0LCBlbHNlIGBmYWxzZWAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8uaXNPYmplY3Qoe30pO1xuICAgICAqIC8vID0+IHRydWVcbiAgICAgKlxuICAgICAqIF8uaXNPYmplY3QoWzEsIDIsIDNdKTtcbiAgICAgKiAvLyA9PiB0cnVlXG4gICAgICpcbiAgICAgKiBfLmlzT2JqZWN0KF8ubm9vcCk7XG4gICAgICogLy8gPT4gdHJ1ZVxuICAgICAqXG4gICAgICogXy5pc09iamVjdChudWxsKTtcbiAgICAgKiAvLyA9PiBmYWxzZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGlzT2JqZWN0KHZhbHVlKSB7XG4gICAgICB2YXIgdHlwZSA9IHR5cGVvZiB2YWx1ZTtcbiAgICAgIHJldHVybiB2YWx1ZSAhPSBudWxsICYmICh0eXBlID09ICdvYmplY3QnIHx8IHR5cGUgPT0gJ2Z1bmN0aW9uJyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2tzIGlmIGB2YWx1ZWAgaXMgb2JqZWN0LWxpa2UuIEEgdmFsdWUgaXMgb2JqZWN0LWxpa2UgaWYgaXQncyBub3QgYG51bGxgXG4gICAgICogYW5kIGhhcyBhIGB0eXBlb2ZgIHJlc3VsdCBvZiBcIm9iamVjdFwiLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDQuMC4wXG4gICAgICogQGNhdGVnb3J5IExhbmdcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjaGVjay5cbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYHZhbHVlYCBpcyBvYmplY3QtbGlrZSwgZWxzZSBgZmFsc2VgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLmlzT2JqZWN0TGlrZSh7fSk7XG4gICAgICogLy8gPT4gdHJ1ZVxuICAgICAqXG4gICAgICogXy5pc09iamVjdExpa2UoWzEsIDIsIDNdKTtcbiAgICAgKiAvLyA9PiB0cnVlXG4gICAgICpcbiAgICAgKiBfLmlzT2JqZWN0TGlrZShfLm5vb3ApO1xuICAgICAqIC8vID0+IGZhbHNlXG4gICAgICpcbiAgICAgKiBfLmlzT2JqZWN0TGlrZShudWxsKTtcbiAgICAgKiAvLyA9PiBmYWxzZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGlzT2JqZWN0TGlrZSh2YWx1ZSkge1xuICAgICAgcmV0dXJuIHZhbHVlICE9IG51bGwgJiYgdHlwZW9mIHZhbHVlID09ICdvYmplY3QnO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrcyBpZiBgdmFsdWVgIGlzIGNsYXNzaWZpZWQgYXMgYSBgTWFwYCBvYmplY3QuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgNC4zLjBcbiAgICAgKiBAY2F0ZWdvcnkgTGFuZ1xuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNoZWNrLlxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBgdmFsdWVgIGlzIGEgbWFwLCBlbHNlIGBmYWxzZWAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8uaXNNYXAobmV3IE1hcCk7XG4gICAgICogLy8gPT4gdHJ1ZVxuICAgICAqXG4gICAgICogXy5pc01hcChuZXcgV2Vha01hcCk7XG4gICAgICogLy8gPT4gZmFsc2VcbiAgICAgKi9cbiAgICB2YXIgaXNNYXAgPSBub2RlSXNNYXAgPyBiYXNlVW5hcnkobm9kZUlzTWFwKSA6IGJhc2VJc01hcDtcblxuICAgIC8qKlxuICAgICAqIFBlcmZvcm1zIGEgcGFydGlhbCBkZWVwIGNvbXBhcmlzb24gYmV0d2VlbiBgb2JqZWN0YCBhbmQgYHNvdXJjZWAgdG9cbiAgICAgKiBkZXRlcm1pbmUgaWYgYG9iamVjdGAgY29udGFpbnMgZXF1aXZhbGVudCBwcm9wZXJ0eSB2YWx1ZXMuXG4gICAgICpcbiAgICAgKiAqKk5vdGU6KiogVGhpcyBtZXRob2QgaXMgZXF1aXZhbGVudCB0byBgXy5tYXRjaGVzYCB3aGVuIGBzb3VyY2VgIGlzXG4gICAgICogcGFydGlhbGx5IGFwcGxpZWQuXG4gICAgICpcbiAgICAgKiBQYXJ0aWFsIGNvbXBhcmlzb25zIHdpbGwgbWF0Y2ggZW1wdHkgYXJyYXkgYW5kIGVtcHR5IG9iamVjdCBgc291cmNlYFxuICAgICAqIHZhbHVlcyBhZ2FpbnN0IGFueSBhcnJheSBvciBvYmplY3QgdmFsdWUsIHJlc3BlY3RpdmVseS4gU2VlIGBfLmlzRXF1YWxgXG4gICAgICogZm9yIGEgbGlzdCBvZiBzdXBwb3J0ZWQgdmFsdWUgY29tcGFyaXNvbnMuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMy4wLjBcbiAgICAgKiBAY2F0ZWdvcnkgTGFuZ1xuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIG9iamVjdCB0byBpbnNwZWN0LlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBzb3VyY2UgVGhlIG9iamVjdCBvZiBwcm9wZXJ0eSB2YWx1ZXMgdG8gbWF0Y2guXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGBvYmplY3RgIGlzIGEgbWF0Y2gsIGVsc2UgYGZhbHNlYC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogdmFyIG9iamVjdCA9IHsgJ2EnOiAxLCAnYic6IDIgfTtcbiAgICAgKlxuICAgICAqIF8uaXNNYXRjaChvYmplY3QsIHsgJ2InOiAyIH0pO1xuICAgICAqIC8vID0+IHRydWVcbiAgICAgKlxuICAgICAqIF8uaXNNYXRjaChvYmplY3QsIHsgJ2InOiAxIH0pO1xuICAgICAqIC8vID0+IGZhbHNlXG4gICAgICovXG4gICAgZnVuY3Rpb24gaXNNYXRjaChvYmplY3QsIHNvdXJjZSkge1xuICAgICAgcmV0dXJuIG9iamVjdCA9PT0gc291cmNlIHx8IGJhc2VJc01hdGNoKG9iamVjdCwgc291cmNlLCBnZXRNYXRjaERhdGEoc291cmNlKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhpcyBtZXRob2QgaXMgbGlrZSBgXy5pc01hdGNoYCBleGNlcHQgdGhhdCBpdCBhY2NlcHRzIGBjdXN0b21pemVyYCB3aGljaFxuICAgICAqIGlzIGludm9rZWQgdG8gY29tcGFyZSB2YWx1ZXMuIElmIGBjdXN0b21pemVyYCByZXR1cm5zIGB1bmRlZmluZWRgLCBjb21wYXJpc29uc1xuICAgICAqIGFyZSBoYW5kbGVkIGJ5IHRoZSBtZXRob2QgaW5zdGVhZC4gVGhlIGBjdXN0b21pemVyYCBpcyBpbnZva2VkIHdpdGggZml2ZVxuICAgICAqIGFyZ3VtZW50czogKG9ialZhbHVlLCBzcmNWYWx1ZSwgaW5kZXh8a2V5LCBvYmplY3QsIHNvdXJjZSkuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgNC4wLjBcbiAgICAgKiBAY2F0ZWdvcnkgTGFuZ1xuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIG9iamVjdCB0byBpbnNwZWN0LlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBzb3VyY2UgVGhlIG9iamVjdCBvZiBwcm9wZXJ0eSB2YWx1ZXMgdG8gbWF0Y2guXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gW2N1c3RvbWl6ZXJdIFRoZSBmdW5jdGlvbiB0byBjdXN0b21pemUgY29tcGFyaXNvbnMuXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGBvYmplY3RgIGlzIGEgbWF0Y2gsIGVsc2UgYGZhbHNlYC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogZnVuY3Rpb24gaXNHcmVldGluZyh2YWx1ZSkge1xuICAgICAqICAgcmV0dXJuIC9eaCg/Oml8ZWxsbykkLy50ZXN0KHZhbHVlKTtcbiAgICAgKiB9XG4gICAgICpcbiAgICAgKiBmdW5jdGlvbiBjdXN0b21pemVyKG9ialZhbHVlLCBzcmNWYWx1ZSkge1xuICAgICAqICAgaWYgKGlzR3JlZXRpbmcob2JqVmFsdWUpICYmIGlzR3JlZXRpbmcoc3JjVmFsdWUpKSB7XG4gICAgICogICAgIHJldHVybiB0cnVlO1xuICAgICAqICAgfVxuICAgICAqIH1cbiAgICAgKlxuICAgICAqIHZhciBvYmplY3QgPSB7ICdncmVldGluZyc6ICdoZWxsbycgfTtcbiAgICAgKiB2YXIgc291cmNlID0geyAnZ3JlZXRpbmcnOiAnaGknIH07XG4gICAgICpcbiAgICAgKiBfLmlzTWF0Y2hXaXRoKG9iamVjdCwgc291cmNlLCBjdXN0b21pemVyKTtcbiAgICAgKiAvLyA9PiB0cnVlXG4gICAgICovXG4gICAgZnVuY3Rpb24gaXNNYXRjaFdpdGgob2JqZWN0LCBzb3VyY2UsIGN1c3RvbWl6ZXIpIHtcbiAgICAgIGN1c3RvbWl6ZXIgPSB0eXBlb2YgY3VzdG9taXplciA9PSAnZnVuY3Rpb24nID8gY3VzdG9taXplciA6IHVuZGVmaW5lZDtcbiAgICAgIHJldHVybiBiYXNlSXNNYXRjaChvYmplY3QsIHNvdXJjZSwgZ2V0TWF0Y2hEYXRhKHNvdXJjZSksIGN1c3RvbWl6ZXIpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrcyBpZiBgdmFsdWVgIGlzIGBOYU5gLlxuICAgICAqXG4gICAgICogKipOb3RlOioqIFRoaXMgbWV0aG9kIGlzIGJhc2VkIG9uXG4gICAgICogW2BOdW1iZXIuaXNOYU5gXShodHRwczovL21kbi5pby9OdW1iZXIvaXNOYU4pIGFuZCBpcyBub3QgdGhlIHNhbWUgYXNcbiAgICAgKiBnbG9iYWwgW2Bpc05hTmBdKGh0dHBzOi8vbWRuLmlvL2lzTmFOKSB3aGljaCByZXR1cm5zIGB0cnVlYCBmb3JcbiAgICAgKiBgdW5kZWZpbmVkYCBhbmQgb3RoZXIgbm9uLW51bWJlciB2YWx1ZXMuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMC4xLjBcbiAgICAgKiBAY2F0ZWdvcnkgTGFuZ1xuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNoZWNrLlxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBgdmFsdWVgIGlzIGBOYU5gLCBlbHNlIGBmYWxzZWAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8uaXNOYU4oTmFOKTtcbiAgICAgKiAvLyA9PiB0cnVlXG4gICAgICpcbiAgICAgKiBfLmlzTmFOKG5ldyBOdW1iZXIoTmFOKSk7XG4gICAgICogLy8gPT4gdHJ1ZVxuICAgICAqXG4gICAgICogaXNOYU4odW5kZWZpbmVkKTtcbiAgICAgKiAvLyA9PiB0cnVlXG4gICAgICpcbiAgICAgKiBfLmlzTmFOKHVuZGVmaW5lZCk7XG4gICAgICogLy8gPT4gZmFsc2VcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBpc05hTih2YWx1ZSkge1xuICAgICAgLy8gQW4gYE5hTmAgcHJpbWl0aXZlIGlzIHRoZSBvbmx5IHZhbHVlIHRoYXQgaXMgbm90IGVxdWFsIHRvIGl0c2VsZi5cbiAgICAgIC8vIFBlcmZvcm0gdGhlIGB0b1N0cmluZ1RhZ2AgY2hlY2sgZmlyc3QgdG8gYXZvaWQgZXJyb3JzIHdpdGggc29tZVxuICAgICAgLy8gQWN0aXZlWCBvYmplY3RzIGluIElFLlxuICAgICAgcmV0dXJuIGlzTnVtYmVyKHZhbHVlKSAmJiB2YWx1ZSAhPSArdmFsdWU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2tzIGlmIGB2YWx1ZWAgaXMgYSBwcmlzdGluZSBuYXRpdmUgZnVuY3Rpb24uXG4gICAgICpcbiAgICAgKiAqKk5vdGU6KiogVGhpcyBtZXRob2QgY2FuJ3QgcmVsaWFibHkgZGV0ZWN0IG5hdGl2ZSBmdW5jdGlvbnMgaW4gdGhlIHByZXNlbmNlXG4gICAgICogb2YgdGhlIGNvcmUtanMgcGFja2FnZSBiZWNhdXNlIGNvcmUtanMgY2lyY3VtdmVudHMgdGhpcyBraW5kIG9mIGRldGVjdGlvbi5cbiAgICAgKiBEZXNwaXRlIG11bHRpcGxlIHJlcXVlc3RzLCB0aGUgY29yZS1qcyBtYWludGFpbmVyIGhhcyBtYWRlIGl0IGNsZWFyOiBhbnlcbiAgICAgKiBhdHRlbXB0IHRvIGZpeCB0aGUgZGV0ZWN0aW9uIHdpbGwgYmUgb2JzdHJ1Y3RlZC4gQXMgYSByZXN1bHQsIHdlJ3JlIGxlZnRcbiAgICAgKiB3aXRoIGxpdHRsZSBjaG9pY2UgYnV0IHRvIHRocm93IGFuIGVycm9yLiBVbmZvcnR1bmF0ZWx5LCB0aGlzIGFsc28gYWZmZWN0c1xuICAgICAqIHBhY2thZ2VzLCBsaWtlIFtiYWJlbC1wb2x5ZmlsbF0oaHR0cHM6Ly93d3cubnBtanMuY29tL3BhY2thZ2UvYmFiZWwtcG9seWZpbGwpLFxuICAgICAqIHdoaWNoIHJlbHkgb24gY29yZS1qcy5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAzLjAuMFxuICAgICAqIEBjYXRlZ29yeSBMYW5nXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2hlY2suXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGB2YWx1ZWAgaXMgYSBuYXRpdmUgZnVuY3Rpb24sXG4gICAgICogIGVsc2UgYGZhbHNlYC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5pc05hdGl2ZShBcnJheS5wcm90b3R5cGUucHVzaCk7XG4gICAgICogLy8gPT4gdHJ1ZVxuICAgICAqXG4gICAgICogXy5pc05hdGl2ZShfKTtcbiAgICAgKiAvLyA9PiBmYWxzZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGlzTmF0aXZlKHZhbHVlKSB7XG4gICAgICBpZiAoaXNNYXNrYWJsZSh2YWx1ZSkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKENPUkVfRVJST1JfVEVYVCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gYmFzZUlzTmF0aXZlKHZhbHVlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVja3MgaWYgYHZhbHVlYCBpcyBgbnVsbGAuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMC4xLjBcbiAgICAgKiBAY2F0ZWdvcnkgTGFuZ1xuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNoZWNrLlxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBgdmFsdWVgIGlzIGBudWxsYCwgZWxzZSBgZmFsc2VgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLmlzTnVsbChudWxsKTtcbiAgICAgKiAvLyA9PiB0cnVlXG4gICAgICpcbiAgICAgKiBfLmlzTnVsbCh2b2lkIDApO1xuICAgICAqIC8vID0+IGZhbHNlXG4gICAgICovXG4gICAgZnVuY3Rpb24gaXNOdWxsKHZhbHVlKSB7XG4gICAgICByZXR1cm4gdmFsdWUgPT09IG51bGw7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2tzIGlmIGB2YWx1ZWAgaXMgYG51bGxgIG9yIGB1bmRlZmluZWRgLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDQuMC4wXG4gICAgICogQGNhdGVnb3J5IExhbmdcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjaGVjay5cbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYHZhbHVlYCBpcyBudWxsaXNoLCBlbHNlIGBmYWxzZWAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8uaXNOaWwobnVsbCk7XG4gICAgICogLy8gPT4gdHJ1ZVxuICAgICAqXG4gICAgICogXy5pc05pbCh2b2lkIDApO1xuICAgICAqIC8vID0+IHRydWVcbiAgICAgKlxuICAgICAqIF8uaXNOaWwoTmFOKTtcbiAgICAgKiAvLyA9PiBmYWxzZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGlzTmlsKHZhbHVlKSB7XG4gICAgICByZXR1cm4gdmFsdWUgPT0gbnVsbDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVja3MgaWYgYHZhbHVlYCBpcyBjbGFzc2lmaWVkIGFzIGEgYE51bWJlcmAgcHJpbWl0aXZlIG9yIG9iamVjdC5cbiAgICAgKlxuICAgICAqICoqTm90ZToqKiBUbyBleGNsdWRlIGBJbmZpbml0eWAsIGAtSW5maW5pdHlgLCBhbmQgYE5hTmAsIHdoaWNoIGFyZVxuICAgICAqIGNsYXNzaWZpZWQgYXMgbnVtYmVycywgdXNlIHRoZSBgXy5pc0Zpbml0ZWAgbWV0aG9kLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDAuMS4wXG4gICAgICogQGNhdGVnb3J5IExhbmdcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjaGVjay5cbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYHZhbHVlYCBpcyBhIG51bWJlciwgZWxzZSBgZmFsc2VgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLmlzTnVtYmVyKDMpO1xuICAgICAqIC8vID0+IHRydWVcbiAgICAgKlxuICAgICAqIF8uaXNOdW1iZXIoTnVtYmVyLk1JTl9WQUxVRSk7XG4gICAgICogLy8gPT4gdHJ1ZVxuICAgICAqXG4gICAgICogXy5pc051bWJlcihJbmZpbml0eSk7XG4gICAgICogLy8gPT4gdHJ1ZVxuICAgICAqXG4gICAgICogXy5pc051bWJlcignMycpO1xuICAgICAqIC8vID0+IGZhbHNlXG4gICAgICovXG4gICAgZnVuY3Rpb24gaXNOdW1iZXIodmFsdWUpIHtcbiAgICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT0gJ251bWJlcicgfHxcbiAgICAgICAgKGlzT2JqZWN0TGlrZSh2YWx1ZSkgJiYgYmFzZUdldFRhZyh2YWx1ZSkgPT0gbnVtYmVyVGFnKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVja3MgaWYgYHZhbHVlYCBpcyBhIHBsYWluIG9iamVjdCwgdGhhdCBpcywgYW4gb2JqZWN0IGNyZWF0ZWQgYnkgdGhlXG4gICAgICogYE9iamVjdGAgY29uc3RydWN0b3Igb3Igb25lIHdpdGggYSBgW1tQcm90b3R5cGVdXWAgb2YgYG51bGxgLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDAuOC4wXG4gICAgICogQGNhdGVnb3J5IExhbmdcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjaGVjay5cbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYHZhbHVlYCBpcyBhIHBsYWluIG9iamVjdCwgZWxzZSBgZmFsc2VgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBmdW5jdGlvbiBGb28oKSB7XG4gICAgICogICB0aGlzLmEgPSAxO1xuICAgICAqIH1cbiAgICAgKlxuICAgICAqIF8uaXNQbGFpbk9iamVjdChuZXcgRm9vKTtcbiAgICAgKiAvLyA9PiBmYWxzZVxuICAgICAqXG4gICAgICogXy5pc1BsYWluT2JqZWN0KFsxLCAyLCAzXSk7XG4gICAgICogLy8gPT4gZmFsc2VcbiAgICAgKlxuICAgICAqIF8uaXNQbGFpbk9iamVjdCh7ICd4JzogMCwgJ3knOiAwIH0pO1xuICAgICAqIC8vID0+IHRydWVcbiAgICAgKlxuICAgICAqIF8uaXNQbGFpbk9iamVjdChPYmplY3QuY3JlYXRlKG51bGwpKTtcbiAgICAgKiAvLyA9PiB0cnVlXG4gICAgICovXG4gICAgZnVuY3Rpb24gaXNQbGFpbk9iamVjdCh2YWx1ZSkge1xuICAgICAgaWYgKCFpc09iamVjdExpa2UodmFsdWUpIHx8IGJhc2VHZXRUYWcodmFsdWUpICE9IG9iamVjdFRhZykge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICB2YXIgcHJvdG8gPSBnZXRQcm90b3R5cGUodmFsdWUpO1xuICAgICAgaWYgKHByb3RvID09PSBudWxsKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuICAgICAgdmFyIEN0b3IgPSBoYXNPd25Qcm9wZXJ0eS5jYWxsKHByb3RvLCAnY29uc3RydWN0b3InKSAmJiBwcm90by5jb25zdHJ1Y3RvcjtcbiAgICAgIHJldHVybiB0eXBlb2YgQ3RvciA9PSAnZnVuY3Rpb24nICYmIEN0b3IgaW5zdGFuY2VvZiBDdG9yICYmXG4gICAgICAgIGZ1bmNUb1N0cmluZy5jYWxsKEN0b3IpID09IG9iamVjdEN0b3JTdHJpbmc7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2tzIGlmIGB2YWx1ZWAgaXMgY2xhc3NpZmllZCBhcyBhIGBSZWdFeHBgIG9iamVjdC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAwLjEuMFxuICAgICAqIEBjYXRlZ29yeSBMYW5nXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2hlY2suXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGB2YWx1ZWAgaXMgYSByZWdleHAsIGVsc2UgYGZhbHNlYC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5pc1JlZ0V4cCgvYWJjLyk7XG4gICAgICogLy8gPT4gdHJ1ZVxuICAgICAqXG4gICAgICogXy5pc1JlZ0V4cCgnL2FiYy8nKTtcbiAgICAgKiAvLyA9PiBmYWxzZVxuICAgICAqL1xuICAgIHZhciBpc1JlZ0V4cCA9IG5vZGVJc1JlZ0V4cCA/IGJhc2VVbmFyeShub2RlSXNSZWdFeHApIDogYmFzZUlzUmVnRXhwO1xuXG4gICAgLyoqXG4gICAgICogQ2hlY2tzIGlmIGB2YWx1ZWAgaXMgYSBzYWZlIGludGVnZXIuIEFuIGludGVnZXIgaXMgc2FmZSBpZiBpdCdzIGFuIElFRUUtNzU0XG4gICAgICogZG91YmxlIHByZWNpc2lvbiBudW1iZXIgd2hpY2ggaXNuJ3QgdGhlIHJlc3VsdCBvZiBhIHJvdW5kZWQgdW5zYWZlIGludGVnZXIuXG4gICAgICpcbiAgICAgKiAqKk5vdGU6KiogVGhpcyBtZXRob2QgaXMgYmFzZWQgb25cbiAgICAgKiBbYE51bWJlci5pc1NhZmVJbnRlZ2VyYF0oaHR0cHM6Ly9tZG4uaW8vTnVtYmVyL2lzU2FmZUludGVnZXIpLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDQuMC4wXG4gICAgICogQGNhdGVnb3J5IExhbmdcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjaGVjay5cbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYHZhbHVlYCBpcyBhIHNhZmUgaW50ZWdlciwgZWxzZSBgZmFsc2VgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLmlzU2FmZUludGVnZXIoMyk7XG4gICAgICogLy8gPT4gdHJ1ZVxuICAgICAqXG4gICAgICogXy5pc1NhZmVJbnRlZ2VyKE51bWJlci5NSU5fVkFMVUUpO1xuICAgICAqIC8vID0+IGZhbHNlXG4gICAgICpcbiAgICAgKiBfLmlzU2FmZUludGVnZXIoSW5maW5pdHkpO1xuICAgICAqIC8vID0+IGZhbHNlXG4gICAgICpcbiAgICAgKiBfLmlzU2FmZUludGVnZXIoJzMnKTtcbiAgICAgKiAvLyA9PiBmYWxzZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGlzU2FmZUludGVnZXIodmFsdWUpIHtcbiAgICAgIHJldHVybiBpc0ludGVnZXIodmFsdWUpICYmIHZhbHVlID49IC1NQVhfU0FGRV9JTlRFR0VSICYmIHZhbHVlIDw9IE1BWF9TQUZFX0lOVEVHRVI7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2tzIGlmIGB2YWx1ZWAgaXMgY2xhc3NpZmllZCBhcyBhIGBTZXRgIG9iamVjdC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSA0LjMuMFxuICAgICAqIEBjYXRlZ29yeSBMYW5nXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2hlY2suXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGB2YWx1ZWAgaXMgYSBzZXQsIGVsc2UgYGZhbHNlYC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5pc1NldChuZXcgU2V0KTtcbiAgICAgKiAvLyA9PiB0cnVlXG4gICAgICpcbiAgICAgKiBfLmlzU2V0KG5ldyBXZWFrU2V0KTtcbiAgICAgKiAvLyA9PiBmYWxzZVxuICAgICAqL1xuICAgIHZhciBpc1NldCA9IG5vZGVJc1NldCA/IGJhc2VVbmFyeShub2RlSXNTZXQpIDogYmFzZUlzU2V0O1xuXG4gICAgLyoqXG4gICAgICogQ2hlY2tzIGlmIGB2YWx1ZWAgaXMgY2xhc3NpZmllZCBhcyBhIGBTdHJpbmdgIHByaW1pdGl2ZSBvciBvYmplY3QuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQHNpbmNlIDAuMS4wXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAY2F0ZWdvcnkgTGFuZ1xuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNoZWNrLlxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBgdmFsdWVgIGlzIGEgc3RyaW5nLCBlbHNlIGBmYWxzZWAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8uaXNTdHJpbmcoJ2FiYycpO1xuICAgICAqIC8vID0+IHRydWVcbiAgICAgKlxuICAgICAqIF8uaXNTdHJpbmcoMSk7XG4gICAgICogLy8gPT4gZmFsc2VcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBpc1N0cmluZyh2YWx1ZSkge1xuICAgICAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PSAnc3RyaW5nJyB8fFxuICAgICAgICAoIWlzQXJyYXkodmFsdWUpICYmIGlzT2JqZWN0TGlrZSh2YWx1ZSkgJiYgYmFzZUdldFRhZyh2YWx1ZSkgPT0gc3RyaW5nVGFnKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVja3MgaWYgYHZhbHVlYCBpcyBjbGFzc2lmaWVkIGFzIGEgYFN5bWJvbGAgcHJpbWl0aXZlIG9yIG9iamVjdC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSA0LjAuMFxuICAgICAqIEBjYXRlZ29yeSBMYW5nXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2hlY2suXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGB2YWx1ZWAgaXMgYSBzeW1ib2wsIGVsc2UgYGZhbHNlYC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5pc1N5bWJvbChTeW1ib2wuaXRlcmF0b3IpO1xuICAgICAqIC8vID0+IHRydWVcbiAgICAgKlxuICAgICAqIF8uaXNTeW1ib2woJ2FiYycpO1xuICAgICAqIC8vID0+IGZhbHNlXG4gICAgICovXG4gICAgZnVuY3Rpb24gaXNTeW1ib2wodmFsdWUpIHtcbiAgICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT0gJ3N5bWJvbCcgfHxcbiAgICAgICAgKGlzT2JqZWN0TGlrZSh2YWx1ZSkgJiYgYmFzZUdldFRhZyh2YWx1ZSkgPT0gc3ltYm9sVGFnKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVja3MgaWYgYHZhbHVlYCBpcyBjbGFzc2lmaWVkIGFzIGEgdHlwZWQgYXJyYXkuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMy4wLjBcbiAgICAgKiBAY2F0ZWdvcnkgTGFuZ1xuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNoZWNrLlxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBgdmFsdWVgIGlzIGEgdHlwZWQgYXJyYXksIGVsc2UgYGZhbHNlYC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5pc1R5cGVkQXJyYXkobmV3IFVpbnQ4QXJyYXkpO1xuICAgICAqIC8vID0+IHRydWVcbiAgICAgKlxuICAgICAqIF8uaXNUeXBlZEFycmF5KFtdKTtcbiAgICAgKiAvLyA9PiBmYWxzZVxuICAgICAqL1xuICAgIHZhciBpc1R5cGVkQXJyYXkgPSBub2RlSXNUeXBlZEFycmF5ID8gYmFzZVVuYXJ5KG5vZGVJc1R5cGVkQXJyYXkpIDogYmFzZUlzVHlwZWRBcnJheTtcblxuICAgIC8qKlxuICAgICAqIENoZWNrcyBpZiBgdmFsdWVgIGlzIGB1bmRlZmluZWRgLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBzaW5jZSAwLjEuMFxuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQGNhdGVnb3J5IExhbmdcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjaGVjay5cbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYHZhbHVlYCBpcyBgdW5kZWZpbmVkYCwgZWxzZSBgZmFsc2VgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLmlzVW5kZWZpbmVkKHZvaWQgMCk7XG4gICAgICogLy8gPT4gdHJ1ZVxuICAgICAqXG4gICAgICogXy5pc1VuZGVmaW5lZChudWxsKTtcbiAgICAgKiAvLyA9PiBmYWxzZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGlzVW5kZWZpbmVkKHZhbHVlKSB7XG4gICAgICByZXR1cm4gdmFsdWUgPT09IHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVja3MgaWYgYHZhbHVlYCBpcyBjbGFzc2lmaWVkIGFzIGEgYFdlYWtNYXBgIG9iamVjdC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSA0LjMuMFxuICAgICAqIEBjYXRlZ29yeSBMYW5nXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2hlY2suXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGB2YWx1ZWAgaXMgYSB3ZWFrIG1hcCwgZWxzZSBgZmFsc2VgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLmlzV2Vha01hcChuZXcgV2Vha01hcCk7XG4gICAgICogLy8gPT4gdHJ1ZVxuICAgICAqXG4gICAgICogXy5pc1dlYWtNYXAobmV3IE1hcCk7XG4gICAgICogLy8gPT4gZmFsc2VcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBpc1dlYWtNYXAodmFsdWUpIHtcbiAgICAgIHJldHVybiBpc09iamVjdExpa2UodmFsdWUpICYmIGdldFRhZyh2YWx1ZSkgPT0gd2Vha01hcFRhZztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVja3MgaWYgYHZhbHVlYCBpcyBjbGFzc2lmaWVkIGFzIGEgYFdlYWtTZXRgIG9iamVjdC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSA0LjMuMFxuICAgICAqIEBjYXRlZ29yeSBMYW5nXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2hlY2suXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGB2YWx1ZWAgaXMgYSB3ZWFrIHNldCwgZWxzZSBgZmFsc2VgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLmlzV2Vha1NldChuZXcgV2Vha1NldCk7XG4gICAgICogLy8gPT4gdHJ1ZVxuICAgICAqXG4gICAgICogXy5pc1dlYWtTZXQobmV3IFNldCk7XG4gICAgICogLy8gPT4gZmFsc2VcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBpc1dlYWtTZXQodmFsdWUpIHtcbiAgICAgIHJldHVybiBpc09iamVjdExpa2UodmFsdWUpICYmIGJhc2VHZXRUYWcodmFsdWUpID09IHdlYWtTZXRUYWc7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2tzIGlmIGB2YWx1ZWAgaXMgbGVzcyB0aGFuIGBvdGhlcmAuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMy45LjBcbiAgICAgKiBAY2F0ZWdvcnkgTGFuZ1xuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNvbXBhcmUuXG4gICAgICogQHBhcmFtIHsqfSBvdGhlciBUaGUgb3RoZXIgdmFsdWUgdG8gY29tcGFyZS5cbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYHZhbHVlYCBpcyBsZXNzIHRoYW4gYG90aGVyYCxcbiAgICAgKiAgZWxzZSBgZmFsc2VgLlxuICAgICAqIEBzZWUgXy5ndFxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLmx0KDEsIDMpO1xuICAgICAqIC8vID0+IHRydWVcbiAgICAgKlxuICAgICAqIF8ubHQoMywgMyk7XG4gICAgICogLy8gPT4gZmFsc2VcbiAgICAgKlxuICAgICAqIF8ubHQoMywgMSk7XG4gICAgICogLy8gPT4gZmFsc2VcbiAgICAgKi9cbiAgICB2YXIgbHQgPSBjcmVhdGVSZWxhdGlvbmFsT3BlcmF0aW9uKGJhc2VMdCk7XG5cbiAgICAvKipcbiAgICAgKiBDaGVja3MgaWYgYHZhbHVlYCBpcyBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gYG90aGVyYC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAzLjkuMFxuICAgICAqIEBjYXRlZ29yeSBMYW5nXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY29tcGFyZS5cbiAgICAgKiBAcGFyYW0geyp9IG90aGVyIFRoZSBvdGhlciB2YWx1ZSB0byBjb21wYXJlLlxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBgdmFsdWVgIGlzIGxlc3MgdGhhbiBvciBlcXVhbCB0b1xuICAgICAqICBgb3RoZXJgLCBlbHNlIGBmYWxzZWAuXG4gICAgICogQHNlZSBfLmd0ZVxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLmx0ZSgxLCAzKTtcbiAgICAgKiAvLyA9PiB0cnVlXG4gICAgICpcbiAgICAgKiBfLmx0ZSgzLCAzKTtcbiAgICAgKiAvLyA9PiB0cnVlXG4gICAgICpcbiAgICAgKiBfLmx0ZSgzLCAxKTtcbiAgICAgKiAvLyA9PiBmYWxzZVxuICAgICAqL1xuICAgIHZhciBsdGUgPSBjcmVhdGVSZWxhdGlvbmFsT3BlcmF0aW9uKGZ1bmN0aW9uKHZhbHVlLCBvdGhlcikge1xuICAgICAgcmV0dXJuIHZhbHVlIDw9IG90aGVyO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogQ29udmVydHMgYHZhbHVlYCB0byBhbiBhcnJheS5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAc2luY2UgMC4xLjBcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBjYXRlZ29yeSBMYW5nXG4gICAgICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY29udmVydC5cbiAgICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgdGhlIGNvbnZlcnRlZCBhcnJheS5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy50b0FycmF5KHsgJ2EnOiAxLCAnYic6IDIgfSk7XG4gICAgICogLy8gPT4gWzEsIDJdXG4gICAgICpcbiAgICAgKiBfLnRvQXJyYXkoJ2FiYycpO1xuICAgICAqIC8vID0+IFsnYScsICdiJywgJ2MnXVxuICAgICAqXG4gICAgICogXy50b0FycmF5KDEpO1xuICAgICAqIC8vID0+IFtdXG4gICAgICpcbiAgICAgKiBfLnRvQXJyYXkobnVsbCk7XG4gICAgICogLy8gPT4gW11cbiAgICAgKi9cbiAgICBmdW5jdGlvbiB0b0FycmF5KHZhbHVlKSB7XG4gICAgICBpZiAoIXZhbHVlKSB7XG4gICAgICAgIHJldHVybiBbXTtcbiAgICAgIH1cbiAgICAgIGlmIChpc0FycmF5TGlrZSh2YWx1ZSkpIHtcbiAgICAgICAgcmV0dXJuIGlzU3RyaW5nKHZhbHVlKSA/IHN0cmluZ1RvQXJyYXkodmFsdWUpIDogY29weUFycmF5KHZhbHVlKTtcbiAgICAgIH1cbiAgICAgIGlmIChzeW1JdGVyYXRvciAmJiB2YWx1ZVtzeW1JdGVyYXRvcl0pIHtcbiAgICAgICAgcmV0dXJuIGl0ZXJhdG9yVG9BcnJheSh2YWx1ZVtzeW1JdGVyYXRvcl0oKSk7XG4gICAgICB9XG4gICAgICB2YXIgdGFnID0gZ2V0VGFnKHZhbHVlKSxcbiAgICAgICAgICBmdW5jID0gdGFnID09IG1hcFRhZyA/IG1hcFRvQXJyYXkgOiAodGFnID09IHNldFRhZyA/IHNldFRvQXJyYXkgOiB2YWx1ZXMpO1xuXG4gICAgICByZXR1cm4gZnVuYyh2YWx1ZSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ29udmVydHMgYHZhbHVlYCB0byBhIGZpbml0ZSBudW1iZXIuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgNC4xMi4wXG4gICAgICogQGNhdGVnb3J5IExhbmdcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjb252ZXJ0LlxuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IFJldHVybnMgdGhlIGNvbnZlcnRlZCBudW1iZXIuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8udG9GaW5pdGUoMy4yKTtcbiAgICAgKiAvLyA9PiAzLjJcbiAgICAgKlxuICAgICAqIF8udG9GaW5pdGUoTnVtYmVyLk1JTl9WQUxVRSk7XG4gICAgICogLy8gPT4gNWUtMzI0XG4gICAgICpcbiAgICAgKiBfLnRvRmluaXRlKEluZmluaXR5KTtcbiAgICAgKiAvLyA9PiAxLjc5NzY5MzEzNDg2MjMxNTdlKzMwOFxuICAgICAqXG4gICAgICogXy50b0Zpbml0ZSgnMy4yJyk7XG4gICAgICogLy8gPT4gMy4yXG4gICAgICovXG4gICAgZnVuY3Rpb24gdG9GaW5pdGUodmFsdWUpIHtcbiAgICAgIGlmICghdmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlID09PSAwID8gdmFsdWUgOiAwO1xuICAgICAgfVxuICAgICAgdmFsdWUgPSB0b051bWJlcih2YWx1ZSk7XG4gICAgICBpZiAodmFsdWUgPT09IElORklOSVRZIHx8IHZhbHVlID09PSAtSU5GSU5JVFkpIHtcbiAgICAgICAgdmFyIHNpZ24gPSAodmFsdWUgPCAwID8gLTEgOiAxKTtcbiAgICAgICAgcmV0dXJuIHNpZ24gKiBNQVhfSU5URUdFUjtcbiAgICAgIH1cbiAgICAgIHJldHVybiB2YWx1ZSA9PT0gdmFsdWUgPyB2YWx1ZSA6IDA7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ29udmVydHMgYHZhbHVlYCB0byBhbiBpbnRlZ2VyLlxuICAgICAqXG4gICAgICogKipOb3RlOioqIFRoaXMgbWV0aG9kIGlzIGxvb3NlbHkgYmFzZWQgb25cbiAgICAgKiBbYFRvSW50ZWdlcmBdKGh0dHA6Ly93d3cuZWNtYS1pbnRlcm5hdGlvbmFsLm9yZy9lY21hLTI2Mi83LjAvI3NlYy10b2ludGVnZXIpLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDQuMC4wXG4gICAgICogQGNhdGVnb3J5IExhbmdcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBjb252ZXJ0LlxuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IFJldHVybnMgdGhlIGNvbnZlcnRlZCBpbnRlZ2VyLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLnRvSW50ZWdlcigzLjIpO1xuICAgICAqIC8vID0+IDNcbiAgICAgKlxuICAgICAqIF8udG9JbnRlZ2VyKE51bWJlci5NSU5fVkFMVUUpO1xuICAgICAqIC8vID0+IDBcbiAgICAgKlxuICAgICAqIF8udG9JbnRlZ2VyKEluZmluaXR5KTtcbiAgICAgKiAvLyA9PiAxLjc5NzY5MzEzNDg2MjMxNTdlKzMwOFxuICAgICAqXG4gICAgICogXy50b0ludGVnZXIoJzMuMicpO1xuICAgICAqIC8vID0+IDNcbiAgICAgKi9cbiAgICBmdW5jdGlvbiB0b0ludGVnZXIodmFsdWUpIHtcbiAgICAgIHZhciByZXN1bHQgPSB0b0Zpbml0ZSh2YWx1ZSksXG4gICAgICAgICAgcmVtYWluZGVyID0gcmVzdWx0ICUgMTtcblxuICAgICAgcmV0dXJuIHJlc3VsdCA9PT0gcmVzdWx0ID8gKHJlbWFpbmRlciA/IHJlc3VsdCAtIHJlbWFpbmRlciA6IHJlc3VsdCkgOiAwO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENvbnZlcnRzIGB2YWx1ZWAgdG8gYW4gaW50ZWdlciBzdWl0YWJsZSBmb3IgdXNlIGFzIHRoZSBsZW5ndGggb2YgYW5cbiAgICAgKiBhcnJheS1saWtlIG9iamVjdC5cbiAgICAgKlxuICAgICAqICoqTm90ZToqKiBUaGlzIG1ldGhvZCBpcyBiYXNlZCBvblxuICAgICAqIFtgVG9MZW5ndGhgXShodHRwOi8vZWNtYS1pbnRlcm5hdGlvbmFsLm9yZy9lY21hLTI2Mi83LjAvI3NlYy10b2xlbmd0aCkuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgNC4wLjBcbiAgICAgKiBAY2F0ZWdvcnkgTGFuZ1xuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNvbnZlcnQuXG4gICAgICogQHJldHVybnMge251bWJlcn0gUmV0dXJucyB0aGUgY29udmVydGVkIGludGVnZXIuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8udG9MZW5ndGgoMy4yKTtcbiAgICAgKiAvLyA9PiAzXG4gICAgICpcbiAgICAgKiBfLnRvTGVuZ3RoKE51bWJlci5NSU5fVkFMVUUpO1xuICAgICAqIC8vID0+IDBcbiAgICAgKlxuICAgICAqIF8udG9MZW5ndGgoSW5maW5pdHkpO1xuICAgICAqIC8vID0+IDQyOTQ5NjcyOTVcbiAgICAgKlxuICAgICAqIF8udG9MZW5ndGgoJzMuMicpO1xuICAgICAqIC8vID0+IDNcbiAgICAgKi9cbiAgICBmdW5jdGlvbiB0b0xlbmd0aCh2YWx1ZSkge1xuICAgICAgcmV0dXJuIHZhbHVlID8gYmFzZUNsYW1wKHRvSW50ZWdlcih2YWx1ZSksIDAsIE1BWF9BUlJBWV9MRU5HVEgpIDogMDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDb252ZXJ0cyBgdmFsdWVgIHRvIGEgbnVtYmVyLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDQuMC4wXG4gICAgICogQGNhdGVnb3J5IExhbmdcbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBwcm9jZXNzLlxuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IFJldHVybnMgdGhlIG51bWJlci5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy50b051bWJlcigzLjIpO1xuICAgICAqIC8vID0+IDMuMlxuICAgICAqXG4gICAgICogXy50b051bWJlcihOdW1iZXIuTUlOX1ZBTFVFKTtcbiAgICAgKiAvLyA9PiA1ZS0zMjRcbiAgICAgKlxuICAgICAqIF8udG9OdW1iZXIoSW5maW5pdHkpO1xuICAgICAqIC8vID0+IEluZmluaXR5XG4gICAgICpcbiAgICAgKiBfLnRvTnVtYmVyKCczLjInKTtcbiAgICAgKiAvLyA9PiAzLjJcbiAgICAgKi9cbiAgICBmdW5jdGlvbiB0b051bWJlcih2YWx1ZSkge1xuICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PSAnbnVtYmVyJykge1xuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICB9XG4gICAgICBpZiAoaXNTeW1ib2wodmFsdWUpKSB7XG4gICAgICAgIHJldHVybiBOQU47XG4gICAgICB9XG4gICAgICBpZiAoaXNPYmplY3QodmFsdWUpKSB7XG4gICAgICAgIHZhciBvdGhlciA9IHR5cGVvZiB2YWx1ZS52YWx1ZU9mID09ICdmdW5jdGlvbicgPyB2YWx1ZS52YWx1ZU9mKCkgOiB2YWx1ZTtcbiAgICAgICAgdmFsdWUgPSBpc09iamVjdChvdGhlcikgPyAob3RoZXIgKyAnJykgOiBvdGhlcjtcbiAgICAgIH1cbiAgICAgIGlmICh0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlID09PSAwID8gdmFsdWUgOiArdmFsdWU7XG4gICAgICB9XG4gICAgICB2YWx1ZSA9IHZhbHVlLnJlcGxhY2UocmVUcmltLCAnJyk7XG4gICAgICB2YXIgaXNCaW5hcnkgPSByZUlzQmluYXJ5LnRlc3QodmFsdWUpO1xuICAgICAgcmV0dXJuIChpc0JpbmFyeSB8fCByZUlzT2N0YWwudGVzdCh2YWx1ZSkpXG4gICAgICAgID8gZnJlZVBhcnNlSW50KHZhbHVlLnNsaWNlKDIpLCBpc0JpbmFyeSA/IDIgOiA4KVxuICAgICAgICA6IChyZUlzQmFkSGV4LnRlc3QodmFsdWUpID8gTkFOIDogK3ZhbHVlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDb252ZXJ0cyBgdmFsdWVgIHRvIGEgcGxhaW4gb2JqZWN0IGZsYXR0ZW5pbmcgaW5oZXJpdGVkIGVudW1lcmFibGUgc3RyaW5nXG4gICAgICoga2V5ZWQgcHJvcGVydGllcyBvZiBgdmFsdWVgIHRvIG93biBwcm9wZXJ0aWVzIG9mIHRoZSBwbGFpbiBvYmplY3QuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMy4wLjBcbiAgICAgKiBAY2F0ZWdvcnkgTGFuZ1xuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNvbnZlcnQuXG4gICAgICogQHJldHVybnMge09iamVjdH0gUmV0dXJucyB0aGUgY29udmVydGVkIHBsYWluIG9iamVjdC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogZnVuY3Rpb24gRm9vKCkge1xuICAgICAqICAgdGhpcy5iID0gMjtcbiAgICAgKiB9XG4gICAgICpcbiAgICAgKiBGb28ucHJvdG90eXBlLmMgPSAzO1xuICAgICAqXG4gICAgICogXy5hc3NpZ24oeyAnYSc6IDEgfSwgbmV3IEZvbyk7XG4gICAgICogLy8gPT4geyAnYSc6IDEsICdiJzogMiB9XG4gICAgICpcbiAgICAgKiBfLmFzc2lnbih7ICdhJzogMSB9LCBfLnRvUGxhaW5PYmplY3QobmV3IEZvbykpO1xuICAgICAqIC8vID0+IHsgJ2EnOiAxLCAnYic6IDIsICdjJzogMyB9XG4gICAgICovXG4gICAgZnVuY3Rpb24gdG9QbGFpbk9iamVjdCh2YWx1ZSkge1xuICAgICAgcmV0dXJuIGNvcHlPYmplY3QodmFsdWUsIGtleXNJbih2YWx1ZSkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENvbnZlcnRzIGB2YWx1ZWAgdG8gYSBzYWZlIGludGVnZXIuIEEgc2FmZSBpbnRlZ2VyIGNhbiBiZSBjb21wYXJlZCBhbmRcbiAgICAgKiByZXByZXNlbnRlZCBjb3JyZWN0bHkuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgNC4wLjBcbiAgICAgKiBAY2F0ZWdvcnkgTGFuZ1xuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNvbnZlcnQuXG4gICAgICogQHJldHVybnMge251bWJlcn0gUmV0dXJucyB0aGUgY29udmVydGVkIGludGVnZXIuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8udG9TYWZlSW50ZWdlcigzLjIpO1xuICAgICAqIC8vID0+IDNcbiAgICAgKlxuICAgICAqIF8udG9TYWZlSW50ZWdlcihOdW1iZXIuTUlOX1ZBTFVFKTtcbiAgICAgKiAvLyA9PiAwXG4gICAgICpcbiAgICAgKiBfLnRvU2FmZUludGVnZXIoSW5maW5pdHkpO1xuICAgICAqIC8vID0+IDkwMDcxOTkyNTQ3NDA5OTFcbiAgICAgKlxuICAgICAqIF8udG9TYWZlSW50ZWdlcignMy4yJyk7XG4gICAgICogLy8gPT4gM1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIHRvU2FmZUludGVnZXIodmFsdWUpIHtcbiAgICAgIHJldHVybiB2YWx1ZVxuICAgICAgICA/IGJhc2VDbGFtcCh0b0ludGVnZXIodmFsdWUpLCAtTUFYX1NBRkVfSU5URUdFUiwgTUFYX1NBRkVfSU5URUdFUilcbiAgICAgICAgOiAodmFsdWUgPT09IDAgPyB2YWx1ZSA6IDApO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENvbnZlcnRzIGB2YWx1ZWAgdG8gYSBzdHJpbmcuIEFuIGVtcHR5IHN0cmluZyBpcyByZXR1cm5lZCBmb3IgYG51bGxgXG4gICAgICogYW5kIGB1bmRlZmluZWRgIHZhbHVlcy4gVGhlIHNpZ24gb2YgYC0wYCBpcyBwcmVzZXJ2ZWQuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgNC4wLjBcbiAgICAgKiBAY2F0ZWdvcnkgTGFuZ1xuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNvbnZlcnQuXG4gICAgICogQHJldHVybnMge3N0cmluZ30gUmV0dXJucyB0aGUgY29udmVydGVkIHN0cmluZy5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy50b1N0cmluZyhudWxsKTtcbiAgICAgKiAvLyA9PiAnJ1xuICAgICAqXG4gICAgICogXy50b1N0cmluZygtMCk7XG4gICAgICogLy8gPT4gJy0wJ1xuICAgICAqXG4gICAgICogXy50b1N0cmluZyhbMSwgMiwgM10pO1xuICAgICAqIC8vID0+ICcxLDIsMydcbiAgICAgKi9cbiAgICBmdW5jdGlvbiB0b1N0cmluZyh2YWx1ZSkge1xuICAgICAgcmV0dXJuIHZhbHVlID09IG51bGwgPyAnJyA6IGJhc2VUb1N0cmluZyh2YWx1ZSk7XG4gICAgfVxuXG4gICAgLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG4gICAgLyoqXG4gICAgICogQXNzaWducyBvd24gZW51bWVyYWJsZSBzdHJpbmcga2V5ZWQgcHJvcGVydGllcyBvZiBzb3VyY2Ugb2JqZWN0cyB0byB0aGVcbiAgICAgKiBkZXN0aW5hdGlvbiBvYmplY3QuIFNvdXJjZSBvYmplY3RzIGFyZSBhcHBsaWVkIGZyb20gbGVmdCB0byByaWdodC5cbiAgICAgKiBTdWJzZXF1ZW50IHNvdXJjZXMgb3ZlcndyaXRlIHByb3BlcnR5IGFzc2lnbm1lbnRzIG9mIHByZXZpb3VzIHNvdXJjZXMuXG4gICAgICpcbiAgICAgKiAqKk5vdGU6KiogVGhpcyBtZXRob2QgbXV0YXRlcyBgb2JqZWN0YCBhbmQgaXMgbG9vc2VseSBiYXNlZCBvblxuICAgICAqIFtgT2JqZWN0LmFzc2lnbmBdKGh0dHBzOi8vbWRuLmlvL09iamVjdC9hc3NpZ24pLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDAuMTAuMFxuICAgICAqIEBjYXRlZ29yeSBPYmplY3RcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBkZXN0aW5hdGlvbiBvYmplY3QuXG4gICAgICogQHBhcmFtIHsuLi5PYmplY3R9IFtzb3VyY2VzXSBUaGUgc291cmNlIG9iamVjdHMuXG4gICAgICogQHJldHVybnMge09iamVjdH0gUmV0dXJucyBgb2JqZWN0YC5cbiAgICAgKiBAc2VlIF8uYXNzaWduSW5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogZnVuY3Rpb24gRm9vKCkge1xuICAgICAqICAgdGhpcy5hID0gMTtcbiAgICAgKiB9XG4gICAgICpcbiAgICAgKiBmdW5jdGlvbiBCYXIoKSB7XG4gICAgICogICB0aGlzLmMgPSAzO1xuICAgICAqIH1cbiAgICAgKlxuICAgICAqIEZvby5wcm90b3R5cGUuYiA9IDI7XG4gICAgICogQmFyLnByb3RvdHlwZS5kID0gNDtcbiAgICAgKlxuICAgICAqIF8uYXNzaWduKHsgJ2EnOiAwIH0sIG5ldyBGb28sIG5ldyBCYXIpO1xuICAgICAqIC8vID0+IHsgJ2EnOiAxLCAnYyc6IDMgfVxuICAgICAqL1xuICAgIHZhciBhc3NpZ24gPSBjcmVhdGVBc3NpZ25lcihmdW5jdGlvbihvYmplY3QsIHNvdXJjZSkge1xuICAgICAgaWYgKGlzUHJvdG90eXBlKHNvdXJjZSkgfHwgaXNBcnJheUxpa2Uoc291cmNlKSkge1xuICAgICAgICBjb3B5T2JqZWN0KHNvdXJjZSwga2V5cyhzb3VyY2UpLCBvYmplY3QpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBmb3IgKHZhciBrZXkgaW4gc291cmNlKSB7XG4gICAgICAgIGlmIChoYXNPd25Qcm9wZXJ0eS5jYWxsKHNvdXJjZSwga2V5KSkge1xuICAgICAgICAgIGFzc2lnblZhbHVlKG9iamVjdCwga2V5LCBzb3VyY2Vba2V5XSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFRoaXMgbWV0aG9kIGlzIGxpa2UgYF8uYXNzaWduYCBleGNlcHQgdGhhdCBpdCBpdGVyYXRlcyBvdmVyIG93biBhbmRcbiAgICAgKiBpbmhlcml0ZWQgc291cmNlIHByb3BlcnRpZXMuXG4gICAgICpcbiAgICAgKiAqKk5vdGU6KiogVGhpcyBtZXRob2QgbXV0YXRlcyBgb2JqZWN0YC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSA0LjAuMFxuICAgICAqIEBhbGlhcyBleHRlbmRcbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0XG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgZGVzdGluYXRpb24gb2JqZWN0LlxuICAgICAqIEBwYXJhbSB7Li4uT2JqZWN0fSBbc291cmNlc10gVGhlIHNvdXJjZSBvYmplY3RzLlxuICAgICAqIEByZXR1cm5zIHtPYmplY3R9IFJldHVybnMgYG9iamVjdGAuXG4gICAgICogQHNlZSBfLmFzc2lnblxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBmdW5jdGlvbiBGb28oKSB7XG4gICAgICogICB0aGlzLmEgPSAxO1xuICAgICAqIH1cbiAgICAgKlxuICAgICAqIGZ1bmN0aW9uIEJhcigpIHtcbiAgICAgKiAgIHRoaXMuYyA9IDM7XG4gICAgICogfVxuICAgICAqXG4gICAgICogRm9vLnByb3RvdHlwZS5iID0gMjtcbiAgICAgKiBCYXIucHJvdG90eXBlLmQgPSA0O1xuICAgICAqXG4gICAgICogXy5hc3NpZ25Jbih7ICdhJzogMCB9LCBuZXcgRm9vLCBuZXcgQmFyKTtcbiAgICAgKiAvLyA9PiB7ICdhJzogMSwgJ2InOiAyLCAnYyc6IDMsICdkJzogNCB9XG4gICAgICovXG4gICAgdmFyIGFzc2lnbkluID0gY3JlYXRlQXNzaWduZXIoZnVuY3Rpb24ob2JqZWN0LCBzb3VyY2UpIHtcbiAgICAgIGNvcHlPYmplY3Qoc291cmNlLCBrZXlzSW4oc291cmNlKSwgb2JqZWN0KTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFRoaXMgbWV0aG9kIGlzIGxpa2UgYF8uYXNzaWduSW5gIGV4Y2VwdCB0aGF0IGl0IGFjY2VwdHMgYGN1c3RvbWl6ZXJgXG4gICAgICogd2hpY2ggaXMgaW52b2tlZCB0byBwcm9kdWNlIHRoZSBhc3NpZ25lZCB2YWx1ZXMuIElmIGBjdXN0b21pemVyYCByZXR1cm5zXG4gICAgICogYHVuZGVmaW5lZGAsIGFzc2lnbm1lbnQgaXMgaGFuZGxlZCBieSB0aGUgbWV0aG9kIGluc3RlYWQuIFRoZSBgY3VzdG9taXplcmBcbiAgICAgKiBpcyBpbnZva2VkIHdpdGggZml2ZSBhcmd1bWVudHM6IChvYmpWYWx1ZSwgc3JjVmFsdWUsIGtleSwgb2JqZWN0LCBzb3VyY2UpLlxuICAgICAqXG4gICAgICogKipOb3RlOioqIFRoaXMgbWV0aG9kIG11dGF0ZXMgYG9iamVjdGAuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgNC4wLjBcbiAgICAgKiBAYWxpYXMgZXh0ZW5kV2l0aFxuICAgICAqIEBjYXRlZ29yeSBPYmplY3RcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBkZXN0aW5hdGlvbiBvYmplY3QuXG4gICAgICogQHBhcmFtIHsuLi5PYmplY3R9IHNvdXJjZXMgVGhlIHNvdXJjZSBvYmplY3RzLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtjdXN0b21pemVyXSBUaGUgZnVuY3Rpb24gdG8gY3VzdG9taXplIGFzc2lnbmVkIHZhbHVlcy5cbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIGBvYmplY3RgLlxuICAgICAqIEBzZWUgXy5hc3NpZ25XaXRoXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIGZ1bmN0aW9uIGN1c3RvbWl6ZXIob2JqVmFsdWUsIHNyY1ZhbHVlKSB7XG4gICAgICogICByZXR1cm4gXy5pc1VuZGVmaW5lZChvYmpWYWx1ZSkgPyBzcmNWYWx1ZSA6IG9ialZhbHVlO1xuICAgICAqIH1cbiAgICAgKlxuICAgICAqIHZhciBkZWZhdWx0cyA9IF8ucGFydGlhbFJpZ2h0KF8uYXNzaWduSW5XaXRoLCBjdXN0b21pemVyKTtcbiAgICAgKlxuICAgICAqIGRlZmF1bHRzKHsgJ2EnOiAxIH0sIHsgJ2InOiAyIH0sIHsgJ2EnOiAzIH0pO1xuICAgICAqIC8vID0+IHsgJ2EnOiAxLCAnYic6IDIgfVxuICAgICAqL1xuICAgIHZhciBhc3NpZ25JbldpdGggPSBjcmVhdGVBc3NpZ25lcihmdW5jdGlvbihvYmplY3QsIHNvdXJjZSwgc3JjSW5kZXgsIGN1c3RvbWl6ZXIpIHtcbiAgICAgIGNvcHlPYmplY3Qoc291cmNlLCBrZXlzSW4oc291cmNlKSwgb2JqZWN0LCBjdXN0b21pemVyKTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFRoaXMgbWV0aG9kIGlzIGxpa2UgYF8uYXNzaWduYCBleGNlcHQgdGhhdCBpdCBhY2NlcHRzIGBjdXN0b21pemVyYFxuICAgICAqIHdoaWNoIGlzIGludm9rZWQgdG8gcHJvZHVjZSB0aGUgYXNzaWduZWQgdmFsdWVzLiBJZiBgY3VzdG9taXplcmAgcmV0dXJuc1xuICAgICAqIGB1bmRlZmluZWRgLCBhc3NpZ25tZW50IGlzIGhhbmRsZWQgYnkgdGhlIG1ldGhvZCBpbnN0ZWFkLiBUaGUgYGN1c3RvbWl6ZXJgXG4gICAgICogaXMgaW52b2tlZCB3aXRoIGZpdmUgYXJndW1lbnRzOiAob2JqVmFsdWUsIHNyY1ZhbHVlLCBrZXksIG9iamVjdCwgc291cmNlKS5cbiAgICAgKlxuICAgICAqICoqTm90ZToqKiBUaGlzIG1ldGhvZCBtdXRhdGVzIGBvYmplY3RgLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDQuMC4wXG4gICAgICogQGNhdGVnb3J5IE9iamVjdFxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIGRlc3RpbmF0aW9uIG9iamVjdC5cbiAgICAgKiBAcGFyYW0gey4uLk9iamVjdH0gc291cmNlcyBUaGUgc291cmNlIG9iamVjdHMuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gW2N1c3RvbWl6ZXJdIFRoZSBmdW5jdGlvbiB0byBjdXN0b21pemUgYXNzaWduZWQgdmFsdWVzLlxuICAgICAqIEByZXR1cm5zIHtPYmplY3R9IFJldHVybnMgYG9iamVjdGAuXG4gICAgICogQHNlZSBfLmFzc2lnbkluV2l0aFxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBmdW5jdGlvbiBjdXN0b21pemVyKG9ialZhbHVlLCBzcmNWYWx1ZSkge1xuICAgICAqICAgcmV0dXJuIF8uaXNVbmRlZmluZWQob2JqVmFsdWUpID8gc3JjVmFsdWUgOiBvYmpWYWx1ZTtcbiAgICAgKiB9XG4gICAgICpcbiAgICAgKiB2YXIgZGVmYXVsdHMgPSBfLnBhcnRpYWxSaWdodChfLmFzc2lnbldpdGgsIGN1c3RvbWl6ZXIpO1xuICAgICAqXG4gICAgICogZGVmYXVsdHMoeyAnYSc6IDEgfSwgeyAnYic6IDIgfSwgeyAnYSc6IDMgfSk7XG4gICAgICogLy8gPT4geyAnYSc6IDEsICdiJzogMiB9XG4gICAgICovXG4gICAgdmFyIGFzc2lnbldpdGggPSBjcmVhdGVBc3NpZ25lcihmdW5jdGlvbihvYmplY3QsIHNvdXJjZSwgc3JjSW5kZXgsIGN1c3RvbWl6ZXIpIHtcbiAgICAgIGNvcHlPYmplY3Qoc291cmNlLCBrZXlzKHNvdXJjZSksIG9iamVjdCwgY3VzdG9taXplcik7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuIGFycmF5IG9mIHZhbHVlcyBjb3JyZXNwb25kaW5nIHRvIGBwYXRoc2Agb2YgYG9iamVjdGAuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMS4wLjBcbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0XG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgb2JqZWN0IHRvIGl0ZXJhdGUgb3Zlci5cbiAgICAgKiBAcGFyYW0gey4uLihzdHJpbmd8c3RyaW5nW10pfSBbcGF0aHNdIFRoZSBwcm9wZXJ0eSBwYXRocyB0byBwaWNrLlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgcGlja2VkIHZhbHVlcy5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogdmFyIG9iamVjdCA9IHsgJ2EnOiBbeyAnYic6IHsgJ2MnOiAzIH0gfSwgNF0gfTtcbiAgICAgKlxuICAgICAqIF8uYXQob2JqZWN0LCBbJ2FbMF0uYi5jJywgJ2FbMV0nXSk7XG4gICAgICogLy8gPT4gWzMsIDRdXG4gICAgICovXG4gICAgdmFyIGF0ID0gZmxhdFJlc3QoYmFzZUF0KTtcblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW4gb2JqZWN0IHRoYXQgaW5oZXJpdHMgZnJvbSB0aGUgYHByb3RvdHlwZWAgb2JqZWN0LiBJZiBhXG4gICAgICogYHByb3BlcnRpZXNgIG9iamVjdCBpcyBnaXZlbiwgaXRzIG93biBlbnVtZXJhYmxlIHN0cmluZyBrZXllZCBwcm9wZXJ0aWVzXG4gICAgICogYXJlIGFzc2lnbmVkIHRvIHRoZSBjcmVhdGVkIG9iamVjdC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAyLjMuMFxuICAgICAqIEBjYXRlZ29yeSBPYmplY3RcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gcHJvdG90eXBlIFRoZSBvYmplY3QgdG8gaW5oZXJpdCBmcm9tLlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbcHJvcGVydGllc10gVGhlIHByb3BlcnRpZXMgdG8gYXNzaWduIHRvIHRoZSBvYmplY3QuXG4gICAgICogQHJldHVybnMge09iamVjdH0gUmV0dXJucyB0aGUgbmV3IG9iamVjdC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogZnVuY3Rpb24gU2hhcGUoKSB7XG4gICAgICogICB0aGlzLnggPSAwO1xuICAgICAqICAgdGhpcy55ID0gMDtcbiAgICAgKiB9XG4gICAgICpcbiAgICAgKiBmdW5jdGlvbiBDaXJjbGUoKSB7XG4gICAgICogICBTaGFwZS5jYWxsKHRoaXMpO1xuICAgICAqIH1cbiAgICAgKlxuICAgICAqIENpcmNsZS5wcm90b3R5cGUgPSBfLmNyZWF0ZShTaGFwZS5wcm90b3R5cGUsIHtcbiAgICAgKiAgICdjb25zdHJ1Y3Rvcic6IENpcmNsZVxuICAgICAqIH0pO1xuICAgICAqXG4gICAgICogdmFyIGNpcmNsZSA9IG5ldyBDaXJjbGU7XG4gICAgICogY2lyY2xlIGluc3RhbmNlb2YgQ2lyY2xlO1xuICAgICAqIC8vID0+IHRydWVcbiAgICAgKlxuICAgICAqIGNpcmNsZSBpbnN0YW5jZW9mIFNoYXBlO1xuICAgICAqIC8vID0+IHRydWVcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjcmVhdGUocHJvdG90eXBlLCBwcm9wZXJ0aWVzKSB7XG4gICAgICB2YXIgcmVzdWx0ID0gYmFzZUNyZWF0ZShwcm90b3R5cGUpO1xuICAgICAgcmV0dXJuIHByb3BlcnRpZXMgPT0gbnVsbCA/IHJlc3VsdCA6IGJhc2VBc3NpZ24ocmVzdWx0LCBwcm9wZXJ0aWVzKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBc3NpZ25zIG93biBhbmQgaW5oZXJpdGVkIGVudW1lcmFibGUgc3RyaW5nIGtleWVkIHByb3BlcnRpZXMgb2Ygc291cmNlXG4gICAgICogb2JqZWN0cyB0byB0aGUgZGVzdGluYXRpb24gb2JqZWN0IGZvciBhbGwgZGVzdGluYXRpb24gcHJvcGVydGllcyB0aGF0XG4gICAgICogcmVzb2x2ZSB0byBgdW5kZWZpbmVkYC4gU291cmNlIG9iamVjdHMgYXJlIGFwcGxpZWQgZnJvbSBsZWZ0IHRvIHJpZ2h0LlxuICAgICAqIE9uY2UgYSBwcm9wZXJ0eSBpcyBzZXQsIGFkZGl0aW9uYWwgdmFsdWVzIG9mIHRoZSBzYW1lIHByb3BlcnR5IGFyZSBpZ25vcmVkLlxuICAgICAqXG4gICAgICogKipOb3RlOioqIFRoaXMgbWV0aG9kIG11dGF0ZXMgYG9iamVjdGAuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQHNpbmNlIDAuMS4wXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0XG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgZGVzdGluYXRpb24gb2JqZWN0LlxuICAgICAqIEBwYXJhbSB7Li4uT2JqZWN0fSBbc291cmNlc10gVGhlIHNvdXJjZSBvYmplY3RzLlxuICAgICAqIEByZXR1cm5zIHtPYmplY3R9IFJldHVybnMgYG9iamVjdGAuXG4gICAgICogQHNlZSBfLmRlZmF1bHRzRGVlcFxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLmRlZmF1bHRzKHsgJ2EnOiAxIH0sIHsgJ2InOiAyIH0sIHsgJ2EnOiAzIH0pO1xuICAgICAqIC8vID0+IHsgJ2EnOiAxLCAnYic6IDIgfVxuICAgICAqL1xuICAgIHZhciBkZWZhdWx0cyA9IGJhc2VSZXN0KGZ1bmN0aW9uKG9iamVjdCwgc291cmNlcykge1xuICAgICAgb2JqZWN0ID0gT2JqZWN0KG9iamVjdCk7XG5cbiAgICAgIHZhciBpbmRleCA9IC0xO1xuICAgICAgdmFyIGxlbmd0aCA9IHNvdXJjZXMubGVuZ3RoO1xuICAgICAgdmFyIGd1YXJkID0gbGVuZ3RoID4gMiA/IHNvdXJjZXNbMl0gOiB1bmRlZmluZWQ7XG5cbiAgICAgIGlmIChndWFyZCAmJiBpc0l0ZXJhdGVlQ2FsbChzb3VyY2VzWzBdLCBzb3VyY2VzWzFdLCBndWFyZCkpIHtcbiAgICAgICAgbGVuZ3RoID0gMTtcbiAgICAgIH1cblxuICAgICAgd2hpbGUgKCsraW5kZXggPCBsZW5ndGgpIHtcbiAgICAgICAgdmFyIHNvdXJjZSA9IHNvdXJjZXNbaW5kZXhdO1xuICAgICAgICB2YXIgcHJvcHMgPSBrZXlzSW4oc291cmNlKTtcbiAgICAgICAgdmFyIHByb3BzSW5kZXggPSAtMTtcbiAgICAgICAgdmFyIHByb3BzTGVuZ3RoID0gcHJvcHMubGVuZ3RoO1xuXG4gICAgICAgIHdoaWxlICgrK3Byb3BzSW5kZXggPCBwcm9wc0xlbmd0aCkge1xuICAgICAgICAgIHZhciBrZXkgPSBwcm9wc1twcm9wc0luZGV4XTtcbiAgICAgICAgICB2YXIgdmFsdWUgPSBvYmplY3Rba2V5XTtcblxuICAgICAgICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkIHx8XG4gICAgICAgICAgICAgIChlcSh2YWx1ZSwgb2JqZWN0UHJvdG9ba2V5XSkgJiYgIWhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBrZXkpKSkge1xuICAgICAgICAgICAgb2JqZWN0W2tleV0gPSBzb3VyY2Vba2V5XTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIG9iamVjdDtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFRoaXMgbWV0aG9kIGlzIGxpa2UgYF8uZGVmYXVsdHNgIGV4Y2VwdCB0aGF0IGl0IHJlY3Vyc2l2ZWx5IGFzc2lnbnNcbiAgICAgKiBkZWZhdWx0IHByb3BlcnRpZXMuXG4gICAgICpcbiAgICAgKiAqKk5vdGU6KiogVGhpcyBtZXRob2QgbXV0YXRlcyBgb2JqZWN0YC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAzLjEwLjBcbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0XG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgZGVzdGluYXRpb24gb2JqZWN0LlxuICAgICAqIEBwYXJhbSB7Li4uT2JqZWN0fSBbc291cmNlc10gVGhlIHNvdXJjZSBvYmplY3RzLlxuICAgICAqIEByZXR1cm5zIHtPYmplY3R9IFJldHVybnMgYG9iamVjdGAuXG4gICAgICogQHNlZSBfLmRlZmF1bHRzXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8uZGVmYXVsdHNEZWVwKHsgJ2EnOiB7ICdiJzogMiB9IH0sIHsgJ2EnOiB7ICdiJzogMSwgJ2MnOiAzIH0gfSk7XG4gICAgICogLy8gPT4geyAnYSc6IHsgJ2InOiAyLCAnYyc6IDMgfSB9XG4gICAgICovXG4gICAgdmFyIGRlZmF1bHRzRGVlcCA9IGJhc2VSZXN0KGZ1bmN0aW9uKGFyZ3MpIHtcbiAgICAgIGFyZ3MucHVzaCh1bmRlZmluZWQsIGN1c3RvbURlZmF1bHRzTWVyZ2UpO1xuICAgICAgcmV0dXJuIGFwcGx5KG1lcmdlV2l0aCwgdW5kZWZpbmVkLCBhcmdzKTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFRoaXMgbWV0aG9kIGlzIGxpa2UgYF8uZmluZGAgZXhjZXB0IHRoYXQgaXQgcmV0dXJucyB0aGUga2V5IG9mIHRoZSBmaXJzdFxuICAgICAqIGVsZW1lbnQgYHByZWRpY2F0ZWAgcmV0dXJucyB0cnV0aHkgZm9yIGluc3RlYWQgb2YgdGhlIGVsZW1lbnQgaXRzZWxmLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDEuMS4wXG4gICAgICogQGNhdGVnb3J5IE9iamVjdFxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIG9iamVjdCB0byBpbnNwZWN0LlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtwcmVkaWNhdGU9Xy5pZGVudGl0eV0gVGhlIGZ1bmN0aW9uIGludm9rZWQgcGVyIGl0ZXJhdGlvbi5cbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfHVuZGVmaW5lZH0gUmV0dXJucyB0aGUga2V5IG9mIHRoZSBtYXRjaGVkIGVsZW1lbnQsXG4gICAgICogIGVsc2UgYHVuZGVmaW5lZGAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciB1c2VycyA9IHtcbiAgICAgKiAgICdiYXJuZXknOiAgeyAnYWdlJzogMzYsICdhY3RpdmUnOiB0cnVlIH0sXG4gICAgICogICAnZnJlZCc6ICAgIHsgJ2FnZSc6IDQwLCAnYWN0aXZlJzogZmFsc2UgfSxcbiAgICAgKiAgICdwZWJibGVzJzogeyAnYWdlJzogMSwgICdhY3RpdmUnOiB0cnVlIH1cbiAgICAgKiB9O1xuICAgICAqXG4gICAgICogXy5maW5kS2V5KHVzZXJzLCBmdW5jdGlvbihvKSB7IHJldHVybiBvLmFnZSA8IDQwOyB9KTtcbiAgICAgKiAvLyA9PiAnYmFybmV5JyAoaXRlcmF0aW9uIG9yZGVyIGlzIG5vdCBndWFyYW50ZWVkKVxuICAgICAqXG4gICAgICogLy8gVGhlIGBfLm1hdGNoZXNgIGl0ZXJhdGVlIHNob3J0aGFuZC5cbiAgICAgKiBfLmZpbmRLZXkodXNlcnMsIHsgJ2FnZSc6IDEsICdhY3RpdmUnOiB0cnVlIH0pO1xuICAgICAqIC8vID0+ICdwZWJibGVzJ1xuICAgICAqXG4gICAgICogLy8gVGhlIGBfLm1hdGNoZXNQcm9wZXJ0eWAgaXRlcmF0ZWUgc2hvcnRoYW5kLlxuICAgICAqIF8uZmluZEtleSh1c2VycywgWydhY3RpdmUnLCBmYWxzZV0pO1xuICAgICAqIC8vID0+ICdmcmVkJ1xuICAgICAqXG4gICAgICogLy8gVGhlIGBfLnByb3BlcnR5YCBpdGVyYXRlZSBzaG9ydGhhbmQuXG4gICAgICogXy5maW5kS2V5KHVzZXJzLCAnYWN0aXZlJyk7XG4gICAgICogLy8gPT4gJ2Jhcm5leSdcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBmaW5kS2V5KG9iamVjdCwgcHJlZGljYXRlKSB7XG4gICAgICByZXR1cm4gYmFzZUZpbmRLZXkob2JqZWN0LCBnZXRJdGVyYXRlZShwcmVkaWNhdGUsIDMpLCBiYXNlRm9yT3duKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGlzIG1ldGhvZCBpcyBsaWtlIGBfLmZpbmRLZXlgIGV4Y2VwdCB0aGF0IGl0IGl0ZXJhdGVzIG92ZXIgZWxlbWVudHMgb2ZcbiAgICAgKiBhIGNvbGxlY3Rpb24gaW4gdGhlIG9wcG9zaXRlIG9yZGVyLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDIuMC4wXG4gICAgICogQGNhdGVnb3J5IE9iamVjdFxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIG9iamVjdCB0byBpbnNwZWN0LlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtwcmVkaWNhdGU9Xy5pZGVudGl0eV0gVGhlIGZ1bmN0aW9uIGludm9rZWQgcGVyIGl0ZXJhdGlvbi5cbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfHVuZGVmaW5lZH0gUmV0dXJucyB0aGUga2V5IG9mIHRoZSBtYXRjaGVkIGVsZW1lbnQsXG4gICAgICogIGVsc2UgYHVuZGVmaW5lZGAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciB1c2VycyA9IHtcbiAgICAgKiAgICdiYXJuZXknOiAgeyAnYWdlJzogMzYsICdhY3RpdmUnOiB0cnVlIH0sXG4gICAgICogICAnZnJlZCc6ICAgIHsgJ2FnZSc6IDQwLCAnYWN0aXZlJzogZmFsc2UgfSxcbiAgICAgKiAgICdwZWJibGVzJzogeyAnYWdlJzogMSwgICdhY3RpdmUnOiB0cnVlIH1cbiAgICAgKiB9O1xuICAgICAqXG4gICAgICogXy5maW5kTGFzdEtleSh1c2VycywgZnVuY3Rpb24obykgeyByZXR1cm4gby5hZ2UgPCA0MDsgfSk7XG4gICAgICogLy8gPT4gcmV0dXJucyAncGViYmxlcycgYXNzdW1pbmcgYF8uZmluZEtleWAgcmV0dXJucyAnYmFybmV5J1xuICAgICAqXG4gICAgICogLy8gVGhlIGBfLm1hdGNoZXNgIGl0ZXJhdGVlIHNob3J0aGFuZC5cbiAgICAgKiBfLmZpbmRMYXN0S2V5KHVzZXJzLCB7ICdhZ2UnOiAzNiwgJ2FjdGl2ZSc6IHRydWUgfSk7XG4gICAgICogLy8gPT4gJ2Jhcm5leSdcbiAgICAgKlxuICAgICAqIC8vIFRoZSBgXy5tYXRjaGVzUHJvcGVydHlgIGl0ZXJhdGVlIHNob3J0aGFuZC5cbiAgICAgKiBfLmZpbmRMYXN0S2V5KHVzZXJzLCBbJ2FjdGl2ZScsIGZhbHNlXSk7XG4gICAgICogLy8gPT4gJ2ZyZWQnXG4gICAgICpcbiAgICAgKiAvLyBUaGUgYF8ucHJvcGVydHlgIGl0ZXJhdGVlIHNob3J0aGFuZC5cbiAgICAgKiBfLmZpbmRMYXN0S2V5KHVzZXJzLCAnYWN0aXZlJyk7XG4gICAgICogLy8gPT4gJ3BlYmJsZXMnXG4gICAgICovXG4gICAgZnVuY3Rpb24gZmluZExhc3RLZXkob2JqZWN0LCBwcmVkaWNhdGUpIHtcbiAgICAgIHJldHVybiBiYXNlRmluZEtleShvYmplY3QsIGdldEl0ZXJhdGVlKHByZWRpY2F0ZSwgMyksIGJhc2VGb3JPd25SaWdodCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSXRlcmF0ZXMgb3ZlciBvd24gYW5kIGluaGVyaXRlZCBlbnVtZXJhYmxlIHN0cmluZyBrZXllZCBwcm9wZXJ0aWVzIG9mIGFuXG4gICAgICogb2JqZWN0IGFuZCBpbnZva2VzIGBpdGVyYXRlZWAgZm9yIGVhY2ggcHJvcGVydHkuIFRoZSBpdGVyYXRlZSBpcyBpbnZva2VkXG4gICAgICogd2l0aCB0aHJlZSBhcmd1bWVudHM6ICh2YWx1ZSwga2V5LCBvYmplY3QpLiBJdGVyYXRlZSBmdW5jdGlvbnMgbWF5IGV4aXRcbiAgICAgKiBpdGVyYXRpb24gZWFybHkgYnkgZXhwbGljaXRseSByZXR1cm5pbmcgYGZhbHNlYC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAwLjMuMFxuICAgICAqIEBjYXRlZ29yeSBPYmplY3RcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8gaXRlcmF0ZSBvdmVyLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtpdGVyYXRlZT1fLmlkZW50aXR5XSBUaGUgZnVuY3Rpb24gaW52b2tlZCBwZXIgaXRlcmF0aW9uLlxuICAgICAqIEByZXR1cm5zIHtPYmplY3R9IFJldHVybnMgYG9iamVjdGAuXG4gICAgICogQHNlZSBfLmZvckluUmlnaHRcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogZnVuY3Rpb24gRm9vKCkge1xuICAgICAqICAgdGhpcy5hID0gMTtcbiAgICAgKiAgIHRoaXMuYiA9IDI7XG4gICAgICogfVxuICAgICAqXG4gICAgICogRm9vLnByb3RvdHlwZS5jID0gMztcbiAgICAgKlxuICAgICAqIF8uZm9ySW4obmV3IEZvbywgZnVuY3Rpb24odmFsdWUsIGtleSkge1xuICAgICAqICAgY29uc29sZS5sb2coa2V5KTtcbiAgICAgKiB9KTtcbiAgICAgKiAvLyA9PiBMb2dzICdhJywgJ2InLCB0aGVuICdjJyAoaXRlcmF0aW9uIG9yZGVyIGlzIG5vdCBndWFyYW50ZWVkKS5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBmb3JJbihvYmplY3QsIGl0ZXJhdGVlKSB7XG4gICAgICByZXR1cm4gb2JqZWN0ID09IG51bGxcbiAgICAgICAgPyBvYmplY3RcbiAgICAgICAgOiBiYXNlRm9yKG9iamVjdCwgZ2V0SXRlcmF0ZWUoaXRlcmF0ZWUsIDMpLCBrZXlzSW4pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoaXMgbWV0aG9kIGlzIGxpa2UgYF8uZm9ySW5gIGV4Y2VwdCB0aGF0IGl0IGl0ZXJhdGVzIG92ZXIgcHJvcGVydGllcyBvZlxuICAgICAqIGBvYmplY3RgIGluIHRoZSBvcHBvc2l0ZSBvcmRlci5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAyLjAuMFxuICAgICAqIEBjYXRlZ29yeSBPYmplY3RcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8gaXRlcmF0ZSBvdmVyLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtpdGVyYXRlZT1fLmlkZW50aXR5XSBUaGUgZnVuY3Rpb24gaW52b2tlZCBwZXIgaXRlcmF0aW9uLlxuICAgICAqIEByZXR1cm5zIHtPYmplY3R9IFJldHVybnMgYG9iamVjdGAuXG4gICAgICogQHNlZSBfLmZvckluXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIGZ1bmN0aW9uIEZvbygpIHtcbiAgICAgKiAgIHRoaXMuYSA9IDE7XG4gICAgICogICB0aGlzLmIgPSAyO1xuICAgICAqIH1cbiAgICAgKlxuICAgICAqIEZvby5wcm90b3R5cGUuYyA9IDM7XG4gICAgICpcbiAgICAgKiBfLmZvckluUmlnaHQobmV3IEZvbywgZnVuY3Rpb24odmFsdWUsIGtleSkge1xuICAgICAqICAgY29uc29sZS5sb2coa2V5KTtcbiAgICAgKiB9KTtcbiAgICAgKiAvLyA9PiBMb2dzICdjJywgJ2InLCB0aGVuICdhJyBhc3N1bWluZyBgXy5mb3JJbmAgbG9ncyAnYScsICdiJywgdGhlbiAnYycuXG4gICAgICovXG4gICAgZnVuY3Rpb24gZm9ySW5SaWdodChvYmplY3QsIGl0ZXJhdGVlKSB7XG4gICAgICByZXR1cm4gb2JqZWN0ID09IG51bGxcbiAgICAgICAgPyBvYmplY3RcbiAgICAgICAgOiBiYXNlRm9yUmlnaHQob2JqZWN0LCBnZXRJdGVyYXRlZShpdGVyYXRlZSwgMyksIGtleXNJbik7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSXRlcmF0ZXMgb3ZlciBvd24gZW51bWVyYWJsZSBzdHJpbmcga2V5ZWQgcHJvcGVydGllcyBvZiBhbiBvYmplY3QgYW5kXG4gICAgICogaW52b2tlcyBgaXRlcmF0ZWVgIGZvciBlYWNoIHByb3BlcnR5LiBUaGUgaXRlcmF0ZWUgaXMgaW52b2tlZCB3aXRoIHRocmVlXG4gICAgICogYXJndW1lbnRzOiAodmFsdWUsIGtleSwgb2JqZWN0KS4gSXRlcmF0ZWUgZnVuY3Rpb25zIG1heSBleGl0IGl0ZXJhdGlvblxuICAgICAqIGVhcmx5IGJ5IGV4cGxpY2l0bHkgcmV0dXJuaW5nIGBmYWxzZWAuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMC4zLjBcbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0XG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgb2JqZWN0IHRvIGl0ZXJhdGUgb3Zlci5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbaXRlcmF0ZWU9Xy5pZGVudGl0eV0gVGhlIGZ1bmN0aW9uIGludm9rZWQgcGVyIGl0ZXJhdGlvbi5cbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIGBvYmplY3RgLlxuICAgICAqIEBzZWUgXy5mb3JPd25SaWdodFxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBmdW5jdGlvbiBGb28oKSB7XG4gICAgICogICB0aGlzLmEgPSAxO1xuICAgICAqICAgdGhpcy5iID0gMjtcbiAgICAgKiB9XG4gICAgICpcbiAgICAgKiBGb28ucHJvdG90eXBlLmMgPSAzO1xuICAgICAqXG4gICAgICogXy5mb3JPd24obmV3IEZvbywgZnVuY3Rpb24odmFsdWUsIGtleSkge1xuICAgICAqICAgY29uc29sZS5sb2coa2V5KTtcbiAgICAgKiB9KTtcbiAgICAgKiAvLyA9PiBMb2dzICdhJyB0aGVuICdiJyAoaXRlcmF0aW9uIG9yZGVyIGlzIG5vdCBndWFyYW50ZWVkKS5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBmb3JPd24ob2JqZWN0LCBpdGVyYXRlZSkge1xuICAgICAgcmV0dXJuIG9iamVjdCAmJiBiYXNlRm9yT3duKG9iamVjdCwgZ2V0SXRlcmF0ZWUoaXRlcmF0ZWUsIDMpKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGlzIG1ldGhvZCBpcyBsaWtlIGBfLmZvck93bmAgZXhjZXB0IHRoYXQgaXQgaXRlcmF0ZXMgb3ZlciBwcm9wZXJ0aWVzIG9mXG4gICAgICogYG9iamVjdGAgaW4gdGhlIG9wcG9zaXRlIG9yZGVyLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDIuMC4wXG4gICAgICogQGNhdGVnb3J5IE9iamVjdFxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIG9iamVjdCB0byBpdGVyYXRlIG92ZXIuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gW2l0ZXJhdGVlPV8uaWRlbnRpdHldIFRoZSBmdW5jdGlvbiBpbnZva2VkIHBlciBpdGVyYXRpb24uXG4gICAgICogQHJldHVybnMge09iamVjdH0gUmV0dXJucyBgb2JqZWN0YC5cbiAgICAgKiBAc2VlIF8uZm9yT3duXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIGZ1bmN0aW9uIEZvbygpIHtcbiAgICAgKiAgIHRoaXMuYSA9IDE7XG4gICAgICogICB0aGlzLmIgPSAyO1xuICAgICAqIH1cbiAgICAgKlxuICAgICAqIEZvby5wcm90b3R5cGUuYyA9IDM7XG4gICAgICpcbiAgICAgKiBfLmZvck93blJpZ2h0KG5ldyBGb28sIGZ1bmN0aW9uKHZhbHVlLCBrZXkpIHtcbiAgICAgKiAgIGNvbnNvbGUubG9nKGtleSk7XG4gICAgICogfSk7XG4gICAgICogLy8gPT4gTG9ncyAnYicgdGhlbiAnYScgYXNzdW1pbmcgYF8uZm9yT3duYCBsb2dzICdhJyB0aGVuICdiJy5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBmb3JPd25SaWdodChvYmplY3QsIGl0ZXJhdGVlKSB7XG4gICAgICByZXR1cm4gb2JqZWN0ICYmIGJhc2VGb3JPd25SaWdodChvYmplY3QsIGdldEl0ZXJhdGVlKGl0ZXJhdGVlLCAzKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbiBhcnJheSBvZiBmdW5jdGlvbiBwcm9wZXJ0eSBuYW1lcyBmcm9tIG93biBlbnVtZXJhYmxlIHByb3BlcnRpZXNcbiAgICAgKiBvZiBgb2JqZWN0YC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAc2luY2UgMC4xLjBcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBjYXRlZ29yeSBPYmplY3RcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8gaW5zcGVjdC5cbiAgICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgdGhlIGZ1bmN0aW9uIG5hbWVzLlxuICAgICAqIEBzZWUgXy5mdW5jdGlvbnNJblxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBmdW5jdGlvbiBGb28oKSB7XG4gICAgICogICB0aGlzLmEgPSBfLmNvbnN0YW50KCdhJyk7XG4gICAgICogICB0aGlzLmIgPSBfLmNvbnN0YW50KCdiJyk7XG4gICAgICogfVxuICAgICAqXG4gICAgICogRm9vLnByb3RvdHlwZS5jID0gXy5jb25zdGFudCgnYycpO1xuICAgICAqXG4gICAgICogXy5mdW5jdGlvbnMobmV3IEZvbyk7XG4gICAgICogLy8gPT4gWydhJywgJ2InXVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGZ1bmN0aW9ucyhvYmplY3QpIHtcbiAgICAgIHJldHVybiBvYmplY3QgPT0gbnVsbCA/IFtdIDogYmFzZUZ1bmN0aW9ucyhvYmplY3QsIGtleXMob2JqZWN0KSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbiBhcnJheSBvZiBmdW5jdGlvbiBwcm9wZXJ0eSBuYW1lcyBmcm9tIG93biBhbmQgaW5oZXJpdGVkXG4gICAgICogZW51bWVyYWJsZSBwcm9wZXJ0aWVzIG9mIGBvYmplY3RgLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDQuMC4wXG4gICAgICogQGNhdGVnb3J5IE9iamVjdFxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIG9iamVjdCB0byBpbnNwZWN0LlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgZnVuY3Rpb24gbmFtZXMuXG4gICAgICogQHNlZSBfLmZ1bmN0aW9uc1xuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBmdW5jdGlvbiBGb28oKSB7XG4gICAgICogICB0aGlzLmEgPSBfLmNvbnN0YW50KCdhJyk7XG4gICAgICogICB0aGlzLmIgPSBfLmNvbnN0YW50KCdiJyk7XG4gICAgICogfVxuICAgICAqXG4gICAgICogRm9vLnByb3RvdHlwZS5jID0gXy5jb25zdGFudCgnYycpO1xuICAgICAqXG4gICAgICogXy5mdW5jdGlvbnNJbihuZXcgRm9vKTtcbiAgICAgKiAvLyA9PiBbJ2EnLCAnYicsICdjJ11cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBmdW5jdGlvbnNJbihvYmplY3QpIHtcbiAgICAgIHJldHVybiBvYmplY3QgPT0gbnVsbCA/IFtdIDogYmFzZUZ1bmN0aW9ucyhvYmplY3QsIGtleXNJbihvYmplY3QpKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSB2YWx1ZSBhdCBgcGF0aGAgb2YgYG9iamVjdGAuIElmIHRoZSByZXNvbHZlZCB2YWx1ZSBpc1xuICAgICAqIGB1bmRlZmluZWRgLCB0aGUgYGRlZmF1bHRWYWx1ZWAgaXMgcmV0dXJuZWQgaW4gaXRzIHBsYWNlLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDMuNy4wXG4gICAgICogQGNhdGVnb3J5IE9iamVjdFxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIG9iamVjdCB0byBxdWVyeS5cbiAgICAgKiBAcGFyYW0ge0FycmF5fHN0cmluZ30gcGF0aCBUaGUgcGF0aCBvZiB0aGUgcHJvcGVydHkgdG8gZ2V0LlxuICAgICAqIEBwYXJhbSB7Kn0gW2RlZmF1bHRWYWx1ZV0gVGhlIHZhbHVlIHJldHVybmVkIGZvciBgdW5kZWZpbmVkYCByZXNvbHZlZCB2YWx1ZXMuXG4gICAgICogQHJldHVybnMgeyp9IFJldHVybnMgdGhlIHJlc29sdmVkIHZhbHVlLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiB2YXIgb2JqZWN0ID0geyAnYSc6IFt7ICdiJzogeyAnYyc6IDMgfSB9XSB9O1xuICAgICAqXG4gICAgICogXy5nZXQob2JqZWN0LCAnYVswXS5iLmMnKTtcbiAgICAgKiAvLyA9PiAzXG4gICAgICpcbiAgICAgKiBfLmdldChvYmplY3QsIFsnYScsICcwJywgJ2InLCAnYyddKTtcbiAgICAgKiAvLyA9PiAzXG4gICAgICpcbiAgICAgKiBfLmdldChvYmplY3QsICdhLmIuYycsICdkZWZhdWx0Jyk7XG4gICAgICogLy8gPT4gJ2RlZmF1bHQnXG4gICAgICovXG4gICAgZnVuY3Rpb24gZ2V0KG9iamVjdCwgcGF0aCwgZGVmYXVsdFZhbHVlKSB7XG4gICAgICB2YXIgcmVzdWx0ID0gb2JqZWN0ID09IG51bGwgPyB1bmRlZmluZWQgOiBiYXNlR2V0KG9iamVjdCwgcGF0aCk7XG4gICAgICByZXR1cm4gcmVzdWx0ID09PSB1bmRlZmluZWQgPyBkZWZhdWx0VmFsdWUgOiByZXN1bHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2tzIGlmIGBwYXRoYCBpcyBhIGRpcmVjdCBwcm9wZXJ0eSBvZiBgb2JqZWN0YC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAc2luY2UgMC4xLjBcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBjYXRlZ29yeSBPYmplY3RcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8gcXVlcnkuXG4gICAgICogQHBhcmFtIHtBcnJheXxzdHJpbmd9IHBhdGggVGhlIHBhdGggdG8gY2hlY2suXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGBwYXRoYCBleGlzdHMsIGVsc2UgYGZhbHNlYC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogdmFyIG9iamVjdCA9IHsgJ2EnOiB7ICdiJzogMiB9IH07XG4gICAgICogdmFyIG90aGVyID0gXy5jcmVhdGUoeyAnYSc6IF8uY3JlYXRlKHsgJ2InOiAyIH0pIH0pO1xuICAgICAqXG4gICAgICogXy5oYXMob2JqZWN0LCAnYScpO1xuICAgICAqIC8vID0+IHRydWVcbiAgICAgKlxuICAgICAqIF8uaGFzKG9iamVjdCwgJ2EuYicpO1xuICAgICAqIC8vID0+IHRydWVcbiAgICAgKlxuICAgICAqIF8uaGFzKG9iamVjdCwgWydhJywgJ2InXSk7XG4gICAgICogLy8gPT4gdHJ1ZVxuICAgICAqXG4gICAgICogXy5oYXMob3RoZXIsICdhJyk7XG4gICAgICogLy8gPT4gZmFsc2VcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBoYXMob2JqZWN0LCBwYXRoKSB7XG4gICAgICByZXR1cm4gb2JqZWN0ICE9IG51bGwgJiYgaGFzUGF0aChvYmplY3QsIHBhdGgsIGJhc2VIYXMpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENoZWNrcyBpZiBgcGF0aGAgaXMgYSBkaXJlY3Qgb3IgaW5oZXJpdGVkIHByb3BlcnR5IG9mIGBvYmplY3RgLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDQuMC4wXG4gICAgICogQGNhdGVnb3J5IE9iamVjdFxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIG9iamVjdCB0byBxdWVyeS5cbiAgICAgKiBAcGFyYW0ge0FycmF5fHN0cmluZ30gcGF0aCBUaGUgcGF0aCB0byBjaGVjay5cbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYHBhdGhgIGV4aXN0cywgZWxzZSBgZmFsc2VgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiB2YXIgb2JqZWN0ID0gXy5jcmVhdGUoeyAnYSc6IF8uY3JlYXRlKHsgJ2InOiAyIH0pIH0pO1xuICAgICAqXG4gICAgICogXy5oYXNJbihvYmplY3QsICdhJyk7XG4gICAgICogLy8gPT4gdHJ1ZVxuICAgICAqXG4gICAgICogXy5oYXNJbihvYmplY3QsICdhLmInKTtcbiAgICAgKiAvLyA9PiB0cnVlXG4gICAgICpcbiAgICAgKiBfLmhhc0luKG9iamVjdCwgWydhJywgJ2InXSk7XG4gICAgICogLy8gPT4gdHJ1ZVxuICAgICAqXG4gICAgICogXy5oYXNJbihvYmplY3QsICdiJyk7XG4gICAgICogLy8gPT4gZmFsc2VcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBoYXNJbihvYmplY3QsIHBhdGgpIHtcbiAgICAgIHJldHVybiBvYmplY3QgIT0gbnVsbCAmJiBoYXNQYXRoKG9iamVjdCwgcGF0aCwgYmFzZUhhc0luKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuIG9iamVjdCBjb21wb3NlZCBvZiB0aGUgaW52ZXJ0ZWQga2V5cyBhbmQgdmFsdWVzIG9mIGBvYmplY3RgLlxuICAgICAqIElmIGBvYmplY3RgIGNvbnRhaW5zIGR1cGxpY2F0ZSB2YWx1ZXMsIHN1YnNlcXVlbnQgdmFsdWVzIG92ZXJ3cml0ZVxuICAgICAqIHByb3BlcnR5IGFzc2lnbm1lbnRzIG9mIHByZXZpb3VzIHZhbHVlcy5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAwLjcuMFxuICAgICAqIEBjYXRlZ29yeSBPYmplY3RcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8gaW52ZXJ0LlxuICAgICAqIEByZXR1cm5zIHtPYmplY3R9IFJldHVybnMgdGhlIG5ldyBpbnZlcnRlZCBvYmplY3QuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciBvYmplY3QgPSB7ICdhJzogMSwgJ2InOiAyLCAnYyc6IDEgfTtcbiAgICAgKlxuICAgICAqIF8uaW52ZXJ0KG9iamVjdCk7XG4gICAgICogLy8gPT4geyAnMSc6ICdjJywgJzInOiAnYicgfVxuICAgICAqL1xuICAgIHZhciBpbnZlcnQgPSBjcmVhdGVJbnZlcnRlcihmdW5jdGlvbihyZXN1bHQsIHZhbHVlLCBrZXkpIHtcbiAgICAgIGlmICh2YWx1ZSAhPSBudWxsICYmXG4gICAgICAgICAgdHlwZW9mIHZhbHVlLnRvU3RyaW5nICE9ICdmdW5jdGlvbicpIHtcbiAgICAgICAgdmFsdWUgPSBuYXRpdmVPYmplY3RUb1N0cmluZy5jYWxsKHZhbHVlKTtcbiAgICAgIH1cblxuICAgICAgcmVzdWx0W3ZhbHVlXSA9IGtleTtcbiAgICB9LCBjb25zdGFudChpZGVudGl0eSkpO1xuXG4gICAgLyoqXG4gICAgICogVGhpcyBtZXRob2QgaXMgbGlrZSBgXy5pbnZlcnRgIGV4Y2VwdCB0aGF0IHRoZSBpbnZlcnRlZCBvYmplY3QgaXMgZ2VuZXJhdGVkXG4gICAgICogZnJvbSB0aGUgcmVzdWx0cyBvZiBydW5uaW5nIGVhY2ggZWxlbWVudCBvZiBgb2JqZWN0YCB0aHJ1IGBpdGVyYXRlZWAuIFRoZVxuICAgICAqIGNvcnJlc3BvbmRpbmcgaW52ZXJ0ZWQgdmFsdWUgb2YgZWFjaCBpbnZlcnRlZCBrZXkgaXMgYW4gYXJyYXkgb2Yga2V5c1xuICAgICAqIHJlc3BvbnNpYmxlIGZvciBnZW5lcmF0aW5nIHRoZSBpbnZlcnRlZCB2YWx1ZS4gVGhlIGl0ZXJhdGVlIGlzIGludm9rZWRcbiAgICAgKiB3aXRoIG9uZSBhcmd1bWVudDogKHZhbHVlKS5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSA0LjEuMFxuICAgICAqIEBjYXRlZ29yeSBPYmplY3RcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8gaW52ZXJ0LlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtpdGVyYXRlZT1fLmlkZW50aXR5XSBUaGUgaXRlcmF0ZWUgaW52b2tlZCBwZXIgZWxlbWVudC5cbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIHRoZSBuZXcgaW52ZXJ0ZWQgb2JqZWN0LlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiB2YXIgb2JqZWN0ID0geyAnYSc6IDEsICdiJzogMiwgJ2MnOiAxIH07XG4gICAgICpcbiAgICAgKiBfLmludmVydEJ5KG9iamVjdCk7XG4gICAgICogLy8gPT4geyAnMSc6IFsnYScsICdjJ10sICcyJzogWydiJ10gfVxuICAgICAqXG4gICAgICogXy5pbnZlcnRCeShvYmplY3QsIGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICogICByZXR1cm4gJ2dyb3VwJyArIHZhbHVlO1xuICAgICAqIH0pO1xuICAgICAqIC8vID0+IHsgJ2dyb3VwMSc6IFsnYScsICdjJ10sICdncm91cDInOiBbJ2InXSB9XG4gICAgICovXG4gICAgdmFyIGludmVydEJ5ID0gY3JlYXRlSW52ZXJ0ZXIoZnVuY3Rpb24ocmVzdWx0LCB2YWx1ZSwga2V5KSB7XG4gICAgICBpZiAodmFsdWUgIT0gbnVsbCAmJlxuICAgICAgICAgIHR5cGVvZiB2YWx1ZS50b1N0cmluZyAhPSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHZhbHVlID0gbmF0aXZlT2JqZWN0VG9TdHJpbmcuY2FsbCh2YWx1ZSk7XG4gICAgICB9XG5cbiAgICAgIGlmIChoYXNPd25Qcm9wZXJ0eS5jYWxsKHJlc3VsdCwgdmFsdWUpKSB7XG4gICAgICAgIHJlc3VsdFt2YWx1ZV0ucHVzaChrZXkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVzdWx0W3ZhbHVlXSA9IFtrZXldO1xuICAgICAgfVxuICAgIH0sIGdldEl0ZXJhdGVlKTtcblxuICAgIC8qKlxuICAgICAqIEludm9rZXMgdGhlIG1ldGhvZCBhdCBgcGF0aGAgb2YgYG9iamVjdGAuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgNC4wLjBcbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0XG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgb2JqZWN0IHRvIHF1ZXJ5LlxuICAgICAqIEBwYXJhbSB7QXJyYXl8c3RyaW5nfSBwYXRoIFRoZSBwYXRoIG9mIHRoZSBtZXRob2QgdG8gaW52b2tlLlxuICAgICAqIEBwYXJhbSB7Li4uKn0gW2FyZ3NdIFRoZSBhcmd1bWVudHMgdG8gaW52b2tlIHRoZSBtZXRob2Qgd2l0aC5cbiAgICAgKiBAcmV0dXJucyB7Kn0gUmV0dXJucyB0aGUgcmVzdWx0IG9mIHRoZSBpbnZva2VkIG1ldGhvZC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogdmFyIG9iamVjdCA9IHsgJ2EnOiBbeyAnYic6IHsgJ2MnOiBbMSwgMiwgMywgNF0gfSB9XSB9O1xuICAgICAqXG4gICAgICogXy5pbnZva2Uob2JqZWN0LCAnYVswXS5iLmMuc2xpY2UnLCAxLCAzKTtcbiAgICAgKiAvLyA9PiBbMiwgM11cbiAgICAgKi9cbiAgICB2YXIgaW52b2tlID0gYmFzZVJlc3QoYmFzZUludm9rZSk7XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuIGFycmF5IG9mIHRoZSBvd24gZW51bWVyYWJsZSBwcm9wZXJ0eSBuYW1lcyBvZiBgb2JqZWN0YC5cbiAgICAgKlxuICAgICAqICoqTm90ZToqKiBOb24tb2JqZWN0IHZhbHVlcyBhcmUgY29lcmNlZCB0byBvYmplY3RzLiBTZWUgdGhlXG4gICAgICogW0VTIHNwZWNdKGh0dHA6Ly9lY21hLWludGVybmF0aW9uYWwub3JnL2VjbWEtMjYyLzcuMC8jc2VjLW9iamVjdC5rZXlzKVxuICAgICAqIGZvciBtb3JlIGRldGFpbHMuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQHNpbmNlIDAuMS4wXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0XG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgb2JqZWN0IHRvIHF1ZXJ5LlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgYXJyYXkgb2YgcHJvcGVydHkgbmFtZXMuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIGZ1bmN0aW9uIEZvbygpIHtcbiAgICAgKiAgIHRoaXMuYSA9IDE7XG4gICAgICogICB0aGlzLmIgPSAyO1xuICAgICAqIH1cbiAgICAgKlxuICAgICAqIEZvby5wcm90b3R5cGUuYyA9IDM7XG4gICAgICpcbiAgICAgKiBfLmtleXMobmV3IEZvbyk7XG4gICAgICogLy8gPT4gWydhJywgJ2InXSAoaXRlcmF0aW9uIG9yZGVyIGlzIG5vdCBndWFyYW50ZWVkKVxuICAgICAqXG4gICAgICogXy5rZXlzKCdoaScpO1xuICAgICAqIC8vID0+IFsnMCcsICcxJ11cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBrZXlzKG9iamVjdCkge1xuICAgICAgcmV0dXJuIGlzQXJyYXlMaWtlKG9iamVjdCkgPyBhcnJheUxpa2VLZXlzKG9iamVjdCkgOiBiYXNlS2V5cyhvYmplY3QpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW4gYXJyYXkgb2YgdGhlIG93biBhbmQgaW5oZXJpdGVkIGVudW1lcmFibGUgcHJvcGVydHkgbmFtZXMgb2YgYG9iamVjdGAuXG4gICAgICpcbiAgICAgKiAqKk5vdGU6KiogTm9uLW9iamVjdCB2YWx1ZXMgYXJlIGNvZXJjZWQgdG8gb2JqZWN0cy5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAzLjAuMFxuICAgICAqIEBjYXRlZ29yeSBPYmplY3RcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8gcXVlcnkuXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIHRoZSBhcnJheSBvZiBwcm9wZXJ0eSBuYW1lcy5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogZnVuY3Rpb24gRm9vKCkge1xuICAgICAqICAgdGhpcy5hID0gMTtcbiAgICAgKiAgIHRoaXMuYiA9IDI7XG4gICAgICogfVxuICAgICAqXG4gICAgICogRm9vLnByb3RvdHlwZS5jID0gMztcbiAgICAgKlxuICAgICAqIF8ua2V5c0luKG5ldyBGb28pO1xuICAgICAqIC8vID0+IFsnYScsICdiJywgJ2MnXSAoaXRlcmF0aW9uIG9yZGVyIGlzIG5vdCBndWFyYW50ZWVkKVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGtleXNJbihvYmplY3QpIHtcbiAgICAgIHJldHVybiBpc0FycmF5TGlrZShvYmplY3QpID8gYXJyYXlMaWtlS2V5cyhvYmplY3QsIHRydWUpIDogYmFzZUtleXNJbihvYmplY3QpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBvcHBvc2l0ZSBvZiBgXy5tYXBWYWx1ZXNgOyB0aGlzIG1ldGhvZCBjcmVhdGVzIGFuIG9iamVjdCB3aXRoIHRoZVxuICAgICAqIHNhbWUgdmFsdWVzIGFzIGBvYmplY3RgIGFuZCBrZXlzIGdlbmVyYXRlZCBieSBydW5uaW5nIGVhY2ggb3duIGVudW1lcmFibGVcbiAgICAgKiBzdHJpbmcga2V5ZWQgcHJvcGVydHkgb2YgYG9iamVjdGAgdGhydSBgaXRlcmF0ZWVgLiBUaGUgaXRlcmF0ZWUgaXMgaW52b2tlZFxuICAgICAqIHdpdGggdGhyZWUgYXJndW1lbnRzOiAodmFsdWUsIGtleSwgb2JqZWN0KS5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAzLjguMFxuICAgICAqIEBjYXRlZ29yeSBPYmplY3RcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8gaXRlcmF0ZSBvdmVyLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtpdGVyYXRlZT1fLmlkZW50aXR5XSBUaGUgZnVuY3Rpb24gaW52b2tlZCBwZXIgaXRlcmF0aW9uLlxuICAgICAqIEByZXR1cm5zIHtPYmplY3R9IFJldHVybnMgdGhlIG5ldyBtYXBwZWQgb2JqZWN0LlxuICAgICAqIEBzZWUgXy5tYXBWYWx1ZXNcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5tYXBLZXlzKHsgJ2EnOiAxLCAnYic6IDIgfSwgZnVuY3Rpb24odmFsdWUsIGtleSkge1xuICAgICAqICAgcmV0dXJuIGtleSArIHZhbHVlO1xuICAgICAqIH0pO1xuICAgICAqIC8vID0+IHsgJ2ExJzogMSwgJ2IyJzogMiB9XG4gICAgICovXG4gICAgZnVuY3Rpb24gbWFwS2V5cyhvYmplY3QsIGl0ZXJhdGVlKSB7XG4gICAgICB2YXIgcmVzdWx0ID0ge307XG4gICAgICBpdGVyYXRlZSA9IGdldEl0ZXJhdGVlKGl0ZXJhdGVlLCAzKTtcblxuICAgICAgYmFzZUZvck93bihvYmplY3QsIGZ1bmN0aW9uKHZhbHVlLCBrZXksIG9iamVjdCkge1xuICAgICAgICBiYXNlQXNzaWduVmFsdWUocmVzdWx0LCBpdGVyYXRlZSh2YWx1ZSwga2V5LCBvYmplY3QpLCB2YWx1ZSk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbiBvYmplY3Qgd2l0aCB0aGUgc2FtZSBrZXlzIGFzIGBvYmplY3RgIGFuZCB2YWx1ZXMgZ2VuZXJhdGVkXG4gICAgICogYnkgcnVubmluZyBlYWNoIG93biBlbnVtZXJhYmxlIHN0cmluZyBrZXllZCBwcm9wZXJ0eSBvZiBgb2JqZWN0YCB0aHJ1XG4gICAgICogYGl0ZXJhdGVlYC4gVGhlIGl0ZXJhdGVlIGlzIGludm9rZWQgd2l0aCB0aHJlZSBhcmd1bWVudHM6XG4gICAgICogKHZhbHVlLCBrZXksIG9iamVjdCkuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMi40LjBcbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0XG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgb2JqZWN0IHRvIGl0ZXJhdGUgb3Zlci5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbaXRlcmF0ZWU9Xy5pZGVudGl0eV0gVGhlIGZ1bmN0aW9uIGludm9rZWQgcGVyIGl0ZXJhdGlvbi5cbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIHRoZSBuZXcgbWFwcGVkIG9iamVjdC5cbiAgICAgKiBAc2VlIF8ubWFwS2V5c1xuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiB2YXIgdXNlcnMgPSB7XG4gICAgICogICAnZnJlZCc6ICAgIHsgJ3VzZXInOiAnZnJlZCcsICAgICdhZ2UnOiA0MCB9LFxuICAgICAqICAgJ3BlYmJsZXMnOiB7ICd1c2VyJzogJ3BlYmJsZXMnLCAnYWdlJzogMSB9XG4gICAgICogfTtcbiAgICAgKlxuICAgICAqIF8ubWFwVmFsdWVzKHVzZXJzLCBmdW5jdGlvbihvKSB7IHJldHVybiBvLmFnZTsgfSk7XG4gICAgICogLy8gPT4geyAnZnJlZCc6IDQwLCAncGViYmxlcyc6IDEgfSAoaXRlcmF0aW9uIG9yZGVyIGlzIG5vdCBndWFyYW50ZWVkKVxuICAgICAqXG4gICAgICogLy8gVGhlIGBfLnByb3BlcnR5YCBpdGVyYXRlZSBzaG9ydGhhbmQuXG4gICAgICogXy5tYXBWYWx1ZXModXNlcnMsICdhZ2UnKTtcbiAgICAgKiAvLyA9PiB7ICdmcmVkJzogNDAsICdwZWJibGVzJzogMSB9IChpdGVyYXRpb24gb3JkZXIgaXMgbm90IGd1YXJhbnRlZWQpXG4gICAgICovXG4gICAgZnVuY3Rpb24gbWFwVmFsdWVzKG9iamVjdCwgaXRlcmF0ZWUpIHtcbiAgICAgIHZhciByZXN1bHQgPSB7fTtcbiAgICAgIGl0ZXJhdGVlID0gZ2V0SXRlcmF0ZWUoaXRlcmF0ZWUsIDMpO1xuXG4gICAgICBiYXNlRm9yT3duKG9iamVjdCwgZnVuY3Rpb24odmFsdWUsIGtleSwgb2JqZWN0KSB7XG4gICAgICAgIGJhc2VBc3NpZ25WYWx1ZShyZXN1bHQsIGtleSwgaXRlcmF0ZWUodmFsdWUsIGtleSwgb2JqZWN0KSk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhpcyBtZXRob2QgaXMgbGlrZSBgXy5hc3NpZ25gIGV4Y2VwdCB0aGF0IGl0IHJlY3Vyc2l2ZWx5IG1lcmdlcyBvd24gYW5kXG4gICAgICogaW5oZXJpdGVkIGVudW1lcmFibGUgc3RyaW5nIGtleWVkIHByb3BlcnRpZXMgb2Ygc291cmNlIG9iamVjdHMgaW50byB0aGVcbiAgICAgKiBkZXN0aW5hdGlvbiBvYmplY3QuIFNvdXJjZSBwcm9wZXJ0aWVzIHRoYXQgcmVzb2x2ZSB0byBgdW5kZWZpbmVkYCBhcmVcbiAgICAgKiBza2lwcGVkIGlmIGEgZGVzdGluYXRpb24gdmFsdWUgZXhpc3RzLiBBcnJheSBhbmQgcGxhaW4gb2JqZWN0IHByb3BlcnRpZXNcbiAgICAgKiBhcmUgbWVyZ2VkIHJlY3Vyc2l2ZWx5LiBPdGhlciBvYmplY3RzIGFuZCB2YWx1ZSB0eXBlcyBhcmUgb3ZlcnJpZGRlbiBieVxuICAgICAqIGFzc2lnbm1lbnQuIFNvdXJjZSBvYmplY3RzIGFyZSBhcHBsaWVkIGZyb20gbGVmdCB0byByaWdodC4gU3Vic2VxdWVudFxuICAgICAqIHNvdXJjZXMgb3ZlcndyaXRlIHByb3BlcnR5IGFzc2lnbm1lbnRzIG9mIHByZXZpb3VzIHNvdXJjZXMuXG4gICAgICpcbiAgICAgKiAqKk5vdGU6KiogVGhpcyBtZXRob2QgbXV0YXRlcyBgb2JqZWN0YC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAwLjUuMFxuICAgICAqIEBjYXRlZ29yeSBPYmplY3RcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBkZXN0aW5hdGlvbiBvYmplY3QuXG4gICAgICogQHBhcmFtIHsuLi5PYmplY3R9IFtzb3VyY2VzXSBUaGUgc291cmNlIG9iamVjdHMuXG4gICAgICogQHJldHVybnMge09iamVjdH0gUmV0dXJucyBgb2JqZWN0YC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogdmFyIG9iamVjdCA9IHtcbiAgICAgKiAgICdhJzogW3sgJ2InOiAyIH0sIHsgJ2QnOiA0IH1dXG4gICAgICogfTtcbiAgICAgKlxuICAgICAqIHZhciBvdGhlciA9IHtcbiAgICAgKiAgICdhJzogW3sgJ2MnOiAzIH0sIHsgJ2UnOiA1IH1dXG4gICAgICogfTtcbiAgICAgKlxuICAgICAqIF8ubWVyZ2Uob2JqZWN0LCBvdGhlcik7XG4gICAgICogLy8gPT4geyAnYSc6IFt7ICdiJzogMiwgJ2MnOiAzIH0sIHsgJ2QnOiA0LCAnZSc6IDUgfV0gfVxuICAgICAqL1xuICAgIHZhciBtZXJnZSA9IGNyZWF0ZUFzc2lnbmVyKGZ1bmN0aW9uKG9iamVjdCwgc291cmNlLCBzcmNJbmRleCkge1xuICAgICAgYmFzZU1lcmdlKG9iamVjdCwgc291cmNlLCBzcmNJbmRleCk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBUaGlzIG1ldGhvZCBpcyBsaWtlIGBfLm1lcmdlYCBleGNlcHQgdGhhdCBpdCBhY2NlcHRzIGBjdXN0b21pemVyYCB3aGljaFxuICAgICAqIGlzIGludm9rZWQgdG8gcHJvZHVjZSB0aGUgbWVyZ2VkIHZhbHVlcyBvZiB0aGUgZGVzdGluYXRpb24gYW5kIHNvdXJjZVxuICAgICAqIHByb3BlcnRpZXMuIElmIGBjdXN0b21pemVyYCByZXR1cm5zIGB1bmRlZmluZWRgLCBtZXJnaW5nIGlzIGhhbmRsZWQgYnkgdGhlXG4gICAgICogbWV0aG9kIGluc3RlYWQuIFRoZSBgY3VzdG9taXplcmAgaXMgaW52b2tlZCB3aXRoIHNpeCBhcmd1bWVudHM6XG4gICAgICogKG9ialZhbHVlLCBzcmNWYWx1ZSwga2V5LCBvYmplY3QsIHNvdXJjZSwgc3RhY2spLlxuICAgICAqXG4gICAgICogKipOb3RlOioqIFRoaXMgbWV0aG9kIG11dGF0ZXMgYG9iamVjdGAuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgNC4wLjBcbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0XG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgZGVzdGluYXRpb24gb2JqZWN0LlxuICAgICAqIEBwYXJhbSB7Li4uT2JqZWN0fSBzb3VyY2VzIFRoZSBzb3VyY2Ugb2JqZWN0cy5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjdXN0b21pemVyIFRoZSBmdW5jdGlvbiB0byBjdXN0b21pemUgYXNzaWduZWQgdmFsdWVzLlxuICAgICAqIEByZXR1cm5zIHtPYmplY3R9IFJldHVybnMgYG9iamVjdGAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIGZ1bmN0aW9uIGN1c3RvbWl6ZXIob2JqVmFsdWUsIHNyY1ZhbHVlKSB7XG4gICAgICogICBpZiAoXy5pc0FycmF5KG9ialZhbHVlKSkge1xuICAgICAqICAgICByZXR1cm4gb2JqVmFsdWUuY29uY2F0KHNyY1ZhbHVlKTtcbiAgICAgKiAgIH1cbiAgICAgKiB9XG4gICAgICpcbiAgICAgKiB2YXIgb2JqZWN0ID0geyAnYSc6IFsxXSwgJ2InOiBbMl0gfTtcbiAgICAgKiB2YXIgb3RoZXIgPSB7ICdhJzogWzNdLCAnYic6IFs0XSB9O1xuICAgICAqXG4gICAgICogXy5tZXJnZVdpdGgob2JqZWN0LCBvdGhlciwgY3VzdG9taXplcik7XG4gICAgICogLy8gPT4geyAnYSc6IFsxLCAzXSwgJ2InOiBbMiwgNF0gfVxuICAgICAqL1xuICAgIHZhciBtZXJnZVdpdGggPSBjcmVhdGVBc3NpZ25lcihmdW5jdGlvbihvYmplY3QsIHNvdXJjZSwgc3JjSW5kZXgsIGN1c3RvbWl6ZXIpIHtcbiAgICAgIGJhc2VNZXJnZShvYmplY3QsIHNvdXJjZSwgc3JjSW5kZXgsIGN1c3RvbWl6ZXIpO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogVGhlIG9wcG9zaXRlIG9mIGBfLnBpY2tgOyB0aGlzIG1ldGhvZCBjcmVhdGVzIGFuIG9iamVjdCBjb21wb3NlZCBvZiB0aGVcbiAgICAgKiBvd24gYW5kIGluaGVyaXRlZCBlbnVtZXJhYmxlIHByb3BlcnR5IHBhdGhzIG9mIGBvYmplY3RgIHRoYXQgYXJlIG5vdCBvbWl0dGVkLlxuICAgICAqXG4gICAgICogKipOb3RlOioqIFRoaXMgbWV0aG9kIGlzIGNvbnNpZGVyYWJseSBzbG93ZXIgdGhhbiBgXy5waWNrYC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAc2luY2UgMC4xLjBcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBjYXRlZ29yeSBPYmplY3RcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBzb3VyY2Ugb2JqZWN0LlxuICAgICAqIEBwYXJhbSB7Li4uKHN0cmluZ3xzdHJpbmdbXSl9IFtwYXRoc10gVGhlIHByb3BlcnR5IHBhdGhzIHRvIG9taXQuXG4gICAgICogQHJldHVybnMge09iamVjdH0gUmV0dXJucyB0aGUgbmV3IG9iamVjdC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogdmFyIG9iamVjdCA9IHsgJ2EnOiAxLCAnYic6ICcyJywgJ2MnOiAzIH07XG4gICAgICpcbiAgICAgKiBfLm9taXQob2JqZWN0LCBbJ2EnLCAnYyddKTtcbiAgICAgKiAvLyA9PiB7ICdiJzogJzInIH1cbiAgICAgKi9cbiAgICB2YXIgb21pdCA9IGZsYXRSZXN0KGZ1bmN0aW9uKG9iamVjdCwgcGF0aHMpIHtcbiAgICAgIHZhciByZXN1bHQgPSB7fTtcbiAgICAgIGlmIChvYmplY3QgPT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgfVxuICAgICAgdmFyIGlzRGVlcCA9IGZhbHNlO1xuICAgICAgcGF0aHMgPSBhcnJheU1hcChwYXRocywgZnVuY3Rpb24ocGF0aCkge1xuICAgICAgICBwYXRoID0gY2FzdFBhdGgocGF0aCwgb2JqZWN0KTtcbiAgICAgICAgaXNEZWVwIHx8IChpc0RlZXAgPSBwYXRoLmxlbmd0aCA+IDEpO1xuICAgICAgICByZXR1cm4gcGF0aDtcbiAgICAgIH0pO1xuICAgICAgY29weU9iamVjdChvYmplY3QsIGdldEFsbEtleXNJbihvYmplY3QpLCByZXN1bHQpO1xuICAgICAgaWYgKGlzRGVlcCkge1xuICAgICAgICByZXN1bHQgPSBiYXNlQ2xvbmUocmVzdWx0LCBDTE9ORV9ERUVQX0ZMQUcgfCBDTE9ORV9GTEFUX0ZMQUcgfCBDTE9ORV9TWU1CT0xTX0ZMQUcsIGN1c3RvbU9taXRDbG9uZSk7XG4gICAgICB9XG4gICAgICB2YXIgbGVuZ3RoID0gcGF0aHMubGVuZ3RoO1xuICAgICAgd2hpbGUgKGxlbmd0aC0tKSB7XG4gICAgICAgIGJhc2VVbnNldChyZXN1bHQsIHBhdGhzW2xlbmd0aF0pO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFRoZSBvcHBvc2l0ZSBvZiBgXy5waWNrQnlgOyB0aGlzIG1ldGhvZCBjcmVhdGVzIGFuIG9iamVjdCBjb21wb3NlZCBvZlxuICAgICAqIHRoZSBvd24gYW5kIGluaGVyaXRlZCBlbnVtZXJhYmxlIHN0cmluZyBrZXllZCBwcm9wZXJ0aWVzIG9mIGBvYmplY3RgIHRoYXRcbiAgICAgKiBgcHJlZGljYXRlYCBkb2Vzbid0IHJldHVybiB0cnV0aHkgZm9yLiBUaGUgcHJlZGljYXRlIGlzIGludm9rZWQgd2l0aCB0d29cbiAgICAgKiBhcmd1bWVudHM6ICh2YWx1ZSwga2V5KS5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSA0LjAuMFxuICAgICAqIEBjYXRlZ29yeSBPYmplY3RcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBzb3VyY2Ugb2JqZWN0LlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtwcmVkaWNhdGU9Xy5pZGVudGl0eV0gVGhlIGZ1bmN0aW9uIGludm9rZWQgcGVyIHByb3BlcnR5LlxuICAgICAqIEByZXR1cm5zIHtPYmplY3R9IFJldHVybnMgdGhlIG5ldyBvYmplY3QuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciBvYmplY3QgPSB7ICdhJzogMSwgJ2InOiAnMicsICdjJzogMyB9O1xuICAgICAqXG4gICAgICogXy5vbWl0Qnkob2JqZWN0LCBfLmlzTnVtYmVyKTtcbiAgICAgKiAvLyA9PiB7ICdiJzogJzInIH1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBvbWl0Qnkob2JqZWN0LCBwcmVkaWNhdGUpIHtcbiAgICAgIHJldHVybiBwaWNrQnkob2JqZWN0LCBuZWdhdGUoZ2V0SXRlcmF0ZWUocHJlZGljYXRlKSkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW4gb2JqZWN0IGNvbXBvc2VkIG9mIHRoZSBwaWNrZWQgYG9iamVjdGAgcHJvcGVydGllcy5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAc2luY2UgMC4xLjBcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBjYXRlZ29yeSBPYmplY3RcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBzb3VyY2Ugb2JqZWN0LlxuICAgICAqIEBwYXJhbSB7Li4uKHN0cmluZ3xzdHJpbmdbXSl9IFtwYXRoc10gVGhlIHByb3BlcnR5IHBhdGhzIHRvIHBpY2suXG4gICAgICogQHJldHVybnMge09iamVjdH0gUmV0dXJucyB0aGUgbmV3IG9iamVjdC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogdmFyIG9iamVjdCA9IHsgJ2EnOiAxLCAnYic6ICcyJywgJ2MnOiAzIH07XG4gICAgICpcbiAgICAgKiBfLnBpY2sob2JqZWN0LCBbJ2EnLCAnYyddKTtcbiAgICAgKiAvLyA9PiB7ICdhJzogMSwgJ2MnOiAzIH1cbiAgICAgKi9cbiAgICB2YXIgcGljayA9IGZsYXRSZXN0KGZ1bmN0aW9uKG9iamVjdCwgcGF0aHMpIHtcbiAgICAgIHJldHVybiBvYmplY3QgPT0gbnVsbCA/IHt9IDogYmFzZVBpY2sob2JqZWN0LCBwYXRocyk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuIG9iamVjdCBjb21wb3NlZCBvZiB0aGUgYG9iamVjdGAgcHJvcGVydGllcyBgcHJlZGljYXRlYCByZXR1cm5zXG4gICAgICogdHJ1dGh5IGZvci4gVGhlIHByZWRpY2F0ZSBpcyBpbnZva2VkIHdpdGggdHdvIGFyZ3VtZW50czogKHZhbHVlLCBrZXkpLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDQuMC4wXG4gICAgICogQGNhdGVnb3J5IE9iamVjdFxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIHNvdXJjZSBvYmplY3QuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gW3ByZWRpY2F0ZT1fLmlkZW50aXR5XSBUaGUgZnVuY3Rpb24gaW52b2tlZCBwZXIgcHJvcGVydHkuXG4gICAgICogQHJldHVybnMge09iamVjdH0gUmV0dXJucyB0aGUgbmV3IG9iamVjdC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogdmFyIG9iamVjdCA9IHsgJ2EnOiAxLCAnYic6ICcyJywgJ2MnOiAzIH07XG4gICAgICpcbiAgICAgKiBfLnBpY2tCeShvYmplY3QsIF8uaXNOdW1iZXIpO1xuICAgICAqIC8vID0+IHsgJ2EnOiAxLCAnYyc6IDMgfVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHBpY2tCeShvYmplY3QsIHByZWRpY2F0ZSkge1xuICAgICAgaWYgKG9iamVjdCA9PSBudWxsKSB7XG4gICAgICAgIHJldHVybiB7fTtcbiAgICAgIH1cbiAgICAgIHZhciBwcm9wcyA9IGFycmF5TWFwKGdldEFsbEtleXNJbihvYmplY3QpLCBmdW5jdGlvbihwcm9wKSB7XG4gICAgICAgIHJldHVybiBbcHJvcF07XG4gICAgICB9KTtcbiAgICAgIHByZWRpY2F0ZSA9IGdldEl0ZXJhdGVlKHByZWRpY2F0ZSk7XG4gICAgICByZXR1cm4gYmFzZVBpY2tCeShvYmplY3QsIHByb3BzLCBmdW5jdGlvbih2YWx1ZSwgcGF0aCkge1xuICAgICAgICByZXR1cm4gcHJlZGljYXRlKHZhbHVlLCBwYXRoWzBdKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoaXMgbWV0aG9kIGlzIGxpa2UgYF8uZ2V0YCBleGNlcHQgdGhhdCBpZiB0aGUgcmVzb2x2ZWQgdmFsdWUgaXMgYVxuICAgICAqIGZ1bmN0aW9uIGl0J3MgaW52b2tlZCB3aXRoIHRoZSBgdGhpc2AgYmluZGluZyBvZiBpdHMgcGFyZW50IG9iamVjdCBhbmRcbiAgICAgKiBpdHMgcmVzdWx0IGlzIHJldHVybmVkLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBzaW5jZSAwLjEuMFxuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQGNhdGVnb3J5IE9iamVjdFxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIG9iamVjdCB0byBxdWVyeS5cbiAgICAgKiBAcGFyYW0ge0FycmF5fHN0cmluZ30gcGF0aCBUaGUgcGF0aCBvZiB0aGUgcHJvcGVydHkgdG8gcmVzb2x2ZS5cbiAgICAgKiBAcGFyYW0geyp9IFtkZWZhdWx0VmFsdWVdIFRoZSB2YWx1ZSByZXR1cm5lZCBmb3IgYHVuZGVmaW5lZGAgcmVzb2x2ZWQgdmFsdWVzLlxuICAgICAqIEByZXR1cm5zIHsqfSBSZXR1cm5zIHRoZSByZXNvbHZlZCB2YWx1ZS5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogdmFyIG9iamVjdCA9IHsgJ2EnOiBbeyAnYic6IHsgJ2MxJzogMywgJ2MyJzogXy5jb25zdGFudCg0KSB9IH1dIH07XG4gICAgICpcbiAgICAgKiBfLnJlc3VsdChvYmplY3QsICdhWzBdLmIuYzEnKTtcbiAgICAgKiAvLyA9PiAzXG4gICAgICpcbiAgICAgKiBfLnJlc3VsdChvYmplY3QsICdhWzBdLmIuYzInKTtcbiAgICAgKiAvLyA9PiA0XG4gICAgICpcbiAgICAgKiBfLnJlc3VsdChvYmplY3QsICdhWzBdLmIuYzMnLCAnZGVmYXVsdCcpO1xuICAgICAqIC8vID0+ICdkZWZhdWx0J1xuICAgICAqXG4gICAgICogXy5yZXN1bHQob2JqZWN0LCAnYVswXS5iLmMzJywgXy5jb25zdGFudCgnZGVmYXVsdCcpKTtcbiAgICAgKiAvLyA9PiAnZGVmYXVsdCdcbiAgICAgKi9cbiAgICBmdW5jdGlvbiByZXN1bHQob2JqZWN0LCBwYXRoLCBkZWZhdWx0VmFsdWUpIHtcbiAgICAgIHBhdGggPSBjYXN0UGF0aChwYXRoLCBvYmplY3QpO1xuXG4gICAgICB2YXIgaW5kZXggPSAtMSxcbiAgICAgICAgICBsZW5ndGggPSBwYXRoLmxlbmd0aDtcblxuICAgICAgLy8gRW5zdXJlIHRoZSBsb29wIGlzIGVudGVyZWQgd2hlbiBwYXRoIGlzIGVtcHR5LlxuICAgICAgaWYgKCFsZW5ndGgpIHtcbiAgICAgICAgbGVuZ3RoID0gMTtcbiAgICAgICAgb2JqZWN0ID0gdW5kZWZpbmVkO1xuICAgICAgfVxuICAgICAgd2hpbGUgKCsraW5kZXggPCBsZW5ndGgpIHtcbiAgICAgICAgdmFyIHZhbHVlID0gb2JqZWN0ID09IG51bGwgPyB1bmRlZmluZWQgOiBvYmplY3RbdG9LZXkocGF0aFtpbmRleF0pXTtcbiAgICAgICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICBpbmRleCA9IGxlbmd0aDtcbiAgICAgICAgICB2YWx1ZSA9IGRlZmF1bHRWYWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBvYmplY3QgPSBpc0Z1bmN0aW9uKHZhbHVlKSA/IHZhbHVlLmNhbGwob2JqZWN0KSA6IHZhbHVlO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG9iamVjdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXRzIHRoZSB2YWx1ZSBhdCBgcGF0aGAgb2YgYG9iamVjdGAuIElmIGEgcG9ydGlvbiBvZiBgcGF0aGAgZG9lc24ndCBleGlzdCxcbiAgICAgKiBpdCdzIGNyZWF0ZWQuIEFycmF5cyBhcmUgY3JlYXRlZCBmb3IgbWlzc2luZyBpbmRleCBwcm9wZXJ0aWVzIHdoaWxlIG9iamVjdHNcbiAgICAgKiBhcmUgY3JlYXRlZCBmb3IgYWxsIG90aGVyIG1pc3NpbmcgcHJvcGVydGllcy4gVXNlIGBfLnNldFdpdGhgIHRvIGN1c3RvbWl6ZVxuICAgICAqIGBwYXRoYCBjcmVhdGlvbi5cbiAgICAgKlxuICAgICAqICoqTm90ZToqKiBUaGlzIG1ldGhvZCBtdXRhdGVzIGBvYmplY3RgLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDMuNy4wXG4gICAgICogQGNhdGVnb3J5IE9iamVjdFxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIG9iamVjdCB0byBtb2RpZnkuXG4gICAgICogQHBhcmFtIHtBcnJheXxzdHJpbmd9IHBhdGggVGhlIHBhdGggb2YgdGhlIHByb3BlcnR5IHRvIHNldC5cbiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIFRoZSB2YWx1ZSB0byBzZXQuXG4gICAgICogQHJldHVybnMge09iamVjdH0gUmV0dXJucyBgb2JqZWN0YC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogdmFyIG9iamVjdCA9IHsgJ2EnOiBbeyAnYic6IHsgJ2MnOiAzIH0gfV0gfTtcbiAgICAgKlxuICAgICAqIF8uc2V0KG9iamVjdCwgJ2FbMF0uYi5jJywgNCk7XG4gICAgICogY29uc29sZS5sb2cob2JqZWN0LmFbMF0uYi5jKTtcbiAgICAgKiAvLyA9PiA0XG4gICAgICpcbiAgICAgKiBfLnNldChvYmplY3QsIFsneCcsICcwJywgJ3knLCAneiddLCA1KTtcbiAgICAgKiBjb25zb2xlLmxvZyhvYmplY3QueFswXS55LnopO1xuICAgICAqIC8vID0+IDVcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBzZXQob2JqZWN0LCBwYXRoLCB2YWx1ZSkge1xuICAgICAgcmV0dXJuIG9iamVjdCA9PSBudWxsID8gb2JqZWN0IDogYmFzZVNldChvYmplY3QsIHBhdGgsIHZhbHVlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGlzIG1ldGhvZCBpcyBsaWtlIGBfLnNldGAgZXhjZXB0IHRoYXQgaXQgYWNjZXB0cyBgY3VzdG9taXplcmAgd2hpY2ggaXNcbiAgICAgKiBpbnZva2VkIHRvIHByb2R1Y2UgdGhlIG9iamVjdHMgb2YgYHBhdGhgLiAgSWYgYGN1c3RvbWl6ZXJgIHJldHVybnMgYHVuZGVmaW5lZGBcbiAgICAgKiBwYXRoIGNyZWF0aW9uIGlzIGhhbmRsZWQgYnkgdGhlIG1ldGhvZCBpbnN0ZWFkLiBUaGUgYGN1c3RvbWl6ZXJgIGlzIGludm9rZWRcbiAgICAgKiB3aXRoIHRocmVlIGFyZ3VtZW50czogKG5zVmFsdWUsIGtleSwgbnNPYmplY3QpLlxuICAgICAqXG4gICAgICogKipOb3RlOioqIFRoaXMgbWV0aG9kIG11dGF0ZXMgYG9iamVjdGAuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgNC4wLjBcbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0XG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgb2JqZWN0IHRvIG1vZGlmeS5cbiAgICAgKiBAcGFyYW0ge0FycmF5fHN0cmluZ30gcGF0aCBUaGUgcGF0aCBvZiB0aGUgcHJvcGVydHkgdG8gc2V0LlxuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIHNldC5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbY3VzdG9taXplcl0gVGhlIGZ1bmN0aW9uIHRvIGN1c3RvbWl6ZSBhc3NpZ25lZCB2YWx1ZXMuXG4gICAgICogQHJldHVybnMge09iamVjdH0gUmV0dXJucyBgb2JqZWN0YC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogdmFyIG9iamVjdCA9IHt9O1xuICAgICAqXG4gICAgICogXy5zZXRXaXRoKG9iamVjdCwgJ1swXVsxXScsICdhJywgT2JqZWN0KTtcbiAgICAgKiAvLyA9PiB7ICcwJzogeyAnMSc6ICdhJyB9IH1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBzZXRXaXRoKG9iamVjdCwgcGF0aCwgdmFsdWUsIGN1c3RvbWl6ZXIpIHtcbiAgICAgIGN1c3RvbWl6ZXIgPSB0eXBlb2YgY3VzdG9taXplciA9PSAnZnVuY3Rpb24nID8gY3VzdG9taXplciA6IHVuZGVmaW5lZDtcbiAgICAgIHJldHVybiBvYmplY3QgPT0gbnVsbCA/IG9iamVjdCA6IGJhc2VTZXQob2JqZWN0LCBwYXRoLCB2YWx1ZSwgY3VzdG9taXplcik7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhbiBhcnJheSBvZiBvd24gZW51bWVyYWJsZSBzdHJpbmcga2V5ZWQtdmFsdWUgcGFpcnMgZm9yIGBvYmplY3RgXG4gICAgICogd2hpY2ggY2FuIGJlIGNvbnN1bWVkIGJ5IGBfLmZyb21QYWlyc2AuIElmIGBvYmplY3RgIGlzIGEgbWFwIG9yIHNldCwgaXRzXG4gICAgICogZW50cmllcyBhcmUgcmV0dXJuZWQuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgNC4wLjBcbiAgICAgKiBAYWxpYXMgZW50cmllc1xuICAgICAqIEBjYXRlZ29yeSBPYmplY3RcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8gcXVlcnkuXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIHRoZSBrZXktdmFsdWUgcGFpcnMuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIGZ1bmN0aW9uIEZvbygpIHtcbiAgICAgKiAgIHRoaXMuYSA9IDE7XG4gICAgICogICB0aGlzLmIgPSAyO1xuICAgICAqIH1cbiAgICAgKlxuICAgICAqIEZvby5wcm90b3R5cGUuYyA9IDM7XG4gICAgICpcbiAgICAgKiBfLnRvUGFpcnMobmV3IEZvbyk7XG4gICAgICogLy8gPT4gW1snYScsIDFdLCBbJ2InLCAyXV0gKGl0ZXJhdGlvbiBvcmRlciBpcyBub3QgZ3VhcmFudGVlZClcbiAgICAgKi9cbiAgICB2YXIgdG9QYWlycyA9IGNyZWF0ZVRvUGFpcnMoa2V5cyk7XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuIGFycmF5IG9mIG93biBhbmQgaW5oZXJpdGVkIGVudW1lcmFibGUgc3RyaW5nIGtleWVkLXZhbHVlIHBhaXJzXG4gICAgICogZm9yIGBvYmplY3RgIHdoaWNoIGNhbiBiZSBjb25zdW1lZCBieSBgXy5mcm9tUGFpcnNgLiBJZiBgb2JqZWN0YCBpcyBhIG1hcFxuICAgICAqIG9yIHNldCwgaXRzIGVudHJpZXMgYXJlIHJldHVybmVkLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDQuMC4wXG4gICAgICogQGFsaWFzIGVudHJpZXNJblxuICAgICAqIEBjYXRlZ29yeSBPYmplY3RcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8gcXVlcnkuXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIHRoZSBrZXktdmFsdWUgcGFpcnMuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIGZ1bmN0aW9uIEZvbygpIHtcbiAgICAgKiAgIHRoaXMuYSA9IDE7XG4gICAgICogICB0aGlzLmIgPSAyO1xuICAgICAqIH1cbiAgICAgKlxuICAgICAqIEZvby5wcm90b3R5cGUuYyA9IDM7XG4gICAgICpcbiAgICAgKiBfLnRvUGFpcnNJbihuZXcgRm9vKTtcbiAgICAgKiAvLyA9PiBbWydhJywgMV0sIFsnYicsIDJdLCBbJ2MnLCAzXV0gKGl0ZXJhdGlvbiBvcmRlciBpcyBub3QgZ3VhcmFudGVlZClcbiAgICAgKi9cbiAgICB2YXIgdG9QYWlyc0luID0gY3JlYXRlVG9QYWlycyhrZXlzSW4pO1xuXG4gICAgLyoqXG4gICAgICogQW4gYWx0ZXJuYXRpdmUgdG8gYF8ucmVkdWNlYDsgdGhpcyBtZXRob2QgdHJhbnNmb3JtcyBgb2JqZWN0YCB0byBhIG5ld1xuICAgICAqIGBhY2N1bXVsYXRvcmAgb2JqZWN0IHdoaWNoIGlzIHRoZSByZXN1bHQgb2YgcnVubmluZyBlYWNoIG9mIGl0cyBvd25cbiAgICAgKiBlbnVtZXJhYmxlIHN0cmluZyBrZXllZCBwcm9wZXJ0aWVzIHRocnUgYGl0ZXJhdGVlYCwgd2l0aCBlYWNoIGludm9jYXRpb25cbiAgICAgKiBwb3RlbnRpYWxseSBtdXRhdGluZyB0aGUgYGFjY3VtdWxhdG9yYCBvYmplY3QuIElmIGBhY2N1bXVsYXRvcmAgaXMgbm90XG4gICAgICogcHJvdmlkZWQsIGEgbmV3IG9iamVjdCB3aXRoIHRoZSBzYW1lIGBbW1Byb3RvdHlwZV1dYCB3aWxsIGJlIHVzZWQuIFRoZVxuICAgICAqIGl0ZXJhdGVlIGlzIGludm9rZWQgd2l0aCBmb3VyIGFyZ3VtZW50czogKGFjY3VtdWxhdG9yLCB2YWx1ZSwga2V5LCBvYmplY3QpLlxuICAgICAqIEl0ZXJhdGVlIGZ1bmN0aW9ucyBtYXkgZXhpdCBpdGVyYXRpb24gZWFybHkgYnkgZXhwbGljaXRseSByZXR1cm5pbmcgYGZhbHNlYC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAxLjMuMFxuICAgICAqIEBjYXRlZ29yeSBPYmplY3RcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8gaXRlcmF0ZSBvdmVyLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtpdGVyYXRlZT1fLmlkZW50aXR5XSBUaGUgZnVuY3Rpb24gaW52b2tlZCBwZXIgaXRlcmF0aW9uLlxuICAgICAqIEBwYXJhbSB7Kn0gW2FjY3VtdWxhdG9yXSBUaGUgY3VzdG9tIGFjY3VtdWxhdG9yIHZhbHVlLlxuICAgICAqIEByZXR1cm5zIHsqfSBSZXR1cm5zIHRoZSBhY2N1bXVsYXRlZCB2YWx1ZS5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy50cmFuc2Zvcm0oWzIsIDMsIDRdLCBmdW5jdGlvbihyZXN1bHQsIG4pIHtcbiAgICAgKiAgIHJlc3VsdC5wdXNoKG4gKj0gbik7XG4gICAgICogICByZXR1cm4gbiAlIDIgPT0gMDtcbiAgICAgKiB9LCBbXSk7XG4gICAgICogLy8gPT4gWzQsIDldXG4gICAgICpcbiAgICAgKiBfLnRyYW5zZm9ybSh7ICdhJzogMSwgJ2InOiAyLCAnYyc6IDEgfSwgZnVuY3Rpb24ocmVzdWx0LCB2YWx1ZSwga2V5KSB7XG4gICAgICogICAocmVzdWx0W3ZhbHVlXSB8fCAocmVzdWx0W3ZhbHVlXSA9IFtdKSkucHVzaChrZXkpO1xuICAgICAqIH0sIHt9KTtcbiAgICAgKiAvLyA9PiB7ICcxJzogWydhJywgJ2MnXSwgJzInOiBbJ2InXSB9XG4gICAgICovXG4gICAgZnVuY3Rpb24gdHJhbnNmb3JtKG9iamVjdCwgaXRlcmF0ZWUsIGFjY3VtdWxhdG9yKSB7XG4gICAgICB2YXIgaXNBcnIgPSBpc0FycmF5KG9iamVjdCksXG4gICAgICAgICAgaXNBcnJMaWtlID0gaXNBcnIgfHwgaXNCdWZmZXIob2JqZWN0KSB8fCBpc1R5cGVkQXJyYXkob2JqZWN0KTtcblxuICAgICAgaXRlcmF0ZWUgPSBnZXRJdGVyYXRlZShpdGVyYXRlZSwgNCk7XG4gICAgICBpZiAoYWNjdW11bGF0b3IgPT0gbnVsbCkge1xuICAgICAgICB2YXIgQ3RvciA9IG9iamVjdCAmJiBvYmplY3QuY29uc3RydWN0b3I7XG4gICAgICAgIGlmIChpc0Fyckxpa2UpIHtcbiAgICAgICAgICBhY2N1bXVsYXRvciA9IGlzQXJyID8gbmV3IEN0b3IgOiBbXTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChpc09iamVjdChvYmplY3QpKSB7XG4gICAgICAgICAgYWNjdW11bGF0b3IgPSBpc0Z1bmN0aW9uKEN0b3IpID8gYmFzZUNyZWF0ZShnZXRQcm90b3R5cGUob2JqZWN0KSkgOiB7fTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICBhY2N1bXVsYXRvciA9IHt9O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICAoaXNBcnJMaWtlID8gYXJyYXlFYWNoIDogYmFzZUZvck93bikob2JqZWN0LCBmdW5jdGlvbih2YWx1ZSwgaW5kZXgsIG9iamVjdCkge1xuICAgICAgICByZXR1cm4gaXRlcmF0ZWUoYWNjdW11bGF0b3IsIHZhbHVlLCBpbmRleCwgb2JqZWN0KTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGFjY3VtdWxhdG9yO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlbW92ZXMgdGhlIHByb3BlcnR5IGF0IGBwYXRoYCBvZiBgb2JqZWN0YC5cbiAgICAgKlxuICAgICAqICoqTm90ZToqKiBUaGlzIG1ldGhvZCBtdXRhdGVzIGBvYmplY3RgLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDQuMC4wXG4gICAgICogQGNhdGVnb3J5IE9iamVjdFxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIG9iamVjdCB0byBtb2RpZnkuXG4gICAgICogQHBhcmFtIHtBcnJheXxzdHJpbmd9IHBhdGggVGhlIHBhdGggb2YgdGhlIHByb3BlcnR5IHRvIHVuc2V0LlxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgcHJvcGVydHkgaXMgZGVsZXRlZCwgZWxzZSBgZmFsc2VgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiB2YXIgb2JqZWN0ID0geyAnYSc6IFt7ICdiJzogeyAnYyc6IDcgfSB9XSB9O1xuICAgICAqIF8udW5zZXQob2JqZWN0LCAnYVswXS5iLmMnKTtcbiAgICAgKiAvLyA9PiB0cnVlXG4gICAgICpcbiAgICAgKiBjb25zb2xlLmxvZyhvYmplY3QpO1xuICAgICAqIC8vID0+IHsgJ2EnOiBbeyAnYic6IHt9IH1dIH07XG4gICAgICpcbiAgICAgKiBfLnVuc2V0KG9iamVjdCwgWydhJywgJzAnLCAnYicsICdjJ10pO1xuICAgICAqIC8vID0+IHRydWVcbiAgICAgKlxuICAgICAqIGNvbnNvbGUubG9nKG9iamVjdCk7XG4gICAgICogLy8gPT4geyAnYSc6IFt7ICdiJzoge30gfV0gfTtcbiAgICAgKi9cbiAgICBmdW5jdGlvbiB1bnNldChvYmplY3QsIHBhdGgpIHtcbiAgICAgIHJldHVybiBvYmplY3QgPT0gbnVsbCA/IHRydWUgOiBiYXNlVW5zZXQob2JqZWN0LCBwYXRoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGlzIG1ldGhvZCBpcyBsaWtlIGBfLnNldGAgZXhjZXB0IHRoYXQgYWNjZXB0cyBgdXBkYXRlcmAgdG8gcHJvZHVjZSB0aGVcbiAgICAgKiB2YWx1ZSB0byBzZXQuIFVzZSBgXy51cGRhdGVXaXRoYCB0byBjdXN0b21pemUgYHBhdGhgIGNyZWF0aW9uLiBUaGUgYHVwZGF0ZXJgXG4gICAgICogaXMgaW52b2tlZCB3aXRoIG9uZSBhcmd1bWVudDogKHZhbHVlKS5cbiAgICAgKlxuICAgICAqICoqTm90ZToqKiBUaGlzIG1ldGhvZCBtdXRhdGVzIGBvYmplY3RgLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDQuNi4wXG4gICAgICogQGNhdGVnb3J5IE9iamVjdFxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIG9iamVjdCB0byBtb2RpZnkuXG4gICAgICogQHBhcmFtIHtBcnJheXxzdHJpbmd9IHBhdGggVGhlIHBhdGggb2YgdGhlIHByb3BlcnR5IHRvIHNldC5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSB1cGRhdGVyIFRoZSBmdW5jdGlvbiB0byBwcm9kdWNlIHRoZSB1cGRhdGVkIHZhbHVlLlxuICAgICAqIEByZXR1cm5zIHtPYmplY3R9IFJldHVybnMgYG9iamVjdGAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciBvYmplY3QgPSB7ICdhJzogW3sgJ2InOiB7ICdjJzogMyB9IH1dIH07XG4gICAgICpcbiAgICAgKiBfLnVwZGF0ZShvYmplY3QsICdhWzBdLmIuYycsIGZ1bmN0aW9uKG4pIHsgcmV0dXJuIG4gKiBuOyB9KTtcbiAgICAgKiBjb25zb2xlLmxvZyhvYmplY3QuYVswXS5iLmMpO1xuICAgICAqIC8vID0+IDlcbiAgICAgKlxuICAgICAqIF8udXBkYXRlKG9iamVjdCwgJ3hbMF0ueS56JywgZnVuY3Rpb24obikgeyByZXR1cm4gbiA/IG4gKyAxIDogMDsgfSk7XG4gICAgICogY29uc29sZS5sb2cob2JqZWN0LnhbMF0ueS56KTtcbiAgICAgKiAvLyA9PiAwXG4gICAgICovXG4gICAgZnVuY3Rpb24gdXBkYXRlKG9iamVjdCwgcGF0aCwgdXBkYXRlcikge1xuICAgICAgcmV0dXJuIG9iamVjdCA9PSBudWxsID8gb2JqZWN0IDogYmFzZVVwZGF0ZShvYmplY3QsIHBhdGgsIGNhc3RGdW5jdGlvbih1cGRhdGVyKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhpcyBtZXRob2QgaXMgbGlrZSBgXy51cGRhdGVgIGV4Y2VwdCB0aGF0IGl0IGFjY2VwdHMgYGN1c3RvbWl6ZXJgIHdoaWNoIGlzXG4gICAgICogaW52b2tlZCB0byBwcm9kdWNlIHRoZSBvYmplY3RzIG9mIGBwYXRoYC4gIElmIGBjdXN0b21pemVyYCByZXR1cm5zIGB1bmRlZmluZWRgXG4gICAgICogcGF0aCBjcmVhdGlvbiBpcyBoYW5kbGVkIGJ5IHRoZSBtZXRob2QgaW5zdGVhZC4gVGhlIGBjdXN0b21pemVyYCBpcyBpbnZva2VkXG4gICAgICogd2l0aCB0aHJlZSBhcmd1bWVudHM6IChuc1ZhbHVlLCBrZXksIG5zT2JqZWN0KS5cbiAgICAgKlxuICAgICAqICoqTm90ZToqKiBUaGlzIG1ldGhvZCBtdXRhdGVzIGBvYmplY3RgLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDQuNi4wXG4gICAgICogQGNhdGVnb3J5IE9iamVjdFxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIG9iamVjdCB0byBtb2RpZnkuXG4gICAgICogQHBhcmFtIHtBcnJheXxzdHJpbmd9IHBhdGggVGhlIHBhdGggb2YgdGhlIHByb3BlcnR5IHRvIHNldC5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSB1cGRhdGVyIFRoZSBmdW5jdGlvbiB0byBwcm9kdWNlIHRoZSB1cGRhdGVkIHZhbHVlLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtjdXN0b21pemVyXSBUaGUgZnVuY3Rpb24gdG8gY3VzdG9taXplIGFzc2lnbmVkIHZhbHVlcy5cbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIGBvYmplY3RgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiB2YXIgb2JqZWN0ID0ge307XG4gICAgICpcbiAgICAgKiBfLnVwZGF0ZVdpdGgob2JqZWN0LCAnWzBdWzFdJywgXy5jb25zdGFudCgnYScpLCBPYmplY3QpO1xuICAgICAqIC8vID0+IHsgJzAnOiB7ICcxJzogJ2EnIH0gfVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHVwZGF0ZVdpdGgob2JqZWN0LCBwYXRoLCB1cGRhdGVyLCBjdXN0b21pemVyKSB7XG4gICAgICBjdXN0b21pemVyID0gdHlwZW9mIGN1c3RvbWl6ZXIgPT0gJ2Z1bmN0aW9uJyA/IGN1c3RvbWl6ZXIgOiB1bmRlZmluZWQ7XG4gICAgICByZXR1cm4gb2JqZWN0ID09IG51bGwgPyBvYmplY3QgOiBiYXNlVXBkYXRlKG9iamVjdCwgcGF0aCwgY2FzdEZ1bmN0aW9uKHVwZGF0ZXIpLCBjdXN0b21pemVyKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuIGFycmF5IG9mIHRoZSBvd24gZW51bWVyYWJsZSBzdHJpbmcga2V5ZWQgcHJvcGVydHkgdmFsdWVzIG9mIGBvYmplY3RgLlxuICAgICAqXG4gICAgICogKipOb3RlOioqIE5vbi1vYmplY3QgdmFsdWVzIGFyZSBjb2VyY2VkIHRvIG9iamVjdHMuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQHNpbmNlIDAuMS4wXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAY2F0ZWdvcnkgT2JqZWN0XG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgb2JqZWN0IHRvIHF1ZXJ5LlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgYXJyYXkgb2YgcHJvcGVydHkgdmFsdWVzLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBmdW5jdGlvbiBGb28oKSB7XG4gICAgICogICB0aGlzLmEgPSAxO1xuICAgICAqICAgdGhpcy5iID0gMjtcbiAgICAgKiB9XG4gICAgICpcbiAgICAgKiBGb28ucHJvdG90eXBlLmMgPSAzO1xuICAgICAqXG4gICAgICogXy52YWx1ZXMobmV3IEZvbyk7XG4gICAgICogLy8gPT4gWzEsIDJdIChpdGVyYXRpb24gb3JkZXIgaXMgbm90IGd1YXJhbnRlZWQpXG4gICAgICpcbiAgICAgKiBfLnZhbHVlcygnaGknKTtcbiAgICAgKiAvLyA9PiBbJ2gnLCAnaSddXG4gICAgICovXG4gICAgZnVuY3Rpb24gdmFsdWVzKG9iamVjdCkge1xuICAgICAgcmV0dXJuIG9iamVjdCA9PSBudWxsID8gW10gOiBiYXNlVmFsdWVzKG9iamVjdCwga2V5cyhvYmplY3QpKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuIGFycmF5IG9mIHRoZSBvd24gYW5kIGluaGVyaXRlZCBlbnVtZXJhYmxlIHN0cmluZyBrZXllZCBwcm9wZXJ0eVxuICAgICAqIHZhbHVlcyBvZiBgb2JqZWN0YC5cbiAgICAgKlxuICAgICAqICoqTm90ZToqKiBOb24tb2JqZWN0IHZhbHVlcyBhcmUgY29lcmNlZCB0byBvYmplY3RzLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDMuMC4wXG4gICAgICogQGNhdGVnb3J5IE9iamVjdFxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIG9iamVjdCB0byBxdWVyeS5cbiAgICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgdGhlIGFycmF5IG9mIHByb3BlcnR5IHZhbHVlcy5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogZnVuY3Rpb24gRm9vKCkge1xuICAgICAqICAgdGhpcy5hID0gMTtcbiAgICAgKiAgIHRoaXMuYiA9IDI7XG4gICAgICogfVxuICAgICAqXG4gICAgICogRm9vLnByb3RvdHlwZS5jID0gMztcbiAgICAgKlxuICAgICAqIF8udmFsdWVzSW4obmV3IEZvbyk7XG4gICAgICogLy8gPT4gWzEsIDIsIDNdIChpdGVyYXRpb24gb3JkZXIgaXMgbm90IGd1YXJhbnRlZWQpXG4gICAgICovXG4gICAgZnVuY3Rpb24gdmFsdWVzSW4ob2JqZWN0KSB7XG4gICAgICByZXR1cm4gb2JqZWN0ID09IG51bGwgPyBbXSA6IGJhc2VWYWx1ZXMob2JqZWN0LCBrZXlzSW4ob2JqZWN0KSk7XG4gICAgfVxuXG4gICAgLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG4gICAgLyoqXG4gICAgICogQ2xhbXBzIGBudW1iZXJgIHdpdGhpbiB0aGUgaW5jbHVzaXZlIGBsb3dlcmAgYW5kIGB1cHBlcmAgYm91bmRzLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDQuMC4wXG4gICAgICogQGNhdGVnb3J5IE51bWJlclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBudW1iZXIgVGhlIG51bWJlciB0byBjbGFtcC5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW2xvd2VyXSBUaGUgbG93ZXIgYm91bmQuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHVwcGVyIFRoZSB1cHBlciBib3VuZC5cbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSBSZXR1cm5zIHRoZSBjbGFtcGVkIG51bWJlci5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5jbGFtcCgtMTAsIC01LCA1KTtcbiAgICAgKiAvLyA9PiAtNVxuICAgICAqXG4gICAgICogXy5jbGFtcCgxMCwgLTUsIDUpO1xuICAgICAqIC8vID0+IDVcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjbGFtcChudW1iZXIsIGxvd2VyLCB1cHBlcikge1xuICAgICAgaWYgKHVwcGVyID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdXBwZXIgPSBsb3dlcjtcbiAgICAgICAgbG93ZXIgPSB1bmRlZmluZWQ7XG4gICAgICB9XG4gICAgICBpZiAodXBwZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICB1cHBlciA9IHRvTnVtYmVyKHVwcGVyKTtcbiAgICAgICAgdXBwZXIgPSB1cHBlciA9PT0gdXBwZXIgPyB1cHBlciA6IDA7XG4gICAgICB9XG4gICAgICBpZiAobG93ZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBsb3dlciA9IHRvTnVtYmVyKGxvd2VyKTtcbiAgICAgICAgbG93ZXIgPSBsb3dlciA9PT0gbG93ZXIgPyBsb3dlciA6IDA7XG4gICAgICB9XG4gICAgICByZXR1cm4gYmFzZUNsYW1wKHRvTnVtYmVyKG51bWJlciksIGxvd2VyLCB1cHBlcik7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2tzIGlmIGBuYCBpcyBiZXR3ZWVuIGBzdGFydGAgYW5kIHVwIHRvLCBidXQgbm90IGluY2x1ZGluZywgYGVuZGAuIElmXG4gICAgICogYGVuZGAgaXMgbm90IHNwZWNpZmllZCwgaXQncyBzZXQgdG8gYHN0YXJ0YCB3aXRoIGBzdGFydGAgdGhlbiBzZXQgdG8gYDBgLlxuICAgICAqIElmIGBzdGFydGAgaXMgZ3JlYXRlciB0aGFuIGBlbmRgIHRoZSBwYXJhbXMgYXJlIHN3YXBwZWQgdG8gc3VwcG9ydFxuICAgICAqIG5lZ2F0aXZlIHJhbmdlcy5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAzLjMuMFxuICAgICAqIEBjYXRlZ29yeSBOdW1iZXJcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gbnVtYmVyIFRoZSBudW1iZXIgdG8gY2hlY2suXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtzdGFydD0wXSBUaGUgc3RhcnQgb2YgdGhlIHJhbmdlLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBlbmQgVGhlIGVuZCBvZiB0aGUgcmFuZ2UuXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGBudW1iZXJgIGlzIGluIHRoZSByYW5nZSwgZWxzZSBgZmFsc2VgLlxuICAgICAqIEBzZWUgXy5yYW5nZSwgXy5yYW5nZVJpZ2h0XG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8uaW5SYW5nZSgzLCAyLCA0KTtcbiAgICAgKiAvLyA9PiB0cnVlXG4gICAgICpcbiAgICAgKiBfLmluUmFuZ2UoNCwgOCk7XG4gICAgICogLy8gPT4gdHJ1ZVxuICAgICAqXG4gICAgICogXy5pblJhbmdlKDQsIDIpO1xuICAgICAqIC8vID0+IGZhbHNlXG4gICAgICpcbiAgICAgKiBfLmluUmFuZ2UoMiwgMik7XG4gICAgICogLy8gPT4gZmFsc2VcbiAgICAgKlxuICAgICAqIF8uaW5SYW5nZSgxLjIsIDIpO1xuICAgICAqIC8vID0+IHRydWVcbiAgICAgKlxuICAgICAqIF8uaW5SYW5nZSg1LjIsIDQpO1xuICAgICAqIC8vID0+IGZhbHNlXG4gICAgICpcbiAgICAgKiBfLmluUmFuZ2UoLTMsIC0yLCAtNik7XG4gICAgICogLy8gPT4gdHJ1ZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGluUmFuZ2UobnVtYmVyLCBzdGFydCwgZW5kKSB7XG4gICAgICBzdGFydCA9IHRvRmluaXRlKHN0YXJ0KTtcbiAgICAgIGlmIChlbmQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBlbmQgPSBzdGFydDtcbiAgICAgICAgc3RhcnQgPSAwO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZW5kID0gdG9GaW5pdGUoZW5kKTtcbiAgICAgIH1cbiAgICAgIG51bWJlciA9IHRvTnVtYmVyKG51bWJlcik7XG4gICAgICByZXR1cm4gYmFzZUluUmFuZ2UobnVtYmVyLCBzdGFydCwgZW5kKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQcm9kdWNlcyBhIHJhbmRvbSBudW1iZXIgYmV0d2VlbiB0aGUgaW5jbHVzaXZlIGBsb3dlcmAgYW5kIGB1cHBlcmAgYm91bmRzLlxuICAgICAqIElmIG9ubHkgb25lIGFyZ3VtZW50IGlzIHByb3ZpZGVkIGEgbnVtYmVyIGJldHdlZW4gYDBgIGFuZCB0aGUgZ2l2ZW4gbnVtYmVyXG4gICAgICogaXMgcmV0dXJuZWQuIElmIGBmbG9hdGluZ2AgaXMgYHRydWVgLCBvciBlaXRoZXIgYGxvd2VyYCBvciBgdXBwZXJgIGFyZVxuICAgICAqIGZsb2F0cywgYSBmbG9hdGluZy1wb2ludCBudW1iZXIgaXMgcmV0dXJuZWQgaW5zdGVhZCBvZiBhbiBpbnRlZ2VyLlxuICAgICAqXG4gICAgICogKipOb3RlOioqIEphdmFTY3JpcHQgZm9sbG93cyB0aGUgSUVFRS03NTQgc3RhbmRhcmQgZm9yIHJlc29sdmluZ1xuICAgICAqIGZsb2F0aW5nLXBvaW50IHZhbHVlcyB3aGljaCBjYW4gcHJvZHVjZSB1bmV4cGVjdGVkIHJlc3VsdHMuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMC43LjBcbiAgICAgKiBAY2F0ZWdvcnkgTnVtYmVyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtsb3dlcj0wXSBUaGUgbG93ZXIgYm91bmQuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFt1cHBlcj0xXSBUaGUgdXBwZXIgYm91bmQuXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbZmxvYXRpbmddIFNwZWNpZnkgcmV0dXJuaW5nIGEgZmxvYXRpbmctcG9pbnQgbnVtYmVyLlxuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IFJldHVybnMgdGhlIHJhbmRvbSBudW1iZXIuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8ucmFuZG9tKDAsIDUpO1xuICAgICAqIC8vID0+IGFuIGludGVnZXIgYmV0d2VlbiAwIGFuZCA1XG4gICAgICpcbiAgICAgKiBfLnJhbmRvbSg1KTtcbiAgICAgKiAvLyA9PiBhbHNvIGFuIGludGVnZXIgYmV0d2VlbiAwIGFuZCA1XG4gICAgICpcbiAgICAgKiBfLnJhbmRvbSg1LCB0cnVlKTtcbiAgICAgKiAvLyA9PiBhIGZsb2F0aW5nLXBvaW50IG51bWJlciBiZXR3ZWVuIDAgYW5kIDVcbiAgICAgKlxuICAgICAqIF8ucmFuZG9tKDEuMiwgNS4yKTtcbiAgICAgKiAvLyA9PiBhIGZsb2F0aW5nLXBvaW50IG51bWJlciBiZXR3ZWVuIDEuMiBhbmQgNS4yXG4gICAgICovXG4gICAgZnVuY3Rpb24gcmFuZG9tKGxvd2VyLCB1cHBlciwgZmxvYXRpbmcpIHtcbiAgICAgIGlmIChmbG9hdGluZyAmJiB0eXBlb2YgZmxvYXRpbmcgIT0gJ2Jvb2xlYW4nICYmIGlzSXRlcmF0ZWVDYWxsKGxvd2VyLCB1cHBlciwgZmxvYXRpbmcpKSB7XG4gICAgICAgIHVwcGVyID0gZmxvYXRpbmcgPSB1bmRlZmluZWQ7XG4gICAgICB9XG4gICAgICBpZiAoZmxvYXRpbmcgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBpZiAodHlwZW9mIHVwcGVyID09ICdib29sZWFuJykge1xuICAgICAgICAgIGZsb2F0aW5nID0gdXBwZXI7XG4gICAgICAgICAgdXBwZXIgPSB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodHlwZW9mIGxvd2VyID09ICdib29sZWFuJykge1xuICAgICAgICAgIGZsb2F0aW5nID0gbG93ZXI7XG4gICAgICAgICAgbG93ZXIgPSB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmIChsb3dlciA9PT0gdW5kZWZpbmVkICYmIHVwcGVyID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgbG93ZXIgPSAwO1xuICAgICAgICB1cHBlciA9IDE7XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgbG93ZXIgPSB0b0Zpbml0ZShsb3dlcik7XG4gICAgICAgIGlmICh1cHBlciA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgdXBwZXIgPSBsb3dlcjtcbiAgICAgICAgICBsb3dlciA9IDA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdXBwZXIgPSB0b0Zpbml0ZSh1cHBlcik7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmIChsb3dlciA+IHVwcGVyKSB7XG4gICAgICAgIHZhciB0ZW1wID0gbG93ZXI7XG4gICAgICAgIGxvd2VyID0gdXBwZXI7XG4gICAgICAgIHVwcGVyID0gdGVtcDtcbiAgICAgIH1cbiAgICAgIGlmIChmbG9hdGluZyB8fCBsb3dlciAlIDEgfHwgdXBwZXIgJSAxKSB7XG4gICAgICAgIHZhciByYW5kID0gbmF0aXZlUmFuZG9tKCk7XG4gICAgICAgIHJldHVybiBuYXRpdmVNaW4obG93ZXIgKyAocmFuZCAqICh1cHBlciAtIGxvd2VyICsgZnJlZVBhcnNlRmxvYXQoJzFlLScgKyAoKHJhbmQgKyAnJykubGVuZ3RoIC0gMSkpKSksIHVwcGVyKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBiYXNlUmFuZG9tKGxvd2VyLCB1cHBlcik7XG4gICAgfVxuXG4gICAgLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG4gICAgLyoqXG4gICAgICogQ29udmVydHMgYHN0cmluZ2AgdG8gW2NhbWVsIGNhc2VdKGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0NhbWVsQ2FzZSkuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMy4wLjBcbiAgICAgKiBAY2F0ZWdvcnkgU3RyaW5nXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IFtzdHJpbmc9JyddIFRoZSBzdHJpbmcgdG8gY29udmVydC5cbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSBSZXR1cm5zIHRoZSBjYW1lbCBjYXNlZCBzdHJpbmcuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8uY2FtZWxDYXNlKCdGb28gQmFyJyk7XG4gICAgICogLy8gPT4gJ2Zvb0JhcidcbiAgICAgKlxuICAgICAqIF8uY2FtZWxDYXNlKCctLWZvby1iYXItLScpO1xuICAgICAqIC8vID0+ICdmb29CYXInXG4gICAgICpcbiAgICAgKiBfLmNhbWVsQ2FzZSgnX19GT09fQkFSX18nKTtcbiAgICAgKiAvLyA9PiAnZm9vQmFyJ1xuICAgICAqL1xuICAgIHZhciBjYW1lbENhc2UgPSBjcmVhdGVDb21wb3VuZGVyKGZ1bmN0aW9uKHJlc3VsdCwgd29yZCwgaW5kZXgpIHtcbiAgICAgIHdvcmQgPSB3b3JkLnRvTG93ZXJDYXNlKCk7XG4gICAgICByZXR1cm4gcmVzdWx0ICsgKGluZGV4ID8gY2FwaXRhbGl6ZSh3b3JkKSA6IHdvcmQpO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogQ29udmVydHMgdGhlIGZpcnN0IGNoYXJhY3RlciBvZiBgc3RyaW5nYCB0byB1cHBlciBjYXNlIGFuZCB0aGUgcmVtYWluaW5nXG4gICAgICogdG8gbG93ZXIgY2FzZS5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAzLjAuMFxuICAgICAqIEBjYXRlZ29yeSBTdHJpbmdcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gW3N0cmluZz0nJ10gVGhlIHN0cmluZyB0byBjYXBpdGFsaXplLlxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IFJldHVybnMgdGhlIGNhcGl0YWxpemVkIHN0cmluZy5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5jYXBpdGFsaXplKCdGUkVEJyk7XG4gICAgICogLy8gPT4gJ0ZyZWQnXG4gICAgICovXG4gICAgZnVuY3Rpb24gY2FwaXRhbGl6ZShzdHJpbmcpIHtcbiAgICAgIHJldHVybiB1cHBlckZpcnN0KHRvU3RyaW5nKHN0cmluZykudG9Mb3dlckNhc2UoKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRGVidXJycyBgc3RyaW5nYCBieSBjb252ZXJ0aW5nXG4gICAgICogW0xhdGluLTEgU3VwcGxlbWVudF0oaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvTGF0aW4tMV9TdXBwbGVtZW50XyhVbmljb2RlX2Jsb2NrKSNDaGFyYWN0ZXJfdGFibGUpXG4gICAgICogYW5kIFtMYXRpbiBFeHRlbmRlZC1BXShodHRwczovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9MYXRpbl9FeHRlbmRlZC1BKVxuICAgICAqIGxldHRlcnMgdG8gYmFzaWMgTGF0aW4gbGV0dGVycyBhbmQgcmVtb3ZpbmdcbiAgICAgKiBbY29tYmluaW5nIGRpYWNyaXRpY2FsIG1hcmtzXShodHRwczovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9Db21iaW5pbmdfRGlhY3JpdGljYWxfTWFya3MpLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDMuMC4wXG4gICAgICogQGNhdGVnb3J5IFN0cmluZ1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBbc3RyaW5nPScnXSBUaGUgc3RyaW5nIHRvIGRlYnVyci5cbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSBSZXR1cm5zIHRoZSBkZWJ1cnJlZCBzdHJpbmcuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8uZGVidXJyKCdkw6lqw6AgdnUnKTtcbiAgICAgKiAvLyA9PiAnZGVqYSB2dSdcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBkZWJ1cnIoc3RyaW5nKSB7XG4gICAgICBzdHJpbmcgPSB0b1N0cmluZyhzdHJpbmcpO1xuICAgICAgcmV0dXJuIHN0cmluZyAmJiBzdHJpbmcucmVwbGFjZShyZUxhdGluLCBkZWJ1cnJMZXR0ZXIpLnJlcGxhY2UocmVDb21ib01hcmssICcnKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGVja3MgaWYgYHN0cmluZ2AgZW5kcyB3aXRoIHRoZSBnaXZlbiB0YXJnZXQgc3RyaW5nLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDMuMC4wXG4gICAgICogQGNhdGVnb3J5IFN0cmluZ1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBbc3RyaW5nPScnXSBUaGUgc3RyaW5nIHRvIGluc3BlY3QuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IFt0YXJnZXRdIFRoZSBzdHJpbmcgdG8gc2VhcmNoIGZvci5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW3Bvc2l0aW9uPXN0cmluZy5sZW5ndGhdIFRoZSBwb3NpdGlvbiB0byBzZWFyY2ggdXAgdG8uXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGBzdHJpbmdgIGVuZHMgd2l0aCBgdGFyZ2V0YCxcbiAgICAgKiAgZWxzZSBgZmFsc2VgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLmVuZHNXaXRoKCdhYmMnLCAnYycpO1xuICAgICAqIC8vID0+IHRydWVcbiAgICAgKlxuICAgICAqIF8uZW5kc1dpdGgoJ2FiYycsICdiJyk7XG4gICAgICogLy8gPT4gZmFsc2VcbiAgICAgKlxuICAgICAqIF8uZW5kc1dpdGgoJ2FiYycsICdiJywgMik7XG4gICAgICogLy8gPT4gdHJ1ZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGVuZHNXaXRoKHN0cmluZywgdGFyZ2V0LCBwb3NpdGlvbikge1xuICAgICAgc3RyaW5nID0gdG9TdHJpbmcoc3RyaW5nKTtcbiAgICAgIHRhcmdldCA9IGJhc2VUb1N0cmluZyh0YXJnZXQpO1xuXG4gICAgICB2YXIgbGVuZ3RoID0gc3RyaW5nLmxlbmd0aDtcbiAgICAgIHBvc2l0aW9uID0gcG9zaXRpb24gPT09IHVuZGVmaW5lZFxuICAgICAgICA/IGxlbmd0aFxuICAgICAgICA6IGJhc2VDbGFtcCh0b0ludGVnZXIocG9zaXRpb24pLCAwLCBsZW5ndGgpO1xuXG4gICAgICB2YXIgZW5kID0gcG9zaXRpb247XG4gICAgICBwb3NpdGlvbiAtPSB0YXJnZXQubGVuZ3RoO1xuICAgICAgcmV0dXJuIHBvc2l0aW9uID49IDAgJiYgc3RyaW5nLnNsaWNlKHBvc2l0aW9uLCBlbmQpID09IHRhcmdldDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDb252ZXJ0cyB0aGUgY2hhcmFjdGVycyBcIiZcIiwgXCI8XCIsIFwiPlwiLCAnXCInLCBhbmQgXCInXCIgaW4gYHN0cmluZ2AgdG8gdGhlaXJcbiAgICAgKiBjb3JyZXNwb25kaW5nIEhUTUwgZW50aXRpZXMuXG4gICAgICpcbiAgICAgKiAqKk5vdGU6KiogTm8gb3RoZXIgY2hhcmFjdGVycyBhcmUgZXNjYXBlZC4gVG8gZXNjYXBlIGFkZGl0aW9uYWxcbiAgICAgKiBjaGFyYWN0ZXJzIHVzZSBhIHRoaXJkLXBhcnR5IGxpYnJhcnkgbGlrZSBbX2hlX10oaHR0cHM6Ly9tdGhzLmJlL2hlKS5cbiAgICAgKlxuICAgICAqIFRob3VnaCB0aGUgXCI+XCIgY2hhcmFjdGVyIGlzIGVzY2FwZWQgZm9yIHN5bW1ldHJ5LCBjaGFyYWN0ZXJzIGxpa2VcbiAgICAgKiBcIj5cIiBhbmQgXCIvXCIgZG9uJ3QgbmVlZCBlc2NhcGluZyBpbiBIVE1MIGFuZCBoYXZlIG5vIHNwZWNpYWwgbWVhbmluZ1xuICAgICAqIHVubGVzcyB0aGV5J3JlIHBhcnQgb2YgYSB0YWcgb3IgdW5xdW90ZWQgYXR0cmlidXRlIHZhbHVlLiBTZWVcbiAgICAgKiBbTWF0aGlhcyBCeW5lbnMncyBhcnRpY2xlXShodHRwczovL21hdGhpYXNieW5lbnMuYmUvbm90ZXMvYW1iaWd1b3VzLWFtcGVyc2FuZHMpXG4gICAgICogKHVuZGVyIFwic2VtaS1yZWxhdGVkIGZ1biBmYWN0XCIpIGZvciBtb3JlIGRldGFpbHMuXG4gICAgICpcbiAgICAgKiBXaGVuIHdvcmtpbmcgd2l0aCBIVE1MIHlvdSBzaG91bGQgYWx3YXlzXG4gICAgICogW3F1b3RlIGF0dHJpYnV0ZSB2YWx1ZXNdKGh0dHA6Ly93b25rby5jb20vcG9zdC9odG1sLWVzY2FwaW5nKSB0byByZWR1Y2VcbiAgICAgKiBYU1MgdmVjdG9ycy5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAc2luY2UgMC4xLjBcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBjYXRlZ29yeSBTdHJpbmdcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gW3N0cmluZz0nJ10gVGhlIHN0cmluZyB0byBlc2NhcGUuXG4gICAgICogQHJldHVybnMge3N0cmluZ30gUmV0dXJucyB0aGUgZXNjYXBlZCBzdHJpbmcuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8uZXNjYXBlKCdmcmVkLCBiYXJuZXksICYgcGViYmxlcycpO1xuICAgICAqIC8vID0+ICdmcmVkLCBiYXJuZXksICZhbXA7IHBlYmJsZXMnXG4gICAgICovXG4gICAgZnVuY3Rpb24gZXNjYXBlKHN0cmluZykge1xuICAgICAgc3RyaW5nID0gdG9TdHJpbmcoc3RyaW5nKTtcbiAgICAgIHJldHVybiAoc3RyaW5nICYmIHJlSGFzVW5lc2NhcGVkSHRtbC50ZXN0KHN0cmluZykpXG4gICAgICAgID8gc3RyaW5nLnJlcGxhY2UocmVVbmVzY2FwZWRIdG1sLCBlc2NhcGVIdG1sQ2hhcilcbiAgICAgICAgOiBzdHJpbmc7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXNjYXBlcyB0aGUgYFJlZ0V4cGAgc3BlY2lhbCBjaGFyYWN0ZXJzIFwiXlwiLCBcIiRcIiwgXCJcXFwiLCBcIi5cIiwgXCIqXCIsIFwiK1wiLFxuICAgICAqIFwiP1wiLCBcIihcIiwgXCIpXCIsIFwiW1wiLCBcIl1cIiwgXCJ7XCIsIFwifVwiLCBhbmQgXCJ8XCIgaW4gYHN0cmluZ2AuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMy4wLjBcbiAgICAgKiBAY2F0ZWdvcnkgU3RyaW5nXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IFtzdHJpbmc9JyddIFRoZSBzdHJpbmcgdG8gZXNjYXBlLlxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IFJldHVybnMgdGhlIGVzY2FwZWQgc3RyaW5nLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLmVzY2FwZVJlZ0V4cCgnW2xvZGFzaF0oaHR0cHM6Ly9sb2Rhc2guY29tLyknKTtcbiAgICAgKiAvLyA9PiAnXFxbbG9kYXNoXFxdXFwoaHR0cHM6Ly9sb2Rhc2hcXC5jb20vXFwpJ1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIGVzY2FwZVJlZ0V4cChzdHJpbmcpIHtcbiAgICAgIHN0cmluZyA9IHRvU3RyaW5nKHN0cmluZyk7XG4gICAgICByZXR1cm4gKHN0cmluZyAmJiByZUhhc1JlZ0V4cENoYXIudGVzdChzdHJpbmcpKVxuICAgICAgICA/IHN0cmluZy5yZXBsYWNlKHJlUmVnRXhwQ2hhciwgJ1xcXFwkJicpXG4gICAgICAgIDogc3RyaW5nO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENvbnZlcnRzIGBzdHJpbmdgIHRvXG4gICAgICogW2tlYmFiIGNhc2VdKGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0xldHRlcl9jYXNlI1NwZWNpYWxfY2FzZV9zdHlsZXMpLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDMuMC4wXG4gICAgICogQGNhdGVnb3J5IFN0cmluZ1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBbc3RyaW5nPScnXSBUaGUgc3RyaW5nIHRvIGNvbnZlcnQuXG4gICAgICogQHJldHVybnMge3N0cmluZ30gUmV0dXJucyB0aGUga2ViYWIgY2FzZWQgc3RyaW5nLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLmtlYmFiQ2FzZSgnRm9vIEJhcicpO1xuICAgICAqIC8vID0+ICdmb28tYmFyJ1xuICAgICAqXG4gICAgICogXy5rZWJhYkNhc2UoJ2Zvb0JhcicpO1xuICAgICAqIC8vID0+ICdmb28tYmFyJ1xuICAgICAqXG4gICAgICogXy5rZWJhYkNhc2UoJ19fRk9PX0JBUl9fJyk7XG4gICAgICogLy8gPT4gJ2Zvby1iYXInXG4gICAgICovXG4gICAgdmFyIGtlYmFiQ2FzZSA9IGNyZWF0ZUNvbXBvdW5kZXIoZnVuY3Rpb24ocmVzdWx0LCB3b3JkLCBpbmRleCkge1xuICAgICAgcmV0dXJuIHJlc3VsdCArIChpbmRleCA/ICctJyA6ICcnKSArIHdvcmQudG9Mb3dlckNhc2UoKTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIENvbnZlcnRzIGBzdHJpbmdgLCBhcyBzcGFjZSBzZXBhcmF0ZWQgd29yZHMsIHRvIGxvd2VyIGNhc2UuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgNC4wLjBcbiAgICAgKiBAY2F0ZWdvcnkgU3RyaW5nXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IFtzdHJpbmc9JyddIFRoZSBzdHJpbmcgdG8gY29udmVydC5cbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSBSZXR1cm5zIHRoZSBsb3dlciBjYXNlZCBzdHJpbmcuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8ubG93ZXJDYXNlKCctLUZvby1CYXItLScpO1xuICAgICAqIC8vID0+ICdmb28gYmFyJ1xuICAgICAqXG4gICAgICogXy5sb3dlckNhc2UoJ2Zvb0JhcicpO1xuICAgICAqIC8vID0+ICdmb28gYmFyJ1xuICAgICAqXG4gICAgICogXy5sb3dlckNhc2UoJ19fRk9PX0JBUl9fJyk7XG4gICAgICogLy8gPT4gJ2ZvbyBiYXInXG4gICAgICovXG4gICAgdmFyIGxvd2VyQ2FzZSA9IGNyZWF0ZUNvbXBvdW5kZXIoZnVuY3Rpb24ocmVzdWx0LCB3b3JkLCBpbmRleCkge1xuICAgICAgcmV0dXJuIHJlc3VsdCArIChpbmRleCA/ICcgJyA6ICcnKSArIHdvcmQudG9Mb3dlckNhc2UoKTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIENvbnZlcnRzIHRoZSBmaXJzdCBjaGFyYWN0ZXIgb2YgYHN0cmluZ2AgdG8gbG93ZXIgY2FzZS5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSA0LjAuMFxuICAgICAqIEBjYXRlZ29yeSBTdHJpbmdcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gW3N0cmluZz0nJ10gVGhlIHN0cmluZyB0byBjb252ZXJ0LlxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IFJldHVybnMgdGhlIGNvbnZlcnRlZCBzdHJpbmcuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8ubG93ZXJGaXJzdCgnRnJlZCcpO1xuICAgICAqIC8vID0+ICdmcmVkJ1xuICAgICAqXG4gICAgICogXy5sb3dlckZpcnN0KCdGUkVEJyk7XG4gICAgICogLy8gPT4gJ2ZSRUQnXG4gICAgICovXG4gICAgdmFyIGxvd2VyRmlyc3QgPSBjcmVhdGVDYXNlRmlyc3QoJ3RvTG93ZXJDYXNlJyk7XG5cbiAgICAvKipcbiAgICAgKiBQYWRzIGBzdHJpbmdgIG9uIHRoZSBsZWZ0IGFuZCByaWdodCBzaWRlcyBpZiBpdCdzIHNob3J0ZXIgdGhhbiBgbGVuZ3RoYC5cbiAgICAgKiBQYWRkaW5nIGNoYXJhY3RlcnMgYXJlIHRydW5jYXRlZCBpZiB0aGV5IGNhbid0IGJlIGV2ZW5seSBkaXZpZGVkIGJ5IGBsZW5ndGhgLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDMuMC4wXG4gICAgICogQGNhdGVnb3J5IFN0cmluZ1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBbc3RyaW5nPScnXSBUaGUgc3RyaW5nIHRvIHBhZC5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW2xlbmd0aD0wXSBUaGUgcGFkZGluZyBsZW5ndGguXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IFtjaGFycz0nICddIFRoZSBzdHJpbmcgdXNlZCBhcyBwYWRkaW5nLlxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IFJldHVybnMgdGhlIHBhZGRlZCBzdHJpbmcuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8ucGFkKCdhYmMnLCA4KTtcbiAgICAgKiAvLyA9PiAnICBhYmMgICAnXG4gICAgICpcbiAgICAgKiBfLnBhZCgnYWJjJywgOCwgJ18tJyk7XG4gICAgICogLy8gPT4gJ18tYWJjXy1fJ1xuICAgICAqXG4gICAgICogXy5wYWQoJ2FiYycsIDMpO1xuICAgICAqIC8vID0+ICdhYmMnXG4gICAgICovXG4gICAgZnVuY3Rpb24gcGFkKHN0cmluZywgbGVuZ3RoLCBjaGFycykge1xuICAgICAgc3RyaW5nID0gdG9TdHJpbmcoc3RyaW5nKTtcbiAgICAgIGxlbmd0aCA9IHRvSW50ZWdlcihsZW5ndGgpO1xuXG4gICAgICB2YXIgc3RyTGVuZ3RoID0gbGVuZ3RoID8gc3RyaW5nU2l6ZShzdHJpbmcpIDogMDtcbiAgICAgIGlmICghbGVuZ3RoIHx8IHN0ckxlbmd0aCA+PSBsZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIHN0cmluZztcbiAgICAgIH1cbiAgICAgIHZhciBtaWQgPSAobGVuZ3RoIC0gc3RyTGVuZ3RoKSAvIDI7XG4gICAgICByZXR1cm4gKFxuICAgICAgICBjcmVhdGVQYWRkaW5nKG5hdGl2ZUZsb29yKG1pZCksIGNoYXJzKSArXG4gICAgICAgIHN0cmluZyArXG4gICAgICAgIGNyZWF0ZVBhZGRpbmcobmF0aXZlQ2VpbChtaWQpLCBjaGFycylcbiAgICAgICk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUGFkcyBgc3RyaW5nYCBvbiB0aGUgcmlnaHQgc2lkZSBpZiBpdCdzIHNob3J0ZXIgdGhhbiBgbGVuZ3RoYC4gUGFkZGluZ1xuICAgICAqIGNoYXJhY3RlcnMgYXJlIHRydW5jYXRlZCBpZiB0aGV5IGV4Y2VlZCBgbGVuZ3RoYC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSA0LjAuMFxuICAgICAqIEBjYXRlZ29yeSBTdHJpbmdcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gW3N0cmluZz0nJ10gVGhlIHN0cmluZyB0byBwYWQuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtsZW5ndGg9MF0gVGhlIHBhZGRpbmcgbGVuZ3RoLlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBbY2hhcnM9JyAnXSBUaGUgc3RyaW5nIHVzZWQgYXMgcGFkZGluZy5cbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSBSZXR1cm5zIHRoZSBwYWRkZWQgc3RyaW5nLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLnBhZEVuZCgnYWJjJywgNik7XG4gICAgICogLy8gPT4gJ2FiYyAgICdcbiAgICAgKlxuICAgICAqIF8ucGFkRW5kKCdhYmMnLCA2LCAnXy0nKTtcbiAgICAgKiAvLyA9PiAnYWJjXy1fJ1xuICAgICAqXG4gICAgICogXy5wYWRFbmQoJ2FiYycsIDMpO1xuICAgICAqIC8vID0+ICdhYmMnXG4gICAgICovXG4gICAgZnVuY3Rpb24gcGFkRW5kKHN0cmluZywgbGVuZ3RoLCBjaGFycykge1xuICAgICAgc3RyaW5nID0gdG9TdHJpbmcoc3RyaW5nKTtcbiAgICAgIGxlbmd0aCA9IHRvSW50ZWdlcihsZW5ndGgpO1xuXG4gICAgICB2YXIgc3RyTGVuZ3RoID0gbGVuZ3RoID8gc3RyaW5nU2l6ZShzdHJpbmcpIDogMDtcbiAgICAgIHJldHVybiAobGVuZ3RoICYmIHN0ckxlbmd0aCA8IGxlbmd0aClcbiAgICAgICAgPyAoc3RyaW5nICsgY3JlYXRlUGFkZGluZyhsZW5ndGggLSBzdHJMZW5ndGgsIGNoYXJzKSlcbiAgICAgICAgOiBzdHJpbmc7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUGFkcyBgc3RyaW5nYCBvbiB0aGUgbGVmdCBzaWRlIGlmIGl0J3Mgc2hvcnRlciB0aGFuIGBsZW5ndGhgLiBQYWRkaW5nXG4gICAgICogY2hhcmFjdGVycyBhcmUgdHJ1bmNhdGVkIGlmIHRoZXkgZXhjZWVkIGBsZW5ndGhgLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDQuMC4wXG4gICAgICogQGNhdGVnb3J5IFN0cmluZ1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBbc3RyaW5nPScnXSBUaGUgc3RyaW5nIHRvIHBhZC5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW2xlbmd0aD0wXSBUaGUgcGFkZGluZyBsZW5ndGguXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IFtjaGFycz0nICddIFRoZSBzdHJpbmcgdXNlZCBhcyBwYWRkaW5nLlxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IFJldHVybnMgdGhlIHBhZGRlZCBzdHJpbmcuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8ucGFkU3RhcnQoJ2FiYycsIDYpO1xuICAgICAqIC8vID0+ICcgICBhYmMnXG4gICAgICpcbiAgICAgKiBfLnBhZFN0YXJ0KCdhYmMnLCA2LCAnXy0nKTtcbiAgICAgKiAvLyA9PiAnXy1fYWJjJ1xuICAgICAqXG4gICAgICogXy5wYWRTdGFydCgnYWJjJywgMyk7XG4gICAgICogLy8gPT4gJ2FiYydcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBwYWRTdGFydChzdHJpbmcsIGxlbmd0aCwgY2hhcnMpIHtcbiAgICAgIHN0cmluZyA9IHRvU3RyaW5nKHN0cmluZyk7XG4gICAgICBsZW5ndGggPSB0b0ludGVnZXIobGVuZ3RoKTtcblxuICAgICAgdmFyIHN0ckxlbmd0aCA9IGxlbmd0aCA/IHN0cmluZ1NpemUoc3RyaW5nKSA6IDA7XG4gICAgICByZXR1cm4gKGxlbmd0aCAmJiBzdHJMZW5ndGggPCBsZW5ndGgpXG4gICAgICAgID8gKGNyZWF0ZVBhZGRpbmcobGVuZ3RoIC0gc3RyTGVuZ3RoLCBjaGFycykgKyBzdHJpbmcpXG4gICAgICAgIDogc3RyaW5nO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENvbnZlcnRzIGBzdHJpbmdgIHRvIGFuIGludGVnZXIgb2YgdGhlIHNwZWNpZmllZCByYWRpeC4gSWYgYHJhZGl4YCBpc1xuICAgICAqIGB1bmRlZmluZWRgIG9yIGAwYCwgYSBgcmFkaXhgIG9mIGAxMGAgaXMgdXNlZCB1bmxlc3MgYHZhbHVlYCBpcyBhXG4gICAgICogaGV4YWRlY2ltYWwsIGluIHdoaWNoIGNhc2UgYSBgcmFkaXhgIG9mIGAxNmAgaXMgdXNlZC5cbiAgICAgKlxuICAgICAqICoqTm90ZToqKiBUaGlzIG1ldGhvZCBhbGlnbnMgd2l0aCB0aGVcbiAgICAgKiBbRVM1IGltcGxlbWVudGF0aW9uXShodHRwczovL2VzNS5naXRodWIuaW8vI3gxNS4xLjIuMikgb2YgYHBhcnNlSW50YC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAxLjEuMFxuICAgICAqIEBjYXRlZ29yeSBTdHJpbmdcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gc3RyaW5nIFRoZSBzdHJpbmcgdG8gY29udmVydC5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW3JhZGl4PTEwXSBUaGUgcmFkaXggdG8gaW50ZXJwcmV0IGB2YWx1ZWAgYnkuXG4gICAgICogQHBhcmFtLSB7T2JqZWN0fSBbZ3VhcmRdIEVuYWJsZXMgdXNlIGFzIGFuIGl0ZXJhdGVlIGZvciBtZXRob2RzIGxpa2UgYF8ubWFwYC5cbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSBSZXR1cm5zIHRoZSBjb252ZXJ0ZWQgaW50ZWdlci5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5wYXJzZUludCgnMDgnKTtcbiAgICAgKiAvLyA9PiA4XG4gICAgICpcbiAgICAgKiBfLm1hcChbJzYnLCAnMDgnLCAnMTAnXSwgXy5wYXJzZUludCk7XG4gICAgICogLy8gPT4gWzYsIDgsIDEwXVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHBhcnNlSW50KHN0cmluZywgcmFkaXgsIGd1YXJkKSB7XG4gICAgICBpZiAoZ3VhcmQgfHwgcmFkaXggPT0gbnVsbCkge1xuICAgICAgICByYWRpeCA9IDA7XG4gICAgICB9IGVsc2UgaWYgKHJhZGl4KSB7XG4gICAgICAgIHJhZGl4ID0gK3JhZGl4O1xuICAgICAgfVxuICAgICAgcmV0dXJuIG5hdGl2ZVBhcnNlSW50KHRvU3RyaW5nKHN0cmluZykucmVwbGFjZShyZVRyaW1TdGFydCwgJycpLCByYWRpeCB8fCAwKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXBlYXRzIHRoZSBnaXZlbiBzdHJpbmcgYG5gIHRpbWVzLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDMuMC4wXG4gICAgICogQGNhdGVnb3J5IFN0cmluZ1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBbc3RyaW5nPScnXSBUaGUgc3RyaW5nIHRvIHJlcGVhdC5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW249MV0gVGhlIG51bWJlciBvZiB0aW1lcyB0byByZXBlYXQgdGhlIHN0cmluZy5cbiAgICAgKiBAcGFyYW0tIHtPYmplY3R9IFtndWFyZF0gRW5hYmxlcyB1c2UgYXMgYW4gaXRlcmF0ZWUgZm9yIG1ldGhvZHMgbGlrZSBgXy5tYXBgLlxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IFJldHVybnMgdGhlIHJlcGVhdGVkIHN0cmluZy5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5yZXBlYXQoJyonLCAzKTtcbiAgICAgKiAvLyA9PiAnKioqJ1xuICAgICAqXG4gICAgICogXy5yZXBlYXQoJ2FiYycsIDIpO1xuICAgICAqIC8vID0+ICdhYmNhYmMnXG4gICAgICpcbiAgICAgKiBfLnJlcGVhdCgnYWJjJywgMCk7XG4gICAgICogLy8gPT4gJydcbiAgICAgKi9cbiAgICBmdW5jdGlvbiByZXBlYXQoc3RyaW5nLCBuLCBndWFyZCkge1xuICAgICAgaWYgKChndWFyZCA/IGlzSXRlcmF0ZWVDYWxsKHN0cmluZywgbiwgZ3VhcmQpIDogbiA9PT0gdW5kZWZpbmVkKSkge1xuICAgICAgICBuID0gMTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG4gPSB0b0ludGVnZXIobik7XG4gICAgICB9XG4gICAgICByZXR1cm4gYmFzZVJlcGVhdCh0b1N0cmluZyhzdHJpbmcpLCBuKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXBsYWNlcyBtYXRjaGVzIGZvciBgcGF0dGVybmAgaW4gYHN0cmluZ2Agd2l0aCBgcmVwbGFjZW1lbnRgLlxuICAgICAqXG4gICAgICogKipOb3RlOioqIFRoaXMgbWV0aG9kIGlzIGJhc2VkIG9uXG4gICAgICogW2BTdHJpbmcjcmVwbGFjZWBdKGh0dHBzOi8vbWRuLmlvL1N0cmluZy9yZXBsYWNlKS5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSA0LjAuMFxuICAgICAqIEBjYXRlZ29yeSBTdHJpbmdcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gW3N0cmluZz0nJ10gVGhlIHN0cmluZyB0byBtb2RpZnkuXG4gICAgICogQHBhcmFtIHtSZWdFeHB8c3RyaW5nfSBwYXR0ZXJuIFRoZSBwYXR0ZXJuIHRvIHJlcGxhY2UuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbnxzdHJpbmd9IHJlcGxhY2VtZW50IFRoZSBtYXRjaCByZXBsYWNlbWVudC5cbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSBSZXR1cm5zIHRoZSBtb2RpZmllZCBzdHJpbmcuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8ucmVwbGFjZSgnSGkgRnJlZCcsICdGcmVkJywgJ0Jhcm5leScpO1xuICAgICAqIC8vID0+ICdIaSBCYXJuZXknXG4gICAgICovXG4gICAgZnVuY3Rpb24gcmVwbGFjZSgpIHtcbiAgICAgIHZhciBhcmdzID0gYXJndW1lbnRzLFxuICAgICAgICAgIHN0cmluZyA9IHRvU3RyaW5nKGFyZ3NbMF0pO1xuXG4gICAgICByZXR1cm4gYXJncy5sZW5ndGggPCAzID8gc3RyaW5nIDogc3RyaW5nLnJlcGxhY2UoYXJnc1sxXSwgYXJnc1syXSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ29udmVydHMgYHN0cmluZ2AgdG9cbiAgICAgKiBbc25ha2UgY2FzZV0oaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvU25ha2VfY2FzZSkuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMy4wLjBcbiAgICAgKiBAY2F0ZWdvcnkgU3RyaW5nXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IFtzdHJpbmc9JyddIFRoZSBzdHJpbmcgdG8gY29udmVydC5cbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSBSZXR1cm5zIHRoZSBzbmFrZSBjYXNlZCBzdHJpbmcuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8uc25ha2VDYXNlKCdGb28gQmFyJyk7XG4gICAgICogLy8gPT4gJ2Zvb19iYXInXG4gICAgICpcbiAgICAgKiBfLnNuYWtlQ2FzZSgnZm9vQmFyJyk7XG4gICAgICogLy8gPT4gJ2Zvb19iYXInXG4gICAgICpcbiAgICAgKiBfLnNuYWtlQ2FzZSgnLS1GT08tQkFSLS0nKTtcbiAgICAgKiAvLyA9PiAnZm9vX2JhcidcbiAgICAgKi9cbiAgICB2YXIgc25ha2VDYXNlID0gY3JlYXRlQ29tcG91bmRlcihmdW5jdGlvbihyZXN1bHQsIHdvcmQsIGluZGV4KSB7XG4gICAgICByZXR1cm4gcmVzdWx0ICsgKGluZGV4ID8gJ18nIDogJycpICsgd29yZC50b0xvd2VyQ2FzZSgpO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogU3BsaXRzIGBzdHJpbmdgIGJ5IGBzZXBhcmF0b3JgLlxuICAgICAqXG4gICAgICogKipOb3RlOioqIFRoaXMgbWV0aG9kIGlzIGJhc2VkIG9uXG4gICAgICogW2BTdHJpbmcjc3BsaXRgXShodHRwczovL21kbi5pby9TdHJpbmcvc3BsaXQpLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDQuMC4wXG4gICAgICogQGNhdGVnb3J5IFN0cmluZ1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBbc3RyaW5nPScnXSBUaGUgc3RyaW5nIHRvIHNwbGl0LlxuICAgICAqIEBwYXJhbSB7UmVnRXhwfHN0cmluZ30gc2VwYXJhdG9yIFRoZSBzZXBhcmF0b3IgcGF0dGVybiB0byBzcGxpdCBieS5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW2xpbWl0XSBUaGUgbGVuZ3RoIHRvIHRydW5jYXRlIHJlc3VsdHMgdG8uXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIHRoZSBzdHJpbmcgc2VnbWVudHMuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8uc3BsaXQoJ2EtYi1jJywgJy0nLCAyKTtcbiAgICAgKiAvLyA9PiBbJ2EnLCAnYiddXG4gICAgICovXG4gICAgZnVuY3Rpb24gc3BsaXQoc3RyaW5nLCBzZXBhcmF0b3IsIGxpbWl0KSB7XG4gICAgICBpZiAobGltaXQgJiYgdHlwZW9mIGxpbWl0ICE9ICdudW1iZXInICYmIGlzSXRlcmF0ZWVDYWxsKHN0cmluZywgc2VwYXJhdG9yLCBsaW1pdCkpIHtcbiAgICAgICAgc2VwYXJhdG9yID0gbGltaXQgPSB1bmRlZmluZWQ7XG4gICAgICB9XG4gICAgICBsaW1pdCA9IGxpbWl0ID09PSB1bmRlZmluZWQgPyBNQVhfQVJSQVlfTEVOR1RIIDogbGltaXQgPj4+IDA7XG4gICAgICBpZiAoIWxpbWl0KSB7XG4gICAgICAgIHJldHVybiBbXTtcbiAgICAgIH1cbiAgICAgIHN0cmluZyA9IHRvU3RyaW5nKHN0cmluZyk7XG4gICAgICBpZiAoc3RyaW5nICYmIChcbiAgICAgICAgICAgIHR5cGVvZiBzZXBhcmF0b3IgPT0gJ3N0cmluZycgfHxcbiAgICAgICAgICAgIChzZXBhcmF0b3IgIT0gbnVsbCAmJiAhaXNSZWdFeHAoc2VwYXJhdG9yKSlcbiAgICAgICAgICApKSB7XG4gICAgICAgIHNlcGFyYXRvciA9IGJhc2VUb1N0cmluZyhzZXBhcmF0b3IpO1xuICAgICAgICBpZiAoIXNlcGFyYXRvciAmJiBoYXNVbmljb2RlKHN0cmluZykpIHtcbiAgICAgICAgICByZXR1cm4gY2FzdFNsaWNlKHN0cmluZ1RvQXJyYXkoc3RyaW5nKSwgMCwgbGltaXQpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gc3RyaW5nLnNwbGl0KHNlcGFyYXRvciwgbGltaXQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENvbnZlcnRzIGBzdHJpbmdgIHRvXG4gICAgICogW3N0YXJ0IGNhc2VdKGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0xldHRlcl9jYXNlI1N0eWxpc3RpY19vcl9zcGVjaWFsaXNlZF91c2FnZSkuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMy4xLjBcbiAgICAgKiBAY2F0ZWdvcnkgU3RyaW5nXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IFtzdHJpbmc9JyddIFRoZSBzdHJpbmcgdG8gY29udmVydC5cbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSBSZXR1cm5zIHRoZSBzdGFydCBjYXNlZCBzdHJpbmcuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8uc3RhcnRDYXNlKCctLWZvby1iYXItLScpO1xuICAgICAqIC8vID0+ICdGb28gQmFyJ1xuICAgICAqXG4gICAgICogXy5zdGFydENhc2UoJ2Zvb0JhcicpO1xuICAgICAqIC8vID0+ICdGb28gQmFyJ1xuICAgICAqXG4gICAgICogXy5zdGFydENhc2UoJ19fRk9PX0JBUl9fJyk7XG4gICAgICogLy8gPT4gJ0ZPTyBCQVInXG4gICAgICovXG4gICAgdmFyIHN0YXJ0Q2FzZSA9IGNyZWF0ZUNvbXBvdW5kZXIoZnVuY3Rpb24ocmVzdWx0LCB3b3JkLCBpbmRleCkge1xuICAgICAgcmV0dXJuIHJlc3VsdCArIChpbmRleCA/ICcgJyA6ICcnKSArIHVwcGVyRmlyc3Qod29yZCk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBDaGVja3MgaWYgYHN0cmluZ2Agc3RhcnRzIHdpdGggdGhlIGdpdmVuIHRhcmdldCBzdHJpbmcuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMy4wLjBcbiAgICAgKiBAY2F0ZWdvcnkgU3RyaW5nXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IFtzdHJpbmc9JyddIFRoZSBzdHJpbmcgdG8gaW5zcGVjdC5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gW3RhcmdldF0gVGhlIHN0cmluZyB0byBzZWFyY2ggZm9yLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbcG9zaXRpb249MF0gVGhlIHBvc2l0aW9uIHRvIHNlYXJjaCBmcm9tLlxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBgc3RyaW5nYCBzdGFydHMgd2l0aCBgdGFyZ2V0YCxcbiAgICAgKiAgZWxzZSBgZmFsc2VgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLnN0YXJ0c1dpdGgoJ2FiYycsICdhJyk7XG4gICAgICogLy8gPT4gdHJ1ZVxuICAgICAqXG4gICAgICogXy5zdGFydHNXaXRoKCdhYmMnLCAnYicpO1xuICAgICAqIC8vID0+IGZhbHNlXG4gICAgICpcbiAgICAgKiBfLnN0YXJ0c1dpdGgoJ2FiYycsICdiJywgMSk7XG4gICAgICogLy8gPT4gdHJ1ZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHN0YXJ0c1dpdGgoc3RyaW5nLCB0YXJnZXQsIHBvc2l0aW9uKSB7XG4gICAgICBzdHJpbmcgPSB0b1N0cmluZyhzdHJpbmcpO1xuICAgICAgcG9zaXRpb24gPSBwb3NpdGlvbiA9PSBudWxsXG4gICAgICAgID8gMFxuICAgICAgICA6IGJhc2VDbGFtcCh0b0ludGVnZXIocG9zaXRpb24pLCAwLCBzdHJpbmcubGVuZ3RoKTtcblxuICAgICAgdGFyZ2V0ID0gYmFzZVRvU3RyaW5nKHRhcmdldCk7XG4gICAgICByZXR1cm4gc3RyaW5nLnNsaWNlKHBvc2l0aW9uLCBwb3NpdGlvbiArIHRhcmdldC5sZW5ndGgpID09IHRhcmdldDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgY29tcGlsZWQgdGVtcGxhdGUgZnVuY3Rpb24gdGhhdCBjYW4gaW50ZXJwb2xhdGUgZGF0YSBwcm9wZXJ0aWVzXG4gICAgICogaW4gXCJpbnRlcnBvbGF0ZVwiIGRlbGltaXRlcnMsIEhUTUwtZXNjYXBlIGludGVycG9sYXRlZCBkYXRhIHByb3BlcnRpZXMgaW5cbiAgICAgKiBcImVzY2FwZVwiIGRlbGltaXRlcnMsIGFuZCBleGVjdXRlIEphdmFTY3JpcHQgaW4gXCJldmFsdWF0ZVwiIGRlbGltaXRlcnMuIERhdGFcbiAgICAgKiBwcm9wZXJ0aWVzIG1heSBiZSBhY2Nlc3NlZCBhcyBmcmVlIHZhcmlhYmxlcyBpbiB0aGUgdGVtcGxhdGUuIElmIGEgc2V0dGluZ1xuICAgICAqIG9iamVjdCBpcyBnaXZlbiwgaXQgdGFrZXMgcHJlY2VkZW5jZSBvdmVyIGBfLnRlbXBsYXRlU2V0dGluZ3NgIHZhbHVlcy5cbiAgICAgKlxuICAgICAqICoqTm90ZToqKiBJbiB0aGUgZGV2ZWxvcG1lbnQgYnVpbGQgYF8udGVtcGxhdGVgIHV0aWxpemVzXG4gICAgICogW3NvdXJjZVVSTHNdKGh0dHA6Ly93d3cuaHRtbDVyb2Nrcy5jb20vZW4vdHV0b3JpYWxzL2RldmVsb3BlcnRvb2xzL3NvdXJjZW1hcHMvI3RvYy1zb3VyY2V1cmwpXG4gICAgICogZm9yIGVhc2llciBkZWJ1Z2dpbmcuXG4gICAgICpcbiAgICAgKiBGb3IgbW9yZSBpbmZvcm1hdGlvbiBvbiBwcmVjb21waWxpbmcgdGVtcGxhdGVzIHNlZVxuICAgICAqIFtsb2Rhc2gncyBjdXN0b20gYnVpbGRzIGRvY3VtZW50YXRpb25dKGh0dHBzOi8vbG9kYXNoLmNvbS9jdXN0b20tYnVpbGRzKS5cbiAgICAgKlxuICAgICAqIEZvciBtb3JlIGluZm9ybWF0aW9uIG9uIENocm9tZSBleHRlbnNpb24gc2FuZGJveGVzIHNlZVxuICAgICAqIFtDaHJvbWUncyBleHRlbnNpb25zIGRvY3VtZW50YXRpb25dKGh0dHBzOi8vZGV2ZWxvcGVyLmNocm9tZS5jb20vZXh0ZW5zaW9ucy9zYW5kYm94aW5nRXZhbCkuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQHNpbmNlIDAuMS4wXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAY2F0ZWdvcnkgU3RyaW5nXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IFtzdHJpbmc9JyddIFRoZSB0ZW1wbGF0ZSBzdHJpbmcuXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zPXt9XSBUaGUgb3B0aW9ucyBvYmplY3QuXG4gICAgICogQHBhcmFtIHtSZWdFeHB9IFtvcHRpb25zLmVzY2FwZT1fLnRlbXBsYXRlU2V0dGluZ3MuZXNjYXBlXVxuICAgICAqICBUaGUgSFRNTCBcImVzY2FwZVwiIGRlbGltaXRlci5cbiAgICAgKiBAcGFyYW0ge1JlZ0V4cH0gW29wdGlvbnMuZXZhbHVhdGU9Xy50ZW1wbGF0ZVNldHRpbmdzLmV2YWx1YXRlXVxuICAgICAqICBUaGUgXCJldmFsdWF0ZVwiIGRlbGltaXRlci5cbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW29wdGlvbnMuaW1wb3J0cz1fLnRlbXBsYXRlU2V0dGluZ3MuaW1wb3J0c11cbiAgICAgKiAgQW4gb2JqZWN0IHRvIGltcG9ydCBpbnRvIHRoZSB0ZW1wbGF0ZSBhcyBmcmVlIHZhcmlhYmxlcy5cbiAgICAgKiBAcGFyYW0ge1JlZ0V4cH0gW29wdGlvbnMuaW50ZXJwb2xhdGU9Xy50ZW1wbGF0ZVNldHRpbmdzLmludGVycG9sYXRlXVxuICAgICAqICBUaGUgXCJpbnRlcnBvbGF0ZVwiIGRlbGltaXRlci5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gW29wdGlvbnMuc291cmNlVVJMPSdsb2Rhc2gudGVtcGxhdGVTb3VyY2VzW25dJ11cbiAgICAgKiAgVGhlIHNvdXJjZVVSTCBvZiB0aGUgY29tcGlsZWQgdGVtcGxhdGUuXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IFtvcHRpb25zLnZhcmlhYmxlPSdvYmonXVxuICAgICAqICBUaGUgZGF0YSBvYmplY3QgdmFyaWFibGUgbmFtZS5cbiAgICAgKiBAcGFyYW0tIHtPYmplY3R9IFtndWFyZF0gRW5hYmxlcyB1c2UgYXMgYW4gaXRlcmF0ZWUgZm9yIG1ldGhvZHMgbGlrZSBgXy5tYXBgLlxuICAgICAqIEByZXR1cm5zIHtGdW5jdGlvbn0gUmV0dXJucyB0aGUgY29tcGlsZWQgdGVtcGxhdGUgZnVuY3Rpb24uXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIC8vIFVzZSB0aGUgXCJpbnRlcnBvbGF0ZVwiIGRlbGltaXRlciB0byBjcmVhdGUgYSBjb21waWxlZCB0ZW1wbGF0ZS5cbiAgICAgKiB2YXIgY29tcGlsZWQgPSBfLnRlbXBsYXRlKCdoZWxsbyA8JT0gdXNlciAlPiEnKTtcbiAgICAgKiBjb21waWxlZCh7ICd1c2VyJzogJ2ZyZWQnIH0pO1xuICAgICAqIC8vID0+ICdoZWxsbyBmcmVkISdcbiAgICAgKlxuICAgICAqIC8vIFVzZSB0aGUgSFRNTCBcImVzY2FwZVwiIGRlbGltaXRlciB0byBlc2NhcGUgZGF0YSBwcm9wZXJ0eSB2YWx1ZXMuXG4gICAgICogdmFyIGNvbXBpbGVkID0gXy50ZW1wbGF0ZSgnPGI+PCUtIHZhbHVlICU+PC9iPicpO1xuICAgICAqIGNvbXBpbGVkKHsgJ3ZhbHVlJzogJzxzY3JpcHQ+JyB9KTtcbiAgICAgKiAvLyA9PiAnPGI+Jmx0O3NjcmlwdCZndDs8L2I+J1xuICAgICAqXG4gICAgICogLy8gVXNlIHRoZSBcImV2YWx1YXRlXCIgZGVsaW1pdGVyIHRvIGV4ZWN1dGUgSmF2YVNjcmlwdCBhbmQgZ2VuZXJhdGUgSFRNTC5cbiAgICAgKiB2YXIgY29tcGlsZWQgPSBfLnRlbXBsYXRlKCc8JSBfLmZvckVhY2godXNlcnMsIGZ1bmN0aW9uKHVzZXIpIHsgJT48bGk+PCUtIHVzZXIgJT48L2xpPjwlIH0pOyAlPicpO1xuICAgICAqIGNvbXBpbGVkKHsgJ3VzZXJzJzogWydmcmVkJywgJ2Jhcm5leSddIH0pO1xuICAgICAqIC8vID0+ICc8bGk+ZnJlZDwvbGk+PGxpPmJhcm5leTwvbGk+J1xuICAgICAqXG4gICAgICogLy8gVXNlIHRoZSBpbnRlcm5hbCBgcHJpbnRgIGZ1bmN0aW9uIGluIFwiZXZhbHVhdGVcIiBkZWxpbWl0ZXJzLlxuICAgICAqIHZhciBjb21waWxlZCA9IF8udGVtcGxhdGUoJzwlIHByaW50KFwiaGVsbG8gXCIgKyB1c2VyKTsgJT4hJyk7XG4gICAgICogY29tcGlsZWQoeyAndXNlcic6ICdiYXJuZXknIH0pO1xuICAgICAqIC8vID0+ICdoZWxsbyBiYXJuZXkhJ1xuICAgICAqXG4gICAgICogLy8gVXNlIHRoZSBFUyB0ZW1wbGF0ZSBsaXRlcmFsIGRlbGltaXRlciBhcyBhbiBcImludGVycG9sYXRlXCIgZGVsaW1pdGVyLlxuICAgICAqIC8vIERpc2FibGUgc3VwcG9ydCBieSByZXBsYWNpbmcgdGhlIFwiaW50ZXJwb2xhdGVcIiBkZWxpbWl0ZXIuXG4gICAgICogdmFyIGNvbXBpbGVkID0gXy50ZW1wbGF0ZSgnaGVsbG8gJHsgdXNlciB9IScpO1xuICAgICAqIGNvbXBpbGVkKHsgJ3VzZXInOiAncGViYmxlcycgfSk7XG4gICAgICogLy8gPT4gJ2hlbGxvIHBlYmJsZXMhJ1xuICAgICAqXG4gICAgICogLy8gVXNlIGJhY2tzbGFzaGVzIHRvIHRyZWF0IGRlbGltaXRlcnMgYXMgcGxhaW4gdGV4dC5cbiAgICAgKiB2YXIgY29tcGlsZWQgPSBfLnRlbXBsYXRlKCc8JT0gXCJcXFxcPCUtIHZhbHVlICVcXFxcPlwiICU+Jyk7XG4gICAgICogY29tcGlsZWQoeyAndmFsdWUnOiAnaWdub3JlZCcgfSk7XG4gICAgICogLy8gPT4gJzwlLSB2YWx1ZSAlPidcbiAgICAgKlxuICAgICAqIC8vIFVzZSB0aGUgYGltcG9ydHNgIG9wdGlvbiB0byBpbXBvcnQgYGpRdWVyeWAgYXMgYGpxYC5cbiAgICAgKiB2YXIgdGV4dCA9ICc8JSBqcS5lYWNoKHVzZXJzLCBmdW5jdGlvbih1c2VyKSB7ICU+PGxpPjwlLSB1c2VyICU+PC9saT48JSB9KTsgJT4nO1xuICAgICAqIHZhciBjb21waWxlZCA9IF8udGVtcGxhdGUodGV4dCwgeyAnaW1wb3J0cyc6IHsgJ2pxJzogalF1ZXJ5IH0gfSk7XG4gICAgICogY29tcGlsZWQoeyAndXNlcnMnOiBbJ2ZyZWQnLCAnYmFybmV5J10gfSk7XG4gICAgICogLy8gPT4gJzxsaT5mcmVkPC9saT48bGk+YmFybmV5PC9saT4nXG4gICAgICpcbiAgICAgKiAvLyBVc2UgdGhlIGBzb3VyY2VVUkxgIG9wdGlvbiB0byBzcGVjaWZ5IGEgY3VzdG9tIHNvdXJjZVVSTCBmb3IgdGhlIHRlbXBsYXRlLlxuICAgICAqIHZhciBjb21waWxlZCA9IF8udGVtcGxhdGUoJ2hlbGxvIDwlPSB1c2VyICU+IScsIHsgJ3NvdXJjZVVSTCc6ICcvYmFzaWMvZ3JlZXRpbmcuanN0JyB9KTtcbiAgICAgKiBjb21waWxlZChkYXRhKTtcbiAgICAgKiAvLyA9PiBGaW5kIHRoZSBzb3VyY2Ugb2YgXCJncmVldGluZy5qc3RcIiB1bmRlciB0aGUgU291cmNlcyB0YWIgb3IgUmVzb3VyY2VzIHBhbmVsIG9mIHRoZSB3ZWIgaW5zcGVjdG9yLlxuICAgICAqXG4gICAgICogLy8gVXNlIHRoZSBgdmFyaWFibGVgIG9wdGlvbiB0byBlbnN1cmUgYSB3aXRoLXN0YXRlbWVudCBpc24ndCB1c2VkIGluIHRoZSBjb21waWxlZCB0ZW1wbGF0ZS5cbiAgICAgKiB2YXIgY29tcGlsZWQgPSBfLnRlbXBsYXRlKCdoaSA8JT0gZGF0YS51c2VyICU+IScsIHsgJ3ZhcmlhYmxlJzogJ2RhdGEnIH0pO1xuICAgICAqIGNvbXBpbGVkLnNvdXJjZTtcbiAgICAgKiAvLyA9PiBmdW5jdGlvbihkYXRhKSB7XG4gICAgICogLy8gICB2YXIgX190LCBfX3AgPSAnJztcbiAgICAgKiAvLyAgIF9fcCArPSAnaGkgJyArICgoX190ID0gKCBkYXRhLnVzZXIgKSkgPT0gbnVsbCA/ICcnIDogX190KSArICchJztcbiAgICAgKiAvLyAgIHJldHVybiBfX3A7XG4gICAgICogLy8gfVxuICAgICAqXG4gICAgICogLy8gVXNlIGN1c3RvbSB0ZW1wbGF0ZSBkZWxpbWl0ZXJzLlxuICAgICAqIF8udGVtcGxhdGVTZXR0aW5ncy5pbnRlcnBvbGF0ZSA9IC97eyhbXFxzXFxTXSs/KX19L2c7XG4gICAgICogdmFyIGNvbXBpbGVkID0gXy50ZW1wbGF0ZSgnaGVsbG8ge3sgdXNlciB9fSEnKTtcbiAgICAgKiBjb21waWxlZCh7ICd1c2VyJzogJ211c3RhY2hlJyB9KTtcbiAgICAgKiAvLyA9PiAnaGVsbG8gbXVzdGFjaGUhJ1xuICAgICAqXG4gICAgICogLy8gVXNlIHRoZSBgc291cmNlYCBwcm9wZXJ0eSB0byBpbmxpbmUgY29tcGlsZWQgdGVtcGxhdGVzIGZvciBtZWFuaW5nZnVsXG4gICAgICogLy8gbGluZSBudW1iZXJzIGluIGVycm9yIG1lc3NhZ2VzIGFuZCBzdGFjayB0cmFjZXMuXG4gICAgICogZnMud3JpdGVGaWxlU3luYyhwYXRoLmpvaW4ocHJvY2Vzcy5jd2QoKSwgJ2pzdC5qcycpLCAnXFxcbiAgICAgKiAgIHZhciBKU1QgPSB7XFxcbiAgICAgKiAgICAgXCJtYWluXCI6ICcgKyBfLnRlbXBsYXRlKG1haW5UZXh0KS5zb3VyY2UgKyAnXFxcbiAgICAgKiAgIH07XFxcbiAgICAgKiAnKTtcbiAgICAgKi9cbiAgICBmdW5jdGlvbiB0ZW1wbGF0ZShzdHJpbmcsIG9wdGlvbnMsIGd1YXJkKSB7XG4gICAgICAvLyBCYXNlZCBvbiBKb2huIFJlc2lnJ3MgYHRtcGxgIGltcGxlbWVudGF0aW9uXG4gICAgICAvLyAoaHR0cDovL2Vqb2huLm9yZy9ibG9nL2phdmFzY3JpcHQtbWljcm8tdGVtcGxhdGluZy8pXG4gICAgICAvLyBhbmQgTGF1cmEgRG9rdG9yb3ZhJ3MgZG9ULmpzIChodHRwczovL2dpdGh1Yi5jb20vb2xhZG8vZG9UKS5cbiAgICAgIHZhciBzZXR0aW5ncyA9IGxvZGFzaC50ZW1wbGF0ZVNldHRpbmdzO1xuXG4gICAgICBpZiAoZ3VhcmQgJiYgaXNJdGVyYXRlZUNhbGwoc3RyaW5nLCBvcHRpb25zLCBndWFyZCkpIHtcbiAgICAgICAgb3B0aW9ucyA9IHVuZGVmaW5lZDtcbiAgICAgIH1cbiAgICAgIHN0cmluZyA9IHRvU3RyaW5nKHN0cmluZyk7XG4gICAgICBvcHRpb25zID0gYXNzaWduSW5XaXRoKHt9LCBvcHRpb25zLCBzZXR0aW5ncywgY3VzdG9tRGVmYXVsdHNBc3NpZ25Jbik7XG5cbiAgICAgIHZhciBpbXBvcnRzID0gYXNzaWduSW5XaXRoKHt9LCBvcHRpb25zLmltcG9ydHMsIHNldHRpbmdzLmltcG9ydHMsIGN1c3RvbURlZmF1bHRzQXNzaWduSW4pLFxuICAgICAgICAgIGltcG9ydHNLZXlzID0ga2V5cyhpbXBvcnRzKSxcbiAgICAgICAgICBpbXBvcnRzVmFsdWVzID0gYmFzZVZhbHVlcyhpbXBvcnRzLCBpbXBvcnRzS2V5cyk7XG5cbiAgICAgIHZhciBpc0VzY2FwaW5nLFxuICAgICAgICAgIGlzRXZhbHVhdGluZyxcbiAgICAgICAgICBpbmRleCA9IDAsXG4gICAgICAgICAgaW50ZXJwb2xhdGUgPSBvcHRpb25zLmludGVycG9sYXRlIHx8IHJlTm9NYXRjaCxcbiAgICAgICAgICBzb3VyY2UgPSBcIl9fcCArPSAnXCI7XG5cbiAgICAgIC8vIENvbXBpbGUgdGhlIHJlZ2V4cCB0byBtYXRjaCBlYWNoIGRlbGltaXRlci5cbiAgICAgIHZhciByZURlbGltaXRlcnMgPSBSZWdFeHAoXG4gICAgICAgIChvcHRpb25zLmVzY2FwZSB8fCByZU5vTWF0Y2gpLnNvdXJjZSArICd8JyArXG4gICAgICAgIGludGVycG9sYXRlLnNvdXJjZSArICd8JyArXG4gICAgICAgIChpbnRlcnBvbGF0ZSA9PT0gcmVJbnRlcnBvbGF0ZSA/IHJlRXNUZW1wbGF0ZSA6IHJlTm9NYXRjaCkuc291cmNlICsgJ3wnICtcbiAgICAgICAgKG9wdGlvbnMuZXZhbHVhdGUgfHwgcmVOb01hdGNoKS5zb3VyY2UgKyAnfCQnXG4gICAgICAsICdnJyk7XG5cbiAgICAgIC8vIFVzZSBhIHNvdXJjZVVSTCBmb3IgZWFzaWVyIGRlYnVnZ2luZy5cbiAgICAgIHZhciBzb3VyY2VVUkwgPSAnLy8jIHNvdXJjZVVSTD0nICtcbiAgICAgICAgKCdzb3VyY2VVUkwnIGluIG9wdGlvbnNcbiAgICAgICAgICA/IG9wdGlvbnMuc291cmNlVVJMXG4gICAgICAgICAgOiAoJ2xvZGFzaC50ZW1wbGF0ZVNvdXJjZXNbJyArICgrK3RlbXBsYXRlQ291bnRlcikgKyAnXScpXG4gICAgICAgICkgKyAnXFxuJztcblxuICAgICAgc3RyaW5nLnJlcGxhY2UocmVEZWxpbWl0ZXJzLCBmdW5jdGlvbihtYXRjaCwgZXNjYXBlVmFsdWUsIGludGVycG9sYXRlVmFsdWUsIGVzVGVtcGxhdGVWYWx1ZSwgZXZhbHVhdGVWYWx1ZSwgb2Zmc2V0KSB7XG4gICAgICAgIGludGVycG9sYXRlVmFsdWUgfHwgKGludGVycG9sYXRlVmFsdWUgPSBlc1RlbXBsYXRlVmFsdWUpO1xuXG4gICAgICAgIC8vIEVzY2FwZSBjaGFyYWN0ZXJzIHRoYXQgY2FuJ3QgYmUgaW5jbHVkZWQgaW4gc3RyaW5nIGxpdGVyYWxzLlxuICAgICAgICBzb3VyY2UgKz0gc3RyaW5nLnNsaWNlKGluZGV4LCBvZmZzZXQpLnJlcGxhY2UocmVVbmVzY2FwZWRTdHJpbmcsIGVzY2FwZVN0cmluZ0NoYXIpO1xuXG4gICAgICAgIC8vIFJlcGxhY2UgZGVsaW1pdGVycyB3aXRoIHNuaXBwZXRzLlxuICAgICAgICBpZiAoZXNjYXBlVmFsdWUpIHtcbiAgICAgICAgICBpc0VzY2FwaW5nID0gdHJ1ZTtcbiAgICAgICAgICBzb3VyY2UgKz0gXCInICtcXG5fX2UoXCIgKyBlc2NhcGVWYWx1ZSArIFwiKSArXFxuJ1wiO1xuICAgICAgICB9XG4gICAgICAgIGlmIChldmFsdWF0ZVZhbHVlKSB7XG4gICAgICAgICAgaXNFdmFsdWF0aW5nID0gdHJ1ZTtcbiAgICAgICAgICBzb3VyY2UgKz0gXCInO1xcblwiICsgZXZhbHVhdGVWYWx1ZSArIFwiO1xcbl9fcCArPSAnXCI7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGludGVycG9sYXRlVmFsdWUpIHtcbiAgICAgICAgICBzb3VyY2UgKz0gXCInICtcXG4oKF9fdCA9IChcIiArIGludGVycG9sYXRlVmFsdWUgKyBcIikpID09IG51bGwgPyAnJyA6IF9fdCkgK1xcbidcIjtcbiAgICAgICAgfVxuICAgICAgICBpbmRleCA9IG9mZnNldCArIG1hdGNoLmxlbmd0aDtcblxuICAgICAgICAvLyBUaGUgSlMgZW5naW5lIGVtYmVkZGVkIGluIEFkb2JlIHByb2R1Y3RzIG5lZWRzIGBtYXRjaGAgcmV0dXJuZWQgaW5cbiAgICAgICAgLy8gb3JkZXIgdG8gcHJvZHVjZSB0aGUgY29ycmVjdCBgb2Zmc2V0YCB2YWx1ZS5cbiAgICAgICAgcmV0dXJuIG1hdGNoO1xuICAgICAgfSk7XG5cbiAgICAgIHNvdXJjZSArPSBcIic7XFxuXCI7XG5cbiAgICAgIC8vIElmIGB2YXJpYWJsZWAgaXMgbm90IHNwZWNpZmllZCB3cmFwIGEgd2l0aC1zdGF0ZW1lbnQgYXJvdW5kIHRoZSBnZW5lcmF0ZWRcbiAgICAgIC8vIGNvZGUgdG8gYWRkIHRoZSBkYXRhIG9iamVjdCB0byB0aGUgdG9wIG9mIHRoZSBzY29wZSBjaGFpbi5cbiAgICAgIHZhciB2YXJpYWJsZSA9IG9wdGlvbnMudmFyaWFibGU7XG4gICAgICBpZiAoIXZhcmlhYmxlKSB7XG4gICAgICAgIHNvdXJjZSA9ICd3aXRoIChvYmopIHtcXG4nICsgc291cmNlICsgJ1xcbn1cXG4nO1xuICAgICAgfVxuICAgICAgLy8gQ2xlYW51cCBjb2RlIGJ5IHN0cmlwcGluZyBlbXB0eSBzdHJpbmdzLlxuICAgICAgc291cmNlID0gKGlzRXZhbHVhdGluZyA/IHNvdXJjZS5yZXBsYWNlKHJlRW1wdHlTdHJpbmdMZWFkaW5nLCAnJykgOiBzb3VyY2UpXG4gICAgICAgIC5yZXBsYWNlKHJlRW1wdHlTdHJpbmdNaWRkbGUsICckMScpXG4gICAgICAgIC5yZXBsYWNlKHJlRW1wdHlTdHJpbmdUcmFpbGluZywgJyQxOycpO1xuXG4gICAgICAvLyBGcmFtZSBjb2RlIGFzIHRoZSBmdW5jdGlvbiBib2R5LlxuICAgICAgc291cmNlID0gJ2Z1bmN0aW9uKCcgKyAodmFyaWFibGUgfHwgJ29iaicpICsgJykge1xcbicgK1xuICAgICAgICAodmFyaWFibGVcbiAgICAgICAgICA/ICcnXG4gICAgICAgICAgOiAnb2JqIHx8IChvYmogPSB7fSk7XFxuJ1xuICAgICAgICApICtcbiAgICAgICAgXCJ2YXIgX190LCBfX3AgPSAnJ1wiICtcbiAgICAgICAgKGlzRXNjYXBpbmdcbiAgICAgICAgICAgPyAnLCBfX2UgPSBfLmVzY2FwZSdcbiAgICAgICAgICAgOiAnJ1xuICAgICAgICApICtcbiAgICAgICAgKGlzRXZhbHVhdGluZ1xuICAgICAgICAgID8gJywgX19qID0gQXJyYXkucHJvdG90eXBlLmpvaW47XFxuJyArXG4gICAgICAgICAgICBcImZ1bmN0aW9uIHByaW50KCkgeyBfX3AgKz0gX19qLmNhbGwoYXJndW1lbnRzLCAnJykgfVxcblwiXG4gICAgICAgICAgOiAnO1xcbidcbiAgICAgICAgKSArXG4gICAgICAgIHNvdXJjZSArXG4gICAgICAgICdyZXR1cm4gX19wXFxufSc7XG5cbiAgICAgIHZhciByZXN1bHQgPSBhdHRlbXB0KGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gRnVuY3Rpb24oaW1wb3J0c0tleXMsIHNvdXJjZVVSTCArICdyZXR1cm4gJyArIHNvdXJjZSlcbiAgICAgICAgICAuYXBwbHkodW5kZWZpbmVkLCBpbXBvcnRzVmFsdWVzKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBQcm92aWRlIHRoZSBjb21waWxlZCBmdW5jdGlvbidzIHNvdXJjZSBieSBpdHMgYHRvU3RyaW5nYCBtZXRob2Qgb3JcbiAgICAgIC8vIHRoZSBgc291cmNlYCBwcm9wZXJ0eSBhcyBhIGNvbnZlbmllbmNlIGZvciBpbmxpbmluZyBjb21waWxlZCB0ZW1wbGF0ZXMuXG4gICAgICByZXN1bHQuc291cmNlID0gc291cmNlO1xuICAgICAgaWYgKGlzRXJyb3IocmVzdWx0KSkge1xuICAgICAgICB0aHJvdyByZXN1bHQ7XG4gICAgICB9XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENvbnZlcnRzIGBzdHJpbmdgLCBhcyBhIHdob2xlLCB0byBsb3dlciBjYXNlIGp1c3QgbGlrZVxuICAgICAqIFtTdHJpbmcjdG9Mb3dlckNhc2VdKGh0dHBzOi8vbWRuLmlvL3RvTG93ZXJDYXNlKS5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSA0LjAuMFxuICAgICAqIEBjYXRlZ29yeSBTdHJpbmdcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gW3N0cmluZz0nJ10gVGhlIHN0cmluZyB0byBjb252ZXJ0LlxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IFJldHVybnMgdGhlIGxvd2VyIGNhc2VkIHN0cmluZy5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy50b0xvd2VyKCctLUZvby1CYXItLScpO1xuICAgICAqIC8vID0+ICctLWZvby1iYXItLSdcbiAgICAgKlxuICAgICAqIF8udG9Mb3dlcignZm9vQmFyJyk7XG4gICAgICogLy8gPT4gJ2Zvb2JhcidcbiAgICAgKlxuICAgICAqIF8udG9Mb3dlcignX19GT09fQkFSX18nKTtcbiAgICAgKiAvLyA9PiAnX19mb29fYmFyX18nXG4gICAgICovXG4gICAgZnVuY3Rpb24gdG9Mb3dlcih2YWx1ZSkge1xuICAgICAgcmV0dXJuIHRvU3RyaW5nKHZhbHVlKS50b0xvd2VyQ2FzZSgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENvbnZlcnRzIGBzdHJpbmdgLCBhcyBhIHdob2xlLCB0byB1cHBlciBjYXNlIGp1c3QgbGlrZVxuICAgICAqIFtTdHJpbmcjdG9VcHBlckNhc2VdKGh0dHBzOi8vbWRuLmlvL3RvVXBwZXJDYXNlKS5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSA0LjAuMFxuICAgICAqIEBjYXRlZ29yeSBTdHJpbmdcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gW3N0cmluZz0nJ10gVGhlIHN0cmluZyB0byBjb252ZXJ0LlxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IFJldHVybnMgdGhlIHVwcGVyIGNhc2VkIHN0cmluZy5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy50b1VwcGVyKCctLWZvby1iYXItLScpO1xuICAgICAqIC8vID0+ICctLUZPTy1CQVItLSdcbiAgICAgKlxuICAgICAqIF8udG9VcHBlcignZm9vQmFyJyk7XG4gICAgICogLy8gPT4gJ0ZPT0JBUidcbiAgICAgKlxuICAgICAqIF8udG9VcHBlcignX19mb29fYmFyX18nKTtcbiAgICAgKiAvLyA9PiAnX19GT09fQkFSX18nXG4gICAgICovXG4gICAgZnVuY3Rpb24gdG9VcHBlcih2YWx1ZSkge1xuICAgICAgcmV0dXJuIHRvU3RyaW5nKHZhbHVlKS50b1VwcGVyQ2FzZSgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlbW92ZXMgbGVhZGluZyBhbmQgdHJhaWxpbmcgd2hpdGVzcGFjZSBvciBzcGVjaWZpZWQgY2hhcmFjdGVycyBmcm9tIGBzdHJpbmdgLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDMuMC4wXG4gICAgICogQGNhdGVnb3J5IFN0cmluZ1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBbc3RyaW5nPScnXSBUaGUgc3RyaW5nIHRvIHRyaW0uXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IFtjaGFycz13aGl0ZXNwYWNlXSBUaGUgY2hhcmFjdGVycyB0byB0cmltLlxuICAgICAqIEBwYXJhbS0ge09iamVjdH0gW2d1YXJkXSBFbmFibGVzIHVzZSBhcyBhbiBpdGVyYXRlZSBmb3IgbWV0aG9kcyBsaWtlIGBfLm1hcGAuXG4gICAgICogQHJldHVybnMge3N0cmluZ30gUmV0dXJucyB0aGUgdHJpbW1lZCBzdHJpbmcuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8udHJpbSgnICBhYmMgICcpO1xuICAgICAqIC8vID0+ICdhYmMnXG4gICAgICpcbiAgICAgKiBfLnRyaW0oJy1fLWFiYy1fLScsICdfLScpO1xuICAgICAqIC8vID0+ICdhYmMnXG4gICAgICpcbiAgICAgKiBfLm1hcChbJyAgZm9vICAnLCAnICBiYXIgICddLCBfLnRyaW0pO1xuICAgICAqIC8vID0+IFsnZm9vJywgJ2JhciddXG4gICAgICovXG4gICAgZnVuY3Rpb24gdHJpbShzdHJpbmcsIGNoYXJzLCBndWFyZCkge1xuICAgICAgc3RyaW5nID0gdG9TdHJpbmcoc3RyaW5nKTtcbiAgICAgIGlmIChzdHJpbmcgJiYgKGd1YXJkIHx8IGNoYXJzID09PSB1bmRlZmluZWQpKSB7XG4gICAgICAgIHJldHVybiBzdHJpbmcucmVwbGFjZShyZVRyaW0sICcnKTtcbiAgICAgIH1cbiAgICAgIGlmICghc3RyaW5nIHx8ICEoY2hhcnMgPSBiYXNlVG9TdHJpbmcoY2hhcnMpKSkge1xuICAgICAgICByZXR1cm4gc3RyaW5nO1xuICAgICAgfVxuICAgICAgdmFyIHN0clN5bWJvbHMgPSBzdHJpbmdUb0FycmF5KHN0cmluZyksXG4gICAgICAgICAgY2hyU3ltYm9scyA9IHN0cmluZ1RvQXJyYXkoY2hhcnMpLFxuICAgICAgICAgIHN0YXJ0ID0gY2hhcnNTdGFydEluZGV4KHN0clN5bWJvbHMsIGNoclN5bWJvbHMpLFxuICAgICAgICAgIGVuZCA9IGNoYXJzRW5kSW5kZXgoc3RyU3ltYm9scywgY2hyU3ltYm9scykgKyAxO1xuXG4gICAgICByZXR1cm4gY2FzdFNsaWNlKHN0clN5bWJvbHMsIHN0YXJ0LCBlbmQpLmpvaW4oJycpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlbW92ZXMgdHJhaWxpbmcgd2hpdGVzcGFjZSBvciBzcGVjaWZpZWQgY2hhcmFjdGVycyBmcm9tIGBzdHJpbmdgLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDQuMC4wXG4gICAgICogQGNhdGVnb3J5IFN0cmluZ1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBbc3RyaW5nPScnXSBUaGUgc3RyaW5nIHRvIHRyaW0uXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IFtjaGFycz13aGl0ZXNwYWNlXSBUaGUgY2hhcmFjdGVycyB0byB0cmltLlxuICAgICAqIEBwYXJhbS0ge09iamVjdH0gW2d1YXJkXSBFbmFibGVzIHVzZSBhcyBhbiBpdGVyYXRlZSBmb3IgbWV0aG9kcyBsaWtlIGBfLm1hcGAuXG4gICAgICogQHJldHVybnMge3N0cmluZ30gUmV0dXJucyB0aGUgdHJpbW1lZCBzdHJpbmcuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8udHJpbUVuZCgnICBhYmMgICcpO1xuICAgICAqIC8vID0+ICcgIGFiYydcbiAgICAgKlxuICAgICAqIF8udHJpbUVuZCgnLV8tYWJjLV8tJywgJ18tJyk7XG4gICAgICogLy8gPT4gJy1fLWFiYydcbiAgICAgKi9cbiAgICBmdW5jdGlvbiB0cmltRW5kKHN0cmluZywgY2hhcnMsIGd1YXJkKSB7XG4gICAgICBzdHJpbmcgPSB0b1N0cmluZyhzdHJpbmcpO1xuICAgICAgaWYgKHN0cmluZyAmJiAoZ3VhcmQgfHwgY2hhcnMgPT09IHVuZGVmaW5lZCkpIHtcbiAgICAgICAgcmV0dXJuIHN0cmluZy5yZXBsYWNlKHJlVHJpbUVuZCwgJycpO1xuICAgICAgfVxuICAgICAgaWYgKCFzdHJpbmcgfHwgIShjaGFycyA9IGJhc2VUb1N0cmluZyhjaGFycykpKSB7XG4gICAgICAgIHJldHVybiBzdHJpbmc7XG4gICAgICB9XG4gICAgICB2YXIgc3RyU3ltYm9scyA9IHN0cmluZ1RvQXJyYXkoc3RyaW5nKSxcbiAgICAgICAgICBlbmQgPSBjaGFyc0VuZEluZGV4KHN0clN5bWJvbHMsIHN0cmluZ1RvQXJyYXkoY2hhcnMpKSArIDE7XG5cbiAgICAgIHJldHVybiBjYXN0U2xpY2Uoc3RyU3ltYm9scywgMCwgZW5kKS5qb2luKCcnKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZW1vdmVzIGxlYWRpbmcgd2hpdGVzcGFjZSBvciBzcGVjaWZpZWQgY2hhcmFjdGVycyBmcm9tIGBzdHJpbmdgLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDQuMC4wXG4gICAgICogQGNhdGVnb3J5IFN0cmluZ1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBbc3RyaW5nPScnXSBUaGUgc3RyaW5nIHRvIHRyaW0uXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IFtjaGFycz13aGl0ZXNwYWNlXSBUaGUgY2hhcmFjdGVycyB0byB0cmltLlxuICAgICAqIEBwYXJhbS0ge09iamVjdH0gW2d1YXJkXSBFbmFibGVzIHVzZSBhcyBhbiBpdGVyYXRlZSBmb3IgbWV0aG9kcyBsaWtlIGBfLm1hcGAuXG4gICAgICogQHJldHVybnMge3N0cmluZ30gUmV0dXJucyB0aGUgdHJpbW1lZCBzdHJpbmcuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8udHJpbVN0YXJ0KCcgIGFiYyAgJyk7XG4gICAgICogLy8gPT4gJ2FiYyAgJ1xuICAgICAqXG4gICAgICogXy50cmltU3RhcnQoJy1fLWFiYy1fLScsICdfLScpO1xuICAgICAqIC8vID0+ICdhYmMtXy0nXG4gICAgICovXG4gICAgZnVuY3Rpb24gdHJpbVN0YXJ0KHN0cmluZywgY2hhcnMsIGd1YXJkKSB7XG4gICAgICBzdHJpbmcgPSB0b1N0cmluZyhzdHJpbmcpO1xuICAgICAgaWYgKHN0cmluZyAmJiAoZ3VhcmQgfHwgY2hhcnMgPT09IHVuZGVmaW5lZCkpIHtcbiAgICAgICAgcmV0dXJuIHN0cmluZy5yZXBsYWNlKHJlVHJpbVN0YXJ0LCAnJyk7XG4gICAgICB9XG4gICAgICBpZiAoIXN0cmluZyB8fCAhKGNoYXJzID0gYmFzZVRvU3RyaW5nKGNoYXJzKSkpIHtcbiAgICAgICAgcmV0dXJuIHN0cmluZztcbiAgICAgIH1cbiAgICAgIHZhciBzdHJTeW1ib2xzID0gc3RyaW5nVG9BcnJheShzdHJpbmcpLFxuICAgICAgICAgIHN0YXJ0ID0gY2hhcnNTdGFydEluZGV4KHN0clN5bWJvbHMsIHN0cmluZ1RvQXJyYXkoY2hhcnMpKTtcblxuICAgICAgcmV0dXJuIGNhc3RTbGljZShzdHJTeW1ib2xzLCBzdGFydCkuam9pbignJyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVHJ1bmNhdGVzIGBzdHJpbmdgIGlmIGl0J3MgbG9uZ2VyIHRoYW4gdGhlIGdpdmVuIG1heGltdW0gc3RyaW5nIGxlbmd0aC5cbiAgICAgKiBUaGUgbGFzdCBjaGFyYWN0ZXJzIG9mIHRoZSB0cnVuY2F0ZWQgc3RyaW5nIGFyZSByZXBsYWNlZCB3aXRoIHRoZSBvbWlzc2lvblxuICAgICAqIHN0cmluZyB3aGljaCBkZWZhdWx0cyB0byBcIi4uLlwiLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDQuMC4wXG4gICAgICogQGNhdGVnb3J5IFN0cmluZ1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBbc3RyaW5nPScnXSBUaGUgc3RyaW5nIHRvIHRydW5jYXRlLlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9ucz17fV0gVGhlIG9wdGlvbnMgb2JqZWN0LlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbb3B0aW9ucy5sZW5ndGg9MzBdIFRoZSBtYXhpbXVtIHN0cmluZyBsZW5ndGguXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IFtvcHRpb25zLm9taXNzaW9uPScuLi4nXSBUaGUgc3RyaW5nIHRvIGluZGljYXRlIHRleHQgaXMgb21pdHRlZC5cbiAgICAgKiBAcGFyYW0ge1JlZ0V4cHxzdHJpbmd9IFtvcHRpb25zLnNlcGFyYXRvcl0gVGhlIHNlcGFyYXRvciBwYXR0ZXJuIHRvIHRydW5jYXRlIHRvLlxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IFJldHVybnMgdGhlIHRydW5jYXRlZCBzdHJpbmcuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8udHJ1bmNhdGUoJ2hpLWRpZGRseS1obyB0aGVyZSwgbmVpZ2hib3Jpbm8nKTtcbiAgICAgKiAvLyA9PiAnaGktZGlkZGx5LWhvIHRoZXJlLCBuZWlnaGJvLi4uJ1xuICAgICAqXG4gICAgICogXy50cnVuY2F0ZSgnaGktZGlkZGx5LWhvIHRoZXJlLCBuZWlnaGJvcmlubycsIHtcbiAgICAgKiAgICdsZW5ndGgnOiAyNCxcbiAgICAgKiAgICdzZXBhcmF0b3InOiAnICdcbiAgICAgKiB9KTtcbiAgICAgKiAvLyA9PiAnaGktZGlkZGx5LWhvIHRoZXJlLC4uLidcbiAgICAgKlxuICAgICAqIF8udHJ1bmNhdGUoJ2hpLWRpZGRseS1obyB0aGVyZSwgbmVpZ2hib3Jpbm8nLCB7XG4gICAgICogICAnbGVuZ3RoJzogMjQsXG4gICAgICogICAnc2VwYXJhdG9yJzogLyw/ICsvXG4gICAgICogfSk7XG4gICAgICogLy8gPT4gJ2hpLWRpZGRseS1obyB0aGVyZS4uLidcbiAgICAgKlxuICAgICAqIF8udHJ1bmNhdGUoJ2hpLWRpZGRseS1obyB0aGVyZSwgbmVpZ2hib3Jpbm8nLCB7XG4gICAgICogICAnb21pc3Npb24nOiAnIFsuLi5dJ1xuICAgICAqIH0pO1xuICAgICAqIC8vID0+ICdoaS1kaWRkbHktaG8gdGhlcmUsIG5laWcgWy4uLl0nXG4gICAgICovXG4gICAgZnVuY3Rpb24gdHJ1bmNhdGUoc3RyaW5nLCBvcHRpb25zKSB7XG4gICAgICB2YXIgbGVuZ3RoID0gREVGQVVMVF9UUlVOQ19MRU5HVEgsXG4gICAgICAgICAgb21pc3Npb24gPSBERUZBVUxUX1RSVU5DX09NSVNTSU9OO1xuXG4gICAgICBpZiAoaXNPYmplY3Qob3B0aW9ucykpIHtcbiAgICAgICAgdmFyIHNlcGFyYXRvciA9ICdzZXBhcmF0b3InIGluIG9wdGlvbnMgPyBvcHRpb25zLnNlcGFyYXRvciA6IHNlcGFyYXRvcjtcbiAgICAgICAgbGVuZ3RoID0gJ2xlbmd0aCcgaW4gb3B0aW9ucyA/IHRvSW50ZWdlcihvcHRpb25zLmxlbmd0aCkgOiBsZW5ndGg7XG4gICAgICAgIG9taXNzaW9uID0gJ29taXNzaW9uJyBpbiBvcHRpb25zID8gYmFzZVRvU3RyaW5nKG9wdGlvbnMub21pc3Npb24pIDogb21pc3Npb247XG4gICAgICB9XG4gICAgICBzdHJpbmcgPSB0b1N0cmluZyhzdHJpbmcpO1xuXG4gICAgICB2YXIgc3RyTGVuZ3RoID0gc3RyaW5nLmxlbmd0aDtcbiAgICAgIGlmIChoYXNVbmljb2RlKHN0cmluZykpIHtcbiAgICAgICAgdmFyIHN0clN5bWJvbHMgPSBzdHJpbmdUb0FycmF5KHN0cmluZyk7XG4gICAgICAgIHN0ckxlbmd0aCA9IHN0clN5bWJvbHMubGVuZ3RoO1xuICAgICAgfVxuICAgICAgaWYgKGxlbmd0aCA+PSBzdHJMZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIHN0cmluZztcbiAgICAgIH1cbiAgICAgIHZhciBlbmQgPSBsZW5ndGggLSBzdHJpbmdTaXplKG9taXNzaW9uKTtcbiAgICAgIGlmIChlbmQgPCAxKSB7XG4gICAgICAgIHJldHVybiBvbWlzc2lvbjtcbiAgICAgIH1cbiAgICAgIHZhciByZXN1bHQgPSBzdHJTeW1ib2xzXG4gICAgICAgID8gY2FzdFNsaWNlKHN0clN5bWJvbHMsIDAsIGVuZCkuam9pbignJylcbiAgICAgICAgOiBzdHJpbmcuc2xpY2UoMCwgZW5kKTtcblxuICAgICAgaWYgKHNlcGFyYXRvciA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiByZXN1bHQgKyBvbWlzc2lvbjtcbiAgICAgIH1cbiAgICAgIGlmIChzdHJTeW1ib2xzKSB7XG4gICAgICAgIGVuZCArPSAocmVzdWx0Lmxlbmd0aCAtIGVuZCk7XG4gICAgICB9XG4gICAgICBpZiAoaXNSZWdFeHAoc2VwYXJhdG9yKSkge1xuICAgICAgICBpZiAoc3RyaW5nLnNsaWNlKGVuZCkuc2VhcmNoKHNlcGFyYXRvcikpIHtcbiAgICAgICAgICB2YXIgbWF0Y2gsXG4gICAgICAgICAgICAgIHN1YnN0cmluZyA9IHJlc3VsdDtcblxuICAgICAgICAgIGlmICghc2VwYXJhdG9yLmdsb2JhbCkge1xuICAgICAgICAgICAgc2VwYXJhdG9yID0gUmVnRXhwKHNlcGFyYXRvci5zb3VyY2UsIHRvU3RyaW5nKHJlRmxhZ3MuZXhlYyhzZXBhcmF0b3IpKSArICdnJyk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHNlcGFyYXRvci5sYXN0SW5kZXggPSAwO1xuICAgICAgICAgIHdoaWxlICgobWF0Y2ggPSBzZXBhcmF0b3IuZXhlYyhzdWJzdHJpbmcpKSkge1xuICAgICAgICAgICAgdmFyIG5ld0VuZCA9IG1hdGNoLmluZGV4O1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXN1bHQgPSByZXN1bHQuc2xpY2UoMCwgbmV3RW5kID09PSB1bmRlZmluZWQgPyBlbmQgOiBuZXdFbmQpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKHN0cmluZy5pbmRleE9mKGJhc2VUb1N0cmluZyhzZXBhcmF0b3IpLCBlbmQpICE9IGVuZCkge1xuICAgICAgICB2YXIgaW5kZXggPSByZXN1bHQubGFzdEluZGV4T2Yoc2VwYXJhdG9yKTtcbiAgICAgICAgaWYgKGluZGV4ID4gLTEpIHtcbiAgICAgICAgICByZXN1bHQgPSByZXN1bHQuc2xpY2UoMCwgaW5kZXgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gcmVzdWx0ICsgb21pc3Npb247XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIGludmVyc2Ugb2YgYF8uZXNjYXBlYDsgdGhpcyBtZXRob2QgY29udmVydHMgdGhlIEhUTUwgZW50aXRpZXNcbiAgICAgKiBgJmFtcDtgLCBgJmx0O2AsIGAmZ3Q7YCwgYCZxdW90O2AsIGFuZCBgJiMzOTtgIGluIGBzdHJpbmdgIHRvXG4gICAgICogdGhlaXIgY29ycmVzcG9uZGluZyBjaGFyYWN0ZXJzLlxuICAgICAqXG4gICAgICogKipOb3RlOioqIE5vIG90aGVyIEhUTUwgZW50aXRpZXMgYXJlIHVuZXNjYXBlZC4gVG8gdW5lc2NhcGUgYWRkaXRpb25hbFxuICAgICAqIEhUTUwgZW50aXRpZXMgdXNlIGEgdGhpcmQtcGFydHkgbGlicmFyeSBsaWtlIFtfaGVfXShodHRwczovL210aHMuYmUvaGUpLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDAuNi4wXG4gICAgICogQGNhdGVnb3J5IFN0cmluZ1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBbc3RyaW5nPScnXSBUaGUgc3RyaW5nIHRvIHVuZXNjYXBlLlxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IFJldHVybnMgdGhlIHVuZXNjYXBlZCBzdHJpbmcuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8udW5lc2NhcGUoJ2ZyZWQsIGJhcm5leSwgJmFtcDsgcGViYmxlcycpO1xuICAgICAqIC8vID0+ICdmcmVkLCBiYXJuZXksICYgcGViYmxlcydcbiAgICAgKi9cbiAgICBmdW5jdGlvbiB1bmVzY2FwZShzdHJpbmcpIHtcbiAgICAgIHN0cmluZyA9IHRvU3RyaW5nKHN0cmluZyk7XG4gICAgICByZXR1cm4gKHN0cmluZyAmJiByZUhhc0VzY2FwZWRIdG1sLnRlc3Qoc3RyaW5nKSlcbiAgICAgICAgPyBzdHJpbmcucmVwbGFjZShyZUVzY2FwZWRIdG1sLCB1bmVzY2FwZUh0bWxDaGFyKVxuICAgICAgICA6IHN0cmluZztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDb252ZXJ0cyBgc3RyaW5nYCwgYXMgc3BhY2Ugc2VwYXJhdGVkIHdvcmRzLCB0byB1cHBlciBjYXNlLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDQuMC4wXG4gICAgICogQGNhdGVnb3J5IFN0cmluZ1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBbc3RyaW5nPScnXSBUaGUgc3RyaW5nIHRvIGNvbnZlcnQuXG4gICAgICogQHJldHVybnMge3N0cmluZ30gUmV0dXJucyB0aGUgdXBwZXIgY2FzZWQgc3RyaW5nLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLnVwcGVyQ2FzZSgnLS1mb28tYmFyJyk7XG4gICAgICogLy8gPT4gJ0ZPTyBCQVInXG4gICAgICpcbiAgICAgKiBfLnVwcGVyQ2FzZSgnZm9vQmFyJyk7XG4gICAgICogLy8gPT4gJ0ZPTyBCQVInXG4gICAgICpcbiAgICAgKiBfLnVwcGVyQ2FzZSgnX19mb29fYmFyX18nKTtcbiAgICAgKiAvLyA9PiAnRk9PIEJBUidcbiAgICAgKi9cbiAgICB2YXIgdXBwZXJDYXNlID0gY3JlYXRlQ29tcG91bmRlcihmdW5jdGlvbihyZXN1bHQsIHdvcmQsIGluZGV4KSB7XG4gICAgICByZXR1cm4gcmVzdWx0ICsgKGluZGV4ID8gJyAnIDogJycpICsgd29yZC50b1VwcGVyQ2FzZSgpO1xuICAgIH0pO1xuXG4gICAgLyoqXG4gICAgICogQ29udmVydHMgdGhlIGZpcnN0IGNoYXJhY3RlciBvZiBgc3RyaW5nYCB0byB1cHBlciBjYXNlLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDQuMC4wXG4gICAgICogQGNhdGVnb3J5IFN0cmluZ1xuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBbc3RyaW5nPScnXSBUaGUgc3RyaW5nIHRvIGNvbnZlcnQuXG4gICAgICogQHJldHVybnMge3N0cmluZ30gUmV0dXJucyB0aGUgY29udmVydGVkIHN0cmluZy5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy51cHBlckZpcnN0KCdmcmVkJyk7XG4gICAgICogLy8gPT4gJ0ZyZWQnXG4gICAgICpcbiAgICAgKiBfLnVwcGVyRmlyc3QoJ0ZSRUQnKTtcbiAgICAgKiAvLyA9PiAnRlJFRCdcbiAgICAgKi9cbiAgICB2YXIgdXBwZXJGaXJzdCA9IGNyZWF0ZUNhc2VGaXJzdCgndG9VcHBlckNhc2UnKTtcblxuICAgIC8qKlxuICAgICAqIFNwbGl0cyBgc3RyaW5nYCBpbnRvIGFuIGFycmF5IG9mIGl0cyB3b3Jkcy5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAzLjAuMFxuICAgICAqIEBjYXRlZ29yeSBTdHJpbmdcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gW3N0cmluZz0nJ10gVGhlIHN0cmluZyB0byBpbnNwZWN0LlxuICAgICAqIEBwYXJhbSB7UmVnRXhwfHN0cmluZ30gW3BhdHRlcm5dIFRoZSBwYXR0ZXJuIHRvIG1hdGNoIHdvcmRzLlxuICAgICAqIEBwYXJhbS0ge09iamVjdH0gW2d1YXJkXSBFbmFibGVzIHVzZSBhcyBhbiBpdGVyYXRlZSBmb3IgbWV0aG9kcyBsaWtlIGBfLm1hcGAuXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIHRoZSB3b3JkcyBvZiBgc3RyaW5nYC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy53b3JkcygnZnJlZCwgYmFybmV5LCAmIHBlYmJsZXMnKTtcbiAgICAgKiAvLyA9PiBbJ2ZyZWQnLCAnYmFybmV5JywgJ3BlYmJsZXMnXVxuICAgICAqXG4gICAgICogXy53b3JkcygnZnJlZCwgYmFybmV5LCAmIHBlYmJsZXMnLCAvW14sIF0rL2cpO1xuICAgICAqIC8vID0+IFsnZnJlZCcsICdiYXJuZXknLCAnJicsICdwZWJibGVzJ11cbiAgICAgKi9cbiAgICBmdW5jdGlvbiB3b3JkcyhzdHJpbmcsIHBhdHRlcm4sIGd1YXJkKSB7XG4gICAgICBzdHJpbmcgPSB0b1N0cmluZyhzdHJpbmcpO1xuICAgICAgcGF0dGVybiA9IGd1YXJkID8gdW5kZWZpbmVkIDogcGF0dGVybjtcblxuICAgICAgaWYgKHBhdHRlcm4gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gaGFzVW5pY29kZVdvcmQoc3RyaW5nKSA/IHVuaWNvZGVXb3JkcyhzdHJpbmcpIDogYXNjaWlXb3JkcyhzdHJpbmcpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHN0cmluZy5tYXRjaChwYXR0ZXJuKSB8fCBbXTtcbiAgICB9XG5cbiAgICAvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cbiAgICAvKipcbiAgICAgKiBBdHRlbXB0cyB0byBpbnZva2UgYGZ1bmNgLCByZXR1cm5pbmcgZWl0aGVyIHRoZSByZXN1bHQgb3IgdGhlIGNhdWdodCBlcnJvclxuICAgICAqIG9iamVjdC4gQW55IGFkZGl0aW9uYWwgYXJndW1lbnRzIGFyZSBwcm92aWRlZCB0byBgZnVuY2Agd2hlbiBpdCdzIGludm9rZWQuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMy4wLjBcbiAgICAgKiBAY2F0ZWdvcnkgVXRpbFxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZ1bmMgVGhlIGZ1bmN0aW9uIHRvIGF0dGVtcHQuXG4gICAgICogQHBhcmFtIHsuLi4qfSBbYXJnc10gVGhlIGFyZ3VtZW50cyB0byBpbnZva2UgYGZ1bmNgIHdpdGguXG4gICAgICogQHJldHVybnMgeyp9IFJldHVybnMgdGhlIGBmdW5jYCByZXN1bHQgb3IgZXJyb3Igb2JqZWN0LlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiAvLyBBdm9pZCB0aHJvd2luZyBlcnJvcnMgZm9yIGludmFsaWQgc2VsZWN0b3JzLlxuICAgICAqIHZhciBlbGVtZW50cyA9IF8uYXR0ZW1wdChmdW5jdGlvbihzZWxlY3Rvcikge1xuICAgICAqICAgcmV0dXJuIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3IpO1xuICAgICAqIH0sICc+Xz4nKTtcbiAgICAgKlxuICAgICAqIGlmIChfLmlzRXJyb3IoZWxlbWVudHMpKSB7XG4gICAgICogICBlbGVtZW50cyA9IFtdO1xuICAgICAqIH1cbiAgICAgKi9cbiAgICB2YXIgYXR0ZW1wdCA9IGJhc2VSZXN0KGZ1bmN0aW9uKGZ1bmMsIGFyZ3MpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIHJldHVybiBhcHBseShmdW5jLCB1bmRlZmluZWQsIGFyZ3MpO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICByZXR1cm4gaXNFcnJvcihlKSA/IGUgOiBuZXcgRXJyb3IoZSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBCaW5kcyBtZXRob2RzIG9mIGFuIG9iamVjdCB0byB0aGUgb2JqZWN0IGl0c2VsZiwgb3ZlcndyaXRpbmcgdGhlIGV4aXN0aW5nXG4gICAgICogbWV0aG9kLlxuICAgICAqXG4gICAgICogKipOb3RlOioqIFRoaXMgbWV0aG9kIGRvZXNuJ3Qgc2V0IHRoZSBcImxlbmd0aFwiIHByb3BlcnR5IG9mIGJvdW5kIGZ1bmN0aW9ucy5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAc2luY2UgMC4xLjBcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBjYXRlZ29yeSBVdGlsXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgb2JqZWN0IHRvIGJpbmQgYW5kIGFzc2lnbiB0aGUgYm91bmQgbWV0aG9kcyB0by5cbiAgICAgKiBAcGFyYW0gey4uLihzdHJpbmd8c3RyaW5nW10pfSBtZXRob2ROYW1lcyBUaGUgb2JqZWN0IG1ldGhvZCBuYW1lcyB0byBiaW5kLlxuICAgICAqIEByZXR1cm5zIHtPYmplY3R9IFJldHVybnMgYG9iamVjdGAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciB2aWV3ID0ge1xuICAgICAqICAgJ2xhYmVsJzogJ2RvY3MnLFxuICAgICAqICAgJ2NsaWNrJzogZnVuY3Rpb24oKSB7XG4gICAgICogICAgIGNvbnNvbGUubG9nKCdjbGlja2VkICcgKyB0aGlzLmxhYmVsKTtcbiAgICAgKiAgIH1cbiAgICAgKiB9O1xuICAgICAqXG4gICAgICogXy5iaW5kQWxsKHZpZXcsIFsnY2xpY2snXSk7XG4gICAgICogalF1ZXJ5KGVsZW1lbnQpLm9uKCdjbGljaycsIHZpZXcuY2xpY2spO1xuICAgICAqIC8vID0+IExvZ3MgJ2NsaWNrZWQgZG9jcycgd2hlbiBjbGlja2VkLlxuICAgICAqL1xuICAgIHZhciBiaW5kQWxsID0gZmxhdFJlc3QoZnVuY3Rpb24ob2JqZWN0LCBtZXRob2ROYW1lcykge1xuICAgICAgYXJyYXlFYWNoKG1ldGhvZE5hbWVzLCBmdW5jdGlvbihrZXkpIHtcbiAgICAgICAga2V5ID0gdG9LZXkoa2V5KTtcbiAgICAgICAgYmFzZUFzc2lnblZhbHVlKG9iamVjdCwga2V5LCBiaW5kKG9iamVjdFtrZXldLCBvYmplY3QpKTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIG9iamVjdDtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBmdW5jdGlvbiB0aGF0IGl0ZXJhdGVzIG92ZXIgYHBhaXJzYCBhbmQgaW52b2tlcyB0aGUgY29ycmVzcG9uZGluZ1xuICAgICAqIGZ1bmN0aW9uIG9mIHRoZSBmaXJzdCBwcmVkaWNhdGUgdG8gcmV0dXJuIHRydXRoeS4gVGhlIHByZWRpY2F0ZS1mdW5jdGlvblxuICAgICAqIHBhaXJzIGFyZSBpbnZva2VkIHdpdGggdGhlIGB0aGlzYCBiaW5kaW5nIGFuZCBhcmd1bWVudHMgb2YgdGhlIGNyZWF0ZWRcbiAgICAgKiBmdW5jdGlvbi5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSA0LjAuMFxuICAgICAqIEBjYXRlZ29yeSBVdGlsXG4gICAgICogQHBhcmFtIHtBcnJheX0gcGFpcnMgVGhlIHByZWRpY2F0ZS1mdW5jdGlvbiBwYWlycy5cbiAgICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgdGhlIG5ldyBjb21wb3NpdGUgZnVuY3Rpb24uXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciBmdW5jID0gXy5jb25kKFtcbiAgICAgKiAgIFtfLm1hdGNoZXMoeyAnYSc6IDEgfSksICAgICAgICAgICBfLmNvbnN0YW50KCdtYXRjaGVzIEEnKV0sXG4gICAgICogICBbXy5jb25mb3Jtcyh7ICdiJzogXy5pc051bWJlciB9KSwgXy5jb25zdGFudCgnbWF0Y2hlcyBCJyldLFxuICAgICAqICAgW18uc3R1YlRydWUsICAgICAgICAgICAgICAgICAgICAgIF8uY29uc3RhbnQoJ25vIG1hdGNoJyldXG4gICAgICogXSk7XG4gICAgICpcbiAgICAgKiBmdW5jKHsgJ2EnOiAxLCAnYic6IDIgfSk7XG4gICAgICogLy8gPT4gJ21hdGNoZXMgQSdcbiAgICAgKlxuICAgICAqIGZ1bmMoeyAnYSc6IDAsICdiJzogMSB9KTtcbiAgICAgKiAvLyA9PiAnbWF0Y2hlcyBCJ1xuICAgICAqXG4gICAgICogZnVuYyh7ICdhJzogJzEnLCAnYic6ICcyJyB9KTtcbiAgICAgKiAvLyA9PiAnbm8gbWF0Y2gnXG4gICAgICovXG4gICAgZnVuY3Rpb24gY29uZChwYWlycykge1xuICAgICAgdmFyIGxlbmd0aCA9IHBhaXJzID09IG51bGwgPyAwIDogcGFpcnMubGVuZ3RoLFxuICAgICAgICAgIHRvSXRlcmF0ZWUgPSBnZXRJdGVyYXRlZSgpO1xuXG4gICAgICBwYWlycyA9ICFsZW5ndGggPyBbXSA6IGFycmF5TWFwKHBhaXJzLCBmdW5jdGlvbihwYWlyKSB7XG4gICAgICAgIGlmICh0eXBlb2YgcGFpclsxXSAhPSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihGVU5DX0VSUk9SX1RFWFQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBbdG9JdGVyYXRlZShwYWlyWzBdKSwgcGFpclsxXV07XG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIGJhc2VSZXN0KGZ1bmN0aW9uKGFyZ3MpIHtcbiAgICAgICAgdmFyIGluZGV4ID0gLTE7XG4gICAgICAgIHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG4gICAgICAgICAgdmFyIHBhaXIgPSBwYWlyc1tpbmRleF07XG4gICAgICAgICAgaWYgKGFwcGx5KHBhaXJbMF0sIHRoaXMsIGFyZ3MpKSB7XG4gICAgICAgICAgICByZXR1cm4gYXBwbHkocGFpclsxXSwgdGhpcywgYXJncyk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgZnVuY3Rpb24gdGhhdCBpbnZva2VzIHRoZSBwcmVkaWNhdGUgcHJvcGVydGllcyBvZiBgc291cmNlYCB3aXRoXG4gICAgICogdGhlIGNvcnJlc3BvbmRpbmcgcHJvcGVydHkgdmFsdWVzIG9mIGEgZ2l2ZW4gb2JqZWN0LCByZXR1cm5pbmcgYHRydWVgIGlmXG4gICAgICogYWxsIHByZWRpY2F0ZXMgcmV0dXJuIHRydXRoeSwgZWxzZSBgZmFsc2VgLlxuICAgICAqXG4gICAgICogKipOb3RlOioqIFRoZSBjcmVhdGVkIGZ1bmN0aW9uIGlzIGVxdWl2YWxlbnQgdG8gYF8uY29uZm9ybXNUb2Agd2l0aFxuICAgICAqIGBzb3VyY2VgIHBhcnRpYWxseSBhcHBsaWVkLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDQuMC4wXG4gICAgICogQGNhdGVnb3J5IFV0aWxcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gc291cmNlIFRoZSBvYmplY3Qgb2YgcHJvcGVydHkgcHJlZGljYXRlcyB0byBjb25mb3JtIHRvLlxuICAgICAqIEByZXR1cm5zIHtGdW5jdGlvbn0gUmV0dXJucyB0aGUgbmV3IHNwZWMgZnVuY3Rpb24uXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciBvYmplY3RzID0gW1xuICAgICAqICAgeyAnYSc6IDIsICdiJzogMSB9LFxuICAgICAqICAgeyAnYSc6IDEsICdiJzogMiB9XG4gICAgICogXTtcbiAgICAgKlxuICAgICAqIF8uZmlsdGVyKG9iamVjdHMsIF8uY29uZm9ybXMoeyAnYic6IGZ1bmN0aW9uKG4pIHsgcmV0dXJuIG4gPiAxOyB9IH0pKTtcbiAgICAgKiAvLyA9PiBbeyAnYSc6IDEsICdiJzogMiB9XVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNvbmZvcm1zKHNvdXJjZSkge1xuICAgICAgcmV0dXJuIGJhc2VDb25mb3JtcyhiYXNlQ2xvbmUoc291cmNlLCBDTE9ORV9ERUVQX0ZMQUcpKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgZnVuY3Rpb24gdGhhdCByZXR1cm5zIGB2YWx1ZWAuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMi40LjBcbiAgICAgKiBAY2F0ZWdvcnkgVXRpbFxuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIHJldHVybiBmcm9tIHRoZSBuZXcgZnVuY3Rpb24uXG4gICAgICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIHRoZSBuZXcgY29uc3RhbnQgZnVuY3Rpb24uXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciBvYmplY3RzID0gXy50aW1lcygyLCBfLmNvbnN0YW50KHsgJ2EnOiAxIH0pKTtcbiAgICAgKlxuICAgICAqIGNvbnNvbGUubG9nKG9iamVjdHMpO1xuICAgICAqIC8vID0+IFt7ICdhJzogMSB9LCB7ICdhJzogMSB9XVxuICAgICAqXG4gICAgICogY29uc29sZS5sb2cob2JqZWN0c1swXSA9PT0gb2JqZWN0c1sxXSk7XG4gICAgICogLy8gPT4gdHJ1ZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNvbnN0YW50KHZhbHVlKSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2hlY2tzIGB2YWx1ZWAgdG8gZGV0ZXJtaW5lIHdoZXRoZXIgYSBkZWZhdWx0IHZhbHVlIHNob3VsZCBiZSByZXR1cm5lZCBpblxuICAgICAqIGl0cyBwbGFjZS4gVGhlIGBkZWZhdWx0VmFsdWVgIGlzIHJldHVybmVkIGlmIGB2YWx1ZWAgaXMgYE5hTmAsIGBudWxsYCxcbiAgICAgKiBvciBgdW5kZWZpbmVkYC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSA0LjE0LjBcbiAgICAgKiBAY2F0ZWdvcnkgVXRpbFxuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNoZWNrLlxuICAgICAqIEBwYXJhbSB7Kn0gZGVmYXVsdFZhbHVlIFRoZSBkZWZhdWx0IHZhbHVlLlxuICAgICAqIEByZXR1cm5zIHsqfSBSZXR1cm5zIHRoZSByZXNvbHZlZCB2YWx1ZS5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5kZWZhdWx0VG8oMSwgMTApO1xuICAgICAqIC8vID0+IDFcbiAgICAgKlxuICAgICAqIF8uZGVmYXVsdFRvKHVuZGVmaW5lZCwgMTApO1xuICAgICAqIC8vID0+IDEwXG4gICAgICovXG4gICAgZnVuY3Rpb24gZGVmYXVsdFRvKHZhbHVlLCBkZWZhdWx0VmFsdWUpIHtcbiAgICAgIHJldHVybiAodmFsdWUgPT0gbnVsbCB8fCB2YWx1ZSAhPT0gdmFsdWUpID8gZGVmYXVsdFZhbHVlIDogdmFsdWU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGZ1bmN0aW9uIHRoYXQgcmV0dXJucyB0aGUgcmVzdWx0IG9mIGludm9raW5nIHRoZSBnaXZlbiBmdW5jdGlvbnNcbiAgICAgKiB3aXRoIHRoZSBgdGhpc2AgYmluZGluZyBvZiB0aGUgY3JlYXRlZCBmdW5jdGlvbiwgd2hlcmUgZWFjaCBzdWNjZXNzaXZlXG4gICAgICogaW52b2NhdGlvbiBpcyBzdXBwbGllZCB0aGUgcmV0dXJuIHZhbHVlIG9mIHRoZSBwcmV2aW91cy5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAzLjAuMFxuICAgICAqIEBjYXRlZ29yeSBVdGlsXG4gICAgICogQHBhcmFtIHsuLi4oRnVuY3Rpb258RnVuY3Rpb25bXSl9IFtmdW5jc10gVGhlIGZ1bmN0aW9ucyB0byBpbnZva2UuXG4gICAgICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIHRoZSBuZXcgY29tcG9zaXRlIGZ1bmN0aW9uLlxuICAgICAqIEBzZWUgXy5mbG93UmlnaHRcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogZnVuY3Rpb24gc3F1YXJlKG4pIHtcbiAgICAgKiAgIHJldHVybiBuICogbjtcbiAgICAgKiB9XG4gICAgICpcbiAgICAgKiB2YXIgYWRkU3F1YXJlID0gXy5mbG93KFtfLmFkZCwgc3F1YXJlXSk7XG4gICAgICogYWRkU3F1YXJlKDEsIDIpO1xuICAgICAqIC8vID0+IDlcbiAgICAgKi9cbiAgICB2YXIgZmxvdyA9IGNyZWF0ZUZsb3coKTtcblxuICAgIC8qKlxuICAgICAqIFRoaXMgbWV0aG9kIGlzIGxpa2UgYF8uZmxvd2AgZXhjZXB0IHRoYXQgaXQgY3JlYXRlcyBhIGZ1bmN0aW9uIHRoYXRcbiAgICAgKiBpbnZva2VzIHRoZSBnaXZlbiBmdW5jdGlvbnMgZnJvbSByaWdodCB0byBsZWZ0LlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBzaW5jZSAzLjAuMFxuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQGNhdGVnb3J5IFV0aWxcbiAgICAgKiBAcGFyYW0gey4uLihGdW5jdGlvbnxGdW5jdGlvbltdKX0gW2Z1bmNzXSBUaGUgZnVuY3Rpb25zIHRvIGludm9rZS5cbiAgICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgdGhlIG5ldyBjb21wb3NpdGUgZnVuY3Rpb24uXG4gICAgICogQHNlZSBfLmZsb3dcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogZnVuY3Rpb24gc3F1YXJlKG4pIHtcbiAgICAgKiAgIHJldHVybiBuICogbjtcbiAgICAgKiB9XG4gICAgICpcbiAgICAgKiB2YXIgYWRkU3F1YXJlID0gXy5mbG93UmlnaHQoW3NxdWFyZSwgXy5hZGRdKTtcbiAgICAgKiBhZGRTcXVhcmUoMSwgMik7XG4gICAgICogLy8gPT4gOVxuICAgICAqL1xuICAgIHZhciBmbG93UmlnaHQgPSBjcmVhdGVGbG93KHRydWUpO1xuXG4gICAgLyoqXG4gICAgICogVGhpcyBtZXRob2QgcmV0dXJucyB0aGUgZmlyc3QgYXJndW1lbnQgaXQgcmVjZWl2ZXMuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQHNpbmNlIDAuMS4wXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAY2F0ZWdvcnkgVXRpbFxuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgQW55IHZhbHVlLlxuICAgICAqIEByZXR1cm5zIHsqfSBSZXR1cm5zIGB2YWx1ZWAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciBvYmplY3QgPSB7ICdhJzogMSB9O1xuICAgICAqXG4gICAgICogY29uc29sZS5sb2coXy5pZGVudGl0eShvYmplY3QpID09PSBvYmplY3QpO1xuICAgICAqIC8vID0+IHRydWVcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBpZGVudGl0eSh2YWx1ZSkge1xuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBmdW5jdGlvbiB0aGF0IGludm9rZXMgYGZ1bmNgIHdpdGggdGhlIGFyZ3VtZW50cyBvZiB0aGUgY3JlYXRlZFxuICAgICAqIGZ1bmN0aW9uLiBJZiBgZnVuY2AgaXMgYSBwcm9wZXJ0eSBuYW1lLCB0aGUgY3JlYXRlZCBmdW5jdGlvbiByZXR1cm5zIHRoZVxuICAgICAqIHByb3BlcnR5IHZhbHVlIGZvciBhIGdpdmVuIGVsZW1lbnQuIElmIGBmdW5jYCBpcyBhbiBhcnJheSBvciBvYmplY3QsIHRoZVxuICAgICAqIGNyZWF0ZWQgZnVuY3Rpb24gcmV0dXJucyBgdHJ1ZWAgZm9yIGVsZW1lbnRzIHRoYXQgY29udGFpbiB0aGUgZXF1aXZhbGVudFxuICAgICAqIHNvdXJjZSBwcm9wZXJ0aWVzLCBvdGhlcndpc2UgaXQgcmV0dXJucyBgZmFsc2VgLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBzaW5jZSA0LjAuMFxuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQGNhdGVnb3J5IFV0aWxcbiAgICAgKiBAcGFyYW0geyp9IFtmdW5jPV8uaWRlbnRpdHldIFRoZSB2YWx1ZSB0byBjb252ZXJ0IHRvIGEgY2FsbGJhY2suXG4gICAgICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIHRoZSBjYWxsYmFjay5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogdmFyIHVzZXJzID0gW1xuICAgICAqICAgeyAndXNlcic6ICdiYXJuZXknLCAnYWdlJzogMzYsICdhY3RpdmUnOiB0cnVlIH0sXG4gICAgICogICB7ICd1c2VyJzogJ2ZyZWQnLCAgICdhZ2UnOiA0MCwgJ2FjdGl2ZSc6IGZhbHNlIH1cbiAgICAgKiBdO1xuICAgICAqXG4gICAgICogLy8gVGhlIGBfLm1hdGNoZXNgIGl0ZXJhdGVlIHNob3J0aGFuZC5cbiAgICAgKiBfLmZpbHRlcih1c2VycywgXy5pdGVyYXRlZSh7ICd1c2VyJzogJ2Jhcm5leScsICdhY3RpdmUnOiB0cnVlIH0pKTtcbiAgICAgKiAvLyA9PiBbeyAndXNlcic6ICdiYXJuZXknLCAnYWdlJzogMzYsICdhY3RpdmUnOiB0cnVlIH1dXG4gICAgICpcbiAgICAgKiAvLyBUaGUgYF8ubWF0Y2hlc1Byb3BlcnR5YCBpdGVyYXRlZSBzaG9ydGhhbmQuXG4gICAgICogXy5maWx0ZXIodXNlcnMsIF8uaXRlcmF0ZWUoWyd1c2VyJywgJ2ZyZWQnXSkpO1xuICAgICAqIC8vID0+IFt7ICd1c2VyJzogJ2ZyZWQnLCAnYWdlJzogNDAgfV1cbiAgICAgKlxuICAgICAqIC8vIFRoZSBgXy5wcm9wZXJ0eWAgaXRlcmF0ZWUgc2hvcnRoYW5kLlxuICAgICAqIF8ubWFwKHVzZXJzLCBfLml0ZXJhdGVlKCd1c2VyJykpO1xuICAgICAqIC8vID0+IFsnYmFybmV5JywgJ2ZyZWQnXVxuICAgICAqXG4gICAgICogLy8gQ3JlYXRlIGN1c3RvbSBpdGVyYXRlZSBzaG9ydGhhbmRzLlxuICAgICAqIF8uaXRlcmF0ZWUgPSBfLndyYXAoXy5pdGVyYXRlZSwgZnVuY3Rpb24oaXRlcmF0ZWUsIGZ1bmMpIHtcbiAgICAgKiAgIHJldHVybiAhXy5pc1JlZ0V4cChmdW5jKSA/IGl0ZXJhdGVlKGZ1bmMpIDogZnVuY3Rpb24oc3RyaW5nKSB7XG4gICAgICogICAgIHJldHVybiBmdW5jLnRlc3Qoc3RyaW5nKTtcbiAgICAgKiAgIH07XG4gICAgICogfSk7XG4gICAgICpcbiAgICAgKiBfLmZpbHRlcihbJ2FiYycsICdkZWYnXSwgL2VmLyk7XG4gICAgICogLy8gPT4gWydkZWYnXVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGl0ZXJhdGVlKGZ1bmMpIHtcbiAgICAgIHJldHVybiBiYXNlSXRlcmF0ZWUodHlwZW9mIGZ1bmMgPT0gJ2Z1bmN0aW9uJyA/IGZ1bmMgOiBiYXNlQ2xvbmUoZnVuYywgQ0xPTkVfREVFUF9GTEFHKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGZ1bmN0aW9uIHRoYXQgcGVyZm9ybXMgYSBwYXJ0aWFsIGRlZXAgY29tcGFyaXNvbiBiZXR3ZWVuIGEgZ2l2ZW5cbiAgICAgKiBvYmplY3QgYW5kIGBzb3VyY2VgLCByZXR1cm5pbmcgYHRydWVgIGlmIHRoZSBnaXZlbiBvYmplY3QgaGFzIGVxdWl2YWxlbnRcbiAgICAgKiBwcm9wZXJ0eSB2YWx1ZXMsIGVsc2UgYGZhbHNlYC5cbiAgICAgKlxuICAgICAqICoqTm90ZToqKiBUaGUgY3JlYXRlZCBmdW5jdGlvbiBpcyBlcXVpdmFsZW50IHRvIGBfLmlzTWF0Y2hgIHdpdGggYHNvdXJjZWBcbiAgICAgKiBwYXJ0aWFsbHkgYXBwbGllZC5cbiAgICAgKlxuICAgICAqIFBhcnRpYWwgY29tcGFyaXNvbnMgd2lsbCBtYXRjaCBlbXB0eSBhcnJheSBhbmQgZW1wdHkgb2JqZWN0IGBzb3VyY2VgXG4gICAgICogdmFsdWVzIGFnYWluc3QgYW55IGFycmF5IG9yIG9iamVjdCB2YWx1ZSwgcmVzcGVjdGl2ZWx5LiBTZWUgYF8uaXNFcXVhbGBcbiAgICAgKiBmb3IgYSBsaXN0IG9mIHN1cHBvcnRlZCB2YWx1ZSBjb21wYXJpc29ucy5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAzLjAuMFxuICAgICAqIEBjYXRlZ29yeSBVdGlsXG4gICAgICogQHBhcmFtIHtPYmplY3R9IHNvdXJjZSBUaGUgb2JqZWN0IG9mIHByb3BlcnR5IHZhbHVlcyB0byBtYXRjaC5cbiAgICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgdGhlIG5ldyBzcGVjIGZ1bmN0aW9uLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiB2YXIgb2JqZWN0cyA9IFtcbiAgICAgKiAgIHsgJ2EnOiAxLCAnYic6IDIsICdjJzogMyB9LFxuICAgICAqICAgeyAnYSc6IDQsICdiJzogNSwgJ2MnOiA2IH1cbiAgICAgKiBdO1xuICAgICAqXG4gICAgICogXy5maWx0ZXIob2JqZWN0cywgXy5tYXRjaGVzKHsgJ2EnOiA0LCAnYyc6IDYgfSkpO1xuICAgICAqIC8vID0+IFt7ICdhJzogNCwgJ2InOiA1LCAnYyc6IDYgfV1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBtYXRjaGVzKHNvdXJjZSkge1xuICAgICAgcmV0dXJuIGJhc2VNYXRjaGVzKGJhc2VDbG9uZShzb3VyY2UsIENMT05FX0RFRVBfRkxBRykpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBmdW5jdGlvbiB0aGF0IHBlcmZvcm1zIGEgcGFydGlhbCBkZWVwIGNvbXBhcmlzb24gYmV0d2VlbiB0aGVcbiAgICAgKiB2YWx1ZSBhdCBgcGF0aGAgb2YgYSBnaXZlbiBvYmplY3QgdG8gYHNyY1ZhbHVlYCwgcmV0dXJuaW5nIGB0cnVlYCBpZiB0aGVcbiAgICAgKiBvYmplY3QgdmFsdWUgaXMgZXF1aXZhbGVudCwgZWxzZSBgZmFsc2VgLlxuICAgICAqXG4gICAgICogKipOb3RlOioqIFBhcnRpYWwgY29tcGFyaXNvbnMgd2lsbCBtYXRjaCBlbXB0eSBhcnJheSBhbmQgZW1wdHkgb2JqZWN0XG4gICAgICogYHNyY1ZhbHVlYCB2YWx1ZXMgYWdhaW5zdCBhbnkgYXJyYXkgb3Igb2JqZWN0IHZhbHVlLCByZXNwZWN0aXZlbHkuIFNlZVxuICAgICAqIGBfLmlzRXF1YWxgIGZvciBhIGxpc3Qgb2Ygc3VwcG9ydGVkIHZhbHVlIGNvbXBhcmlzb25zLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDMuMi4wXG4gICAgICogQGNhdGVnb3J5IFV0aWxcbiAgICAgKiBAcGFyYW0ge0FycmF5fHN0cmluZ30gcGF0aCBUaGUgcGF0aCBvZiB0aGUgcHJvcGVydHkgdG8gZ2V0LlxuICAgICAqIEBwYXJhbSB7Kn0gc3JjVmFsdWUgVGhlIHZhbHVlIHRvIG1hdGNoLlxuICAgICAqIEByZXR1cm5zIHtGdW5jdGlvbn0gUmV0dXJucyB0aGUgbmV3IHNwZWMgZnVuY3Rpb24uXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciBvYmplY3RzID0gW1xuICAgICAqICAgeyAnYSc6IDEsICdiJzogMiwgJ2MnOiAzIH0sXG4gICAgICogICB7ICdhJzogNCwgJ2InOiA1LCAnYyc6IDYgfVxuICAgICAqIF07XG4gICAgICpcbiAgICAgKiBfLmZpbmQob2JqZWN0cywgXy5tYXRjaGVzUHJvcGVydHkoJ2EnLCA0KSk7XG4gICAgICogLy8gPT4geyAnYSc6IDQsICdiJzogNSwgJ2MnOiA2IH1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBtYXRjaGVzUHJvcGVydHkocGF0aCwgc3JjVmFsdWUpIHtcbiAgICAgIHJldHVybiBiYXNlTWF0Y2hlc1Byb3BlcnR5KHBhdGgsIGJhc2VDbG9uZShzcmNWYWx1ZSwgQ0xPTkVfREVFUF9GTEFHKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGZ1bmN0aW9uIHRoYXQgaW52b2tlcyB0aGUgbWV0aG9kIGF0IGBwYXRoYCBvZiBhIGdpdmVuIG9iamVjdC5cbiAgICAgKiBBbnkgYWRkaXRpb25hbCBhcmd1bWVudHMgYXJlIHByb3ZpZGVkIHRvIHRoZSBpbnZva2VkIG1ldGhvZC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAzLjcuMFxuICAgICAqIEBjYXRlZ29yeSBVdGlsXG4gICAgICogQHBhcmFtIHtBcnJheXxzdHJpbmd9IHBhdGggVGhlIHBhdGggb2YgdGhlIG1ldGhvZCB0byBpbnZva2UuXG4gICAgICogQHBhcmFtIHsuLi4qfSBbYXJnc10gVGhlIGFyZ3VtZW50cyB0byBpbnZva2UgdGhlIG1ldGhvZCB3aXRoLlxuICAgICAqIEByZXR1cm5zIHtGdW5jdGlvbn0gUmV0dXJucyB0aGUgbmV3IGludm9rZXIgZnVuY3Rpb24uXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciBvYmplY3RzID0gW1xuICAgICAqICAgeyAnYSc6IHsgJ2InOiBfLmNvbnN0YW50KDIpIH0gfSxcbiAgICAgKiAgIHsgJ2EnOiB7ICdiJzogXy5jb25zdGFudCgxKSB9IH1cbiAgICAgKiBdO1xuICAgICAqXG4gICAgICogXy5tYXAob2JqZWN0cywgXy5tZXRob2QoJ2EuYicpKTtcbiAgICAgKiAvLyA9PiBbMiwgMV1cbiAgICAgKlxuICAgICAqIF8ubWFwKG9iamVjdHMsIF8ubWV0aG9kKFsnYScsICdiJ10pKTtcbiAgICAgKiAvLyA9PiBbMiwgMV1cbiAgICAgKi9cbiAgICB2YXIgbWV0aG9kID0gYmFzZVJlc3QoZnVuY3Rpb24ocGF0aCwgYXJncykge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uKG9iamVjdCkge1xuICAgICAgICByZXR1cm4gYmFzZUludm9rZShvYmplY3QsIHBhdGgsIGFyZ3MpO1xuICAgICAgfTtcbiAgICB9KTtcblxuICAgIC8qKlxuICAgICAqIFRoZSBvcHBvc2l0ZSBvZiBgXy5tZXRob2RgOyB0aGlzIG1ldGhvZCBjcmVhdGVzIGEgZnVuY3Rpb24gdGhhdCBpbnZva2VzXG4gICAgICogdGhlIG1ldGhvZCBhdCBhIGdpdmVuIHBhdGggb2YgYG9iamVjdGAuIEFueSBhZGRpdGlvbmFsIGFyZ3VtZW50cyBhcmVcbiAgICAgKiBwcm92aWRlZCB0byB0aGUgaW52b2tlZCBtZXRob2QuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMy43LjBcbiAgICAgKiBAY2F0ZWdvcnkgVXRpbFxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIG9iamVjdCB0byBxdWVyeS5cbiAgICAgKiBAcGFyYW0gey4uLip9IFthcmdzXSBUaGUgYXJndW1lbnRzIHRvIGludm9rZSB0aGUgbWV0aG9kIHdpdGguXG4gICAgICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIHRoZSBuZXcgaW52b2tlciBmdW5jdGlvbi5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogdmFyIGFycmF5ID0gXy50aW1lcygzLCBfLmNvbnN0YW50KSxcbiAgICAgKiAgICAgb2JqZWN0ID0geyAnYSc6IGFycmF5LCAnYic6IGFycmF5LCAnYyc6IGFycmF5IH07XG4gICAgICpcbiAgICAgKiBfLm1hcChbJ2FbMl0nLCAnY1swXSddLCBfLm1ldGhvZE9mKG9iamVjdCkpO1xuICAgICAqIC8vID0+IFsyLCAwXVxuICAgICAqXG4gICAgICogXy5tYXAoW1snYScsICcyJ10sIFsnYycsICcwJ11dLCBfLm1ldGhvZE9mKG9iamVjdCkpO1xuICAgICAqIC8vID0+IFsyLCAwXVxuICAgICAqL1xuICAgIHZhciBtZXRob2RPZiA9IGJhc2VSZXN0KGZ1bmN0aW9uKG9iamVjdCwgYXJncykge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uKHBhdGgpIHtcbiAgICAgICAgcmV0dXJuIGJhc2VJbnZva2Uob2JqZWN0LCBwYXRoLCBhcmdzKTtcbiAgICAgIH07XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBBZGRzIGFsbCBvd24gZW51bWVyYWJsZSBzdHJpbmcga2V5ZWQgZnVuY3Rpb24gcHJvcGVydGllcyBvZiBhIHNvdXJjZVxuICAgICAqIG9iamVjdCB0byB0aGUgZGVzdGluYXRpb24gb2JqZWN0LiBJZiBgb2JqZWN0YCBpcyBhIGZ1bmN0aW9uLCB0aGVuIG1ldGhvZHNcbiAgICAgKiBhcmUgYWRkZWQgdG8gaXRzIHByb3RvdHlwZSBhcyB3ZWxsLlxuICAgICAqXG4gICAgICogKipOb3RlOioqIFVzZSBgXy5ydW5JbkNvbnRleHRgIHRvIGNyZWF0ZSBhIHByaXN0aW5lIGBsb2Rhc2hgIGZ1bmN0aW9uIHRvXG4gICAgICogYXZvaWQgY29uZmxpY3RzIGNhdXNlZCBieSBtb2RpZnlpbmcgdGhlIG9yaWdpbmFsLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBzaW5jZSAwLjEuMFxuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQGNhdGVnb3J5IFV0aWxcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufE9iamVjdH0gW29iamVjdD1sb2Rhc2hdIFRoZSBkZXN0aW5hdGlvbiBvYmplY3QuXG4gICAgICogQHBhcmFtIHtPYmplY3R9IHNvdXJjZSBUaGUgb2JqZWN0IG9mIGZ1bmN0aW9ucyB0byBhZGQuXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zPXt9XSBUaGUgb3B0aW9ucyBvYmplY3QuXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbb3B0aW9ucy5jaGFpbj10cnVlXSBTcGVjaWZ5IHdoZXRoZXIgbWl4aW5zIGFyZSBjaGFpbmFibGUuXG4gICAgICogQHJldHVybnMge0Z1bmN0aW9ufE9iamVjdH0gUmV0dXJucyBgb2JqZWN0YC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogZnVuY3Rpb24gdm93ZWxzKHN0cmluZykge1xuICAgICAqICAgcmV0dXJuIF8uZmlsdGVyKHN0cmluZywgZnVuY3Rpb24odikge1xuICAgICAqICAgICByZXR1cm4gL1thZWlvdV0vaS50ZXN0KHYpO1xuICAgICAqICAgfSk7XG4gICAgICogfVxuICAgICAqXG4gICAgICogXy5taXhpbih7ICd2b3dlbHMnOiB2b3dlbHMgfSk7XG4gICAgICogXy52b3dlbHMoJ2ZyZWQnKTtcbiAgICAgKiAvLyA9PiBbJ2UnXVxuICAgICAqXG4gICAgICogXygnZnJlZCcpLnZvd2VscygpLnZhbHVlKCk7XG4gICAgICogLy8gPT4gWydlJ11cbiAgICAgKlxuICAgICAqIF8ubWl4aW4oeyAndm93ZWxzJzogdm93ZWxzIH0sIHsgJ2NoYWluJzogZmFsc2UgfSk7XG4gICAgICogXygnZnJlZCcpLnZvd2VscygpO1xuICAgICAqIC8vID0+IFsnZSddXG4gICAgICovXG4gICAgZnVuY3Rpb24gbWl4aW4ob2JqZWN0LCBzb3VyY2UsIG9wdGlvbnMpIHtcbiAgICAgIHZhciBwcm9wcyA9IGtleXMoc291cmNlKSxcbiAgICAgICAgICBtZXRob2ROYW1lcyA9IGJhc2VGdW5jdGlvbnMoc291cmNlLCBwcm9wcyk7XG5cbiAgICAgIGlmIChvcHRpb25zID09IG51bGwgJiZcbiAgICAgICAgICAhKGlzT2JqZWN0KHNvdXJjZSkgJiYgKG1ldGhvZE5hbWVzLmxlbmd0aCB8fCAhcHJvcHMubGVuZ3RoKSkpIHtcbiAgICAgICAgb3B0aW9ucyA9IHNvdXJjZTtcbiAgICAgICAgc291cmNlID0gb2JqZWN0O1xuICAgICAgICBvYmplY3QgPSB0aGlzO1xuICAgICAgICBtZXRob2ROYW1lcyA9IGJhc2VGdW5jdGlvbnMoc291cmNlLCBrZXlzKHNvdXJjZSkpO1xuICAgICAgfVxuICAgICAgdmFyIGNoYWluID0gIShpc09iamVjdChvcHRpb25zKSAmJiAnY2hhaW4nIGluIG9wdGlvbnMpIHx8ICEhb3B0aW9ucy5jaGFpbixcbiAgICAgICAgICBpc0Z1bmMgPSBpc0Z1bmN0aW9uKG9iamVjdCk7XG5cbiAgICAgIGFycmF5RWFjaChtZXRob2ROYW1lcywgZnVuY3Rpb24obWV0aG9kTmFtZSkge1xuICAgICAgICB2YXIgZnVuYyA9IHNvdXJjZVttZXRob2ROYW1lXTtcbiAgICAgICAgb2JqZWN0W21ldGhvZE5hbWVdID0gZnVuYztcbiAgICAgICAgaWYgKGlzRnVuYykge1xuICAgICAgICAgIG9iamVjdC5wcm90b3R5cGVbbWV0aG9kTmFtZV0gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBjaGFpbkFsbCA9IHRoaXMuX19jaGFpbl9fO1xuICAgICAgICAgICAgaWYgKGNoYWluIHx8IGNoYWluQWxsKSB7XG4gICAgICAgICAgICAgIHZhciByZXN1bHQgPSBvYmplY3QodGhpcy5fX3dyYXBwZWRfXyksXG4gICAgICAgICAgICAgICAgICBhY3Rpb25zID0gcmVzdWx0Ll9fYWN0aW9uc19fID0gY29weUFycmF5KHRoaXMuX19hY3Rpb25zX18pO1xuXG4gICAgICAgICAgICAgIGFjdGlvbnMucHVzaCh7ICdmdW5jJzogZnVuYywgJ2FyZ3MnOiBhcmd1bWVudHMsICd0aGlzQXJnJzogb2JqZWN0IH0pO1xuICAgICAgICAgICAgICByZXN1bHQuX19jaGFpbl9fID0gY2hhaW5BbGw7XG4gICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZnVuYy5hcHBseShvYmplY3QsIGFycmF5UHVzaChbdGhpcy52YWx1ZSgpXSwgYXJndW1lbnRzKSk7XG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBvYmplY3Q7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV2ZXJ0cyB0aGUgYF9gIHZhcmlhYmxlIHRvIGl0cyBwcmV2aW91cyB2YWx1ZSBhbmQgcmV0dXJucyBhIHJlZmVyZW5jZSB0b1xuICAgICAqIHRoZSBgbG9kYXNoYCBmdW5jdGlvbi5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAc2luY2UgMC4xLjBcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBjYXRlZ29yeSBVdGlsXG4gICAgICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIHRoZSBgbG9kYXNoYCBmdW5jdGlvbi5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogdmFyIGxvZGFzaCA9IF8ubm9Db25mbGljdCgpO1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIG5vQ29uZmxpY3QoKSB7XG4gICAgICBpZiAocm9vdC5fID09PSB0aGlzKSB7XG4gICAgICAgIHJvb3QuXyA9IG9sZERhc2g7XG4gICAgICB9XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGlzIG1ldGhvZCByZXR1cm5zIGB1bmRlZmluZWRgLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDIuMy4wXG4gICAgICogQGNhdGVnb3J5IFV0aWxcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy50aW1lcygyLCBfLm5vb3ApO1xuICAgICAqIC8vID0+IFt1bmRlZmluZWQsIHVuZGVmaW5lZF1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBub29wKCkge1xuICAgICAgLy8gTm8gb3BlcmF0aW9uIHBlcmZvcm1lZC5cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgZnVuY3Rpb24gdGhhdCBnZXRzIHRoZSBhcmd1bWVudCBhdCBpbmRleCBgbmAuIElmIGBuYCBpcyBuZWdhdGl2ZSxcbiAgICAgKiB0aGUgbnRoIGFyZ3VtZW50IGZyb20gdGhlIGVuZCBpcyByZXR1cm5lZC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSA0LjAuMFxuICAgICAqIEBjYXRlZ29yeSBVdGlsXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtuPTBdIFRoZSBpbmRleCBvZiB0aGUgYXJndW1lbnQgdG8gcmV0dXJuLlxuICAgICAqIEByZXR1cm5zIHtGdW5jdGlvbn0gUmV0dXJucyB0aGUgbmV3IHBhc3MtdGhydSBmdW5jdGlvbi5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogdmFyIGZ1bmMgPSBfLm50aEFyZygxKTtcbiAgICAgKiBmdW5jKCdhJywgJ2InLCAnYycsICdkJyk7XG4gICAgICogLy8gPT4gJ2InXG4gICAgICpcbiAgICAgKiB2YXIgZnVuYyA9IF8ubnRoQXJnKC0yKTtcbiAgICAgKiBmdW5jKCdhJywgJ2InLCAnYycsICdkJyk7XG4gICAgICogLy8gPT4gJ2MnXG4gICAgICovXG4gICAgZnVuY3Rpb24gbnRoQXJnKG4pIHtcbiAgICAgIG4gPSB0b0ludGVnZXIobik7XG4gICAgICByZXR1cm4gYmFzZVJlc3QoZnVuY3Rpb24oYXJncykge1xuICAgICAgICByZXR1cm4gYmFzZU50aChhcmdzLCBuKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBmdW5jdGlvbiB0aGF0IGludm9rZXMgYGl0ZXJhdGVlc2Agd2l0aCB0aGUgYXJndW1lbnRzIGl0IHJlY2VpdmVzXG4gICAgICogYW5kIHJldHVybnMgdGhlaXIgcmVzdWx0cy5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSA0LjAuMFxuICAgICAqIEBjYXRlZ29yeSBVdGlsXG4gICAgICogQHBhcmFtIHsuLi4oRnVuY3Rpb258RnVuY3Rpb25bXSl9IFtpdGVyYXRlZXM9W18uaWRlbnRpdHldXVxuICAgICAqICBUaGUgaXRlcmF0ZWVzIHRvIGludm9rZS5cbiAgICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgdGhlIG5ldyBmdW5jdGlvbi5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogdmFyIGZ1bmMgPSBfLm92ZXIoW01hdGgubWF4LCBNYXRoLm1pbl0pO1xuICAgICAqXG4gICAgICogZnVuYygxLCAyLCAzLCA0KTtcbiAgICAgKiAvLyA9PiBbNCwgMV1cbiAgICAgKi9cbiAgICB2YXIgb3ZlciA9IGNyZWF0ZU92ZXIoYXJyYXlNYXApO1xuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGZ1bmN0aW9uIHRoYXQgY2hlY2tzIGlmICoqYWxsKiogb2YgdGhlIGBwcmVkaWNhdGVzYCByZXR1cm5cbiAgICAgKiB0cnV0aHkgd2hlbiBpbnZva2VkIHdpdGggdGhlIGFyZ3VtZW50cyBpdCByZWNlaXZlcy5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSA0LjAuMFxuICAgICAqIEBjYXRlZ29yeSBVdGlsXG4gICAgICogQHBhcmFtIHsuLi4oRnVuY3Rpb258RnVuY3Rpb25bXSl9IFtwcmVkaWNhdGVzPVtfLmlkZW50aXR5XV1cbiAgICAgKiAgVGhlIHByZWRpY2F0ZXMgdG8gY2hlY2suXG4gICAgICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIHRoZSBuZXcgZnVuY3Rpb24uXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciBmdW5jID0gXy5vdmVyRXZlcnkoW0Jvb2xlYW4sIGlzRmluaXRlXSk7XG4gICAgICpcbiAgICAgKiBmdW5jKCcxJyk7XG4gICAgICogLy8gPT4gdHJ1ZVxuICAgICAqXG4gICAgICogZnVuYyhudWxsKTtcbiAgICAgKiAvLyA9PiBmYWxzZVxuICAgICAqXG4gICAgICogZnVuYyhOYU4pO1xuICAgICAqIC8vID0+IGZhbHNlXG4gICAgICovXG4gICAgdmFyIG92ZXJFdmVyeSA9IGNyZWF0ZU92ZXIoYXJyYXlFdmVyeSk7XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgZnVuY3Rpb24gdGhhdCBjaGVja3MgaWYgKiphbnkqKiBvZiB0aGUgYHByZWRpY2F0ZXNgIHJldHVyblxuICAgICAqIHRydXRoeSB3aGVuIGludm9rZWQgd2l0aCB0aGUgYXJndW1lbnRzIGl0IHJlY2VpdmVzLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDQuMC4wXG4gICAgICogQGNhdGVnb3J5IFV0aWxcbiAgICAgKiBAcGFyYW0gey4uLihGdW5jdGlvbnxGdW5jdGlvbltdKX0gW3ByZWRpY2F0ZXM9W18uaWRlbnRpdHldXVxuICAgICAqICBUaGUgcHJlZGljYXRlcyB0byBjaGVjay5cbiAgICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgdGhlIG5ldyBmdW5jdGlvbi5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogdmFyIGZ1bmMgPSBfLm92ZXJTb21lKFtCb29sZWFuLCBpc0Zpbml0ZV0pO1xuICAgICAqXG4gICAgICogZnVuYygnMScpO1xuICAgICAqIC8vID0+IHRydWVcbiAgICAgKlxuICAgICAqIGZ1bmMobnVsbCk7XG4gICAgICogLy8gPT4gdHJ1ZVxuICAgICAqXG4gICAgICogZnVuYyhOYU4pO1xuICAgICAqIC8vID0+IGZhbHNlXG4gICAgICovXG4gICAgdmFyIG92ZXJTb21lID0gY3JlYXRlT3ZlcihhcnJheVNvbWUpO1xuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGZ1bmN0aW9uIHRoYXQgcmV0dXJucyB0aGUgdmFsdWUgYXQgYHBhdGhgIG9mIGEgZ2l2ZW4gb2JqZWN0LlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDIuNC4wXG4gICAgICogQGNhdGVnb3J5IFV0aWxcbiAgICAgKiBAcGFyYW0ge0FycmF5fHN0cmluZ30gcGF0aCBUaGUgcGF0aCBvZiB0aGUgcHJvcGVydHkgdG8gZ2V0LlxuICAgICAqIEByZXR1cm5zIHtGdW5jdGlvbn0gUmV0dXJucyB0aGUgbmV3IGFjY2Vzc29yIGZ1bmN0aW9uLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiB2YXIgb2JqZWN0cyA9IFtcbiAgICAgKiAgIHsgJ2EnOiB7ICdiJzogMiB9IH0sXG4gICAgICogICB7ICdhJzogeyAnYic6IDEgfSB9XG4gICAgICogXTtcbiAgICAgKlxuICAgICAqIF8ubWFwKG9iamVjdHMsIF8ucHJvcGVydHkoJ2EuYicpKTtcbiAgICAgKiAvLyA9PiBbMiwgMV1cbiAgICAgKlxuICAgICAqIF8ubWFwKF8uc29ydEJ5KG9iamVjdHMsIF8ucHJvcGVydHkoWydhJywgJ2InXSkpLCAnYS5iJyk7XG4gICAgICogLy8gPT4gWzEsIDJdXG4gICAgICovXG4gICAgZnVuY3Rpb24gcHJvcGVydHkocGF0aCkge1xuICAgICAgcmV0dXJuIGlzS2V5KHBhdGgpID8gYmFzZVByb3BlcnR5KHRvS2V5KHBhdGgpKSA6IGJhc2VQcm9wZXJ0eURlZXAocGF0aCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIG9wcG9zaXRlIG9mIGBfLnByb3BlcnR5YDsgdGhpcyBtZXRob2QgY3JlYXRlcyBhIGZ1bmN0aW9uIHRoYXQgcmV0dXJuc1xuICAgICAqIHRoZSB2YWx1ZSBhdCBhIGdpdmVuIHBhdGggb2YgYG9iamVjdGAuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMy4wLjBcbiAgICAgKiBAY2F0ZWdvcnkgVXRpbFxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIG9iamVjdCB0byBxdWVyeS5cbiAgICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgdGhlIG5ldyBhY2Nlc3NvciBmdW5jdGlvbi5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogdmFyIGFycmF5ID0gWzAsIDEsIDJdLFxuICAgICAqICAgICBvYmplY3QgPSB7ICdhJzogYXJyYXksICdiJzogYXJyYXksICdjJzogYXJyYXkgfTtcbiAgICAgKlxuICAgICAqIF8ubWFwKFsnYVsyXScsICdjWzBdJ10sIF8ucHJvcGVydHlPZihvYmplY3QpKTtcbiAgICAgKiAvLyA9PiBbMiwgMF1cbiAgICAgKlxuICAgICAqIF8ubWFwKFtbJ2EnLCAnMiddLCBbJ2MnLCAnMCddXSwgXy5wcm9wZXJ0eU9mKG9iamVjdCkpO1xuICAgICAqIC8vID0+IFsyLCAwXVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHByb3BlcnR5T2Yob2JqZWN0KSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24ocGF0aCkge1xuICAgICAgICByZXR1cm4gb2JqZWN0ID09IG51bGwgPyB1bmRlZmluZWQgOiBiYXNlR2V0KG9iamVjdCwgcGF0aCk7XG4gICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW4gYXJyYXkgb2YgbnVtYmVycyAocG9zaXRpdmUgYW5kL29yIG5lZ2F0aXZlKSBwcm9ncmVzc2luZyBmcm9tXG4gICAgICogYHN0YXJ0YCB1cCB0bywgYnV0IG5vdCBpbmNsdWRpbmcsIGBlbmRgLiBBIHN0ZXAgb2YgYC0xYCBpcyB1c2VkIGlmIGEgbmVnYXRpdmVcbiAgICAgKiBgc3RhcnRgIGlzIHNwZWNpZmllZCB3aXRob3V0IGFuIGBlbmRgIG9yIGBzdGVwYC4gSWYgYGVuZGAgaXMgbm90IHNwZWNpZmllZCxcbiAgICAgKiBpdCdzIHNldCB0byBgc3RhcnRgIHdpdGggYHN0YXJ0YCB0aGVuIHNldCB0byBgMGAuXG4gICAgICpcbiAgICAgKiAqKk5vdGU6KiogSmF2YVNjcmlwdCBmb2xsb3dzIHRoZSBJRUVFLTc1NCBzdGFuZGFyZCBmb3IgcmVzb2x2aW5nXG4gICAgICogZmxvYXRpbmctcG9pbnQgdmFsdWVzIHdoaWNoIGNhbiBwcm9kdWNlIHVuZXhwZWN0ZWQgcmVzdWx0cy5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAc2luY2UgMC4xLjBcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBjYXRlZ29yeSBVdGlsXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtzdGFydD0wXSBUaGUgc3RhcnQgb2YgdGhlIHJhbmdlLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBlbmQgVGhlIGVuZCBvZiB0aGUgcmFuZ2UuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtzdGVwPTFdIFRoZSB2YWx1ZSB0byBpbmNyZW1lbnQgb3IgZGVjcmVtZW50IGJ5LlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgcmFuZ2Ugb2YgbnVtYmVycy5cbiAgICAgKiBAc2VlIF8uaW5SYW5nZSwgXy5yYW5nZVJpZ2h0XG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8ucmFuZ2UoNCk7XG4gICAgICogLy8gPT4gWzAsIDEsIDIsIDNdXG4gICAgICpcbiAgICAgKiBfLnJhbmdlKC00KTtcbiAgICAgKiAvLyA9PiBbMCwgLTEsIC0yLCAtM11cbiAgICAgKlxuICAgICAqIF8ucmFuZ2UoMSwgNSk7XG4gICAgICogLy8gPT4gWzEsIDIsIDMsIDRdXG4gICAgICpcbiAgICAgKiBfLnJhbmdlKDAsIDIwLCA1KTtcbiAgICAgKiAvLyA9PiBbMCwgNSwgMTAsIDE1XVxuICAgICAqXG4gICAgICogXy5yYW5nZSgwLCAtNCwgLTEpO1xuICAgICAqIC8vID0+IFswLCAtMSwgLTIsIC0zXVxuICAgICAqXG4gICAgICogXy5yYW5nZSgxLCA0LCAwKTtcbiAgICAgKiAvLyA9PiBbMSwgMSwgMV1cbiAgICAgKlxuICAgICAqIF8ucmFuZ2UoMCk7XG4gICAgICogLy8gPT4gW11cbiAgICAgKi9cbiAgICB2YXIgcmFuZ2UgPSBjcmVhdGVSYW5nZSgpO1xuXG4gICAgLyoqXG4gICAgICogVGhpcyBtZXRob2QgaXMgbGlrZSBgXy5yYW5nZWAgZXhjZXB0IHRoYXQgaXQgcG9wdWxhdGVzIHZhbHVlcyBpblxuICAgICAqIGRlc2NlbmRpbmcgb3JkZXIuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgNC4wLjBcbiAgICAgKiBAY2F0ZWdvcnkgVXRpbFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbc3RhcnQ9MF0gVGhlIHN0YXJ0IG9mIHRoZSByYW5nZS5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gZW5kIFRoZSBlbmQgb2YgdGhlIHJhbmdlLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBbc3RlcD0xXSBUaGUgdmFsdWUgdG8gaW5jcmVtZW50IG9yIGRlY3JlbWVudCBieS5cbiAgICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgdGhlIHJhbmdlIG9mIG51bWJlcnMuXG4gICAgICogQHNlZSBfLmluUmFuZ2UsIF8ucmFuZ2VcbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5yYW5nZVJpZ2h0KDQpO1xuICAgICAqIC8vID0+IFszLCAyLCAxLCAwXVxuICAgICAqXG4gICAgICogXy5yYW5nZVJpZ2h0KC00KTtcbiAgICAgKiAvLyA9PiBbLTMsIC0yLCAtMSwgMF1cbiAgICAgKlxuICAgICAqIF8ucmFuZ2VSaWdodCgxLCA1KTtcbiAgICAgKiAvLyA9PiBbNCwgMywgMiwgMV1cbiAgICAgKlxuICAgICAqIF8ucmFuZ2VSaWdodCgwLCAyMCwgNSk7XG4gICAgICogLy8gPT4gWzE1LCAxMCwgNSwgMF1cbiAgICAgKlxuICAgICAqIF8ucmFuZ2VSaWdodCgwLCAtNCwgLTEpO1xuICAgICAqIC8vID0+IFstMywgLTIsIC0xLCAwXVxuICAgICAqXG4gICAgICogXy5yYW5nZVJpZ2h0KDEsIDQsIDApO1xuICAgICAqIC8vID0+IFsxLCAxLCAxXVxuICAgICAqXG4gICAgICogXy5yYW5nZVJpZ2h0KDApO1xuICAgICAqIC8vID0+IFtdXG4gICAgICovXG4gICAgdmFyIHJhbmdlUmlnaHQgPSBjcmVhdGVSYW5nZSh0cnVlKTtcblxuICAgIC8qKlxuICAgICAqIFRoaXMgbWV0aG9kIHJldHVybnMgYSBuZXcgZW1wdHkgYXJyYXkuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgNC4xMy4wXG4gICAgICogQGNhdGVnb3J5IFV0aWxcbiAgICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgdGhlIG5ldyBlbXB0eSBhcnJheS5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogdmFyIGFycmF5cyA9IF8udGltZXMoMiwgXy5zdHViQXJyYXkpO1xuICAgICAqXG4gICAgICogY29uc29sZS5sb2coYXJyYXlzKTtcbiAgICAgKiAvLyA9PiBbW10sIFtdXVxuICAgICAqXG4gICAgICogY29uc29sZS5sb2coYXJyYXlzWzBdID09PSBhcnJheXNbMV0pO1xuICAgICAqIC8vID0+IGZhbHNlXG4gICAgICovXG4gICAgZnVuY3Rpb24gc3R1YkFycmF5KCkge1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoaXMgbWV0aG9kIHJldHVybnMgYGZhbHNlYC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSA0LjEzLjBcbiAgICAgKiBAY2F0ZWdvcnkgVXRpbFxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGBmYWxzZWAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8udGltZXMoMiwgXy5zdHViRmFsc2UpO1xuICAgICAqIC8vID0+IFtmYWxzZSwgZmFsc2VdXG4gICAgICovXG4gICAgZnVuY3Rpb24gc3R1YkZhbHNlKCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoaXMgbWV0aG9kIHJldHVybnMgYSBuZXcgZW1wdHkgb2JqZWN0LlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDQuMTMuMFxuICAgICAqIEBjYXRlZ29yeSBVdGlsXG4gICAgICogQHJldHVybnMge09iamVjdH0gUmV0dXJucyB0aGUgbmV3IGVtcHR5IG9iamVjdC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogdmFyIG9iamVjdHMgPSBfLnRpbWVzKDIsIF8uc3R1Yk9iamVjdCk7XG4gICAgICpcbiAgICAgKiBjb25zb2xlLmxvZyhvYmplY3RzKTtcbiAgICAgKiAvLyA9PiBbe30sIHt9XVxuICAgICAqXG4gICAgICogY29uc29sZS5sb2cob2JqZWN0c1swXSA9PT0gb2JqZWN0c1sxXSk7XG4gICAgICogLy8gPT4gZmFsc2VcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBzdHViT2JqZWN0KCkge1xuICAgICAgcmV0dXJuIHt9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoaXMgbWV0aG9kIHJldHVybnMgYW4gZW1wdHkgc3RyaW5nLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDQuMTMuMFxuICAgICAqIEBjYXRlZ29yeSBVdGlsXG4gICAgICogQHJldHVybnMge3N0cmluZ30gUmV0dXJucyB0aGUgZW1wdHkgc3RyaW5nLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLnRpbWVzKDIsIF8uc3R1YlN0cmluZyk7XG4gICAgICogLy8gPT4gWycnLCAnJ11cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBzdHViU3RyaW5nKCkge1xuICAgICAgcmV0dXJuICcnO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoaXMgbWV0aG9kIHJldHVybnMgYHRydWVgLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDQuMTMuMFxuICAgICAqIEBjYXRlZ29yeSBVdGlsXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLnRpbWVzKDIsIF8uc3R1YlRydWUpO1xuICAgICAqIC8vID0+IFt0cnVlLCB0cnVlXVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHN0dWJUcnVlKCkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSW52b2tlcyB0aGUgaXRlcmF0ZWUgYG5gIHRpbWVzLCByZXR1cm5pbmcgYW4gYXJyYXkgb2YgdGhlIHJlc3VsdHMgb2ZcbiAgICAgKiBlYWNoIGludm9jYXRpb24uIFRoZSBpdGVyYXRlZSBpcyBpbnZva2VkIHdpdGggb25lIGFyZ3VtZW50OyAoaW5kZXgpLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBzaW5jZSAwLjEuMFxuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQGNhdGVnb3J5IFV0aWxcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gbiBUaGUgbnVtYmVyIG9mIHRpbWVzIHRvIGludm9rZSBgaXRlcmF0ZWVgLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtpdGVyYXRlZT1fLmlkZW50aXR5XSBUaGUgZnVuY3Rpb24gaW52b2tlZCBwZXIgaXRlcmF0aW9uLlxuICAgICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyB0aGUgYXJyYXkgb2YgcmVzdWx0cy5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy50aW1lcygzLCBTdHJpbmcpO1xuICAgICAqIC8vID0+IFsnMCcsICcxJywgJzInXVxuICAgICAqXG4gICAgICogIF8udGltZXMoNCwgXy5jb25zdGFudCgwKSk7XG4gICAgICogLy8gPT4gWzAsIDAsIDAsIDBdXG4gICAgICovXG4gICAgZnVuY3Rpb24gdGltZXMobiwgaXRlcmF0ZWUpIHtcbiAgICAgIG4gPSB0b0ludGVnZXIobik7XG4gICAgICBpZiAobiA8IDEgfHwgbiA+IE1BWF9TQUZFX0lOVEVHRVIpIHtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgfVxuICAgICAgdmFyIGluZGV4ID0gTUFYX0FSUkFZX0xFTkdUSCxcbiAgICAgICAgICBsZW5ndGggPSBuYXRpdmVNaW4obiwgTUFYX0FSUkFZX0xFTkdUSCk7XG5cbiAgICAgIGl0ZXJhdGVlID0gZ2V0SXRlcmF0ZWUoaXRlcmF0ZWUpO1xuICAgICAgbiAtPSBNQVhfQVJSQVlfTEVOR1RIO1xuXG4gICAgICB2YXIgcmVzdWx0ID0gYmFzZVRpbWVzKGxlbmd0aCwgaXRlcmF0ZWUpO1xuICAgICAgd2hpbGUgKCsraW5kZXggPCBuKSB7XG4gICAgICAgIGl0ZXJhdGVlKGluZGV4KTtcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ29udmVydHMgYHZhbHVlYCB0byBhIHByb3BlcnR5IHBhdGggYXJyYXkuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgNC4wLjBcbiAgICAgKiBAY2F0ZWdvcnkgVXRpbFxuICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUgVGhlIHZhbHVlIHRvIGNvbnZlcnQuXG4gICAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIHRoZSBuZXcgcHJvcGVydHkgcGF0aCBhcnJheS5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy50b1BhdGgoJ2EuYi5jJyk7XG4gICAgICogLy8gPT4gWydhJywgJ2InLCAnYyddXG4gICAgICpcbiAgICAgKiBfLnRvUGF0aCgnYVswXS5iLmMnKTtcbiAgICAgKiAvLyA9PiBbJ2EnLCAnMCcsICdiJywgJ2MnXVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHRvUGF0aCh2YWx1ZSkge1xuICAgICAgaWYgKGlzQXJyYXkodmFsdWUpKSB7XG4gICAgICAgIHJldHVybiBhcnJheU1hcCh2YWx1ZSwgdG9LZXkpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGlzU3ltYm9sKHZhbHVlKSA/IFt2YWx1ZV0gOiBjb3B5QXJyYXkoc3RyaW5nVG9QYXRoKHRvU3RyaW5nKHZhbHVlKSkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdlbmVyYXRlcyBhIHVuaXF1ZSBJRC4gSWYgYHByZWZpeGAgaXMgZ2l2ZW4sIHRoZSBJRCBpcyBhcHBlbmRlZCB0byBpdC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAc2luY2UgMC4xLjBcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBjYXRlZ29yeSBVdGlsXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IFtwcmVmaXg9JyddIFRoZSB2YWx1ZSB0byBwcmVmaXggdGhlIElEIHdpdGguXG4gICAgICogQHJldHVybnMge3N0cmluZ30gUmV0dXJucyB0aGUgdW5pcXVlIElELlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLnVuaXF1ZUlkKCdjb250YWN0XycpO1xuICAgICAqIC8vID0+ICdjb250YWN0XzEwNCdcbiAgICAgKlxuICAgICAqIF8udW5pcXVlSWQoKTtcbiAgICAgKiAvLyA9PiAnMTA1J1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIHVuaXF1ZUlkKHByZWZpeCkge1xuICAgICAgdmFyIGlkID0gKytpZENvdW50ZXI7XG4gICAgICByZXR1cm4gdG9TdHJpbmcocHJlZml4KSArIGlkO1xuICAgIH1cblxuICAgIC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuICAgIC8qKlxuICAgICAqIEFkZHMgdHdvIG51bWJlcnMuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgMy40LjBcbiAgICAgKiBAY2F0ZWdvcnkgTWF0aFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBhdWdlbmQgVGhlIGZpcnN0IG51bWJlciBpbiBhbiBhZGRpdGlvbi5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gYWRkZW5kIFRoZSBzZWNvbmQgbnVtYmVyIGluIGFuIGFkZGl0aW9uLlxuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IFJldHVybnMgdGhlIHRvdGFsLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLmFkZCg2LCA0KTtcbiAgICAgKiAvLyA9PiAxMFxuICAgICAqL1xuICAgIHZhciBhZGQgPSBjcmVhdGVNYXRoT3BlcmF0aW9uKGZ1bmN0aW9uKGF1Z2VuZCwgYWRkZW5kKSB7XG4gICAgICByZXR1cm4gYXVnZW5kICsgYWRkZW5kO1xuICAgIH0sIDApO1xuXG4gICAgLyoqXG4gICAgICogQ29tcHV0ZXMgYG51bWJlcmAgcm91bmRlZCB1cCB0byBgcHJlY2lzaW9uYC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAzLjEwLjBcbiAgICAgKiBAY2F0ZWdvcnkgTWF0aFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBudW1iZXIgVGhlIG51bWJlciB0byByb3VuZCB1cC5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW3ByZWNpc2lvbj0wXSBUaGUgcHJlY2lzaW9uIHRvIHJvdW5kIHVwIHRvLlxuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IFJldHVybnMgdGhlIHJvdW5kZWQgdXAgbnVtYmVyLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLmNlaWwoNC4wMDYpO1xuICAgICAqIC8vID0+IDVcbiAgICAgKlxuICAgICAqIF8uY2VpbCg2LjAwNCwgMik7XG4gICAgICogLy8gPT4gNi4wMVxuICAgICAqXG4gICAgICogXy5jZWlsKDYwNDAsIC0yKTtcbiAgICAgKiAvLyA9PiA2MTAwXG4gICAgICovXG4gICAgdmFyIGNlaWwgPSBjcmVhdGVSb3VuZCgnY2VpbCcpO1xuXG4gICAgLyoqXG4gICAgICogRGl2aWRlIHR3byBudW1iZXJzLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDQuNy4wXG4gICAgICogQGNhdGVnb3J5IE1hdGhcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gZGl2aWRlbmQgVGhlIGZpcnN0IG51bWJlciBpbiBhIGRpdmlzaW9uLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBkaXZpc29yIFRoZSBzZWNvbmQgbnVtYmVyIGluIGEgZGl2aXNpb24uXG4gICAgICogQHJldHVybnMge251bWJlcn0gUmV0dXJucyB0aGUgcXVvdGllbnQuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8uZGl2aWRlKDYsIDQpO1xuICAgICAqIC8vID0+IDEuNVxuICAgICAqL1xuICAgIHZhciBkaXZpZGUgPSBjcmVhdGVNYXRoT3BlcmF0aW9uKGZ1bmN0aW9uKGRpdmlkZW5kLCBkaXZpc29yKSB7XG4gICAgICByZXR1cm4gZGl2aWRlbmQgLyBkaXZpc29yO1xuICAgIH0sIDEpO1xuXG4gICAgLyoqXG4gICAgICogQ29tcHV0ZXMgYG51bWJlcmAgcm91bmRlZCBkb3duIHRvIGBwcmVjaXNpb25gLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDMuMTAuMFxuICAgICAqIEBjYXRlZ29yeSBNYXRoXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IG51bWJlciBUaGUgbnVtYmVyIHRvIHJvdW5kIGRvd24uXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFtwcmVjaXNpb249MF0gVGhlIHByZWNpc2lvbiB0byByb3VuZCBkb3duIHRvLlxuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IFJldHVybnMgdGhlIHJvdW5kZWQgZG93biBudW1iZXIuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8uZmxvb3IoNC4wMDYpO1xuICAgICAqIC8vID0+IDRcbiAgICAgKlxuICAgICAqIF8uZmxvb3IoMC4wNDYsIDIpO1xuICAgICAqIC8vID0+IDAuMDRcbiAgICAgKlxuICAgICAqIF8uZmxvb3IoNDA2MCwgLTIpO1xuICAgICAqIC8vID0+IDQwMDBcbiAgICAgKi9cbiAgICB2YXIgZmxvb3IgPSBjcmVhdGVSb3VuZCgnZmxvb3InKTtcblxuICAgIC8qKlxuICAgICAqIENvbXB1dGVzIHRoZSBtYXhpbXVtIHZhbHVlIG9mIGBhcnJheWAuIElmIGBhcnJheWAgaXMgZW1wdHkgb3IgZmFsc2V5LFxuICAgICAqIGB1bmRlZmluZWRgIGlzIHJldHVybmVkLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBzaW5jZSAwLjEuMFxuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQGNhdGVnb3J5IE1hdGhcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBhcnJheSBUaGUgYXJyYXkgdG8gaXRlcmF0ZSBvdmVyLlxuICAgICAqIEByZXR1cm5zIHsqfSBSZXR1cm5zIHRoZSBtYXhpbXVtIHZhbHVlLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLm1heChbNCwgMiwgOCwgNl0pO1xuICAgICAqIC8vID0+IDhcbiAgICAgKlxuICAgICAqIF8ubWF4KFtdKTtcbiAgICAgKiAvLyA9PiB1bmRlZmluZWRcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBtYXgoYXJyYXkpIHtcbiAgICAgIHJldHVybiAoYXJyYXkgJiYgYXJyYXkubGVuZ3RoKVxuICAgICAgICA/IGJhc2VFeHRyZW11bShhcnJheSwgaWRlbnRpdHksIGJhc2VHdClcbiAgICAgICAgOiB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhpcyBtZXRob2QgaXMgbGlrZSBgXy5tYXhgIGV4Y2VwdCB0aGF0IGl0IGFjY2VwdHMgYGl0ZXJhdGVlYCB3aGljaCBpc1xuICAgICAqIGludm9rZWQgZm9yIGVhY2ggZWxlbWVudCBpbiBgYXJyYXlgIHRvIGdlbmVyYXRlIHRoZSBjcml0ZXJpb24gYnkgd2hpY2hcbiAgICAgKiB0aGUgdmFsdWUgaXMgcmFua2VkLiBUaGUgaXRlcmF0ZWUgaXMgaW52b2tlZCB3aXRoIG9uZSBhcmd1bWVudDogKHZhbHVlKS5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSA0LjAuMFxuICAgICAqIEBjYXRlZ29yeSBNYXRoXG4gICAgICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIGFycmF5IHRvIGl0ZXJhdGUgb3Zlci5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbaXRlcmF0ZWU9Xy5pZGVudGl0eV0gVGhlIGl0ZXJhdGVlIGludm9rZWQgcGVyIGVsZW1lbnQuXG4gICAgICogQHJldHVybnMgeyp9IFJldHVybnMgdGhlIG1heGltdW0gdmFsdWUuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciBvYmplY3RzID0gW3sgJ24nOiAxIH0sIHsgJ24nOiAyIH1dO1xuICAgICAqXG4gICAgICogXy5tYXhCeShvYmplY3RzLCBmdW5jdGlvbihvKSB7IHJldHVybiBvLm47IH0pO1xuICAgICAqIC8vID0+IHsgJ24nOiAyIH1cbiAgICAgKlxuICAgICAqIC8vIFRoZSBgXy5wcm9wZXJ0eWAgaXRlcmF0ZWUgc2hvcnRoYW5kLlxuICAgICAqIF8ubWF4Qnkob2JqZWN0cywgJ24nKTtcbiAgICAgKiAvLyA9PiB7ICduJzogMiB9XG4gICAgICovXG4gICAgZnVuY3Rpb24gbWF4QnkoYXJyYXksIGl0ZXJhdGVlKSB7XG4gICAgICByZXR1cm4gKGFycmF5ICYmIGFycmF5Lmxlbmd0aClcbiAgICAgICAgPyBiYXNlRXh0cmVtdW0oYXJyYXksIGdldEl0ZXJhdGVlKGl0ZXJhdGVlLCAyKSwgYmFzZUd0KVxuICAgICAgICA6IHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDb21wdXRlcyB0aGUgbWVhbiBvZiB0aGUgdmFsdWVzIGluIGBhcnJheWAuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgNC4wLjBcbiAgICAgKiBAY2F0ZWdvcnkgTWF0aFxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGFycmF5IFRoZSBhcnJheSB0byBpdGVyYXRlIG92ZXIuXG4gICAgICogQHJldHVybnMge251bWJlcn0gUmV0dXJucyB0aGUgbWVhbi5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5tZWFuKFs0LCAyLCA4LCA2XSk7XG4gICAgICogLy8gPT4gNVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIG1lYW4oYXJyYXkpIHtcbiAgICAgIHJldHVybiBiYXNlTWVhbihhcnJheSwgaWRlbnRpdHkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoaXMgbWV0aG9kIGlzIGxpa2UgYF8ubWVhbmAgZXhjZXB0IHRoYXQgaXQgYWNjZXB0cyBgaXRlcmF0ZWVgIHdoaWNoIGlzXG4gICAgICogaW52b2tlZCBmb3IgZWFjaCBlbGVtZW50IGluIGBhcnJheWAgdG8gZ2VuZXJhdGUgdGhlIHZhbHVlIHRvIGJlIGF2ZXJhZ2VkLlxuICAgICAqIFRoZSBpdGVyYXRlZSBpcyBpbnZva2VkIHdpdGggb25lIGFyZ3VtZW50OiAodmFsdWUpLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHNpbmNlIDQuNy4wXG4gICAgICogQGNhdGVnb3J5IE1hdGhcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBhcnJheSBUaGUgYXJyYXkgdG8gaXRlcmF0ZSBvdmVyLlxuICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IFtpdGVyYXRlZT1fLmlkZW50aXR5XSBUaGUgaXRlcmF0ZWUgaW52b2tlZCBwZXIgZWxlbWVudC5cbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSBSZXR1cm5zIHRoZSBtZWFuLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiB2YXIgb2JqZWN0cyA9IFt7ICduJzogNCB9LCB7ICduJzogMiB9LCB7ICduJzogOCB9LCB7ICduJzogNiB9XTtcbiAgICAgKlxuICAgICAqIF8ubWVhbkJ5KG9iamVjdHMsIGZ1bmN0aW9uKG8pIHsgcmV0dXJuIG8ubjsgfSk7XG4gICAgICogLy8gPT4gNVxuICAgICAqXG4gICAgICogLy8gVGhlIGBfLnByb3BlcnR5YCBpdGVyYXRlZSBzaG9ydGhhbmQuXG4gICAgICogXy5tZWFuQnkob2JqZWN0cywgJ24nKTtcbiAgICAgKiAvLyA9PiA1XG4gICAgICovXG4gICAgZnVuY3Rpb24gbWVhbkJ5KGFycmF5LCBpdGVyYXRlZSkge1xuICAgICAgcmV0dXJuIGJhc2VNZWFuKGFycmF5LCBnZXRJdGVyYXRlZShpdGVyYXRlZSwgMikpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENvbXB1dGVzIHRoZSBtaW5pbXVtIHZhbHVlIG9mIGBhcnJheWAuIElmIGBhcnJheWAgaXMgZW1wdHkgb3IgZmFsc2V5LFxuICAgICAqIGB1bmRlZmluZWRgIGlzIHJldHVybmVkLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBzaW5jZSAwLjEuMFxuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQGNhdGVnb3J5IE1hdGhcbiAgICAgKiBAcGFyYW0ge0FycmF5fSBhcnJheSBUaGUgYXJyYXkgdG8gaXRlcmF0ZSBvdmVyLlxuICAgICAqIEByZXR1cm5zIHsqfSBSZXR1cm5zIHRoZSBtaW5pbXVtIHZhbHVlLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLm1pbihbNCwgMiwgOCwgNl0pO1xuICAgICAqIC8vID0+IDJcbiAgICAgKlxuICAgICAqIF8ubWluKFtdKTtcbiAgICAgKiAvLyA9PiB1bmRlZmluZWRcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBtaW4oYXJyYXkpIHtcbiAgICAgIHJldHVybiAoYXJyYXkgJiYgYXJyYXkubGVuZ3RoKVxuICAgICAgICA/IGJhc2VFeHRyZW11bShhcnJheSwgaWRlbnRpdHksIGJhc2VMdClcbiAgICAgICAgOiB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhpcyBtZXRob2QgaXMgbGlrZSBgXy5taW5gIGV4Y2VwdCB0aGF0IGl0IGFjY2VwdHMgYGl0ZXJhdGVlYCB3aGljaCBpc1xuICAgICAqIGludm9rZWQgZm9yIGVhY2ggZWxlbWVudCBpbiBgYXJyYXlgIHRvIGdlbmVyYXRlIHRoZSBjcml0ZXJpb24gYnkgd2hpY2hcbiAgICAgKiB0aGUgdmFsdWUgaXMgcmFua2VkLiBUaGUgaXRlcmF0ZWUgaXMgaW52b2tlZCB3aXRoIG9uZSBhcmd1bWVudDogKHZhbHVlKS5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSA0LjAuMFxuICAgICAqIEBjYXRlZ29yeSBNYXRoXG4gICAgICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIGFycmF5IHRvIGl0ZXJhdGUgb3Zlci5cbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbaXRlcmF0ZWU9Xy5pZGVudGl0eV0gVGhlIGl0ZXJhdGVlIGludm9rZWQgcGVyIGVsZW1lbnQuXG4gICAgICogQHJldHVybnMgeyp9IFJldHVybnMgdGhlIG1pbmltdW0gdmFsdWUuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIHZhciBvYmplY3RzID0gW3sgJ24nOiAxIH0sIHsgJ24nOiAyIH1dO1xuICAgICAqXG4gICAgICogXy5taW5CeShvYmplY3RzLCBmdW5jdGlvbihvKSB7IHJldHVybiBvLm47IH0pO1xuICAgICAqIC8vID0+IHsgJ24nOiAxIH1cbiAgICAgKlxuICAgICAqIC8vIFRoZSBgXy5wcm9wZXJ0eWAgaXRlcmF0ZWUgc2hvcnRoYW5kLlxuICAgICAqIF8ubWluQnkob2JqZWN0cywgJ24nKTtcbiAgICAgKiAvLyA9PiB7ICduJzogMSB9XG4gICAgICovXG4gICAgZnVuY3Rpb24gbWluQnkoYXJyYXksIGl0ZXJhdGVlKSB7XG4gICAgICByZXR1cm4gKGFycmF5ICYmIGFycmF5Lmxlbmd0aClcbiAgICAgICAgPyBiYXNlRXh0cmVtdW0oYXJyYXksIGdldEl0ZXJhdGVlKGl0ZXJhdGVlLCAyKSwgYmFzZUx0KVxuICAgICAgICA6IHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBNdWx0aXBseSB0d28gbnVtYmVycy5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSA0LjcuMFxuICAgICAqIEBjYXRlZ29yeSBNYXRoXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IG11bHRpcGxpZXIgVGhlIGZpcnN0IG51bWJlciBpbiBhIG11bHRpcGxpY2F0aW9uLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBtdWx0aXBsaWNhbmQgVGhlIHNlY29uZCBudW1iZXIgaW4gYSBtdWx0aXBsaWNhdGlvbi5cbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSBSZXR1cm5zIHRoZSBwcm9kdWN0LlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLm11bHRpcGx5KDYsIDQpO1xuICAgICAqIC8vID0+IDI0XG4gICAgICovXG4gICAgdmFyIG11bHRpcGx5ID0gY3JlYXRlTWF0aE9wZXJhdGlvbihmdW5jdGlvbihtdWx0aXBsaWVyLCBtdWx0aXBsaWNhbmQpIHtcbiAgICAgIHJldHVybiBtdWx0aXBsaWVyICogbXVsdGlwbGljYW5kO1xuICAgIH0sIDEpO1xuXG4gICAgLyoqXG4gICAgICogQ29tcHV0ZXMgYG51bWJlcmAgcm91bmRlZCB0byBgcHJlY2lzaW9uYC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAzLjEwLjBcbiAgICAgKiBAY2F0ZWdvcnkgTWF0aFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBudW1iZXIgVGhlIG51bWJlciB0byByb3VuZC5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW3ByZWNpc2lvbj0wXSBUaGUgcHJlY2lzaW9uIHRvIHJvdW5kIHRvLlxuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IFJldHVybnMgdGhlIHJvdW5kZWQgbnVtYmVyLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpcbiAgICAgKiBfLnJvdW5kKDQuMDA2KTtcbiAgICAgKiAvLyA9PiA0XG4gICAgICpcbiAgICAgKiBfLnJvdW5kKDQuMDA2LCAyKTtcbiAgICAgKiAvLyA9PiA0LjAxXG4gICAgICpcbiAgICAgKiBfLnJvdW5kKDQwNjAsIC0yKTtcbiAgICAgKiAvLyA9PiA0MTAwXG4gICAgICovXG4gICAgdmFyIHJvdW5kID0gY3JlYXRlUm91bmQoJ3JvdW5kJyk7XG5cbiAgICAvKipcbiAgICAgKiBTdWJ0cmFjdCB0d28gbnVtYmVycy5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSA0LjAuMFxuICAgICAqIEBjYXRlZ29yeSBNYXRoXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IG1pbnVlbmQgVGhlIGZpcnN0IG51bWJlciBpbiBhIHN1YnRyYWN0aW9uLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBzdWJ0cmFoZW5kIFRoZSBzZWNvbmQgbnVtYmVyIGluIGEgc3VidHJhY3Rpb24uXG4gICAgICogQHJldHVybnMge251bWJlcn0gUmV0dXJucyB0aGUgZGlmZmVyZW5jZS5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogXy5zdWJ0cmFjdCg2LCA0KTtcbiAgICAgKiAvLyA9PiAyXG4gICAgICovXG4gICAgdmFyIHN1YnRyYWN0ID0gY3JlYXRlTWF0aE9wZXJhdGlvbihmdW5jdGlvbihtaW51ZW5kLCBzdWJ0cmFoZW5kKSB7XG4gICAgICByZXR1cm4gbWludWVuZCAtIHN1YnRyYWhlbmQ7XG4gICAgfSwgMCk7XG5cbiAgICAvKipcbiAgICAgKiBDb21wdXRlcyB0aGUgc3VtIG9mIHRoZSB2YWx1ZXMgaW4gYGFycmF5YC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgX1xuICAgICAqIEBzaW5jZSAzLjQuMFxuICAgICAqIEBjYXRlZ29yeSBNYXRoXG4gICAgICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIGFycmF5IHRvIGl0ZXJhdGUgb3Zlci5cbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSBSZXR1cm5zIHRoZSBzdW0uXG4gICAgICogQGV4YW1wbGVcbiAgICAgKlxuICAgICAqIF8uc3VtKFs0LCAyLCA4LCA2XSk7XG4gICAgICogLy8gPT4gMjBcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBzdW0oYXJyYXkpIHtcbiAgICAgIHJldHVybiAoYXJyYXkgJiYgYXJyYXkubGVuZ3RoKVxuICAgICAgICA/IGJhc2VTdW0oYXJyYXksIGlkZW50aXR5KVxuICAgICAgICA6IDA7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhpcyBtZXRob2QgaXMgbGlrZSBgXy5zdW1gIGV4Y2VwdCB0aGF0IGl0IGFjY2VwdHMgYGl0ZXJhdGVlYCB3aGljaCBpc1xuICAgICAqIGludm9rZWQgZm9yIGVhY2ggZWxlbWVudCBpbiBgYXJyYXlgIHRvIGdlbmVyYXRlIHRoZSB2YWx1ZSB0byBiZSBzdW1tZWQuXG4gICAgICogVGhlIGl0ZXJhdGVlIGlzIGludm9rZWQgd2l0aCBvbmUgYXJndW1lbnQ6ICh2YWx1ZSkuXG4gICAgICpcbiAgICAgKiBAc3RhdGljXG4gICAgICogQG1lbWJlck9mIF9cbiAgICAgKiBAc2luY2UgNC4wLjBcbiAgICAgKiBAY2F0ZWdvcnkgTWF0aFxuICAgICAqIEBwYXJhbSB7QXJyYXl9IGFycmF5IFRoZSBhcnJheSB0byBpdGVyYXRlIG92ZXIuXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gW2l0ZXJhdGVlPV8uaWRlbnRpdHldIFRoZSBpdGVyYXRlZSBpbnZva2VkIHBlciBlbGVtZW50LlxuICAgICAqIEByZXR1cm5zIHtudW1iZXJ9IFJldHVybnMgdGhlIHN1bS5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqXG4gICAgICogdmFyIG9iamVjdHMgPSBbeyAnbic6IDQgfSwgeyAnbic6IDIgfSwgeyAnbic6IDggfSwgeyAnbic6IDYgfV07XG4gICAgICpcbiAgICAgKiBfLnN1bUJ5KG9iamVjdHMsIGZ1bmN0aW9uKG8pIHsgcmV0dXJuIG8ubjsgfSk7XG4gICAgICogLy8gPT4gMjBcbiAgICAgKlxuICAgICAqIC8vIFRoZSBgXy5wcm9wZXJ0eWAgaXRlcmF0ZWUgc2hvcnRoYW5kLlxuICAgICAqIF8uc3VtQnkob2JqZWN0cywgJ24nKTtcbiAgICAgKiAvLyA9PiAyMFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHN1bUJ5KGFycmF5LCBpdGVyYXRlZSkge1xuICAgICAgcmV0dXJuIChhcnJheSAmJiBhcnJheS5sZW5ndGgpXG4gICAgICAgID8gYmFzZVN1bShhcnJheSwgZ2V0SXRlcmF0ZWUoaXRlcmF0ZWUsIDIpKVxuICAgICAgICA6IDA7XG4gICAgfVxuXG4gICAgLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG4gICAgLy8gQWRkIG1ldGhvZHMgdGhhdCByZXR1cm4gd3JhcHBlZCB2YWx1ZXMgaW4gY2hhaW4gc2VxdWVuY2VzLlxuICAgIGxvZGFzaC5hZnRlciA9IGFmdGVyO1xuICAgIGxvZGFzaC5hcnkgPSBhcnk7XG4gICAgbG9kYXNoLmFzc2lnbiA9IGFzc2lnbjtcbiAgICBsb2Rhc2guYXNzaWduSW4gPSBhc3NpZ25JbjtcbiAgICBsb2Rhc2guYXNzaWduSW5XaXRoID0gYXNzaWduSW5XaXRoO1xuICAgIGxvZGFzaC5hc3NpZ25XaXRoID0gYXNzaWduV2l0aDtcbiAgICBsb2Rhc2guYXQgPSBhdDtcbiAgICBsb2Rhc2guYmVmb3JlID0gYmVmb3JlO1xuICAgIGxvZGFzaC5iaW5kID0gYmluZDtcbiAgICBsb2Rhc2guYmluZEFsbCA9IGJpbmRBbGw7XG4gICAgbG9kYXNoLmJpbmRLZXkgPSBiaW5kS2V5O1xuICAgIGxvZGFzaC5jYXN0QXJyYXkgPSBjYXN0QXJyYXk7XG4gICAgbG9kYXNoLmNoYWluID0gY2hhaW47XG4gICAgbG9kYXNoLmNodW5rID0gY2h1bms7XG4gICAgbG9kYXNoLmNvbXBhY3QgPSBjb21wYWN0O1xuICAgIGxvZGFzaC5jb25jYXQgPSBjb25jYXQ7XG4gICAgbG9kYXNoLmNvbmQgPSBjb25kO1xuICAgIGxvZGFzaC5jb25mb3JtcyA9IGNvbmZvcm1zO1xuICAgIGxvZGFzaC5jb25zdGFudCA9IGNvbnN0YW50O1xuICAgIGxvZGFzaC5jb3VudEJ5ID0gY291bnRCeTtcbiAgICBsb2Rhc2guY3JlYXRlID0gY3JlYXRlO1xuICAgIGxvZGFzaC5jdXJyeSA9IGN1cnJ5O1xuICAgIGxvZGFzaC5jdXJyeVJpZ2h0ID0gY3VycnlSaWdodDtcbiAgICBsb2Rhc2guZGVib3VuY2UgPSBkZWJvdW5jZTtcbiAgICBsb2Rhc2guZGVmYXVsdHMgPSBkZWZhdWx0cztcbiAgICBsb2Rhc2guZGVmYXVsdHNEZWVwID0gZGVmYXVsdHNEZWVwO1xuICAgIGxvZGFzaC5kZWZlciA9IGRlZmVyO1xuICAgIGxvZGFzaC5kZWxheSA9IGRlbGF5O1xuICAgIGxvZGFzaC5kaWZmZXJlbmNlID0gZGlmZmVyZW5jZTtcbiAgICBsb2Rhc2guZGlmZmVyZW5jZUJ5ID0gZGlmZmVyZW5jZUJ5O1xuICAgIGxvZGFzaC5kaWZmZXJlbmNlV2l0aCA9IGRpZmZlcmVuY2VXaXRoO1xuICAgIGxvZGFzaC5kcm9wID0gZHJvcDtcbiAgICBsb2Rhc2guZHJvcFJpZ2h0ID0gZHJvcFJpZ2h0O1xuICAgIGxvZGFzaC5kcm9wUmlnaHRXaGlsZSA9IGRyb3BSaWdodFdoaWxlO1xuICAgIGxvZGFzaC5kcm9wV2hpbGUgPSBkcm9wV2hpbGU7XG4gICAgbG9kYXNoLmZpbGwgPSBmaWxsO1xuICAgIGxvZGFzaC5maWx0ZXIgPSBmaWx0ZXI7XG4gICAgbG9kYXNoLmZsYXRNYXAgPSBmbGF0TWFwO1xuICAgIGxvZGFzaC5mbGF0TWFwRGVlcCA9IGZsYXRNYXBEZWVwO1xuICAgIGxvZGFzaC5mbGF0TWFwRGVwdGggPSBmbGF0TWFwRGVwdGg7XG4gICAgbG9kYXNoLmZsYXR0ZW4gPSBmbGF0dGVuO1xuICAgIGxvZGFzaC5mbGF0dGVuRGVlcCA9IGZsYXR0ZW5EZWVwO1xuICAgIGxvZGFzaC5mbGF0dGVuRGVwdGggPSBmbGF0dGVuRGVwdGg7XG4gICAgbG9kYXNoLmZsaXAgPSBmbGlwO1xuICAgIGxvZGFzaC5mbG93ID0gZmxvdztcbiAgICBsb2Rhc2guZmxvd1JpZ2h0ID0gZmxvd1JpZ2h0O1xuICAgIGxvZGFzaC5mcm9tUGFpcnMgPSBmcm9tUGFpcnM7XG4gICAgbG9kYXNoLmZ1bmN0aW9ucyA9IGZ1bmN0aW9ucztcbiAgICBsb2Rhc2guZnVuY3Rpb25zSW4gPSBmdW5jdGlvbnNJbjtcbiAgICBsb2Rhc2guZ3JvdXBCeSA9IGdyb3VwQnk7XG4gICAgbG9kYXNoLmluaXRpYWwgPSBpbml0aWFsO1xuICAgIGxvZGFzaC5pbnRlcnNlY3Rpb24gPSBpbnRlcnNlY3Rpb247XG4gICAgbG9kYXNoLmludGVyc2VjdGlvbkJ5ID0gaW50ZXJzZWN0aW9uQnk7XG4gICAgbG9kYXNoLmludGVyc2VjdGlvbldpdGggPSBpbnRlcnNlY3Rpb25XaXRoO1xuICAgIGxvZGFzaC5pbnZlcnQgPSBpbnZlcnQ7XG4gICAgbG9kYXNoLmludmVydEJ5ID0gaW52ZXJ0Qnk7XG4gICAgbG9kYXNoLmludm9rZU1hcCA9IGludm9rZU1hcDtcbiAgICBsb2Rhc2guaXRlcmF0ZWUgPSBpdGVyYXRlZTtcbiAgICBsb2Rhc2gua2V5QnkgPSBrZXlCeTtcbiAgICBsb2Rhc2gua2V5cyA9IGtleXM7XG4gICAgbG9kYXNoLmtleXNJbiA9IGtleXNJbjtcbiAgICBsb2Rhc2gubWFwID0gbWFwO1xuICAgIGxvZGFzaC5tYXBLZXlzID0gbWFwS2V5cztcbiAgICBsb2Rhc2gubWFwVmFsdWVzID0gbWFwVmFsdWVzO1xuICAgIGxvZGFzaC5tYXRjaGVzID0gbWF0Y2hlcztcbiAgICBsb2Rhc2gubWF0Y2hlc1Byb3BlcnR5ID0gbWF0Y2hlc1Byb3BlcnR5O1xuICAgIGxvZGFzaC5tZW1vaXplID0gbWVtb2l6ZTtcbiAgICBsb2Rhc2gubWVyZ2UgPSBtZXJnZTtcbiAgICBsb2Rhc2gubWVyZ2VXaXRoID0gbWVyZ2VXaXRoO1xuICAgIGxvZGFzaC5tZXRob2QgPSBtZXRob2Q7XG4gICAgbG9kYXNoLm1ldGhvZE9mID0gbWV0aG9kT2Y7XG4gICAgbG9kYXNoLm1peGluID0gbWl4aW47XG4gICAgbG9kYXNoLm5lZ2F0ZSA9IG5lZ2F0ZTtcbiAgICBsb2Rhc2gubnRoQXJnID0gbnRoQXJnO1xuICAgIGxvZGFzaC5vbWl0ID0gb21pdDtcbiAgICBsb2Rhc2gub21pdEJ5ID0gb21pdEJ5O1xuICAgIGxvZGFzaC5vbmNlID0gb25jZTtcbiAgICBsb2Rhc2gub3JkZXJCeSA9IG9yZGVyQnk7XG4gICAgbG9kYXNoLm92ZXIgPSBvdmVyO1xuICAgIGxvZGFzaC5vdmVyQXJncyA9IG92ZXJBcmdzO1xuICAgIGxvZGFzaC5vdmVyRXZlcnkgPSBvdmVyRXZlcnk7XG4gICAgbG9kYXNoLm92ZXJTb21lID0gb3ZlclNvbWU7XG4gICAgbG9kYXNoLnBhcnRpYWwgPSBwYXJ0aWFsO1xuICAgIGxvZGFzaC5wYXJ0aWFsUmlnaHQgPSBwYXJ0aWFsUmlnaHQ7XG4gICAgbG9kYXNoLnBhcnRpdGlvbiA9IHBhcnRpdGlvbjtcbiAgICBsb2Rhc2gucGljayA9IHBpY2s7XG4gICAgbG9kYXNoLnBpY2tCeSA9IHBpY2tCeTtcbiAgICBsb2Rhc2gucHJvcGVydHkgPSBwcm9wZXJ0eTtcbiAgICBsb2Rhc2gucHJvcGVydHlPZiA9IHByb3BlcnR5T2Y7XG4gICAgbG9kYXNoLnB1bGwgPSBwdWxsO1xuICAgIGxvZGFzaC5wdWxsQWxsID0gcHVsbEFsbDtcbiAgICBsb2Rhc2gucHVsbEFsbEJ5ID0gcHVsbEFsbEJ5O1xuICAgIGxvZGFzaC5wdWxsQWxsV2l0aCA9IHB1bGxBbGxXaXRoO1xuICAgIGxvZGFzaC5wdWxsQXQgPSBwdWxsQXQ7XG4gICAgbG9kYXNoLnJhbmdlID0gcmFuZ2U7XG4gICAgbG9kYXNoLnJhbmdlUmlnaHQgPSByYW5nZVJpZ2h0O1xuICAgIGxvZGFzaC5yZWFyZyA9IHJlYXJnO1xuICAgIGxvZGFzaC5yZWplY3QgPSByZWplY3Q7XG4gICAgbG9kYXNoLnJlbW92ZSA9IHJlbW92ZTtcbiAgICBsb2Rhc2gucmVzdCA9IHJlc3Q7XG4gICAgbG9kYXNoLnJldmVyc2UgPSByZXZlcnNlO1xuICAgIGxvZGFzaC5zYW1wbGVTaXplID0gc2FtcGxlU2l6ZTtcbiAgICBsb2Rhc2guc2V0ID0gc2V0O1xuICAgIGxvZGFzaC5zZXRXaXRoID0gc2V0V2l0aDtcbiAgICBsb2Rhc2guc2h1ZmZsZSA9IHNodWZmbGU7XG4gICAgbG9kYXNoLnNsaWNlID0gc2xpY2U7XG4gICAgbG9kYXNoLnNvcnRCeSA9IHNvcnRCeTtcbiAgICBsb2Rhc2guc29ydGVkVW5pcSA9IHNvcnRlZFVuaXE7XG4gICAgbG9kYXNoLnNvcnRlZFVuaXFCeSA9IHNvcnRlZFVuaXFCeTtcbiAgICBsb2Rhc2guc3BsaXQgPSBzcGxpdDtcbiAgICBsb2Rhc2guc3ByZWFkID0gc3ByZWFkO1xuICAgIGxvZGFzaC50YWlsID0gdGFpbDtcbiAgICBsb2Rhc2gudGFrZSA9IHRha2U7XG4gICAgbG9kYXNoLnRha2VSaWdodCA9IHRha2VSaWdodDtcbiAgICBsb2Rhc2gudGFrZVJpZ2h0V2hpbGUgPSB0YWtlUmlnaHRXaGlsZTtcbiAgICBsb2Rhc2gudGFrZVdoaWxlID0gdGFrZVdoaWxlO1xuICAgIGxvZGFzaC50YXAgPSB0YXA7XG4gICAgbG9kYXNoLnRocm90dGxlID0gdGhyb3R0bGU7XG4gICAgbG9kYXNoLnRocnUgPSB0aHJ1O1xuICAgIGxvZGFzaC50b0FycmF5ID0gdG9BcnJheTtcbiAgICBsb2Rhc2gudG9QYWlycyA9IHRvUGFpcnM7XG4gICAgbG9kYXNoLnRvUGFpcnNJbiA9IHRvUGFpcnNJbjtcbiAgICBsb2Rhc2gudG9QYXRoID0gdG9QYXRoO1xuICAgIGxvZGFzaC50b1BsYWluT2JqZWN0ID0gdG9QbGFpbk9iamVjdDtcbiAgICBsb2Rhc2gudHJhbnNmb3JtID0gdHJhbnNmb3JtO1xuICAgIGxvZGFzaC51bmFyeSA9IHVuYXJ5O1xuICAgIGxvZGFzaC51bmlvbiA9IHVuaW9uO1xuICAgIGxvZGFzaC51bmlvbkJ5ID0gdW5pb25CeTtcbiAgICBsb2Rhc2gudW5pb25XaXRoID0gdW5pb25XaXRoO1xuICAgIGxvZGFzaC51bmlxID0gdW5pcTtcbiAgICBsb2Rhc2gudW5pcUJ5ID0gdW5pcUJ5O1xuICAgIGxvZGFzaC51bmlxV2l0aCA9IHVuaXFXaXRoO1xuICAgIGxvZGFzaC51bnNldCA9IHVuc2V0O1xuICAgIGxvZGFzaC51bnppcCA9IHVuemlwO1xuICAgIGxvZGFzaC51bnppcFdpdGggPSB1bnppcFdpdGg7XG4gICAgbG9kYXNoLnVwZGF0ZSA9IHVwZGF0ZTtcbiAgICBsb2Rhc2gudXBkYXRlV2l0aCA9IHVwZGF0ZVdpdGg7XG4gICAgbG9kYXNoLnZhbHVlcyA9IHZhbHVlcztcbiAgICBsb2Rhc2gudmFsdWVzSW4gPSB2YWx1ZXNJbjtcbiAgICBsb2Rhc2gud2l0aG91dCA9IHdpdGhvdXQ7XG4gICAgbG9kYXNoLndvcmRzID0gd29yZHM7XG4gICAgbG9kYXNoLndyYXAgPSB3cmFwO1xuICAgIGxvZGFzaC54b3IgPSB4b3I7XG4gICAgbG9kYXNoLnhvckJ5ID0geG9yQnk7XG4gICAgbG9kYXNoLnhvcldpdGggPSB4b3JXaXRoO1xuICAgIGxvZGFzaC56aXAgPSB6aXA7XG4gICAgbG9kYXNoLnppcE9iamVjdCA9IHppcE9iamVjdDtcbiAgICBsb2Rhc2guemlwT2JqZWN0RGVlcCA9IHppcE9iamVjdERlZXA7XG4gICAgbG9kYXNoLnppcFdpdGggPSB6aXBXaXRoO1xuXG4gICAgLy8gQWRkIGFsaWFzZXMuXG4gICAgbG9kYXNoLmVudHJpZXMgPSB0b1BhaXJzO1xuICAgIGxvZGFzaC5lbnRyaWVzSW4gPSB0b1BhaXJzSW47XG4gICAgbG9kYXNoLmV4dGVuZCA9IGFzc2lnbkluO1xuICAgIGxvZGFzaC5leHRlbmRXaXRoID0gYXNzaWduSW5XaXRoO1xuXG4gICAgLy8gQWRkIG1ldGhvZHMgdG8gYGxvZGFzaC5wcm90b3R5cGVgLlxuICAgIG1peGluKGxvZGFzaCwgbG9kYXNoKTtcblxuICAgIC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuICAgIC8vIEFkZCBtZXRob2RzIHRoYXQgcmV0dXJuIHVud3JhcHBlZCB2YWx1ZXMgaW4gY2hhaW4gc2VxdWVuY2VzLlxuICAgIGxvZGFzaC5hZGQgPSBhZGQ7XG4gICAgbG9kYXNoLmF0dGVtcHQgPSBhdHRlbXB0O1xuICAgIGxvZGFzaC5jYW1lbENhc2UgPSBjYW1lbENhc2U7XG4gICAgbG9kYXNoLmNhcGl0YWxpemUgPSBjYXBpdGFsaXplO1xuICAgIGxvZGFzaC5jZWlsID0gY2VpbDtcbiAgICBsb2Rhc2guY2xhbXAgPSBjbGFtcDtcbiAgICBsb2Rhc2guY2xvbmUgPSBjbG9uZTtcbiAgICBsb2Rhc2guY2xvbmVEZWVwID0gY2xvbmVEZWVwO1xuICAgIGxvZGFzaC5jbG9uZURlZXBXaXRoID0gY2xvbmVEZWVwV2l0aDtcbiAgICBsb2Rhc2guY2xvbmVXaXRoID0gY2xvbmVXaXRoO1xuICAgIGxvZGFzaC5jb25mb3Jtc1RvID0gY29uZm9ybXNUbztcbiAgICBsb2Rhc2guZGVidXJyID0gZGVidXJyO1xuICAgIGxvZGFzaC5kZWZhdWx0VG8gPSBkZWZhdWx0VG87XG4gICAgbG9kYXNoLmRpdmlkZSA9IGRpdmlkZTtcbiAgICBsb2Rhc2guZW5kc1dpdGggPSBlbmRzV2l0aDtcbiAgICBsb2Rhc2guZXEgPSBlcTtcbiAgICBsb2Rhc2guZXNjYXBlID0gZXNjYXBlO1xuICAgIGxvZGFzaC5lc2NhcGVSZWdFeHAgPSBlc2NhcGVSZWdFeHA7XG4gICAgbG9kYXNoLmV2ZXJ5ID0gZXZlcnk7XG4gICAgbG9kYXNoLmZpbmQgPSBmaW5kO1xuICAgIGxvZGFzaC5maW5kSW5kZXggPSBmaW5kSW5kZXg7XG4gICAgbG9kYXNoLmZpbmRLZXkgPSBmaW5kS2V5O1xuICAgIGxvZGFzaC5maW5kTGFzdCA9IGZpbmRMYXN0O1xuICAgIGxvZGFzaC5maW5kTGFzdEluZGV4ID0gZmluZExhc3RJbmRleDtcbiAgICBsb2Rhc2guZmluZExhc3RLZXkgPSBmaW5kTGFzdEtleTtcbiAgICBsb2Rhc2guZmxvb3IgPSBmbG9vcjtcbiAgICBsb2Rhc2guZm9yRWFjaCA9IGZvckVhY2g7XG4gICAgbG9kYXNoLmZvckVhY2hSaWdodCA9IGZvckVhY2hSaWdodDtcbiAgICBsb2Rhc2guZm9ySW4gPSBmb3JJbjtcbiAgICBsb2Rhc2guZm9ySW5SaWdodCA9IGZvckluUmlnaHQ7XG4gICAgbG9kYXNoLmZvck93biA9IGZvck93bjtcbiAgICBsb2Rhc2guZm9yT3duUmlnaHQgPSBmb3JPd25SaWdodDtcbiAgICBsb2Rhc2guZ2V0ID0gZ2V0O1xuICAgIGxvZGFzaC5ndCA9IGd0O1xuICAgIGxvZGFzaC5ndGUgPSBndGU7XG4gICAgbG9kYXNoLmhhcyA9IGhhcztcbiAgICBsb2Rhc2guaGFzSW4gPSBoYXNJbjtcbiAgICBsb2Rhc2guaGVhZCA9IGhlYWQ7XG4gICAgbG9kYXNoLmlkZW50aXR5ID0gaWRlbnRpdHk7XG4gICAgbG9kYXNoLmluY2x1ZGVzID0gaW5jbHVkZXM7XG4gICAgbG9kYXNoLmluZGV4T2YgPSBpbmRleE9mO1xuICAgIGxvZGFzaC5pblJhbmdlID0gaW5SYW5nZTtcbiAgICBsb2Rhc2guaW52b2tlID0gaW52b2tlO1xuICAgIGxvZGFzaC5pc0FyZ3VtZW50cyA9IGlzQXJndW1lbnRzO1xuICAgIGxvZGFzaC5pc0FycmF5ID0gaXNBcnJheTtcbiAgICBsb2Rhc2guaXNBcnJheUJ1ZmZlciA9IGlzQXJyYXlCdWZmZXI7XG4gICAgbG9kYXNoLmlzQXJyYXlMaWtlID0gaXNBcnJheUxpa2U7XG4gICAgbG9kYXNoLmlzQXJyYXlMaWtlT2JqZWN0ID0gaXNBcnJheUxpa2VPYmplY3Q7XG4gICAgbG9kYXNoLmlzQm9vbGVhbiA9IGlzQm9vbGVhbjtcbiAgICBsb2Rhc2guaXNCdWZmZXIgPSBpc0J1ZmZlcjtcbiAgICBsb2Rhc2guaXNEYXRlID0gaXNEYXRlO1xuICAgIGxvZGFzaC5pc0VsZW1lbnQgPSBpc0VsZW1lbnQ7XG4gICAgbG9kYXNoLmlzRW1wdHkgPSBpc0VtcHR5O1xuICAgIGxvZGFzaC5pc0VxdWFsID0gaXNFcXVhbDtcbiAgICBsb2Rhc2guaXNFcXVhbFdpdGggPSBpc0VxdWFsV2l0aDtcbiAgICBsb2Rhc2guaXNFcnJvciA9IGlzRXJyb3I7XG4gICAgbG9kYXNoLmlzRmluaXRlID0gaXNGaW5pdGU7XG4gICAgbG9kYXNoLmlzRnVuY3Rpb24gPSBpc0Z1bmN0aW9uO1xuICAgIGxvZGFzaC5pc0ludGVnZXIgPSBpc0ludGVnZXI7XG4gICAgbG9kYXNoLmlzTGVuZ3RoID0gaXNMZW5ndGg7XG4gICAgbG9kYXNoLmlzTWFwID0gaXNNYXA7XG4gICAgbG9kYXNoLmlzTWF0Y2ggPSBpc01hdGNoO1xuICAgIGxvZGFzaC5pc01hdGNoV2l0aCA9IGlzTWF0Y2hXaXRoO1xuICAgIGxvZGFzaC5pc05hTiA9IGlzTmFOO1xuICAgIGxvZGFzaC5pc05hdGl2ZSA9IGlzTmF0aXZlO1xuICAgIGxvZGFzaC5pc05pbCA9IGlzTmlsO1xuICAgIGxvZGFzaC5pc051bGwgPSBpc051bGw7XG4gICAgbG9kYXNoLmlzTnVtYmVyID0gaXNOdW1iZXI7XG4gICAgbG9kYXNoLmlzT2JqZWN0ID0gaXNPYmplY3Q7XG4gICAgbG9kYXNoLmlzT2JqZWN0TGlrZSA9IGlzT2JqZWN0TGlrZTtcbiAgICBsb2Rhc2guaXNQbGFpbk9iamVjdCA9IGlzUGxhaW5PYmplY3Q7XG4gICAgbG9kYXNoLmlzUmVnRXhwID0gaXNSZWdFeHA7XG4gICAgbG9kYXNoLmlzU2FmZUludGVnZXIgPSBpc1NhZmVJbnRlZ2VyO1xuICAgIGxvZGFzaC5pc1NldCA9IGlzU2V0O1xuICAgIGxvZGFzaC5pc1N0cmluZyA9IGlzU3RyaW5nO1xuICAgIGxvZGFzaC5pc1N5bWJvbCA9IGlzU3ltYm9sO1xuICAgIGxvZGFzaC5pc1R5cGVkQXJyYXkgPSBpc1R5cGVkQXJyYXk7XG4gICAgbG9kYXNoLmlzVW5kZWZpbmVkID0gaXNVbmRlZmluZWQ7XG4gICAgbG9kYXNoLmlzV2Vha01hcCA9IGlzV2Vha01hcDtcbiAgICBsb2Rhc2guaXNXZWFrU2V0ID0gaXNXZWFrU2V0O1xuICAgIGxvZGFzaC5qb2luID0gam9pbjtcbiAgICBsb2Rhc2gua2ViYWJDYXNlID0ga2ViYWJDYXNlO1xuICAgIGxvZGFzaC5sYXN0ID0gbGFzdDtcbiAgICBsb2Rhc2gubGFzdEluZGV4T2YgPSBsYXN0SW5kZXhPZjtcbiAgICBsb2Rhc2gubG93ZXJDYXNlID0gbG93ZXJDYXNlO1xuICAgIGxvZGFzaC5sb3dlckZpcnN0ID0gbG93ZXJGaXJzdDtcbiAgICBsb2Rhc2gubHQgPSBsdDtcbiAgICBsb2Rhc2gubHRlID0gbHRlO1xuICAgIGxvZGFzaC5tYXggPSBtYXg7XG4gICAgbG9kYXNoLm1heEJ5ID0gbWF4Qnk7XG4gICAgbG9kYXNoLm1lYW4gPSBtZWFuO1xuICAgIGxvZGFzaC5tZWFuQnkgPSBtZWFuQnk7XG4gICAgbG9kYXNoLm1pbiA9IG1pbjtcbiAgICBsb2Rhc2gubWluQnkgPSBtaW5CeTtcbiAgICBsb2Rhc2guc3R1YkFycmF5ID0gc3R1YkFycmF5O1xuICAgIGxvZGFzaC5zdHViRmFsc2UgPSBzdHViRmFsc2U7XG4gICAgbG9kYXNoLnN0dWJPYmplY3QgPSBzdHViT2JqZWN0O1xuICAgIGxvZGFzaC5zdHViU3RyaW5nID0gc3R1YlN0cmluZztcbiAgICBsb2Rhc2guc3R1YlRydWUgPSBzdHViVHJ1ZTtcbiAgICBsb2Rhc2gubXVsdGlwbHkgPSBtdWx0aXBseTtcbiAgICBsb2Rhc2gubnRoID0gbnRoO1xuICAgIGxvZGFzaC5ub0NvbmZsaWN0ID0gbm9Db25mbGljdDtcbiAgICBsb2Rhc2gubm9vcCA9IG5vb3A7XG4gICAgbG9kYXNoLm5vdyA9IG5vdztcbiAgICBsb2Rhc2gucGFkID0gcGFkO1xuICAgIGxvZGFzaC5wYWRFbmQgPSBwYWRFbmQ7XG4gICAgbG9kYXNoLnBhZFN0YXJ0ID0gcGFkU3RhcnQ7XG4gICAgbG9kYXNoLnBhcnNlSW50ID0gcGFyc2VJbnQ7XG4gICAgbG9kYXNoLnJhbmRvbSA9IHJhbmRvbTtcbiAgICBsb2Rhc2gucmVkdWNlID0gcmVkdWNlO1xuICAgIGxvZGFzaC5yZWR1Y2VSaWdodCA9IHJlZHVjZVJpZ2h0O1xuICAgIGxvZGFzaC5yZXBlYXQgPSByZXBlYXQ7XG4gICAgbG9kYXNoLnJlcGxhY2UgPSByZXBsYWNlO1xuICAgIGxvZGFzaC5yZXN1bHQgPSByZXN1bHQ7XG4gICAgbG9kYXNoLnJvdW5kID0gcm91bmQ7XG4gICAgbG9kYXNoLnJ1bkluQ29udGV4dCA9IHJ1bkluQ29udGV4dDtcbiAgICBsb2Rhc2guc2FtcGxlID0gc2FtcGxlO1xuICAgIGxvZGFzaC5zaXplID0gc2l6ZTtcbiAgICBsb2Rhc2guc25ha2VDYXNlID0gc25ha2VDYXNlO1xuICAgIGxvZGFzaC5zb21lID0gc29tZTtcbiAgICBsb2Rhc2guc29ydGVkSW5kZXggPSBzb3J0ZWRJbmRleDtcbiAgICBsb2Rhc2guc29ydGVkSW5kZXhCeSA9IHNvcnRlZEluZGV4Qnk7XG4gICAgbG9kYXNoLnNvcnRlZEluZGV4T2YgPSBzb3J0ZWRJbmRleE9mO1xuICAgIGxvZGFzaC5zb3J0ZWRMYXN0SW5kZXggPSBzb3J0ZWRMYXN0SW5kZXg7XG4gICAgbG9kYXNoLnNvcnRlZExhc3RJbmRleEJ5ID0gc29ydGVkTGFzdEluZGV4Qnk7XG4gICAgbG9kYXNoLnNvcnRlZExhc3RJbmRleE9mID0gc29ydGVkTGFzdEluZGV4T2Y7XG4gICAgbG9kYXNoLnN0YXJ0Q2FzZSA9IHN0YXJ0Q2FzZTtcbiAgICBsb2Rhc2guc3RhcnRzV2l0aCA9IHN0YXJ0c1dpdGg7XG4gICAgbG9kYXNoLnN1YnRyYWN0ID0gc3VidHJhY3Q7XG4gICAgbG9kYXNoLnN1bSA9IHN1bTtcbiAgICBsb2Rhc2guc3VtQnkgPSBzdW1CeTtcbiAgICBsb2Rhc2gudGVtcGxhdGUgPSB0ZW1wbGF0ZTtcbiAgICBsb2Rhc2gudGltZXMgPSB0aW1lcztcbiAgICBsb2Rhc2gudG9GaW5pdGUgPSB0b0Zpbml0ZTtcbiAgICBsb2Rhc2gudG9JbnRlZ2VyID0gdG9JbnRlZ2VyO1xuICAgIGxvZGFzaC50b0xlbmd0aCA9IHRvTGVuZ3RoO1xuICAgIGxvZGFzaC50b0xvd2VyID0gdG9Mb3dlcjtcbiAgICBsb2Rhc2gudG9OdW1iZXIgPSB0b051bWJlcjtcbiAgICBsb2Rhc2gudG9TYWZlSW50ZWdlciA9IHRvU2FmZUludGVnZXI7XG4gICAgbG9kYXNoLnRvU3RyaW5nID0gdG9TdHJpbmc7XG4gICAgbG9kYXNoLnRvVXBwZXIgPSB0b1VwcGVyO1xuICAgIGxvZGFzaC50cmltID0gdHJpbTtcbiAgICBsb2Rhc2gudHJpbUVuZCA9IHRyaW1FbmQ7XG4gICAgbG9kYXNoLnRyaW1TdGFydCA9IHRyaW1TdGFydDtcbiAgICBsb2Rhc2gudHJ1bmNhdGUgPSB0cnVuY2F0ZTtcbiAgICBsb2Rhc2gudW5lc2NhcGUgPSB1bmVzY2FwZTtcbiAgICBsb2Rhc2gudW5pcXVlSWQgPSB1bmlxdWVJZDtcbiAgICBsb2Rhc2gudXBwZXJDYXNlID0gdXBwZXJDYXNlO1xuICAgIGxvZGFzaC51cHBlckZpcnN0ID0gdXBwZXJGaXJzdDtcblxuICAgIC8vIEFkZCBhbGlhc2VzLlxuICAgIGxvZGFzaC5lYWNoID0gZm9yRWFjaDtcbiAgICBsb2Rhc2guZWFjaFJpZ2h0ID0gZm9yRWFjaFJpZ2h0O1xuICAgIGxvZGFzaC5maXJzdCA9IGhlYWQ7XG5cbiAgICBtaXhpbihsb2Rhc2gsIChmdW5jdGlvbigpIHtcbiAgICAgIHZhciBzb3VyY2UgPSB7fTtcbiAgICAgIGJhc2VGb3JPd24obG9kYXNoLCBmdW5jdGlvbihmdW5jLCBtZXRob2ROYW1lKSB7XG4gICAgICAgIGlmICghaGFzT3duUHJvcGVydHkuY2FsbChsb2Rhc2gucHJvdG90eXBlLCBtZXRob2ROYW1lKSkge1xuICAgICAgICAgIHNvdXJjZVttZXRob2ROYW1lXSA9IGZ1bmM7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHNvdXJjZTtcbiAgICB9KCkpLCB7ICdjaGFpbic6IGZhbHNlIH0pO1xuXG4gICAgLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG4gICAgLyoqXG4gICAgICogVGhlIHNlbWFudGljIHZlcnNpb24gbnVtYmVyLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfXG4gICAgICogQHR5cGUge3N0cmluZ31cbiAgICAgKi9cbiAgICBsb2Rhc2guVkVSU0lPTiA9IFZFUlNJT047XG5cbiAgICAvLyBBc3NpZ24gZGVmYXVsdCBwbGFjZWhvbGRlcnMuXG4gICAgYXJyYXlFYWNoKFsnYmluZCcsICdiaW5kS2V5JywgJ2N1cnJ5JywgJ2N1cnJ5UmlnaHQnLCAncGFydGlhbCcsICdwYXJ0aWFsUmlnaHQnXSwgZnVuY3Rpb24obWV0aG9kTmFtZSkge1xuICAgICAgbG9kYXNoW21ldGhvZE5hbWVdLnBsYWNlaG9sZGVyID0gbG9kYXNoO1xuICAgIH0pO1xuXG4gICAgLy8gQWRkIGBMYXp5V3JhcHBlcmAgbWV0aG9kcyBmb3IgYF8uZHJvcGAgYW5kIGBfLnRha2VgIHZhcmlhbnRzLlxuICAgIGFycmF5RWFjaChbJ2Ryb3AnLCAndGFrZSddLCBmdW5jdGlvbihtZXRob2ROYW1lLCBpbmRleCkge1xuICAgICAgTGF6eVdyYXBwZXIucHJvdG90eXBlW21ldGhvZE5hbWVdID0gZnVuY3Rpb24obikge1xuICAgICAgICBuID0gbiA9PT0gdW5kZWZpbmVkID8gMSA6IG5hdGl2ZU1heCh0b0ludGVnZXIobiksIDApO1xuXG4gICAgICAgIHZhciByZXN1bHQgPSAodGhpcy5fX2ZpbHRlcmVkX18gJiYgIWluZGV4KVxuICAgICAgICAgID8gbmV3IExhenlXcmFwcGVyKHRoaXMpXG4gICAgICAgICAgOiB0aGlzLmNsb25lKCk7XG5cbiAgICAgICAgaWYgKHJlc3VsdC5fX2ZpbHRlcmVkX18pIHtcbiAgICAgICAgICByZXN1bHQuX190YWtlQ291bnRfXyA9IG5hdGl2ZU1pbihuLCByZXN1bHQuX190YWtlQ291bnRfXyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmVzdWx0Ll9fdmlld3NfXy5wdXNoKHtcbiAgICAgICAgICAgICdzaXplJzogbmF0aXZlTWluKG4sIE1BWF9BUlJBWV9MRU5HVEgpLFxuICAgICAgICAgICAgJ3R5cGUnOiBtZXRob2ROYW1lICsgKHJlc3VsdC5fX2Rpcl9fIDwgMCA/ICdSaWdodCcgOiAnJylcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgfTtcblxuICAgICAgTGF6eVdyYXBwZXIucHJvdG90eXBlW21ldGhvZE5hbWUgKyAnUmlnaHQnXSA9IGZ1bmN0aW9uKG4pIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucmV2ZXJzZSgpW21ldGhvZE5hbWVdKG4pLnJldmVyc2UoKTtcbiAgICAgIH07XG4gICAgfSk7XG5cbiAgICAvLyBBZGQgYExhenlXcmFwcGVyYCBtZXRob2RzIHRoYXQgYWNjZXB0IGFuIGBpdGVyYXRlZWAgdmFsdWUuXG4gICAgYXJyYXlFYWNoKFsnZmlsdGVyJywgJ21hcCcsICd0YWtlV2hpbGUnXSwgZnVuY3Rpb24obWV0aG9kTmFtZSwgaW5kZXgpIHtcbiAgICAgIHZhciB0eXBlID0gaW5kZXggKyAxLFxuICAgICAgICAgIGlzRmlsdGVyID0gdHlwZSA9PSBMQVpZX0ZJTFRFUl9GTEFHIHx8IHR5cGUgPT0gTEFaWV9XSElMRV9GTEFHO1xuXG4gICAgICBMYXp5V3JhcHBlci5wcm90b3R5cGVbbWV0aG9kTmFtZV0gPSBmdW5jdGlvbihpdGVyYXRlZSkge1xuICAgICAgICB2YXIgcmVzdWx0ID0gdGhpcy5jbG9uZSgpO1xuICAgICAgICByZXN1bHQuX19pdGVyYXRlZXNfXy5wdXNoKHtcbiAgICAgICAgICAnaXRlcmF0ZWUnOiBnZXRJdGVyYXRlZShpdGVyYXRlZSwgMyksXG4gICAgICAgICAgJ3R5cGUnOiB0eXBlXG4gICAgICAgIH0pO1xuICAgICAgICByZXN1bHQuX19maWx0ZXJlZF9fID0gcmVzdWx0Ll9fZmlsdGVyZWRfXyB8fCBpc0ZpbHRlcjtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgIH07XG4gICAgfSk7XG5cbiAgICAvLyBBZGQgYExhenlXcmFwcGVyYCBtZXRob2RzIGZvciBgXy5oZWFkYCBhbmQgYF8ubGFzdGAuXG4gICAgYXJyYXlFYWNoKFsnaGVhZCcsICdsYXN0J10sIGZ1bmN0aW9uKG1ldGhvZE5hbWUsIGluZGV4KSB7XG4gICAgICB2YXIgdGFrZU5hbWUgPSAndGFrZScgKyAoaW5kZXggPyAnUmlnaHQnIDogJycpO1xuXG4gICAgICBMYXp5V3JhcHBlci5wcm90b3R5cGVbbWV0aG9kTmFtZV0gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXNbdGFrZU5hbWVdKDEpLnZhbHVlKClbMF07XG4gICAgICB9O1xuICAgIH0pO1xuXG4gICAgLy8gQWRkIGBMYXp5V3JhcHBlcmAgbWV0aG9kcyBmb3IgYF8uaW5pdGlhbGAgYW5kIGBfLnRhaWxgLlxuICAgIGFycmF5RWFjaChbJ2luaXRpYWwnLCAndGFpbCddLCBmdW5jdGlvbihtZXRob2ROYW1lLCBpbmRleCkge1xuICAgICAgdmFyIGRyb3BOYW1lID0gJ2Ryb3AnICsgKGluZGV4ID8gJycgOiAnUmlnaHQnKTtcblxuICAgICAgTGF6eVdyYXBwZXIucHJvdG90eXBlW21ldGhvZE5hbWVdID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9fZmlsdGVyZWRfXyA/IG5ldyBMYXp5V3JhcHBlcih0aGlzKSA6IHRoaXNbZHJvcE5hbWVdKDEpO1xuICAgICAgfTtcbiAgICB9KTtcblxuICAgIExhenlXcmFwcGVyLnByb3RvdHlwZS5jb21wYWN0ID0gZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy5maWx0ZXIoaWRlbnRpdHkpO1xuICAgIH07XG5cbiAgICBMYXp5V3JhcHBlci5wcm90b3R5cGUuZmluZCA9IGZ1bmN0aW9uKHByZWRpY2F0ZSkge1xuICAgICAgcmV0dXJuIHRoaXMuZmlsdGVyKHByZWRpY2F0ZSkuaGVhZCgpO1xuICAgIH07XG5cbiAgICBMYXp5V3JhcHBlci5wcm90b3R5cGUuZmluZExhc3QgPSBmdW5jdGlvbihwcmVkaWNhdGUpIHtcbiAgICAgIHJldHVybiB0aGlzLnJldmVyc2UoKS5maW5kKHByZWRpY2F0ZSk7XG4gICAgfTtcblxuICAgIExhenlXcmFwcGVyLnByb3RvdHlwZS5pbnZva2VNYXAgPSBiYXNlUmVzdChmdW5jdGlvbihwYXRoLCBhcmdzKSB7XG4gICAgICBpZiAodHlwZW9mIHBhdGggPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICByZXR1cm4gbmV3IExhenlXcmFwcGVyKHRoaXMpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXMubWFwKGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiBiYXNlSW52b2tlKHZhbHVlLCBwYXRoLCBhcmdzKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgTGF6eVdyYXBwZXIucHJvdG90eXBlLnJlamVjdCA9IGZ1bmN0aW9uKHByZWRpY2F0ZSkge1xuICAgICAgcmV0dXJuIHRoaXMuZmlsdGVyKG5lZ2F0ZShnZXRJdGVyYXRlZShwcmVkaWNhdGUpKSk7XG4gICAgfTtcblxuICAgIExhenlXcmFwcGVyLnByb3RvdHlwZS5zbGljZSA9IGZ1bmN0aW9uKHN0YXJ0LCBlbmQpIHtcbiAgICAgIHN0YXJ0ID0gdG9JbnRlZ2VyKHN0YXJ0KTtcblxuICAgICAgdmFyIHJlc3VsdCA9IHRoaXM7XG4gICAgICBpZiAocmVzdWx0Ll9fZmlsdGVyZWRfXyAmJiAoc3RhcnQgPiAwIHx8IGVuZCA8IDApKSB7XG4gICAgICAgIHJldHVybiBuZXcgTGF6eVdyYXBwZXIocmVzdWx0KTtcbiAgICAgIH1cbiAgICAgIGlmIChzdGFydCA8IDApIHtcbiAgICAgICAgcmVzdWx0ID0gcmVzdWx0LnRha2VSaWdodCgtc3RhcnQpO1xuICAgICAgfSBlbHNlIGlmIChzdGFydCkge1xuICAgICAgICByZXN1bHQgPSByZXN1bHQuZHJvcChzdGFydCk7XG4gICAgICB9XG4gICAgICBpZiAoZW5kICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgZW5kID0gdG9JbnRlZ2VyKGVuZCk7XG4gICAgICAgIHJlc3VsdCA9IGVuZCA8IDAgPyByZXN1bHQuZHJvcFJpZ2h0KC1lbmQpIDogcmVzdWx0LnRha2UoZW5kIC0gc3RhcnQpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuXG4gICAgTGF6eVdyYXBwZXIucHJvdG90eXBlLnRha2VSaWdodFdoaWxlID0gZnVuY3Rpb24ocHJlZGljYXRlKSB7XG4gICAgICByZXR1cm4gdGhpcy5yZXZlcnNlKCkudGFrZVdoaWxlKHByZWRpY2F0ZSkucmV2ZXJzZSgpO1xuICAgIH07XG5cbiAgICBMYXp5V3JhcHBlci5wcm90b3R5cGUudG9BcnJheSA9IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMudGFrZShNQVhfQVJSQVlfTEVOR1RIKTtcbiAgICB9O1xuXG4gICAgLy8gQWRkIGBMYXp5V3JhcHBlcmAgbWV0aG9kcyB0byBgbG9kYXNoLnByb3RvdHlwZWAuXG4gICAgYmFzZUZvck93bihMYXp5V3JhcHBlci5wcm90b3R5cGUsIGZ1bmN0aW9uKGZ1bmMsIG1ldGhvZE5hbWUpIHtcbiAgICAgIHZhciBjaGVja0l0ZXJhdGVlID0gL14oPzpmaWx0ZXJ8ZmluZHxtYXB8cmVqZWN0KXxXaGlsZSQvLnRlc3QobWV0aG9kTmFtZSksXG4gICAgICAgICAgaXNUYWtlciA9IC9eKD86aGVhZHxsYXN0KSQvLnRlc3QobWV0aG9kTmFtZSksXG4gICAgICAgICAgbG9kYXNoRnVuYyA9IGxvZGFzaFtpc1Rha2VyID8gKCd0YWtlJyArIChtZXRob2ROYW1lID09ICdsYXN0JyA/ICdSaWdodCcgOiAnJykpIDogbWV0aG9kTmFtZV0sXG4gICAgICAgICAgcmV0VW53cmFwcGVkID0gaXNUYWtlciB8fCAvXmZpbmQvLnRlc3QobWV0aG9kTmFtZSk7XG5cbiAgICAgIGlmICghbG9kYXNoRnVuYykge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBsb2Rhc2gucHJvdG90eXBlW21ldGhvZE5hbWVdID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IHRoaXMuX193cmFwcGVkX18sXG4gICAgICAgICAgICBhcmdzID0gaXNUYWtlciA/IFsxXSA6IGFyZ3VtZW50cyxcbiAgICAgICAgICAgIGlzTGF6eSA9IHZhbHVlIGluc3RhbmNlb2YgTGF6eVdyYXBwZXIsXG4gICAgICAgICAgICBpdGVyYXRlZSA9IGFyZ3NbMF0sXG4gICAgICAgICAgICB1c2VMYXp5ID0gaXNMYXp5IHx8IGlzQXJyYXkodmFsdWUpO1xuXG4gICAgICAgIHZhciBpbnRlcmNlcHRvciA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICAgICAgdmFyIHJlc3VsdCA9IGxvZGFzaEZ1bmMuYXBwbHkobG9kYXNoLCBhcnJheVB1c2goW3ZhbHVlXSwgYXJncykpO1xuICAgICAgICAgIHJldHVybiAoaXNUYWtlciAmJiBjaGFpbkFsbCkgPyByZXN1bHRbMF0gOiByZXN1bHQ7XG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKHVzZUxhenkgJiYgY2hlY2tJdGVyYXRlZSAmJiB0eXBlb2YgaXRlcmF0ZWUgPT0gJ2Z1bmN0aW9uJyAmJiBpdGVyYXRlZS5sZW5ndGggIT0gMSkge1xuICAgICAgICAgIC8vIEF2b2lkIGxhenkgdXNlIGlmIHRoZSBpdGVyYXRlZSBoYXMgYSBcImxlbmd0aFwiIHZhbHVlIG90aGVyIHRoYW4gYDFgLlxuICAgICAgICAgIGlzTGF6eSA9IHVzZUxhenkgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY2hhaW5BbGwgPSB0aGlzLl9fY2hhaW5fXyxcbiAgICAgICAgICAgIGlzSHlicmlkID0gISF0aGlzLl9fYWN0aW9uc19fLmxlbmd0aCxcbiAgICAgICAgICAgIGlzVW53cmFwcGVkID0gcmV0VW53cmFwcGVkICYmICFjaGFpbkFsbCxcbiAgICAgICAgICAgIG9ubHlMYXp5ID0gaXNMYXp5ICYmICFpc0h5YnJpZDtcblxuICAgICAgICBpZiAoIXJldFVud3JhcHBlZCAmJiB1c2VMYXp5KSB7XG4gICAgICAgICAgdmFsdWUgPSBvbmx5TGF6eSA/IHZhbHVlIDogbmV3IExhenlXcmFwcGVyKHRoaXMpO1xuICAgICAgICAgIHZhciByZXN1bHQgPSBmdW5jLmFwcGx5KHZhbHVlLCBhcmdzKTtcbiAgICAgICAgICByZXN1bHQuX19hY3Rpb25zX18ucHVzaCh7ICdmdW5jJzogdGhydSwgJ2FyZ3MnOiBbaW50ZXJjZXB0b3JdLCAndGhpc0FyZyc6IHVuZGVmaW5lZCB9KTtcbiAgICAgICAgICByZXR1cm4gbmV3IExvZGFzaFdyYXBwZXIocmVzdWx0LCBjaGFpbkFsbCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlzVW53cmFwcGVkICYmIG9ubHlMYXp5KSB7XG4gICAgICAgICAgcmV0dXJuIGZ1bmMuYXBwbHkodGhpcywgYXJncyk7XG4gICAgICAgIH1cbiAgICAgICAgcmVzdWx0ID0gdGhpcy50aHJ1KGludGVyY2VwdG9yKTtcbiAgICAgICAgcmV0dXJuIGlzVW53cmFwcGVkID8gKGlzVGFrZXIgPyByZXN1bHQudmFsdWUoKVswXSA6IHJlc3VsdC52YWx1ZSgpKSA6IHJlc3VsdDtcbiAgICAgIH07XG4gICAgfSk7XG5cbiAgICAvLyBBZGQgYEFycmF5YCBtZXRob2RzIHRvIGBsb2Rhc2gucHJvdG90eXBlYC5cbiAgICBhcnJheUVhY2goWydwb3AnLCAncHVzaCcsICdzaGlmdCcsICdzb3J0JywgJ3NwbGljZScsICd1bnNoaWZ0J10sIGZ1bmN0aW9uKG1ldGhvZE5hbWUpIHtcbiAgICAgIHZhciBmdW5jID0gYXJyYXlQcm90b1ttZXRob2ROYW1lXSxcbiAgICAgICAgICBjaGFpbk5hbWUgPSAvXig/OnB1c2h8c29ydHx1bnNoaWZ0KSQvLnRlc3QobWV0aG9kTmFtZSkgPyAndGFwJyA6ICd0aHJ1JyxcbiAgICAgICAgICByZXRVbndyYXBwZWQgPSAvXig/OnBvcHxzaGlmdCkkLy50ZXN0KG1ldGhvZE5hbWUpO1xuXG4gICAgICBsb2Rhc2gucHJvdG90eXBlW21ldGhvZE5hbWVdID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBhcmdzID0gYXJndW1lbnRzO1xuICAgICAgICBpZiAocmV0VW53cmFwcGVkICYmICF0aGlzLl9fY2hhaW5fXykge1xuICAgICAgICAgIHZhciB2YWx1ZSA9IHRoaXMudmFsdWUoKTtcbiAgICAgICAgICByZXR1cm4gZnVuYy5hcHBseShpc0FycmF5KHZhbHVlKSA/IHZhbHVlIDogW10sIGFyZ3MpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzW2NoYWluTmFtZV0oZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgICByZXR1cm4gZnVuYy5hcHBseShpc0FycmF5KHZhbHVlKSA/IHZhbHVlIDogW10sIGFyZ3MpO1xuICAgICAgICB9KTtcbiAgICAgIH07XG4gICAgfSk7XG5cbiAgICAvLyBNYXAgbWluaWZpZWQgbWV0aG9kIG5hbWVzIHRvIHRoZWlyIHJlYWwgbmFtZXMuXG4gICAgYmFzZUZvck93bihMYXp5V3JhcHBlci5wcm90b3R5cGUsIGZ1bmN0aW9uKGZ1bmMsIG1ldGhvZE5hbWUpIHtcbiAgICAgIHZhciBsb2Rhc2hGdW5jID0gbG9kYXNoW21ldGhvZE5hbWVdO1xuICAgICAgaWYgKGxvZGFzaEZ1bmMpIHtcbiAgICAgICAgdmFyIGtleSA9IChsb2Rhc2hGdW5jLm5hbWUgKyAnJyksXG4gICAgICAgICAgICBuYW1lcyA9IHJlYWxOYW1lc1trZXldIHx8IChyZWFsTmFtZXNba2V5XSA9IFtdKTtcblxuICAgICAgICBuYW1lcy5wdXNoKHsgJ25hbWUnOiBtZXRob2ROYW1lLCAnZnVuYyc6IGxvZGFzaEZ1bmMgfSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICByZWFsTmFtZXNbY3JlYXRlSHlicmlkKHVuZGVmaW5lZCwgV1JBUF9CSU5EX0tFWV9GTEFHKS5uYW1lXSA9IFt7XG4gICAgICAnbmFtZSc6ICd3cmFwcGVyJyxcbiAgICAgICdmdW5jJzogdW5kZWZpbmVkXG4gICAgfV07XG5cbiAgICAvLyBBZGQgbWV0aG9kcyB0byBgTGF6eVdyYXBwZXJgLlxuICAgIExhenlXcmFwcGVyLnByb3RvdHlwZS5jbG9uZSA9IGxhenlDbG9uZTtcbiAgICBMYXp5V3JhcHBlci5wcm90b3R5cGUucmV2ZXJzZSA9IGxhenlSZXZlcnNlO1xuICAgIExhenlXcmFwcGVyLnByb3RvdHlwZS52YWx1ZSA9IGxhenlWYWx1ZTtcblxuICAgIC8vIEFkZCBjaGFpbiBzZXF1ZW5jZSBtZXRob2RzIHRvIHRoZSBgbG9kYXNoYCB3cmFwcGVyLlxuICAgIGxvZGFzaC5wcm90b3R5cGUuYXQgPSB3cmFwcGVyQXQ7XG4gICAgbG9kYXNoLnByb3RvdHlwZS5jaGFpbiA9IHdyYXBwZXJDaGFpbjtcbiAgICBsb2Rhc2gucHJvdG90eXBlLmNvbW1pdCA9IHdyYXBwZXJDb21taXQ7XG4gICAgbG9kYXNoLnByb3RvdHlwZS5uZXh0ID0gd3JhcHBlck5leHQ7XG4gICAgbG9kYXNoLnByb3RvdHlwZS5wbGFudCA9IHdyYXBwZXJQbGFudDtcbiAgICBsb2Rhc2gucHJvdG90eXBlLnJldmVyc2UgPSB3cmFwcGVyUmV2ZXJzZTtcbiAgICBsb2Rhc2gucHJvdG90eXBlLnRvSlNPTiA9IGxvZGFzaC5wcm90b3R5cGUudmFsdWVPZiA9IGxvZGFzaC5wcm90b3R5cGUudmFsdWUgPSB3cmFwcGVyVmFsdWU7XG5cbiAgICAvLyBBZGQgbGF6eSBhbGlhc2VzLlxuICAgIGxvZGFzaC5wcm90b3R5cGUuZmlyc3QgPSBsb2Rhc2gucHJvdG90eXBlLmhlYWQ7XG5cbiAgICBpZiAoc3ltSXRlcmF0b3IpIHtcbiAgICAgIGxvZGFzaC5wcm90b3R5cGVbc3ltSXRlcmF0b3JdID0gd3JhcHBlclRvSXRlcmF0b3I7XG4gICAgfVxuICAgIHJldHVybiBsb2Rhc2g7XG4gIH0pO1xuXG4gIC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG4gIC8vIEV4cG9ydCBsb2Rhc2guXG4gIHZhciBfID0gcnVuSW5Db250ZXh0KCk7XG5cbiAgLy8gU29tZSBBTUQgYnVpbGQgb3B0aW1pemVycywgbGlrZSByLmpzLCBjaGVjayBmb3IgY29uZGl0aW9uIHBhdHRlcm5zIGxpa2U6XG4gIGlmICh0eXBlb2YgZGVmaW5lID09ICdmdW5jdGlvbicgJiYgdHlwZW9mIGRlZmluZS5hbWQgPT0gJ29iamVjdCcgJiYgZGVmaW5lLmFtZCkge1xuICAgIC8vIEV4cG9zZSBMb2Rhc2ggb24gdGhlIGdsb2JhbCBvYmplY3QgdG8gcHJldmVudCBlcnJvcnMgd2hlbiBMb2Rhc2ggaXNcbiAgICAvLyBsb2FkZWQgYnkgYSBzY3JpcHQgdGFnIGluIHRoZSBwcmVzZW5jZSBvZiBhbiBBTUQgbG9hZGVyLlxuICAgIC8vIFNlZSBodHRwOi8vcmVxdWlyZWpzLm9yZy9kb2NzL2Vycm9ycy5odG1sI21pc21hdGNoIGZvciBtb3JlIGRldGFpbHMuXG4gICAgLy8gVXNlIGBfLm5vQ29uZmxpY3RgIHRvIHJlbW92ZSBMb2Rhc2ggZnJvbSB0aGUgZ2xvYmFsIG9iamVjdC5cbiAgICByb290Ll8gPSBfO1xuXG4gICAgLy8gRGVmaW5lIGFzIGFuIGFub255bW91cyBtb2R1bGUgc28sIHRocm91Z2ggcGF0aCBtYXBwaW5nLCBpdCBjYW4gYmVcbiAgICAvLyByZWZlcmVuY2VkIGFzIHRoZSBcInVuZGVyc2NvcmVcIiBtb2R1bGUuXG4gICAgZGVmaW5lKGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIF87XG4gICAgfSk7XG4gIH1cbiAgLy8gQ2hlY2sgZm9yIGBleHBvcnRzYCBhZnRlciBgZGVmaW5lYCBpbiBjYXNlIGEgYnVpbGQgb3B0aW1pemVyIGFkZHMgaXQuXG4gIGVsc2UgaWYgKGZyZWVNb2R1bGUpIHtcbiAgICAvLyBFeHBvcnQgZm9yIE5vZGUuanMuXG4gICAgKGZyZWVNb2R1bGUuZXhwb3J0cyA9IF8pLl8gPSBfO1xuICAgIC8vIEV4cG9ydCBmb3IgQ29tbW9uSlMgc3VwcG9ydC5cbiAgICBmcmVlRXhwb3J0cy5fID0gXztcbiAgfVxuICBlbHNlIHtcbiAgICAvLyBFeHBvcnQgdG8gdGhlIGdsb2JhbCBvYmplY3QuXG4gICAgcm9vdC5fID0gXztcbiAgfVxufS5jYWxsKHRoaXMpKTtcbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/lodash/lodash.js\n");

/***/ }),

/***/ "./node_modules/postal/lib/postal.js":
/*!*******************************************!*\
  !*** ./node_modules/postal/lib/postal.js ***!
  \*******************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/**\n * postal - Pub/Sub library providing wildcard subscriptions, complex message handling, etc.  Works server and client-side.\n * Author: Jim Cowart (http://ifandelse.com)\n * Version: v2.0.5\n * Url: http://github.com/postaljs/postal.js\n * License(s): MIT\n */\n\n( function( root, factory ) {\n\t\n\tif ( true ) {\n\t\t// AMD. Register as an anonymous module.\n\t\t!(__WEBPACK_AMD_DEFINE_ARRAY__ = [ __webpack_require__(/*! lodash */ \"./node_modules/lodash/lodash.js\") ], __WEBPACK_AMD_DEFINE_RESULT__ = (function( _ ) {\n\t\t\treturn factory( _, root );\n\t\t}).apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\t\n\t} else {}\n}( this, function( _, global, undefined ) {\n\tvar prevPostal = global && global.postal;\n\tvar prevLodash = global && global._;\n\tif ( prevLodash && prevLodash !== _ ) {\n\t\t_ = _.noConflict();\n\t}\n\tvar _defaultConfig = {\n\t\tDEFAULT_CHANNEL: \"/\",\n\t\tSYSTEM_CHANNEL: \"postal\",\n\t\tenableSystemMessages: true,\n\t\tcacheKeyDelimiter: \"|\",\n\t\tautoCompactResolver: false\n\t};\n\tvar postal = {\n\t\tconfiguration: _.extend( {}, _defaultConfig )\n\t};\n\tvar _config = postal.configuration;\n\n\t\n\nvar ChannelDefinition = function( channelName, bus ) {\n\tthis.bus = bus;\n\tthis.channel = channelName || _config.DEFAULT_CHANNEL;\n};\n\nChannelDefinition.prototype.subscribe = function() {\n\treturn this.bus.subscribe( {\n\t\tchannel: this.channel,\n\t\ttopic: ( arguments.length === 1 ? arguments[ 0 ].topic : arguments[ 0 ] ),\n\t\tcallback: ( arguments.length === 1 ? arguments[ 0 ].callback : arguments[ 1 ] )\n\t} );\n};\n\n/*\n    publish( envelope [, callback ] );\n    publish( topic, data [, callback ] );\n*/\nChannelDefinition.prototype.publish = function() {\n\tvar envelope = {};\n\tvar callback;\n\tif ( typeof arguments[ 0 ] === \"string\" ) {\n\t\tenvelope.topic = arguments[ 0 ];\n\t\tenvelope.data = arguments[ 1 ];\n\t\tcallback = arguments[ 2 ];\n\t} else {\n\t\tenvelope = arguments[ 0 ];\n\t\tcallback = arguments[ 1 ];\n\t}\n\tif ( typeof envelope !== \"object\" ) {\n\t\tthrow new Error( \"The first argument to ChannelDefinition.publish should be either an envelope object or a string topic.\" );\n\t}\n\tenvelope.headers = _.extend( envelope.headers || { resolverNoCache: _config.resolverNoCache } );\n\tenvelope.channel = this.channel;\n\tthis.bus.publish( envelope, callback );\n};\n\n\t\nvar SubscriptionDefinition = function( channel, topic, callback ) {\n\tif ( arguments.length !== 3 ) {\n\t\tthrow new Error( \"You must provide a channel, topic and callback when creating a SubscriptionDefinition instance.\" );\n\t}\n\tif ( topic.length === 0 ) {\n\t\tthrow new Error( \"Topics cannot be empty\" );\n\t}\n\tthis.channel = channel;\n\tthis.topic = topic;\n\tthis.callback = callback;\n\tthis.pipeline = [];\n\tthis.cacheKeys = [];\n\tthis._context = undefined;\n};\n\nvar ConsecutiveDistinctPredicate = function() {\n\tvar previous;\n\treturn function( data ) {\n\t\tvar eq = false;\n\t\tif ( typeof data === \"string\" ) {\n\t\t\teq = data === previous;\n\t\t\tprevious = data;\n\t\t} else {\n\t\t\teq = _.isEqual( data, previous );\n\t\t\tprevious = _.extend( {}, data );\n\t\t}\n\t\treturn !eq;\n\t};\n};\n\nvar DistinctPredicate = function DistinctPredicateFactory() {\n\tvar previous = [];\n\treturn function DistinctPredicate( data ) {\n\t\tvar isDistinct = !_.some( previous, function( p ) {\n\t\t\treturn _.isEqual( data, p );\n\t\t} );\n\t\tif ( isDistinct ) {\n\t\t\tprevious.push( data );\n\t\t}\n\t\treturn isDistinct;\n\t};\n};\n\nSubscriptionDefinition.prototype = {\n\n\t\"catch\": function( errorHandler ) {\n\t\tvar original = this.callback;\n\t\tvar safeCallback = function() {\n\t\t\ttry {\n\t\t\t\toriginal.apply( this, arguments );\n\t\t\t} catch ( err ) {\n\t\t\t\terrorHandler( err, arguments[ 0 ] );\n\t\t\t}\n\t\t};\n\t\tthis.callback = safeCallback;\n\t\treturn this;\n\t},\n\n\tdefer: function defer() {\n\t\treturn this.delay( 0 );\n\t},\n\n\tdisposeAfter: function disposeAfter( maxCalls ) {\n\t\tif ( typeof maxCalls !== \"number\" || maxCalls <= 0 ) {\n\t\t\tthrow new Error( \"The value provided to disposeAfter (maxCalls) must be a number greater than zero.\" );\n\t\t}\n\t\tvar dispose = _.after( maxCalls, this.unsubscribe.bind( this ) );\n\t\tthis.pipeline.push( function( data, env, next ) {\n\t\t\tnext( data, env );\n\t\t\tdispose();\n\t\t} );\n\t\treturn this;\n\t},\n\n\tdistinct: function distinct() {\n\t\treturn this.constraint( new DistinctPredicate() );\n\t},\n\n\tdistinctUntilChanged: function distinctUntilChanged() {\n\t\treturn this.constraint( new ConsecutiveDistinctPredicate() );\n\t},\n\n\tinvokeSubscriber: function invokeSubscriber( data, env ) {\n\t\tif ( !this.inactive ) {\n\t\t\tvar self = this;\n\t\t\tvar pipeline = self.pipeline;\n\t\t\tvar len = pipeline.length;\n\t\t\tvar context = self._context;\n\t\t\tvar idx = -1;\n\t\t\tvar invoked = false;\n\t\t\tif ( !len ) {\n\t\t\t\tself.callback.call( context, data, env );\n\t\t\t\tinvoked = true;\n\t\t\t} else {\n\t\t\t\tpipeline = pipeline.concat( [ self.callback ] );\n\t\t\t\tvar step = function step( d, e ) {\n\t\t\t\t\tidx += 1;\n\t\t\t\t\tif ( idx < len ) {\n\t\t\t\t\t\tpipeline[ idx ].call( context, d, e, step );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tself.callback.call( context, d, e );\n\t\t\t\t\t\tinvoked = true;\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tstep( data, env, 0 );\n\t\t\t}\n\t\t\treturn invoked;\n\t\t}\n\t},\n\n\tlogError: function logError() {\n\t\t\n\t\tif ( console ) {\n\t\t\tvar report;\n\t\t\tif ( console.warn ) {\n\t\t\t\treport = console.warn;\n\t\t\t} else {\n\t\t\t\treport = console.log;\n\t\t\t}\n\t\t\tthis.catch( report );\n\t\t}\n\t\treturn this;\n\t},\n\n\tonce: function once() {\n\t\treturn this.disposeAfter( 1 );\n\t},\n\n\tsubscribe: function subscribe( callback ) {\n\t\tthis.callback = callback;\n\t\treturn this;\n\t},\n\n\tunsubscribe: function unsubscribe() {\n\t\t\n\t\tif ( !this.inactive ) {\n\t\t\tpostal.unsubscribe( this );\n\t\t}\n\t},\n\n\tconstraint: function constraint( predicate ) {\n\t\tif ( typeof predicate !== \"function\" ) {\n\t\t\tthrow new Error( \"Predicate constraint must be a function\" );\n\t\t}\n\t\tthis.pipeline.push( function( data, env, next ) {\n\t\t\tif ( predicate.call( this, data, env ) ) {\n\t\t\t\tnext( data, env );\n\t\t\t}\n\t\t} );\n\t\treturn this;\n\t},\n\n\tconstraints: function constraints( predicates ) {\n\t\tvar self = this;\n\t\t\n\t\t_.each( predicates, function( predicate ) {\n\t\t\tself.constraint( predicate );\n\t\t} );\n\t\treturn self;\n\t},\n\n\tcontext: function contextSetter( context ) {\n\t\tthis._context = context;\n\t\treturn this;\n\t},\n\n\tdebounce: function debounce( milliseconds, immediate ) {\n\t\tif ( typeof milliseconds !== \"number\" ) {\n\t\t\tthrow new Error( \"Milliseconds must be a number\" );\n\t\t}\n\n\t\tvar options = {};\n\n\t\tif ( !!immediate === true ) { \n\t\t\toptions.leading = true;\n\t\t\toptions.trailing = false;\n\t\t}\n\n\t\tthis.pipeline.push(\n\t\t\t_.debounce( function( data, env, next ) {\n\t\t\t\tnext( data, env );\n\t\t\t},\n\t\t\t\tmilliseconds,\n\t\t\t\toptions\n\t\t\t)\n\t\t);\n\t\treturn this;\n\t},\n\n\tdelay: function delay( milliseconds ) {\n\t\tif ( typeof milliseconds !== \"number\" ) {\n\t\t\tthrow new Error( \"Milliseconds must be a number\" );\n\t\t}\n\t\tvar self = this;\n\t\tself.pipeline.push( function( data, env, next ) {\n\t\t\tsetTimeout( function() {\n\t\t\t\tnext( data, env );\n\t\t\t}, milliseconds );\n\t\t} );\n\t\treturn this;\n\t},\n\n\tthrottle: function throttle( milliseconds ) {\n\t\tif ( typeof milliseconds !== \"number\" ) {\n\t\t\tthrow new Error( \"Milliseconds must be a number\" );\n\t\t}\n\t\tvar fn = function( data, env, next ) {\n\t\t\tnext( data, env );\n\t\t};\n\t\tthis.pipeline.push( _.throttle( fn, milliseconds ) );\n\t\treturn this;\n\t}\n};\n\n\t\n\n\nvar bindingsResolver = _config.resolver = {\n\tcache: {},\n\tregex: {},\n\tenableCache: true,\n\n\tcompare: function compare( binding, topic, headerOptions ) {\n\t\tvar pattern;\n\t\tvar rgx;\n\t\tvar prevSegment;\n\t\tvar cacheKey = topic + _config.cacheKeyDelimiter + binding;\n\t\tvar result = ( this.cache[ cacheKey ] );\n\t\tvar opt = headerOptions || {};\n\t\tvar saveToCache = this.enableCache && !opt.resolverNoCache;\n\t\t// result is cached?\n\t\tif ( result === true ) {\n\t\t\treturn result;\n\t\t}\n\t\t// plain string matching?\n\t\tif ( binding.indexOf( \"#\" ) === -1 && binding.indexOf( \"*\" ) === -1 ) {\n\t\t\tresult = ( topic === binding );\n\t\t\tif ( saveToCache ) {\n\t\t\t\tthis.cache[ cacheKey ] = result;\n\t\t\t}\n\t\t\treturn result;\n\t\t}\n\t\t// ah, regex matching, then\n\t\tif ( !( rgx = this.regex[ binding ] ) ) {\n\t\t\tpattern = \"^\" + _.map( binding.split( \".\" ), function mapTopicBinding( segment ) {\n\t\t\t\t\tvar res = \"\";\n\t\t\t\t\tif ( !!prevSegment ) {\n\t\t\t\t\t\tres = prevSegment !== \"#\" ? \"\\\\.\\\\b\" : \"\\\\b\";\n\t\t\t\t\t}\n\t\t\t\t\tif ( segment === \"#\" ) {\n\t\t\t\t\t\tres += \"[\\\\s\\\\S]*\";\n\t\t\t\t\t} else if ( segment === \"*\" ) {\n\t\t\t\t\t\tres += \"[^.]+\";\n\t\t\t\t\t} else {\n\t\t\t\t\t\tres += segment;\n\t\t\t\t\t}\n\t\t\t\t\tprevSegment = segment;\n\t\t\t\t\treturn res;\n\t\t\t\t} ).join( \"\" ) + \"$\";\n\t\t\trgx = this.regex[ binding ] = new RegExp( pattern );\n\t\t}\n\t\tresult = rgx.test( topic );\n\t\tif ( saveToCache ) {\n\t\t\tthis.cache[ cacheKey ] = result;\n\t\t}\n\t\treturn result;\n\t},\n\n\treset: function reset() {\n\t\tthis.cache = {};\n\t\tthis.regex = {};\n\t},\n\n\tpurge: function( options ) {\n\t\tvar self = this;\n\t\tvar keyDelimiter = _config.cacheKeyDelimiter;\n\t\tvar matchPredicate = function( val, key ) {\n\t\t\tvar split = key.split( keyDelimiter );\n\t\t\tvar topic = split[ 0 ];\n\t\t\tvar binding = split[ 1 ];\n\t\t\tif ( ( typeof options.topic === \"undefined\" || options.topic === topic ) &&\n\t\t\t\t\t( typeof options.binding === \"undefined\" || options.binding === binding ) ) {\n\t\t\t\tdelete self.cache[ key ];\n\t\t\t}\n\t\t};\n\n\t\tvar compactPredicate = function( val, key ) {\n\t\t\tvar split = key.split( keyDelimiter );\n\t\t\tif ( postal.getSubscribersFor( { topic: split[ 0 ] } ).length === 0 ) {\n\t\t\t\tdelete self.cache[ key ];\n\t\t\t}\n\t\t};\n\n\t\tif ( typeof options === \"undefined\" ) {\n\t\t\tthis.reset();\n\t\t} else {\n\t\t\tvar handler = options.compact === true ? compactPredicate : matchPredicate;\n\t\t\t_.each( this.cache, handler );\n\t\t}\n\t}\n};\n\n\t\n\n\nvar pubInProgress = 0;\nvar unSubQueue = [];\nvar autoCompactIndex = 0;\n\nfunction clearUnSubQueue() {\n\twhile ( unSubQueue.length ) {\n\t\tpostal.unsubscribe( unSubQueue.shift() );\n\t}\n}\n\nfunction getCachePurger( subDef, key, cache ) {\n\treturn function( sub, i, list ) {\n\t\tif ( sub === subDef ) {\n\t\t\tlist.splice( i, 1 );\n\t\t}\n\t\tif ( list.length === 0 ) {\n\t\t\tdelete cache[ key ];\n\t\t}\n\t};\n}\n\nfunction getCacher( topic, pubCache, cacheKey, done, envelope ) {\n\tvar headers = envelope && envelope.headers || {};\n\treturn function( subDef ) {\n\t\tvar cache;\n\t\tif ( _config.resolver.compare( subDef.topic, topic, headers ) ) {\n\t\t\tif ( !headers.resolverNoCache ) {\n\t\t\t\tcache = pubCache[ cacheKey ] = ( pubCache[ cacheKey ] || [] );\n\t\t\t\tcache.push( subDef );\n\t\t\t\tsubDef.cacheKeys.push( cacheKey );\n\t\t\t}\n\t\t\tif ( done ) {\n\t\t\t\tdone( subDef );\n\t\t\t}\n\t\t}\n\t};\n}\n\nfunction getSystemMessage( kind, subDef ) {\n\treturn {\n\t\tchannel: _config.SYSTEM_CHANNEL,\n\t\ttopic: \"subscription.\" + kind,\n\t\tdata: {\n\t\t\tevent: \"subscription.\" + kind,\n\t\t\tchannel: subDef.channel,\n\t\t\ttopic: subDef.topic\n\t\t}\n\t};\n}\n\nvar sysCreatedMessage = getSystemMessage.bind( undefined, \"created\" );\nvar sysRemovedMessage = getSystemMessage.bind( undefined, \"removed\" );\n\nfunction getPredicate( options, resolver ) {\n\tif ( typeof options === \"function\" ) {\n\t\treturn options;\n\t} else if ( !options ) {\n\t\treturn function() {\n\t\t\treturn true;\n\t\t};\n\t} else {\n\t\treturn function( sub ) {\n\t\t\tvar compared = 0;\n\t\t\tvar matched = 0;\n\t\t\t_.each( options, function( val, prop ) {\n\t\t\t\tcompared += 1;\n\t\t\t\tif (\n\t\t\t\t// We use the bindings resolver to compare the options.topic to subDef.topic\n\t\t\t\t( prop === \"topic\" && resolver.compare( sub.topic, options.topic, { resolverNoCache: true } ) ) ||\n\t\t\t\t\t\t( prop === \"context\" && options.context === sub._context ) ||\n\t\t\t\t\t\t// Any other potential prop/value matching outside topic & context...\n\t\t\t\t\t\t( sub[ prop ] === options[ prop ] ) ) {\n\t\t\t\t\tmatched += 1;\n\t\t\t\t}\n\t\t\t} );\n\t\t\treturn compared === matched;\n\t\t};\n\t}\n}\n\n_.extend( postal, {\n\tcache: {},\n\tsubscriptions: {},\n\twireTaps: [],\n\n\tChannelDefinition: ChannelDefinition,\n\tSubscriptionDefinition: SubscriptionDefinition,\n\n\tchannel: function channel( channelName ) {\n\t\treturn new ChannelDefinition( channelName, this );\n\t},\n\n\taddWireTap: function addWireTap( callback ) {\n\t\tvar self = this;\n\t\tself.wireTaps.push( callback );\n\t\treturn function() {\n\t\t\tvar idx = self.wireTaps.indexOf( callback );\n\t\t\tif ( idx !== -1 ) {\n\t\t\t\tself.wireTaps.splice( idx, 1 );\n\t\t\t}\n\t\t};\n\t},\n\n\tnoConflict: function noConflict() {\n\t\t\n\t\tif ( typeof window === \"undefined\" || ( typeof window !== \"undefined\" && \"function\" === \"function\" && __webpack_require__(/*! !webpack amd options */ \"./node_modules/webpack/buildin/amd-options.js\") ) ) {\n\t\t\tthrow new Error( \"noConflict can only be used in browser clients which aren't using AMD modules\" );\n\t\t}\n\t\tglobal.postal = prevPostal;\n\t\treturn this;\n\t},\n\n\tgetSubscribersFor: function getSubscribersFor( options ) {\n\t\tvar result = [];\n\t\tvar self = this;\n\t\t_.each( self.subscriptions, function( channel ) {\n\t\t\t_.each( channel, function( subList ) {\n\t\t\t\tresult = result.concat( _.filter( subList, getPredicate( options, _config.resolver ) ) );\n\t\t\t} );\n\t\t} );\n\t\treturn result;\n\t},\n\n\tpublish: function publish( envelope, cb ) {\n\t\t++pubInProgress;\n\t\tvar channel = envelope.channel = envelope.channel || _config.DEFAULT_CHANNEL;\n\t\tvar topic = envelope.topic;\n\t\tenvelope.timeStamp = new Date();\n\t\tif ( this.wireTaps.length ) {\n\t\t\t_.each( this.wireTaps, function( tap ) {\n\t\t\t\ttap( envelope.data, envelope, pubInProgress );\n\t\t\t} );\n\t\t}\n\t\tvar cacheKey = channel + _config.cacheKeyDelimiter + topic;\n\t\tvar cache = this.cache[ cacheKey ];\n\t\tvar skipped = 0;\n\t\tvar activated = 0;\n\t\tif ( !cache ) {\n\t\t\tvar cacherFn = getCacher(\n\t\t\t\ttopic,\n\t\t\t\tthis.cache,\n\t\t\t\tcacheKey,\n\t\t\t\tfunction( candidate ) {\n\t\t\t\t\tif ( candidate.invokeSubscriber( envelope.data, envelope ) ) {\n\t\t\t\t\t\tactivated++;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tskipped++;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tenvelope\n\t\t\t);\n\t\t\t_.each( this.subscriptions[ channel ], function( candidates ) {\n\t\t\t\t_.each( candidates, cacherFn );\n\t\t\t} );\n\t\t} else {\n\t\t\t_.each( cache, function( subDef ) {\n\t\t\t\tif ( subDef.invokeSubscriber( envelope.data, envelope ) ) {\n\t\t\t\t\tactivated++;\n\t\t\t\t} else {\n\t\t\t\t\tskipped++;\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t\tif ( --pubInProgress === 0 ) {\n\t\t\tclearUnSubQueue();\n\t\t}\n\t\tif ( cb ) {\n\t\t\tcb( {\n\t\t\t\tactivated: activated,\n\t\t\t\tskipped: skipped\n\t\t\t} );\n\t\t}\n\t},\n\n\treset: function reset() {\n\t\tthis.unsubscribeFor();\n\t\t_config.resolver.reset();\n\t\tthis.subscriptions = {};\n\t\tthis.cache = {};\n\t},\n\n\tsubscribe: function subscribe( options ) {\n\t\tvar subscriptions = this.subscriptions;\n\t\tvar subDef = new SubscriptionDefinition( options.channel || _config.DEFAULT_CHANNEL, options.topic, options.callback );\n\t\tvar channel = subscriptions[ subDef.channel ];\n\t\tvar channelLen = subDef.channel.length;\n\t\tvar subs;\n\t\tif ( !channel ) {\n\t\t\tchannel = subscriptions[ subDef.channel ] = {};\n\t\t}\n\t\tsubs = subscriptions[ subDef.channel ][ subDef.topic ];\n\t\tif ( !subs ) {\n\t\t\tsubs = subscriptions[ subDef.channel ][ subDef.topic ] = [];\n\t\t}\n\t\t// First, add the SubscriptionDefinition to the channel list\n\t\tsubs.push( subDef );\n\t\t// Next, add the SubscriptionDefinition to any relevant existing cache(s)\n\t\tvar cache = this.cache;\n\t\t_.each( _.keys( cache ), function( cacheKey ) {\n\t\t\tif ( cacheKey.substr( 0, channelLen ) === subDef.channel ) {\n\t\t\t\tgetCacher(\n\t\t\t\t\tcacheKey.split( _config.cacheKeyDelimiter )[1],\n\t\t\t\t\tcache,\n\t\t\t\t\tcacheKey )( subDef );\n\t\t\t}\n\t\t} );\n\t\t\n\t\tif ( _config.enableSystemMessages ) {\n\t\t\tthis.publish( sysCreatedMessage( subDef ) );\n\t\t}\n\t\treturn subDef;\n\t},\n\n\tunsubscribe: function unsubscribe() {\n\t\tvar unSubLen = arguments.length;\n\t\tvar unSubIdx = 0;\n\t\tvar subDef;\n\t\tvar channelSubs;\n\t\tvar topicSubs;\n\t\tvar idx;\n\t\tfor ( ; unSubIdx < unSubLen; unSubIdx++ ) {\n\t\t\tsubDef = arguments[ unSubIdx ];\n\t\t\tsubDef.inactive = true;\n\t\t\tif ( pubInProgress ) {\n\t\t\t\tunSubQueue.push( subDef );\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tchannelSubs = this.subscriptions[ subDef.channel ];\n\t\t\ttopicSubs = channelSubs && channelSubs[ subDef.topic ];\n\t\t\t\n\t\t\tif ( topicSubs ) {\n\t\t\t\tvar len = topicSubs.length;\n\t\t\t\tidx = 0;\n\t\t\t\t// remove SubscriptionDefinition from channel list\n\t\t\t\twhile ( idx < len ) {\n\t\t\t\t\t\n\t\t\t\t\tif ( topicSubs[ idx ] === subDef ) {\n\t\t\t\t\t\ttopicSubs.splice( idx, 1 );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tidx += 1;\n\t\t\t\t}\n\t\t\t\tif ( topicSubs.length === 0 ) {\n\t\t\t\t\tdelete channelSubs[ subDef.topic ];\n\t\t\t\t\tif ( !_.keys( channelSubs ).length ) {\n\t\t\t\t\t\tdelete this.subscriptions[ subDef.channel ];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// remove SubscriptionDefinition from postal cache\n\t\t\t\tif ( subDef.cacheKeys && subDef.cacheKeys.length ) {\n\t\t\t\t\tvar key;\n\t\t\t\t\twhile ( key = subDef.cacheKeys.pop() ) {\n\t\t\t\t\t\t_.each( this.cache[ key ], getCachePurger( subDef, key, this.cache ) );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif ( typeof _config.resolver.purge === \"function\" ) {\n\t\t\t\t\t// check to see if relevant resolver cache entries can be purged\n\t\t\t\t\tvar autoCompact = _config.autoCompactResolver === true ?\n\t\t\t\t\t\t0 : typeof _config.autoCompactResolver === \"number\" ?\n\t\t\t\t\t\t\t( _config.autoCompactResolver - 1 ) : false;\n\t\t\t\t\tif ( autoCompact >= 0 && autoCompactIndex === autoCompact ) {\n\t\t\t\t\t\t_config.resolver.purge( { compact: true } );\n\t\t\t\t\t\tautoCompactIndex = 0;\n\t\t\t\t\t} else if ( autoCompact >= 0 && autoCompactIndex < autoCompact ) {\n\t\t\t\t\t\tautoCompactIndex += 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif ( _config.enableSystemMessages ) {\n\t\t\t\tthis.publish( sysRemovedMessage( subDef ) );\n\t\t\t}\n\t\t}\n\t},\n\n\tunsubscribeFor: function unsubscribeFor( options ) {\n\t\tvar toDispose = [];\n\t\t\n\t\tif ( this.subscriptions ) {\n\t\t\ttoDispose = this.getSubscribersFor( options );\n\t\t\tthis.unsubscribe.apply( this, toDispose );\n\t\t}\n\t}\n} );\n\n\n\t\n\tif ( global && Object.prototype.hasOwnProperty.call( global, \"__postalReady__\" ) && _.isArray( global.__postalReady__ ) ) {\n\t\twhile ( global.__postalReady__.length ) {\n\t\t\tglobal.__postalReady__.shift().onReady( postal );\n\t\t}\n\t}\n\t\n\n\treturn postal;\n} ) );\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvcG9zdGFsL2xpYi9wb3N0YWwuanM/NjdiYSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFBQTs7QUFFSCxFQUFFLFFBTUY7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkI7QUFDN0I7QUFDQTs7OztBQUlBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtREFBbUQsMkNBQTJDO0FBQzlGO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLDBCQUEwQjtBQUMxQjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLEVBQUU7O0FBRUY7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBLCtCO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKLEdBQUc7QUFDSDtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7QUFLQTtBQUNBLFVBQVU7QUFDVixVQUFVO0FBQ1Y7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLG1DQUFtQyxvQkFBb0I7QUFDdkQ7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7QUFLQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBLEVBQUU7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVFQUF1RSx3QkFBd0I7QUFDL0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLFVBQVU7QUFDVixrQkFBa0I7QUFDbEI7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsRUFBRTs7QUFFRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSixHQUFHO0FBQ0g7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSixHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTLHFCQUFxQjtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0IsZ0JBQWdCO0FBQy9DO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxFQUFFOztBQUVGO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7Ozs7QUFJRDtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBLENBQUMiLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvcG9zdGFsL2xpYi9wb3N0YWwuanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIHBvc3RhbCAtIFB1Yi9TdWIgbGlicmFyeSBwcm92aWRpbmcgd2lsZGNhcmQgc3Vic2NyaXB0aW9ucywgY29tcGxleCBtZXNzYWdlIGhhbmRsaW5nLCBldGMuICBXb3JrcyBzZXJ2ZXIgYW5kIGNsaWVudC1zaWRlLlxuICogQXV0aG9yOiBKaW0gQ293YXJ0IChodHRwOi8vaWZhbmRlbHNlLmNvbSlcbiAqIFZlcnNpb246IHYyLjAuNVxuICogVXJsOiBodHRwOi8vZ2l0aHViLmNvbS9wb3N0YWxqcy9wb3N0YWwuanNcbiAqIExpY2Vuc2Uocyk6IE1JVFxuICovXG5cbiggZnVuY3Rpb24oIHJvb3QsIGZhY3RvcnkgKSB7XG5cdFxuXHRpZiAoIHR5cGVvZiBkZWZpbmUgPT09IFwiZnVuY3Rpb25cIiAmJiBkZWZpbmUuYW1kICkge1xuXHRcdC8vIEFNRC4gUmVnaXN0ZXIgYXMgYW4gYW5vbnltb3VzIG1vZHVsZS5cblx0XHRkZWZpbmUoIFsgXCJsb2Rhc2hcIiBdLCBmdW5jdGlvbiggXyApIHtcblx0XHRcdHJldHVybiBmYWN0b3J5KCBfLCByb290ICk7XG5cdFx0fSApO1xuXHRcblx0fSBlbHNlIGlmICggdHlwZW9mIG1vZHVsZSA9PT0gXCJvYmplY3RcIiAmJiBtb2R1bGUuZXhwb3J0cyApIHtcblx0XHQvLyBOb2RlLCBvciBDb21tb25KUy1MaWtlIGVudmlyb25tZW50c1xuXHRcdG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSggcmVxdWlyZSggXCJsb2Rhc2hcIiApLCB0aGlzICk7XG5cdH0gZWxzZSB7XG5cdFx0Ly8gQnJvd3NlciBnbG9iYWxzXG5cdFx0cm9vdC5wb3N0YWwgPSBmYWN0b3J5KCByb290Ll8sIHJvb3QgKTtcblx0fVxufSggdGhpcywgZnVuY3Rpb24oIF8sIGdsb2JhbCwgdW5kZWZpbmVkICkge1xuXHR2YXIgcHJldlBvc3RhbCA9IGdsb2JhbCAmJiBnbG9iYWwucG9zdGFsO1xuXHR2YXIgcHJldkxvZGFzaCA9IGdsb2JhbCAmJiBnbG9iYWwuXztcblx0aWYgKCBwcmV2TG9kYXNoICYmIHByZXZMb2Rhc2ggIT09IF8gKSB7XG5cdFx0XyA9IF8ubm9Db25mbGljdCgpO1xuXHR9XG5cdHZhciBfZGVmYXVsdENvbmZpZyA9IHtcblx0XHRERUZBVUxUX0NIQU5ORUw6IFwiL1wiLFxuXHRcdFNZU1RFTV9DSEFOTkVMOiBcInBvc3RhbFwiLFxuXHRcdGVuYWJsZVN5c3RlbU1lc3NhZ2VzOiB0cnVlLFxuXHRcdGNhY2hlS2V5RGVsaW1pdGVyOiBcInxcIixcblx0XHRhdXRvQ29tcGFjdFJlc29sdmVyOiBmYWxzZVxuXHR9O1xuXHR2YXIgcG9zdGFsID0ge1xuXHRcdGNvbmZpZ3VyYXRpb246IF8uZXh0ZW5kKCB7fSwgX2RlZmF1bHRDb25maWcgKVxuXHR9O1xuXHR2YXIgX2NvbmZpZyA9IHBvc3RhbC5jb25maWd1cmF0aW9uO1xuXG5cdFxuXG52YXIgQ2hhbm5lbERlZmluaXRpb24gPSBmdW5jdGlvbiggY2hhbm5lbE5hbWUsIGJ1cyApIHtcblx0dGhpcy5idXMgPSBidXM7XG5cdHRoaXMuY2hhbm5lbCA9IGNoYW5uZWxOYW1lIHx8IF9jb25maWcuREVGQVVMVF9DSEFOTkVMO1xufTtcblxuQ2hhbm5lbERlZmluaXRpb24ucHJvdG90eXBlLnN1YnNjcmliZSA9IGZ1bmN0aW9uKCkge1xuXHRyZXR1cm4gdGhpcy5idXMuc3Vic2NyaWJlKCB7XG5cdFx0Y2hhbm5lbDogdGhpcy5jaGFubmVsLFxuXHRcdHRvcGljOiAoIGFyZ3VtZW50cy5sZW5ndGggPT09IDEgPyBhcmd1bWVudHNbIDAgXS50b3BpYyA6IGFyZ3VtZW50c1sgMCBdICksXG5cdFx0Y2FsbGJhY2s6ICggYXJndW1lbnRzLmxlbmd0aCA9PT0gMSA/IGFyZ3VtZW50c1sgMCBdLmNhbGxiYWNrIDogYXJndW1lbnRzWyAxIF0gKVxuXHR9ICk7XG59O1xuXG4vKlxuICAgIHB1Ymxpc2goIGVudmVsb3BlIFssIGNhbGxiYWNrIF0gKTtcbiAgICBwdWJsaXNoKCB0b3BpYywgZGF0YSBbLCBjYWxsYmFjayBdICk7XG4qL1xuQ2hhbm5lbERlZmluaXRpb24ucHJvdG90eXBlLnB1Ymxpc2ggPSBmdW5jdGlvbigpIHtcblx0dmFyIGVudmVsb3BlID0ge307XG5cdHZhciBjYWxsYmFjaztcblx0aWYgKCB0eXBlb2YgYXJndW1lbnRzWyAwIF0gPT09IFwic3RyaW5nXCIgKSB7XG5cdFx0ZW52ZWxvcGUudG9waWMgPSBhcmd1bWVudHNbIDAgXTtcblx0XHRlbnZlbG9wZS5kYXRhID0gYXJndW1lbnRzWyAxIF07XG5cdFx0Y2FsbGJhY2sgPSBhcmd1bWVudHNbIDIgXTtcblx0fSBlbHNlIHtcblx0XHRlbnZlbG9wZSA9IGFyZ3VtZW50c1sgMCBdO1xuXHRcdGNhbGxiYWNrID0gYXJndW1lbnRzWyAxIF07XG5cdH1cblx0aWYgKCB0eXBlb2YgZW52ZWxvcGUgIT09IFwib2JqZWN0XCIgKSB7XG5cdFx0dGhyb3cgbmV3IEVycm9yKCBcIlRoZSBmaXJzdCBhcmd1bWVudCB0byBDaGFubmVsRGVmaW5pdGlvbi5wdWJsaXNoIHNob3VsZCBiZSBlaXRoZXIgYW4gZW52ZWxvcGUgb2JqZWN0IG9yIGEgc3RyaW5nIHRvcGljLlwiICk7XG5cdH1cblx0ZW52ZWxvcGUuaGVhZGVycyA9IF8uZXh0ZW5kKCBlbnZlbG9wZS5oZWFkZXJzIHx8IHsgcmVzb2x2ZXJOb0NhY2hlOiBfY29uZmlnLnJlc29sdmVyTm9DYWNoZSB9ICk7XG5cdGVudmVsb3BlLmNoYW5uZWwgPSB0aGlzLmNoYW5uZWw7XG5cdHRoaXMuYnVzLnB1Ymxpc2goIGVudmVsb3BlLCBjYWxsYmFjayApO1xufTtcblxuXHRcbnZhciBTdWJzY3JpcHRpb25EZWZpbml0aW9uID0gZnVuY3Rpb24oIGNoYW5uZWwsIHRvcGljLCBjYWxsYmFjayApIHtcblx0aWYgKCBhcmd1bWVudHMubGVuZ3RoICE9PSAzICkge1xuXHRcdHRocm93IG5ldyBFcnJvciggXCJZb3UgbXVzdCBwcm92aWRlIGEgY2hhbm5lbCwgdG9waWMgYW5kIGNhbGxiYWNrIHdoZW4gY3JlYXRpbmcgYSBTdWJzY3JpcHRpb25EZWZpbml0aW9uIGluc3RhbmNlLlwiICk7XG5cdH1cblx0aWYgKCB0b3BpYy5sZW5ndGggPT09IDAgKSB7XG5cdFx0dGhyb3cgbmV3IEVycm9yKCBcIlRvcGljcyBjYW5ub3QgYmUgZW1wdHlcIiApO1xuXHR9XG5cdHRoaXMuY2hhbm5lbCA9IGNoYW5uZWw7XG5cdHRoaXMudG9waWMgPSB0b3BpYztcblx0dGhpcy5jYWxsYmFjayA9IGNhbGxiYWNrO1xuXHR0aGlzLnBpcGVsaW5lID0gW107XG5cdHRoaXMuY2FjaGVLZXlzID0gW107XG5cdHRoaXMuX2NvbnRleHQgPSB1bmRlZmluZWQ7XG59O1xuXG52YXIgQ29uc2VjdXRpdmVEaXN0aW5jdFByZWRpY2F0ZSA9IGZ1bmN0aW9uKCkge1xuXHR2YXIgcHJldmlvdXM7XG5cdHJldHVybiBmdW5jdGlvbiggZGF0YSApIHtcblx0XHR2YXIgZXEgPSBmYWxzZTtcblx0XHRpZiAoIHR5cGVvZiBkYXRhID09PSBcInN0cmluZ1wiICkge1xuXHRcdFx0ZXEgPSBkYXRhID09PSBwcmV2aW91cztcblx0XHRcdHByZXZpb3VzID0gZGF0YTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0ZXEgPSBfLmlzRXF1YWwoIGRhdGEsIHByZXZpb3VzICk7XG5cdFx0XHRwcmV2aW91cyA9IF8uZXh0ZW5kKCB7fSwgZGF0YSApO1xuXHRcdH1cblx0XHRyZXR1cm4gIWVxO1xuXHR9O1xufTtcblxudmFyIERpc3RpbmN0UHJlZGljYXRlID0gZnVuY3Rpb24gRGlzdGluY3RQcmVkaWNhdGVGYWN0b3J5KCkge1xuXHR2YXIgcHJldmlvdXMgPSBbXTtcblx0cmV0dXJuIGZ1bmN0aW9uIERpc3RpbmN0UHJlZGljYXRlKCBkYXRhICkge1xuXHRcdHZhciBpc0Rpc3RpbmN0ID0gIV8uc29tZSggcHJldmlvdXMsIGZ1bmN0aW9uKCBwICkge1xuXHRcdFx0cmV0dXJuIF8uaXNFcXVhbCggZGF0YSwgcCApO1xuXHRcdH0gKTtcblx0XHRpZiAoIGlzRGlzdGluY3QgKSB7XG5cdFx0XHRwcmV2aW91cy5wdXNoKCBkYXRhICk7XG5cdFx0fVxuXHRcdHJldHVybiBpc0Rpc3RpbmN0O1xuXHR9O1xufTtcblxuU3Vic2NyaXB0aW9uRGVmaW5pdGlvbi5wcm90b3R5cGUgPSB7XG5cblx0XCJjYXRjaFwiOiBmdW5jdGlvbiggZXJyb3JIYW5kbGVyICkge1xuXHRcdHZhciBvcmlnaW5hbCA9IHRoaXMuY2FsbGJhY2s7XG5cdFx0dmFyIHNhZmVDYWxsYmFjayA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0dHJ5IHtcblx0XHRcdFx0b3JpZ2luYWwuYXBwbHkoIHRoaXMsIGFyZ3VtZW50cyApO1xuXHRcdFx0fSBjYXRjaCAoIGVyciApIHtcblx0XHRcdFx0ZXJyb3JIYW5kbGVyKCBlcnIsIGFyZ3VtZW50c1sgMCBdICk7XG5cdFx0XHR9XG5cdFx0fTtcblx0XHR0aGlzLmNhbGxiYWNrID0gc2FmZUNhbGxiYWNrO1xuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXG5cdGRlZmVyOiBmdW5jdGlvbiBkZWZlcigpIHtcblx0XHRyZXR1cm4gdGhpcy5kZWxheSggMCApO1xuXHR9LFxuXG5cdGRpc3Bvc2VBZnRlcjogZnVuY3Rpb24gZGlzcG9zZUFmdGVyKCBtYXhDYWxscyApIHtcblx0XHRpZiAoIHR5cGVvZiBtYXhDYWxscyAhPT0gXCJudW1iZXJcIiB8fCBtYXhDYWxscyA8PSAwICkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCBcIlRoZSB2YWx1ZSBwcm92aWRlZCB0byBkaXNwb3NlQWZ0ZXIgKG1heENhbGxzKSBtdXN0IGJlIGEgbnVtYmVyIGdyZWF0ZXIgdGhhbiB6ZXJvLlwiICk7XG5cdFx0fVxuXHRcdHZhciBkaXNwb3NlID0gXy5hZnRlciggbWF4Q2FsbHMsIHRoaXMudW5zdWJzY3JpYmUuYmluZCggdGhpcyApICk7XG5cdFx0dGhpcy5waXBlbGluZS5wdXNoKCBmdW5jdGlvbiggZGF0YSwgZW52LCBuZXh0ICkge1xuXHRcdFx0bmV4dCggZGF0YSwgZW52ICk7XG5cdFx0XHRkaXNwb3NlKCk7XG5cdFx0fSApO1xuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXG5cdGRpc3RpbmN0OiBmdW5jdGlvbiBkaXN0aW5jdCgpIHtcblx0XHRyZXR1cm4gdGhpcy5jb25zdHJhaW50KCBuZXcgRGlzdGluY3RQcmVkaWNhdGUoKSApO1xuXHR9LFxuXG5cdGRpc3RpbmN0VW50aWxDaGFuZ2VkOiBmdW5jdGlvbiBkaXN0aW5jdFVudGlsQ2hhbmdlZCgpIHtcblx0XHRyZXR1cm4gdGhpcy5jb25zdHJhaW50KCBuZXcgQ29uc2VjdXRpdmVEaXN0aW5jdFByZWRpY2F0ZSgpICk7XG5cdH0sXG5cblx0aW52b2tlU3Vic2NyaWJlcjogZnVuY3Rpb24gaW52b2tlU3Vic2NyaWJlciggZGF0YSwgZW52ICkge1xuXHRcdGlmICggIXRoaXMuaW5hY3RpdmUgKSB7XG5cdFx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cdFx0XHR2YXIgcGlwZWxpbmUgPSBzZWxmLnBpcGVsaW5lO1xuXHRcdFx0dmFyIGxlbiA9IHBpcGVsaW5lLmxlbmd0aDtcblx0XHRcdHZhciBjb250ZXh0ID0gc2VsZi5fY29udGV4dDtcblx0XHRcdHZhciBpZHggPSAtMTtcblx0XHRcdHZhciBpbnZva2VkID0gZmFsc2U7XG5cdFx0XHRpZiAoICFsZW4gKSB7XG5cdFx0XHRcdHNlbGYuY2FsbGJhY2suY2FsbCggY29udGV4dCwgZGF0YSwgZW52ICk7XG5cdFx0XHRcdGludm9rZWQgPSB0cnVlO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cGlwZWxpbmUgPSBwaXBlbGluZS5jb25jYXQoIFsgc2VsZi5jYWxsYmFjayBdICk7XG5cdFx0XHRcdHZhciBzdGVwID0gZnVuY3Rpb24gc3RlcCggZCwgZSApIHtcblx0XHRcdFx0XHRpZHggKz0gMTtcblx0XHRcdFx0XHRpZiAoIGlkeCA8IGxlbiApIHtcblx0XHRcdFx0XHRcdHBpcGVsaW5lWyBpZHggXS5jYWxsKCBjb250ZXh0LCBkLCBlLCBzdGVwICk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdHNlbGYuY2FsbGJhY2suY2FsbCggY29udGV4dCwgZCwgZSApO1xuXHRcdFx0XHRcdFx0aW52b2tlZCA9IHRydWU7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9O1xuXHRcdFx0XHRzdGVwKCBkYXRhLCBlbnYsIDAgKTtcblx0XHRcdH1cblx0XHRcdHJldHVybiBpbnZva2VkO1xuXHRcdH1cblx0fSxcblxuXHRsb2dFcnJvcjogZnVuY3Rpb24gbG9nRXJyb3IoKSB7XG5cdFx0XG5cdFx0aWYgKCBjb25zb2xlICkge1xuXHRcdFx0dmFyIHJlcG9ydDtcblx0XHRcdGlmICggY29uc29sZS53YXJuICkge1xuXHRcdFx0XHRyZXBvcnQgPSBjb25zb2xlLndhcm47XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZXBvcnQgPSBjb25zb2xlLmxvZztcblx0XHRcdH1cblx0XHRcdHRoaXMuY2F0Y2goIHJlcG9ydCApO1xuXHRcdH1cblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblxuXHRvbmNlOiBmdW5jdGlvbiBvbmNlKCkge1xuXHRcdHJldHVybiB0aGlzLmRpc3Bvc2VBZnRlciggMSApO1xuXHR9LFxuXG5cdHN1YnNjcmliZTogZnVuY3Rpb24gc3Vic2NyaWJlKCBjYWxsYmFjayApIHtcblx0XHR0aGlzLmNhbGxiYWNrID0gY2FsbGJhY2s7XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0dW5zdWJzY3JpYmU6IGZ1bmN0aW9uIHVuc3Vic2NyaWJlKCkge1xuXHRcdFxuXHRcdGlmICggIXRoaXMuaW5hY3RpdmUgKSB7XG5cdFx0XHRwb3N0YWwudW5zdWJzY3JpYmUoIHRoaXMgKTtcblx0XHR9XG5cdH0sXG5cblx0Y29uc3RyYWludDogZnVuY3Rpb24gY29uc3RyYWludCggcHJlZGljYXRlICkge1xuXHRcdGlmICggdHlwZW9mIHByZWRpY2F0ZSAhPT0gXCJmdW5jdGlvblwiICkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCBcIlByZWRpY2F0ZSBjb25zdHJhaW50IG11c3QgYmUgYSBmdW5jdGlvblwiICk7XG5cdFx0fVxuXHRcdHRoaXMucGlwZWxpbmUucHVzaCggZnVuY3Rpb24oIGRhdGEsIGVudiwgbmV4dCApIHtcblx0XHRcdGlmICggcHJlZGljYXRlLmNhbGwoIHRoaXMsIGRhdGEsIGVudiApICkge1xuXHRcdFx0XHRuZXh0KCBkYXRhLCBlbnYgKTtcblx0XHRcdH1cblx0XHR9ICk7XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0Y29uc3RyYWludHM6IGZ1bmN0aW9uIGNvbnN0cmFpbnRzKCBwcmVkaWNhdGVzICkge1xuXHRcdHZhciBzZWxmID0gdGhpcztcblx0XHRcblx0XHRfLmVhY2goIHByZWRpY2F0ZXMsIGZ1bmN0aW9uKCBwcmVkaWNhdGUgKSB7XG5cdFx0XHRzZWxmLmNvbnN0cmFpbnQoIHByZWRpY2F0ZSApO1xuXHRcdH0gKTtcblx0XHRyZXR1cm4gc2VsZjtcblx0fSxcblxuXHRjb250ZXh0OiBmdW5jdGlvbiBjb250ZXh0U2V0dGVyKCBjb250ZXh0ICkge1xuXHRcdHRoaXMuX2NvbnRleHQgPSBjb250ZXh0O1xuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXG5cdGRlYm91bmNlOiBmdW5jdGlvbiBkZWJvdW5jZSggbWlsbGlzZWNvbmRzLCBpbW1lZGlhdGUgKSB7XG5cdFx0aWYgKCB0eXBlb2YgbWlsbGlzZWNvbmRzICE9PSBcIm51bWJlclwiICkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCBcIk1pbGxpc2Vjb25kcyBtdXN0IGJlIGEgbnVtYmVyXCIgKTtcblx0XHR9XG5cblx0XHR2YXIgb3B0aW9ucyA9IHt9O1xuXG5cdFx0aWYgKCAhIWltbWVkaWF0ZSA9PT0gdHJ1ZSApIHsgXG5cdFx0XHRvcHRpb25zLmxlYWRpbmcgPSB0cnVlO1xuXHRcdFx0b3B0aW9ucy50cmFpbGluZyA9IGZhbHNlO1xuXHRcdH1cblxuXHRcdHRoaXMucGlwZWxpbmUucHVzaChcblx0XHRcdF8uZGVib3VuY2UoIGZ1bmN0aW9uKCBkYXRhLCBlbnYsIG5leHQgKSB7XG5cdFx0XHRcdG5leHQoIGRhdGEsIGVudiApO1xuXHRcdFx0fSxcblx0XHRcdFx0bWlsbGlzZWNvbmRzLFxuXHRcdFx0XHRvcHRpb25zXG5cdFx0XHQpXG5cdFx0KTtcblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblxuXHRkZWxheTogZnVuY3Rpb24gZGVsYXkoIG1pbGxpc2Vjb25kcyApIHtcblx0XHRpZiAoIHR5cGVvZiBtaWxsaXNlY29uZHMgIT09IFwibnVtYmVyXCIgKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoIFwiTWlsbGlzZWNvbmRzIG11c3QgYmUgYSBudW1iZXJcIiApO1xuXHRcdH1cblx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cdFx0c2VsZi5waXBlbGluZS5wdXNoKCBmdW5jdGlvbiggZGF0YSwgZW52LCBuZXh0ICkge1xuXHRcdFx0c2V0VGltZW91dCggZnVuY3Rpb24oKSB7XG5cdFx0XHRcdG5leHQoIGRhdGEsIGVudiApO1xuXHRcdFx0fSwgbWlsbGlzZWNvbmRzICk7XG5cdFx0fSApO1xuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXG5cdHRocm90dGxlOiBmdW5jdGlvbiB0aHJvdHRsZSggbWlsbGlzZWNvbmRzICkge1xuXHRcdGlmICggdHlwZW9mIG1pbGxpc2Vjb25kcyAhPT0gXCJudW1iZXJcIiApIHtcblx0XHRcdHRocm93IG5ldyBFcnJvciggXCJNaWxsaXNlY29uZHMgbXVzdCBiZSBhIG51bWJlclwiICk7XG5cdFx0fVxuXHRcdHZhciBmbiA9IGZ1bmN0aW9uKCBkYXRhLCBlbnYsIG5leHQgKSB7XG5cdFx0XHRuZXh0KCBkYXRhLCBlbnYgKTtcblx0XHR9O1xuXHRcdHRoaXMucGlwZWxpbmUucHVzaCggXy50aHJvdHRsZSggZm4sIG1pbGxpc2Vjb25kcyApICk7XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH1cbn07XG5cblx0XG5cblxudmFyIGJpbmRpbmdzUmVzb2x2ZXIgPSBfY29uZmlnLnJlc29sdmVyID0ge1xuXHRjYWNoZToge30sXG5cdHJlZ2V4OiB7fSxcblx0ZW5hYmxlQ2FjaGU6IHRydWUsXG5cblx0Y29tcGFyZTogZnVuY3Rpb24gY29tcGFyZSggYmluZGluZywgdG9waWMsIGhlYWRlck9wdGlvbnMgKSB7XG5cdFx0dmFyIHBhdHRlcm47XG5cdFx0dmFyIHJneDtcblx0XHR2YXIgcHJldlNlZ21lbnQ7XG5cdFx0dmFyIGNhY2hlS2V5ID0gdG9waWMgKyBfY29uZmlnLmNhY2hlS2V5RGVsaW1pdGVyICsgYmluZGluZztcblx0XHR2YXIgcmVzdWx0ID0gKCB0aGlzLmNhY2hlWyBjYWNoZUtleSBdICk7XG5cdFx0dmFyIG9wdCA9IGhlYWRlck9wdGlvbnMgfHwge307XG5cdFx0dmFyIHNhdmVUb0NhY2hlID0gdGhpcy5lbmFibGVDYWNoZSAmJiAhb3B0LnJlc29sdmVyTm9DYWNoZTtcblx0XHQvLyByZXN1bHQgaXMgY2FjaGVkP1xuXHRcdGlmICggcmVzdWx0ID09PSB0cnVlICkge1xuXHRcdFx0cmV0dXJuIHJlc3VsdDtcblx0XHR9XG5cdFx0Ly8gcGxhaW4gc3RyaW5nIG1hdGNoaW5nP1xuXHRcdGlmICggYmluZGluZy5pbmRleE9mKCBcIiNcIiApID09PSAtMSAmJiBiaW5kaW5nLmluZGV4T2YoIFwiKlwiICkgPT09IC0xICkge1xuXHRcdFx0cmVzdWx0ID0gKCB0b3BpYyA9PT0gYmluZGluZyApO1xuXHRcdFx0aWYgKCBzYXZlVG9DYWNoZSApIHtcblx0XHRcdFx0dGhpcy5jYWNoZVsgY2FjaGVLZXkgXSA9IHJlc3VsdDtcblx0XHRcdH1cblx0XHRcdHJldHVybiByZXN1bHQ7XG5cdFx0fVxuXHRcdC8vIGFoLCByZWdleCBtYXRjaGluZywgdGhlblxuXHRcdGlmICggISggcmd4ID0gdGhpcy5yZWdleFsgYmluZGluZyBdICkgKSB7XG5cdFx0XHRwYXR0ZXJuID0gXCJeXCIgKyBfLm1hcCggYmluZGluZy5zcGxpdCggXCIuXCIgKSwgZnVuY3Rpb24gbWFwVG9waWNCaW5kaW5nKCBzZWdtZW50ICkge1xuXHRcdFx0XHRcdHZhciByZXMgPSBcIlwiO1xuXHRcdFx0XHRcdGlmICggISFwcmV2U2VnbWVudCApIHtcblx0XHRcdFx0XHRcdHJlcyA9IHByZXZTZWdtZW50ICE9PSBcIiNcIiA/IFwiXFxcXC5cXFxcYlwiIDogXCJcXFxcYlwiO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRpZiAoIHNlZ21lbnQgPT09IFwiI1wiICkge1xuXHRcdFx0XHRcdFx0cmVzICs9IFwiW1xcXFxzXFxcXFNdKlwiO1xuXHRcdFx0XHRcdH0gZWxzZSBpZiAoIHNlZ21lbnQgPT09IFwiKlwiICkge1xuXHRcdFx0XHRcdFx0cmVzICs9IFwiW14uXStcIjtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0cmVzICs9IHNlZ21lbnQ7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHByZXZTZWdtZW50ID0gc2VnbWVudDtcblx0XHRcdFx0XHRyZXR1cm4gcmVzO1xuXHRcdFx0XHR9ICkuam9pbiggXCJcIiApICsgXCIkXCI7XG5cdFx0XHRyZ3ggPSB0aGlzLnJlZ2V4WyBiaW5kaW5nIF0gPSBuZXcgUmVnRXhwKCBwYXR0ZXJuICk7XG5cdFx0fVxuXHRcdHJlc3VsdCA9IHJneC50ZXN0KCB0b3BpYyApO1xuXHRcdGlmICggc2F2ZVRvQ2FjaGUgKSB7XG5cdFx0XHR0aGlzLmNhY2hlWyBjYWNoZUtleSBdID0gcmVzdWx0O1xuXHRcdH1cblx0XHRyZXR1cm4gcmVzdWx0O1xuXHR9LFxuXG5cdHJlc2V0OiBmdW5jdGlvbiByZXNldCgpIHtcblx0XHR0aGlzLmNhY2hlID0ge307XG5cdFx0dGhpcy5yZWdleCA9IHt9O1xuXHR9LFxuXG5cdHB1cmdlOiBmdW5jdGlvbiggb3B0aW9ucyApIHtcblx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cdFx0dmFyIGtleURlbGltaXRlciA9IF9jb25maWcuY2FjaGVLZXlEZWxpbWl0ZXI7XG5cdFx0dmFyIG1hdGNoUHJlZGljYXRlID0gZnVuY3Rpb24oIHZhbCwga2V5ICkge1xuXHRcdFx0dmFyIHNwbGl0ID0ga2V5LnNwbGl0KCBrZXlEZWxpbWl0ZXIgKTtcblx0XHRcdHZhciB0b3BpYyA9IHNwbGl0WyAwIF07XG5cdFx0XHR2YXIgYmluZGluZyA9IHNwbGl0WyAxIF07XG5cdFx0XHRpZiAoICggdHlwZW9mIG9wdGlvbnMudG9waWMgPT09IFwidW5kZWZpbmVkXCIgfHwgb3B0aW9ucy50b3BpYyA9PT0gdG9waWMgKSAmJlxuXHRcdFx0XHRcdCggdHlwZW9mIG9wdGlvbnMuYmluZGluZyA9PT0gXCJ1bmRlZmluZWRcIiB8fCBvcHRpb25zLmJpbmRpbmcgPT09IGJpbmRpbmcgKSApIHtcblx0XHRcdFx0ZGVsZXRlIHNlbGYuY2FjaGVbIGtleSBdO1xuXHRcdFx0fVxuXHRcdH07XG5cblx0XHR2YXIgY29tcGFjdFByZWRpY2F0ZSA9IGZ1bmN0aW9uKCB2YWwsIGtleSApIHtcblx0XHRcdHZhciBzcGxpdCA9IGtleS5zcGxpdCgga2V5RGVsaW1pdGVyICk7XG5cdFx0XHRpZiAoIHBvc3RhbC5nZXRTdWJzY3JpYmVyc0ZvciggeyB0b3BpYzogc3BsaXRbIDAgXSB9ICkubGVuZ3RoID09PSAwICkge1xuXHRcdFx0XHRkZWxldGUgc2VsZi5jYWNoZVsga2V5IF07XG5cdFx0XHR9XG5cdFx0fTtcblxuXHRcdGlmICggdHlwZW9mIG9wdGlvbnMgPT09IFwidW5kZWZpbmVkXCIgKSB7XG5cdFx0XHR0aGlzLnJlc2V0KCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHZhciBoYW5kbGVyID0gb3B0aW9ucy5jb21wYWN0ID09PSB0cnVlID8gY29tcGFjdFByZWRpY2F0ZSA6IG1hdGNoUHJlZGljYXRlO1xuXHRcdFx0Xy5lYWNoKCB0aGlzLmNhY2hlLCBoYW5kbGVyICk7XG5cdFx0fVxuXHR9XG59O1xuXG5cdFxuXG5cbnZhciBwdWJJblByb2dyZXNzID0gMDtcbnZhciB1blN1YlF1ZXVlID0gW107XG52YXIgYXV0b0NvbXBhY3RJbmRleCA9IDA7XG5cbmZ1bmN0aW9uIGNsZWFyVW5TdWJRdWV1ZSgpIHtcblx0d2hpbGUgKCB1blN1YlF1ZXVlLmxlbmd0aCApIHtcblx0XHRwb3N0YWwudW5zdWJzY3JpYmUoIHVuU3ViUXVldWUuc2hpZnQoKSApO1xuXHR9XG59XG5cbmZ1bmN0aW9uIGdldENhY2hlUHVyZ2VyKCBzdWJEZWYsIGtleSwgY2FjaGUgKSB7XG5cdHJldHVybiBmdW5jdGlvbiggc3ViLCBpLCBsaXN0ICkge1xuXHRcdGlmICggc3ViID09PSBzdWJEZWYgKSB7XG5cdFx0XHRsaXN0LnNwbGljZSggaSwgMSApO1xuXHRcdH1cblx0XHRpZiAoIGxpc3QubGVuZ3RoID09PSAwICkge1xuXHRcdFx0ZGVsZXRlIGNhY2hlWyBrZXkgXTtcblx0XHR9XG5cdH07XG59XG5cbmZ1bmN0aW9uIGdldENhY2hlciggdG9waWMsIHB1YkNhY2hlLCBjYWNoZUtleSwgZG9uZSwgZW52ZWxvcGUgKSB7XG5cdHZhciBoZWFkZXJzID0gZW52ZWxvcGUgJiYgZW52ZWxvcGUuaGVhZGVycyB8fCB7fTtcblx0cmV0dXJuIGZ1bmN0aW9uKCBzdWJEZWYgKSB7XG5cdFx0dmFyIGNhY2hlO1xuXHRcdGlmICggX2NvbmZpZy5yZXNvbHZlci5jb21wYXJlKCBzdWJEZWYudG9waWMsIHRvcGljLCBoZWFkZXJzICkgKSB7XG5cdFx0XHRpZiAoICFoZWFkZXJzLnJlc29sdmVyTm9DYWNoZSApIHtcblx0XHRcdFx0Y2FjaGUgPSBwdWJDYWNoZVsgY2FjaGVLZXkgXSA9ICggcHViQ2FjaGVbIGNhY2hlS2V5IF0gfHwgW10gKTtcblx0XHRcdFx0Y2FjaGUucHVzaCggc3ViRGVmICk7XG5cdFx0XHRcdHN1YkRlZi5jYWNoZUtleXMucHVzaCggY2FjaGVLZXkgKTtcblx0XHRcdH1cblx0XHRcdGlmICggZG9uZSApIHtcblx0XHRcdFx0ZG9uZSggc3ViRGVmICk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9O1xufVxuXG5mdW5jdGlvbiBnZXRTeXN0ZW1NZXNzYWdlKCBraW5kLCBzdWJEZWYgKSB7XG5cdHJldHVybiB7XG5cdFx0Y2hhbm5lbDogX2NvbmZpZy5TWVNURU1fQ0hBTk5FTCxcblx0XHR0b3BpYzogXCJzdWJzY3JpcHRpb24uXCIgKyBraW5kLFxuXHRcdGRhdGE6IHtcblx0XHRcdGV2ZW50OiBcInN1YnNjcmlwdGlvbi5cIiArIGtpbmQsXG5cdFx0XHRjaGFubmVsOiBzdWJEZWYuY2hhbm5lbCxcblx0XHRcdHRvcGljOiBzdWJEZWYudG9waWNcblx0XHR9XG5cdH07XG59XG5cbnZhciBzeXNDcmVhdGVkTWVzc2FnZSA9IGdldFN5c3RlbU1lc3NhZ2UuYmluZCggdW5kZWZpbmVkLCBcImNyZWF0ZWRcIiApO1xudmFyIHN5c1JlbW92ZWRNZXNzYWdlID0gZ2V0U3lzdGVtTWVzc2FnZS5iaW5kKCB1bmRlZmluZWQsIFwicmVtb3ZlZFwiICk7XG5cbmZ1bmN0aW9uIGdldFByZWRpY2F0ZSggb3B0aW9ucywgcmVzb2x2ZXIgKSB7XG5cdGlmICggdHlwZW9mIG9wdGlvbnMgPT09IFwiZnVuY3Rpb25cIiApIHtcblx0XHRyZXR1cm4gb3B0aW9ucztcblx0fSBlbHNlIGlmICggIW9wdGlvbnMgKSB7XG5cdFx0cmV0dXJuIGZ1bmN0aW9uKCkge1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fTtcblx0fSBlbHNlIHtcblx0XHRyZXR1cm4gZnVuY3Rpb24oIHN1YiApIHtcblx0XHRcdHZhciBjb21wYXJlZCA9IDA7XG5cdFx0XHR2YXIgbWF0Y2hlZCA9IDA7XG5cdFx0XHRfLmVhY2goIG9wdGlvbnMsIGZ1bmN0aW9uKCB2YWwsIHByb3AgKSB7XG5cdFx0XHRcdGNvbXBhcmVkICs9IDE7XG5cdFx0XHRcdGlmIChcblx0XHRcdFx0Ly8gV2UgdXNlIHRoZSBiaW5kaW5ncyByZXNvbHZlciB0byBjb21wYXJlIHRoZSBvcHRpb25zLnRvcGljIHRvIHN1YkRlZi50b3BpY1xuXHRcdFx0XHQoIHByb3AgPT09IFwidG9waWNcIiAmJiByZXNvbHZlci5jb21wYXJlKCBzdWIudG9waWMsIG9wdGlvbnMudG9waWMsIHsgcmVzb2x2ZXJOb0NhY2hlOiB0cnVlIH0gKSApIHx8XG5cdFx0XHRcdFx0XHQoIHByb3AgPT09IFwiY29udGV4dFwiICYmIG9wdGlvbnMuY29udGV4dCA9PT0gc3ViLl9jb250ZXh0ICkgfHxcblx0XHRcdFx0XHRcdC8vIEFueSBvdGhlciBwb3RlbnRpYWwgcHJvcC92YWx1ZSBtYXRjaGluZyBvdXRzaWRlIHRvcGljICYgY29udGV4dC4uLlxuXHRcdFx0XHRcdFx0KCBzdWJbIHByb3AgXSA9PT0gb3B0aW9uc1sgcHJvcCBdICkgKSB7XG5cdFx0XHRcdFx0bWF0Y2hlZCArPSAxO1xuXHRcdFx0XHR9XG5cdFx0XHR9ICk7XG5cdFx0XHRyZXR1cm4gY29tcGFyZWQgPT09IG1hdGNoZWQ7XG5cdFx0fTtcblx0fVxufVxuXG5fLmV4dGVuZCggcG9zdGFsLCB7XG5cdGNhY2hlOiB7fSxcblx0c3Vic2NyaXB0aW9uczoge30sXG5cdHdpcmVUYXBzOiBbXSxcblxuXHRDaGFubmVsRGVmaW5pdGlvbjogQ2hhbm5lbERlZmluaXRpb24sXG5cdFN1YnNjcmlwdGlvbkRlZmluaXRpb246IFN1YnNjcmlwdGlvbkRlZmluaXRpb24sXG5cblx0Y2hhbm5lbDogZnVuY3Rpb24gY2hhbm5lbCggY2hhbm5lbE5hbWUgKSB7XG5cdFx0cmV0dXJuIG5ldyBDaGFubmVsRGVmaW5pdGlvbiggY2hhbm5lbE5hbWUsIHRoaXMgKTtcblx0fSxcblxuXHRhZGRXaXJlVGFwOiBmdW5jdGlvbiBhZGRXaXJlVGFwKCBjYWxsYmFjayApIHtcblx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cdFx0c2VsZi53aXJlVGFwcy5wdXNoKCBjYWxsYmFjayApO1xuXHRcdHJldHVybiBmdW5jdGlvbigpIHtcblx0XHRcdHZhciBpZHggPSBzZWxmLndpcmVUYXBzLmluZGV4T2YoIGNhbGxiYWNrICk7XG5cdFx0XHRpZiAoIGlkeCAhPT0gLTEgKSB7XG5cdFx0XHRcdHNlbGYud2lyZVRhcHMuc3BsaWNlKCBpZHgsIDEgKTtcblx0XHRcdH1cblx0XHR9O1xuXHR9LFxuXG5cdG5vQ29uZmxpY3Q6IGZ1bmN0aW9uIG5vQ29uZmxpY3QoKSB7XG5cdFx0XG5cdFx0aWYgKCB0eXBlb2Ygd2luZG93ID09PSBcInVuZGVmaW5lZFwiIHx8ICggdHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiAmJiB0eXBlb2YgZGVmaW5lID09PSBcImZ1bmN0aW9uXCIgJiYgZGVmaW5lLmFtZCApICkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKCBcIm5vQ29uZmxpY3QgY2FuIG9ubHkgYmUgdXNlZCBpbiBicm93c2VyIGNsaWVudHMgd2hpY2ggYXJlbid0IHVzaW5nIEFNRCBtb2R1bGVzXCIgKTtcblx0XHR9XG5cdFx0Z2xvYmFsLnBvc3RhbCA9IHByZXZQb3N0YWw7XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0Z2V0U3Vic2NyaWJlcnNGb3I6IGZ1bmN0aW9uIGdldFN1YnNjcmliZXJzRm9yKCBvcHRpb25zICkge1xuXHRcdHZhciByZXN1bHQgPSBbXTtcblx0XHR2YXIgc2VsZiA9IHRoaXM7XG5cdFx0Xy5lYWNoKCBzZWxmLnN1YnNjcmlwdGlvbnMsIGZ1bmN0aW9uKCBjaGFubmVsICkge1xuXHRcdFx0Xy5lYWNoKCBjaGFubmVsLCBmdW5jdGlvbiggc3ViTGlzdCApIHtcblx0XHRcdFx0cmVzdWx0ID0gcmVzdWx0LmNvbmNhdCggXy5maWx0ZXIoIHN1Ykxpc3QsIGdldFByZWRpY2F0ZSggb3B0aW9ucywgX2NvbmZpZy5yZXNvbHZlciApICkgKTtcblx0XHRcdH0gKTtcblx0XHR9ICk7XG5cdFx0cmV0dXJuIHJlc3VsdDtcblx0fSxcblxuXHRwdWJsaXNoOiBmdW5jdGlvbiBwdWJsaXNoKCBlbnZlbG9wZSwgY2IgKSB7XG5cdFx0KytwdWJJblByb2dyZXNzO1xuXHRcdHZhciBjaGFubmVsID0gZW52ZWxvcGUuY2hhbm5lbCA9IGVudmVsb3BlLmNoYW5uZWwgfHwgX2NvbmZpZy5ERUZBVUxUX0NIQU5ORUw7XG5cdFx0dmFyIHRvcGljID0gZW52ZWxvcGUudG9waWM7XG5cdFx0ZW52ZWxvcGUudGltZVN0YW1wID0gbmV3IERhdGUoKTtcblx0XHRpZiAoIHRoaXMud2lyZVRhcHMubGVuZ3RoICkge1xuXHRcdFx0Xy5lYWNoKCB0aGlzLndpcmVUYXBzLCBmdW5jdGlvbiggdGFwICkge1xuXHRcdFx0XHR0YXAoIGVudmVsb3BlLmRhdGEsIGVudmVsb3BlLCBwdWJJblByb2dyZXNzICk7XG5cdFx0XHR9ICk7XG5cdFx0fVxuXHRcdHZhciBjYWNoZUtleSA9IGNoYW5uZWwgKyBfY29uZmlnLmNhY2hlS2V5RGVsaW1pdGVyICsgdG9waWM7XG5cdFx0dmFyIGNhY2hlID0gdGhpcy5jYWNoZVsgY2FjaGVLZXkgXTtcblx0XHR2YXIgc2tpcHBlZCA9IDA7XG5cdFx0dmFyIGFjdGl2YXRlZCA9IDA7XG5cdFx0aWYgKCAhY2FjaGUgKSB7XG5cdFx0XHR2YXIgY2FjaGVyRm4gPSBnZXRDYWNoZXIoXG5cdFx0XHRcdHRvcGljLFxuXHRcdFx0XHR0aGlzLmNhY2hlLFxuXHRcdFx0XHRjYWNoZUtleSxcblx0XHRcdFx0ZnVuY3Rpb24oIGNhbmRpZGF0ZSApIHtcblx0XHRcdFx0XHRpZiAoIGNhbmRpZGF0ZS5pbnZva2VTdWJzY3JpYmVyKCBlbnZlbG9wZS5kYXRhLCBlbnZlbG9wZSApICkge1xuXHRcdFx0XHRcdFx0YWN0aXZhdGVkKys7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdHNraXBwZWQrKztcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0sXG5cdFx0XHRcdGVudmVsb3BlXG5cdFx0XHQpO1xuXHRcdFx0Xy5lYWNoKCB0aGlzLnN1YnNjcmlwdGlvbnNbIGNoYW5uZWwgXSwgZnVuY3Rpb24oIGNhbmRpZGF0ZXMgKSB7XG5cdFx0XHRcdF8uZWFjaCggY2FuZGlkYXRlcywgY2FjaGVyRm4gKTtcblx0XHRcdH0gKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Xy5lYWNoKCBjYWNoZSwgZnVuY3Rpb24oIHN1YkRlZiApIHtcblx0XHRcdFx0aWYgKCBzdWJEZWYuaW52b2tlU3Vic2NyaWJlciggZW52ZWxvcGUuZGF0YSwgZW52ZWxvcGUgKSApIHtcblx0XHRcdFx0XHRhY3RpdmF0ZWQrKztcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRza2lwcGVkKys7XG5cdFx0XHRcdH1cblx0XHRcdH0gKTtcblx0XHR9XG5cdFx0aWYgKCAtLXB1YkluUHJvZ3Jlc3MgPT09IDAgKSB7XG5cdFx0XHRjbGVhclVuU3ViUXVldWUoKTtcblx0XHR9XG5cdFx0aWYgKCBjYiApIHtcblx0XHRcdGNiKCB7XG5cdFx0XHRcdGFjdGl2YXRlZDogYWN0aXZhdGVkLFxuXHRcdFx0XHRza2lwcGVkOiBza2lwcGVkXG5cdFx0XHR9ICk7XG5cdFx0fVxuXHR9LFxuXG5cdHJlc2V0OiBmdW5jdGlvbiByZXNldCgpIHtcblx0XHR0aGlzLnVuc3Vic2NyaWJlRm9yKCk7XG5cdFx0X2NvbmZpZy5yZXNvbHZlci5yZXNldCgpO1xuXHRcdHRoaXMuc3Vic2NyaXB0aW9ucyA9IHt9O1xuXHRcdHRoaXMuY2FjaGUgPSB7fTtcblx0fSxcblxuXHRzdWJzY3JpYmU6IGZ1bmN0aW9uIHN1YnNjcmliZSggb3B0aW9ucyApIHtcblx0XHR2YXIgc3Vic2NyaXB0aW9ucyA9IHRoaXMuc3Vic2NyaXB0aW9ucztcblx0XHR2YXIgc3ViRGVmID0gbmV3IFN1YnNjcmlwdGlvbkRlZmluaXRpb24oIG9wdGlvbnMuY2hhbm5lbCB8fCBfY29uZmlnLkRFRkFVTFRfQ0hBTk5FTCwgb3B0aW9ucy50b3BpYywgb3B0aW9ucy5jYWxsYmFjayApO1xuXHRcdHZhciBjaGFubmVsID0gc3Vic2NyaXB0aW9uc1sgc3ViRGVmLmNoYW5uZWwgXTtcblx0XHR2YXIgY2hhbm5lbExlbiA9IHN1YkRlZi5jaGFubmVsLmxlbmd0aDtcblx0XHR2YXIgc3Vicztcblx0XHRpZiAoICFjaGFubmVsICkge1xuXHRcdFx0Y2hhbm5lbCA9IHN1YnNjcmlwdGlvbnNbIHN1YkRlZi5jaGFubmVsIF0gPSB7fTtcblx0XHR9XG5cdFx0c3VicyA9IHN1YnNjcmlwdGlvbnNbIHN1YkRlZi5jaGFubmVsIF1bIHN1YkRlZi50b3BpYyBdO1xuXHRcdGlmICggIXN1YnMgKSB7XG5cdFx0XHRzdWJzID0gc3Vic2NyaXB0aW9uc1sgc3ViRGVmLmNoYW5uZWwgXVsgc3ViRGVmLnRvcGljIF0gPSBbXTtcblx0XHR9XG5cdFx0Ly8gRmlyc3QsIGFkZCB0aGUgU3Vic2NyaXB0aW9uRGVmaW5pdGlvbiB0byB0aGUgY2hhbm5lbCBsaXN0XG5cdFx0c3Vicy5wdXNoKCBzdWJEZWYgKTtcblx0XHQvLyBOZXh0LCBhZGQgdGhlIFN1YnNjcmlwdGlvbkRlZmluaXRpb24gdG8gYW55IHJlbGV2YW50IGV4aXN0aW5nIGNhY2hlKHMpXG5cdFx0dmFyIGNhY2hlID0gdGhpcy5jYWNoZTtcblx0XHRfLmVhY2goIF8ua2V5cyggY2FjaGUgKSwgZnVuY3Rpb24oIGNhY2hlS2V5ICkge1xuXHRcdFx0aWYgKCBjYWNoZUtleS5zdWJzdHIoIDAsIGNoYW5uZWxMZW4gKSA9PT0gc3ViRGVmLmNoYW5uZWwgKSB7XG5cdFx0XHRcdGdldENhY2hlcihcblx0XHRcdFx0XHRjYWNoZUtleS5zcGxpdCggX2NvbmZpZy5jYWNoZUtleURlbGltaXRlciApWzFdLFxuXHRcdFx0XHRcdGNhY2hlLFxuXHRcdFx0XHRcdGNhY2hlS2V5ICkoIHN1YkRlZiApO1xuXHRcdFx0fVxuXHRcdH0gKTtcblx0XHRcblx0XHRpZiAoIF9jb25maWcuZW5hYmxlU3lzdGVtTWVzc2FnZXMgKSB7XG5cdFx0XHR0aGlzLnB1Ymxpc2goIHN5c0NyZWF0ZWRNZXNzYWdlKCBzdWJEZWYgKSApO1xuXHRcdH1cblx0XHRyZXR1cm4gc3ViRGVmO1xuXHR9LFxuXG5cdHVuc3Vic2NyaWJlOiBmdW5jdGlvbiB1bnN1YnNjcmliZSgpIHtcblx0XHR2YXIgdW5TdWJMZW4gPSBhcmd1bWVudHMubGVuZ3RoO1xuXHRcdHZhciB1blN1YklkeCA9IDA7XG5cdFx0dmFyIHN1YkRlZjtcblx0XHR2YXIgY2hhbm5lbFN1YnM7XG5cdFx0dmFyIHRvcGljU3Vicztcblx0XHR2YXIgaWR4O1xuXHRcdGZvciAoIDsgdW5TdWJJZHggPCB1blN1YkxlbjsgdW5TdWJJZHgrKyApIHtcblx0XHRcdHN1YkRlZiA9IGFyZ3VtZW50c1sgdW5TdWJJZHggXTtcblx0XHRcdHN1YkRlZi5pbmFjdGl2ZSA9IHRydWU7XG5cdFx0XHRpZiAoIHB1YkluUHJvZ3Jlc3MgKSB7XG5cdFx0XHRcdHVuU3ViUXVldWUucHVzaCggc3ViRGVmICk7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblx0XHRcdGNoYW5uZWxTdWJzID0gdGhpcy5zdWJzY3JpcHRpb25zWyBzdWJEZWYuY2hhbm5lbCBdO1xuXHRcdFx0dG9waWNTdWJzID0gY2hhbm5lbFN1YnMgJiYgY2hhbm5lbFN1YnNbIHN1YkRlZi50b3BpYyBdO1xuXHRcdFx0XG5cdFx0XHRpZiAoIHRvcGljU3VicyApIHtcblx0XHRcdFx0dmFyIGxlbiA9IHRvcGljU3Vicy5sZW5ndGg7XG5cdFx0XHRcdGlkeCA9IDA7XG5cdFx0XHRcdC8vIHJlbW92ZSBTdWJzY3JpcHRpb25EZWZpbml0aW9uIGZyb20gY2hhbm5lbCBsaXN0XG5cdFx0XHRcdHdoaWxlICggaWR4IDwgbGVuICkge1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGlmICggdG9waWNTdWJzWyBpZHggXSA9PT0gc3ViRGVmICkge1xuXHRcdFx0XHRcdFx0dG9waWNTdWJzLnNwbGljZSggaWR4LCAxICk7XG5cdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0aWR4ICs9IDE7XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKCB0b3BpY1N1YnMubGVuZ3RoID09PSAwICkge1xuXHRcdFx0XHRcdGRlbGV0ZSBjaGFubmVsU3Vic1sgc3ViRGVmLnRvcGljIF07XG5cdFx0XHRcdFx0aWYgKCAhXy5rZXlzKCBjaGFubmVsU3VicyApLmxlbmd0aCApIHtcblx0XHRcdFx0XHRcdGRlbGV0ZSB0aGlzLnN1YnNjcmlwdGlvbnNbIHN1YkRlZi5jaGFubmVsIF07XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdC8vIHJlbW92ZSBTdWJzY3JpcHRpb25EZWZpbml0aW9uIGZyb20gcG9zdGFsIGNhY2hlXG5cdFx0XHRcdGlmICggc3ViRGVmLmNhY2hlS2V5cyAmJiBzdWJEZWYuY2FjaGVLZXlzLmxlbmd0aCApIHtcblx0XHRcdFx0XHR2YXIga2V5O1xuXHRcdFx0XHRcdHdoaWxlICgga2V5ID0gc3ViRGVmLmNhY2hlS2V5cy5wb3AoKSApIHtcblx0XHRcdFx0XHRcdF8uZWFjaCggdGhpcy5jYWNoZVsga2V5IF0sIGdldENhY2hlUHVyZ2VyKCBzdWJEZWYsIGtleSwgdGhpcy5jYWNoZSApICk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdGlmICggdHlwZW9mIF9jb25maWcucmVzb2x2ZXIucHVyZ2UgPT09IFwiZnVuY3Rpb25cIiApIHtcblx0XHRcdFx0XHQvLyBjaGVjayB0byBzZWUgaWYgcmVsZXZhbnQgcmVzb2x2ZXIgY2FjaGUgZW50cmllcyBjYW4gYmUgcHVyZ2VkXG5cdFx0XHRcdFx0dmFyIGF1dG9Db21wYWN0ID0gX2NvbmZpZy5hdXRvQ29tcGFjdFJlc29sdmVyID09PSB0cnVlID9cblx0XHRcdFx0XHRcdDAgOiB0eXBlb2YgX2NvbmZpZy5hdXRvQ29tcGFjdFJlc29sdmVyID09PSBcIm51bWJlclwiID9cblx0XHRcdFx0XHRcdFx0KCBfY29uZmlnLmF1dG9Db21wYWN0UmVzb2x2ZXIgLSAxICkgOiBmYWxzZTtcblx0XHRcdFx0XHRpZiAoIGF1dG9Db21wYWN0ID49IDAgJiYgYXV0b0NvbXBhY3RJbmRleCA9PT0gYXV0b0NvbXBhY3QgKSB7XG5cdFx0XHRcdFx0XHRfY29uZmlnLnJlc29sdmVyLnB1cmdlKCB7IGNvbXBhY3Q6IHRydWUgfSApO1xuXHRcdFx0XHRcdFx0YXV0b0NvbXBhY3RJbmRleCA9IDA7XG5cdFx0XHRcdFx0fSBlbHNlIGlmICggYXV0b0NvbXBhY3QgPj0gMCAmJiBhdXRvQ29tcGFjdEluZGV4IDwgYXV0b0NvbXBhY3QgKSB7XG5cdFx0XHRcdFx0XHRhdXRvQ29tcGFjdEluZGV4ICs9IDE7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRpZiAoIF9jb25maWcuZW5hYmxlU3lzdGVtTWVzc2FnZXMgKSB7XG5cdFx0XHRcdHRoaXMucHVibGlzaCggc3lzUmVtb3ZlZE1lc3NhZ2UoIHN1YkRlZiApICk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9LFxuXG5cdHVuc3Vic2NyaWJlRm9yOiBmdW5jdGlvbiB1bnN1YnNjcmliZUZvciggb3B0aW9ucyApIHtcblx0XHR2YXIgdG9EaXNwb3NlID0gW107XG5cdFx0XG5cdFx0aWYgKCB0aGlzLnN1YnNjcmlwdGlvbnMgKSB7XG5cdFx0XHR0b0Rpc3Bvc2UgPSB0aGlzLmdldFN1YnNjcmliZXJzRm9yKCBvcHRpb25zICk7XG5cdFx0XHR0aGlzLnVuc3Vic2NyaWJlLmFwcGx5KCB0aGlzLCB0b0Rpc3Bvc2UgKTtcblx0XHR9XG5cdH1cbn0gKTtcblxuXG5cdFxuXHRpZiAoIGdsb2JhbCAmJiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoIGdsb2JhbCwgXCJfX3Bvc3RhbFJlYWR5X19cIiApICYmIF8uaXNBcnJheSggZ2xvYmFsLl9fcG9zdGFsUmVhZHlfXyApICkge1xuXHRcdHdoaWxlICggZ2xvYmFsLl9fcG9zdGFsUmVhZHlfXy5sZW5ndGggKSB7XG5cdFx0XHRnbG9iYWwuX19wb3N0YWxSZWFkeV9fLnNoaWZ0KCkub25SZWFkeSggcG9zdGFsICk7XG5cdFx0fVxuXHR9XG5cdFxuXG5cdHJldHVybiBwb3N0YWw7XG59ICkgKTtcbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/postal/lib/postal.js\n");

/***/ }),

/***/ "./node_modules/process/browser.js":
/*!*****************************************!*\
  !*** ./node_modules/process/browser.js ***!
  \*****************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvcHJvY2Vzcy9icm93c2VyLmpzP2YyOGMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixzQkFBc0I7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLHFDQUFxQzs7QUFFckM7QUFDQTtBQUNBOztBQUVBLDJCQUEyQjtBQUMzQjtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsVUFBVSIsImZpbGUiOiIuL25vZGVfbW9kdWxlcy9wcm9jZXNzL2Jyb3dzZXIuanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBzaGltIGZvciB1c2luZyBwcm9jZXNzIGluIGJyb3dzZXJcbnZhciBwcm9jZXNzID0gbW9kdWxlLmV4cG9ydHMgPSB7fTtcblxuLy8gY2FjaGVkIGZyb20gd2hhdGV2ZXIgZ2xvYmFsIGlzIHByZXNlbnQgc28gdGhhdCB0ZXN0IHJ1bm5lcnMgdGhhdCBzdHViIGl0XG4vLyBkb24ndCBicmVhayB0aGluZ3MuICBCdXQgd2UgbmVlZCB0byB3cmFwIGl0IGluIGEgdHJ5IGNhdGNoIGluIGNhc2UgaXQgaXNcbi8vIHdyYXBwZWQgaW4gc3RyaWN0IG1vZGUgY29kZSB3aGljaCBkb2Vzbid0IGRlZmluZSBhbnkgZ2xvYmFscy4gIEl0J3MgaW5zaWRlIGFcbi8vIGZ1bmN0aW9uIGJlY2F1c2UgdHJ5L2NhdGNoZXMgZGVvcHRpbWl6ZSBpbiBjZXJ0YWluIGVuZ2luZXMuXG5cbnZhciBjYWNoZWRTZXRUaW1lb3V0O1xudmFyIGNhY2hlZENsZWFyVGltZW91dDtcblxuZnVuY3Rpb24gZGVmYXVsdFNldFRpbW91dCgpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3NldFRpbWVvdXQgaGFzIG5vdCBiZWVuIGRlZmluZWQnKTtcbn1cbmZ1bmN0aW9uIGRlZmF1bHRDbGVhclRpbWVvdXQgKCkge1xuICAgIHRocm93IG5ldyBFcnJvcignY2xlYXJUaW1lb3V0IGhhcyBub3QgYmVlbiBkZWZpbmVkJyk7XG59XG4oZnVuY3Rpb24gKCkge1xuICAgIHRyeSB7XG4gICAgICAgIGlmICh0eXBlb2Ygc2V0VGltZW91dCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgY2FjaGVkU2V0VGltZW91dCA9IHNldFRpbWVvdXQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjYWNoZWRTZXRUaW1lb3V0ID0gZGVmYXVsdFNldFRpbW91dDtcbiAgICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgY2FjaGVkU2V0VGltZW91dCA9IGRlZmF1bHRTZXRUaW1vdXQ7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICAgIGlmICh0eXBlb2YgY2xlYXJUaW1lb3V0ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICBjYWNoZWRDbGVhclRpbWVvdXQgPSBjbGVhclRpbWVvdXQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjYWNoZWRDbGVhclRpbWVvdXQgPSBkZWZhdWx0Q2xlYXJUaW1lb3V0O1xuICAgICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBjYWNoZWRDbGVhclRpbWVvdXQgPSBkZWZhdWx0Q2xlYXJUaW1lb3V0O1xuICAgIH1cbn0gKCkpXG5mdW5jdGlvbiBydW5UaW1lb3V0KGZ1bikge1xuICAgIGlmIChjYWNoZWRTZXRUaW1lb3V0ID09PSBzZXRUaW1lb3V0KSB7XG4gICAgICAgIC8vbm9ybWFsIGVudmlyb21lbnRzIGluIHNhbmUgc2l0dWF0aW9uc1xuICAgICAgICByZXR1cm4gc2V0VGltZW91dChmdW4sIDApO1xuICAgIH1cbiAgICAvLyBpZiBzZXRUaW1lb3V0IHdhc24ndCBhdmFpbGFibGUgYnV0IHdhcyBsYXR0ZXIgZGVmaW5lZFxuICAgIGlmICgoY2FjaGVkU2V0VGltZW91dCA9PT0gZGVmYXVsdFNldFRpbW91dCB8fCAhY2FjaGVkU2V0VGltZW91dCkgJiYgc2V0VGltZW91dCkge1xuICAgICAgICBjYWNoZWRTZXRUaW1lb3V0ID0gc2V0VGltZW91dDtcbiAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQoZnVuLCAwKTtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgICAgLy8gd2hlbiB3aGVuIHNvbWVib2R5IGhhcyBzY3Jld2VkIHdpdGggc2V0VGltZW91dCBidXQgbm8gSS5FLiBtYWRkbmVzc1xuICAgICAgICByZXR1cm4gY2FjaGVkU2V0VGltZW91dChmdW4sIDApO1xuICAgIH0gY2F0Y2goZSl7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBXaGVuIHdlIGFyZSBpbiBJLkUuIGJ1dCB0aGUgc2NyaXB0IGhhcyBiZWVuIGV2YWxlZCBzbyBJLkUuIGRvZXNuJ3QgdHJ1c3QgdGhlIGdsb2JhbCBvYmplY3Qgd2hlbiBjYWxsZWQgbm9ybWFsbHlcbiAgICAgICAgICAgIHJldHVybiBjYWNoZWRTZXRUaW1lb3V0LmNhbGwobnVsbCwgZnVuLCAwKTtcbiAgICAgICAgfSBjYXRjaChlKXtcbiAgICAgICAgICAgIC8vIHNhbWUgYXMgYWJvdmUgYnV0IHdoZW4gaXQncyBhIHZlcnNpb24gb2YgSS5FLiB0aGF0IG11c3QgaGF2ZSB0aGUgZ2xvYmFsIG9iamVjdCBmb3IgJ3RoaXMnLCBob3BmdWxseSBvdXIgY29udGV4dCBjb3JyZWN0IG90aGVyd2lzZSBpdCB3aWxsIHRocm93IGEgZ2xvYmFsIGVycm9yXG4gICAgICAgICAgICByZXR1cm4gY2FjaGVkU2V0VGltZW91dC5jYWxsKHRoaXMsIGZ1biwgMCk7XG4gICAgICAgIH1cbiAgICB9XG5cblxufVxuZnVuY3Rpb24gcnVuQ2xlYXJUaW1lb3V0KG1hcmtlcikge1xuICAgIGlmIChjYWNoZWRDbGVhclRpbWVvdXQgPT09IGNsZWFyVGltZW91dCkge1xuICAgICAgICAvL25vcm1hbCBlbnZpcm9tZW50cyBpbiBzYW5lIHNpdHVhdGlvbnNcbiAgICAgICAgcmV0dXJuIGNsZWFyVGltZW91dChtYXJrZXIpO1xuICAgIH1cbiAgICAvLyBpZiBjbGVhclRpbWVvdXQgd2Fzbid0IGF2YWlsYWJsZSBidXQgd2FzIGxhdHRlciBkZWZpbmVkXG4gICAgaWYgKChjYWNoZWRDbGVhclRpbWVvdXQgPT09IGRlZmF1bHRDbGVhclRpbWVvdXQgfHwgIWNhY2hlZENsZWFyVGltZW91dCkgJiYgY2xlYXJUaW1lb3V0KSB7XG4gICAgICAgIGNhY2hlZENsZWFyVGltZW91dCA9IGNsZWFyVGltZW91dDtcbiAgICAgICAgcmV0dXJuIGNsZWFyVGltZW91dChtYXJrZXIpO1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgICAvLyB3aGVuIHdoZW4gc29tZWJvZHkgaGFzIHNjcmV3ZWQgd2l0aCBzZXRUaW1lb3V0IGJ1dCBubyBJLkUuIG1hZGRuZXNzXG4gICAgICAgIHJldHVybiBjYWNoZWRDbGVhclRpbWVvdXQobWFya2VyKTtcbiAgICB9IGNhdGNoIChlKXtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFdoZW4gd2UgYXJlIGluIEkuRS4gYnV0IHRoZSBzY3JpcHQgaGFzIGJlZW4gZXZhbGVkIHNvIEkuRS4gZG9lc24ndCAgdHJ1c3QgdGhlIGdsb2JhbCBvYmplY3Qgd2hlbiBjYWxsZWQgbm9ybWFsbHlcbiAgICAgICAgICAgIHJldHVybiBjYWNoZWRDbGVhclRpbWVvdXQuY2FsbChudWxsLCBtYXJrZXIpO1xuICAgICAgICB9IGNhdGNoIChlKXtcbiAgICAgICAgICAgIC8vIHNhbWUgYXMgYWJvdmUgYnV0IHdoZW4gaXQncyBhIHZlcnNpb24gb2YgSS5FLiB0aGF0IG11c3QgaGF2ZSB0aGUgZ2xvYmFsIG9iamVjdCBmb3IgJ3RoaXMnLCBob3BmdWxseSBvdXIgY29udGV4dCBjb3JyZWN0IG90aGVyd2lzZSBpdCB3aWxsIHRocm93IGEgZ2xvYmFsIGVycm9yLlxuICAgICAgICAgICAgLy8gU29tZSB2ZXJzaW9ucyBvZiBJLkUuIGhhdmUgZGlmZmVyZW50IHJ1bGVzIGZvciBjbGVhclRpbWVvdXQgdnMgc2V0VGltZW91dFxuICAgICAgICAgICAgcmV0dXJuIGNhY2hlZENsZWFyVGltZW91dC5jYWxsKHRoaXMsIG1hcmtlcik7XG4gICAgICAgIH1cbiAgICB9XG5cblxuXG59XG52YXIgcXVldWUgPSBbXTtcbnZhciBkcmFpbmluZyA9IGZhbHNlO1xudmFyIGN1cnJlbnRRdWV1ZTtcbnZhciBxdWV1ZUluZGV4ID0gLTE7XG5cbmZ1bmN0aW9uIGNsZWFuVXBOZXh0VGljaygpIHtcbiAgICBpZiAoIWRyYWluaW5nIHx8ICFjdXJyZW50UXVldWUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBkcmFpbmluZyA9IGZhbHNlO1xuICAgIGlmIChjdXJyZW50UXVldWUubGVuZ3RoKSB7XG4gICAgICAgIHF1ZXVlID0gY3VycmVudFF1ZXVlLmNvbmNhdChxdWV1ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcXVldWVJbmRleCA9IC0xO1xuICAgIH1cbiAgICBpZiAocXVldWUubGVuZ3RoKSB7XG4gICAgICAgIGRyYWluUXVldWUoKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGRyYWluUXVldWUoKSB7XG4gICAgaWYgKGRyYWluaW5nKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIHRpbWVvdXQgPSBydW5UaW1lb3V0KGNsZWFuVXBOZXh0VGljayk7XG4gICAgZHJhaW5pbmcgPSB0cnVlO1xuXG4gICAgdmFyIGxlbiA9IHF1ZXVlLmxlbmd0aDtcbiAgICB3aGlsZShsZW4pIHtcbiAgICAgICAgY3VycmVudFF1ZXVlID0gcXVldWU7XG4gICAgICAgIHF1ZXVlID0gW107XG4gICAgICAgIHdoaWxlICgrK3F1ZXVlSW5kZXggPCBsZW4pIHtcbiAgICAgICAgICAgIGlmIChjdXJyZW50UXVldWUpIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50UXVldWVbcXVldWVJbmRleF0ucnVuKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcXVldWVJbmRleCA9IC0xO1xuICAgICAgICBsZW4gPSBxdWV1ZS5sZW5ndGg7XG4gICAgfVxuICAgIGN1cnJlbnRRdWV1ZSA9IG51bGw7XG4gICAgZHJhaW5pbmcgPSBmYWxzZTtcbiAgICBydW5DbGVhclRpbWVvdXQodGltZW91dCk7XG59XG5cbnByb2Nlc3MubmV4dFRpY2sgPSBmdW5jdGlvbiAoZnVuKSB7XG4gICAgdmFyIGFyZ3MgPSBuZXcgQXJyYXkoYXJndW1lbnRzLmxlbmd0aCAtIDEpO1xuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID4gMSkge1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgYXJnc1tpIC0gMV0gPSBhcmd1bWVudHNbaV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcXVldWUucHVzaChuZXcgSXRlbShmdW4sIGFyZ3MpKTtcbiAgICBpZiAocXVldWUubGVuZ3RoID09PSAxICYmICFkcmFpbmluZykge1xuICAgICAgICBydW5UaW1lb3V0KGRyYWluUXVldWUpO1xuICAgIH1cbn07XG5cbi8vIHY4IGxpa2VzIHByZWRpY3RpYmxlIG9iamVjdHNcbmZ1bmN0aW9uIEl0ZW0oZnVuLCBhcnJheSkge1xuICAgIHRoaXMuZnVuID0gZnVuO1xuICAgIHRoaXMuYXJyYXkgPSBhcnJheTtcbn1cbkl0ZW0ucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmZ1bi5hcHBseShudWxsLCB0aGlzLmFycmF5KTtcbn07XG5wcm9jZXNzLnRpdGxlID0gJ2Jyb3dzZXInO1xucHJvY2Vzcy5icm93c2VyID0gdHJ1ZTtcbnByb2Nlc3MuZW52ID0ge307XG5wcm9jZXNzLmFyZ3YgPSBbXTtcbnByb2Nlc3MudmVyc2lvbiA9ICcnOyAvLyBlbXB0eSBzdHJpbmcgdG8gYXZvaWQgcmVnZXhwIGlzc3Vlc1xucHJvY2Vzcy52ZXJzaW9ucyA9IHt9O1xuXG5mdW5jdGlvbiBub29wKCkge31cblxucHJvY2Vzcy5vbiA9IG5vb3A7XG5wcm9jZXNzLmFkZExpc3RlbmVyID0gbm9vcDtcbnByb2Nlc3Mub25jZSA9IG5vb3A7XG5wcm9jZXNzLm9mZiA9IG5vb3A7XG5wcm9jZXNzLnJlbW92ZUxpc3RlbmVyID0gbm9vcDtcbnByb2Nlc3MucmVtb3ZlQWxsTGlzdGVuZXJzID0gbm9vcDtcbnByb2Nlc3MuZW1pdCA9IG5vb3A7XG5wcm9jZXNzLnByZXBlbmRMaXN0ZW5lciA9IG5vb3A7XG5wcm9jZXNzLnByZXBlbmRPbmNlTGlzdGVuZXIgPSBub29wO1xuXG5wcm9jZXNzLmxpc3RlbmVycyA9IGZ1bmN0aW9uIChuYW1lKSB7IHJldHVybiBbXSB9XG5cbnByb2Nlc3MuYmluZGluZyA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdwcm9jZXNzLmJpbmRpbmcgaXMgbm90IHN1cHBvcnRlZCcpO1xufTtcblxucHJvY2Vzcy5jd2QgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAnLycgfTtcbnByb2Nlc3MuY2hkaXIgPSBmdW5jdGlvbiAoZGlyKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdwcm9jZXNzLmNoZGlyIGlzIG5vdCBzdXBwb3J0ZWQnKTtcbn07XG5wcm9jZXNzLnVtYXNrID0gZnVuY3Rpb24oKSB7IHJldHVybiAwOyB9O1xuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/process/browser.js\n");

/***/ }),

/***/ "./node_modules/rot-js/lib/rot.js":
/*!****************************************!*\
  !*** ./node_modules/rot-js/lib/rot.js ***!
  \****************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("/* WEBPACK VAR INJECTION */(function(global, process) {var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/*\n\tThis is rot.js, the ROguelike Toolkit in JavaScript.\n\tVersion 0.7~dev, generated on Tue Dec 12 13:34:23 CET 2017.\n*/\n/**\n * Add objects for Node.js environment\n */\nglobal.requestAnimationFrame = function(cb) {\n\treturn setTimeout(function() { cb(Date.now()); }, 1000/60);\n};\n\nglobal.document = {\n\tbody: {\n\t\tappendChild: function(child) {},\n\t\tscrollLeft: 0,\n\t\tscrollTop: 0\n\t},\n\tcreateElement: function(type) {\n\t\tvar canvas;\n\t\treturn canvas = {\n\t\t\tgetBoundingClientRect: function() {\n\t\t\t\tvar rect;\n\t\t\t\treturn rect = {\n\t\t\t\t\tleft: 0,\n\t\t\t\t\ttop: 0\n\t\t\t\t};\n\t\t\t},\n\t\t\tgetContext: function(type) {\n\t\t\t\tvar context;\n\t\t\t\treturn context = {\n\t\t\t\t\t_termcolor: null,\n\t\t\t\t\tbeginPath: function() {},\n\t\t\t\t\tcanvas: canvas,\n\t\t\t\t\tclearRect: function(x, y, w, h) {\n\t\t\t\t\t\tif(this._termcolor !== null) {\n\t\t\t\t\t\t\tvar clearCmd = this._termcolor.clearToAnsi(this.fillStyle);\n\t\t\t\t\t\t\tprocess.stdout.write(clearCmd);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tdrawImage: function(a, b, c, d, e, f, g, h, i) {},\n\t\t\t\t\tfill: function() {},\n\t\t\t\t\tfillRect: function(x, y, w, h) {\n\t\t\t\t\t\tif(this._termcolor !== null) {\n\t\t\t\t\t\t\tvar clearCmd = this._termcolor.clearToAnsi(this.fillStyle);\n\t\t\t\t\t\t\tprocess.stdout.write(clearCmd);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tfillStyle: \"#000\",\n\t\t\t\t\tfillText: function(chs, x, y) {},\n\t\t\t\t\tfont: \"monospace\",\n\t\t\t\t\tlineTo: function(x, y) {},\n\t\t\t\t\tmeasureText: function(ch) {\n\t\t\t\t\t\tvar result;\n\t\t\t\t\t\treturn result = {\n\t\t\t\t\t\t\twidth: 12\n\t\t\t\t\t\t};\n\t\t\t\t\t},\n\t\t\t\t\tmoveTo: function(x, y) {},\n\t\t\t\t\ttextAlign: \"center\",\n\t\t\t\t\ttextBaseline: \"middle\"\n\t\t\t\t};\n\t\t\t},\n\t\t\theight: 0,\n\t\t\tstyle: {\n\t\t\t\tleft: \"100px\",\n\t\t\t\tposition: \"absolute\",\n\t\t\t\ttop: \"100px\",\n\t\t\t\tvisibility: \"hidden\"\n\t\t\t},\n\t\t\twidth: 0\n\t\t};\n\t},\n\tdocumentElement: {\n\t\tscrollLeft: 0,\n\t\tscrollTop: 0\n\t}\n};\n(function (root, factory) {\n    if (true) {\n        // AMD. Register as an anonymous module.\n        !(__WEBPACK_AMD_DEFINE_ARRAY__ = [], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n    } else {}\n}(this, function() {\n/**\n * @namespace Top-level ROT namespace\n */\nvar ROT = {\n\t/**\n\t * @returns {bool} Is rot.js supported by this browser?\n\t */\n\tisSupported: function() {\n\t\treturn !!(document.createElement(\"canvas\").getContext && Function.prototype.bind);\n\t},\n\n\t/** Default with for display and map generators */\n\tDEFAULT_WIDTH: 80,\n\t/** Default height for display and map generators */\n\tDEFAULT_HEIGHT: 25,\n\n\t/** Directional constants. Ordering is important! */\n\tDIRS: {\n\t\t\"4\": [\n\t\t\t[ 0, -1],\n\t\t\t[ 1,  0],\n\t\t\t[ 0,  1],\n\t\t\t[-1,  0]\n\t\t],\n\t\t\"8\": [\n\t\t\t[ 0, -1],\n\t\t\t[ 1, -1],\n\t\t\t[ 1,  0],\n\t\t\t[ 1,  1],\n\t\t\t[ 0,  1],\n\t\t\t[-1,  1],\n\t\t\t[-1,  0],\n\t\t\t[-1, -1]\n\t\t],\n\t\t\"6\": [\n\t\t\t[-1, -1],\n\t\t\t[ 1, -1],\n\t\t\t[ 2,  0],\n\t\t\t[ 1,  1],\n\t\t\t[-1,  1],\n\t\t\t[-2,  0]\n\t\t]\n\t},\n\n\t/** Cancel key. */\n\tVK_CANCEL: 3, \n\t/** Help key. */\n\tVK_HELP: 6, \n\t/** Backspace key. */\n\tVK_BACK_SPACE: 8, \n\t/** Tab key. */\n\tVK_TAB: 9, \n\t/** 5 key on Numpad when NumLock is unlocked. Or on Mac, clear key which is positioned at NumLock key. */\n\tVK_CLEAR: 12, \n\t/** Return/enter key on the main keyboard. */\n\tVK_RETURN: 13, \n\t/** Reserved, but not used. */\n\tVK_ENTER: 14, \n\t/** Shift key. */\n\tVK_SHIFT: 16, \n\t/** Control key. */\n\tVK_CONTROL: 17, \n\t/** Alt (Option on Mac) key. */\n\tVK_ALT: 18, \n\t/** Pause key. */\n\tVK_PAUSE: 19, \n\t/** Caps lock. */\n\tVK_CAPS_LOCK: 20, \n\t/** Escape key. */\n\tVK_ESCAPE: 27, \n\t/** Space bar. */\n\tVK_SPACE: 32, \n\t/** Page Up key. */\n\tVK_PAGE_UP: 33, \n\t/** Page Down key. */\n\tVK_PAGE_DOWN: 34, \n\t/** End key. */\n\tVK_END: 35, \n\t/** Home key. */\n\tVK_HOME: 36, \n\t/** Left arrow. */\n\tVK_LEFT: 37, \n\t/** Up arrow. */\n\tVK_UP: 38, \n\t/** Right arrow. */\n\tVK_RIGHT: 39, \n\t/** Down arrow. */\n\tVK_DOWN: 40, \n\t/** Print Screen key. */\n\tVK_PRINTSCREEN: 44, \n\t/** Ins(ert) key. */\n\tVK_INSERT: 45, \n\t/** Del(ete) key. */\n\tVK_DELETE: 46, \n\t/***/\n\tVK_0: 48,\n\t/***/\n\tVK_1: 49,\n\t/***/\n\tVK_2: 50,\n\t/***/\n\tVK_3: 51,\n\t/***/\n\tVK_4: 52,\n\t/***/\n\tVK_5: 53,\n\t/***/\n\tVK_6: 54,\n\t/***/\n\tVK_7: 55,\n\t/***/\n\tVK_8: 56,\n\t/***/\n\tVK_9: 57,\n\t/** Colon (:) key. Requires Gecko 15.0 */\n\tVK_COLON: 58, \n\t/** Semicolon (;) key. */\n\tVK_SEMICOLON: 59, \n\t/** Less-than (<) key. Requires Gecko 15.0 */\n\tVK_LESS_THAN: 60, \n\t/** Equals (=) key. */\n\tVK_EQUALS: 61, \n\t/** Greater-than (>) key. Requires Gecko 15.0 */\n\tVK_GREATER_THAN: 62, \n\t/** Question mark (?) key. Requires Gecko 15.0 */\n\tVK_QUESTION_MARK: 63, \n\t/** Atmark (@) key. Requires Gecko 15.0 */\n\tVK_AT: 64, \n\t/***/\n\tVK_A: 65,\n\t/***/\n\tVK_B: 66,\n\t/***/\n\tVK_C: 67,\n\t/***/\n\tVK_D: 68,\n\t/***/\n\tVK_E: 69,\n\t/***/\n\tVK_F: 70,\n\t/***/\n\tVK_G: 71,\n\t/***/\n\tVK_H: 72,\n\t/***/\n\tVK_I: 73,\n\t/***/\n\tVK_J: 74,\n\t/***/\n\tVK_K: 75,\n\t/***/\n\tVK_L: 76,\n\t/***/\n\tVK_M: 77,\n\t/***/\n\tVK_N: 78,\n\t/***/\n\tVK_O: 79,\n\t/***/\n\tVK_P: 80,\n\t/***/\n\tVK_Q: 81,\n\t/***/\n\tVK_R: 82,\n\t/***/\n\tVK_S: 83,\n\t/***/\n\tVK_T: 84,\n\t/***/\n\tVK_U: 85,\n\t/***/\n\tVK_V: 86,\n\t/***/\n\tVK_W: 87,\n\t/***/\n\tVK_X: 88,\n\t/***/\n\tVK_Y: 89,\n\t/***/\n\tVK_Z: 90,\n\t/***/\n\tVK_CONTEXT_MENU: 93,\n\t/** 0 on the numeric keypad. */\n\tVK_NUMPAD0: 96, \n\t/** 1 on the numeric keypad. */\n\tVK_NUMPAD1: 97, \n\t/** 2 on the numeric keypad. */\n\tVK_NUMPAD2: 98, \n\t/** 3 on the numeric keypad. */\n\tVK_NUMPAD3: 99, \n\t/** 4 on the numeric keypad. */\n\tVK_NUMPAD4: 100, \n\t/** 5 on the numeric keypad. */\n\tVK_NUMPAD5: 101, \n\t/** 6 on the numeric keypad. */\n\tVK_NUMPAD6: 102, \n\t/** 7 on the numeric keypad. */\n\tVK_NUMPAD7: 103, \n\t/** 8 on the numeric keypad. */\n\tVK_NUMPAD8: 104, \n\t/** 9 on the numeric keypad. */\n\tVK_NUMPAD9: 105, \n\t/** * on the numeric keypad. */\n\tVK_MULTIPLY: 106,\n\t/** + on the numeric keypad. */\n\tVK_ADD: 107, \n\t/***/\n\tVK_SEPARATOR: 108,\n\t/** - on the numeric keypad. */\n\tVK_SUBTRACT: 109, \n\t/** Decimal point on the numeric keypad. */\n\tVK_DECIMAL: 110, \n\t/** / on the numeric keypad. */\n\tVK_DIVIDE: 111, \n\t/** F1 key. */\n\tVK_F1: 112, \n\t/** F2 key. */\n\tVK_F2: 113, \n\t/** F3 key. */\n\tVK_F3: 114, \n\t/** F4 key. */\n\tVK_F4: 115, \n\t/** F5 key. */\n\tVK_F5: 116, \n\t/** F6 key. */\n\tVK_F6: 117, \n\t/** F7 key. */\n\tVK_F7: 118, \n\t/** F8 key. */\n\tVK_F8: 119, \n\t/** F9 key. */\n\tVK_F9: 120, \n\t/** F10 key. */\n\tVK_F10: 121, \n\t/** F11 key. */\n\tVK_F11: 122, \n\t/** F12 key. */\n\tVK_F12: 123, \n\t/** F13 key. */\n\tVK_F13: 124, \n\t/** F14 key. */\n\tVK_F14: 125, \n\t/** F15 key. */\n\tVK_F15: 126, \n\t/** F16 key. */\n\tVK_F16: 127, \n\t/** F17 key. */\n\tVK_F17: 128, \n\t/** F18 key. */\n\tVK_F18: 129, \n\t/** F19 key. */\n\tVK_F19: 130, \n\t/** F20 key. */\n\tVK_F20: 131, \n\t/** F21 key. */\n\tVK_F21: 132, \n\t/** F22 key. */\n\tVK_F22: 133, \n\t/** F23 key. */\n\tVK_F23: 134, \n\t/** F24 key. */\n\tVK_F24: 135, \n\t/** Num Lock key. */\n\tVK_NUM_LOCK: 144, \n\t/** Scroll Lock key. */\n\tVK_SCROLL_LOCK: 145, \n\t/** Circumflex (^) key. Requires Gecko 15.0 */\n\tVK_CIRCUMFLEX: 160, \n\t/** Exclamation (!) key. Requires Gecko 15.0 */\n\tVK_EXCLAMATION: 161, \n\t/** Double quote () key. Requires Gecko 15.0 */\n\tVK_DOUBLE_QUOTE: 162, \n\t/** Hash (#) key. Requires Gecko 15.0 */\n\tVK_HASH: 163, \n\t/** Dollar sign ($) key. Requires Gecko 15.0 */\n\tVK_DOLLAR: 164, \n\t/** Percent (%) key. Requires Gecko 15.0 */\n\tVK_PERCENT: 165, \n\t/** Ampersand (&) key. Requires Gecko 15.0 */\n\tVK_AMPERSAND: 166, \n\t/** Underscore (_) key. Requires Gecko 15.0 */\n\tVK_UNDERSCORE: 167, \n\t/** Open parenthesis (() key. Requires Gecko 15.0 */\n\tVK_OPEN_PAREN: 168, \n\t/** Close parenthesis ()) key. Requires Gecko 15.0 */\n\tVK_CLOSE_PAREN: 169, \n\t/* Asterisk (*) key. Requires Gecko 15.0 */\n\tVK_ASTERISK: 170,\n\t/** Plus (+) key. Requires Gecko 15.0 */\n\tVK_PLUS: 171, \n\t/** Pipe (|) key. Requires Gecko 15.0 */\n\tVK_PIPE: 172, \n\t/** Hyphen-US/docs/Minus (-) key. Requires Gecko 15.0 */\n\tVK_HYPHEN_MINUS: 173, \n\t/** Open curly bracket ({) key. Requires Gecko 15.0 */\n\tVK_OPEN_CURLY_BRACKET: 174, \n\t/** Close curly bracket (}) key. Requires Gecko 15.0 */\n\tVK_CLOSE_CURLY_BRACKET: 175, \n\t/** Tilde (~) key. Requires Gecko 15.0 */\n\tVK_TILDE: 176, \n\t/** Comma (,) key. */\n\tVK_COMMA: 188, \n\t/** Period (.) key. */\n\tVK_PERIOD: 190, \n\t/** Slash (/) key. */\n\tVK_SLASH: 191, \n\t/** Back tick (`) key. */\n\tVK_BACK_QUOTE: 192, \n\t/** Open square bracket ([) key. */\n\tVK_OPEN_BRACKET: 219, \n\t/** Back slash (\\) key. */\n\tVK_BACK_SLASH: 220, \n\t/** Close square bracket (]) key. */\n\tVK_CLOSE_BRACKET: 221, \n\t/** Quote (''') key. */\n\tVK_QUOTE: 222, \n\t/** Meta key on Linux, Command key on Mac. */\n\tVK_META: 224, \n\t/** AltGr key on Linux. Requires Gecko 15.0 */\n\tVK_ALTGR: 225, \n\t/** Windows logo key on Windows. Or Super or Hyper key on Linux. Requires Gecko 15.0 */\n\tVK_WIN: 91, \n\t/** Linux support for this keycode was added in Gecko 4.0. */\n\tVK_KANA: 21, \n\t/** Linux support for this keycode was added in Gecko 4.0. */\n\tVK_HANGUL: 21, \n\t/** 英数 key on Japanese Mac keyboard. Requires Gecko 15.0 */\n\tVK_EISU: 22, \n\t/** Linux support for this keycode was added in Gecko 4.0. */\n\tVK_JUNJA: 23, \n\t/** Linux support for this keycode was added in Gecko 4.0. */\n\tVK_FINAL: 24, \n\t/** Linux support for this keycode was added in Gecko 4.0. */\n\tVK_HANJA: 25, \n\t/** Linux support for this keycode was added in Gecko 4.0. */\n\tVK_KANJI: 25, \n\t/** Linux support for this keycode was added in Gecko 4.0. */\n\tVK_CONVERT: 28, \n\t/** Linux support for this keycode was added in Gecko 4.0. */\n\tVK_NONCONVERT: 29, \n\t/** Linux support for this keycode was added in Gecko 4.0. */\n\tVK_ACCEPT: 30, \n\t/** Linux support for this keycode was added in Gecko 4.0. */\n\tVK_MODECHANGE: 31, \n\t/** Linux support for this keycode was added in Gecko 4.0. */\n\tVK_SELECT: 41, \n\t/** Linux support for this keycode was added in Gecko 4.0. */\n\tVK_PRINT: 42, \n\t/** Linux support for this keycode was added in Gecko 4.0. */\n\tVK_EXECUTE: 43, \n\t/** Linux support for this keycode was added in Gecko 4.0.\t */\n\tVK_SLEEP: 95 \n};\n/**\n * @namespace\n * Contains text tokenization and breaking routines\n */\nROT.Text = {\n\tRE_COLORS: /%([bc]){([^}]*)}/g,\n\n\t/* token types */\n\tTYPE_TEXT:\t\t0,\n\tTYPE_NEWLINE:\t1,\n\tTYPE_FG:\t\t2,\n\tTYPE_BG:\t\t3,\n\n\t/**\n\t * Measure size of a resulting text block\n\t */\n\tmeasure: function(str, maxWidth) {\n\t\tvar result = {width:0, height:1};\n\t\tvar tokens = this.tokenize(str, maxWidth);\n\t\tvar lineWidth = 0;\n\n\t\tfor (var i=0;i<tokens.length;i++) {\n\t\t\tvar token = tokens[i];\n\t\t\tswitch (token.type) {\n\t\t\t\tcase this.TYPE_TEXT:\n\t\t\t\t\tlineWidth += token.value.length;\n\t\t\t\tbreak;\n\n\t\t\t\tcase this.TYPE_NEWLINE:\n\t\t\t\t\tresult.height++;\n\t\t\t\t\tresult.width = Math.max(result.width, lineWidth);\n\t\t\t\t\tlineWidth = 0;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tresult.width = Math.max(result.width, lineWidth);\n\n\t\treturn result;\n\t},\n\n\t/**\n\t * Convert string to a series of a formatting commands\n\t */\n\ttokenize: function(str, maxWidth) {\n\t\tvar result = [];\n\n\t\t/* first tokenization pass - split texts and color formatting commands */\n\t\tvar offset = 0;\n\t\tstr.replace(this.RE_COLORS, function(match, type, name, index) {\n\t\t\t/* string before */\n\t\t\tvar part = str.substring(offset, index);\n\t\t\tif (part.length) {\n\t\t\t\tresult.push({\n\t\t\t\t\ttype: ROT.Text.TYPE_TEXT,\n\t\t\t\t\tvalue: part\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t/* color command */\n\t\t\tresult.push({\n\t\t\t\ttype: (type == \"c\" ? ROT.Text.TYPE_FG : ROT.Text.TYPE_BG),\n\t\t\t\tvalue: name.trim()\n\t\t\t});\n\n\t\t\toffset = index + match.length;\n\t\t\treturn \"\";\n\t\t});\n\n\t\t/* last remaining part */\n\t\tvar part = str.substring(offset);\n\t\tif (part.length) {\n\t\t\tresult.push({\n\t\t\t\ttype: ROT.Text.TYPE_TEXT,\n\t\t\t\tvalue: part\n\t\t\t});\n\t\t}\n\n\t\treturn this._breakLines(result, maxWidth);\n\t},\n\n\t/* insert line breaks into first-pass tokenized data */\n\t_breakLines: function(tokens, maxWidth) {\n\t\tif (!maxWidth) { maxWidth = Infinity; }\n\n\t\tvar i = 0;\n\t\tvar lineLength = 0;\n\t\tvar lastTokenWithSpace = -1;\n\n\t\twhile (i < tokens.length) { /* take all text tokens, remove space, apply linebreaks */\n\t\t\tvar token = tokens[i];\n\t\t\tif (token.type == ROT.Text.TYPE_NEWLINE) { /* reset */\n\t\t\t\tlineLength = 0; \n\t\t\t\tlastTokenWithSpace = -1;\n\t\t\t}\n\t\t\tif (token.type != ROT.Text.TYPE_TEXT) { /* skip non-text tokens */\n\t\t\t\ti++;\n\t\t\t\tcontinue; \n\t\t\t}\n\n\t\t\t/* remove spaces at the beginning of line */\n\t\t\twhile (lineLength == 0 && token.value.charAt(0) == \" \") { token.value = token.value.substring(1); }\n\n\t\t\t/* forced newline? insert two new tokens after this one */\n\t\t\tvar index = token.value.indexOf(\"\\n\");\n\t\t\tif (index != -1) { \n\t\t\t\ttoken.value = this._breakInsideToken(tokens, i, index, true); \n\n\t\t\t\t/* if there are spaces at the end, we must remove them (we do not want the line too long) */\n\t\t\t\tvar arr = token.value.split(\"\");\n\t\t\t\twhile (arr.length && arr[arr.length-1] == \" \") { arr.pop(); }\n\t\t\t\ttoken.value = arr.join(\"\");\n\t\t\t}\n\n\t\t\t/* token degenerated? */\n\t\t\tif (!token.value.length) {\n\t\t\t\ttokens.splice(i, 1);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (lineLength + token.value.length > maxWidth) { /* line too long, find a suitable breaking spot */\n\n\t\t\t\t/* is it possible to break within this token? */\n\t\t\t\tvar index = -1;\n\t\t\t\twhile (1) {\n\t\t\t\t\tvar nextIndex = token.value.indexOf(\" \", index+1);\n\t\t\t\t\tif (nextIndex == -1) { break; }\n\t\t\t\t\tif (lineLength + nextIndex > maxWidth) { break; }\n\t\t\t\t\tindex = nextIndex;\n\t\t\t\t}\n\n\t\t\t\tif (index != -1) { /* break at space within this one */\n\t\t\t\t\ttoken.value = this._breakInsideToken(tokens, i, index, true);\n\t\t\t\t} else if (lastTokenWithSpace != -1) { /* is there a previous token where a break can occur? */\n\t\t\t\t\tvar token = tokens[lastTokenWithSpace];\n\t\t\t\t\tvar breakIndex = token.value.lastIndexOf(\" \");\n\t\t\t\t\ttoken.value = this._breakInsideToken(tokens, lastTokenWithSpace, breakIndex, true);\n\t\t\t\t\ti = lastTokenWithSpace;\n\t\t\t\t} else { /* force break in this token */\n\t\t\t\t\ttoken.value = this._breakInsideToken(tokens, i, maxWidth-lineLength, false);\n\t\t\t\t}\n\n\t\t\t} else { /* line not long, continue */\n\t\t\t\tlineLength += token.value.length;\n\t\t\t\tif (token.value.indexOf(\" \") != -1) { lastTokenWithSpace = i; }\n\t\t\t}\n\t\t\t\n\t\t\ti++; /* advance to next token */\n\t\t}\n\n\n\t\ttokens.push({type: ROT.Text.TYPE_NEWLINE}); /* insert fake newline to fix the last text line */\n\n\t\t/* remove trailing space from text tokens before newlines */\n\t\tvar lastTextToken = null;\n\t\tfor (var i=0;i<tokens.length;i++) {\n\t\t\tvar token = tokens[i];\n\t\t\tswitch (token.type) {\n\t\t\t\tcase ROT.Text.TYPE_TEXT: lastTextToken = token; break;\n\t\t\t\tcase ROT.Text.TYPE_NEWLINE: \n\t\t\t\t\tif (lastTextToken) { /* remove trailing space */\n\t\t\t\t\t\tvar arr = lastTextToken.value.split(\"\");\n\t\t\t\t\t\twhile (arr.length && arr[arr.length-1] == \" \") { arr.pop(); }\n\t\t\t\t\t\tlastTextToken.value = arr.join(\"\");\n\t\t\t\t\t}\n\t\t\t\t\tlastTextToken = null;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\ttokens.pop(); /* remove fake token */\n\n\t\treturn tokens;\n\t},\n\n\t/**\n\t * Create new tokens and insert them into the stream\n\t * @param {object[]} tokens\n\t * @param {int} tokenIndex Token being processed\n\t * @param {int} breakIndex Index within current token's value\n\t * @param {bool} removeBreakChar Do we want to remove the breaking character?\n\t * @returns {string} remaining unbroken token value\n\t */\n\t_breakInsideToken: function(tokens, tokenIndex, breakIndex, removeBreakChar) {\n\t\tvar newBreakToken = {\n\t\t\ttype: ROT.Text.TYPE_NEWLINE\n\t\t};\n\t\tvar newTextToken = {\n\t\t\ttype: ROT.Text.TYPE_TEXT,\n\t\t\tvalue: tokens[tokenIndex].value.substring(breakIndex + (removeBreakChar ? 1 : 0))\n\t\t};\n\t\ttokens.splice(tokenIndex+1, 0, newBreakToken, newTextToken);\n\t\treturn tokens[tokenIndex].value.substring(0, breakIndex);\n\t}\n};\n/**\n * @returns {any} Randomly picked item, null when length=0\n */\nArray.prototype.random = Array.prototype.random || function() {\n\tif (!this.length) { return null; }\n\treturn this[Math.floor(ROT.RNG.getUniform() * this.length)];\n};\n\n/**\n * @returns {array} New array with randomized items\n */\nArray.prototype.randomize = Array.prototype.randomize || function() {\n  var result = [];\n  var clone = this.slice();\n  while (clone.length) {\n    var index = clone.indexOf(clone.random());\n    result.push(clone.splice(index, 1)[0]);\n  }\n  return result;\n};\n/**\n * Always positive modulus\n * @param {int} n Modulus\n * @returns {int} this modulo n\n */\nNumber.prototype.mod = Number.prototype.mod || function(n) {\n\treturn ((this%n)+n)%n;\n};\n/**\n * @returns {string} First letter capitalized\n */\nString.prototype.capitalize = String.prototype.capitalize || function() {\n\treturn this.charAt(0).toUpperCase() + this.substring(1);\n};\n\n/** \n * Left pad\n * @param {string} [character=\"0\"]\n * @param {int} [count=2]\n */\nString.prototype.lpad = String.prototype.lpad || function(character, count) {\n\tvar ch = character || \"0\";\n\tvar cnt = count || 2;\n\n\tvar s = \"\";\n\twhile (s.length < (cnt - this.length)) { s += ch; }\n\ts = s.substring(0, cnt-this.length);\n\treturn s+this;\n};\n\n/** \n * Right pad\n * @param {string} [character=\"0\"]\n * @param {int} [count=2]\n */\nString.prototype.rpad = String.prototype.rpad || function(character, count) {\n\tvar ch = character || \"0\";\n\tvar cnt = count || 2;\n\n\tvar s = \"\";\n\twhile (s.length < (cnt - this.length)) { s += ch; }\n\ts = s.substring(0, cnt-this.length);\n\treturn this+s;\n};\n\n/**\n * Format a string in a flexible way. Scans for %s strings and replaces them with arguments. List of patterns is modifiable via String.format.map.\n * @param {string} template\n * @param {any} [argv]\n */\nString.format = String.format || function(template) {\n\tvar map = String.format.map;\n\tvar args = Array.prototype.slice.call(arguments, 1);\n\n\tvar replacer = function(match, group1, group2, index) {\n\t\tif (template.charAt(index-1) == \"%\") { return match.substring(1); }\n\t\tif (!args.length) { return match; }\n\t\tvar obj = args[0];\n\n\t\tvar group = group1 || group2;\n\t\tvar parts = group.split(\",\");\n\t\tvar name = parts.shift();\n\t\tvar method = map[name.toLowerCase()];\n\t\tif (!method) { return match; }\n\n\t\tvar obj = args.shift();\n\t\tvar replaced = obj[method].apply(obj, parts);\n\n\t\tvar first = name.charAt(0);\n\t\tif (first != first.toLowerCase()) { replaced = replaced.capitalize(); }\n\n\t\treturn replaced;\n\t};\n\treturn template.replace(/%(?:([a-z]+)|(?:{([^}]+)}))/gi, replacer);\n};\n\nString.format.map = String.format.map || {\n\t\"s\": \"toString\"\n};\n\n/**\n * Convenience shortcut to String.format(this)\n */\nString.prototype.format = String.prototype.format || function() {\n\tvar args = Array.prototype.slice.call(arguments);\n\targs.unshift(this);\n\treturn String.format.apply(String, args);\n};\n\nif (!Object.create) {  \n\t/**\n\t * ES5 Object.create\n\t */\n\tObject.create = function(o) {  \n\t\tvar tmp = function() {};\n\t\ttmp.prototype = o;\n\t\treturn new tmp();\n\t};  \n}  \n/**\n * Sets prototype of this function to an instance of parent function\n * @param {function} parent\n */\nFunction.prototype.extend = Function.prototype.extend || function(parent) {\n\tthis.prototype = Object.create(parent.prototype);\n\tthis.prototype.constructor = this;\n\treturn this;\n};\nif (typeof window != \"undefined\") {\n\twindow.requestAnimationFrame =\n\t\twindow.requestAnimationFrame\n\t\t|| window.mozRequestAnimationFrame\n\t\t|| window.webkitRequestAnimationFrame\n\t\t|| window.oRequestAnimationFrame\n\t\t|| window.msRequestAnimationFrame\n\t\t|| function(cb) { return setTimeout(function() { cb(Date.now()); }, 1000/60); };\n\n\twindow.cancelAnimationFrame =\n\t\twindow.cancelAnimationFrame\n\t\t|| window.mozCancelAnimationFrame\n\t\t|| window.webkitCancelAnimationFrame\n\t\t|| window.oCancelAnimationFrame\n\t\t|| window.msCancelAnimationFrame\n\t\t|| function(id) { return clearTimeout(id); };\n}\n/**\n * @class Visual map display\n * @param {object} [options]\n * @param {int} [options.width=ROT.DEFAULT_WIDTH]\n * @param {int} [options.height=ROT.DEFAULT_HEIGHT]\n * @param {int} [options.fontSize=15]\n * @param {string} [options.fontFamily=\"monospace\"]\n * @param {string} [options.fontStyle=\"\"] bold/italic/none/both\n * @param {string} [options.fg=\"#ccc\"]\n * @param {string} [options.bg=\"#000\"]\n * @param {float} [options.spacing=1]\n * @param {float} [options.border=0]\n * @param {string} [options.layout=\"rect\"]\n * @param {bool} [options.forceSquareRatio=false]\n * @param {int} [options.tileWidth=32]\n * @param {int} [options.tileHeight=32]\n * @param {object} [options.tileMap={}]\n * @param {image} [options.tileSet=null]\n * @param {image} [options.tileColorize=false]\n */\nROT.Display = function(options) {\n\tvar canvas = document.createElement(\"canvas\");\n\tthis._context = canvas.getContext(\"2d\");\n\tthis._data = {};\n\tthis._dirty = false; /* false = nothing, true = all, object = dirty cells */\n\tthis._options = {};\n\tthis._backend = null;\n\t\n\tvar defaultOptions = {\n\t\twidth: ROT.DEFAULT_WIDTH,\n\t\theight: ROT.DEFAULT_HEIGHT,\n\t\ttranspose: false,\n\t\tlayout: \"rect\",\n\t\tfontSize: 15,\n\t\tspacing: 1,\n\t\tborder: 0,\n\t\tforceSquareRatio: false,\n\t\tfontFamily: \"monospace\",\n\t\tfontStyle: \"\",\n\t\tfg: \"#ccc\",\n\t\tbg: \"#000\",\n\t\ttileWidth: 32,\n\t\ttileHeight: 32,\n\t\ttileMap: {},\n\t\ttileSet: null,\n\t\ttileColorize: false,\n\t\ttermColor: \"xterm\"\n\t};\n\tfor (var p in options) { defaultOptions[p] = options[p]; }\n\tthis.setOptions(defaultOptions);\n\tthis.DEBUG = this.DEBUG.bind(this);\n\n\tthis._tick = this._tick.bind(this);\n\trequestAnimationFrame(this._tick);\n};\n\n/**\n * Debug helper, ideal as a map generator callback. Always bound to this.\n * @param {int} x\n * @param {int} y\n * @param {int} what\n */\nROT.Display.prototype.DEBUG = function(x, y, what) {\n\tvar colors = [this._options.bg, this._options.fg];\n\tthis.draw(x, y, null, null, colors[what % colors.length]);\n};\n\n/**\n * Clear the whole display (cover it with background color)\n */\nROT.Display.prototype.clear = function() {\n\tthis._data = {};\n\tthis._dirty = true;\n};\n\n/**\n * @see ROT.Display\n */\nROT.Display.prototype.setOptions = function(options) {\n\tfor (var p in options) { this._options[p] = options[p]; }\n\tif (options.width || options.height || options.fontSize || options.fontFamily || options.spacing || options.layout) {\n\t\tif (options.layout) { \n\t\t\tthis._backend = new ROT.Display[options.layout.capitalize()](this._context);\n\t\t}\n\n\t\tvar font = (this._options.fontStyle ? this._options.fontStyle + \" \" : \"\") + this._options.fontSize + \"px \" + this._options.fontFamily;\n\t\tthis._context.font = font;\n\t\tthis._backend.compute(this._options);\n\t\tthis._context.font = font;\n\t\tthis._context.textAlign = \"center\";\n\t\tthis._context.textBaseline = \"middle\";\n\t\tthis._dirty = true;\n\t}\n\treturn this;\n};\n\n/**\n * Returns currently set options\n * @returns {object} Current options object \n */\nROT.Display.prototype.getOptions = function() {\n\treturn this._options;\n};\n\n/**\n * Returns the DOM node of this display\n * @returns {node} DOM node\n */\nROT.Display.prototype.getContainer = function() {\n\treturn this._context.canvas;\n};\n\n/**\n * Compute the maximum width/height to fit into a set of given constraints\n * @param {int} availWidth Maximum allowed pixel width\n * @param {int} availHeight Maximum allowed pixel height\n * @returns {int[2]} cellWidth,cellHeight\n */\nROT.Display.prototype.computeSize = function(availWidth, availHeight) {\n\treturn this._backend.computeSize(availWidth, availHeight, this._options);\n};\n\n/**\n * Compute the maximum font size to fit into a set of given constraints\n * @param {int} availWidth Maximum allowed pixel width\n * @param {int} availHeight Maximum allowed pixel height\n * @returns {int} fontSize\n */\nROT.Display.prototype.computeFontSize = function(availWidth, availHeight) {\n\treturn this._backend.computeFontSize(availWidth, availHeight, this._options);\n};\n\n/**\n * Convert a DOM event (mouse or touch) to map coordinates. Uses first touch for multi-touch.\n * @param {Event} e event\n * @returns {int[2]} -1 for values outside of the canvas\n */\nROT.Display.prototype.eventToPosition = function(e) {\n\tif (e.touches) {\n\t\tvar x = e.touches[0].clientX;\n\t\tvar y = e.touches[0].clientY;\n\t} else {\n\t\tvar x = e.clientX;\n\t\tvar y = e.clientY;\n\t}\n\n\tvar rect = this._context.canvas.getBoundingClientRect();\n\tx -= rect.left;\n\ty -= rect.top;\n\t\n\tx *= this._context.canvas.width / this._context.canvas.clientWidth;\n\ty *= this._context.canvas.height / this._context.canvas.clientHeight;\n\n\tif (x < 0 || y < 0 || x >= this._context.canvas.width || y >= this._context.canvas.height) { return [-1, -1]; }\n\n\treturn this._backend.eventToPosition(x, y);\n};\n\n/**\n * @param {int} x\n * @param {int} y\n * @param {string || string[]} ch One or more chars (will be overlapping themselves)\n * @param {string} [fg] foreground color\n * @param {string} [bg] background color\n */\nROT.Display.prototype.draw = function(x, y, ch, fg, bg) {\n\tif (!fg) { fg = this._options.fg; }\n\tif (!bg) { bg = this._options.bg; }\n\tthis._data[x+\",\"+y] = [x, y, ch, fg, bg];\n\t\n\tif (this._dirty === true) { return; } /* will already redraw everything */\n\tif (!this._dirty) { this._dirty = {}; } /* first! */\n\tthis._dirty[x+\",\"+y] = true;\n};\n\n/**\n * Draws a text at given position. Optionally wraps at a maximum length. Currently does not work with hex layout.\n * @param {int} x\n * @param {int} y\n * @param {string} text May contain color/background format specifiers, %c{name}/%b{name}, both optional. %c{}/%b{} resets to default.\n * @param {int} [maxWidth] wrap at what width?\n * @returns {int} lines drawn\n */\nROT.Display.prototype.drawText = function(x, y, text, maxWidth) {\n\tvar fg = null;\n\tvar bg = null;\n\tvar cx = x;\n\tvar cy = y;\n\tvar lines = 1;\n\tif (!maxWidth) { maxWidth = this._options.width-x; }\n\n\tvar tokens = ROT.Text.tokenize(text, maxWidth);\n\n\twhile (tokens.length) { /* interpret tokenized opcode stream */\n\t\tvar token = tokens.shift();\n\t\tswitch (token.type) {\n\t\t\tcase ROT.Text.TYPE_TEXT:\n\t\t\t\tvar isSpace = false, isPrevSpace = false, isFullWidth = false, isPrevFullWidth = false;\n\t\t\t\tfor (var i=0;i<token.value.length;i++) {\n\t\t\t\t\tvar cc = token.value.charCodeAt(i);\n\t\t\t\t\tvar c = token.value.charAt(i);\n\t\t\t\t\t// Assign to `true` when the current char is full-width.\n\t\t\t\t\tisFullWidth = (cc > 0xff00 && cc < 0xff61) || (cc > 0xffdc && cc < 0xffe8) || cc > 0xffee;\n\t\t\t\t\t// Current char is space, whatever full-width or half-width both are OK.\n\t\t\t\t\tisSpace = (c.charCodeAt(0) == 0x20 || c.charCodeAt(0) == 0x3000);\n\t\t\t\t\t// The previous char is full-width and\n\t\t\t\t\t// current char is nether half-width nor a space.\n\t\t\t\t\tif (isPrevFullWidth && !isFullWidth && !isSpace) { cx++; } // add an extra position\n\t\t\t\t\t// The current char is full-width and\n\t\t\t\t\t// the previous char is not a space.\n\t\t\t\t\tif(isFullWidth && !isPrevSpace) { cx++; } // add an extra position\n\t\t\t\t\tthis.draw(cx++, cy, c, fg, bg);\n\t\t\t\t\tisPrevSpace = isSpace;\n\t\t\t\t\tisPrevFullWidth = isFullWidth;\n\t\t\t\t}\n\t\t\tbreak;\n\n\t\t\tcase ROT.Text.TYPE_FG:\n\t\t\t\tfg = token.value || null;\n\t\t\tbreak;\n\n\t\t\tcase ROT.Text.TYPE_BG:\n\t\t\t\tbg = token.value || null;\n\t\t\tbreak;\n\n\t\t\tcase ROT.Text.TYPE_NEWLINE:\n\t\t\t\tcx = x;\n\t\t\t\tcy++;\n\t\t\t\tlines++;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn lines;\n};\n\n/**\n * Timer tick: update dirty parts\n */\nROT.Display.prototype._tick = function() {\n\trequestAnimationFrame(this._tick);\n\n\tif (!this._dirty) { return; }\n\n\tif (this._dirty === true) { /* draw all */\n\t\tthis._context.fillStyle = this._options.bg;\n\t\tthis._context.fillRect(0, 0, this._context.canvas.width, this._context.canvas.height);\n\n\t\tfor (var id in this._data) { /* redraw cached data */\n\t\t\tthis._draw(id, false);\n\t\t}\n\n\t} else { /* draw only dirty */\n\t\tfor (var key in this._dirty) {\n\t\t\tthis._draw(key, true);\n\t\t}\n\t}\n\n\tthis._dirty = false;\n};\n\n/**\n * @param {string} key What to draw\n * @param {bool} clearBefore Is it necessary to clean before?\n */\nROT.Display.prototype._draw = function(key, clearBefore) {\n\tvar data = this._data[key];\n\tif (data[4] != this._options.bg) { clearBefore = true; }\n\n\tthis._backend.draw(data, clearBefore);\n};\n/**\n * @class Abstract display backend module\n * @private\n */\nROT.Display.Backend = function(context) {\n\tthis._context = context;\n};\n\nROT.Display.Backend.prototype.compute = function(options) {\n};\n\nROT.Display.Backend.prototype.draw = function(data, clearBefore) {\n};\n\nROT.Display.Backend.prototype.computeSize = function(availWidth, availHeight) {\n};\n\nROT.Display.Backend.prototype.computeFontSize = function(availWidth, availHeight) {\n};\n\nROT.Display.Backend.prototype.eventToPosition = function(x, y) {\n};\n/**\n * @class Rectangular backend\n * @private\n */\nROT.Display.Rect = function(context) {\n\tROT.Display.Backend.call(this, context);\n\t\n\tthis._spacingX = 0;\n\tthis._spacingY = 0;\n\tthis._canvasCache = {};\n\tthis._options = {};\n};\nROT.Display.Rect.extend(ROT.Display.Backend);\n\nROT.Display.Rect.cache = false;\n\nROT.Display.Rect.prototype.compute = function(options) {\n\tthis._canvasCache = {};\n\tthis._options = options;\n\n\tvar charWidth = Math.ceil(this._context.measureText(\"W\").width);\n\tthis._spacingX = Math.ceil(options.spacing * charWidth);\n\tthis._spacingY = Math.ceil(options.spacing * options.fontSize);\n\n\tif (this._options.forceSquareRatio) {\n\t\tthis._spacingX = this._spacingY = Math.max(this._spacingX, this._spacingY);\n\t}\n\n\tthis._context.canvas.width = options.width * this._spacingX;\n\tthis._context.canvas.height = options.height * this._spacingY;\n};\n\nROT.Display.Rect.prototype.draw = function(data, clearBefore) {\n\tif (this.constructor.cache) {\n\t\tthis._drawWithCache(data, clearBefore);\n\t} else {\n\t\tthis._drawNoCache(data, clearBefore);\n\t}\n};\n\nROT.Display.Rect.prototype._drawWithCache = function(data, clearBefore) {\n\tvar x = data[0];\n\tvar y = data[1];\n\tvar ch = data[2];\n\tvar fg = data[3];\n\tvar bg = data[4];\n\n\tvar hash = \"\"+ch+fg+bg;\n\tif (hash in this._canvasCache) {\n\t\tvar canvas = this._canvasCache[hash];\n\t} else {\n\t\tvar b = this._options.border;\n\t\tvar canvas = document.createElement(\"canvas\");\n\t\tvar ctx = canvas.getContext(\"2d\");\n\t\tcanvas.width = this._spacingX;\n\t\tcanvas.height = this._spacingY;\n\t\tctx.fillStyle = bg;\n\t\tctx.fillRect(b, b, canvas.width-b, canvas.height-b);\n\t\t\n\t\tif (ch) {\n\t\t\tctx.fillStyle = fg;\n\t\t\tctx.font = this._context.font;\n\t\t\tctx.textAlign = \"center\";\n\t\t\tctx.textBaseline = \"middle\";\n\n\t\t\tvar chars = [].concat(ch);\n\t\t\tfor (var i=0;i<chars.length;i++) {\n\t\t\t\tctx.fillText(chars[i], this._spacingX/2, Math.ceil(this._spacingY/2));\n\t\t\t}\n\t\t}\n\t\tthis._canvasCache[hash] = canvas;\n\t}\n\t\n\tthis._context.drawImage(canvas, x*this._spacingX, y*this._spacingY);\n};\n\nROT.Display.Rect.prototype._drawNoCache = function(data, clearBefore) {\n\tvar x = data[0];\n\tvar y = data[1];\n\tvar ch = data[2];\n\tvar fg = data[3];\n\tvar bg = data[4];\n\n\tif (clearBefore) { \n\t\tvar b = this._options.border;\n\t\tthis._context.fillStyle = bg;\n\t\tthis._context.fillRect(x*this._spacingX + b, y*this._spacingY + b, this._spacingX - b, this._spacingY - b);\n\t}\n\t\n\tif (!ch) { return; }\n\n\tthis._context.fillStyle = fg;\n\n\tvar chars = [].concat(ch);\n\tfor (var i=0;i<chars.length;i++) {\n\t\tthis._context.fillText(chars[i], (x+0.5) * this._spacingX, Math.ceil((y+0.5) * this._spacingY));\n\t}\n};\n\nROT.Display.Rect.prototype.computeSize = function(availWidth, availHeight) {\n\tvar width = Math.floor(availWidth / this._spacingX);\n\tvar height = Math.floor(availHeight / this._spacingY);\n\treturn [width, height];\n};\n\nROT.Display.Rect.prototype.computeFontSize = function(availWidth, availHeight) {\n\tvar boxWidth = Math.floor(availWidth / this._options.width);\n\tvar boxHeight = Math.floor(availHeight / this._options.height);\n\n\t/* compute char ratio */\n\tvar oldFont = this._context.font;\n\tthis._context.font = \"100px \" + this._options.fontFamily;\n\tvar width = Math.ceil(this._context.measureText(\"W\").width);\n\tthis._context.font = oldFont;\n\tvar ratio = width / 100;\n\t\t\n\tvar widthFraction = ratio * boxHeight / boxWidth;\n\tif (widthFraction > 1) { /* too wide with current aspect ratio */\n\t\tboxHeight = Math.floor(boxHeight / widthFraction);\n\t}\n\treturn Math.floor(boxHeight / this._options.spacing);\n};\n\nROT.Display.Rect.prototype.eventToPosition = function(x, y) {\n\treturn [Math.floor(x/this._spacingX), Math.floor(y/this._spacingY)];\n};\n/**\n * @class Hexagonal backend\n * @private\n */\nROT.Display.Hex = function(context) {\n\tROT.Display.Backend.call(this, context);\n\n\tthis._spacingX = 0;\n\tthis._spacingY = 0;\n\tthis._hexSize = 0;\n\tthis._options = {};\n};\nROT.Display.Hex.extend(ROT.Display.Backend);\n\nROT.Display.Hex.prototype.compute = function(options) {\n\tthis._options = options;\n\n\t/* FIXME char size computation does not respect transposed hexes */\n\tvar charWidth = Math.ceil(this._context.measureText(\"W\").width);\n\tthis._hexSize = Math.floor(options.spacing * (options.fontSize + charWidth/Math.sqrt(3)) / 2);\n\tthis._spacingX = this._hexSize * Math.sqrt(3) / 2;\n\tthis._spacingY = this._hexSize * 1.5;\n\n\tif (options.transpose) {\n\t\tvar xprop = \"height\";\n\t\tvar yprop = \"width\";\n\t} else {\n\t\tvar xprop = \"width\";\n\t\tvar yprop = \"height\";\n\t}\n\tthis._context.canvas[xprop] = Math.ceil( (options.width + 1) * this._spacingX );\n\tthis._context.canvas[yprop] = Math.ceil( (options.height - 1) * this._spacingY + 2*this._hexSize );\n};\n\nROT.Display.Hex.prototype.draw = function(data, clearBefore) {\n\tvar x = data[0];\n\tvar y = data[1];\n\tvar ch = data[2];\n\tvar fg = data[3];\n\tvar bg = data[4];\n\n\tvar px = [\n\t\t(x+1) * this._spacingX,\n\t\ty * this._spacingY + this._hexSize\n\t];\n\tif (this._options.transpose) { px.reverse(); }\n\n\tif (clearBefore) {\n\t\tthis._context.fillStyle = bg;\n\t\tthis._fill(px[0], px[1]);\n\t}\n\n\tif (!ch) { return; }\n\n\tthis._context.fillStyle = fg;\n\n\tvar chars = [].concat(ch);\n\tfor (var i=0;i<chars.length;i++) {\n\t\tthis._context.fillText(chars[i], px[0], Math.ceil(px[1]));\n\t}\n};\n\nROT.Display.Hex.prototype.computeSize = function(availWidth, availHeight) {\n\tif (this._options.transpose) {\n\t\tavailWidth += availHeight;\n\t\tavailHeight = availWidth - availHeight;\n\t\tavailWidth -= availHeight;\n\t}\n\n\tvar width = Math.floor(availWidth / this._spacingX) - 1;\n\tvar height = Math.floor((availHeight - 2*this._hexSize) / this._spacingY + 1);\n\treturn [width, height];\n};\n\nROT.Display.Hex.prototype.computeFontSize = function(availWidth, availHeight) {\n\tif (this._options.transpose) {\n\t\tavailWidth += availHeight;\n\t\tavailHeight = availWidth - availHeight;\n\t\tavailWidth -= availHeight;\n\t}\n\n\tvar hexSizeWidth = 2*availWidth / ((this._options.width+1) * Math.sqrt(3)) - 1;\n\tvar hexSizeHeight = availHeight / (2 + 1.5*(this._options.height-1));\n\tvar hexSize = Math.min(hexSizeWidth, hexSizeHeight);\n\n\t/* compute char ratio */\n\tvar oldFont = this._context.font;\n\tthis._context.font = \"100px \" + this._options.fontFamily;\n\tvar width = Math.ceil(this._context.measureText(\"W\").width);\n\tthis._context.font = oldFont;\n\tvar ratio = width / 100;\n\n\thexSize = Math.floor(hexSize)+1; /* closest larger hexSize */\n\n\t/* FIXME char size computation does not respect transposed hexes */\n\tvar fontSize = 2*hexSize / (this._options.spacing * (1 + ratio / Math.sqrt(3)));\n\n\t/* closest smaller fontSize */\n\treturn Math.ceil(fontSize)-1;\n};\n\nROT.Display.Hex.prototype.eventToPosition = function(x, y) {\n\tif (this._options.transpose) {\n\t\tx += y;\n\t\ty = x-y;\n\t\tx -= y;\n\t\tvar nodeSize = this._context.canvas.width;\n\t} else {\n\t\tvar nodeSize = this._context.canvas.height;\n\t}\n\tvar size = nodeSize / this._options.height;\n\ty = Math.floor(y/size);\n\n\tif (y.mod(2)) { /* odd row */\n\t\tx -= this._spacingX;\n\t\tx = 1 + 2*Math.floor(x/(2*this._spacingX));\n\t} else {\n\t\tx = 2*Math.floor(x/(2*this._spacingX));\n\t}\n\n\treturn [x, y];\n};\n\n/**\n * Arguments are pixel values. If \"transposed\" mode is enabled, then these two are already swapped.\n */\nROT.Display.Hex.prototype._fill = function(cx, cy) {\n\tvar a = this._hexSize;\n\tvar b = this._options.border;\n\n\tthis._context.beginPath();\n\n\tif (this._options.transpose) {\n\t\tthis._context.moveTo(cx-a+b,\tcy);\n\t\tthis._context.lineTo(cx-a/2+b,\tcy+this._spacingX-b);\n\t\tthis._context.lineTo(cx+a/2-b,\tcy+this._spacingX-b);\n\t\tthis._context.lineTo(cx+a-b,\tcy);\n\t\tthis._context.lineTo(cx+a/2-b,\tcy-this._spacingX+b);\n\t\tthis._context.lineTo(cx-a/2+b,\tcy-this._spacingX+b);\n\t\tthis._context.lineTo(cx-a+b,\tcy);\n\t} else {\n\t\tthis._context.moveTo(cx,\t\t\t\t\tcy-a+b);\n\t\tthis._context.lineTo(cx+this._spacingX-b,\tcy-a/2+b);\n\t\tthis._context.lineTo(cx+this._spacingX-b,\tcy+a/2-b);\n\t\tthis._context.lineTo(cx,\t\t\t\t\tcy+a-b);\n\t\tthis._context.lineTo(cx-this._spacingX+b,\tcy+a/2-b);\n\t\tthis._context.lineTo(cx-this._spacingX+b,\tcy-a/2+b);\n\t\tthis._context.lineTo(cx,\t\t\t\t\tcy-a+b);\n\t}\n\tthis._context.fill();\n};\n/**\n * @class Tile backend\n * @private\n */\nROT.Display.Tile = function(context) {\n\tROT.Display.Rect.call(this, context);\n\t\n\tthis._options = {};\n\tthis._colorCanvas = document.createElement(\"canvas\");\n};\nROT.Display.Tile.extend(ROT.Display.Rect);\n\nROT.Display.Tile.prototype.compute = function(options) {\n\tthis._options = options;\n\tthis._context.canvas.width = options.width * options.tileWidth;\n\tthis._context.canvas.height = options.height * options.tileHeight;\n\tthis._colorCanvas.width = options.tileWidth;\n\tthis._colorCanvas.height = options.tileHeight;\n};\n\nROT.Display.Tile.prototype.draw = function(data, clearBefore) {\n\tvar x = data[0];\n\tvar y = data[1];\n\tvar ch = data[2];\n\tvar fg = data[3];\n\tvar bg = data[4];\n\n\tvar tileWidth = this._options.tileWidth;\n\tvar tileHeight = this._options.tileHeight;\n\n\tif (clearBefore) {\n\t\tif (this._options.tileColorize) {\n\t\t\tthis._context.clearRect(x*tileWidth, y*tileHeight, tileWidth, tileHeight);\n\t\t} else {\n\t\t\tthis._context.fillStyle = bg;\n\t\t\tthis._context.fillRect(x*tileWidth, y*tileHeight, tileWidth, tileHeight);\n\t\t}\n\t}\n\n\tif (!ch) { return; }\n\n\tvar chars = [].concat(ch);\n\tfor (var i=0;i<chars.length;i++) {\n\t\tvar tile = this._options.tileMap[chars[i]];\n\t\tif (!tile) { throw new Error(\"Char '\" + chars[i] + \"' not found in tileMap\"); }\n\t\t\n\t\tif (this._options.tileColorize) { /* apply colorization */\n\t\t\tvar canvas = this._colorCanvas;\n\t\t\tvar context = canvas.getContext(\"2d\");\n\t\t\tcontext.clearRect(0, 0, tileWidth, tileHeight);\n\n\t\t\tcontext.drawImage(\n\t\t\t\tthis._options.tileSet,\n\t\t\t\ttile[0], tile[1], tileWidth, tileHeight,\n\t\t\t\t0, 0, tileWidth, tileHeight\n\t\t\t);\n\n\t\t\tif (fg != \"transparent\") {\n\t\t\t\tcontext.fillStyle = fg;\n\t\t\t\tcontext.globalCompositeOperation = \"source-atop\";\n\t\t\t\tcontext.fillRect(0, 0, tileWidth, tileHeight);\n\t\t\t}\n\n\t\t\tif (bg != \"transparent\") {\n\t\t\t\tcontext.fillStyle = bg;\n\t\t\t\tcontext.globalCompositeOperation = \"destination-over\";\n\t\t\t\tcontext.fillRect(0, 0, tileWidth, tileHeight);\n\t\t\t}\n\n\t\t\tthis._context.drawImage(canvas, x*tileWidth, y*tileHeight, tileWidth, tileHeight);\n\n\t\t} else { /* no colorizing, easy */\n\t\t\tthis._context.drawImage(\n\t\t\t\tthis._options.tileSet,\n\t\t\t\ttile[0], tile[1], tileWidth, tileHeight,\n\t\t\t\tx*tileWidth, y*tileHeight, tileWidth, tileHeight\n\t\t\t);\n\t\t}\n\t}\n};\n\nROT.Display.Tile.prototype.computeSize = function(availWidth, availHeight) {\n\tvar width = Math.floor(availWidth / this._options.tileWidth);\n\tvar height = Math.floor(availHeight / this._options.tileHeight);\n\treturn [width, height];\n};\n\nROT.Display.Tile.prototype.computeFontSize = function(availWidth, availHeight) {\n\tvar width = Math.floor(availWidth / this._options.width);\n\tvar height = Math.floor(availHeight / this._options.height);\n\treturn [width, height];\n};\n\nROT.Display.Tile.prototype.eventToPosition = function(x, y) {\n\treturn [Math.floor(x/this._options.tileWidth), Math.floor(y/this._options.tileHeight)];\n};\n/**\n * @namespace\n * This code is an implementation of Alea algorithm; (C) 2010 Johannes Baagøe.\n * Alea is licensed according to the http://en.wikipedia.org/wiki/MIT_License.\n */\nROT.RNG = {\n\t/**\n\t * @returns {number} \n\t */\n\tgetSeed: function() {\n\t\treturn this._seed;\n\t},\n\n\t/**\n\t * @param {number} seed Seed the number generator\n\t */\n\tsetSeed: function(seed) {\n\t\tseed = (seed < 1 ? 1/seed : seed);\n\n\t\tthis._seed = seed;\n\t\tthis._s0 = (seed >>> 0) * this._frac;\n\n\t\tseed = (seed*69069 + 1) >>> 0;\n\t\tthis._s1 = seed * this._frac;\n\n\t\tseed = (seed*69069 + 1) >>> 0;\n\t\tthis._s2 = seed * this._frac;\n\n\t\tthis._c = 1;\n\t\treturn this;\n\t},\n\n\t/**\n\t * @returns {float} Pseudorandom value [0,1), uniformly distributed\n\t */\n\tgetUniform: function() {\n\t\tvar t = 2091639 * this._s0 + this._c * this._frac;\n\t\tthis._s0 = this._s1;\n\t\tthis._s1 = this._s2;\n\t\tthis._c = t | 0;\n\t\tthis._s2 = t - this._c;\n\t\treturn this._s2;\n\t},\n\n\t/**\n\t * @param {int} lowerBound The lower end of the range to return a value from, inclusive\n\t * @param {int} upperBound The upper end of the range to return a value from, inclusive\n\t * @returns {int} Pseudorandom value [lowerBound, upperBound], using ROT.RNG.getUniform() to distribute the value\n\t */\n\tgetUniformInt: function(lowerBound, upperBound) {\n\t\tvar max = Math.max(lowerBound, upperBound);\n\t\tvar min = Math.min(lowerBound, upperBound);\n\t\treturn Math.floor(this.getUniform() * (max - min + 1)) + min;\n\t},\n\n\t/**\n\t * @param {float} [mean=0] Mean value\n\t * @param {float} [stddev=1] Standard deviation. ~95% of the absolute values will be lower than 2*stddev.\n\t * @returns {float} A normally distributed pseudorandom value\n\t */\n\tgetNormal: function(mean, stddev) {\n\t\tdo {\n\t\t\tvar u = 2*this.getUniform()-1;\n\t\t\tvar v = 2*this.getUniform()-1;\n\t\t\tvar r = u*u + v*v;\n\t\t} while (r > 1 || r == 0);\n\n\t\tvar gauss = u * Math.sqrt(-2*Math.log(r)/r);\n\t\treturn (mean || 0) + gauss*(stddev || 1);\n\t},\n\n\t/**\n\t * @returns {int} Pseudorandom value [1,100] inclusive, uniformly distributed\n\t */\n\tgetPercentage: function() {\n\t\treturn 1 + Math.floor(this.getUniform()*100);\n\t},\n\t\n\t/**\n\t * @param {object} data key=whatever, value=weight (relative probability)\n\t * @returns {string} whatever\n\t */\n\tgetWeightedValue: function(data) {\n\t\tvar total = 0;\n\t\t\n\t\tfor (var id in data) {\n\t\t\ttotal += data[id];\n\t\t}\n\t\tvar random = this.getUniform()*total;\n\t\t\n\t\tvar part = 0;\n\t\tfor (var id in data) {\n\t\t\tpart += data[id];\n\t\t\tif (random < part) { return id; }\n\t\t}\n\n\t\t// If by some floating-point annoyance we have\n\t\t// random >= total, just return the last id.\n\t\treturn id;\n\t},\n\n\t/**\n\t * Get RNG state. Useful for storing the state and re-setting it via setState.\n\t * @returns {?} Internal state\n\t */\n\tgetState: function() {\n\t\treturn [this._s0, this._s1, this._s2, this._c];\n\t},\n\n\t/**\n\t * Set a previously retrieved state.\n\t * @param {?} state\n\t */\n\tsetState: function(state) {\n\t\tthis._s0 = state[0];\n\t\tthis._s1 = state[1];\n\t\tthis._s2 = state[2];\n\t\tthis._c  = state[3];\n\t\treturn this;\n\t},\n\n\t/**\n\t * Returns a cloned RNG\n\t */\n\tclone: function() {\n\t\tvar clone = Object.create(this);\n\t\tclone.setState(this.getState());\n\t\treturn clone;\n\t},\n\n\t_s0: 0,\n\t_s1: 0,\n\t_s2: 0,\n\t_c: 0,\n\t_frac: 2.3283064365386963e-10 /* 2^-32 */\n};\n\nROT.RNG.setSeed(Date.now());\n/**\n * @class (Markov process)-based string generator. \n * Copied from a <a href=\"http://www.roguebasin.roguelikedevelopment.org/index.php?title=Names_from_a_high_order_Markov_Process_and_a_simplified_Katz_back-off_scheme\">RogueBasin article</a>. \n * Offers configurable order and prior.\n * @param {object} [options]\n * @param {bool} [options.words=false] Use word mode?\n * @param {int} [options.order=3]\n * @param {float} [options.prior=0.001]\n */\nROT.StringGenerator = function(options) {\n\tthis._options = {\n\t\twords: false,\n\t\torder: 3,\n\t\tprior: 0.001\n\t};\n\tfor (var p in options) { this._options[p] = options[p]; }\n\n\tthis._boundary = String.fromCharCode(0);\n\tthis._suffix = this._boundary;\n\tthis._prefix = [];\n\tfor (var i=0;i<this._options.order;i++) { this._prefix.push(this._boundary); }\n\n\tthis._priorValues = {};\n\tthis._priorValues[this._boundary] = this._options.prior;\n\n\tthis._data = {};\n};\n\n/**\n * Remove all learning data\n */\nROT.StringGenerator.prototype.clear = function() {\n\tthis._data = {};\n\tthis._priorValues = {};\n};\n\n/**\n * @returns {string} Generated string\n */\nROT.StringGenerator.prototype.generate = function() {\n\tvar result = [this._sample(this._prefix)];\n\twhile (result[result.length-1] != this._boundary) {\n\t\tresult.push(this._sample(result));\n\t}\n\treturn this._join(result.slice(0, -1));\n};\n\n/**\n * Observe (learn) a string from a training set\n */\nROT.StringGenerator.prototype.observe = function(string) {\n\tvar tokens = this._split(string);\n\n\tfor (var i=0; i<tokens.length; i++) {\n\t\tthis._priorValues[tokens[i]] = this._options.prior;\n\t}\n\n\ttokens = this._prefix.concat(tokens).concat(this._suffix); /* add boundary symbols */\n\n\tfor (var i=this._options.order; i<tokens.length; i++) {\n\t\tvar context = tokens.slice(i-this._options.order, i);\n\t\tvar event = tokens[i];\n\t\tfor (var j=0; j<context.length; j++) {\n\t\t\tvar subcontext = context.slice(j);\n\t\t\tthis._observeEvent(subcontext, event);\n\t\t}\n\t}\n};\n\nROT.StringGenerator.prototype.getStats = function() {\n\tvar parts = [];\n\n\tvar priorCount = 0;\n\tfor (var p in this._priorValues) { priorCount++; }\n\tpriorCount--; /* boundary */\n\tparts.push(\"distinct samples: \" + priorCount);\n\n\tvar dataCount = 0;\n\tvar eventCount = 0;\n\tfor (var p in this._data) { \n\t\tdataCount++; \n\t\tfor (var key in this._data[p]) {\n\t\t\teventCount++;\n\t\t}\n\t}\n\tparts.push(\"dictionary size (contexts): \" + dataCount);\n\tparts.push(\"dictionary size (events): \" + eventCount);\n\n\treturn parts.join(\", \");\n};\n\n/**\n * @param {string}\n * @returns {string[]}\n */\nROT.StringGenerator.prototype._split = function(str) {\n\treturn str.split(this._options.words ? /\\s+/ : \"\");\n};\n\n/**\n * @param {string[]}\n * @returns {string} \n */\nROT.StringGenerator.prototype._join = function(arr) {\n\treturn arr.join(this._options.words ? \" \" : \"\");\n};\n\n/**\n * @param {string[]} context\n * @param {string} event\n */\nROT.StringGenerator.prototype._observeEvent = function(context, event) {\n\tvar key = this._join(context);\n\tif (!(key in this._data)) { this._data[key] = {}; }\n\tvar data = this._data[key];\n\n\tif (!(event in data)) { data[event] = 0; }\n\tdata[event]++;\n};\n\n/**\n * @param {string[]}\n * @returns {string}\n */\nROT.StringGenerator.prototype._sample = function(context) {\n\tcontext = this._backoff(context);\n\tvar key = this._join(context);\n\tvar data = this._data[key];\n\n\tvar available = {};\n\n\tif (this._options.prior) {\n\t\tfor (var event in this._priorValues) { available[event] = this._priorValues[event]; }\n\t\tfor (var event in data) { available[event] += data[event]; }\n\t} else { \n\t\tavailable = data;\n\t}\n\n\treturn ROT.RNG.getWeightedValue(available);\n};\n\n/**\n * @param {string[]}\n * @returns {string[]}\n */\nROT.StringGenerator.prototype._backoff = function(context) {\n\tif (context.length > this._options.order) {\n\t\tcontext = context.slice(-this._options.order);\n\t} else if (context.length < this._options.order) {\n\t\tcontext = this._prefix.slice(0, this._options.order - context.length).concat(context);\n\t}\n\n\twhile (!(this._join(context) in this._data) && context.length > 0) { context = context.slice(1); }\n\n\treturn context;\n};\n/**\n * @class Generic event queue: stores events and retrieves them based on their time\n */\nROT.EventQueue = function() {\n\tthis._time = 0;\n\tthis._events = [];\n\tthis._eventTimes = [];\n};\n\n/**\n * @returns {number} Elapsed time\n */\nROT.EventQueue.prototype.getTime = function() {\n\treturn this._time;\n};\n\n/**\n * Clear all scheduled events\n */\nROT.EventQueue.prototype.clear = function() {\n\tthis._events = [];\n\tthis._eventTimes = [];\n\treturn this;\n};\n\n/**\n * @param {?} event\n * @param {number} time\n */\nROT.EventQueue.prototype.add = function(event, time) {\n\tvar index = this._events.length;\n\tfor (var i=0;i<this._eventTimes.length;i++) {\n\t\tif (this._eventTimes[i] > time) {\n\t\t\tindex = i;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tthis._events.splice(index, 0, event);\n\tthis._eventTimes.splice(index, 0, time);\n};\n\n/**\n * Locates the nearest event, advances time if necessary. Returns that event and removes it from the queue.\n * @returns {? || null} The event previously added by addEvent, null if no event available\n */\nROT.EventQueue.prototype.get = function() {\n\tif (!this._events.length) { return null; }\n\n\tvar time = this._eventTimes.splice(0, 1)[0];\n\tif (time > 0) { /* advance */\n\t\tthis._time += time;\n\t\tfor (var i=0;i<this._eventTimes.length;i++) { this._eventTimes[i] -= time; }\n\t}\n\n\treturn this._events.splice(0, 1)[0];\n};\n\n/**\n * Get the time associated with the given event\n * @param {?} event\n * @returns {number} time\n */\nROT.EventQueue.prototype.getEventTime = function(event) {\n\tvar index = this._events.indexOf(event);\n\tif (index == -1) { return undefined }\n\treturn this._eventTimes[index];\n};\n\n/**\n * Remove an event from the queue\n * @param {?} event\n * @returns {bool} success?\n */\nROT.EventQueue.prototype.remove = function(event) {\n\tvar index = this._events.indexOf(event);\n\tif (index == -1) { return false }\n\tthis._remove(index);\n\treturn true;\n};\n\n/**\n * Remove an event from the queue\n * @param {int} index\n */\nROT.EventQueue.prototype._remove = function(index) {\n\tthis._events.splice(index, 1);\n\tthis._eventTimes.splice(index, 1);\n};\n/**\n * @class Abstract scheduler\n */\nROT.Scheduler = function() {\n\tthis._queue = new ROT.EventQueue();\n\tthis._repeat = [];\n\tthis._current = null;\n};\n\n/**\n * @see ROT.EventQueue#getTime\n */\nROT.Scheduler.prototype.getTime = function() {\n\treturn this._queue.getTime();\n};\n\n/**\n * @param {?} item\n * @param {bool} repeat\n */\nROT.Scheduler.prototype.add = function(item, repeat) {\n\tif (repeat) { this._repeat.push(item); }\n\treturn this;\n};\n\n/**\n * Get the time the given item is scheduled for\n * @param {?} item\n * @returns {number} time\n */\nROT.Scheduler.prototype.getTimeOf = function(item) {\n\treturn this._queue.getEventTime(item);\n};\n\n/**\n * Clear all items\n */\nROT.Scheduler.prototype.clear = function() {\n\tthis._queue.clear();\n\tthis._repeat = [];\n\tthis._current = null;\n\treturn this;\n};\n\n/**\n * Remove a previously added item\n * @param {?} item\n * @returns {bool} successful?\n */\nROT.Scheduler.prototype.remove = function(item) {\n\tvar result = this._queue.remove(item);\n\n\tvar index = this._repeat.indexOf(item);\n\tif (index != -1) { this._repeat.splice(index, 1); }\n\n\tif (this._current == item) { this._current = null; }\n\n\treturn result;\n};\n\n/**\n * Schedule next item\n * @returns {?}\n */\nROT.Scheduler.prototype.next = function() {\n\tthis._current = this._queue.get();\n\treturn this._current;\n};\n/**\n * @class Simple fair scheduler (round-robin style)\n * @augments ROT.Scheduler\n */\nROT.Scheduler.Simple = function() {\n\tROT.Scheduler.call(this);\n};\nROT.Scheduler.Simple.extend(ROT.Scheduler);\n\n/**\n * @see ROT.Scheduler#add\n */\nROT.Scheduler.Simple.prototype.add = function(item, repeat) {\n\tthis._queue.add(item, 0);\n\treturn ROT.Scheduler.prototype.add.call(this, item, repeat);\n};\n\n/**\n * @see ROT.Scheduler#next\n */\nROT.Scheduler.Simple.prototype.next = function() {\n\tif (this._current && this._repeat.indexOf(this._current) != -1) {\n\t\tthis._queue.add(this._current, 0);\n\t}\n\treturn ROT.Scheduler.prototype.next.call(this);\n};\n/**\n * @class Speed-based scheduler\n * @augments ROT.Scheduler\n */\nROT.Scheduler.Speed = function() {\n\tROT.Scheduler.call(this);\n};\nROT.Scheduler.Speed.extend(ROT.Scheduler);\n\n/**\n * @param {object} item anything with \"getSpeed\" method\n * @param {bool} repeat\n * @param {number} [time=1/item.getSpeed()]\n * @see ROT.Scheduler#add\n */\nROT.Scheduler.Speed.prototype.add = function(item, repeat, time) {\n\tthis._queue.add(item, time !== undefined ? time : 1/item.getSpeed());\n\treturn ROT.Scheduler.prototype.add.call(this, item, repeat);\n};\n\n/**\n * @see ROT.Scheduler#next\n */\nROT.Scheduler.Speed.prototype.next = function() {\n\tif (this._current && this._repeat.indexOf(this._current) != -1) {\n\t\tthis._queue.add(this._current, 1/this._current.getSpeed());\n\t}\n\treturn ROT.Scheduler.prototype.next.call(this);\n};\n/**\n * @class Action-based scheduler\n * @augments ROT.Scheduler\n */\nROT.Scheduler.Action = function() {\n\tROT.Scheduler.call(this);\n\tthis._defaultDuration = 1; /* for newly added */\n\tthis._duration = this._defaultDuration; /* for this._current */\n};\nROT.Scheduler.Action.extend(ROT.Scheduler);\n\n/**\n * @param {object} item\n * @param {bool} repeat\n * @param {number} [time=1]\n * @see ROT.Scheduler#add\n */\nROT.Scheduler.Action.prototype.add = function(item, repeat, time) {\n\tthis._queue.add(item, time || this._defaultDuration);\n\treturn ROT.Scheduler.prototype.add.call(this, item, repeat);\n};\n\nROT.Scheduler.Action.prototype.clear = function() {\n\tthis._duration = this._defaultDuration;\n\treturn ROT.Scheduler.prototype.clear.call(this);\n};\n\nROT.Scheduler.Action.prototype.remove = function(item) {\n\tif (item == this._current) { this._duration = this._defaultDuration; }\n\treturn ROT.Scheduler.prototype.remove.call(this, item);\n};\n\n/**\n * @see ROT.Scheduler#next\n */\nROT.Scheduler.Action.prototype.next = function() {\n\tif (this._current && this._repeat.indexOf(this._current) != -1) {\n\t\tthis._queue.add(this._current, this._duration || this._defaultDuration);\n\t\tthis._duration = this._defaultDuration;\n\t}\n\treturn ROT.Scheduler.prototype.next.call(this);\n};\n\n/**\n * Set duration for the active item\n */\nROT.Scheduler.Action.prototype.setDuration = function(time) {\n\tif (this._current) { this._duration = time; }\n\treturn this;\n};\n/**\n * @class Asynchronous main loop\n * @param {ROT.Scheduler} scheduler\n */\nROT.Engine = function(scheduler) {\n\tthis._scheduler = scheduler;\n\tthis._lock = 1;\n};\n\n/**\n * Start the main loop. When this call returns, the loop is locked.\n */\nROT.Engine.prototype.start = function() {\n\treturn this.unlock();\n};\n\n/**\n * Interrupt the engine by an asynchronous action\n */\nROT.Engine.prototype.lock = function() {\n\tthis._lock++;\n\treturn this;\n};\n\n/**\n * Resume execution (paused by a previous lock)\n */\nROT.Engine.prototype.unlock = function() {\n\tif (!this._lock) { throw new Error(\"Cannot unlock unlocked engine\"); }\n\tthis._lock--;\n\n\twhile (!this._lock) {\n\t\tvar actor = this._scheduler.next();\n\t\tif (!actor) { return this.lock(); } /* no actors */\n\t\tvar result = actor.act();\n\t\tif (result && result.then) { /* actor returned a \"thenable\", looks like a Promise */\n\t\t\tthis.lock();\n\t\t\tresult.then(this.unlock.bind(this));\n\t\t}\n\t}\n\n\treturn this;\n};\n/**\n * @class Base map generator\n * @param {int} [width=ROT.DEFAULT_WIDTH]\n * @param {int} [height=ROT.DEFAULT_HEIGHT]\n */\nROT.Map = function(width, height) {\n\tthis._width = width || ROT.DEFAULT_WIDTH;\n\tthis._height = height || ROT.DEFAULT_HEIGHT;\n};\n\nROT.Map.prototype.create = function(callback) {};\n\nROT.Map.prototype._fillMap = function(value) {\n\tvar map = [];\n\tfor (var i=0;i<this._width;i++) {\n\t\tmap.push([]);\n\t\tfor (var j=0;j<this._height;j++) { map[i].push(value); }\n\t}\n\treturn map;\n};\n/**\n * @class Simple empty rectangular room\n * @augments ROT.Map\n */\nROT.Map.Arena = function(width, height) {\n\tROT.Map.call(this, width, height);\n};\nROT.Map.Arena.extend(ROT.Map);\n\nROT.Map.Arena.prototype.create = function(callback) {\n\tvar w = this._width-1;\n\tvar h = this._height-1;\n\tfor (var i=0;i<=w;i++) {\n\t\tfor (var j=0;j<=h;j++) {\n\t\t\tvar empty = (i && j && i<w && j<h);\n\t\t\tcallback(i, j, empty ? 0 : 1);\n\t\t}\n\t}\n\treturn this;\n};\n/**\n * @class Recursively divided maze, http://en.wikipedia.org/wiki/Maze_generation_algorithm#Recursive_division_method\n * @augments ROT.Map\n */\nROT.Map.DividedMaze = function(width, height) {\n\tROT.Map.call(this, width, height);\n\tthis._stack = [];\n};\nROT.Map.DividedMaze.extend(ROT.Map);\n\nROT.Map.DividedMaze.prototype.create = function(callback) {\n\tvar w = this._width;\n\tvar h = this._height;\n\t\n\tthis._map = [];\n\t\n\tfor (var i=0;i<w;i++) {\n\t\tthis._map.push([]);\n\t\tfor (var j=0;j<h;j++) {\n\t\t\tvar border = (i == 0 || j == 0 || i+1 == w || j+1 == h);\n\t\t\tthis._map[i].push(border ? 1 : 0);\n\t\t}\n\t}\n\t\n\tthis._stack = [\n\t\t[1, 1, w-2, h-2]\n\t];\n\tthis._process();\n\t\n\tfor (var i=0;i<w;i++) {\n\t\tfor (var j=0;j<h;j++) {\n\t\t\tcallback(i, j, this._map[i][j]);\n\t\t}\n\t}\n\tthis._map = null;\n\treturn this;\n};\n\nROT.Map.DividedMaze.prototype._process = function() {\n\twhile (this._stack.length) {\n\t\tvar room = this._stack.shift(); /* [left, top, right, bottom] */\n\t\tthis._partitionRoom(room);\n\t}\n};\n\nROT.Map.DividedMaze.prototype._partitionRoom = function(room) {\n\tvar availX = [];\n\tvar availY = [];\n\t\n\tfor (var i=room[0]+1;i<room[2];i++) {\n\t\tvar top = this._map[i][room[1]-1];\n\t\tvar bottom = this._map[i][room[3]+1];\n\t\tif (top && bottom && !(i % 2)) { availX.push(i); }\n\t}\n\t\n\tfor (var j=room[1]+1;j<room[3];j++) {\n\t\tvar left = this._map[room[0]-1][j];\n\t\tvar right = this._map[room[2]+1][j];\n\t\tif (left && right && !(j % 2)) { availY.push(j); }\n\t}\n\n\tif (!availX.length || !availY.length) { return; }\n\n\tvar x = availX.random();\n\tvar y = availY.random();\n\t\n\tthis._map[x][y] = 1;\n\t\n\tvar walls = [];\n\t\n\tvar w = []; walls.push(w); /* left part */\n\tfor (var i=room[0]; i<x; i++) { \n\t\tthis._map[i][y] = 1;\n\t\tw.push([i, y]); \n\t}\n\t\n\tvar w = []; walls.push(w); /* right part */\n\tfor (var i=x+1; i<=room[2]; i++) { \n\t\tthis._map[i][y] = 1;\n\t\tw.push([i, y]); \n\t}\n\n\tvar w = []; walls.push(w); /* top part */\n\tfor (var j=room[1]; j<y; j++) { \n\t\tthis._map[x][j] = 1;\n\t\tw.push([x, j]); \n\t}\n\t\n\tvar w = []; walls.push(w); /* bottom part */\n\tfor (var j=y+1; j<=room[3]; j++) { \n\t\tthis._map[x][j] = 1;\n\t\tw.push([x, j]); \n\t}\n\t\t\n\tvar solid = walls.random();\n\tfor (var i=0;i<walls.length;i++) {\n\t\tvar w = walls[i];\n\t\tif (w == solid) { continue; }\n\t\t\n\t\tvar hole = w.random();\n\t\tthis._map[hole[0]][hole[1]] = 0;\n\t}\n\n\tthis._stack.push([room[0], room[1], x-1, y-1]); /* left top */\n\tthis._stack.push([x+1, room[1], room[2], y-1]); /* right top */\n\tthis._stack.push([room[0], y+1, x-1, room[3]]); /* left bottom */\n\tthis._stack.push([x+1, y+1, room[2], room[3]]); /* right bottom */\n};\n/**\n * @class Icey's Maze generator\n * See http://www.roguebasin.roguelikedevelopment.org/index.php?title=Simple_maze for explanation\n * @augments ROT.Map\n */\nROT.Map.IceyMaze = function(width, height, regularity) {\n\tROT.Map.call(this, width, height);\n\tthis._regularity = regularity || 0;\n};\nROT.Map.IceyMaze.extend(ROT.Map);\n\nROT.Map.IceyMaze.prototype.create = function(callback) {\n\tvar width = this._width;\n\tvar height = this._height;\n\t\n\tvar map = this._fillMap(1);\n\t\n\twidth -= (width % 2 ? 1 : 2);\n\theight -= (height % 2 ? 1 : 2);\n\n\tvar cx = 0;\n\tvar cy = 0;\n\tvar nx = 0;\n\tvar ny = 0;\n\n\tvar done = 0;\n\tvar blocked = false;\n\tvar dirs = [\n\t\t[0, 0],\n\t\t[0, 0],\n\t\t[0, 0],\n\t\t[0, 0]\n\t];\n\tdo {\n\t\tcx = 1 + 2*Math.floor(ROT.RNG.getUniform()*(width-1) / 2);\n\t\tcy = 1 + 2*Math.floor(ROT.RNG.getUniform()*(height-1) / 2);\n\n\t\tif (!done) { map[cx][cy] = 0; }\n\t\t\n\t\tif (!map[cx][cy]) {\n\t\t\tthis._randomize(dirs);\n\t\t\tdo {\n\t\t\t\tif (Math.floor(ROT.RNG.getUniform()*(this._regularity+1)) == 0) { this._randomize(dirs); }\n\t\t\t\tblocked = true;\n\t\t\t\tfor (var i=0;i<4;i++) {\n\t\t\t\t\tnx = cx + dirs[i][0]*2;\n\t\t\t\t\tny = cy + dirs[i][1]*2;\n\t\t\t\t\tif (this._isFree(map, nx, ny, width, height)) {\n\t\t\t\t\t\tmap[nx][ny] = 0;\n\t\t\t\t\t\tmap[cx + dirs[i][0]][cy + dirs[i][1]] = 0;\n\t\t\t\t\t\t\n\t\t\t\t\t\tcx = nx;\n\t\t\t\t\t\tcy = ny;\n\t\t\t\t\t\tblocked = false;\n\t\t\t\t\t\tdone++;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} while (!blocked);\n\t\t}\n\t} while (done+1 < width*height/4);\n\t\n\tfor (var i=0;i<this._width;i++) {\n\t\tfor (var j=0;j<this._height;j++) {\n\t\t\tcallback(i, j, map[i][j]);\n\t\t}\n\t}\n\tthis._map = null;\n\treturn this;\n};\n\nROT.Map.IceyMaze.prototype._randomize = function(dirs) {\n\tfor (var i=0;i<4;i++) {\n\t\tdirs[i][0] = 0;\n\t\tdirs[i][1] = 0;\n\t}\n\t\n\tswitch (Math.floor(ROT.RNG.getUniform()*4)) {\n\t\tcase 0:\n\t\t\tdirs[0][0] = -1; dirs[1][0] = 1;\n\t\t\tdirs[2][1] = -1; dirs[3][1] = 1;\n\t\tbreak;\n\t\tcase 1:\n\t\t\tdirs[3][0] = -1; dirs[2][0] = 1;\n\t\t\tdirs[1][1] = -1; dirs[0][1] = 1;\n\t\tbreak;\n\t\tcase 2:\n\t\t\tdirs[2][0] = -1; dirs[3][0] = 1;\n\t\t\tdirs[0][1] = -1; dirs[1][1] = 1;\n\t\tbreak;\n\t\tcase 3:\n\t\t\tdirs[1][0] = -1; dirs[0][0] = 1;\n\t\t\tdirs[3][1] = -1; dirs[2][1] = 1;\n\t\tbreak;\n\t}\n};\n\nROT.Map.IceyMaze.prototype._isFree = function(map, x, y, width, height) {\n\tif (x < 1 || y < 1 || x >= width || y >= height) { return false; }\n\treturn map[x][y];\n};\n/**\n * @class Maze generator - Eller's algorithm\n * See http://homepages.cwi.nl/~tromp/maze.html for explanation\n * @augments ROT.Map\n */\nROT.Map.EllerMaze = function(width, height) {\n\tROT.Map.call(this, width, height);\n};\nROT.Map.EllerMaze.extend(ROT.Map);\n\nROT.Map.EllerMaze.prototype.create = function(callback) {\n\tvar map = this._fillMap(1);\n\tvar w = Math.ceil((this._width-2)/2);\n\t\n\tvar rand = 9/24;\n\t\n\tvar L = [];\n\tvar R = [];\n\t\n\tfor (var i=0;i<w;i++) {\n\t\tL.push(i);\n\t\tR.push(i);\n\t}\n\tL.push(w-1); /* fake stop-block at the right side */\n\n\tfor (var j=1;j+3<this._height;j+=2) {\n\t\t/* one row */\n\t\tfor (var i=0;i<w;i++) {\n\t\t\t/* cell coords (will be always empty) */\n\t\t\tvar x = 2*i+1;\n\t\t\tvar y = j;\n\t\t\tmap[x][y] = 0;\n\t\t\t\n\t\t\t/* right connection */\n\t\t\tif (i != L[i+1] && ROT.RNG.getUniform() > rand) {\n\t\t\t\tthis._addToList(i, L, R);\n\t\t\t\tmap[x+1][y] = 0;\n\t\t\t}\n\t\t\t\n\t\t\t/* bottom connection */\n\t\t\tif (i != L[i] && ROT.RNG.getUniform() > rand) {\n\t\t\t\t/* remove connection */\n\t\t\t\tthis._removeFromList(i, L, R);\n\t\t\t} else {\n\t\t\t\t/* create connection */\n\t\t\t\tmap[x][y+1] = 0;\n\t\t\t}\n\t\t}\n\t}\n\n\t/* last row */\n\tfor (var i=0;i<w;i++) {\n\t\t/* cell coords (will be always empty) */\n\t\tvar x = 2*i+1;\n\t\tvar y = j;\n\t\tmap[x][y] = 0;\n\t\t\n\t\t/* right connection */\n\t\tif (i != L[i+1] && (i == L[i] || ROT.RNG.getUniform() > rand)) {\n\t\t\t/* dig right also if the cell is separated, so it gets connected to the rest of maze */\n\t\t\tthis._addToList(i, L, R);\n\t\t\tmap[x+1][y] = 0;\n\t\t}\n\t\t\n\t\tthis._removeFromList(i, L, R);\n\t}\n\t\n\tfor (var i=0;i<this._width;i++) {\n\t\tfor (var j=0;j<this._height;j++) {\n\t\t\tcallback(i, j, map[i][j]);\n\t\t}\n\t}\n\t\n\treturn this;\n};\n\n/**\n * Remove \"i\" from its list\n */\nROT.Map.EllerMaze.prototype._removeFromList = function(i, L, R) {\n\tR[L[i]] = R[i];\n\tL[R[i]] = L[i];\n\tR[i] = i;\n\tL[i] = i;\n};\n\n/**\n * Join lists with \"i\" and \"i+1\"\n */\nROT.Map.EllerMaze.prototype._addToList = function(i, L, R) {\n\tR[L[i+1]] = R[i];\n\tL[R[i]] = L[i+1];\n\tR[i] = i+1;\n\tL[i+1] = i;\n};\n/**\n * @class Cellular automaton map generator\n * @augments ROT.Map\n * @param {int} [width=ROT.DEFAULT_WIDTH]\n * @param {int} [height=ROT.DEFAULT_HEIGHT]\n * @param {object} [options] Options\n * @param {int[]} [options.born] List of neighbor counts for a new cell to be born in empty space\n * @param {int[]} [options.survive] List of neighbor counts for an existing  cell to survive\n * @param {int} [options.topology] Topology 4 or 6 or 8\n */\nROT.Map.Cellular = function(width, height, options) {\n\tROT.Map.call(this, width, height);\n\tthis._options = {\n\t\tborn: [5, 6, 7, 8],\n\t\tsurvive: [4, 5, 6, 7, 8],\n\t\ttopology: 8\n\t};\n\tthis.setOptions(options);\n\n\tthis._dirs = ROT.DIRS[this._options.topology];\n\tthis._map = this._fillMap(0);\n};\nROT.Map.Cellular.extend(ROT.Map);\n\n/**\n * Fill the map with random values\n * @param {float} probability Probability for a cell to become alive; 0 = all empty, 1 = all full\n */\nROT.Map.Cellular.prototype.randomize = function(probability) {\n\tfor (var i=0;i<this._width;i++) {\n\t\tfor (var j=0;j<this._height;j++) {\n\t\t\tthis._map[i][j] = (ROT.RNG.getUniform() < probability ? 1 : 0);\n\t\t}\n\t}\n\treturn this;\n};\n\n/**\n * Change options.\n * @see ROT.Map.Cellular\n */\nROT.Map.Cellular.prototype.setOptions = function(options) {\n\tfor (var p in options) { this._options[p] = options[p]; }\n};\n\nROT.Map.Cellular.prototype.set = function(x, y, value) {\n\tthis._map[x][y] = value;\n};\n\nROT.Map.Cellular.prototype.create = function(callback) {\n\tvar newMap = this._fillMap(0);\n\tvar born = this._options.born;\n\tvar survive = this._options.survive;\n\n\n\tfor (var j=0;j<this._height;j++) {\n\t\tvar widthStep = 1;\n\t\tvar widthStart = 0;\n\t\tif (this._options.topology == 6) {\n\t\t\twidthStep = 2;\n\t\t\twidthStart = j%2;\n\t\t}\n\n\t\tfor (var i=widthStart; i<this._width; i+=widthStep) {\n\t\t\tvar cur = this._map[i][j];\n\t\t\tvar ncount = this._getNeighbors(i, j);\n\n\t\t\tif (cur && survive.indexOf(ncount) != -1) { /* survive */\n\t\t\t\tnewMap[i][j] = 1;\n\t\t\t} else if (!cur && born.indexOf(ncount) != -1) { /* born */\n\t\t\t\tnewMap[i][j] = 1;\n\t\t\t}\n\t\t}\n\t}\n\n\tthis._map = newMap;\n\tcallback && this._serviceCallback(callback);\n};\n\nROT.Map.Cellular.prototype._serviceCallback = function(callback) {\n\tfor (var j=0;j<this._height;j++) {\n\t\tvar widthStep = 1;\n\t\tvar widthStart = 0;\n\t\tif (this._options.topology == 6) {\n\t\t\twidthStep = 2;\n\t\t\twidthStart = j%2;\n\t\t}\n\t\tfor (var i=widthStart; i<this._width; i+=widthStep) {\n\t\t\tcallback(i, j, this._map[i][j]);\n\t\t}\n\t}\n};\n\n/**\n * Get neighbor count at [i,j] in this._map\n */\nROT.Map.Cellular.prototype._getNeighbors = function(cx, cy) {\n\tvar result = 0;\n\tfor (var i=0;i<this._dirs.length;i++) {\n\t\tvar dir = this._dirs[i];\n\t\tvar x = cx + dir[0];\n\t\tvar y = cy + dir[1];\n\n\t\tif (x < 0 || x >= this._width || y < 0 || y >= this._height) { continue; }\n\t\tresult += (this._map[x][y] == 1 ? 1 : 0);\n\t}\n\n\treturn result;\n};\n\n/**\n * Make sure every non-wall space is accessible.\n * @param {function} callback to call to display map when do\n * @param {int} value to consider empty space - defaults to 0\n * @param {function} callback to call when a new connection is made\n */\nROT.Map.Cellular.prototype.connect = function(callback, value, connectionCallback) {\n\tif (!value) value = 0;\n\n\tvar allFreeSpace = [];\n\tvar notConnected = {};\n\n\t// find all free space\n\tvar widthStep = 1;\n\tvar widthStarts = [0, 0];\n\tif (this._options.topology == 6) {\n\t\twidthStep = 2;\n\t\twidthStarts = [0, 1];\n\t}\n\tfor (var y = 0; y < this._height; y++) {\n\t\tfor (var x = widthStarts[y % 2]; x < this._width; x += widthStep) {\n\t\t\tif (this._freeSpace(x, y, value)) {\n\t\t\t\tvar p = [x, y];\n\t\t\t\tnotConnected[this._pointKey(p)] = p;\n\t\t\t\tallFreeSpace.push([x, y]);\n\t\t\t}\n\t\t}\n\t}\n\tvar start = allFreeSpace[ROT.RNG.getUniformInt(0, allFreeSpace.length - 1)];\n\n\tvar key = this._pointKey(start);\n\tvar connected = {};\n\tconnected[key] = start;\n\tdelete notConnected[key];\n\n\t// find what's connected to the starting point\n\tthis._findConnected(connected, notConnected, [start], false, value);\n\n\twhile (Object.keys(notConnected).length > 0) {\n\t\t// find two points from notConnected to connected\n\t\tvar p = this._getFromTo(connected, notConnected);\n\t\tvar from = p[0]; // notConnected\n\t\tvar to = p[1]; // connected\n\n\t\t// find everything connected to the starting point\n\t\tvar local = {};\n\t\tlocal[this._pointKey(from)] = from;\n\t\tthis._findConnected(local, notConnected, [from], true, value);\n\n\t\t// connect to a connected cell\n\t\tvar tunnelFn = (this._options.topology == 6 ? this._tunnelToConnected6 : this._tunnelToConnected);\n\t\ttunnelFn.call(this, to, from, connected, notConnected, value, connectionCallback);\n\n\t\t// now all of local is connected\n\t\tfor (var k in local) {\n\t\t\tvar pp = local[k];\n\t\t\tthis._map[pp[0]][pp[1]] = value;\n\t\t\tconnected[k] = pp;\n\t\t\tdelete notConnected[k];\n\t\t}\n\t}\n\n\tcallback && this._serviceCallback(callback);\n};\n\n/**\n * Find random points to connect. Search for the closest point in the larger space.\n * This is to minimize the length of the passage while maintaining good performance.\n */\nROT.Map.Cellular.prototype._getFromTo = function(connected, notConnected) {\n\tvar from, to, d;\n\tvar connectedKeys = Object.keys(connected);\n\tvar notConnectedKeys = Object.keys(notConnected);\n\tfor (var i = 0; i < 5; i++) {\n\t\tif (connectedKeys.length < notConnectedKeys.length) {\n\t\t\tvar keys = connectedKeys;\n\t\t\tto = connected[keys[ROT.RNG.getUniformInt(0, keys.length - 1)]];\n\t\t\tfrom = this._getClosest(to, notConnected);\n\t\t} else {\n\t\t\tvar keys = notConnectedKeys;\n\t\t\tfrom = notConnected[keys[ROT.RNG.getUniformInt(0, keys.length - 1)]];\n\t\t\tto = this._getClosest(from, connected);\n\t\t}\n\t\td = (from[0] - to[0]) * (from[0] - to[0]) + (from[1] - to[1]) * (from[1] - to[1]);\n\t\tif (d < 64) {\n\t\t\tbreak;\n\t\t}\n\t}\n\t// console.log(\">>> connected=\" + to + \" notConnected=\" + from + \" dist=\" + d);\n\treturn [from, to];\n};\n\nROT.Map.Cellular.prototype._getClosest = function(point, space) {\n\tvar minPoint = null;\n\tvar minDist = null;\n\tfor (k in space) {\n\t\tvar p = space[k];\n\t\tvar d = (p[0] - point[0]) * (p[0] - point[0]) + (p[1] - point[1]) * (p[1] - point[1]);\n\t\tif (minDist == null || d < minDist) {\n\t\t\tminDist = d;\n\t\t\tminPoint = p;\n\t\t}\n\t}\n\treturn minPoint;\n};\n\nROT.Map.Cellular.prototype._findConnected = function(connected, notConnected, stack, keepNotConnected, value) {\n\twhile(stack.length > 0) {\n\t\tvar p = stack.splice(0, 1)[0];\n\t\tvar tests;\n\n\t\tif (this._options.topology == 6) {\n\t\t\ttests = [\n\t\t\t\t[p[0] + 2, p[1]],\n\t\t\t\t[p[0] + 1, p[1] - 1],\n\t\t\t\t[p[0] - 1, p[1] - 1],\n\t\t\t\t[p[0] - 2, p[1]],\n\t\t\t\t[p[0] - 1, p[1] + 1],\n\t\t\t\t[p[0] + 1, p[1] + 1],\n\t\t\t];\n\t\t} else {\n\t\t\ttests = [\n\t\t\t\t[p[0] + 1, p[1]],\n\t\t\t\t[p[0] - 1, p[1]],\n\t\t\t\t[p[0],     p[1] + 1],\n\t\t\t\t[p[0],     p[1] - 1]\n\t\t\t];\n\t\t}\n\n\t\tfor (var i = 0; i < tests.length; i++) {\n\t\t\tvar key = this._pointKey(tests[i]);\n\t\t\tif (connected[key] == null && this._freeSpace(tests[i][0], tests[i][1], value)) {\n\t\t\t\tconnected[key] = tests[i];\n\t\t\t\tif (!keepNotConnected) {\n\t\t\t\t\tdelete notConnected[key];\n\t\t\t\t}\n\t\t\t\tstack.push(tests[i]);\n\t\t\t}\n\t\t}\n\t}\n};\n\nROT.Map.Cellular.prototype._tunnelToConnected = function(to, from, connected, notConnected, value, connectionCallback) {\n\tvar key = this._pointKey(from);\n\tvar a, b;\n\tif (from[0] < to[0]) {\n\t\ta = from;\n\t\tb = to;\n\t} else {\n\t\ta = to;\n\t\tb = from;\n\t}\n\tfor (var xx = a[0]; xx <= b[0]; xx++) {\n\t\tthis._map[xx][a[1]] = value;\n\t\tvar p = [xx, a[1]];\n\t\tvar pkey = this._pointKey(p);\n\t\tconnected[pkey] = p;\n\t\tdelete notConnected[pkey];\n\t}\n\tif (connectionCallback && a[0] < b[0]) {\n\t\tconnectionCallback(a, [b[0], a[1]]);\n\t}\n\n\t// x is now fixed\n\tvar x = b[0];\n\n\tif (from[1] < to[1]) {\n\t\ta = from;\n\t\tb = to;\n\t} else {\n\t\ta = to;\n\t\tb = from;\n\t}\n\tfor (var yy = a[1]; yy < b[1]; yy++) {\n\t\tthis._map[x][yy] = value;\n\t\tvar p = [x, yy];\n\t\tvar pkey = this._pointKey(p);\n\t\tconnected[pkey] = p;\n\t\tdelete notConnected[pkey];\n\t}\n\tif (connectionCallback && a[1] < b[1]) { connectionCallback([b[0], a[1]], [b[0], b[1]]); }\n}\n\nROT.Map.Cellular.prototype._tunnelToConnected6 = function(to, from, connected, notConnected, value, connectionCallback) {\n\tvar a, b;\n\tif (from[0] < to[0]) {\n\t\ta = from;\n\t\tb = to;\n\t} else {\n\t\ta = to;\n\t\tb = from;\n\t}\n\n\t// tunnel diagonally until horizontally level\n\tvar xx = a[0];\n\tvar yy = a[1];\n\twhile (!(xx == b[0] && yy == b[1])) {\n\t\tvar stepWidth = 2;\n\t\tif (yy < b[1]) {\n\t\t\tyy++;\n\t\t\tstepWidth = 1;\n\t\t} else if (yy > b[1]) {\n\t\t\tyy--;\n\t\t\tstepWidth = 1;\n\t\t}\n\t\tif (xx < b[0]) {\n\t\t\txx += stepWidth\n\t\t} else if (xx > b[0]) {\n\t\t\txx -= stepWidth\n\t\t} else if (b[1] % 2) {\n\t\t\t// Won't step outside map if destination on is map's right edge\n\t\t\txx -= stepWidth;\n\t\t} else {\n\t\t\t// ditto for left edge\n\t\t\txx += stepWidth;\n\t\t}\n\t\tthis._map[xx][yy] = value;\n\t\tvar p = [xx, yy]\n\t\tvar pkey = this._pointKey(p);\n\t\tconnected[pkey] = p;\n\t\tdelete notConnected[pkey];\n\t}\n\n\tif (connectionCallback) { connectionCallback(from, to); }\n}\n\nROT.Map.Cellular.prototype._freeSpace = function(x, y, value) {\n\treturn x >= 0 && x < this._width && y >= 0 && y < this._height && this._map[x][y] == value;\n}\n\nROT.Map.Cellular.prototype._pointKey = function(p) {\n\treturn p[0] + \".\" + p[1];\n}\n/**\n * @class Dungeon map: has rooms and corridors\n * @augments ROT.Map\n */\nROT.Map.Dungeon = function(width, height) {\n\tROT.Map.call(this, width, height);\n\tthis._rooms = []; /* list of all rooms */\n\tthis._corridors = [];\n};\nROT.Map.Dungeon.extend(ROT.Map);\n\n/**\n * Get all generated rooms\n * @returns {ROT.Map.Feature.Room[]}\n */\nROT.Map.Dungeon.prototype.getRooms = function() {\n\treturn this._rooms;\n};\n\n/**\n * Get all generated corridors\n * @returns {ROT.Map.Feature.Corridor[]}\n */\nROT.Map.Dungeon.prototype.getCorridors = function() {\n\treturn this._corridors;\n};\n/**\n * @class Random dungeon generator using human-like digging patterns.\n * Heavily based on Mike Anderson's ideas from the \"Tyrant\" algo, mentioned at \n * http://www.roguebasin.roguelikedevelopment.org/index.php?title=Dungeon-Building_Algorithm.\n * @augments ROT.Map.Dungeon\n */\nROT.Map.Digger = function(width, height, options) {\n\tROT.Map.Dungeon.call(this, width, height);\n\t\n\tthis._options = {\n\t\troomWidth: [3, 9], /* room minimum and maximum width */\n\t\troomHeight: [3, 5], /* room minimum and maximum height */\n\t\tcorridorLength: [3, 10], /* corridor minimum and maximum length */\n\t\tdugPercentage: 0.2, /* we stop after this percentage of level area has been dug out */\n\t\ttimeLimit: 1000 /* we stop after this much time has passed (msec) */\n\t};\n\tfor (var p in options) { this._options[p] = options[p]; }\n\t\n\tthis._features = {\n\t\t\"Room\": 4,\n\t\t\"Corridor\": 4\n\t};\n\tthis._featureAttempts = 20; /* how many times do we try to create a feature on a suitable wall */\n\tthis._walls = {}; /* these are available for digging */\n\t\n\tthis._digCallback = this._digCallback.bind(this);\n\tthis._canBeDugCallback = this._canBeDugCallback.bind(this);\n\tthis._isWallCallback = this._isWallCallback.bind(this);\n\tthis._priorityWallCallback = this._priorityWallCallback.bind(this);\n};\nROT.Map.Digger.extend(ROT.Map.Dungeon);\n\n/**\n * Create a map\n * @see ROT.Map#create\n */\nROT.Map.Digger.prototype.create = function(callback) {\n\tthis._rooms = [];\n\tthis._corridors = [];\n\tthis._map = this._fillMap(1);\n\tthis._walls = {};\n\tthis._dug = 0;\n\tvar area = (this._width-2) * (this._height-2);\n\n\tthis._firstRoom();\n\t\n\tvar t1 = Date.now();\n\n\tdo {\n\t\tvar t2 = Date.now();\n\t\tif (t2 - t1 > this._options.timeLimit) { break; }\n\n\t\t/* find a good wall */\n\t\tvar wall = this._findWall();\n\t\tif (!wall) { break; } /* no more walls */\n\t\t\n\t\tvar parts = wall.split(\",\");\n\t\tvar x = parseInt(parts[0]);\n\t\tvar y = parseInt(parts[1]);\n\t\tvar dir = this._getDiggingDirection(x, y);\n\t\tif (!dir) { continue; } /* this wall is not suitable */\n\t\t\n//\t\tconsole.log(\"wall\", x, y);\n\n\t\t/* try adding a feature */\n\t\tvar featureAttempts = 0;\n\t\tdo {\n\t\t\tfeatureAttempts++;\n\t\t\tif (this._tryFeature(x, y, dir[0], dir[1])) { /* feature added */\n\t\t\t\t//if (this._rooms.length + this._corridors.length == 2) { this._rooms[0].addDoor(x, y); } /* first room oficially has doors */\n\t\t\t\tthis._removeSurroundingWalls(x, y);\n\t\t\t\tthis._removeSurroundingWalls(x-dir[0], y-dir[1]);\n\t\t\t\tbreak; \n\t\t\t}\n\t\t} while (featureAttempts < this._featureAttempts);\n\t\t\n\t\tvar priorityWalls = 0;\n\t\tfor (var id in this._walls) { \n\t\t\tif (this._walls[id] > 1) { priorityWalls++; }\n\t\t}\n\n\t} while (this._dug/area < this._options.dugPercentage || priorityWalls); /* fixme number of priority walls */\n\n\tthis._addDoors();\n\n\tif (callback) {\n\t\tfor (var i=0;i<this._width;i++) {\n\t\t\tfor (var j=0;j<this._height;j++) {\n\t\t\t\tcallback(i, j, this._map[i][j]);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tthis._walls = {};\n\tthis._map = null;\n\n\treturn this;\n};\n\nROT.Map.Digger.prototype._digCallback = function(x, y, value) {\n\tif (value == 0 || value == 2) { /* empty */\n\t\tthis._map[x][y] = 0;\n\t\tthis._dug++;\n\t} else { /* wall */\n\t\tthis._walls[x+\",\"+y] = 1;\n\t}\n};\n\nROT.Map.Digger.prototype._isWallCallback = function(x, y) {\n\tif (x < 0 || y < 0 || x >= this._width || y >= this._height) { return false; }\n\treturn (this._map[x][y] == 1);\n};\n\nROT.Map.Digger.prototype._canBeDugCallback = function(x, y) {\n\tif (x < 1 || y < 1 || x+1 >= this._width || y+1 >= this._height) { return false; }\n\treturn (this._map[x][y] == 1);\n};\n\nROT.Map.Digger.prototype._priorityWallCallback = function(x, y) {\n\tthis._walls[x+\",\"+y] = 2;\n};\n\nROT.Map.Digger.prototype._firstRoom = function() {\n\tvar cx = Math.floor(this._width/2);\n\tvar cy = Math.floor(this._height/2);\n\tvar room = ROT.Map.Feature.Room.createRandomCenter(cx, cy, this._options);\n\tthis._rooms.push(room);\n\troom.create(this._digCallback);\n};\n\n/**\n * Get a suitable wall\n */\nROT.Map.Digger.prototype._findWall = function() {\n\tvar prio1 = [];\n\tvar prio2 = [];\n\tfor (var id in this._walls) {\n\t\tvar prio = this._walls[id];\n\t\tif (prio == 2) { \n\t\t\tprio2.push(id); \n\t\t} else {\n\t\t\tprio1.push(id);\n\t\t}\n\t}\n\t\n\tvar arr = (prio2.length ? prio2 : prio1);\n\tif (!arr.length) { return null; } /* no walls :/ */\n\t\n\tvar id = arr.sort().random(); // sort to make the order deterministic\n\tdelete this._walls[id];\n\n\treturn id;\n};\n\n/**\n * Tries adding a feature\n * @returns {bool} was this a successful try?\n */\nROT.Map.Digger.prototype._tryFeature = function(x, y, dx, dy) {\n\tvar feature = ROT.RNG.getWeightedValue(this._features);\n\tfeature = ROT.Map.Feature[feature].createRandomAt(x, y, dx, dy, this._options);\n\t\n\tif (!feature.isValid(this._isWallCallback, this._canBeDugCallback)) {\n//\t\tconsole.log(\"not valid\");\n//\t\tfeature.debug();\n\t\treturn false;\n\t}\n\t\n\tfeature.create(this._digCallback);\n//\tfeature.debug();\n\n\tif (feature instanceof ROT.Map.Feature.Room) { this._rooms.push(feature); }\n\tif (feature instanceof ROT.Map.Feature.Corridor) { \n\t\tfeature.createPriorityWalls(this._priorityWallCallback);\n\t\tthis._corridors.push(feature); \n\t}\n\t\n\treturn true;\n};\n\nROT.Map.Digger.prototype._removeSurroundingWalls = function(cx, cy) {\n\tvar deltas = ROT.DIRS[4];\n\n\tfor (var i=0;i<deltas.length;i++) {\n\t\tvar delta = deltas[i];\n\t\tvar x = cx + delta[0];\n\t\tvar y = cy + delta[1];\n\t\tdelete this._walls[x+\",\"+y];\n\t\tvar x = cx + 2*delta[0];\n\t\tvar y = cy + 2*delta[1];\n\t\tdelete this._walls[x+\",\"+y];\n\t}\n};\n\n/**\n * Returns vector in \"digging\" direction, or false, if this does not exist (or is not unique)\n */\nROT.Map.Digger.prototype._getDiggingDirection = function(cx, cy) {\n\tif (cx <= 0 || cy <= 0 || cx >= this._width - 1 || cy >= this._height - 1) { return null; }\n\n\tvar result = null;\n\tvar deltas = ROT.DIRS[4];\n\t\n\tfor (var i=0;i<deltas.length;i++) {\n\t\tvar delta = deltas[i];\n\t\tvar x = cx + delta[0];\n\t\tvar y = cy + delta[1];\n\t\t\n\t\tif (!this._map[x][y]) { /* there already is another empty neighbor! */\n\t\t\tif (result) { return null; }\n\t\t\tresult = delta;\n\t\t}\n\t}\n\t\n\t/* no empty neighbor */\n\tif (!result) { return null; }\n\t\n\treturn [-result[0], -result[1]];\n};\n\n/**\n * Find empty spaces surrounding rooms, and apply doors.\n */\nROT.Map.Digger.prototype._addDoors = function() {\n\tvar data = this._map;\n\tvar isWallCallback = function(x, y) {\n\t\treturn (data[x][y] == 1);\n\t};\n\tfor (var i = 0; i < this._rooms.length; i++ ) {\n\t\tvar room = this._rooms[i];\n\t\troom.clearDoors();\n\t\troom.addDoors(isWallCallback);\n\t}\n};\n/**\n * @class Dungeon generator which tries to fill the space evenly. Generates independent rooms and tries to connect them.\n * @augments ROT.Map.Dungeon\n */\nROT.Map.Uniform = function(width, height, options) {\n\tROT.Map.Dungeon.call(this, width, height);\n\n\tthis._options = {\n\t\troomWidth: [3, 9], /* room minimum and maximum width */\n\t\troomHeight: [3, 5], /* room minimum and maximum height */\n\t\troomDugPercentage: 0.1, /* we stop after this percentage of level area has been dug out by rooms */\n\t\ttimeLimit: 1000 /* we stop after this much time has passed (msec) */\n\t};\n\tfor (var p in options) { this._options[p] = options[p]; }\n\n\tthis._roomAttempts = 20; /* new room is created N-times until is considered as impossible to generate */\n\tthis._corridorAttempts = 20; /* corridors are tried N-times until the level is considered as impossible to connect */\n\n\tthis._connected = []; /* list of already connected rooms */\n\tthis._unconnected = []; /* list of remaining unconnected rooms */\n\t\n\tthis._digCallback = this._digCallback.bind(this);\n\tthis._canBeDugCallback = this._canBeDugCallback.bind(this);\n\tthis._isWallCallback = this._isWallCallback.bind(this);\n};\nROT.Map.Uniform.extend(ROT.Map.Dungeon);\n\n/**\n * Create a map. If the time limit has been hit, returns null.\n * @see ROT.Map#create\n */\nROT.Map.Uniform.prototype.create = function(callback) {\n\tvar t1 = Date.now();\n\twhile (1) {\n\t\tvar t2 = Date.now();\n\t\tif (t2 - t1 > this._options.timeLimit) { return null; } /* time limit! */\n\t\n\t\tthis._map = this._fillMap(1);\n\t\tthis._dug = 0;\n\t\tthis._rooms = [];\n\t\tthis._unconnected = [];\n\t\tthis._generateRooms();\n\t\tif (this._rooms.length < 2) { continue; }\n\t\tif (this._generateCorridors()) { break; }\n\t}\n\t\n\tif (callback) {\n\t\tfor (var i=0;i<this._width;i++) {\n\t\t\tfor (var j=0;j<this._height;j++) {\n\t\t\t\tcallback(i, j, this._map[i][j]);\n\t\t\t}\n\t\t}\n\t}\n\t\n\treturn this;\n};\n\n/**\n * Generates a suitable amount of rooms\n */\nROT.Map.Uniform.prototype._generateRooms = function() {\n\tvar w = this._width-2;\n\tvar h = this._height-2;\n\n\tdo {\n\t\tvar room = this._generateRoom();\n\t\tif (this._dug/(w*h) > this._options.roomDugPercentage) { break; } /* achieved requested amount of free space */\n\t} while (room);\n\n\t/* either enough rooms, or not able to generate more of them :) */\n};\n\n/**\n * Try to generate one room\n */\nROT.Map.Uniform.prototype._generateRoom = function() {\n\tvar count = 0;\n\twhile (count < this._roomAttempts) {\n\t\tcount++;\n\t\t\n\t\tvar room = ROT.Map.Feature.Room.createRandom(this._width, this._height, this._options);\n\t\tif (!room.isValid(this._isWallCallback, this._canBeDugCallback)) { continue; }\n\t\t\n\t\troom.create(this._digCallback);\n\t\tthis._rooms.push(room);\n\t\treturn room;\n\t} \n\n\t/* no room was generated in a given number of attempts */\n\treturn null;\n};\n\n/**\n * Generates connectors beween rooms\n * @returns {bool} success Was this attempt successfull?\n */\nROT.Map.Uniform.prototype._generateCorridors = function() {\n\tvar cnt = 0;\n\twhile (cnt < this._corridorAttempts) {\n\t\tcnt++;\n\t\tthis._corridors = [];\n\n\t\t/* dig rooms into a clear map */\n\t\tthis._map = this._fillMap(1);\n\t\tfor (var i=0;i<this._rooms.length;i++) { \n\t\t\tvar room = this._rooms[i];\n\t\t\troom.clearDoors();\n\t\t\troom.create(this._digCallback); \n\t\t}\n\n\t\tthis._unconnected = this._rooms.slice().randomize();\n\t\tthis._connected = [];\n\t\tif (this._unconnected.length) { this._connected.push(this._unconnected.pop()); } /* first one is always connected */\n\t\t\n\t\twhile (1) {\n\t\t\t/* 1. pick random connected room */\n\t\t\tvar connected = this._connected.random();\n\t\t\t\n\t\t\t/* 2. find closest unconnected */\n\t\t\tvar room1 = this._closestRoom(this._unconnected, connected);\n\t\t\t\n\t\t\t/* 3. connect it to closest connected */\n\t\t\tvar room2 = this._closestRoom(this._connected, room1);\n\t\t\t\n\t\t\tvar ok = this._connectRooms(room1, room2);\n\t\t\tif (!ok) { break; } /* stop connecting, re-shuffle */\n\t\t\t\n\t\t\tif (!this._unconnected.length) { return true; } /* done; no rooms remain */\n\t\t}\n\t}\n\treturn false;\n};\n\n/**\n * For a given room, find the closest one from the list\n */\nROT.Map.Uniform.prototype._closestRoom = function(rooms, room) {\n\tvar dist = Infinity;\n\tvar center = room.getCenter();\n\tvar result = null;\n\t\n\tfor (var i=0;i<rooms.length;i++) {\n\t\tvar r = rooms[i];\n\t\tvar c = r.getCenter();\n\t\tvar dx = c[0]-center[0];\n\t\tvar dy = c[1]-center[1];\n\t\tvar d = dx*dx+dy*dy;\n\t\t\n\t\tif (d < dist) {\n\t\t\tdist = d;\n\t\t\tresult = r;\n\t\t}\n\t}\n\t\n\treturn result;\n};\n\nROT.Map.Uniform.prototype._connectRooms = function(room1, room2) {\n\t/*\n\t\troom1.debug();\n\t\troom2.debug();\n\t*/\n\n\tvar center1 = room1.getCenter();\n\tvar center2 = room2.getCenter();\n\n\tvar diffX = center2[0] - center1[0];\n\tvar diffY = center2[1] - center1[1];\n\n\tif (Math.abs(diffX) < Math.abs(diffY)) { /* first try connecting north-south walls */\n\t\tvar dirIndex1 = (diffY > 0 ? 2 : 0);\n\t\tvar dirIndex2 = (dirIndex1 + 2) % 4;\n\t\tvar min = room2.getLeft();\n\t\tvar max = room2.getRight();\n\t\tvar index = 0;\n\t} else { /* first try connecting east-west walls */\n\t\tvar dirIndex1 = (diffX > 0 ? 1 : 3);\n\t\tvar dirIndex2 = (dirIndex1 + 2) % 4;\n\t\tvar min = room2.getTop();\n\t\tvar max = room2.getBottom();\n\t\tvar index = 1;\n\t}\n\n\tvar start = this._placeInWall(room1, dirIndex1); /* corridor will start here */\n\tif (!start) { return false; }\n\n\tif (start[index] >= min && start[index] <= max) { /* possible to connect with straight line (I-like) */\n\t\tvar end = start.slice();\n\t\tvar value = null;\n\t\tswitch (dirIndex2) {\n\t\t\tcase 0: value = room2.getTop()-1; break;\n\t\t\tcase 1: value = room2.getRight()+1; break;\n\t\t\tcase 2: value = room2.getBottom()+1; break;\n\t\t\tcase 3: value = room2.getLeft()-1; break;\n\t\t}\n\t\tend[(index+1)%2] = value;\n\t\tthis._digLine([start, end]);\n\t\t\n\t} else if (start[index] < min-1 || start[index] > max+1) { /* need to switch target wall (L-like) */\n\n\t\tvar diff = start[index] - center2[index];\n\t\tswitch (dirIndex2) {\n\t\t\tcase 0:\n\t\t\tcase 1:\tvar rotation = (diff < 0 ? 3 : 1); break;\n\t\t\tcase 2:\n\t\t\tcase 3:\tvar rotation = (diff < 0 ? 1 : 3); break;\n\t\t}\n\t\tdirIndex2 = (dirIndex2 + rotation) % 4;\n\t\t\n\t\tvar end = this._placeInWall(room2, dirIndex2);\n\t\tif (!end) { return false; }\n\n\t\tvar mid = [0, 0];\n\t\tmid[index] = start[index];\n\t\tvar index2 = (index+1)%2;\n\t\tmid[index2] = end[index2];\n\t\tthis._digLine([start, mid, end]);\n\t\t\n\t} else { /* use current wall pair, but adjust the line in the middle (S-like) */\n\t\n\t\tvar index2 = (index+1)%2;\n\t\tvar end = this._placeInWall(room2, dirIndex2);\n\t\tif (!end) { return false; }\n\t\tvar mid = Math.round((end[index2] + start[index2])/2);\n\n\t\tvar mid1 = [0, 0];\n\t\tvar mid2 = [0, 0];\n\t\tmid1[index] = start[index];\n\t\tmid1[index2] = mid;\n\t\tmid2[index] = end[index];\n\t\tmid2[index2] = mid;\n\t\tthis._digLine([start, mid1, mid2, end]);\n\t}\n\n\troom1.addDoor(start[0], start[1]);\n\troom2.addDoor(end[0], end[1]);\n\t\n\tvar index = this._unconnected.indexOf(room1);\n\tif (index != -1) {\n\t\tthis._unconnected.splice(index, 1);\n\t\tthis._connected.push(room1);\n\t}\n\n\tvar index = this._unconnected.indexOf(room2);\n\tif (index != -1) {\n\t\tthis._unconnected.splice(index, 1);\n\t\tthis._connected.push(room2);\n\t}\n\t\n\treturn true;\n};\n\nROT.Map.Uniform.prototype._placeInWall = function(room, dirIndex) {\n\tvar start = [0, 0];\n\tvar dir = [0, 0];\n\tvar length = 0;\n\t\n\tswitch (dirIndex) {\n\t\tcase 0:\n\t\t\tdir = [1, 0];\n\t\t\tstart = [room.getLeft(), room.getTop()-1];\n\t\t\tlength = room.getRight()-room.getLeft()+1;\n\t\tbreak;\n\t\tcase 1:\n\t\t\tdir = [0, 1];\n\t\t\tstart = [room.getRight()+1, room.getTop()];\n\t\t\tlength = room.getBottom()-room.getTop()+1;\n\t\tbreak;\n\t\tcase 2:\n\t\t\tdir = [1, 0];\n\t\t\tstart = [room.getLeft(), room.getBottom()+1];\n\t\t\tlength = room.getRight()-room.getLeft()+1;\n\t\tbreak;\n\t\tcase 3:\n\t\t\tdir = [0, 1];\n\t\t\tstart = [room.getLeft()-1, room.getTop()];\n\t\t\tlength = room.getBottom()-room.getTop()+1;\n\t\tbreak;\n\t}\n\t\n\tvar avail = [];\n\tvar lastBadIndex = -2;\n\n\tfor (var i=0;i<length;i++) {\n\t\tvar x = start[0] + i*dir[0];\n\t\tvar y = start[1] + i*dir[1];\n\t\tavail.push(null);\n\t\t\n\t\tvar isWall = (this._map[x][y] == 1);\n\t\tif (isWall) {\n\t\t\tif (lastBadIndex != i-1) { avail[i] = [x, y]; }\n\t\t} else {\n\t\t\tlastBadIndex = i;\n\t\t\tif (i) { avail[i-1] = null; }\n\t\t}\n\t}\n\t\n\tfor (var i=avail.length-1; i>=0; i--) {\n\t\tif (!avail[i]) { avail.splice(i, 1); }\n\t}\n\treturn (avail.length ? avail.random() : null);\n};\n\n/**\n * Dig a polyline.\n */\nROT.Map.Uniform.prototype._digLine = function(points) {\n\tfor (var i=1;i<points.length;i++) {\n\t\tvar start = points[i-1];\n\t\tvar end = points[i];\n\t\tvar corridor = new ROT.Map.Feature.Corridor(start[0], start[1], end[0], end[1]);\n\t\tcorridor.create(this._digCallback);\n\t\tthis._corridors.push(corridor);\n\t}\n};\n\nROT.Map.Uniform.prototype._digCallback = function(x, y, value) {\n\tthis._map[x][y] = value;\n\tif (value == 0) { this._dug++; }\n};\n\nROT.Map.Uniform.prototype._isWallCallback = function(x, y) {\n\tif (x < 0 || y < 0 || x >= this._width || y >= this._height) { return false; }\n\treturn (this._map[x][y] == 1);\n};\n\nROT.Map.Uniform.prototype._canBeDugCallback = function(x, y) {\n\tif (x < 1 || y < 1 || x+1 >= this._width || y+1 >= this._height) { return false; }\n\treturn (this._map[x][y] == 1);\n};\n\n/**\n * @author hyakugei\n * @class Dungeon generator which uses the \"orginal\" Rogue dungeon generation algorithm. See http://kuoi.com/~kamikaze/GameDesign/art07_rogue_dungeon.php\n * @augments ROT.Map\n * @param {int} [width=ROT.DEFAULT_WIDTH]\n * @param {int} [height=ROT.DEFAULT_HEIGHT]\n * @param {object} [options] Options\n * @param {int[]} [options.cellWidth=3] Number of cells to create on the horizontal (number of rooms horizontally)\n * @param {int[]} [options.cellHeight=3] Number of cells to create on the vertical (number of rooms vertically)\n * @param {int} [options.roomWidth] Room min and max width - normally set auto-magically via the constructor.\n * @param {int} [options.roomHeight] Room min and max height - normally set auto-magically via the constructor.\n */\nROT.Map.Rogue = function (width, height, options) {\n\tROT.Map.call(this, width, height);\n\n\tthis._options = {\n\t\tcellWidth: 3,  // NOTE to self, these could probably work the same as the roomWidth/room Height values\n\t\tcellHeight: 3  //     ie. as an array with min-max values for each direction....\n\t};\n\n\tfor (var p in options) { this._options[p] = options[p]; }\n\n\t/*\n\tSet the room sizes according to the over-all width of the map,\n\tand the cell sizes.\n\t*/\n\tif (!this._options.hasOwnProperty(\"roomWidth\")) {\n\t\tthis._options[\"roomWidth\"] = this._calculateRoomSize(this._width, this._options[\"cellWidth\"]);\n\t}\n\tif (!this._options.hasOwnProperty(\"roomHeight\")) {\n\t\tthis._options[\"roomHeight\"] = this._calculateRoomSize(this._height, this._options[\"cellHeight\"]);\n\t}\n\n};\n\nROT.Map.Rogue.extend(ROT.Map);\n\n/**\n * @see ROT.Map#create\n */\nROT.Map.Rogue.prototype.create = function (callback) {\n\tthis.map = this._fillMap(1);\n\tthis.rooms = [];\n\tthis.connectedCells = [];\n\n\tthis._initRooms();\n\tthis._connectRooms();\n\tthis._connectUnconnectedRooms();\n\tthis._createRandomRoomConnections();\n\tthis._createRooms();\n\tthis._createCorridors();\n\n\tif (callback) {\n\t\tfor (var i = 0; i < this._width; i++) {\n\t\t\tfor (var j = 0; j < this._height; j++) {\n\t\t\t\tcallback(i, j, this.map[i][j]);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn this;\n};\n\nROT.Map.Rogue.prototype._calculateRoomSize = function (size, cell) {\n\tvar max = Math.floor((size/cell) * 0.8);\n\tvar min = Math.floor((size/cell) * 0.25);\n\tif (min < 2) { min = 2; }\n\tif (max < 2) { max = 2; }\n\treturn [min, max];\n};\n\nROT.Map.Rogue.prototype._initRooms = function () {\n\t// create rooms array. This is the \"grid\" list from the algo.\n\tfor (var i = 0; i < this._options.cellWidth; i++) {\n\t\tthis.rooms.push([]);\n\t\tfor(var j = 0; j < this._options.cellHeight; j++) {\n\t\t\tthis.rooms[i].push({\"x\":0, \"y\":0, \"width\":0, \"height\":0, \"connections\":[], \"cellx\":i, \"celly\":j});\n\t\t}\n\t}\n};\n\nROT.Map.Rogue.prototype._connectRooms = function () {\n\t//pick random starting grid\n\tvar cgx = ROT.RNG.getUniformInt(0, this._options.cellWidth-1);\n\tvar cgy = ROT.RNG.getUniformInt(0, this._options.cellHeight-1);\n\n\tvar idx;\n\tvar ncgx;\n\tvar ncgy;\n\n\tvar found = false;\n\tvar room;\n\tvar otherRoom;\n\n\t// find  unconnected neighbour cells\n\tdo {\n\n\t\t//var dirToCheck = [0, 1, 2, 3, 4, 5, 6, 7];\n\t\tvar dirToCheck = [0, 2, 4, 6];\n\t\tdirToCheck = dirToCheck.randomize();\n\n\t\tdo {\n\t\t\tfound = false;\n\t\t\tidx = dirToCheck.pop();\n\n\t\t\tncgx = cgx + ROT.DIRS[8][idx][0];\n\t\t\tncgy = cgy + ROT.DIRS[8][idx][1];\n\n\t\t\tif (ncgx < 0 || ncgx >= this._options.cellWidth) { continue; }\n\t\t\tif (ncgy < 0 || ncgy >= this._options.cellHeight) { continue; }\n\n\t\t\troom = this.rooms[cgx][cgy];\n\n\t\t\tif (room[\"connections\"].length > 0) {\n\t\t\t\t// as long as this room doesn't already coonect to me, we are ok with it.\n\t\t\t\tif (room[\"connections\"][0][0] == ncgx && room[\"connections\"][0][1] == ncgy) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\totherRoom = this.rooms[ncgx][ncgy];\n\n\t\t\tif (otherRoom[\"connections\"].length == 0) {\n\t\t\t\totherRoom[\"connections\"].push([cgx, cgy]);\n\n\t\t\t\tthis.connectedCells.push([ncgx, ncgy]);\n\t\t\t\tcgx = ncgx;\n\t\t\t\tcgy = ncgy;\n\t\t\t\tfound = true;\n\t\t\t}\n\n\t\t} while (dirToCheck.length > 0 && found == false);\n\n\t} while (dirToCheck.length > 0);\n\n};\n\nROT.Map.Rogue.prototype._connectUnconnectedRooms = function () {\n\t//While there are unconnected rooms, try to connect them to a random connected neighbor\n\t//(if a room has no connected neighbors yet, just keep cycling, you'll fill out to it eventually).\n\tvar cw = this._options.cellWidth;\n\tvar ch = this._options.cellHeight;\n\n\tthis.connectedCells = this.connectedCells.randomize();\n\tvar room;\n\tvar otherRoom;\n\tvar validRoom;\n\n\tfor (var i = 0; i < this._options.cellWidth; i++) {\n\t\tfor (var j = 0; j < this._options.cellHeight; j++)  {\n\n\t\t\troom = this.rooms[i][j];\n\n\t\t\tif (room[\"connections\"].length == 0) {\n\t\t\t\tvar directions = [0, 2, 4, 6];\n\t\t\t\tdirections = directions.randomize();\n\n\t\t\t\tvalidRoom = false;\n\n\t\t\t\tdo {\n\n\t\t\t\t\tvar dirIdx = directions.pop();\n\t\t\t\t\tvar newI = i + ROT.DIRS[8][dirIdx][0];\n\t\t\t\t\tvar newJ = j + ROT.DIRS[8][dirIdx][1];\n\n\t\t\t\t\tif (newI < 0 || newI >= cw || newJ < 0 || newJ >= ch) { continue; }\n\n\t\t\t\t\totherRoom = this.rooms[newI][newJ];\n\n\t\t\t\t\tvalidRoom = true;\n\n\t\t\t\t\tif (otherRoom[\"connections\"].length == 0) { break; }\n\n\t\t\t\t\tfor (var k = 0; k < otherRoom[\"connections\"].length; k++) {\n\t\t\t\t\t\tif (otherRoom[\"connections\"][k][0] == i && otherRoom[\"connections\"][k][1] == j) {\n\t\t\t\t\t\t\tvalidRoom = false;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (validRoom) { break; }\n\n\t\t\t\t} while (directions.length);\n\n\t\t\t\tif (validRoom) {\n\t\t\t\t\troom[\"connections\"].push([otherRoom[\"cellx\"], otherRoom[\"celly\"]]);\n\t\t\t\t} else {\n\t\t\t\t\tconsole.log(\"-- Unable to connect room.\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n};\n\nROT.Map.Rogue.prototype._createRandomRoomConnections = function (connections) {\n\t// Empty for now.\n};\n\n\nROT.Map.Rogue.prototype._createRooms = function () {\n\t// Create Rooms\n\n\tvar w = this._width;\n\tvar h = this._height;\n\n\tvar cw = this._options.cellWidth;\n\tvar ch = this._options.cellHeight;\n\n\tvar cwp = Math.floor(this._width / cw);\n\tvar chp = Math.floor(this._height / ch);\n\n\tvar roomw;\n\tvar roomh;\n\tvar roomWidth = this._options[\"roomWidth\"];\n\tvar roomHeight = this._options[\"roomHeight\"];\n\tvar sx;\n\tvar sy;\n\tvar otherRoom;\n\n\tfor (var i = 0; i < cw; i++) {\n\t\tfor (var j = 0; j < ch; j++) {\n\t\t\tsx = cwp * i;\n\t\t\tsy = chp * j;\n\n\t\t\tif (sx == 0) { sx = 1; }\n\t\t\tif (sy == 0) { sy = 1; }\n\n\t\t\troomw = ROT.RNG.getUniformInt(roomWidth[0], roomWidth[1]);\n\t\t\troomh = ROT.RNG.getUniformInt(roomHeight[0], roomHeight[1]);\n\n\t\t\tif (j > 0) {\n\t\t\t\totherRoom = this.rooms[i][j-1];\n\t\t\t\twhile (sy - (otherRoom[\"y\"] + otherRoom[\"height\"] ) < 3) {\n\t\t\t\t\tsy++;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (i > 0) {\n\t\t\t\totherRoom = this.rooms[i-1][j];\n\t\t\t\twhile(sx - (otherRoom[\"x\"] + otherRoom[\"width\"]) < 3) {\n\t\t\t\t\tsx++;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar sxOffset = Math.round(ROT.RNG.getUniformInt(0, cwp-roomw)/2);\n\t\t\tvar syOffset = Math.round(ROT.RNG.getUniformInt(0, chp-roomh)/2);\n\n\t\t\twhile (sx + sxOffset + roomw >= w) {\n\t\t\t\tif(sxOffset) {\n\t\t\t\t\tsxOffset--;\n\t\t\t\t} else {\n\t\t\t\t\troomw--;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\twhile (sy + syOffset + roomh >= h) {\n\t\t\t\tif(syOffset) {\n\t\t\t\t\tsyOffset--;\n\t\t\t\t} else {\n\t\t\t\t\troomh--;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tsx = sx + sxOffset;\n\t\t\tsy = sy + syOffset;\n\n\t\t\tthis.rooms[i][j][\"x\"] = sx;\n\t\t\tthis.rooms[i][j][\"y\"] = sy;\n\t\t\tthis.rooms[i][j][\"width\"] = roomw;\n\t\t\tthis.rooms[i][j][\"height\"] = roomh;\n\n\t\t\tfor (var ii = sx; ii < sx + roomw; ii++) {\n\t\t\t\tfor (var jj = sy; jj < sy + roomh; jj++) {\n\t\t\t\t\tthis.map[ii][jj] = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n};\n\nROT.Map.Rogue.prototype._getWallPosition = function (aRoom, aDirection) {\n\tvar rx;\n\tvar ry;\n\tvar door;\n\n\tif (aDirection == 1 || aDirection == 3) {\n\t\trx = ROT.RNG.getUniformInt(aRoom[\"x\"] + 1, aRoom[\"x\"] + aRoom[\"width\"] - 2);\n\t\tif (aDirection == 1) {\n\t\t\try = aRoom[\"y\"] - 2;\n\t\t\tdoor = ry + 1;\n\t\t} else {\n\t\t\try = aRoom[\"y\"] + aRoom[\"height\"] + 1;\n\t\t\tdoor = ry -1;\n\t\t}\n\n\t\tthis.map[rx][door] = 0; // i'm not setting a specific 'door' tile value right now, just empty space.\n\n\t} else if (aDirection == 2 || aDirection == 4) {\n\t\try = ROT.RNG.getUniformInt(aRoom[\"y\"] + 1, aRoom[\"y\"] + aRoom[\"height\"] - 2);\n\t\tif(aDirection == 2) {\n\t\t\trx = aRoom[\"x\"] + aRoom[\"width\"] + 1;\n\t\t\tdoor = rx - 1;\n\t\t} else {\n\t\t\trx = aRoom[\"x\"] - 2;\n\t\t\tdoor = rx + 1;\n\t\t}\n\n\t\tthis.map[door][ry] = 0; // i'm not setting a specific 'door' tile value right now, just empty space.\n\n\t}\n\treturn [rx, ry];\n};\n\n/***\n* @param startPosition a 2 element array\n* @param endPosition a 2 element array\n*/\nROT.Map.Rogue.prototype._drawCorridor = function (startPosition, endPosition) {\n\tvar xOffset = endPosition[0] - startPosition[0];\n\tvar yOffset = endPosition[1] - startPosition[1];\n\n\tvar xpos = startPosition[0];\n\tvar ypos = startPosition[1];\n\n\tvar tempDist;\n\tvar xDir;\n\tvar yDir;\n\n\tvar move; // 2 element array, element 0 is the direction, element 1 is the total value to move.\n\tvar moves = []; // a list of 2 element arrays\n\n\tvar xAbs = Math.abs(xOffset);\n\tvar yAbs = Math.abs(yOffset);\n\n\tvar percent = ROT.RNG.getUniform(); // used to split the move at different places along the long axis\n\tvar firstHalf = percent;\n\tvar secondHalf = 1 - percent;\n\n\txDir = xOffset > 0 ? 2 : 6;\n\tyDir = yOffset > 0 ? 4 : 0;\n\n\tif (xAbs < yAbs) {\n\t\t// move firstHalf of the y offset\n\t\ttempDist = Math.ceil(yAbs * firstHalf);\n\t\tmoves.push([yDir, tempDist]);\n\t\t// move all the x offset\n\t\tmoves.push([xDir, xAbs]);\n\t\t// move sendHalf of the  y offset\n\t\ttempDist = Math.floor(yAbs * secondHalf);\n\t\tmoves.push([yDir, tempDist]);\n\t} else {\n\t\t//  move firstHalf of the x offset\n\t\ttempDist = Math.ceil(xAbs * firstHalf);\n\t\tmoves.push([xDir, tempDist]);\n\t\t// move all the y offset\n\t\tmoves.push([yDir, yAbs]);\n\t\t// move secondHalf of the x offset.\n\t\ttempDist = Math.floor(xAbs * secondHalf);\n\t\tmoves.push([xDir, tempDist]);\n\t}\n\n\tthis.map[xpos][ypos] = 0;\n\n\twhile (moves.length > 0) {\n\t\tmove = moves.pop();\n\t\twhile (move[1] > 0) {\n\t\t\txpos += ROT.DIRS[8][move[0]][0];\n\t\t\typos += ROT.DIRS[8][move[0]][1];\n\t\t\tthis.map[xpos][ypos] = 0;\n\t\t\tmove[1] = move[1] - 1;\n\t\t}\n\t}\n};\n\nROT.Map.Rogue.prototype._createCorridors = function () {\n\t// Draw Corridors between connected rooms\n\n\tvar cw = this._options.cellWidth;\n\tvar ch = this._options.cellHeight;\n\tvar room;\n\tvar connection;\n\tvar otherRoom;\n\tvar wall;\n\tvar otherWall;\n\n\tfor (var i = 0; i < cw; i++) {\n\t\tfor (var j = 0; j < ch; j++) {\n\t\t\troom = this.rooms[i][j];\n\n\t\t\tfor (var k = 0; k < room[\"connections\"].length; k++) {\n\n\t\t\t\tconnection = room[\"connections\"][k];\n\n\t\t\t\totherRoom = this.rooms[connection[0]][connection[1]];\n\n\t\t\t\t// figure out what wall our corridor will start one.\n\t\t\t\t// figure out what wall our corridor will end on.\n\t\t\t\tif (otherRoom[\"cellx\"] > room[\"cellx\"]) {\n\t\t\t\t\twall = 2;\n\t\t\t\t\totherWall = 4;\n\t\t\t\t} else if (otherRoom[\"cellx\"] < room[\"cellx\"]) {\n\t\t\t\t\twall = 4;\n\t\t\t\t\totherWall = 2;\n\t\t\t\t} else if(otherRoom[\"celly\"] > room[\"celly\"]) {\n\t\t\t\t\twall = 3;\n\t\t\t\t\totherWall = 1;\n\t\t\t\t} else if(otherRoom[\"celly\"] < room[\"celly\"]) {\n\t\t\t\t\twall = 1;\n\t\t\t\t\totherWall = 3;\n\t\t\t\t}\n\n\t\t\t\tthis._drawCorridor(this._getWallPosition(room, wall), this._getWallPosition(otherRoom, otherWall));\n\t\t\t}\n\t\t}\n\t}\n};\n/**\n * @class Dungeon feature; has own .create() method\n */\nROT.Map.Feature = function() {};\nROT.Map.Feature.prototype.isValid = function(canBeDugCallback) {};\nROT.Map.Feature.prototype.create = function(digCallback) {};\nROT.Map.Feature.prototype.debug = function() {};\nROT.Map.Feature.createRandomAt = function(x, y, dx, dy, options) {};\n\n/**\n * @class Room\n * @augments ROT.Map.Feature\n * @param {int} x1\n * @param {int} y1\n * @param {int} x2\n * @param {int} y2\n * @param {int} [doorX]\n * @param {int} [doorY]\n */\nROT.Map.Feature.Room = function(x1, y1, x2, y2, doorX, doorY) {\n\tthis._x1 = x1;\n\tthis._y1 = y1;\n\tthis._x2 = x2;\n\tthis._y2 = y2;\n\tthis._doors = {};\n\tif (arguments.length > 4) { this.addDoor(doorX, doorY); }\n};\nROT.Map.Feature.Room.extend(ROT.Map.Feature);\n\n/**\n * Room of random size, with a given doors and direction\n */\nROT.Map.Feature.Room.createRandomAt = function(x, y, dx, dy, options) {\n\tvar min = options.roomWidth[0];\n\tvar max = options.roomWidth[1];\n\tvar width = ROT.RNG.getUniformInt(min, max);\n\t\n\tvar min = options.roomHeight[0];\n\tvar max = options.roomHeight[1];\n\tvar height = ROT.RNG.getUniformInt(min, max);\n\t\n\tif (dx == 1) { /* to the right */\n\t\tvar y2 = y - Math.floor(ROT.RNG.getUniform() * height);\n\t\treturn new this(x+1, y2, x+width, y2+height-1, x, y);\n\t}\n\t\n\tif (dx == -1) { /* to the left */\n\t\tvar y2 = y - Math.floor(ROT.RNG.getUniform() * height);\n\t\treturn new this(x-width, y2, x-1, y2+height-1, x, y);\n\t}\n\n\tif (dy == 1) { /* to the bottom */\n\t\tvar x2 = x - Math.floor(ROT.RNG.getUniform() * width);\n\t\treturn new this(x2, y+1, x2+width-1, y+height, x, y);\n\t}\n\n\tif (dy == -1) { /* to the top */\n\t\tvar x2 = x - Math.floor(ROT.RNG.getUniform() * width);\n\t\treturn new this(x2, y-height, x2+width-1, y-1, x, y);\n\t}\n\n        throw new Error(\"dx or dy must be 1 or -1\");\n};\n\n/**\n * Room of random size, positioned around center coords\n */\nROT.Map.Feature.Room.createRandomCenter = function(cx, cy, options) {\n\tvar min = options.roomWidth[0];\n\tvar max = options.roomWidth[1];\n\tvar width = ROT.RNG.getUniformInt(min, max);\n\t\n\tvar min = options.roomHeight[0];\n\tvar max = options.roomHeight[1];\n\tvar height = ROT.RNG.getUniformInt(min, max);\n\n\tvar x1 = cx - Math.floor(ROT.RNG.getUniform()*width);\n\tvar y1 = cy - Math.floor(ROT.RNG.getUniform()*height);\n\tvar x2 = x1 + width - 1;\n\tvar y2 = y1 + height - 1;\n\n\treturn new this(x1, y1, x2, y2);\n};\n\n/**\n * Room of random size within a given dimensions\n */\nROT.Map.Feature.Room.createRandom = function(availWidth, availHeight, options) {\n\tvar min = options.roomWidth[0];\n\tvar max = options.roomWidth[1];\n\tvar width = ROT.RNG.getUniformInt(min, max);\n\t\n\tvar min = options.roomHeight[0];\n\tvar max = options.roomHeight[1];\n\tvar height = ROT.RNG.getUniformInt(min, max);\n\t\n\tvar left = availWidth - width - 1;\n\tvar top = availHeight - height - 1;\n\n\tvar x1 = 1 + Math.floor(ROT.RNG.getUniform()*left);\n\tvar y1 = 1 + Math.floor(ROT.RNG.getUniform()*top);\n\tvar x2 = x1 + width - 1;\n\tvar y2 = y1 + height - 1;\n\n\treturn new this(x1, y1, x2, y2);\n};\n\nROT.Map.Feature.Room.prototype.addDoor = function(x, y) {\n\tthis._doors[x+\",\"+y] = 1;\n\treturn this;\n};\n\n/**\n * @param {function}\n */\nROT.Map.Feature.Room.prototype.getDoors = function(callback) {\n\tfor (var key in this._doors) {\n\t\tvar parts = key.split(\",\");\n\t\tcallback(parseInt(parts[0]), parseInt(parts[1]));\n\t}\n\treturn this;\n};\n\nROT.Map.Feature.Room.prototype.clearDoors = function() {\n\tthis._doors = {};\n\treturn this;\n};\n\nROT.Map.Feature.Room.prototype.addDoors = function(isWallCallback) {\n\tvar left = this._x1-1;\n\tvar right = this._x2+1;\n\tvar top = this._y1-1;\n\tvar bottom = this._y2+1;\n\n\tfor (var x=left; x<=right; x++) {\n\t\tfor (var y=top; y<=bottom; y++) {\n\t\t\tif (x != left && x != right && y != top && y != bottom) { continue; }\n\t\t\tif (isWallCallback(x, y)) { continue; }\n\n\t\t\tthis.addDoor(x, y);\n\t\t}\n\t}\n\n\treturn this;\n};\n\nROT.Map.Feature.Room.prototype.debug = function() {\n\tconsole.log(\"room\", this._x1, this._y1, this._x2, this._y2);\n};\n\nROT.Map.Feature.Room.prototype.isValid = function(isWallCallback, canBeDugCallback) { \n\tvar left = this._x1-1;\n\tvar right = this._x2+1;\n\tvar top = this._y1-1;\n\tvar bottom = this._y2+1;\n\t\n\tfor (var x=left; x<=right; x++) {\n\t\tfor (var y=top; y<=bottom; y++) {\n\t\t\tif (x == left || x == right || y == top || y == bottom) {\n\t\t\t\tif (!isWallCallback(x, y)) { return false; }\n\t\t\t} else {\n\t\t\t\tif (!canBeDugCallback(x, y)) { return false; }\n\t\t\t}\n\t\t}\n\t}\n\n\treturn true;\n};\n\n/**\n * @param {function} digCallback Dig callback with a signature (x, y, value). Values: 0 = empty, 1 = wall, 2 = door. Multiple doors are allowed.\n */\nROT.Map.Feature.Room.prototype.create = function(digCallback) { \n\tvar left = this._x1-1;\n\tvar right = this._x2+1;\n\tvar top = this._y1-1;\n\tvar bottom = this._y2+1;\n\t\n\tvar value = 0;\n\tfor (var x=left; x<=right; x++) {\n\t\tfor (var y=top; y<=bottom; y++) {\n\t\t\tif (x+\",\"+y in this._doors) {\n\t\t\t\tvalue = 2;\n\t\t\t} else if (x == left || x == right || y == top || y == bottom) {\n\t\t\t\tvalue = 1;\n\t\t\t} else {\n\t\t\t\tvalue = 0;\n\t\t\t}\n\t\t\tdigCallback(x, y, value);\n\t\t}\n\t}\n};\n\nROT.Map.Feature.Room.prototype.getCenter = function() {\n\treturn [Math.round((this._x1 + this._x2)/2), Math.round((this._y1 + this._y2)/2)];\n};\n\nROT.Map.Feature.Room.prototype.getLeft = function() {\n\treturn this._x1;\n};\n\nROT.Map.Feature.Room.prototype.getRight = function() {\n\treturn this._x2;\n};\n\nROT.Map.Feature.Room.prototype.getTop = function() {\n\treturn this._y1;\n};\n\nROT.Map.Feature.Room.prototype.getBottom = function() {\n\treturn this._y2;\n};\n\n/**\n * @class Corridor\n * @augments ROT.Map.Feature\n * @param {int} startX\n * @param {int} startY\n * @param {int} endX\n * @param {int} endY\n */\nROT.Map.Feature.Corridor = function(startX, startY, endX, endY) {\n\tthis._startX = startX;\n\tthis._startY = startY;\n\tthis._endX = endX; \n\tthis._endY = endY;\n\tthis._endsWithAWall = true;\n};\nROT.Map.Feature.Corridor.extend(ROT.Map.Feature);\n\nROT.Map.Feature.Corridor.createRandomAt = function(x, y, dx, dy, options) {\n\tvar min = options.corridorLength[0];\n\tvar max = options.corridorLength[1];\n\tvar length = ROT.RNG.getUniformInt(min, max);\n\t\n\treturn new this(x, y, x + dx*length, y + dy*length);\n};\n\nROT.Map.Feature.Corridor.prototype.debug = function() {\n\tconsole.log(\"corridor\", this._startX, this._startY, this._endX, this._endY);\n};\n\nROT.Map.Feature.Corridor.prototype.isValid = function(isWallCallback, canBeDugCallback){ \n\tvar sx = this._startX;\n\tvar sy = this._startY;\n\tvar dx = this._endX-sx;\n\tvar dy = this._endY-sy;\n\tvar length = 1 + Math.max(Math.abs(dx), Math.abs(dy));\n\t\n\tif (dx) { dx = dx/Math.abs(dx); }\n\tif (dy) { dy = dy/Math.abs(dy); }\n\tvar nx = dy;\n\tvar ny = -dx;\n\t\n\tvar ok = true;\n\tfor (var i=0; i<length; i++) {\n\t\tvar x = sx + i*dx;\n\t\tvar y = sy + i*dy;\n\n\t\tif (!canBeDugCallback(     x,      y)) { ok = false; }\n\t\tif (!isWallCallback  (x + nx, y + ny)) { ok = false; }\n\t\tif (!isWallCallback  (x - nx, y - ny)) { ok = false; }\n\t\t\n\t\tif (!ok) {\n\t\t\tlength = i;\n\t\t\tthis._endX = x-dx;\n\t\t\tthis._endY = y-dy;\n\t\t\tbreak;\n\t\t}\n\t}\n\t\n\t/**\n\t * If the length degenerated, this corridor might be invalid\n\t */\n\t \n\t/* not supported */\n\tif (length == 0) { return false; } \n\t\n\t /* length 1 allowed only if the next space is empty */\n\tif (length == 1 && isWallCallback(this._endX + dx, this._endY + dy)) { return false; }\n\t\n\t/**\n\t * We do not want the corridor to crash into a corner of a room;\n\t * if any of the ending corners is empty, the N+1th cell of this corridor must be empty too.\n\t * \n\t * Situation:\n\t * #######1\n\t * .......?\n\t * #######2\n\t * \n\t * The corridor was dug from left to right.\n\t * 1, 2 - problematic corners, ? = N+1th cell (not dug)\n\t */\n\tvar firstCornerBad = !isWallCallback(this._endX + dx + nx, this._endY + dy + ny);\n\tvar secondCornerBad = !isWallCallback(this._endX + dx - nx, this._endY + dy - ny);\n\tthis._endsWithAWall = isWallCallback(this._endX + dx, this._endY + dy);\n\tif ((firstCornerBad || secondCornerBad) && this._endsWithAWall) { return false; }\n\n\treturn true;\n};\n\n/**\n * @param {function} digCallback Dig callback with a signature (x, y, value). Values: 0 = empty.\n */\nROT.Map.Feature.Corridor.prototype.create = function(digCallback) { \n\tvar sx = this._startX;\n\tvar sy = this._startY;\n\tvar dx = this._endX-sx;\n\tvar dy = this._endY-sy;\n\tvar length = 1+Math.max(Math.abs(dx), Math.abs(dy));\n\t\n\tif (dx) { dx = dx/Math.abs(dx); }\n\tif (dy) { dy = dy/Math.abs(dy); }\n\tvar nx = dy;\n\tvar ny = -dx;\n\t\n\tfor (var i=0; i<length; i++) {\n\t\tvar x = sx + i*dx;\n\t\tvar y = sy + i*dy;\n\t\tdigCallback(x, y, 0);\n\t}\n\t\n\treturn true;\n};\n\nROT.Map.Feature.Corridor.prototype.createPriorityWalls = function(priorityWallCallback) {\n\tif (!this._endsWithAWall) { return; }\n\n\tvar sx = this._startX;\n\tvar sy = this._startY;\n\n\tvar dx = this._endX-sx;\n\tvar dy = this._endY-sy;\n\tif (dx) { dx = dx/Math.abs(dx); }\n\tif (dy) { dy = dy/Math.abs(dy); }\n\tvar nx = dy;\n\tvar ny = -dx;\n\n\tpriorityWallCallback(this._endX + dx, this._endY + dy);\n\tpriorityWallCallback(this._endX + nx, this._endY + ny);\n\tpriorityWallCallback(this._endX - nx, this._endY - ny);\n};\n/**\n * @class Base noise generator\n */\nROT.Noise = function() {\n};\n\nROT.Noise.prototype.get = function(x, y) {};\n/**\n * A simple 2d implementation of simplex noise by Ondrej Zara\n *\n * Based on a speed-improved simplex noise algorithm for 2D, 3D and 4D in Java.\n * Which is based on example code by Stefan Gustavson (stegu@itn.liu.se).\n * With Optimisations by Peter Eastman (peastman@drizzle.stanford.edu).\n * Better rank ordering method by Stefan Gustavson in 2012.\n */\n\n/**\n * @class 2D simplex noise generator\n * @param {int} [gradients=256] Random gradients\n */\nROT.Noise.Simplex = function(gradients) {\n\tROT.Noise.call(this);\n\n\tthis._F2 = 0.5 * (Math.sqrt(3) - 1);\n\tthis._G2 = (3 - Math.sqrt(3)) / 6;\n\n\tthis._gradients = [\n\t\t[ 0, -1],\n\t\t[ 1, -1],\n\t\t[ 1,  0],\n\t\t[ 1,  1],\n\t\t[ 0,  1],\n\t\t[-1,  1],\n\t\t[-1,  0],\n\t\t[-1, -1]\n\t];\n\n\tvar permutations = [];\n\tvar count = gradients || 256;\n\tfor (var i=0;i<count;i++) { permutations.push(i); }\n\tpermutations = permutations.randomize();\n\n\tthis._perms = [];\n\tthis._indexes = [];\n\n\tfor (var i=0;i<2*count;i++) {\n\t\tthis._perms.push(permutations[i % count]);\n\t\tthis._indexes.push(this._perms[i] % this._gradients.length);\n\t}\n\n};\nROT.Noise.Simplex.extend(ROT.Noise);\n\nROT.Noise.Simplex.prototype.get = function(xin, yin) {\n\tvar perms = this._perms;\n\tvar indexes = this._indexes;\n\tvar count = perms.length/2;\n\tvar G2 = this._G2;\n\n\tvar n0 =0, n1 = 0, n2 = 0, gi; // Noise contributions from the three corners\n\n\t// Skew the input space to determine which simplex cell we're in\n\tvar s = (xin + yin) * this._F2; // Hairy factor for 2D\n\tvar i = Math.floor(xin + s);\n\tvar j = Math.floor(yin + s);\n\tvar t = (i + j) * G2;\n\tvar X0 = i - t; // Unskew the cell origin back to (x,y) space\n\tvar Y0 = j - t;\n\tvar x0 = xin - X0; // The x,y distances from the cell origin\n\tvar y0 = yin - Y0;\n\n\t// For the 2D case, the simplex shape is an equilateral triangle.\n\t// Determine which simplex we are in.\n\tvar i1, j1; // Offsets for second (middle) corner of simplex in (i,j) coords\n\tif (x0 > y0) {\n\t\ti1 = 1;\n\t\tj1 = 0;\n\t} else { // lower triangle, XY order: (0,0)->(1,0)->(1,1)\n\t\ti1 = 0;\n\t\tj1 = 1;\n\t} // upper triangle, YX order: (0,0)->(0,1)->(1,1)\n\n\t// A step of (1,0) in (i,j) means a step of (1-c,-c) in (x,y), and\n\t// a step of (0,1) in (i,j) means a step of (-c,1-c) in (x,y), where\n\t// c = (3-sqrt(3))/6\n\tvar x1 = x0 - i1 + G2; // Offsets for middle corner in (x,y) unskewed coords\n\tvar y1 = y0 - j1 + G2;\n\tvar x2 = x0 - 1 + 2*G2; // Offsets for last corner in (x,y) unskewed coords\n\tvar y2 = y0 - 1 + 2*G2;\n\n\t// Work out the hashed gradient indices of the three simplex corners\n\tvar ii = i.mod(count);\n\tvar jj = j.mod(count);\n\n\t// Calculate the contribution from the three corners\n\tvar t0 = 0.5 - x0*x0 - y0*y0;\n\tif (t0 >= 0) {\n\t\tt0 *= t0;\n\t\tgi = indexes[ii+perms[jj]];\n\t\tvar grad = this._gradients[gi];\n\t\tn0 = t0 * t0 * (grad[0] * x0 + grad[1] * y0);\n\t}\n\t\n\tvar t1 = 0.5 - x1*x1 - y1*y1;\n\tif (t1 >= 0) {\n\t\tt1 *= t1;\n\t\tgi = indexes[ii+i1+perms[jj+j1]];\n\t\tvar grad = this._gradients[gi];\n\t\tn1 = t1 * t1 * (grad[0] * x1 + grad[1] * y1);\n\t}\n\t\n\tvar t2 = 0.5 - x2*x2 - y2*y2;\n\tif (t2 >= 0) {\n\t\tt2 *= t2;\n\t\tgi = indexes[ii+1+perms[jj+1]];\n\t\tvar grad = this._gradients[gi];\n\t\tn2 = t2 * t2 * (grad[0] * x2 + grad[1] * y2);\n\t}\n\n\t// Add contributions from each corner to get the final noise value.\n\t// The result is scaled to return values in the interval [-1,1].\n\treturn 70 * (n0 + n1 + n2);\n}\n/**\n * @class Abstract FOV algorithm\n * @param {function} lightPassesCallback Does the light pass through x,y?\n * @param {object} [options]\n * @param {int} [options.topology=8] 4/6/8\n */\nROT.FOV = function(lightPassesCallback, options) {\n\tthis._lightPasses = lightPassesCallback;\n\tthis._options = {\n\t\ttopology: 8\n\t};\n\tfor (var p in options) { this._options[p] = options[p]; }\n};\n\n/**\n * Compute visibility for a 360-degree circle\n * @param {int} x\n * @param {int} y\n * @param {int} R Maximum visibility radius\n * @param {function} callback\n */\nROT.FOV.prototype.compute = function(x, y, R, callback) {};\n\n/**\n * Return all neighbors in a concentric ring\n * @param {int} cx center-x\n * @param {int} cy center-y\n * @param {int} r range\n */\nROT.FOV.prototype._getCircle = function(cx, cy, r) {\n\tvar result = [];\n\tvar dirs, countFactor, startOffset;\n\n\tswitch (this._options.topology) {\n\t\tcase 4:\n\t\t\tcountFactor = 1;\n\t\t\tstartOffset = [0, 1];\n\t\t\tdirs = [\n\t\t\t\tROT.DIRS[8][7],\n\t\t\t\tROT.DIRS[8][1],\n\t\t\t\tROT.DIRS[8][3],\n\t\t\t\tROT.DIRS[8][5]\n\t\t\t];\n\t\tbreak;\n\n\t\tcase 6:\n\t\t\tdirs = ROT.DIRS[6];\n\t\t\tcountFactor = 1;\n\t\t\tstartOffset = [-1, 1];\n\t\tbreak;\n\n\t\tcase 8:\n\t\t\tdirs = ROT.DIRS[4];\n\t\t\tcountFactor = 2;\n\t\t\tstartOffset = [-1, 1];\n\t\tbreak;\n\t}\n\n\t/* starting neighbor */\n\tvar x = cx + startOffset[0]*r;\n\tvar y = cy + startOffset[1]*r;\n\n\t/* circle */\n\tfor (var i=0;i<dirs.length;i++) {\n\t\tfor (var j=0;j<r*countFactor;j++) {\n\t\t\tresult.push([x, y]);\n\t\t\tx += dirs[i][0];\n\t\t\ty += dirs[i][1];\n\n\t\t}\n\t}\n\n\treturn result;\n};\n/**\n * @class Discrete shadowcasting algorithm. Obsoleted by Precise shadowcasting.\n * @augments ROT.FOV\n */\nROT.FOV.DiscreteShadowcasting = function(lightPassesCallback, options) {\n\tROT.FOV.call(this, lightPassesCallback, options);\n};\nROT.FOV.DiscreteShadowcasting.extend(ROT.FOV);\n\n/**\n * @see ROT.FOV#compute\n */\nROT.FOV.DiscreteShadowcasting.prototype.compute = function(x, y, R, callback) {\n\tvar center = this._coords;\n\tvar map = this._map;\n\n\t/* this place is always visible */\n\tcallback(x, y, 0, 1);\n\n\t/* standing in a dark place. FIXME is this a good idea?  */\n\tif (!this._lightPasses(x, y)) { return; }\n\t\n\t/* start and end angles */\n\tvar DATA = [];\n\t\n\tvar A, B, cx, cy, blocks;\n\n\t/* analyze surrounding cells in concentric rings, starting from the center */\n\tfor (var r=1; r<=R; r++) {\n\t\tvar neighbors = this._getCircle(x, y, r);\n\t\tvar angle = 360 / neighbors.length;\n\n\t\tfor (var i=0;i<neighbors.length;i++) {\n\t\t\tcx = neighbors[i][0];\n\t\t\tcy = neighbors[i][1];\n\t\t\tA = angle * (i - 0.5);\n\t\t\tB = A + angle;\n\t\t\t\n\t\t\tblocks = !this._lightPasses(cx, cy);\n\t\t\tif (this._visibleCoords(Math.floor(A), Math.ceil(B), blocks, DATA)) { callback(cx, cy, r, 1); }\n\t\t\t\n\t\t\tif (DATA.length == 2 && DATA[0] == 0 && DATA[1] == 360) { return; } /* cutoff? */\n\n\t\t} /* for all cells in this ring */\n\t} /* for all rings */\n};\n\n/**\n * @param {int} A start angle\n * @param {int} B end angle\n * @param {bool} blocks Does current cell block visibility?\n * @param {int[][]} DATA shadowed angle pairs\n */\nROT.FOV.DiscreteShadowcasting.prototype._visibleCoords = function(A, B, blocks, DATA) {\n\tif (A < 0) { \n\t\tvar v1 = this._visibleCoords(0, B, blocks, DATA);\n\t\tvar v2 = this._visibleCoords(360+A, 360, blocks, DATA);\n\t\treturn v1 || v2;\n\t}\n\t\n\tvar index = 0;\n\twhile (index < DATA.length && DATA[index] < A) { index++; }\n\t\n\tif (index == DATA.length) { /* completely new shadow */\n\t\tif (blocks) { DATA.push(A, B); } \n\t\treturn true;\n\t}\n\t\n\tvar count = 0;\n\t\n\tif (index % 2) { /* this shadow starts in an existing shadow, or within its ending boundary */\n\t\twhile (index < DATA.length && DATA[index] < B) {\n\t\t\tindex++;\n\t\t\tcount++;\n\t\t}\n\t\t\n\t\tif (count == 0) { return false; }\n\t\t\n\t\tif (blocks) { \n\t\t\tif (count % 2) {\n\t\t\t\tDATA.splice(index-count, count, B);\n\t\t\t} else {\n\t\t\t\tDATA.splice(index-count, count);\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn true;\n\n\t} else { /* this shadow starts outside an existing shadow, or within a starting boundary */\n\t\twhile (index < DATA.length && DATA[index] < B) {\n\t\t\tindex++;\n\t\t\tcount++;\n\t\t}\n\t\t\n\t\t/* visible when outside an existing shadow, or when overlapping */\n\t\tif (A == DATA[index-count] && count == 1) { return false; }\n\t\t\n\t\tif (blocks) { \n\t\t\tif (count % 2) {\n\t\t\t\tDATA.splice(index-count, count, A);\n\t\t\t} else {\n\t\t\t\tDATA.splice(index-count, count, A, B);\n\t\t\t}\n\t\t}\n\t\t\t\n\t\treturn true;\n\t}\n};\n/**\n * @class Precise shadowcasting algorithm\n * @augments ROT.FOV\n */\nROT.FOV.PreciseShadowcasting = function(lightPassesCallback, options) {\n\tROT.FOV.call(this, lightPassesCallback, options);\n};\nROT.FOV.PreciseShadowcasting.extend(ROT.FOV);\n\n/**\n * @see ROT.FOV#compute\n */\nROT.FOV.PreciseShadowcasting.prototype.compute = function(x, y, R, callback) {\n\t/* this place is always visible */\n\tcallback(x, y, 0, 1);\n\n\t/* standing in a dark place. FIXME is this a good idea?  */\n\tif (!this._lightPasses(x, y)) { return; }\n\t\n\t/* list of all shadows */\n\tvar SHADOWS = [];\n\t\n\tvar cx, cy, blocks, A1, A2, visibility;\n\n\t/* analyze surrounding cells in concentric rings, starting from the center */\n\tfor (var r=1; r<=R; r++) {\n\t\tvar neighbors = this._getCircle(x, y, r);\n\t\tvar neighborCount = neighbors.length;\n\n\t\tfor (var i=0;i<neighborCount;i++) {\n\t\t\tcx = neighbors[i][0];\n\t\t\tcy = neighbors[i][1];\n\t\t\t/* shift half-an-angle backwards to maintain consistency of 0-th cells */\n\t\t\tA1 = [i ? 2*i-1 : 2*neighborCount-1, 2*neighborCount];\n\t\t\tA2 = [2*i+1, 2*neighborCount]; \n\t\t\t\n\t\t\tblocks = !this._lightPasses(cx, cy);\n\t\t\tvisibility = this._checkVisibility(A1, A2, blocks, SHADOWS);\n\t\t\tif (visibility) { callback(cx, cy, r, visibility); }\n\n\t\t\tif (SHADOWS.length == 2 && SHADOWS[0][0] == 0 && SHADOWS[1][0] == SHADOWS[1][1]) { return; } /* cutoff? */\n\n\t\t} /* for all cells in this ring */\n\t} /* for all rings */\n};\n\n/**\n * @param {int[2]} A1 arc start\n * @param {int[2]} A2 arc end\n * @param {bool} blocks Does current arc block visibility?\n * @param {int[][]} SHADOWS list of active shadows\n */\nROT.FOV.PreciseShadowcasting.prototype._checkVisibility = function(A1, A2, blocks, SHADOWS) {\n\tif (A1[0] > A2[0]) { /* split into two sub-arcs */\n\t\tvar v1 = this._checkVisibility(A1, [A1[1], A1[1]], blocks, SHADOWS);\n\t\tvar v2 = this._checkVisibility([0, 1], A2, blocks, SHADOWS);\n\t\treturn (v1+v2)/2;\n\t}\n\n\t/* index1: first shadow >= A1 */\n\tvar index1 = 0, edge1 = false;\n\twhile (index1 < SHADOWS.length) {\n\t\tvar old = SHADOWS[index1];\n\t\tvar diff = old[0]*A1[1] - A1[0]*old[1];\n\t\tif (diff >= 0) { /* old >= A1 */\n\t\t\tif (diff == 0 && !(index1 % 2)) { edge1 = true; }\n\t\t\tbreak;\n\t\t}\n\t\tindex1++;\n\t}\n\n\t/* index2: last shadow <= A2 */\n\tvar index2 = SHADOWS.length, edge2 = false;\n\twhile (index2--) {\n\t\tvar old = SHADOWS[index2];\n\t\tvar diff = A2[0]*old[1] - old[0]*A2[1];\n\t\tif (diff >= 0) { /* old <= A2 */\n\t\t\tif (diff == 0 && (index2 % 2)) { edge2 = true; }\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tvar visible = true;\n\tif (index1 == index2 && (edge1 || edge2)) {  /* subset of existing shadow, one of the edges match */\n\t\tvisible = false; \n\t} else if (edge1 && edge2 && index1+1==index2 && (index2 % 2)) { /* completely equivalent with existing shadow */\n\t\tvisible = false;\n\t} else if (index1 > index2 && (index1 % 2)) { /* subset of existing shadow, not touching */\n\t\tvisible = false;\n\t}\n\t\n\tif (!visible) { return 0; } /* fast case: not visible */\n\t\n\tvar visibleLength, P;\n\n\t/* compute the length of visible arc, adjust list of shadows (if blocking) */\n\tvar remove = index2-index1+1;\n\tif (remove % 2) {\n\t\tif (index1 % 2) { /* first edge within existing shadow, second outside */\n\t\t\tvar P = SHADOWS[index1];\n\t\t\tvisibleLength = (A2[0]*P[1] - P[0]*A2[1]) / (P[1] * A2[1]);\n\t\t\tif (blocks) { SHADOWS.splice(index1, remove, A2); }\n\t\t} else { /* second edge within existing shadow, first outside */\n\t\t\tvar P = SHADOWS[index2];\n\t\t\tvisibleLength = (P[0]*A1[1] - A1[0]*P[1]) / (A1[1] * P[1]);\n\t\t\tif (blocks) { SHADOWS.splice(index1, remove, A1); }\n\t\t}\n\t} else {\n\t\tif (index1 % 2) { /* both edges within existing shadows */\n\t\t\tvar P1 = SHADOWS[index1];\n\t\t\tvar P2 = SHADOWS[index2];\n\t\t\tvisibleLength = (P2[0]*P1[1] - P1[0]*P2[1]) / (P1[1] * P2[1]);\n\t\t\tif (blocks) { SHADOWS.splice(index1, remove); }\n\t\t} else { /* both edges outside existing shadows */\n\t\t\tif (blocks) { SHADOWS.splice(index1, remove, A1, A2); }\n\t\t\treturn 1; /* whole arc visible! */\n\t\t}\n\t}\n\n\tvar arcLength = (A2[0]*A1[1] - A1[0]*A2[1]) / (A1[1] * A2[1]);\n\n\treturn visibleLength/arcLength;\n};\n/**\n * @class Recursive shadowcasting algorithm\n * Currently only supports 4/8 topologies, not hexagonal.\n * Based on Peter Harkins' implementation of Björn Bergström's algorithm described here: http://www.roguebasin.com/index.php?title=FOV_using_recursive_shadowcasting\n * @augments ROT.FOV\n */\nROT.FOV.RecursiveShadowcasting = function(lightPassesCallback, options) {\n\tROT.FOV.call(this, lightPassesCallback, options);\n};\nROT.FOV.RecursiveShadowcasting.extend(ROT.FOV);\n\n/** Octants used for translating recursive shadowcasting offsets */\nROT.FOV.RecursiveShadowcasting.OCTANTS = [\n\t[-1,  0,  0,  1],\n\t[ 0, -1,  1,  0],\n\t[ 0, -1, -1,  0],\n\t[-1,  0,  0, -1],\n\t[ 1,  0,  0, -1],\n\t[ 0,  1, -1,  0],\n\t[ 0,  1,  1,  0],\n\t[ 1,  0,  0,  1]\n];\n\n/**\n * Compute visibility for a 360-degree circle\n * @param {int} x\n * @param {int} y\n * @param {int} R Maximum visibility radius\n * @param {function} callback\n */\nROT.FOV.RecursiveShadowcasting.prototype.compute = function(x, y, R, callback) {\n\t//You can always see your own tile\n\tcallback(x, y, 0, 1);\n\tfor(var i = 0; i < ROT.FOV.RecursiveShadowcasting.OCTANTS.length; i++) {\n\t\tthis._renderOctant(x, y, ROT.FOV.RecursiveShadowcasting.OCTANTS[i], R, callback);\n\t}\n};\n\n/**\n * Compute visibility for a 180-degree arc\n * @param {int} x\n * @param {int} y\n * @param {int} R Maximum visibility radius\n * @param {int} dir Direction to look in (expressed in a ROT.DIRS value);\n * @param {function} callback\n */\nROT.FOV.RecursiveShadowcasting.prototype.compute180 = function(x, y, R, dir, callback) {\n\t//You can always see your own tile\n\tcallback(x, y, 0, 1);\n\tvar previousOctant = (dir - 1 + 8) % 8; //Need to retrieve the previous octant to render a full 180 degrees\n\tvar nextPreviousOctant = (dir - 2 + 8) % 8; //Need to retrieve the previous two octants to render a full 180 degrees\n\tvar nextOctant = (dir+ 1 + 8) % 8; //Need to grab to next octant to render a full 180 degrees\n\tthis._renderOctant(x, y, ROT.FOV.RecursiveShadowcasting.OCTANTS[nextPreviousOctant], R, callback);\n\tthis._renderOctant(x, y, ROT.FOV.RecursiveShadowcasting.OCTANTS[previousOctant], R, callback);\n\tthis._renderOctant(x, y, ROT.FOV.RecursiveShadowcasting.OCTANTS[dir], R, callback);\n\tthis._renderOctant(x, y, ROT.FOV.RecursiveShadowcasting.OCTANTS[nextOctant], R, callback);\n};\n\n/**\n * Compute visibility for a 90-degree arc\n * @param {int} x\n * @param {int} y\n * @param {int} R Maximum visibility radius\n * @param {int} dir Direction to look in (expressed in a ROT.DIRS value);\n * @param {function} callback\n */\nROT.FOV.RecursiveShadowcasting.prototype.compute90 = function(x, y, R, dir, callback) {\n\t//You can always see your own tile\n\tcallback(x, y, 0, 1);\n\tvar previousOctant = (dir - 1 + 8) % 8; //Need to retrieve the previous octant to render a full 90 degrees\n\tthis._renderOctant(x, y, ROT.FOV.RecursiveShadowcasting.OCTANTS[dir], R, callback);\n\tthis._renderOctant(x, y, ROT.FOV.RecursiveShadowcasting.OCTANTS[previousOctant], R, callback);\n};\n\n/**\n * Render one octant (45-degree arc) of the viewshed\n * @param {int} x\n * @param {int} y\n * @param {int} octant Octant to be rendered\n * @param {int} R Maximum visibility radius\n * @param {function} callback\n */\nROT.FOV.RecursiveShadowcasting.prototype._renderOctant = function(x, y, octant, R, callback) {\n\t//Radius incremented by 1 to provide same coverage area as other shadowcasting radiuses\n\tthis._castVisibility(x, y, 1, 1.0, 0.0, R + 1, octant[0], octant[1], octant[2], octant[3], callback);\n};\n\n/**\n * Actually calculates the visibility\n * @param {int} startX The starting X coordinate\n * @param {int} startY The starting Y coordinate\n * @param {int} row The row to render\n * @param {float} visSlopeStart The slope to start at\n * @param {float} visSlopeEnd The slope to end at\n * @param {int} radius The radius to reach out to\n * @param {int} xx \n * @param {int} xy \n * @param {int} yx \n * @param {int} yy \n * @param {function} callback The callback to use when we hit a block that is visible\n */\nROT.FOV.RecursiveShadowcasting.prototype._castVisibility = function(startX, startY, row, visSlopeStart, visSlopeEnd, radius, xx, xy, yx, yy, callback) {\n\tif(visSlopeStart < visSlopeEnd) { return; }\n\tfor(var i = row; i <= radius; i++) {\n\t\tvar dx = -i - 1;\n\t\tvar dy = -i;\n\t\tvar blocked = false;\n\t\tvar newStart = 0;\n\n\t\t//'Row' could be column, names here assume octant 0 and would be flipped for half the octants\n\t\twhile(dx <= 0) {\n\t\t\tdx += 1;\n\n\t\t\t//Translate from relative coordinates to map coordinates\n\t\t\tvar mapX = startX + dx * xx + dy * xy;\n\t\t\tvar mapY = startY + dx * yx + dy * yy;\n\n\t\t\t//Range of the row\n\t\t\tvar slopeStart = (dx - 0.5) / (dy + 0.5);\n\t\t\tvar slopeEnd = (dx + 0.5) / (dy - 0.5);\n\t\t\n\t\t\t//Ignore if not yet at left edge of Octant\n\t\t\tif(slopeEnd > visSlopeStart) { continue; }\n\t\t\t\n\t\t\t//Done if past right edge\n\t\t\tif(slopeStart < visSlopeEnd) { break; }\n\t\t\t\t\n\t\t\t//If it's in range, it's visible\n\t\t\tif((dx * dx + dy * dy) < (radius * radius)) {\n\t\t\t\tcallback(mapX, mapY, i, 1);\n\t\t\t}\n\t\n\t\t\tif(!blocked) {\n\t\t\t\t//If tile is a blocking tile, cast around it\n\t\t\t\tif(!this._lightPasses(mapX, mapY) && i < radius) {\n\t\t\t\t\tblocked = true;\n\t\t\t\t\tthis._castVisibility(startX, startY, i + 1, visSlopeStart, slopeStart, radius, xx, xy, yx, yy, callback);\n\t\t\t\t\tnewStart = slopeEnd;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t//Keep narrowing if scanning across a block\n\t\t\t\tif(!this._lightPasses(mapX, mapY)) {\n\t\t\t\t\tnewStart = slopeEnd;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\n\t\t\t\t//Block has ended\n\t\t\t\tblocked = false;\n\t\t\t\tvisSlopeStart = newStart;\n\t\t\t}\n\t\t}\n\t\tif(blocked) { break; }\n\t}\n};\n/**\n * @namespace Color operations\n */\nROT.Color = {\n\tfromString: function(str) {\n\t\tvar cached, r;\n\t\tif (str in this._cache) {\n\t\t\tcached = this._cache[str];\n\t\t} else {\n\t\t\tif (str.charAt(0) == \"#\") { /* hex rgb */\n\n\t\t\t\tvar values = str.match(/[0-9a-f]/gi).map(function(x) { return parseInt(x, 16); });\n\t\t\t\tif (values.length == 3) {\n\t\t\t\t\tcached = values.map(function(x) { return x*17; });\n\t\t\t\t} else {\n\t\t\t\t\tfor (var i=0;i<3;i++) {\n\t\t\t\t\t\tvalues[i+1] += 16*values[i];\n\t\t\t\t\t\tvalues.splice(i, 1);\n\t\t\t\t\t}\n\t\t\t\t\tcached = values;\n\t\t\t\t}\n\n\t\t\t} else if ((r = str.match(/rgb\\(([0-9, ]+)\\)/i))) { /* decimal rgb */\n\t\t\t\tcached = r[1].split(/\\s*,\\s*/).map(function(x) { return parseInt(x); });\n\t\t\t} else { /* html name */\n\t\t\t\tcached = [0, 0, 0];\n\t\t\t}\n\n\t\t\tthis._cache[str] = cached;\n\t\t}\n\n\t\treturn cached.slice();\n\t},\n\n\t/**\n\t * Add two or more colors\n\t * @param {number[]} color1\n\t * @param {number[]} color2\n\t * @returns {number[]}\n\t */\n\tadd: function(color1, color2) {\n\t\tvar result = color1.slice();\n\t\tfor (var i=0;i<3;i++) {\n\t\t\tfor (var j=1;j<arguments.length;j++) {\n\t\t\t\tresult[i] += arguments[j][i];\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t},\n\n\t/**\n\t * Add two or more colors, MODIFIES FIRST ARGUMENT\n\t * @param {number[]} color1\n\t * @param {number[]} color2\n\t * @returns {number[]}\n\t */\n\tadd_: function(color1, color2) {\n\t\tfor (var i=0;i<3;i++) {\n\t\t\tfor (var j=1;j<arguments.length;j++) {\n\t\t\t\tcolor1[i] += arguments[j][i];\n\t\t\t}\n\t\t}\n\t\treturn color1;\n\t},\n\n\t/**\n\t * Multiply (mix) two or more colors\n\t * @param {number[]} color1\n\t * @param {number[]} color2\n\t * @returns {number[]}\n\t */\n\tmultiply: function(color1, color2) {\n\t\tvar result = color1.slice();\n\t\tfor (var i=0;i<3;i++) {\n\t\t\tfor (var j=1;j<arguments.length;j++) {\n\t\t\t\tresult[i] *= arguments[j][i] / 255;\n\t\t\t}\n\t\t\tresult[i] = Math.round(result[i]);\n\t\t}\n\t\treturn result;\n\t},\n\n\t/**\n\t * Multiply (mix) two or more colors, MODIFIES FIRST ARGUMENT\n\t * @param {number[]} color1\n\t * @param {number[]} color2\n\t * @returns {number[]}\n\t */\n\tmultiply_: function(color1, color2) {\n\t\tfor (var i=0;i<3;i++) {\n\t\t\tfor (var j=1;j<arguments.length;j++) {\n\t\t\t\tcolor1[i] *= arguments[j][i] / 255;\n\t\t\t}\n\t\t\tcolor1[i] = Math.round(color1[i]);\n\t\t}\n\t\treturn color1;\n\t},\n\n\t/**\n\t * Interpolate (blend) two colors with a given factor\n\t * @param {number[]} color1\n\t * @param {number[]} color2\n\t * @param {float} [factor=0.5] 0..1\n\t * @returns {number[]}\n\t */\n\tinterpolate: function(color1, color2, factor) {\n\t\tif (arguments.length < 3) { factor = 0.5; }\n\t\tvar result = color1.slice();\n\t\tfor (var i=0;i<3;i++) {\n\t\t\tresult[i] = Math.round(result[i] + factor*(color2[i]-color1[i]));\n\t\t}\n\t\treturn result;\n\t},\n\n\t/**\n\t * Interpolate (blend) two colors with a given factor in HSL mode\n\t * @param {number[]} color1\n\t * @param {number[]} color2\n\t * @param {float} [factor=0.5] 0..1\n\t * @returns {number[]}\n\t */\n\tinterpolateHSL: function(color1, color2, factor) {\n\t\tif (arguments.length < 3) { factor = 0.5; }\n\t\tvar hsl1 = this.rgb2hsl(color1);\n\t\tvar hsl2 = this.rgb2hsl(color2);\n\t\tfor (var i=0;i<3;i++) {\n\t\t\thsl1[i] += factor*(hsl2[i]-hsl1[i]);\n\t\t}\n\t\treturn this.hsl2rgb(hsl1);\n\t},\n\n\t/**\n\t * Create a new random color based on this one\n\t * @param {number[]} color\n\t * @param {number[]} diff Set of standard deviations\n\t * @returns {number[]}\n\t */\n\trandomize: function(color, diff) {\n\t\tif (!(diff instanceof Array)) { diff = Math.round(ROT.RNG.getNormal(0, diff)); }\n\t\tvar result = color.slice();\n\t\tfor (var i=0;i<3;i++) {\n\t\t\tresult[i] += (diff instanceof Array ? Math.round(ROT.RNG.getNormal(0, diff[i])) : diff);\n\t\t}\n\t\treturn result;\n\t},\n\n\t/**\n\t * Converts an RGB color value to HSL. Expects 0..255 inputs, produces 0..1 outputs.\n\t * @param {number[]} color\n\t * @returns {number[]}\n\t */\n\trgb2hsl: function(color) {\n\t\tvar r = color[0]/255;\n\t\tvar g = color[1]/255;\n\t\tvar b = color[2]/255;\n\n\t\tvar max = Math.max(r, g, b), min = Math.min(r, g, b);\n\t\tvar h, s, l = (max + min) / 2;\n\n\t\tif (max == min) {\n\t\t\th = s = 0; // achromatic\n\t\t} else {\n\t\t\tvar d = max - min;\n\t\t\ts = (l > 0.5 ? d / (2 - max - min) : d / (max + min));\n\t\t\tswitch(max) {\n\t\t\t\tcase r: h = (g - b) / d + (g < b ? 6 : 0); break;\n\t\t\t\tcase g: h = (b - r) / d + 2; break;\n\t\t\t\tcase b: h = (r - g) / d + 4; break;\n\t\t\t}\n\t\t\th /= 6;\n\t\t}\n\n\t\treturn [h, s, l];\n\t},\n\n\t/**\n\t * Converts an HSL color value to RGB. Expects 0..1 inputs, produces 0..255 outputs.\n\t * @param {number[]} color\n\t * @returns {number[]}\n\t */\n\thsl2rgb: function(color) {\n\t\tvar l = color[2];\n\n\t\tif (color[1] == 0) {\n\t\t\tl = Math.round(l*255);\n\t\t\treturn [l, l, l];\n\t\t} else {\n\t\t\tvar hue2rgb = function(p, q, t) {\n\t\t\t\tif (t < 0) t += 1;\n\t\t\t\tif (t > 1) t -= 1;\n\t\t\t\tif (t < 1/6) return p + (q - p) * 6 * t;\n\t\t\t\tif (t < 1/2) return q;\n\t\t\t\tif (t < 2/3) return p + (q - p) * (2/3 - t) * 6;\n\t\t\t\treturn p;\n\t\t\t}\n\n\t\t\tvar s = color[1];\n\t\t\tvar q = (l < 0.5 ? l * (1 + s) : l + s - l * s);\n\t\t\tvar p = 2 * l - q;\n\t\t\tvar r = hue2rgb(p, q, color[0] + 1/3);\n\t\t\tvar g = hue2rgb(p, q, color[0]);\n\t\t\tvar b = hue2rgb(p, q, color[0] - 1/3);\n\t\t\treturn [Math.round(r*255), Math.round(g*255), Math.round(b*255)];\n\t\t}\n\t},\n\n\ttoRGB: function(color) {\n\t\treturn \"rgb(\" + this._clamp(color[0]) + \",\" + this._clamp(color[1]) + \",\" + this._clamp(color[2]) + \")\";\n\t},\n\n\ttoHex: function(color) {\n\t\tvar parts = [];\n\t\tfor (var i=0;i<3;i++) {\n\t\t\tparts.push(this._clamp(color[i]).toString(16).lpad(\"0\", 2));\n\t\t}\n\t\treturn \"#\" + parts.join(\"\");\n\t},\n\n\t_clamp: function(num) {\n\t\tif (num < 0) {\n\t\t\treturn 0;\n\t\t} else if (num > 255) {\n\t\t\treturn 255;\n\t\t} else {\n\t\t\treturn num;\n\t\t}\n\t},\n\n\t_cache: {\n\t\t\"black\": [0,0,0],\n\t\t\"navy\": [0,0,128],\n\t\t\"darkblue\": [0,0,139],\n\t\t\"mediumblue\": [0,0,205],\n\t\t\"blue\": [0,0,255],\n\t\t\"darkgreen\": [0,100,0],\n\t\t\"green\": [0,128,0],\n\t\t\"teal\": [0,128,128],\n\t\t\"darkcyan\": [0,139,139],\n\t\t\"deepskyblue\": [0,191,255],\n\t\t\"darkturquoise\": [0,206,209],\n\t\t\"mediumspringgreen\": [0,250,154],\n\t\t\"lime\": [0,255,0],\n\t\t\"springgreen\": [0,255,127],\n\t\t\"aqua\": [0,255,255],\n\t\t\"cyan\": [0,255,255],\n\t\t\"midnightblue\": [25,25,112],\n\t\t\"dodgerblue\": [30,144,255],\n\t\t\"forestgreen\": [34,139,34],\n\t\t\"seagreen\": [46,139,87],\n\t\t\"darkslategray\": [47,79,79],\n\t\t\"darkslategrey\": [47,79,79],\n\t\t\"limegreen\": [50,205,50],\n\t\t\"mediumseagreen\": [60,179,113],\n\t\t\"turquoise\": [64,224,208],\n\t\t\"royalblue\": [65,105,225],\n\t\t\"steelblue\": [70,130,180],\n\t\t\"darkslateblue\": [72,61,139],\n\t\t\"mediumturquoise\": [72,209,204],\n\t\t\"indigo\": [75,0,130],\n\t\t\"darkolivegreen\": [85,107,47],\n\t\t\"cadetblue\": [95,158,160],\n\t\t\"cornflowerblue\": [100,149,237],\n\t\t\"mediumaquamarine\": [102,205,170],\n\t\t\"dimgray\": [105,105,105],\n\t\t\"dimgrey\": [105,105,105],\n\t\t\"slateblue\": [106,90,205],\n\t\t\"olivedrab\": [107,142,35],\n\t\t\"slategray\": [112,128,144],\n\t\t\"slategrey\": [112,128,144],\n\t\t\"lightslategray\": [119,136,153],\n\t\t\"lightslategrey\": [119,136,153],\n\t\t\"mediumslateblue\": [123,104,238],\n\t\t\"lawngreen\": [124,252,0],\n\t\t\"chartreuse\": [127,255,0],\n\t\t\"aquamarine\": [127,255,212],\n\t\t\"maroon\": [128,0,0],\n\t\t\"purple\": [128,0,128],\n\t\t\"olive\": [128,128,0],\n\t\t\"gray\": [128,128,128],\n\t\t\"grey\": [128,128,128],\n\t\t\"skyblue\": [135,206,235],\n\t\t\"lightskyblue\": [135,206,250],\n\t\t\"blueviolet\": [138,43,226],\n\t\t\"darkred\": [139,0,0],\n\t\t\"darkmagenta\": [139,0,139],\n\t\t\"saddlebrown\": [139,69,19],\n\t\t\"darkseagreen\": [143,188,143],\n\t\t\"lightgreen\": [144,238,144],\n\t\t\"mediumpurple\": [147,112,216],\n\t\t\"darkviolet\": [148,0,211],\n\t\t\"palegreen\": [152,251,152],\n\t\t\"darkorchid\": [153,50,204],\n\t\t\"yellowgreen\": [154,205,50],\n\t\t\"sienna\": [160,82,45],\n\t\t\"brown\": [165,42,42],\n\t\t\"darkgray\": [169,169,169],\n\t\t\"darkgrey\": [169,169,169],\n\t\t\"lightblue\": [173,216,230],\n\t\t\"greenyellow\": [173,255,47],\n\t\t\"paleturquoise\": [175,238,238],\n\t\t\"lightsteelblue\": [176,196,222],\n\t\t\"powderblue\": [176,224,230],\n\t\t\"firebrick\": [178,34,34],\n\t\t\"darkgoldenrod\": [184,134,11],\n\t\t\"mediumorchid\": [186,85,211],\n\t\t\"rosybrown\": [188,143,143],\n\t\t\"darkkhaki\": [189,183,107],\n\t\t\"silver\": [192,192,192],\n\t\t\"mediumvioletred\": [199,21,133],\n\t\t\"indianred\": [205,92,92],\n\t\t\"peru\": [205,133,63],\n\t\t\"chocolate\": [210,105,30],\n\t\t\"tan\": [210,180,140],\n\t\t\"lightgray\": [211,211,211],\n\t\t\"lightgrey\": [211,211,211],\n\t\t\"palevioletred\": [216,112,147],\n\t\t\"thistle\": [216,191,216],\n\t\t\"orchid\": [218,112,214],\n\t\t\"goldenrod\": [218,165,32],\n\t\t\"crimson\": [220,20,60],\n\t\t\"gainsboro\": [220,220,220],\n\t\t\"plum\": [221,160,221],\n\t\t\"burlywood\": [222,184,135],\n\t\t\"lightcyan\": [224,255,255],\n\t\t\"lavender\": [230,230,250],\n\t\t\"darksalmon\": [233,150,122],\n\t\t\"violet\": [238,130,238],\n\t\t\"palegoldenrod\": [238,232,170],\n\t\t\"lightcoral\": [240,128,128],\n\t\t\"khaki\": [240,230,140],\n\t\t\"aliceblue\": [240,248,255],\n\t\t\"honeydew\": [240,255,240],\n\t\t\"azure\": [240,255,255],\n\t\t\"sandybrown\": [244,164,96],\n\t\t\"wheat\": [245,222,179],\n\t\t\"beige\": [245,245,220],\n\t\t\"whitesmoke\": [245,245,245],\n\t\t\"mintcream\": [245,255,250],\n\t\t\"ghostwhite\": [248,248,255],\n\t\t\"salmon\": [250,128,114],\n\t\t\"antiquewhite\": [250,235,215],\n\t\t\"linen\": [250,240,230],\n\t\t\"lightgoldenrodyellow\": [250,250,210],\n\t\t\"oldlace\": [253,245,230],\n\t\t\"red\": [255,0,0],\n\t\t\"fuchsia\": [255,0,255],\n\t\t\"magenta\": [255,0,255],\n\t\t\"deeppink\": [255,20,147],\n\t\t\"orangered\": [255,69,0],\n\t\t\"tomato\": [255,99,71],\n\t\t\"hotpink\": [255,105,180],\n\t\t\"coral\": [255,127,80],\n\t\t\"darkorange\": [255,140,0],\n\t\t\"lightsalmon\": [255,160,122],\n\t\t\"orange\": [255,165,0],\n\t\t\"lightpink\": [255,182,193],\n\t\t\"pink\": [255,192,203],\n\t\t\"gold\": [255,215,0],\n\t\t\"peachpuff\": [255,218,185],\n\t\t\"navajowhite\": [255,222,173],\n\t\t\"moccasin\": [255,228,181],\n\t\t\"bisque\": [255,228,196],\n\t\t\"mistyrose\": [255,228,225],\n\t\t\"blanchedalmond\": [255,235,205],\n\t\t\"papayawhip\": [255,239,213],\n\t\t\"lavenderblush\": [255,240,245],\n\t\t\"seashell\": [255,245,238],\n\t\t\"cornsilk\": [255,248,220],\n\t\t\"lemonchiffon\": [255,250,205],\n\t\t\"floralwhite\": [255,250,240],\n\t\t\"snow\": [255,250,250],\n\t\t\"yellow\": [255,255,0],\n\t\t\"lightyellow\": [255,255,224],\n\t\t\"ivory\": [255,255,240],\n\t\t\"white\": [255,255,255]\n\t}\n};\n/**\n * @class Lighting computation, based on a traditional FOV for multiple light sources and multiple passes.\n * @param {function} reflectivityCallback Callback to retrieve cell reflectivity (0..1)\n * @param {object} [options]\n * @param {int} [options.passes=1] Number of passes. 1 equals to simple FOV of all light sources, >1 means a *highly simplified* radiosity-like algorithm.\n * @param {int} [options.emissionThreshold=100] Cells with emissivity > threshold will be treated as light source in the next pass.\n * @param {int} [options.range=10] Max light range\n */\nROT.Lighting = function(reflectivityCallback, options) {\n\tthis._reflectivityCallback = reflectivityCallback;\n\tthis._options = {\n\t\tpasses: 1,\n\t\temissionThreshold: 100,\n\t\trange: 10\n\t};\n\tthis._fov = null;\n\n\tthis._lights = {};\n\tthis._reflectivityCache = {};\n\tthis._fovCache = {};\n\n\tthis.setOptions(options);\n};\n\n/**\n * Adjust options at runtime\n * @see ROT.Lighting\n * @param {object} [options]\n */\nROT.Lighting.prototype.setOptions = function(options) {\n\tfor (var p in options) { this._options[p] = options[p]; }\n\tif (options && options.range) { this.reset(); }\n\treturn this;\n};\n\n/**\n * Set the used Field-Of-View algo\n * @param {ROT.FOV} fov\n */\nROT.Lighting.prototype.setFOV = function(fov) {\n\tthis._fov = fov;\n\tthis._fovCache = {};\n\treturn this;\n};\n\n/**\n * Set (or remove) a light source\n * @param {int} x\n * @param {int} y\n * @param {null || string || number[3]} color\n */\nROT.Lighting.prototype.setLight = function(x, y, color) {\n  var key = x + \",\" + y;\n\n  if (color) {\n    this._lights[key] = (typeof(color) == \"string\" ? ROT.Color.fromString(color) : color);\n  } else {\n    delete this._lights[key];\n  }\n  return this;\n};\n\n/**\n * Remove all light sources\n */\nROT.Lighting.prototype.clearLights = function() {\n    this._lights = {};\n};\n\n/**\n * Reset the pre-computed topology values. Call whenever the underlying map changes its light-passability.\n */\nROT.Lighting.prototype.reset = function() {\n\tthis._reflectivityCache = {};\n\tthis._fovCache = {};\n\n\treturn this;\n};\n\n/**\n * Compute the lighting\n * @param {function} lightingCallback Will be called with (x, y, color) for every lit cell\n */\nROT.Lighting.prototype.compute = function(lightingCallback) {\n\tvar doneCells = {};\n\tvar emittingCells = {};\n\tvar litCells = {};\n\n\tfor (var key in this._lights) { /* prepare emitters for first pass */\n\t\tvar light = this._lights[key];\n\t\temittingCells[key] = [0, 0, 0];\n\t\tROT.Color.add_(emittingCells[key], light);\n\t}\n\n\tfor (var i=0;i<this._options.passes;i++) { /* main loop */\n\t\tthis._emitLight(emittingCells, litCells, doneCells);\n\t\tif (i+1 == this._options.passes) { continue; } /* not for the last pass */\n\t\temittingCells = this._computeEmitters(litCells, doneCells);\n\t}\n\n\tfor (var litKey in litCells) { /* let the user know what and how is lit */\n\t\tvar parts = litKey.split(\",\");\n\t\tvar x = parseInt(parts[0]);\n\t\tvar y = parseInt(parts[1]);\n\t\tlightingCallback(x, y, litCells[litKey]);\n\t}\n\n\treturn this;\n};\n\n/**\n * Compute one iteration from all emitting cells\n * @param {object} emittingCells These emit light\n * @param {object} litCells Add projected light to these\n * @param {object} doneCells These already emitted, forbid them from further calculations\n */\nROT.Lighting.prototype._emitLight = function(emittingCells, litCells, doneCells) {\n\tfor (var key in emittingCells) {\n\t\tvar parts = key.split(\",\");\n\t\tvar x = parseInt(parts[0]);\n\t\tvar y = parseInt(parts[1]);\n\t\tthis._emitLightFromCell(x, y, emittingCells[key], litCells);\n\t\tdoneCells[key] = 1;\n\t}\n\treturn this;\n};\n\n/**\n * Prepare a list of emitters for next pass\n * @param {object} litCells\n * @param {object} doneCells\n * @returns {object}\n */\nROT.Lighting.prototype._computeEmitters = function(litCells, doneCells) {\n\tvar result = {};\n\n\tfor (var key in litCells) {\n\t\tif (key in doneCells) { continue; } /* already emitted */\n\n\t\tvar color = litCells[key];\n\n\t\tif (key in this._reflectivityCache) {\n\t\t\tvar reflectivity = this._reflectivityCache[key];\n\t\t} else {\n\t\t\tvar parts = key.split(\",\");\n\t\t\tvar x = parseInt(parts[0]);\n\t\t\tvar y = parseInt(parts[1]);\n\t\t\tvar reflectivity = this._reflectivityCallback(x, y);\n\t\t\tthis._reflectivityCache[key] = reflectivity;\n\t\t}\n\n\t\tif (reflectivity == 0) { continue; } /* will not reflect at all */\n\n\t\t/* compute emission color */\n\t\tvar emission = [];\n\t\tvar intensity = 0;\n\t\tfor (var i=0;i<3;i++) {\n\t\t\tvar part = Math.round(color[i]*reflectivity);\n\t\t\temission[i] = part;\n\t\t\tintensity += part;\n\t\t}\n\t\tif (intensity > this._options.emissionThreshold) { result[key] = emission; }\n\t}\n\n\treturn result;\n};\n\n/**\n * Compute one iteration from one cell\n * @param {int} x\n * @param {int} y\n * @param {number[]} color\n * @param {object} litCells Cell data to by updated\n */\nROT.Lighting.prototype._emitLightFromCell = function(x, y, color, litCells) {\n\tvar key = x+\",\"+y;\n\tif (key in this._fovCache) {\n\t\tvar fov = this._fovCache[key];\n\t} else {\n\t\tvar fov = this._updateFOV(x, y);\n\t}\n\n\tfor (var fovKey in fov) {\n\t\tvar formFactor = fov[fovKey];\n\n\t\tif (fovKey in litCells) { /* already lit */\n\t\t\tvar result = litCells[fovKey];\n\t\t} else { /* newly lit */\n\t\t\tvar result = [0, 0, 0];\n\t\t\tlitCells[fovKey] = result;\n\t\t}\n\n\t\tfor (var i=0;i<3;i++) { result[i] += Math.round(color[i]*formFactor); } /* add light color */\n\t}\n\n\treturn this;\n};\n\n/**\n * Compute FOV (\"form factor\") for a potential light source at [x,y]\n * @param {int} x\n * @param {int} y\n * @returns {object}\n */\nROT.Lighting.prototype._updateFOV = function(x, y) {\n\tvar key1 = x+\",\"+y;\n\tvar cache = {};\n\tthis._fovCache[key1] = cache;\n\tvar range = this._options.range;\n\tvar cb = function(x, y, r, vis) {\n\t\tvar key2 = x+\",\"+y;\n\t\tvar formFactor = vis * (1-r/range);\n\t\tif (formFactor == 0) { return; }\n\t\tcache[key2] = formFactor;\n\t};\n\tthis._fov.compute(x, y, range, cb.bind(this));\n\n\treturn cache;\n};\n/**\n * @class Abstract pathfinder\n * @param {int} toX Target X coord\n * @param {int} toY Target Y coord\n * @param {function} passableCallback Callback to determine map passability\n * @param {object} [options]\n * @param {int} [options.topology=8]\n */\nROT.Path = function(toX, toY, passableCallback, options) {\n\tthis._toX = toX;\n\tthis._toY = toY;\n\tthis._fromX = null;\n\tthis._fromY = null;\n\tthis._passableCallback = passableCallback;\n\tthis._options = {\n\t\ttopology: 8\n\t};\n\tfor (var p in options) { this._options[p] = options[p]; }\n\n\tthis._dirs = ROT.DIRS[this._options.topology];\n\tif (this._options.topology == 8) { /* reorder dirs for more aesthetic result (vertical/horizontal first) */\n\t\tthis._dirs = [\n\t\t\tthis._dirs[0],\n\t\t\tthis._dirs[2],\n\t\t\tthis._dirs[4],\n\t\t\tthis._dirs[6],\n\t\t\tthis._dirs[1],\n\t\t\tthis._dirs[3],\n\t\t\tthis._dirs[5],\n\t\t\tthis._dirs[7]\n\t\t]\n\t}\n};\n\n/**\n * Compute a path from a given point\n * @param {int} fromX\n * @param {int} fromY\n * @param {function} callback Will be called for every path item with arguments \"x\" and \"y\"\n */\nROT.Path.prototype.compute = function(fromX, fromY, callback) {\n};\n\nROT.Path.prototype._getNeighbors = function(cx, cy) {\n\tvar result = [];\n\tfor (var i=0;i<this._dirs.length;i++) {\n\t\tvar dir = this._dirs[i];\n\t\tvar x = cx + dir[0];\n\t\tvar y = cy + dir[1];\n\t\t\n\t\tif (!this._passableCallback(x, y)) { continue; }\n\t\tresult.push([x, y]);\n\t}\n\t\n\treturn result;\n};\n/**\n * @class Simplified Dijkstra's algorithm: all edges have a value of 1\n * @augments ROT.Path\n * @see ROT.Path\n */\nROT.Path.Dijkstra = function(toX, toY, passableCallback, options) {\n\tROT.Path.call(this, toX, toY, passableCallback, options);\n\n\tthis._computed = {};\n\tthis._todo = [];\n\tthis._add(toX, toY, null);\n};\nROT.Path.Dijkstra.extend(ROT.Path);\n\n/**\n * Compute a path from a given point\n * @see ROT.Path#compute\n */\nROT.Path.Dijkstra.prototype.compute = function(fromX, fromY, callback) {\n\tvar key = fromX+\",\"+fromY;\n\tif (!(key in this._computed)) { this._compute(fromX, fromY); }\n\tif (!(key in this._computed)) { return; }\n\t\n\tvar item = this._computed[key];\n\twhile (item) {\n\t\tcallback(item.x, item.y);\n\t\titem = item.prev;\n\t}\n};\n\n/**\n * Compute a non-cached value\n */\nROT.Path.Dijkstra.prototype._compute = function(fromX, fromY) {\n\twhile (this._todo.length) {\n\t\tvar item = this._todo.shift();\n\t\tif (item.x == fromX && item.y == fromY) { return; }\n\t\t\n\t\tvar neighbors = this._getNeighbors(item.x, item.y);\n\t\t\n\t\tfor (var i=0;i<neighbors.length;i++) {\n\t\t\tvar neighbor = neighbors[i];\n\t\t\tvar x = neighbor[0];\n\t\t\tvar y = neighbor[1];\n\t\t\tvar id = x+\",\"+y;\n\t\t\tif (id in this._computed) { continue; } /* already done */\t\n\t\t\tthis._add(x, y, item); \n\t\t}\n\t}\n};\n\nROT.Path.Dijkstra.prototype._add = function(x, y, prev) {\n\tvar obj = {\n\t\tx: x,\n\t\ty: y,\n\t\tprev: prev\n\t};\n\tthis._computed[x+\",\"+y] = obj;\n\tthis._todo.push(obj);\n};\n/**\n * @class Simplified A* algorithm: all edges have a value of 1\n * @augments ROT.Path\n * @see ROT.Path\n */\nROT.Path.AStar = function(toX, toY, passableCallback, options) {\n\tROT.Path.call(this, toX, toY, passableCallback, options);\n\n\tthis._todo = [];\n\tthis._done = {};\n\tthis._fromX = null;\n\tthis._fromY = null;\n};\nROT.Path.AStar.extend(ROT.Path);\n\n/**\n * Compute a path from a given point\n * @see ROT.Path#compute\n */\nROT.Path.AStar.prototype.compute = function(fromX, fromY, callback) {\n\tthis._todo = [];\n\tthis._done = {};\n\tthis._fromX = fromX;\n\tthis._fromY = fromY;\n\tthis._add(this._toX, this._toY, null);\n\n\twhile (this._todo.length) {\n\t\tvar item = this._todo.shift();\n\t\tvar id = item.x+\",\"+item.y;\n\t\tif (id in this._done) { continue; }\n\t\tthis._done[id] = item;\n\t\tif (item.x == fromX && item.y == fromY) { break; }\n\n\t\tvar neighbors = this._getNeighbors(item.x, item.y);\n\n\t\tfor (var i=0;i<neighbors.length;i++) {\n\t\t\tvar neighbor = neighbors[i];\n\t\t\tvar x = neighbor[0];\n\t\t\tvar y = neighbor[1];\n\t\t\tvar id = x+\",\"+y;\n\t\t\tif (id in this._done) { continue; }\n\t\t\tthis._add(x, y, item); \n\t\t}\n\t}\n\t\n\tvar item = this._done[fromX+\",\"+fromY];\n\tif (!item) { return; }\n\t\n\twhile (item) {\n\t\tcallback(item.x, item.y);\n\t\titem = item.prev;\n\t}\n};\n\nROT.Path.AStar.prototype._add = function(x, y, prev) {\n\tvar h = this._distance(x, y);\n\tvar obj = {\n\t\tx: x,\n\t\ty: y,\n\t\tprev: prev,\n\t\tg: (prev ? prev.g+1 : 0),\n\t\th: h\n\t};\n\t\n\t/* insert into priority queue */\n\t\n\tvar f = obj.g + obj.h;\n\tfor (var i=0;i<this._todo.length;i++) {\n\t\tvar item = this._todo[i];\n\t\tvar itemF = item.g + item.h;\n\t\tif (f < itemF || (f == itemF && h < item.h)) {\n\t\t\tthis._todo.splice(i, 0, obj);\n\t\t\treturn;\n\t\t}\n\t}\n\t\n\tthis._todo.push(obj);\n};\n\nROT.Path.AStar.prototype._distance = function(x, y) {\n\tswitch (this._options.topology) {\n\t\tcase 4:\n\t\t\treturn (Math.abs(x-this._fromX) + Math.abs(y-this._fromY));\n\t\tbreak;\n\n\t\tcase 6:\n\t\t\tvar dx = Math.abs(x - this._fromX);\n\t\t\tvar dy = Math.abs(y - this._fromY);\n\t\t\treturn dy + Math.max(0, (dx-dy)/2);\n\t\tbreak;\n\n\t\tcase 8: \n\t\t\treturn Math.max(Math.abs(x-this._fromX), Math.abs(y-this._fromY));\n\t\tbreak;\n\t}\n\n        throw new Error(\"Illegal topology\");\n};\n/**\n * @class Terminal backend\n * @private\n */\nROT.Display.Term = function(context) {\n\tROT.Display.Backend.call(this, context);\n\tthis._cx = -1;\n\tthis._cy = -1;\n\tthis._lastColor = \"\";\n\tthis._options = {};\n\tthis._ox = 0;\n\tthis._oy = 0;\n\tthis._termcolor = {};\n}\nROT.Display.Term.extend(ROT.Display.Backend);\n\nROT.Display.Term.prototype.compute = function(options) {\n\tthis._options = options;\n\tthis._ox = Math.floor((process.stdout.columns - options.width) / 2);\n\tthis._oy = Math.floor((process.stdout.rows - options.height) / 2);\n\tthis._termcolor = new ROT.Display.Term[options.termColor.capitalize()](this._context);\n\tthis._context._termcolor = this._termcolor;\n}\n\nROT.Display.Term.prototype.draw = function(data, clearBefore) {\n\t// determine where to draw what with what colors\n\tvar x = data[0];\n\tvar y = data[1];\n\tvar ch = data[2];\n\tvar fg = data[3];\n\tvar bg = data[4];\n\n\t// determine if we need to move the terminal cursor\n\tvar dx = this._ox + x;\n\tvar dy = this._oy + y;\n\tif (dx < 0 || dx >= process.stdout.columns) { return; }\n\tif (dy < 0 || dy >= process.stdout.rows) { return; }\n\tif (dx !== this._cx || dy !== this._cy) {\n\t\tprocess.stdout.write(this._termcolor.positionToAnsi(dx,dy));\n\t\tthis._cx = dx;\n\t\tthis._cy = dy;\n\t}\n\n\t// terminals automatically clear, but if we're clearing when we're\n\t// not otherwise provided with a character, just use a space instead\n\tif (clearBefore) {\n\t\tif (!ch) {\n\t\t\tch = \" \";\n\t\t}\n\t}\n\t\t\n\t// if we're not clearing and not provided with a character, do nothing\n\tif (!ch) { return; }\n\n\t// determine if we need to change colors\n\tvar newColor = this._termcolor.colorToAnsi(fg,bg);\n\tif (newColor !== this._lastColor) {\n\t\tprocess.stdout.write(newColor);\n\t\tthis._lastColor = newColor;\n\t}\n\n\t// write the provided symbol to the display\n\tvar chars = [].concat(ch);\n\tprocess.stdout.write(chars[0]);\n\n\t// update our position, given that we wrote a character\n\tthis._cx++;\n\tif (this._cx >= process.stdout.columns) {\n\t\tthis._cx = 0;\n\t\tthis._cy++;\n\t}\n}\n\nROT.Display.Term.prototype.computeSize = function(availWidth, availHeight) {\n\treturn [process.stdout.columns, process.stdout.rows];\n}\n\nROT.Display.Term.prototype.computeFontSize = function(availWidth, availHeight) {\n\treturn 12;\n}\n\nROT.Display.Term.prototype.eventToPosition = function(x, y) {\n\treturn [x,y]\n}\n/**\n * @class Abstract terminal code module\n * @private\n */\nROT.Display.Term.Color = function(context) {\n\tthis._context = context;\n}\n\nROT.Display.Term.Color.prototype.clearToAnsi = function(bg) {\n}\n\nROT.Display.Term.Color.prototype.colorToAnsi = function(fg, bg) {\n}\n\nROT.Display.Term.Color.prototype.positionToAnsi = function(x, y) {\n}\n/**\n * @class xterm terminal code module\n * @private\n */\nROT.Display.Term.Xterm = function(context) {\n\tROT.Display.Term.Color.call(this, context);\n}\nROT.Display.Term.Xterm.extend(ROT.Display.Term.Color);\n\nROT.Display.Term.Xterm.prototype.clearToAnsi = function(bg) {\n\treturn \"\\x1b[0;48;5;\"\n\t\t+ this._termcolor(bg)\n\t\t+ \"m\\x1b[2J\";\n}\n\nROT.Display.Term.Xterm.prototype.colorToAnsi = function(fg, bg) {\n\treturn \"\\x1b[0;38;5;\"\n\t\t+ this._termcolor(fg)\n\t\t+ \";48;5;\"\n\t\t+ this._termcolor(bg)\n\t\t+ \"m\";\n}\n\nROT.Display.Term.Xterm.prototype.positionToAnsi = function(x, y) {\n\treturn \"\\x1b[\" + (y+1) + \";\" + (x+1) + \"H\";\n}\n\nROT.Display.Term.Xterm.prototype._termcolor = function(color) {\n\tvar SRC_COLORS = 256.0;\n\tvar DST_COLORS = 6.0;\n\tvar COLOR_RATIO = DST_COLORS / SRC_COLORS;\n\tvar rgb = ROT.Color.fromString(color);\n\tvar r = Math.floor(rgb[0] * COLOR_RATIO);\n\tvar g = Math.floor(rgb[1] * COLOR_RATIO);\n\tvar b = Math.floor(rgb[2] * COLOR_RATIO);\n\treturn r*36 + g*6 + b*1 + 16;\n}\n/**\n * Export to Node.js module\n */\nfor (var p in ROT) {\n\texports[p] = ROT[p];\n}\n  return ROT;\n}));\n\n/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../../webpack/buildin/global.js */ \"./node_modules/webpack/buildin/global.js\"), __webpack_require__(/*! ./../../process/browser.js */ \"./node_modules/process/browser.js\")))\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvcm90LWpzL2xpYi9yb3QuanM/MmQyNiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoidURBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQixnQkFBZ0IsRUFBRTtBQUNqRDs7QUFFQTtBQUNBO0FBQ0EsaUNBQWlDO0FBQ2pDO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTixzREFBc0Q7QUFDdEQsd0JBQXdCO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQSxxQ0FBcUM7QUFDckM7QUFDQSw4QkFBOEI7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTiw4QkFBOEI7QUFDOUI7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0EsRUFBRTtBQUNGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBLEtBQUssUUFRTDtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyxLQUFLO0FBQ25CO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEVBQUU7O0FBRUY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQjtBQUMxQjtBQUNBLDJCQUEyQjtBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQixJQUFJLElBQUk7O0FBRTdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTs7QUFFQSxlQUFlLGdCQUFnQjtBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxFQUFFOztBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7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Q0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxnQkFBZ0IsR0FBRyxFQUFFO0FBQ3JCO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLGdCQUFnQixHQUFHLEVBQUU7QUFDckI7QUFDQSxNQUFNLEdBQUcsRUFBRTtBQUNYO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLDRCQUE0QjtBQUM1Qjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyIsImZpbGUiOiIuL25vZGVfbW9kdWxlcy9yb3QtanMvbGliL3JvdC5qcy5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qXG5cdFRoaXMgaXMgcm90LmpzLCB0aGUgUk9ndWVsaWtlIFRvb2xraXQgaW4gSmF2YVNjcmlwdC5cblx0VmVyc2lvbiAwLjd+ZGV2LCBnZW5lcmF0ZWQgb24gVHVlIERlYyAxMiAxMzozNDoyMyBDRVQgMjAxNy5cbiovXG4vKipcbiAqIEFkZCBvYmplY3RzIGZvciBOb2RlLmpzIGVudmlyb25tZW50XG4gKi9cbmdsb2JhbC5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUgPSBmdW5jdGlvbihjYikge1xuXHRyZXR1cm4gc2V0VGltZW91dChmdW5jdGlvbigpIHsgY2IoRGF0ZS5ub3coKSk7IH0sIDEwMDAvNjApO1xufTtcblxuZ2xvYmFsLmRvY3VtZW50ID0ge1xuXHRib2R5OiB7XG5cdFx0YXBwZW5kQ2hpbGQ6IGZ1bmN0aW9uKGNoaWxkKSB7fSxcblx0XHRzY3JvbGxMZWZ0OiAwLFxuXHRcdHNjcm9sbFRvcDogMFxuXHR9LFxuXHRjcmVhdGVFbGVtZW50OiBmdW5jdGlvbih0eXBlKSB7XG5cdFx0dmFyIGNhbnZhcztcblx0XHRyZXR1cm4gY2FudmFzID0ge1xuXHRcdFx0Z2V0Qm91bmRpbmdDbGllbnRSZWN0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0dmFyIHJlY3Q7XG5cdFx0XHRcdHJldHVybiByZWN0ID0ge1xuXHRcdFx0XHRcdGxlZnQ6IDAsXG5cdFx0XHRcdFx0dG9wOiAwXG5cdFx0XHRcdH07XG5cdFx0XHR9LFxuXHRcdFx0Z2V0Q29udGV4dDogZnVuY3Rpb24odHlwZSkge1xuXHRcdFx0XHR2YXIgY29udGV4dDtcblx0XHRcdFx0cmV0dXJuIGNvbnRleHQgPSB7XG5cdFx0XHRcdFx0X3Rlcm1jb2xvcjogbnVsbCxcblx0XHRcdFx0XHRiZWdpblBhdGg6IGZ1bmN0aW9uKCkge30sXG5cdFx0XHRcdFx0Y2FudmFzOiBjYW52YXMsXG5cdFx0XHRcdFx0Y2xlYXJSZWN0OiBmdW5jdGlvbih4LCB5LCB3LCBoKSB7XG5cdFx0XHRcdFx0XHRpZih0aGlzLl90ZXJtY29sb3IgIT09IG51bGwpIHtcblx0XHRcdFx0XHRcdFx0dmFyIGNsZWFyQ21kID0gdGhpcy5fdGVybWNvbG9yLmNsZWFyVG9BbnNpKHRoaXMuZmlsbFN0eWxlKTtcblx0XHRcdFx0XHRcdFx0cHJvY2Vzcy5zdGRvdXQud3JpdGUoY2xlYXJDbWQpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0ZHJhd0ltYWdlOiBmdW5jdGlvbihhLCBiLCBjLCBkLCBlLCBmLCBnLCBoLCBpKSB7fSxcblx0XHRcdFx0XHRmaWxsOiBmdW5jdGlvbigpIHt9LFxuXHRcdFx0XHRcdGZpbGxSZWN0OiBmdW5jdGlvbih4LCB5LCB3LCBoKSB7XG5cdFx0XHRcdFx0XHRpZih0aGlzLl90ZXJtY29sb3IgIT09IG51bGwpIHtcblx0XHRcdFx0XHRcdFx0dmFyIGNsZWFyQ21kID0gdGhpcy5fdGVybWNvbG9yLmNsZWFyVG9BbnNpKHRoaXMuZmlsbFN0eWxlKTtcblx0XHRcdFx0XHRcdFx0cHJvY2Vzcy5zdGRvdXQud3JpdGUoY2xlYXJDbWQpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0ZmlsbFN0eWxlOiBcIiMwMDBcIixcblx0XHRcdFx0XHRmaWxsVGV4dDogZnVuY3Rpb24oY2hzLCB4LCB5KSB7fSxcblx0XHRcdFx0XHRmb250OiBcIm1vbm9zcGFjZVwiLFxuXHRcdFx0XHRcdGxpbmVUbzogZnVuY3Rpb24oeCwgeSkge30sXG5cdFx0XHRcdFx0bWVhc3VyZVRleHQ6IGZ1bmN0aW9uKGNoKSB7XG5cdFx0XHRcdFx0XHR2YXIgcmVzdWx0O1xuXHRcdFx0XHRcdFx0cmV0dXJuIHJlc3VsdCA9IHtcblx0XHRcdFx0XHRcdFx0d2lkdGg6IDEyXG5cdFx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0bW92ZVRvOiBmdW5jdGlvbih4LCB5KSB7fSxcblx0XHRcdFx0XHR0ZXh0QWxpZ246IFwiY2VudGVyXCIsXG5cdFx0XHRcdFx0dGV4dEJhc2VsaW5lOiBcIm1pZGRsZVwiXG5cdFx0XHRcdH07XG5cdFx0XHR9LFxuXHRcdFx0aGVpZ2h0OiAwLFxuXHRcdFx0c3R5bGU6IHtcblx0XHRcdFx0bGVmdDogXCIxMDBweFwiLFxuXHRcdFx0XHRwb3NpdGlvbjogXCJhYnNvbHV0ZVwiLFxuXHRcdFx0XHR0b3A6IFwiMTAwcHhcIixcblx0XHRcdFx0dmlzaWJpbGl0eTogXCJoaWRkZW5cIlxuXHRcdFx0fSxcblx0XHRcdHdpZHRoOiAwXG5cdFx0fTtcblx0fSxcblx0ZG9jdW1lbnRFbGVtZW50OiB7XG5cdFx0c2Nyb2xsTGVmdDogMCxcblx0XHRzY3JvbGxUb3A6IDBcblx0fVxufTtcbihmdW5jdGlvbiAocm9vdCwgZmFjdG9yeSkge1xuICAgIGlmICh0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHtcbiAgICAgICAgLy8gQU1ELiBSZWdpc3RlciBhcyBhbiBhbm9ueW1vdXMgbW9kdWxlLlxuICAgICAgICBkZWZpbmUoW10sIGZhY3RvcnkpO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKSB7XG4gICAgICAgIC8vIE5vZGUuIERvZXMgbm90IHdvcmsgd2l0aCBzdHJpY3QgQ29tbW9uSlMsIGJ1dFxuICAgICAgICAvLyBvbmx5IENvbW1vbkpTLWxpa2UgZW52aXJvbm1lbnRzIHRoYXQgc3VwcG9ydCBtb2R1bGUuZXhwb3J0cyxcbiAgICAgICAgLy8gbGlrZSBOb2RlLlxuICAgICAgICBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICAvLyBCcm93c2VyIGdsb2JhbHMgKHJvb3QgaXMgd2luZG93KVxuICAgICAgICByb290LlJPVCA9IGZhY3RvcnkoKTtcbiAgICB9XG59KHRoaXMsIGZ1bmN0aW9uKCkge1xuLyoqXG4gKiBAbmFtZXNwYWNlIFRvcC1sZXZlbCBST1QgbmFtZXNwYWNlXG4gKi9cbnZhciBST1QgPSB7XG5cdC8qKlxuXHQgKiBAcmV0dXJucyB7Ym9vbH0gSXMgcm90LmpzIHN1cHBvcnRlZCBieSB0aGlzIGJyb3dzZXI/XG5cdCAqL1xuXHRpc1N1cHBvcnRlZDogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuICEhKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIikuZ2V0Q29udGV4dCAmJiBGdW5jdGlvbi5wcm90b3R5cGUuYmluZCk7XG5cdH0sXG5cblx0LyoqIERlZmF1bHQgd2l0aCBmb3IgZGlzcGxheSBhbmQgbWFwIGdlbmVyYXRvcnMgKi9cblx0REVGQVVMVF9XSURUSDogODAsXG5cdC8qKiBEZWZhdWx0IGhlaWdodCBmb3IgZGlzcGxheSBhbmQgbWFwIGdlbmVyYXRvcnMgKi9cblx0REVGQVVMVF9IRUlHSFQ6IDI1LFxuXG5cdC8qKiBEaXJlY3Rpb25hbCBjb25zdGFudHMuIE9yZGVyaW5nIGlzIGltcG9ydGFudCEgKi9cblx0RElSUzoge1xuXHRcdFwiNFwiOiBbXG5cdFx0XHRbIDAsIC0xXSxcblx0XHRcdFsgMSwgIDBdLFxuXHRcdFx0WyAwLCAgMV0sXG5cdFx0XHRbLTEsICAwXVxuXHRcdF0sXG5cdFx0XCI4XCI6IFtcblx0XHRcdFsgMCwgLTFdLFxuXHRcdFx0WyAxLCAtMV0sXG5cdFx0XHRbIDEsICAwXSxcblx0XHRcdFsgMSwgIDFdLFxuXHRcdFx0WyAwLCAgMV0sXG5cdFx0XHRbLTEsICAxXSxcblx0XHRcdFstMSwgIDBdLFxuXHRcdFx0Wy0xLCAtMV1cblx0XHRdLFxuXHRcdFwiNlwiOiBbXG5cdFx0XHRbLTEsIC0xXSxcblx0XHRcdFsgMSwgLTFdLFxuXHRcdFx0WyAyLCAgMF0sXG5cdFx0XHRbIDEsICAxXSxcblx0XHRcdFstMSwgIDFdLFxuXHRcdFx0Wy0yLCAgMF1cblx0XHRdXG5cdH0sXG5cblx0LyoqIENhbmNlbCBrZXkuICovXG5cdFZLX0NBTkNFTDogMywgXG5cdC8qKiBIZWxwIGtleS4gKi9cblx0VktfSEVMUDogNiwgXG5cdC8qKiBCYWNrc3BhY2Uga2V5LiAqL1xuXHRWS19CQUNLX1NQQUNFOiA4LCBcblx0LyoqIFRhYiBrZXkuICovXG5cdFZLX1RBQjogOSwgXG5cdC8qKiA1IGtleSBvbiBOdW1wYWQgd2hlbiBOdW1Mb2NrIGlzIHVubG9ja2VkLiBPciBvbiBNYWMsIGNsZWFyIGtleSB3aGljaCBpcyBwb3NpdGlvbmVkIGF0IE51bUxvY2sga2V5LiAqL1xuXHRWS19DTEVBUjogMTIsIFxuXHQvKiogUmV0dXJuL2VudGVyIGtleSBvbiB0aGUgbWFpbiBrZXlib2FyZC4gKi9cblx0VktfUkVUVVJOOiAxMywgXG5cdC8qKiBSZXNlcnZlZCwgYnV0IG5vdCB1c2VkLiAqL1xuXHRWS19FTlRFUjogMTQsIFxuXHQvKiogU2hpZnQga2V5LiAqL1xuXHRWS19TSElGVDogMTYsIFxuXHQvKiogQ29udHJvbCBrZXkuICovXG5cdFZLX0NPTlRST0w6IDE3LCBcblx0LyoqIEFsdCAoT3B0aW9uIG9uIE1hYykga2V5LiAqL1xuXHRWS19BTFQ6IDE4LCBcblx0LyoqIFBhdXNlIGtleS4gKi9cblx0VktfUEFVU0U6IDE5LCBcblx0LyoqIENhcHMgbG9jay4gKi9cblx0VktfQ0FQU19MT0NLOiAyMCwgXG5cdC8qKiBFc2NhcGUga2V5LiAqL1xuXHRWS19FU0NBUEU6IDI3LCBcblx0LyoqIFNwYWNlIGJhci4gKi9cblx0VktfU1BBQ0U6IDMyLCBcblx0LyoqIFBhZ2UgVXAga2V5LiAqL1xuXHRWS19QQUdFX1VQOiAzMywgXG5cdC8qKiBQYWdlIERvd24ga2V5LiAqL1xuXHRWS19QQUdFX0RPV046IDM0LCBcblx0LyoqIEVuZCBrZXkuICovXG5cdFZLX0VORDogMzUsIFxuXHQvKiogSG9tZSBrZXkuICovXG5cdFZLX0hPTUU6IDM2LCBcblx0LyoqIExlZnQgYXJyb3cuICovXG5cdFZLX0xFRlQ6IDM3LCBcblx0LyoqIFVwIGFycm93LiAqL1xuXHRWS19VUDogMzgsIFxuXHQvKiogUmlnaHQgYXJyb3cuICovXG5cdFZLX1JJR0hUOiAzOSwgXG5cdC8qKiBEb3duIGFycm93LiAqL1xuXHRWS19ET1dOOiA0MCwgXG5cdC8qKiBQcmludCBTY3JlZW4ga2V5LiAqL1xuXHRWS19QUklOVFNDUkVFTjogNDQsIFxuXHQvKiogSW5zKGVydCkga2V5LiAqL1xuXHRWS19JTlNFUlQ6IDQ1LCBcblx0LyoqIERlbChldGUpIGtleS4gKi9cblx0VktfREVMRVRFOiA0NiwgXG5cdC8qKiovXG5cdFZLXzA6IDQ4LFxuXHQvKioqL1xuXHRWS18xOiA0OSxcblx0LyoqKi9cblx0VktfMjogNTAsXG5cdC8qKiovXG5cdFZLXzM6IDUxLFxuXHQvKioqL1xuXHRWS180OiA1Mixcblx0LyoqKi9cblx0VktfNTogNTMsXG5cdC8qKiovXG5cdFZLXzY6IDU0LFxuXHQvKioqL1xuXHRWS183OiA1NSxcblx0LyoqKi9cblx0VktfODogNTYsXG5cdC8qKiovXG5cdFZLXzk6IDU3LFxuXHQvKiogQ29sb24gKDopIGtleS4gUmVxdWlyZXMgR2Vja28gMTUuMCAqL1xuXHRWS19DT0xPTjogNTgsIFxuXHQvKiogU2VtaWNvbG9uICg7KSBrZXkuICovXG5cdFZLX1NFTUlDT0xPTjogNTksIFxuXHQvKiogTGVzcy10aGFuICg8KSBrZXkuIFJlcXVpcmVzIEdlY2tvIDE1LjAgKi9cblx0VktfTEVTU19USEFOOiA2MCwgXG5cdC8qKiBFcXVhbHMgKD0pIGtleS4gKi9cblx0VktfRVFVQUxTOiA2MSwgXG5cdC8qKiBHcmVhdGVyLXRoYW4gKD4pIGtleS4gUmVxdWlyZXMgR2Vja28gMTUuMCAqL1xuXHRWS19HUkVBVEVSX1RIQU46IDYyLCBcblx0LyoqIFF1ZXN0aW9uIG1hcmsgKD8pIGtleS4gUmVxdWlyZXMgR2Vja28gMTUuMCAqL1xuXHRWS19RVUVTVElPTl9NQVJLOiA2MywgXG5cdC8qKiBBdG1hcmsgKEApIGtleS4gUmVxdWlyZXMgR2Vja28gMTUuMCAqL1xuXHRWS19BVDogNjQsIFxuXHQvKioqL1xuXHRWS19BOiA2NSxcblx0LyoqKi9cblx0VktfQjogNjYsXG5cdC8qKiovXG5cdFZLX0M6IDY3LFxuXHQvKioqL1xuXHRWS19EOiA2OCxcblx0LyoqKi9cblx0VktfRTogNjksXG5cdC8qKiovXG5cdFZLX0Y6IDcwLFxuXHQvKioqL1xuXHRWS19HOiA3MSxcblx0LyoqKi9cblx0VktfSDogNzIsXG5cdC8qKiovXG5cdFZLX0k6IDczLFxuXHQvKioqL1xuXHRWS19KOiA3NCxcblx0LyoqKi9cblx0VktfSzogNzUsXG5cdC8qKiovXG5cdFZLX0w6IDc2LFxuXHQvKioqL1xuXHRWS19NOiA3Nyxcblx0LyoqKi9cblx0VktfTjogNzgsXG5cdC8qKiovXG5cdFZLX086IDc5LFxuXHQvKioqL1xuXHRWS19QOiA4MCxcblx0LyoqKi9cblx0VktfUTogODEsXG5cdC8qKiovXG5cdFZLX1I6IDgyLFxuXHQvKioqL1xuXHRWS19TOiA4Myxcblx0LyoqKi9cblx0VktfVDogODQsXG5cdC8qKiovXG5cdFZLX1U6IDg1LFxuXHQvKioqL1xuXHRWS19WOiA4Nixcblx0LyoqKi9cblx0VktfVzogODcsXG5cdC8qKiovXG5cdFZLX1g6IDg4LFxuXHQvKioqL1xuXHRWS19ZOiA4OSxcblx0LyoqKi9cblx0VktfWjogOTAsXG5cdC8qKiovXG5cdFZLX0NPTlRFWFRfTUVOVTogOTMsXG5cdC8qKiAwIG9uIHRoZSBudW1lcmljIGtleXBhZC4gKi9cblx0VktfTlVNUEFEMDogOTYsIFxuXHQvKiogMSBvbiB0aGUgbnVtZXJpYyBrZXlwYWQuICovXG5cdFZLX05VTVBBRDE6IDk3LCBcblx0LyoqIDIgb24gdGhlIG51bWVyaWMga2V5cGFkLiAqL1xuXHRWS19OVU1QQUQyOiA5OCwgXG5cdC8qKiAzIG9uIHRoZSBudW1lcmljIGtleXBhZC4gKi9cblx0VktfTlVNUEFEMzogOTksIFxuXHQvKiogNCBvbiB0aGUgbnVtZXJpYyBrZXlwYWQuICovXG5cdFZLX05VTVBBRDQ6IDEwMCwgXG5cdC8qKiA1IG9uIHRoZSBudW1lcmljIGtleXBhZC4gKi9cblx0VktfTlVNUEFENTogMTAxLCBcblx0LyoqIDYgb24gdGhlIG51bWVyaWMga2V5cGFkLiAqL1xuXHRWS19OVU1QQUQ2OiAxMDIsIFxuXHQvKiogNyBvbiB0aGUgbnVtZXJpYyBrZXlwYWQuICovXG5cdFZLX05VTVBBRDc6IDEwMywgXG5cdC8qKiA4IG9uIHRoZSBudW1lcmljIGtleXBhZC4gKi9cblx0VktfTlVNUEFEODogMTA0LCBcblx0LyoqIDkgb24gdGhlIG51bWVyaWMga2V5cGFkLiAqL1xuXHRWS19OVU1QQUQ5OiAxMDUsIFxuXHQvKiogKiBvbiB0aGUgbnVtZXJpYyBrZXlwYWQuICovXG5cdFZLX01VTFRJUExZOiAxMDYsXG5cdC8qKiArIG9uIHRoZSBudW1lcmljIGtleXBhZC4gKi9cblx0VktfQUREOiAxMDcsIFxuXHQvKioqL1xuXHRWS19TRVBBUkFUT1I6IDEwOCxcblx0LyoqIC0gb24gdGhlIG51bWVyaWMga2V5cGFkLiAqL1xuXHRWS19TVUJUUkFDVDogMTA5LCBcblx0LyoqIERlY2ltYWwgcG9pbnQgb24gdGhlIG51bWVyaWMga2V5cGFkLiAqL1xuXHRWS19ERUNJTUFMOiAxMTAsIFxuXHQvKiogLyBvbiB0aGUgbnVtZXJpYyBrZXlwYWQuICovXG5cdFZLX0RJVklERTogMTExLCBcblx0LyoqIEYxIGtleS4gKi9cblx0VktfRjE6IDExMiwgXG5cdC8qKiBGMiBrZXkuICovXG5cdFZLX0YyOiAxMTMsIFxuXHQvKiogRjMga2V5LiAqL1xuXHRWS19GMzogMTE0LCBcblx0LyoqIEY0IGtleS4gKi9cblx0VktfRjQ6IDExNSwgXG5cdC8qKiBGNSBrZXkuICovXG5cdFZLX0Y1OiAxMTYsIFxuXHQvKiogRjYga2V5LiAqL1xuXHRWS19GNjogMTE3LCBcblx0LyoqIEY3IGtleS4gKi9cblx0VktfRjc6IDExOCwgXG5cdC8qKiBGOCBrZXkuICovXG5cdFZLX0Y4OiAxMTksIFxuXHQvKiogRjkga2V5LiAqL1xuXHRWS19GOTogMTIwLCBcblx0LyoqIEYxMCBrZXkuICovXG5cdFZLX0YxMDogMTIxLCBcblx0LyoqIEYxMSBrZXkuICovXG5cdFZLX0YxMTogMTIyLCBcblx0LyoqIEYxMiBrZXkuICovXG5cdFZLX0YxMjogMTIzLCBcblx0LyoqIEYxMyBrZXkuICovXG5cdFZLX0YxMzogMTI0LCBcblx0LyoqIEYxNCBrZXkuICovXG5cdFZLX0YxNDogMTI1LCBcblx0LyoqIEYxNSBrZXkuICovXG5cdFZLX0YxNTogMTI2LCBcblx0LyoqIEYxNiBrZXkuICovXG5cdFZLX0YxNjogMTI3LCBcblx0LyoqIEYxNyBrZXkuICovXG5cdFZLX0YxNzogMTI4LCBcblx0LyoqIEYxOCBrZXkuICovXG5cdFZLX0YxODogMTI5LCBcblx0LyoqIEYxOSBrZXkuICovXG5cdFZLX0YxOTogMTMwLCBcblx0LyoqIEYyMCBrZXkuICovXG5cdFZLX0YyMDogMTMxLCBcblx0LyoqIEYyMSBrZXkuICovXG5cdFZLX0YyMTogMTMyLCBcblx0LyoqIEYyMiBrZXkuICovXG5cdFZLX0YyMjogMTMzLCBcblx0LyoqIEYyMyBrZXkuICovXG5cdFZLX0YyMzogMTM0LCBcblx0LyoqIEYyNCBrZXkuICovXG5cdFZLX0YyNDogMTM1LCBcblx0LyoqIE51bSBMb2NrIGtleS4gKi9cblx0VktfTlVNX0xPQ0s6IDE0NCwgXG5cdC8qKiBTY3JvbGwgTG9jayBrZXkuICovXG5cdFZLX1NDUk9MTF9MT0NLOiAxNDUsIFxuXHQvKiogQ2lyY3VtZmxleCAoXikga2V5LiBSZXF1aXJlcyBHZWNrbyAxNS4wICovXG5cdFZLX0NJUkNVTUZMRVg6IDE2MCwgXG5cdC8qKiBFeGNsYW1hdGlvbiAoISkga2V5LiBSZXF1aXJlcyBHZWNrbyAxNS4wICovXG5cdFZLX0VYQ0xBTUFUSU9OOiAxNjEsIFxuXHQvKiogRG91YmxlIHF1b3RlICgpIGtleS4gUmVxdWlyZXMgR2Vja28gMTUuMCAqL1xuXHRWS19ET1VCTEVfUVVPVEU6IDE2MiwgXG5cdC8qKiBIYXNoICgjKSBrZXkuIFJlcXVpcmVzIEdlY2tvIDE1LjAgKi9cblx0VktfSEFTSDogMTYzLCBcblx0LyoqIERvbGxhciBzaWduICgkKSBrZXkuIFJlcXVpcmVzIEdlY2tvIDE1LjAgKi9cblx0VktfRE9MTEFSOiAxNjQsIFxuXHQvKiogUGVyY2VudCAoJSkga2V5LiBSZXF1aXJlcyBHZWNrbyAxNS4wICovXG5cdFZLX1BFUkNFTlQ6IDE2NSwgXG5cdC8qKiBBbXBlcnNhbmQgKCYpIGtleS4gUmVxdWlyZXMgR2Vja28gMTUuMCAqL1xuXHRWS19BTVBFUlNBTkQ6IDE2NiwgXG5cdC8qKiBVbmRlcnNjb3JlIChfKSBrZXkuIFJlcXVpcmVzIEdlY2tvIDE1LjAgKi9cblx0VktfVU5ERVJTQ09SRTogMTY3LCBcblx0LyoqIE9wZW4gcGFyZW50aGVzaXMgKCgpIGtleS4gUmVxdWlyZXMgR2Vja28gMTUuMCAqL1xuXHRWS19PUEVOX1BBUkVOOiAxNjgsIFxuXHQvKiogQ2xvc2UgcGFyZW50aGVzaXMgKCkpIGtleS4gUmVxdWlyZXMgR2Vja28gMTUuMCAqL1xuXHRWS19DTE9TRV9QQVJFTjogMTY5LCBcblx0LyogQXN0ZXJpc2sgKCopIGtleS4gUmVxdWlyZXMgR2Vja28gMTUuMCAqL1xuXHRWS19BU1RFUklTSzogMTcwLFxuXHQvKiogUGx1cyAoKykga2V5LiBSZXF1aXJlcyBHZWNrbyAxNS4wICovXG5cdFZLX1BMVVM6IDE3MSwgXG5cdC8qKiBQaXBlICh8KSBrZXkuIFJlcXVpcmVzIEdlY2tvIDE1LjAgKi9cblx0VktfUElQRTogMTcyLCBcblx0LyoqIEh5cGhlbi1VUy9kb2NzL01pbnVzICgtKSBrZXkuIFJlcXVpcmVzIEdlY2tvIDE1LjAgKi9cblx0VktfSFlQSEVOX01JTlVTOiAxNzMsIFxuXHQvKiogT3BlbiBjdXJseSBicmFja2V0ICh7KSBrZXkuIFJlcXVpcmVzIEdlY2tvIDE1LjAgKi9cblx0VktfT1BFTl9DVVJMWV9CUkFDS0VUOiAxNzQsIFxuXHQvKiogQ2xvc2UgY3VybHkgYnJhY2tldCAofSkga2V5LiBSZXF1aXJlcyBHZWNrbyAxNS4wICovXG5cdFZLX0NMT1NFX0NVUkxZX0JSQUNLRVQ6IDE3NSwgXG5cdC8qKiBUaWxkZSAofikga2V5LiBSZXF1aXJlcyBHZWNrbyAxNS4wICovXG5cdFZLX1RJTERFOiAxNzYsIFxuXHQvKiogQ29tbWEgKCwpIGtleS4gKi9cblx0VktfQ09NTUE6IDE4OCwgXG5cdC8qKiBQZXJpb2QgKC4pIGtleS4gKi9cblx0VktfUEVSSU9EOiAxOTAsIFxuXHQvKiogU2xhc2ggKC8pIGtleS4gKi9cblx0VktfU0xBU0g6IDE5MSwgXG5cdC8qKiBCYWNrIHRpY2sgKGApIGtleS4gKi9cblx0VktfQkFDS19RVU9URTogMTkyLCBcblx0LyoqIE9wZW4gc3F1YXJlIGJyYWNrZXQgKFspIGtleS4gKi9cblx0VktfT1BFTl9CUkFDS0VUOiAyMTksIFxuXHQvKiogQmFjayBzbGFzaCAoXFwpIGtleS4gKi9cblx0VktfQkFDS19TTEFTSDogMjIwLCBcblx0LyoqIENsb3NlIHNxdWFyZSBicmFja2V0IChdKSBrZXkuICovXG5cdFZLX0NMT1NFX0JSQUNLRVQ6IDIyMSwgXG5cdC8qKiBRdW90ZSAoJycnKSBrZXkuICovXG5cdFZLX1FVT1RFOiAyMjIsIFxuXHQvKiogTWV0YSBrZXkgb24gTGludXgsIENvbW1hbmQga2V5IG9uIE1hYy4gKi9cblx0VktfTUVUQTogMjI0LCBcblx0LyoqIEFsdEdyIGtleSBvbiBMaW51eC4gUmVxdWlyZXMgR2Vja28gMTUuMCAqL1xuXHRWS19BTFRHUjogMjI1LCBcblx0LyoqIFdpbmRvd3MgbG9nbyBrZXkgb24gV2luZG93cy4gT3IgU3VwZXIgb3IgSHlwZXIga2V5IG9uIExpbnV4LiBSZXF1aXJlcyBHZWNrbyAxNS4wICovXG5cdFZLX1dJTjogOTEsIFxuXHQvKiogTGludXggc3VwcG9ydCBmb3IgdGhpcyBrZXljb2RlIHdhcyBhZGRlZCBpbiBHZWNrbyA0LjAuICovXG5cdFZLX0tBTkE6IDIxLCBcblx0LyoqIExpbnV4IHN1cHBvcnQgZm9yIHRoaXMga2V5Y29kZSB3YXMgYWRkZWQgaW4gR2Vja28gNC4wLiAqL1xuXHRWS19IQU5HVUw6IDIxLCBcblx0LyoqIOiLseaVsCBrZXkgb24gSmFwYW5lc2UgTWFjIGtleWJvYXJkLiBSZXF1aXJlcyBHZWNrbyAxNS4wICovXG5cdFZLX0VJU1U6IDIyLCBcblx0LyoqIExpbnV4IHN1cHBvcnQgZm9yIHRoaXMga2V5Y29kZSB3YXMgYWRkZWQgaW4gR2Vja28gNC4wLiAqL1xuXHRWS19KVU5KQTogMjMsIFxuXHQvKiogTGludXggc3VwcG9ydCBmb3IgdGhpcyBrZXljb2RlIHdhcyBhZGRlZCBpbiBHZWNrbyA0LjAuICovXG5cdFZLX0ZJTkFMOiAyNCwgXG5cdC8qKiBMaW51eCBzdXBwb3J0IGZvciB0aGlzIGtleWNvZGUgd2FzIGFkZGVkIGluIEdlY2tvIDQuMC4gKi9cblx0VktfSEFOSkE6IDI1LCBcblx0LyoqIExpbnV4IHN1cHBvcnQgZm9yIHRoaXMga2V5Y29kZSB3YXMgYWRkZWQgaW4gR2Vja28gNC4wLiAqL1xuXHRWS19LQU5KSTogMjUsIFxuXHQvKiogTGludXggc3VwcG9ydCBmb3IgdGhpcyBrZXljb2RlIHdhcyBhZGRlZCBpbiBHZWNrbyA0LjAuICovXG5cdFZLX0NPTlZFUlQ6IDI4LCBcblx0LyoqIExpbnV4IHN1cHBvcnQgZm9yIHRoaXMga2V5Y29kZSB3YXMgYWRkZWQgaW4gR2Vja28gNC4wLiAqL1xuXHRWS19OT05DT05WRVJUOiAyOSwgXG5cdC8qKiBMaW51eCBzdXBwb3J0IGZvciB0aGlzIGtleWNvZGUgd2FzIGFkZGVkIGluIEdlY2tvIDQuMC4gKi9cblx0VktfQUNDRVBUOiAzMCwgXG5cdC8qKiBMaW51eCBzdXBwb3J0IGZvciB0aGlzIGtleWNvZGUgd2FzIGFkZGVkIGluIEdlY2tvIDQuMC4gKi9cblx0VktfTU9ERUNIQU5HRTogMzEsIFxuXHQvKiogTGludXggc3VwcG9ydCBmb3IgdGhpcyBrZXljb2RlIHdhcyBhZGRlZCBpbiBHZWNrbyA0LjAuICovXG5cdFZLX1NFTEVDVDogNDEsIFxuXHQvKiogTGludXggc3VwcG9ydCBmb3IgdGhpcyBrZXljb2RlIHdhcyBhZGRlZCBpbiBHZWNrbyA0LjAuICovXG5cdFZLX1BSSU5UOiA0MiwgXG5cdC8qKiBMaW51eCBzdXBwb3J0IGZvciB0aGlzIGtleWNvZGUgd2FzIGFkZGVkIGluIEdlY2tvIDQuMC4gKi9cblx0VktfRVhFQ1VURTogNDMsIFxuXHQvKiogTGludXggc3VwcG9ydCBmb3IgdGhpcyBrZXljb2RlIHdhcyBhZGRlZCBpbiBHZWNrbyA0LjAuXHQgKi9cblx0VktfU0xFRVA6IDk1IFxufTtcbi8qKlxuICogQG5hbWVzcGFjZVxuICogQ29udGFpbnMgdGV4dCB0b2tlbml6YXRpb24gYW5kIGJyZWFraW5nIHJvdXRpbmVzXG4gKi9cblJPVC5UZXh0ID0ge1xuXHRSRV9DT0xPUlM6IC8lKFtiY10peyhbXn1dKil9L2csXG5cblx0LyogdG9rZW4gdHlwZXMgKi9cblx0VFlQRV9URVhUOlx0XHQwLFxuXHRUWVBFX05FV0xJTkU6XHQxLFxuXHRUWVBFX0ZHOlx0XHQyLFxuXHRUWVBFX0JHOlx0XHQzLFxuXG5cdC8qKlxuXHQgKiBNZWFzdXJlIHNpemUgb2YgYSByZXN1bHRpbmcgdGV4dCBibG9ja1xuXHQgKi9cblx0bWVhc3VyZTogZnVuY3Rpb24oc3RyLCBtYXhXaWR0aCkge1xuXHRcdHZhciByZXN1bHQgPSB7d2lkdGg6MCwgaGVpZ2h0OjF9O1xuXHRcdHZhciB0b2tlbnMgPSB0aGlzLnRva2VuaXplKHN0ciwgbWF4V2lkdGgpO1xuXHRcdHZhciBsaW5lV2lkdGggPSAwO1xuXG5cdFx0Zm9yICh2YXIgaT0wO2k8dG9rZW5zLmxlbmd0aDtpKyspIHtcblx0XHRcdHZhciB0b2tlbiA9IHRva2Vuc1tpXTtcblx0XHRcdHN3aXRjaCAodG9rZW4udHlwZSkge1xuXHRcdFx0XHRjYXNlIHRoaXMuVFlQRV9URVhUOlxuXHRcdFx0XHRcdGxpbmVXaWR0aCArPSB0b2tlbi52YWx1ZS5sZW5ndGg7XG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdGNhc2UgdGhpcy5UWVBFX05FV0xJTkU6XG5cdFx0XHRcdFx0cmVzdWx0LmhlaWdodCsrO1xuXHRcdFx0XHRcdHJlc3VsdC53aWR0aCA9IE1hdGgubWF4KHJlc3VsdC53aWR0aCwgbGluZVdpZHRoKTtcblx0XHRcdFx0XHRsaW5lV2lkdGggPSAwO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdH1cblx0XHR9XG5cdFx0cmVzdWx0LndpZHRoID0gTWF0aC5tYXgocmVzdWx0LndpZHRoLCBsaW5lV2lkdGgpO1xuXG5cdFx0cmV0dXJuIHJlc3VsdDtcblx0fSxcblxuXHQvKipcblx0ICogQ29udmVydCBzdHJpbmcgdG8gYSBzZXJpZXMgb2YgYSBmb3JtYXR0aW5nIGNvbW1hbmRzXG5cdCAqL1xuXHR0b2tlbml6ZTogZnVuY3Rpb24oc3RyLCBtYXhXaWR0aCkge1xuXHRcdHZhciByZXN1bHQgPSBbXTtcblxuXHRcdC8qIGZpcnN0IHRva2VuaXphdGlvbiBwYXNzIC0gc3BsaXQgdGV4dHMgYW5kIGNvbG9yIGZvcm1hdHRpbmcgY29tbWFuZHMgKi9cblx0XHR2YXIgb2Zmc2V0ID0gMDtcblx0XHRzdHIucmVwbGFjZSh0aGlzLlJFX0NPTE9SUywgZnVuY3Rpb24obWF0Y2gsIHR5cGUsIG5hbWUsIGluZGV4KSB7XG5cdFx0XHQvKiBzdHJpbmcgYmVmb3JlICovXG5cdFx0XHR2YXIgcGFydCA9IHN0ci5zdWJzdHJpbmcob2Zmc2V0LCBpbmRleCk7XG5cdFx0XHRpZiAocGFydC5sZW5ndGgpIHtcblx0XHRcdFx0cmVzdWx0LnB1c2goe1xuXHRcdFx0XHRcdHR5cGU6IFJPVC5UZXh0LlRZUEVfVEVYVCxcblx0XHRcdFx0XHR2YWx1ZTogcGFydFxuXHRcdFx0XHR9KTtcblx0XHRcdH1cblxuXHRcdFx0LyogY29sb3IgY29tbWFuZCAqL1xuXHRcdFx0cmVzdWx0LnB1c2goe1xuXHRcdFx0XHR0eXBlOiAodHlwZSA9PSBcImNcIiA/IFJPVC5UZXh0LlRZUEVfRkcgOiBST1QuVGV4dC5UWVBFX0JHKSxcblx0XHRcdFx0dmFsdWU6IG5hbWUudHJpbSgpXG5cdFx0XHR9KTtcblxuXHRcdFx0b2Zmc2V0ID0gaW5kZXggKyBtYXRjaC5sZW5ndGg7XG5cdFx0XHRyZXR1cm4gXCJcIjtcblx0XHR9KTtcblxuXHRcdC8qIGxhc3QgcmVtYWluaW5nIHBhcnQgKi9cblx0XHR2YXIgcGFydCA9IHN0ci5zdWJzdHJpbmcob2Zmc2V0KTtcblx0XHRpZiAocGFydC5sZW5ndGgpIHtcblx0XHRcdHJlc3VsdC5wdXNoKHtcblx0XHRcdFx0dHlwZTogUk9ULlRleHQuVFlQRV9URVhULFxuXHRcdFx0XHR2YWx1ZTogcGFydFxuXHRcdFx0fSk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHRoaXMuX2JyZWFrTGluZXMocmVzdWx0LCBtYXhXaWR0aCk7XG5cdH0sXG5cblx0LyogaW5zZXJ0IGxpbmUgYnJlYWtzIGludG8gZmlyc3QtcGFzcyB0b2tlbml6ZWQgZGF0YSAqL1xuXHRfYnJlYWtMaW5lczogZnVuY3Rpb24odG9rZW5zLCBtYXhXaWR0aCkge1xuXHRcdGlmICghbWF4V2lkdGgpIHsgbWF4V2lkdGggPSBJbmZpbml0eTsgfVxuXG5cdFx0dmFyIGkgPSAwO1xuXHRcdHZhciBsaW5lTGVuZ3RoID0gMDtcblx0XHR2YXIgbGFzdFRva2VuV2l0aFNwYWNlID0gLTE7XG5cblx0XHR3aGlsZSAoaSA8IHRva2Vucy5sZW5ndGgpIHsgLyogdGFrZSBhbGwgdGV4dCB0b2tlbnMsIHJlbW92ZSBzcGFjZSwgYXBwbHkgbGluZWJyZWFrcyAqL1xuXHRcdFx0dmFyIHRva2VuID0gdG9rZW5zW2ldO1xuXHRcdFx0aWYgKHRva2VuLnR5cGUgPT0gUk9ULlRleHQuVFlQRV9ORVdMSU5FKSB7IC8qIHJlc2V0ICovXG5cdFx0XHRcdGxpbmVMZW5ndGggPSAwOyBcblx0XHRcdFx0bGFzdFRva2VuV2l0aFNwYWNlID0gLTE7XG5cdFx0XHR9XG5cdFx0XHRpZiAodG9rZW4udHlwZSAhPSBST1QuVGV4dC5UWVBFX1RFWFQpIHsgLyogc2tpcCBub24tdGV4dCB0b2tlbnMgKi9cblx0XHRcdFx0aSsrO1xuXHRcdFx0XHRjb250aW51ZTsgXG5cdFx0XHR9XG5cblx0XHRcdC8qIHJlbW92ZSBzcGFjZXMgYXQgdGhlIGJlZ2lubmluZyBvZiBsaW5lICovXG5cdFx0XHR3aGlsZSAobGluZUxlbmd0aCA9PSAwICYmIHRva2VuLnZhbHVlLmNoYXJBdCgwKSA9PSBcIiBcIikgeyB0b2tlbi52YWx1ZSA9IHRva2VuLnZhbHVlLnN1YnN0cmluZygxKTsgfVxuXG5cdFx0XHQvKiBmb3JjZWQgbmV3bGluZT8gaW5zZXJ0IHR3byBuZXcgdG9rZW5zIGFmdGVyIHRoaXMgb25lICovXG5cdFx0XHR2YXIgaW5kZXggPSB0b2tlbi52YWx1ZS5pbmRleE9mKFwiXFxuXCIpO1xuXHRcdFx0aWYgKGluZGV4ICE9IC0xKSB7IFxuXHRcdFx0XHR0b2tlbi52YWx1ZSA9IHRoaXMuX2JyZWFrSW5zaWRlVG9rZW4odG9rZW5zLCBpLCBpbmRleCwgdHJ1ZSk7IFxuXG5cdFx0XHRcdC8qIGlmIHRoZXJlIGFyZSBzcGFjZXMgYXQgdGhlIGVuZCwgd2UgbXVzdCByZW1vdmUgdGhlbSAod2UgZG8gbm90IHdhbnQgdGhlIGxpbmUgdG9vIGxvbmcpICovXG5cdFx0XHRcdHZhciBhcnIgPSB0b2tlbi52YWx1ZS5zcGxpdChcIlwiKTtcblx0XHRcdFx0d2hpbGUgKGFyci5sZW5ndGggJiYgYXJyW2Fyci5sZW5ndGgtMV0gPT0gXCIgXCIpIHsgYXJyLnBvcCgpOyB9XG5cdFx0XHRcdHRva2VuLnZhbHVlID0gYXJyLmpvaW4oXCJcIik7XG5cdFx0XHR9XG5cblx0XHRcdC8qIHRva2VuIGRlZ2VuZXJhdGVkPyAqL1xuXHRcdFx0aWYgKCF0b2tlbi52YWx1ZS5sZW5ndGgpIHtcblx0XHRcdFx0dG9rZW5zLnNwbGljZShpLCAxKTtcblx0XHRcdFx0Y29udGludWU7XG5cdFx0XHR9XG5cblx0XHRcdGlmIChsaW5lTGVuZ3RoICsgdG9rZW4udmFsdWUubGVuZ3RoID4gbWF4V2lkdGgpIHsgLyogbGluZSB0b28gbG9uZywgZmluZCBhIHN1aXRhYmxlIGJyZWFraW5nIHNwb3QgKi9cblxuXHRcdFx0XHQvKiBpcyBpdCBwb3NzaWJsZSB0byBicmVhayB3aXRoaW4gdGhpcyB0b2tlbj8gKi9cblx0XHRcdFx0dmFyIGluZGV4ID0gLTE7XG5cdFx0XHRcdHdoaWxlICgxKSB7XG5cdFx0XHRcdFx0dmFyIG5leHRJbmRleCA9IHRva2VuLnZhbHVlLmluZGV4T2YoXCIgXCIsIGluZGV4KzEpO1xuXHRcdFx0XHRcdGlmIChuZXh0SW5kZXggPT0gLTEpIHsgYnJlYWs7IH1cblx0XHRcdFx0XHRpZiAobGluZUxlbmd0aCArIG5leHRJbmRleCA+IG1heFdpZHRoKSB7IGJyZWFrOyB9XG5cdFx0XHRcdFx0aW5kZXggPSBuZXh0SW5kZXg7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAoaW5kZXggIT0gLTEpIHsgLyogYnJlYWsgYXQgc3BhY2Ugd2l0aGluIHRoaXMgb25lICovXG5cdFx0XHRcdFx0dG9rZW4udmFsdWUgPSB0aGlzLl9icmVha0luc2lkZVRva2VuKHRva2VucywgaSwgaW5kZXgsIHRydWUpO1xuXHRcdFx0XHR9IGVsc2UgaWYgKGxhc3RUb2tlbldpdGhTcGFjZSAhPSAtMSkgeyAvKiBpcyB0aGVyZSBhIHByZXZpb3VzIHRva2VuIHdoZXJlIGEgYnJlYWsgY2FuIG9jY3VyPyAqL1xuXHRcdFx0XHRcdHZhciB0b2tlbiA9IHRva2Vuc1tsYXN0VG9rZW5XaXRoU3BhY2VdO1xuXHRcdFx0XHRcdHZhciBicmVha0luZGV4ID0gdG9rZW4udmFsdWUubGFzdEluZGV4T2YoXCIgXCIpO1xuXHRcdFx0XHRcdHRva2VuLnZhbHVlID0gdGhpcy5fYnJlYWtJbnNpZGVUb2tlbih0b2tlbnMsIGxhc3RUb2tlbldpdGhTcGFjZSwgYnJlYWtJbmRleCwgdHJ1ZSk7XG5cdFx0XHRcdFx0aSA9IGxhc3RUb2tlbldpdGhTcGFjZTtcblx0XHRcdFx0fSBlbHNlIHsgLyogZm9yY2UgYnJlYWsgaW4gdGhpcyB0b2tlbiAqL1xuXHRcdFx0XHRcdHRva2VuLnZhbHVlID0gdGhpcy5fYnJlYWtJbnNpZGVUb2tlbih0b2tlbnMsIGksIG1heFdpZHRoLWxpbmVMZW5ndGgsIGZhbHNlKTtcblx0XHRcdFx0fVxuXG5cdFx0XHR9IGVsc2UgeyAvKiBsaW5lIG5vdCBsb25nLCBjb250aW51ZSAqL1xuXHRcdFx0XHRsaW5lTGVuZ3RoICs9IHRva2VuLnZhbHVlLmxlbmd0aDtcblx0XHRcdFx0aWYgKHRva2VuLnZhbHVlLmluZGV4T2YoXCIgXCIpICE9IC0xKSB7IGxhc3RUb2tlbldpdGhTcGFjZSA9IGk7IH1cblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0aSsrOyAvKiBhZHZhbmNlIHRvIG5leHQgdG9rZW4gKi9cblx0XHR9XG5cblxuXHRcdHRva2Vucy5wdXNoKHt0eXBlOiBST1QuVGV4dC5UWVBFX05FV0xJTkV9KTsgLyogaW5zZXJ0IGZha2UgbmV3bGluZSB0byBmaXggdGhlIGxhc3QgdGV4dCBsaW5lICovXG5cblx0XHQvKiByZW1vdmUgdHJhaWxpbmcgc3BhY2UgZnJvbSB0ZXh0IHRva2VucyBiZWZvcmUgbmV3bGluZXMgKi9cblx0XHR2YXIgbGFzdFRleHRUb2tlbiA9IG51bGw7XG5cdFx0Zm9yICh2YXIgaT0wO2k8dG9rZW5zLmxlbmd0aDtpKyspIHtcblx0XHRcdHZhciB0b2tlbiA9IHRva2Vuc1tpXTtcblx0XHRcdHN3aXRjaCAodG9rZW4udHlwZSkge1xuXHRcdFx0XHRjYXNlIFJPVC5UZXh0LlRZUEVfVEVYVDogbGFzdFRleHRUb2tlbiA9IHRva2VuOyBicmVhaztcblx0XHRcdFx0Y2FzZSBST1QuVGV4dC5UWVBFX05FV0xJTkU6IFxuXHRcdFx0XHRcdGlmIChsYXN0VGV4dFRva2VuKSB7IC8qIHJlbW92ZSB0cmFpbGluZyBzcGFjZSAqL1xuXHRcdFx0XHRcdFx0dmFyIGFyciA9IGxhc3RUZXh0VG9rZW4udmFsdWUuc3BsaXQoXCJcIik7XG5cdFx0XHRcdFx0XHR3aGlsZSAoYXJyLmxlbmd0aCAmJiBhcnJbYXJyLmxlbmd0aC0xXSA9PSBcIiBcIikgeyBhcnIucG9wKCk7IH1cblx0XHRcdFx0XHRcdGxhc3RUZXh0VG9rZW4udmFsdWUgPSBhcnIuam9pbihcIlwiKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0bGFzdFRleHRUb2tlbiA9IG51bGw7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHRva2Vucy5wb3AoKTsgLyogcmVtb3ZlIGZha2UgdG9rZW4gKi9cblxuXHRcdHJldHVybiB0b2tlbnM7XG5cdH0sXG5cblx0LyoqXG5cdCAqIENyZWF0ZSBuZXcgdG9rZW5zIGFuZCBpbnNlcnQgdGhlbSBpbnRvIHRoZSBzdHJlYW1cblx0ICogQHBhcmFtIHtvYmplY3RbXX0gdG9rZW5zXG5cdCAqIEBwYXJhbSB7aW50fSB0b2tlbkluZGV4IFRva2VuIGJlaW5nIHByb2Nlc3NlZFxuXHQgKiBAcGFyYW0ge2ludH0gYnJlYWtJbmRleCBJbmRleCB3aXRoaW4gY3VycmVudCB0b2tlbidzIHZhbHVlXG5cdCAqIEBwYXJhbSB7Ym9vbH0gcmVtb3ZlQnJlYWtDaGFyIERvIHdlIHdhbnQgdG8gcmVtb3ZlIHRoZSBicmVha2luZyBjaGFyYWN0ZXI/XG5cdCAqIEByZXR1cm5zIHtzdHJpbmd9IHJlbWFpbmluZyB1bmJyb2tlbiB0b2tlbiB2YWx1ZVxuXHQgKi9cblx0X2JyZWFrSW5zaWRlVG9rZW46IGZ1bmN0aW9uKHRva2VucywgdG9rZW5JbmRleCwgYnJlYWtJbmRleCwgcmVtb3ZlQnJlYWtDaGFyKSB7XG5cdFx0dmFyIG5ld0JyZWFrVG9rZW4gPSB7XG5cdFx0XHR0eXBlOiBST1QuVGV4dC5UWVBFX05FV0xJTkVcblx0XHR9O1xuXHRcdHZhciBuZXdUZXh0VG9rZW4gPSB7XG5cdFx0XHR0eXBlOiBST1QuVGV4dC5UWVBFX1RFWFQsXG5cdFx0XHR2YWx1ZTogdG9rZW5zW3Rva2VuSW5kZXhdLnZhbHVlLnN1YnN0cmluZyhicmVha0luZGV4ICsgKHJlbW92ZUJyZWFrQ2hhciA/IDEgOiAwKSlcblx0XHR9O1xuXHRcdHRva2Vucy5zcGxpY2UodG9rZW5JbmRleCsxLCAwLCBuZXdCcmVha1Rva2VuLCBuZXdUZXh0VG9rZW4pO1xuXHRcdHJldHVybiB0b2tlbnNbdG9rZW5JbmRleF0udmFsdWUuc3Vic3RyaW5nKDAsIGJyZWFrSW5kZXgpO1xuXHR9XG59O1xuLyoqXG4gKiBAcmV0dXJucyB7YW55fSBSYW5kb21seSBwaWNrZWQgaXRlbSwgbnVsbCB3aGVuIGxlbmd0aD0wXG4gKi9cbkFycmF5LnByb3RvdHlwZS5yYW5kb20gPSBBcnJheS5wcm90b3R5cGUucmFuZG9tIHx8IGZ1bmN0aW9uKCkge1xuXHRpZiAoIXRoaXMubGVuZ3RoKSB7IHJldHVybiBudWxsOyB9XG5cdHJldHVybiB0aGlzW01hdGguZmxvb3IoUk9ULlJORy5nZXRVbmlmb3JtKCkgKiB0aGlzLmxlbmd0aCldO1xufTtcblxuLyoqXG4gKiBAcmV0dXJucyB7YXJyYXl9IE5ldyBhcnJheSB3aXRoIHJhbmRvbWl6ZWQgaXRlbXNcbiAqL1xuQXJyYXkucHJvdG90eXBlLnJhbmRvbWl6ZSA9IEFycmF5LnByb3RvdHlwZS5yYW5kb21pemUgfHwgZnVuY3Rpb24oKSB7XG4gIHZhciByZXN1bHQgPSBbXTtcbiAgdmFyIGNsb25lID0gdGhpcy5zbGljZSgpO1xuICB3aGlsZSAoY2xvbmUubGVuZ3RoKSB7XG4gICAgdmFyIGluZGV4ID0gY2xvbmUuaW5kZXhPZihjbG9uZS5yYW5kb20oKSk7XG4gICAgcmVzdWx0LnB1c2goY2xvbmUuc3BsaWNlKGluZGV4LCAxKVswXSk7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn07XG4vKipcbiAqIEFsd2F5cyBwb3NpdGl2ZSBtb2R1bHVzXG4gKiBAcGFyYW0ge2ludH0gbiBNb2R1bHVzXG4gKiBAcmV0dXJucyB7aW50fSB0aGlzIG1vZHVsbyBuXG4gKi9cbk51bWJlci5wcm90b3R5cGUubW9kID0gTnVtYmVyLnByb3RvdHlwZS5tb2QgfHwgZnVuY3Rpb24obikge1xuXHRyZXR1cm4gKCh0aGlzJW4pK24pJW47XG59O1xuLyoqXG4gKiBAcmV0dXJucyB7c3RyaW5nfSBGaXJzdCBsZXR0ZXIgY2FwaXRhbGl6ZWRcbiAqL1xuU3RyaW5nLnByb3RvdHlwZS5jYXBpdGFsaXplID0gU3RyaW5nLnByb3RvdHlwZS5jYXBpdGFsaXplIHx8IGZ1bmN0aW9uKCkge1xuXHRyZXR1cm4gdGhpcy5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHRoaXMuc3Vic3RyaW5nKDEpO1xufTtcblxuLyoqIFxuICogTGVmdCBwYWRcbiAqIEBwYXJhbSB7c3RyaW5nfSBbY2hhcmFjdGVyPVwiMFwiXVxuICogQHBhcmFtIHtpbnR9IFtjb3VudD0yXVxuICovXG5TdHJpbmcucHJvdG90eXBlLmxwYWQgPSBTdHJpbmcucHJvdG90eXBlLmxwYWQgfHwgZnVuY3Rpb24oY2hhcmFjdGVyLCBjb3VudCkge1xuXHR2YXIgY2ggPSBjaGFyYWN0ZXIgfHwgXCIwXCI7XG5cdHZhciBjbnQgPSBjb3VudCB8fCAyO1xuXG5cdHZhciBzID0gXCJcIjtcblx0d2hpbGUgKHMubGVuZ3RoIDwgKGNudCAtIHRoaXMubGVuZ3RoKSkgeyBzICs9IGNoOyB9XG5cdHMgPSBzLnN1YnN0cmluZygwLCBjbnQtdGhpcy5sZW5ndGgpO1xuXHRyZXR1cm4gcyt0aGlzO1xufTtcblxuLyoqIFxuICogUmlnaHQgcGFkXG4gKiBAcGFyYW0ge3N0cmluZ30gW2NoYXJhY3Rlcj1cIjBcIl1cbiAqIEBwYXJhbSB7aW50fSBbY291bnQ9Ml1cbiAqL1xuU3RyaW5nLnByb3RvdHlwZS5ycGFkID0gU3RyaW5nLnByb3RvdHlwZS5ycGFkIHx8IGZ1bmN0aW9uKGNoYXJhY3RlciwgY291bnQpIHtcblx0dmFyIGNoID0gY2hhcmFjdGVyIHx8IFwiMFwiO1xuXHR2YXIgY250ID0gY291bnQgfHwgMjtcblxuXHR2YXIgcyA9IFwiXCI7XG5cdHdoaWxlIChzLmxlbmd0aCA8IChjbnQgLSB0aGlzLmxlbmd0aCkpIHsgcyArPSBjaDsgfVxuXHRzID0gcy5zdWJzdHJpbmcoMCwgY250LXRoaXMubGVuZ3RoKTtcblx0cmV0dXJuIHRoaXMrcztcbn07XG5cbi8qKlxuICogRm9ybWF0IGEgc3RyaW5nIGluIGEgZmxleGlibGUgd2F5LiBTY2FucyBmb3IgJXMgc3RyaW5ncyBhbmQgcmVwbGFjZXMgdGhlbSB3aXRoIGFyZ3VtZW50cy4gTGlzdCBvZiBwYXR0ZXJucyBpcyBtb2RpZmlhYmxlIHZpYSBTdHJpbmcuZm9ybWF0Lm1hcC5cbiAqIEBwYXJhbSB7c3RyaW5nfSB0ZW1wbGF0ZVxuICogQHBhcmFtIHthbnl9IFthcmd2XVxuICovXG5TdHJpbmcuZm9ybWF0ID0gU3RyaW5nLmZvcm1hdCB8fCBmdW5jdGlvbih0ZW1wbGF0ZSkge1xuXHR2YXIgbWFwID0gU3RyaW5nLmZvcm1hdC5tYXA7XG5cdHZhciBhcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKTtcblxuXHR2YXIgcmVwbGFjZXIgPSBmdW5jdGlvbihtYXRjaCwgZ3JvdXAxLCBncm91cDIsIGluZGV4KSB7XG5cdFx0aWYgKHRlbXBsYXRlLmNoYXJBdChpbmRleC0xKSA9PSBcIiVcIikgeyByZXR1cm4gbWF0Y2guc3Vic3RyaW5nKDEpOyB9XG5cdFx0aWYgKCFhcmdzLmxlbmd0aCkgeyByZXR1cm4gbWF0Y2g7IH1cblx0XHR2YXIgb2JqID0gYXJnc1swXTtcblxuXHRcdHZhciBncm91cCA9IGdyb3VwMSB8fCBncm91cDI7XG5cdFx0dmFyIHBhcnRzID0gZ3JvdXAuc3BsaXQoXCIsXCIpO1xuXHRcdHZhciBuYW1lID0gcGFydHMuc2hpZnQoKTtcblx0XHR2YXIgbWV0aG9kID0gbWFwW25hbWUudG9Mb3dlckNhc2UoKV07XG5cdFx0aWYgKCFtZXRob2QpIHsgcmV0dXJuIG1hdGNoOyB9XG5cblx0XHR2YXIgb2JqID0gYXJncy5zaGlmdCgpO1xuXHRcdHZhciByZXBsYWNlZCA9IG9ialttZXRob2RdLmFwcGx5KG9iaiwgcGFydHMpO1xuXG5cdFx0dmFyIGZpcnN0ID0gbmFtZS5jaGFyQXQoMCk7XG5cdFx0aWYgKGZpcnN0ICE9IGZpcnN0LnRvTG93ZXJDYXNlKCkpIHsgcmVwbGFjZWQgPSByZXBsYWNlZC5jYXBpdGFsaXplKCk7IH1cblxuXHRcdHJldHVybiByZXBsYWNlZDtcblx0fTtcblx0cmV0dXJuIHRlbXBsYXRlLnJlcGxhY2UoLyUoPzooW2Etel0rKXwoPzp7KFtefV0rKX0pKS9naSwgcmVwbGFjZXIpO1xufTtcblxuU3RyaW5nLmZvcm1hdC5tYXAgPSBTdHJpbmcuZm9ybWF0Lm1hcCB8fCB7XG5cdFwic1wiOiBcInRvU3RyaW5nXCJcbn07XG5cbi8qKlxuICogQ29udmVuaWVuY2Ugc2hvcnRjdXQgdG8gU3RyaW5nLmZvcm1hdCh0aGlzKVxuICovXG5TdHJpbmcucHJvdG90eXBlLmZvcm1hdCA9IFN0cmluZy5wcm90b3R5cGUuZm9ybWF0IHx8IGZ1bmN0aW9uKCkge1xuXHR2YXIgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cyk7XG5cdGFyZ3MudW5zaGlmdCh0aGlzKTtcblx0cmV0dXJuIFN0cmluZy5mb3JtYXQuYXBwbHkoU3RyaW5nLCBhcmdzKTtcbn07XG5cbmlmICghT2JqZWN0LmNyZWF0ZSkgeyAgXG5cdC8qKlxuXHQgKiBFUzUgT2JqZWN0LmNyZWF0ZVxuXHQgKi9cblx0T2JqZWN0LmNyZWF0ZSA9IGZ1bmN0aW9uKG8pIHsgIFxuXHRcdHZhciB0bXAgPSBmdW5jdGlvbigpIHt9O1xuXHRcdHRtcC5wcm90b3R5cGUgPSBvO1xuXHRcdHJldHVybiBuZXcgdG1wKCk7XG5cdH07ICBcbn0gIFxuLyoqXG4gKiBTZXRzIHByb3RvdHlwZSBvZiB0aGlzIGZ1bmN0aW9uIHRvIGFuIGluc3RhbmNlIG9mIHBhcmVudCBmdW5jdGlvblxuICogQHBhcmFtIHtmdW5jdGlvbn0gcGFyZW50XG4gKi9cbkZ1bmN0aW9uLnByb3RvdHlwZS5leHRlbmQgPSBGdW5jdGlvbi5wcm90b3R5cGUuZXh0ZW5kIHx8IGZ1bmN0aW9uKHBhcmVudCkge1xuXHR0aGlzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUocGFyZW50LnByb3RvdHlwZSk7XG5cdHRoaXMucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gdGhpcztcblx0cmV0dXJuIHRoaXM7XG59O1xuaWYgKHR5cGVvZiB3aW5kb3cgIT0gXCJ1bmRlZmluZWRcIikge1xuXHR3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lID1cblx0XHR3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lXG5cdFx0fHwgd2luZG93Lm1velJlcXVlc3RBbmltYXRpb25GcmFtZVxuXHRcdHx8IHdpbmRvdy53ZWJraXRSZXF1ZXN0QW5pbWF0aW9uRnJhbWVcblx0XHR8fCB3aW5kb3cub1JlcXVlc3RBbmltYXRpb25GcmFtZVxuXHRcdHx8IHdpbmRvdy5tc1JlcXVlc3RBbmltYXRpb25GcmFtZVxuXHRcdHx8IGZ1bmN0aW9uKGNiKSB7IHJldHVybiBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgeyBjYihEYXRlLm5vdygpKTsgfSwgMTAwMC82MCk7IH07XG5cblx0d2luZG93LmNhbmNlbEFuaW1hdGlvbkZyYW1lID1cblx0XHR3aW5kb3cuY2FuY2VsQW5pbWF0aW9uRnJhbWVcblx0XHR8fCB3aW5kb3cubW96Q2FuY2VsQW5pbWF0aW9uRnJhbWVcblx0XHR8fCB3aW5kb3cud2Via2l0Q2FuY2VsQW5pbWF0aW9uRnJhbWVcblx0XHR8fCB3aW5kb3cub0NhbmNlbEFuaW1hdGlvbkZyYW1lXG5cdFx0fHwgd2luZG93Lm1zQ2FuY2VsQW5pbWF0aW9uRnJhbWVcblx0XHR8fCBmdW5jdGlvbihpZCkgeyByZXR1cm4gY2xlYXJUaW1lb3V0KGlkKTsgfTtcbn1cbi8qKlxuICogQGNsYXNzIFZpc3VhbCBtYXAgZGlzcGxheVxuICogQHBhcmFtIHtvYmplY3R9IFtvcHRpb25zXVxuICogQHBhcmFtIHtpbnR9IFtvcHRpb25zLndpZHRoPVJPVC5ERUZBVUxUX1dJRFRIXVxuICogQHBhcmFtIHtpbnR9IFtvcHRpb25zLmhlaWdodD1ST1QuREVGQVVMVF9IRUlHSFRdXG4gKiBAcGFyYW0ge2ludH0gW29wdGlvbnMuZm9udFNpemU9MTVdXG4gKiBAcGFyYW0ge3N0cmluZ30gW29wdGlvbnMuZm9udEZhbWlseT1cIm1vbm9zcGFjZVwiXVxuICogQHBhcmFtIHtzdHJpbmd9IFtvcHRpb25zLmZvbnRTdHlsZT1cIlwiXSBib2xkL2l0YWxpYy9ub25lL2JvdGhcbiAqIEBwYXJhbSB7c3RyaW5nfSBbb3B0aW9ucy5mZz1cIiNjY2NcIl1cbiAqIEBwYXJhbSB7c3RyaW5nfSBbb3B0aW9ucy5iZz1cIiMwMDBcIl1cbiAqIEBwYXJhbSB7ZmxvYXR9IFtvcHRpb25zLnNwYWNpbmc9MV1cbiAqIEBwYXJhbSB7ZmxvYXR9IFtvcHRpb25zLmJvcmRlcj0wXVxuICogQHBhcmFtIHtzdHJpbmd9IFtvcHRpb25zLmxheW91dD1cInJlY3RcIl1cbiAqIEBwYXJhbSB7Ym9vbH0gW29wdGlvbnMuZm9yY2VTcXVhcmVSYXRpbz1mYWxzZV1cbiAqIEBwYXJhbSB7aW50fSBbb3B0aW9ucy50aWxlV2lkdGg9MzJdXG4gKiBAcGFyYW0ge2ludH0gW29wdGlvbnMudGlsZUhlaWdodD0zMl1cbiAqIEBwYXJhbSB7b2JqZWN0fSBbb3B0aW9ucy50aWxlTWFwPXt9XVxuICogQHBhcmFtIHtpbWFnZX0gW29wdGlvbnMudGlsZVNldD1udWxsXVxuICogQHBhcmFtIHtpbWFnZX0gW29wdGlvbnMudGlsZUNvbG9yaXplPWZhbHNlXVxuICovXG5ST1QuRGlzcGxheSA9IGZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0dmFyIGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIik7XG5cdHRoaXMuX2NvbnRleHQgPSBjYW52YXMuZ2V0Q29udGV4dChcIjJkXCIpO1xuXHR0aGlzLl9kYXRhID0ge307XG5cdHRoaXMuX2RpcnR5ID0gZmFsc2U7IC8qIGZhbHNlID0gbm90aGluZywgdHJ1ZSA9IGFsbCwgb2JqZWN0ID0gZGlydHkgY2VsbHMgKi9cblx0dGhpcy5fb3B0aW9ucyA9IHt9O1xuXHR0aGlzLl9iYWNrZW5kID0gbnVsbDtcblx0XG5cdHZhciBkZWZhdWx0T3B0aW9ucyA9IHtcblx0XHR3aWR0aDogUk9ULkRFRkFVTFRfV0lEVEgsXG5cdFx0aGVpZ2h0OiBST1QuREVGQVVMVF9IRUlHSFQsXG5cdFx0dHJhbnNwb3NlOiBmYWxzZSxcblx0XHRsYXlvdXQ6IFwicmVjdFwiLFxuXHRcdGZvbnRTaXplOiAxNSxcblx0XHRzcGFjaW5nOiAxLFxuXHRcdGJvcmRlcjogMCxcblx0XHRmb3JjZVNxdWFyZVJhdGlvOiBmYWxzZSxcblx0XHRmb250RmFtaWx5OiBcIm1vbm9zcGFjZVwiLFxuXHRcdGZvbnRTdHlsZTogXCJcIixcblx0XHRmZzogXCIjY2NjXCIsXG5cdFx0Ymc6IFwiIzAwMFwiLFxuXHRcdHRpbGVXaWR0aDogMzIsXG5cdFx0dGlsZUhlaWdodDogMzIsXG5cdFx0dGlsZU1hcDoge30sXG5cdFx0dGlsZVNldDogbnVsbCxcblx0XHR0aWxlQ29sb3JpemU6IGZhbHNlLFxuXHRcdHRlcm1Db2xvcjogXCJ4dGVybVwiXG5cdH07XG5cdGZvciAodmFyIHAgaW4gb3B0aW9ucykgeyBkZWZhdWx0T3B0aW9uc1twXSA9IG9wdGlvbnNbcF07IH1cblx0dGhpcy5zZXRPcHRpb25zKGRlZmF1bHRPcHRpb25zKTtcblx0dGhpcy5ERUJVRyA9IHRoaXMuREVCVUcuYmluZCh0aGlzKTtcblxuXHR0aGlzLl90aWNrID0gdGhpcy5fdGljay5iaW5kKHRoaXMpO1xuXHRyZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy5fdGljayk7XG59O1xuXG4vKipcbiAqIERlYnVnIGhlbHBlciwgaWRlYWwgYXMgYSBtYXAgZ2VuZXJhdG9yIGNhbGxiYWNrLiBBbHdheXMgYm91bmQgdG8gdGhpcy5cbiAqIEBwYXJhbSB7aW50fSB4XG4gKiBAcGFyYW0ge2ludH0geVxuICogQHBhcmFtIHtpbnR9IHdoYXRcbiAqL1xuUk9ULkRpc3BsYXkucHJvdG90eXBlLkRFQlVHID0gZnVuY3Rpb24oeCwgeSwgd2hhdCkge1xuXHR2YXIgY29sb3JzID0gW3RoaXMuX29wdGlvbnMuYmcsIHRoaXMuX29wdGlvbnMuZmddO1xuXHR0aGlzLmRyYXcoeCwgeSwgbnVsbCwgbnVsbCwgY29sb3JzW3doYXQgJSBjb2xvcnMubGVuZ3RoXSk7XG59O1xuXG4vKipcbiAqIENsZWFyIHRoZSB3aG9sZSBkaXNwbGF5IChjb3ZlciBpdCB3aXRoIGJhY2tncm91bmQgY29sb3IpXG4gKi9cblJPVC5EaXNwbGF5LnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uKCkge1xuXHR0aGlzLl9kYXRhID0ge307XG5cdHRoaXMuX2RpcnR5ID0gdHJ1ZTtcbn07XG5cbi8qKlxuICogQHNlZSBST1QuRGlzcGxheVxuICovXG5ST1QuRGlzcGxheS5wcm90b3R5cGUuc2V0T3B0aW9ucyA9IGZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0Zm9yICh2YXIgcCBpbiBvcHRpb25zKSB7IHRoaXMuX29wdGlvbnNbcF0gPSBvcHRpb25zW3BdOyB9XG5cdGlmIChvcHRpb25zLndpZHRoIHx8IG9wdGlvbnMuaGVpZ2h0IHx8IG9wdGlvbnMuZm9udFNpemUgfHwgb3B0aW9ucy5mb250RmFtaWx5IHx8IG9wdGlvbnMuc3BhY2luZyB8fCBvcHRpb25zLmxheW91dCkge1xuXHRcdGlmIChvcHRpb25zLmxheW91dCkgeyBcblx0XHRcdHRoaXMuX2JhY2tlbmQgPSBuZXcgUk9ULkRpc3BsYXlbb3B0aW9ucy5sYXlvdXQuY2FwaXRhbGl6ZSgpXSh0aGlzLl9jb250ZXh0KTtcblx0XHR9XG5cblx0XHR2YXIgZm9udCA9ICh0aGlzLl9vcHRpb25zLmZvbnRTdHlsZSA/IHRoaXMuX29wdGlvbnMuZm9udFN0eWxlICsgXCIgXCIgOiBcIlwiKSArIHRoaXMuX29wdGlvbnMuZm9udFNpemUgKyBcInB4IFwiICsgdGhpcy5fb3B0aW9ucy5mb250RmFtaWx5O1xuXHRcdHRoaXMuX2NvbnRleHQuZm9udCA9IGZvbnQ7XG5cdFx0dGhpcy5fYmFja2VuZC5jb21wdXRlKHRoaXMuX29wdGlvbnMpO1xuXHRcdHRoaXMuX2NvbnRleHQuZm9udCA9IGZvbnQ7XG5cdFx0dGhpcy5fY29udGV4dC50ZXh0QWxpZ24gPSBcImNlbnRlclwiO1xuXHRcdHRoaXMuX2NvbnRleHQudGV4dEJhc2VsaW5lID0gXCJtaWRkbGVcIjtcblx0XHR0aGlzLl9kaXJ0eSA9IHRydWU7XG5cdH1cblx0cmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIFJldHVybnMgY3VycmVudGx5IHNldCBvcHRpb25zXG4gKiBAcmV0dXJucyB7b2JqZWN0fSBDdXJyZW50IG9wdGlvbnMgb2JqZWN0IFxuICovXG5ST1QuRGlzcGxheS5wcm90b3R5cGUuZ2V0T3B0aW9ucyA9IGZ1bmN0aW9uKCkge1xuXHRyZXR1cm4gdGhpcy5fb3B0aW9ucztcbn07XG5cbi8qKlxuICogUmV0dXJucyB0aGUgRE9NIG5vZGUgb2YgdGhpcyBkaXNwbGF5XG4gKiBAcmV0dXJucyB7bm9kZX0gRE9NIG5vZGVcbiAqL1xuUk9ULkRpc3BsYXkucHJvdG90eXBlLmdldENvbnRhaW5lciA9IGZ1bmN0aW9uKCkge1xuXHRyZXR1cm4gdGhpcy5fY29udGV4dC5jYW52YXM7XG59O1xuXG4vKipcbiAqIENvbXB1dGUgdGhlIG1heGltdW0gd2lkdGgvaGVpZ2h0IHRvIGZpdCBpbnRvIGEgc2V0IG9mIGdpdmVuIGNvbnN0cmFpbnRzXG4gKiBAcGFyYW0ge2ludH0gYXZhaWxXaWR0aCBNYXhpbXVtIGFsbG93ZWQgcGl4ZWwgd2lkdGhcbiAqIEBwYXJhbSB7aW50fSBhdmFpbEhlaWdodCBNYXhpbXVtIGFsbG93ZWQgcGl4ZWwgaGVpZ2h0XG4gKiBAcmV0dXJucyB7aW50WzJdfSBjZWxsV2lkdGgsY2VsbEhlaWdodFxuICovXG5ST1QuRGlzcGxheS5wcm90b3R5cGUuY29tcHV0ZVNpemUgPSBmdW5jdGlvbihhdmFpbFdpZHRoLCBhdmFpbEhlaWdodCkge1xuXHRyZXR1cm4gdGhpcy5fYmFja2VuZC5jb21wdXRlU2l6ZShhdmFpbFdpZHRoLCBhdmFpbEhlaWdodCwgdGhpcy5fb3B0aW9ucyk7XG59O1xuXG4vKipcbiAqIENvbXB1dGUgdGhlIG1heGltdW0gZm9udCBzaXplIHRvIGZpdCBpbnRvIGEgc2V0IG9mIGdpdmVuIGNvbnN0cmFpbnRzXG4gKiBAcGFyYW0ge2ludH0gYXZhaWxXaWR0aCBNYXhpbXVtIGFsbG93ZWQgcGl4ZWwgd2lkdGhcbiAqIEBwYXJhbSB7aW50fSBhdmFpbEhlaWdodCBNYXhpbXVtIGFsbG93ZWQgcGl4ZWwgaGVpZ2h0XG4gKiBAcmV0dXJucyB7aW50fSBmb250U2l6ZVxuICovXG5ST1QuRGlzcGxheS5wcm90b3R5cGUuY29tcHV0ZUZvbnRTaXplID0gZnVuY3Rpb24oYXZhaWxXaWR0aCwgYXZhaWxIZWlnaHQpIHtcblx0cmV0dXJuIHRoaXMuX2JhY2tlbmQuY29tcHV0ZUZvbnRTaXplKGF2YWlsV2lkdGgsIGF2YWlsSGVpZ2h0LCB0aGlzLl9vcHRpb25zKTtcbn07XG5cbi8qKlxuICogQ29udmVydCBhIERPTSBldmVudCAobW91c2Ugb3IgdG91Y2gpIHRvIG1hcCBjb29yZGluYXRlcy4gVXNlcyBmaXJzdCB0b3VjaCBmb3IgbXVsdGktdG91Y2guXG4gKiBAcGFyYW0ge0V2ZW50fSBlIGV2ZW50XG4gKiBAcmV0dXJucyB7aW50WzJdfSAtMSBmb3IgdmFsdWVzIG91dHNpZGUgb2YgdGhlIGNhbnZhc1xuICovXG5ST1QuRGlzcGxheS5wcm90b3R5cGUuZXZlbnRUb1Bvc2l0aW9uID0gZnVuY3Rpb24oZSkge1xuXHRpZiAoZS50b3VjaGVzKSB7XG5cdFx0dmFyIHggPSBlLnRvdWNoZXNbMF0uY2xpZW50WDtcblx0XHR2YXIgeSA9IGUudG91Y2hlc1swXS5jbGllbnRZO1xuXHR9IGVsc2Uge1xuXHRcdHZhciB4ID0gZS5jbGllbnRYO1xuXHRcdHZhciB5ID0gZS5jbGllbnRZO1xuXHR9XG5cblx0dmFyIHJlY3QgPSB0aGlzLl9jb250ZXh0LmNhbnZhcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblx0eCAtPSByZWN0LmxlZnQ7XG5cdHkgLT0gcmVjdC50b3A7XG5cdFxuXHR4ICo9IHRoaXMuX2NvbnRleHQuY2FudmFzLndpZHRoIC8gdGhpcy5fY29udGV4dC5jYW52YXMuY2xpZW50V2lkdGg7XG5cdHkgKj0gdGhpcy5fY29udGV4dC5jYW52YXMuaGVpZ2h0IC8gdGhpcy5fY29udGV4dC5jYW52YXMuY2xpZW50SGVpZ2h0O1xuXG5cdGlmICh4IDwgMCB8fCB5IDwgMCB8fCB4ID49IHRoaXMuX2NvbnRleHQuY2FudmFzLndpZHRoIHx8IHkgPj0gdGhpcy5fY29udGV4dC5jYW52YXMuaGVpZ2h0KSB7IHJldHVybiBbLTEsIC0xXTsgfVxuXG5cdHJldHVybiB0aGlzLl9iYWNrZW5kLmV2ZW50VG9Qb3NpdGlvbih4LCB5KTtcbn07XG5cbi8qKlxuICogQHBhcmFtIHtpbnR9IHhcbiAqIEBwYXJhbSB7aW50fSB5XG4gKiBAcGFyYW0ge3N0cmluZyB8fCBzdHJpbmdbXX0gY2ggT25lIG9yIG1vcmUgY2hhcnMgKHdpbGwgYmUgb3ZlcmxhcHBpbmcgdGhlbXNlbHZlcylcbiAqIEBwYXJhbSB7c3RyaW5nfSBbZmddIGZvcmVncm91bmQgY29sb3JcbiAqIEBwYXJhbSB7c3RyaW5nfSBbYmddIGJhY2tncm91bmQgY29sb3JcbiAqL1xuUk9ULkRpc3BsYXkucHJvdG90eXBlLmRyYXcgPSBmdW5jdGlvbih4LCB5LCBjaCwgZmcsIGJnKSB7XG5cdGlmICghZmcpIHsgZmcgPSB0aGlzLl9vcHRpb25zLmZnOyB9XG5cdGlmICghYmcpIHsgYmcgPSB0aGlzLl9vcHRpb25zLmJnOyB9XG5cdHRoaXMuX2RhdGFbeCtcIixcIit5XSA9IFt4LCB5LCBjaCwgZmcsIGJnXTtcblx0XG5cdGlmICh0aGlzLl9kaXJ0eSA9PT0gdHJ1ZSkgeyByZXR1cm47IH0gLyogd2lsbCBhbHJlYWR5IHJlZHJhdyBldmVyeXRoaW5nICovXG5cdGlmICghdGhpcy5fZGlydHkpIHsgdGhpcy5fZGlydHkgPSB7fTsgfSAvKiBmaXJzdCEgKi9cblx0dGhpcy5fZGlydHlbeCtcIixcIit5XSA9IHRydWU7XG59O1xuXG4vKipcbiAqIERyYXdzIGEgdGV4dCBhdCBnaXZlbiBwb3NpdGlvbi4gT3B0aW9uYWxseSB3cmFwcyBhdCBhIG1heGltdW0gbGVuZ3RoLiBDdXJyZW50bHkgZG9lcyBub3Qgd29yayB3aXRoIGhleCBsYXlvdXQuXG4gKiBAcGFyYW0ge2ludH0geFxuICogQHBhcmFtIHtpbnR9IHlcbiAqIEBwYXJhbSB7c3RyaW5nfSB0ZXh0IE1heSBjb250YWluIGNvbG9yL2JhY2tncm91bmQgZm9ybWF0IHNwZWNpZmllcnMsICVje25hbWV9LyVie25hbWV9LCBib3RoIG9wdGlvbmFsLiAlY3t9LyVie30gcmVzZXRzIHRvIGRlZmF1bHQuXG4gKiBAcGFyYW0ge2ludH0gW21heFdpZHRoXSB3cmFwIGF0IHdoYXQgd2lkdGg/XG4gKiBAcmV0dXJucyB7aW50fSBsaW5lcyBkcmF3blxuICovXG5ST1QuRGlzcGxheS5wcm90b3R5cGUuZHJhd1RleHQgPSBmdW5jdGlvbih4LCB5LCB0ZXh0LCBtYXhXaWR0aCkge1xuXHR2YXIgZmcgPSBudWxsO1xuXHR2YXIgYmcgPSBudWxsO1xuXHR2YXIgY3ggPSB4O1xuXHR2YXIgY3kgPSB5O1xuXHR2YXIgbGluZXMgPSAxO1xuXHRpZiAoIW1heFdpZHRoKSB7IG1heFdpZHRoID0gdGhpcy5fb3B0aW9ucy53aWR0aC14OyB9XG5cblx0dmFyIHRva2VucyA9IFJPVC5UZXh0LnRva2VuaXplKHRleHQsIG1heFdpZHRoKTtcblxuXHR3aGlsZSAodG9rZW5zLmxlbmd0aCkgeyAvKiBpbnRlcnByZXQgdG9rZW5pemVkIG9wY29kZSBzdHJlYW0gKi9cblx0XHR2YXIgdG9rZW4gPSB0b2tlbnMuc2hpZnQoKTtcblx0XHRzd2l0Y2ggKHRva2VuLnR5cGUpIHtcblx0XHRcdGNhc2UgUk9ULlRleHQuVFlQRV9URVhUOlxuXHRcdFx0XHR2YXIgaXNTcGFjZSA9IGZhbHNlLCBpc1ByZXZTcGFjZSA9IGZhbHNlLCBpc0Z1bGxXaWR0aCA9IGZhbHNlLCBpc1ByZXZGdWxsV2lkdGggPSBmYWxzZTtcblx0XHRcdFx0Zm9yICh2YXIgaT0wO2k8dG9rZW4udmFsdWUubGVuZ3RoO2krKykge1xuXHRcdFx0XHRcdHZhciBjYyA9IHRva2VuLnZhbHVlLmNoYXJDb2RlQXQoaSk7XG5cdFx0XHRcdFx0dmFyIGMgPSB0b2tlbi52YWx1ZS5jaGFyQXQoaSk7XG5cdFx0XHRcdFx0Ly8gQXNzaWduIHRvIGB0cnVlYCB3aGVuIHRoZSBjdXJyZW50IGNoYXIgaXMgZnVsbC13aWR0aC5cblx0XHRcdFx0XHRpc0Z1bGxXaWR0aCA9IChjYyA+IDB4ZmYwMCAmJiBjYyA8IDB4ZmY2MSkgfHwgKGNjID4gMHhmZmRjICYmIGNjIDwgMHhmZmU4KSB8fCBjYyA+IDB4ZmZlZTtcblx0XHRcdFx0XHQvLyBDdXJyZW50IGNoYXIgaXMgc3BhY2UsIHdoYXRldmVyIGZ1bGwtd2lkdGggb3IgaGFsZi13aWR0aCBib3RoIGFyZSBPSy5cblx0XHRcdFx0XHRpc1NwYWNlID0gKGMuY2hhckNvZGVBdCgwKSA9PSAweDIwIHx8IGMuY2hhckNvZGVBdCgwKSA9PSAweDMwMDApO1xuXHRcdFx0XHRcdC8vIFRoZSBwcmV2aW91cyBjaGFyIGlzIGZ1bGwtd2lkdGggYW5kXG5cdFx0XHRcdFx0Ly8gY3VycmVudCBjaGFyIGlzIG5ldGhlciBoYWxmLXdpZHRoIG5vciBhIHNwYWNlLlxuXHRcdFx0XHRcdGlmIChpc1ByZXZGdWxsV2lkdGggJiYgIWlzRnVsbFdpZHRoICYmICFpc1NwYWNlKSB7IGN4Kys7IH0gLy8gYWRkIGFuIGV4dHJhIHBvc2l0aW9uXG5cdFx0XHRcdFx0Ly8gVGhlIGN1cnJlbnQgY2hhciBpcyBmdWxsLXdpZHRoIGFuZFxuXHRcdFx0XHRcdC8vIHRoZSBwcmV2aW91cyBjaGFyIGlzIG5vdCBhIHNwYWNlLlxuXHRcdFx0XHRcdGlmKGlzRnVsbFdpZHRoICYmICFpc1ByZXZTcGFjZSkgeyBjeCsrOyB9IC8vIGFkZCBhbiBleHRyYSBwb3NpdGlvblxuXHRcdFx0XHRcdHRoaXMuZHJhdyhjeCsrLCBjeSwgYywgZmcsIGJnKTtcblx0XHRcdFx0XHRpc1ByZXZTcGFjZSA9IGlzU3BhY2U7XG5cdFx0XHRcdFx0aXNQcmV2RnVsbFdpZHRoID0gaXNGdWxsV2lkdGg7XG5cdFx0XHRcdH1cblx0XHRcdGJyZWFrO1xuXG5cdFx0XHRjYXNlIFJPVC5UZXh0LlRZUEVfRkc6XG5cdFx0XHRcdGZnID0gdG9rZW4udmFsdWUgfHwgbnVsbDtcblx0XHRcdGJyZWFrO1xuXG5cdFx0XHRjYXNlIFJPVC5UZXh0LlRZUEVfQkc6XG5cdFx0XHRcdGJnID0gdG9rZW4udmFsdWUgfHwgbnVsbDtcblx0XHRcdGJyZWFrO1xuXG5cdFx0XHRjYXNlIFJPVC5UZXh0LlRZUEVfTkVXTElORTpcblx0XHRcdFx0Y3ggPSB4O1xuXHRcdFx0XHRjeSsrO1xuXHRcdFx0XHRsaW5lcysrO1xuXHRcdFx0YnJlYWs7XG5cdFx0fVxuXHR9XG5cblx0cmV0dXJuIGxpbmVzO1xufTtcblxuLyoqXG4gKiBUaW1lciB0aWNrOiB1cGRhdGUgZGlydHkgcGFydHNcbiAqL1xuUk9ULkRpc3BsYXkucHJvdG90eXBlLl90aWNrID0gZnVuY3Rpb24oKSB7XG5cdHJlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLl90aWNrKTtcblxuXHRpZiAoIXRoaXMuX2RpcnR5KSB7IHJldHVybjsgfVxuXG5cdGlmICh0aGlzLl9kaXJ0eSA9PT0gdHJ1ZSkgeyAvKiBkcmF3IGFsbCAqL1xuXHRcdHRoaXMuX2NvbnRleHQuZmlsbFN0eWxlID0gdGhpcy5fb3B0aW9ucy5iZztcblx0XHR0aGlzLl9jb250ZXh0LmZpbGxSZWN0KDAsIDAsIHRoaXMuX2NvbnRleHQuY2FudmFzLndpZHRoLCB0aGlzLl9jb250ZXh0LmNhbnZhcy5oZWlnaHQpO1xuXG5cdFx0Zm9yICh2YXIgaWQgaW4gdGhpcy5fZGF0YSkgeyAvKiByZWRyYXcgY2FjaGVkIGRhdGEgKi9cblx0XHRcdHRoaXMuX2RyYXcoaWQsIGZhbHNlKTtcblx0XHR9XG5cblx0fSBlbHNlIHsgLyogZHJhdyBvbmx5IGRpcnR5ICovXG5cdFx0Zm9yICh2YXIga2V5IGluIHRoaXMuX2RpcnR5KSB7XG5cdFx0XHR0aGlzLl9kcmF3KGtleSwgdHJ1ZSk7XG5cdFx0fVxuXHR9XG5cblx0dGhpcy5fZGlydHkgPSBmYWxzZTtcbn07XG5cbi8qKlxuICogQHBhcmFtIHtzdHJpbmd9IGtleSBXaGF0IHRvIGRyYXdcbiAqIEBwYXJhbSB7Ym9vbH0gY2xlYXJCZWZvcmUgSXMgaXQgbmVjZXNzYXJ5IHRvIGNsZWFuIGJlZm9yZT9cbiAqL1xuUk9ULkRpc3BsYXkucHJvdG90eXBlLl9kcmF3ID0gZnVuY3Rpb24oa2V5LCBjbGVhckJlZm9yZSkge1xuXHR2YXIgZGF0YSA9IHRoaXMuX2RhdGFba2V5XTtcblx0aWYgKGRhdGFbNF0gIT0gdGhpcy5fb3B0aW9ucy5iZykgeyBjbGVhckJlZm9yZSA9IHRydWU7IH1cblxuXHR0aGlzLl9iYWNrZW5kLmRyYXcoZGF0YSwgY2xlYXJCZWZvcmUpO1xufTtcbi8qKlxuICogQGNsYXNzIEFic3RyYWN0IGRpc3BsYXkgYmFja2VuZCBtb2R1bGVcbiAqIEBwcml2YXRlXG4gKi9cblJPVC5EaXNwbGF5LkJhY2tlbmQgPSBmdW5jdGlvbihjb250ZXh0KSB7XG5cdHRoaXMuX2NvbnRleHQgPSBjb250ZXh0O1xufTtcblxuUk9ULkRpc3BsYXkuQmFja2VuZC5wcm90b3R5cGUuY29tcHV0ZSA9IGZ1bmN0aW9uKG9wdGlvbnMpIHtcbn07XG5cblJPVC5EaXNwbGF5LkJhY2tlbmQucHJvdG90eXBlLmRyYXcgPSBmdW5jdGlvbihkYXRhLCBjbGVhckJlZm9yZSkge1xufTtcblxuUk9ULkRpc3BsYXkuQmFja2VuZC5wcm90b3R5cGUuY29tcHV0ZVNpemUgPSBmdW5jdGlvbihhdmFpbFdpZHRoLCBhdmFpbEhlaWdodCkge1xufTtcblxuUk9ULkRpc3BsYXkuQmFja2VuZC5wcm90b3R5cGUuY29tcHV0ZUZvbnRTaXplID0gZnVuY3Rpb24oYXZhaWxXaWR0aCwgYXZhaWxIZWlnaHQpIHtcbn07XG5cblJPVC5EaXNwbGF5LkJhY2tlbmQucHJvdG90eXBlLmV2ZW50VG9Qb3NpdGlvbiA9IGZ1bmN0aW9uKHgsIHkpIHtcbn07XG4vKipcbiAqIEBjbGFzcyBSZWN0YW5ndWxhciBiYWNrZW5kXG4gKiBAcHJpdmF0ZVxuICovXG5ST1QuRGlzcGxheS5SZWN0ID0gZnVuY3Rpb24oY29udGV4dCkge1xuXHRST1QuRGlzcGxheS5CYWNrZW5kLmNhbGwodGhpcywgY29udGV4dCk7XG5cdFxuXHR0aGlzLl9zcGFjaW5nWCA9IDA7XG5cdHRoaXMuX3NwYWNpbmdZID0gMDtcblx0dGhpcy5fY2FudmFzQ2FjaGUgPSB7fTtcblx0dGhpcy5fb3B0aW9ucyA9IHt9O1xufTtcblJPVC5EaXNwbGF5LlJlY3QuZXh0ZW5kKFJPVC5EaXNwbGF5LkJhY2tlbmQpO1xuXG5ST1QuRGlzcGxheS5SZWN0LmNhY2hlID0gZmFsc2U7XG5cblJPVC5EaXNwbGF5LlJlY3QucHJvdG90eXBlLmNvbXB1dGUgPSBmdW5jdGlvbihvcHRpb25zKSB7XG5cdHRoaXMuX2NhbnZhc0NhY2hlID0ge307XG5cdHRoaXMuX29wdGlvbnMgPSBvcHRpb25zO1xuXG5cdHZhciBjaGFyV2lkdGggPSBNYXRoLmNlaWwodGhpcy5fY29udGV4dC5tZWFzdXJlVGV4dChcIldcIikud2lkdGgpO1xuXHR0aGlzLl9zcGFjaW5nWCA9IE1hdGguY2VpbChvcHRpb25zLnNwYWNpbmcgKiBjaGFyV2lkdGgpO1xuXHR0aGlzLl9zcGFjaW5nWSA9IE1hdGguY2VpbChvcHRpb25zLnNwYWNpbmcgKiBvcHRpb25zLmZvbnRTaXplKTtcblxuXHRpZiAodGhpcy5fb3B0aW9ucy5mb3JjZVNxdWFyZVJhdGlvKSB7XG5cdFx0dGhpcy5fc3BhY2luZ1ggPSB0aGlzLl9zcGFjaW5nWSA9IE1hdGgubWF4KHRoaXMuX3NwYWNpbmdYLCB0aGlzLl9zcGFjaW5nWSk7XG5cdH1cblxuXHR0aGlzLl9jb250ZXh0LmNhbnZhcy53aWR0aCA9IG9wdGlvbnMud2lkdGggKiB0aGlzLl9zcGFjaW5nWDtcblx0dGhpcy5fY29udGV4dC5jYW52YXMuaGVpZ2h0ID0gb3B0aW9ucy5oZWlnaHQgKiB0aGlzLl9zcGFjaW5nWTtcbn07XG5cblJPVC5EaXNwbGF5LlJlY3QucHJvdG90eXBlLmRyYXcgPSBmdW5jdGlvbihkYXRhLCBjbGVhckJlZm9yZSkge1xuXHRpZiAodGhpcy5jb25zdHJ1Y3Rvci5jYWNoZSkge1xuXHRcdHRoaXMuX2RyYXdXaXRoQ2FjaGUoZGF0YSwgY2xlYXJCZWZvcmUpO1xuXHR9IGVsc2Uge1xuXHRcdHRoaXMuX2RyYXdOb0NhY2hlKGRhdGEsIGNsZWFyQmVmb3JlKTtcblx0fVxufTtcblxuUk9ULkRpc3BsYXkuUmVjdC5wcm90b3R5cGUuX2RyYXdXaXRoQ2FjaGUgPSBmdW5jdGlvbihkYXRhLCBjbGVhckJlZm9yZSkge1xuXHR2YXIgeCA9IGRhdGFbMF07XG5cdHZhciB5ID0gZGF0YVsxXTtcblx0dmFyIGNoID0gZGF0YVsyXTtcblx0dmFyIGZnID0gZGF0YVszXTtcblx0dmFyIGJnID0gZGF0YVs0XTtcblxuXHR2YXIgaGFzaCA9IFwiXCIrY2grZmcrYmc7XG5cdGlmIChoYXNoIGluIHRoaXMuX2NhbnZhc0NhY2hlKSB7XG5cdFx0dmFyIGNhbnZhcyA9IHRoaXMuX2NhbnZhc0NhY2hlW2hhc2hdO1xuXHR9IGVsc2Uge1xuXHRcdHZhciBiID0gdGhpcy5fb3B0aW9ucy5ib3JkZXI7XG5cdFx0dmFyIGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIik7XG5cdFx0dmFyIGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XG5cdFx0Y2FudmFzLndpZHRoID0gdGhpcy5fc3BhY2luZ1g7XG5cdFx0Y2FudmFzLmhlaWdodCA9IHRoaXMuX3NwYWNpbmdZO1xuXHRcdGN0eC5maWxsU3R5bGUgPSBiZztcblx0XHRjdHguZmlsbFJlY3QoYiwgYiwgY2FudmFzLndpZHRoLWIsIGNhbnZhcy5oZWlnaHQtYik7XG5cdFx0XG5cdFx0aWYgKGNoKSB7XG5cdFx0XHRjdHguZmlsbFN0eWxlID0gZmc7XG5cdFx0XHRjdHguZm9udCA9IHRoaXMuX2NvbnRleHQuZm9udDtcblx0XHRcdGN0eC50ZXh0QWxpZ24gPSBcImNlbnRlclwiO1xuXHRcdFx0Y3R4LnRleHRCYXNlbGluZSA9IFwibWlkZGxlXCI7XG5cblx0XHRcdHZhciBjaGFycyA9IFtdLmNvbmNhdChjaCk7XG5cdFx0XHRmb3IgKHZhciBpPTA7aTxjaGFycy5sZW5ndGg7aSsrKSB7XG5cdFx0XHRcdGN0eC5maWxsVGV4dChjaGFyc1tpXSwgdGhpcy5fc3BhY2luZ1gvMiwgTWF0aC5jZWlsKHRoaXMuX3NwYWNpbmdZLzIpKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0dGhpcy5fY2FudmFzQ2FjaGVbaGFzaF0gPSBjYW52YXM7XG5cdH1cblx0XG5cdHRoaXMuX2NvbnRleHQuZHJhd0ltYWdlKGNhbnZhcywgeCp0aGlzLl9zcGFjaW5nWCwgeSp0aGlzLl9zcGFjaW5nWSk7XG59O1xuXG5ST1QuRGlzcGxheS5SZWN0LnByb3RvdHlwZS5fZHJhd05vQ2FjaGUgPSBmdW5jdGlvbihkYXRhLCBjbGVhckJlZm9yZSkge1xuXHR2YXIgeCA9IGRhdGFbMF07XG5cdHZhciB5ID0gZGF0YVsxXTtcblx0dmFyIGNoID0gZGF0YVsyXTtcblx0dmFyIGZnID0gZGF0YVszXTtcblx0dmFyIGJnID0gZGF0YVs0XTtcblxuXHRpZiAoY2xlYXJCZWZvcmUpIHsgXG5cdFx0dmFyIGIgPSB0aGlzLl9vcHRpb25zLmJvcmRlcjtcblx0XHR0aGlzLl9jb250ZXh0LmZpbGxTdHlsZSA9IGJnO1xuXHRcdHRoaXMuX2NvbnRleHQuZmlsbFJlY3QoeCp0aGlzLl9zcGFjaW5nWCArIGIsIHkqdGhpcy5fc3BhY2luZ1kgKyBiLCB0aGlzLl9zcGFjaW5nWCAtIGIsIHRoaXMuX3NwYWNpbmdZIC0gYik7XG5cdH1cblx0XG5cdGlmICghY2gpIHsgcmV0dXJuOyB9XG5cblx0dGhpcy5fY29udGV4dC5maWxsU3R5bGUgPSBmZztcblxuXHR2YXIgY2hhcnMgPSBbXS5jb25jYXQoY2gpO1xuXHRmb3IgKHZhciBpPTA7aTxjaGFycy5sZW5ndGg7aSsrKSB7XG5cdFx0dGhpcy5fY29udGV4dC5maWxsVGV4dChjaGFyc1tpXSwgKHgrMC41KSAqIHRoaXMuX3NwYWNpbmdYLCBNYXRoLmNlaWwoKHkrMC41KSAqIHRoaXMuX3NwYWNpbmdZKSk7XG5cdH1cbn07XG5cblJPVC5EaXNwbGF5LlJlY3QucHJvdG90eXBlLmNvbXB1dGVTaXplID0gZnVuY3Rpb24oYXZhaWxXaWR0aCwgYXZhaWxIZWlnaHQpIHtcblx0dmFyIHdpZHRoID0gTWF0aC5mbG9vcihhdmFpbFdpZHRoIC8gdGhpcy5fc3BhY2luZ1gpO1xuXHR2YXIgaGVpZ2h0ID0gTWF0aC5mbG9vcihhdmFpbEhlaWdodCAvIHRoaXMuX3NwYWNpbmdZKTtcblx0cmV0dXJuIFt3aWR0aCwgaGVpZ2h0XTtcbn07XG5cblJPVC5EaXNwbGF5LlJlY3QucHJvdG90eXBlLmNvbXB1dGVGb250U2l6ZSA9IGZ1bmN0aW9uKGF2YWlsV2lkdGgsIGF2YWlsSGVpZ2h0KSB7XG5cdHZhciBib3hXaWR0aCA9IE1hdGguZmxvb3IoYXZhaWxXaWR0aCAvIHRoaXMuX29wdGlvbnMud2lkdGgpO1xuXHR2YXIgYm94SGVpZ2h0ID0gTWF0aC5mbG9vcihhdmFpbEhlaWdodCAvIHRoaXMuX29wdGlvbnMuaGVpZ2h0KTtcblxuXHQvKiBjb21wdXRlIGNoYXIgcmF0aW8gKi9cblx0dmFyIG9sZEZvbnQgPSB0aGlzLl9jb250ZXh0LmZvbnQ7XG5cdHRoaXMuX2NvbnRleHQuZm9udCA9IFwiMTAwcHggXCIgKyB0aGlzLl9vcHRpb25zLmZvbnRGYW1pbHk7XG5cdHZhciB3aWR0aCA9IE1hdGguY2VpbCh0aGlzLl9jb250ZXh0Lm1lYXN1cmVUZXh0KFwiV1wiKS53aWR0aCk7XG5cdHRoaXMuX2NvbnRleHQuZm9udCA9IG9sZEZvbnQ7XG5cdHZhciByYXRpbyA9IHdpZHRoIC8gMTAwO1xuXHRcdFxuXHR2YXIgd2lkdGhGcmFjdGlvbiA9IHJhdGlvICogYm94SGVpZ2h0IC8gYm94V2lkdGg7XG5cdGlmICh3aWR0aEZyYWN0aW9uID4gMSkgeyAvKiB0b28gd2lkZSB3aXRoIGN1cnJlbnQgYXNwZWN0IHJhdGlvICovXG5cdFx0Ym94SGVpZ2h0ID0gTWF0aC5mbG9vcihib3hIZWlnaHQgLyB3aWR0aEZyYWN0aW9uKTtcblx0fVxuXHRyZXR1cm4gTWF0aC5mbG9vcihib3hIZWlnaHQgLyB0aGlzLl9vcHRpb25zLnNwYWNpbmcpO1xufTtcblxuUk9ULkRpc3BsYXkuUmVjdC5wcm90b3R5cGUuZXZlbnRUb1Bvc2l0aW9uID0gZnVuY3Rpb24oeCwgeSkge1xuXHRyZXR1cm4gW01hdGguZmxvb3IoeC90aGlzLl9zcGFjaW5nWCksIE1hdGguZmxvb3IoeS90aGlzLl9zcGFjaW5nWSldO1xufTtcbi8qKlxuICogQGNsYXNzIEhleGFnb25hbCBiYWNrZW5kXG4gKiBAcHJpdmF0ZVxuICovXG5ST1QuRGlzcGxheS5IZXggPSBmdW5jdGlvbihjb250ZXh0KSB7XG5cdFJPVC5EaXNwbGF5LkJhY2tlbmQuY2FsbCh0aGlzLCBjb250ZXh0KTtcblxuXHR0aGlzLl9zcGFjaW5nWCA9IDA7XG5cdHRoaXMuX3NwYWNpbmdZID0gMDtcblx0dGhpcy5faGV4U2l6ZSA9IDA7XG5cdHRoaXMuX29wdGlvbnMgPSB7fTtcbn07XG5ST1QuRGlzcGxheS5IZXguZXh0ZW5kKFJPVC5EaXNwbGF5LkJhY2tlbmQpO1xuXG5ST1QuRGlzcGxheS5IZXgucHJvdG90eXBlLmNvbXB1dGUgPSBmdW5jdGlvbihvcHRpb25zKSB7XG5cdHRoaXMuX29wdGlvbnMgPSBvcHRpb25zO1xuXG5cdC8qIEZJWE1FIGNoYXIgc2l6ZSBjb21wdXRhdGlvbiBkb2VzIG5vdCByZXNwZWN0IHRyYW5zcG9zZWQgaGV4ZXMgKi9cblx0dmFyIGNoYXJXaWR0aCA9IE1hdGguY2VpbCh0aGlzLl9jb250ZXh0Lm1lYXN1cmVUZXh0KFwiV1wiKS53aWR0aCk7XG5cdHRoaXMuX2hleFNpemUgPSBNYXRoLmZsb29yKG9wdGlvbnMuc3BhY2luZyAqIChvcHRpb25zLmZvbnRTaXplICsgY2hhcldpZHRoL01hdGguc3FydCgzKSkgLyAyKTtcblx0dGhpcy5fc3BhY2luZ1ggPSB0aGlzLl9oZXhTaXplICogTWF0aC5zcXJ0KDMpIC8gMjtcblx0dGhpcy5fc3BhY2luZ1kgPSB0aGlzLl9oZXhTaXplICogMS41O1xuXG5cdGlmIChvcHRpb25zLnRyYW5zcG9zZSkge1xuXHRcdHZhciB4cHJvcCA9IFwiaGVpZ2h0XCI7XG5cdFx0dmFyIHlwcm9wID0gXCJ3aWR0aFwiO1xuXHR9IGVsc2Uge1xuXHRcdHZhciB4cHJvcCA9IFwid2lkdGhcIjtcblx0XHR2YXIgeXByb3AgPSBcImhlaWdodFwiO1xuXHR9XG5cdHRoaXMuX2NvbnRleHQuY2FudmFzW3hwcm9wXSA9IE1hdGguY2VpbCggKG9wdGlvbnMud2lkdGggKyAxKSAqIHRoaXMuX3NwYWNpbmdYICk7XG5cdHRoaXMuX2NvbnRleHQuY2FudmFzW3lwcm9wXSA9IE1hdGguY2VpbCggKG9wdGlvbnMuaGVpZ2h0IC0gMSkgKiB0aGlzLl9zcGFjaW5nWSArIDIqdGhpcy5faGV4U2l6ZSApO1xufTtcblxuUk9ULkRpc3BsYXkuSGV4LnByb3RvdHlwZS5kcmF3ID0gZnVuY3Rpb24oZGF0YSwgY2xlYXJCZWZvcmUpIHtcblx0dmFyIHggPSBkYXRhWzBdO1xuXHR2YXIgeSA9IGRhdGFbMV07XG5cdHZhciBjaCA9IGRhdGFbMl07XG5cdHZhciBmZyA9IGRhdGFbM107XG5cdHZhciBiZyA9IGRhdGFbNF07XG5cblx0dmFyIHB4ID0gW1xuXHRcdCh4KzEpICogdGhpcy5fc3BhY2luZ1gsXG5cdFx0eSAqIHRoaXMuX3NwYWNpbmdZICsgdGhpcy5faGV4U2l6ZVxuXHRdO1xuXHRpZiAodGhpcy5fb3B0aW9ucy50cmFuc3Bvc2UpIHsgcHgucmV2ZXJzZSgpOyB9XG5cblx0aWYgKGNsZWFyQmVmb3JlKSB7XG5cdFx0dGhpcy5fY29udGV4dC5maWxsU3R5bGUgPSBiZztcblx0XHR0aGlzLl9maWxsKHB4WzBdLCBweFsxXSk7XG5cdH1cblxuXHRpZiAoIWNoKSB7IHJldHVybjsgfVxuXG5cdHRoaXMuX2NvbnRleHQuZmlsbFN0eWxlID0gZmc7XG5cblx0dmFyIGNoYXJzID0gW10uY29uY2F0KGNoKTtcblx0Zm9yICh2YXIgaT0wO2k8Y2hhcnMubGVuZ3RoO2krKykge1xuXHRcdHRoaXMuX2NvbnRleHQuZmlsbFRleHQoY2hhcnNbaV0sIHB4WzBdLCBNYXRoLmNlaWwocHhbMV0pKTtcblx0fVxufTtcblxuUk9ULkRpc3BsYXkuSGV4LnByb3RvdHlwZS5jb21wdXRlU2l6ZSA9IGZ1bmN0aW9uKGF2YWlsV2lkdGgsIGF2YWlsSGVpZ2h0KSB7XG5cdGlmICh0aGlzLl9vcHRpb25zLnRyYW5zcG9zZSkge1xuXHRcdGF2YWlsV2lkdGggKz0gYXZhaWxIZWlnaHQ7XG5cdFx0YXZhaWxIZWlnaHQgPSBhdmFpbFdpZHRoIC0gYXZhaWxIZWlnaHQ7XG5cdFx0YXZhaWxXaWR0aCAtPSBhdmFpbEhlaWdodDtcblx0fVxuXG5cdHZhciB3aWR0aCA9IE1hdGguZmxvb3IoYXZhaWxXaWR0aCAvIHRoaXMuX3NwYWNpbmdYKSAtIDE7XG5cdHZhciBoZWlnaHQgPSBNYXRoLmZsb29yKChhdmFpbEhlaWdodCAtIDIqdGhpcy5faGV4U2l6ZSkgLyB0aGlzLl9zcGFjaW5nWSArIDEpO1xuXHRyZXR1cm4gW3dpZHRoLCBoZWlnaHRdO1xufTtcblxuUk9ULkRpc3BsYXkuSGV4LnByb3RvdHlwZS5jb21wdXRlRm9udFNpemUgPSBmdW5jdGlvbihhdmFpbFdpZHRoLCBhdmFpbEhlaWdodCkge1xuXHRpZiAodGhpcy5fb3B0aW9ucy50cmFuc3Bvc2UpIHtcblx0XHRhdmFpbFdpZHRoICs9IGF2YWlsSGVpZ2h0O1xuXHRcdGF2YWlsSGVpZ2h0ID0gYXZhaWxXaWR0aCAtIGF2YWlsSGVpZ2h0O1xuXHRcdGF2YWlsV2lkdGggLT0gYXZhaWxIZWlnaHQ7XG5cdH1cblxuXHR2YXIgaGV4U2l6ZVdpZHRoID0gMiphdmFpbFdpZHRoIC8gKCh0aGlzLl9vcHRpb25zLndpZHRoKzEpICogTWF0aC5zcXJ0KDMpKSAtIDE7XG5cdHZhciBoZXhTaXplSGVpZ2h0ID0gYXZhaWxIZWlnaHQgLyAoMiArIDEuNSoodGhpcy5fb3B0aW9ucy5oZWlnaHQtMSkpO1xuXHR2YXIgaGV4U2l6ZSA9IE1hdGgubWluKGhleFNpemVXaWR0aCwgaGV4U2l6ZUhlaWdodCk7XG5cblx0LyogY29tcHV0ZSBjaGFyIHJhdGlvICovXG5cdHZhciBvbGRGb250ID0gdGhpcy5fY29udGV4dC5mb250O1xuXHR0aGlzLl9jb250ZXh0LmZvbnQgPSBcIjEwMHB4IFwiICsgdGhpcy5fb3B0aW9ucy5mb250RmFtaWx5O1xuXHR2YXIgd2lkdGggPSBNYXRoLmNlaWwodGhpcy5fY29udGV4dC5tZWFzdXJlVGV4dChcIldcIikud2lkdGgpO1xuXHR0aGlzLl9jb250ZXh0LmZvbnQgPSBvbGRGb250O1xuXHR2YXIgcmF0aW8gPSB3aWR0aCAvIDEwMDtcblxuXHRoZXhTaXplID0gTWF0aC5mbG9vcihoZXhTaXplKSsxOyAvKiBjbG9zZXN0IGxhcmdlciBoZXhTaXplICovXG5cblx0LyogRklYTUUgY2hhciBzaXplIGNvbXB1dGF0aW9uIGRvZXMgbm90IHJlc3BlY3QgdHJhbnNwb3NlZCBoZXhlcyAqL1xuXHR2YXIgZm9udFNpemUgPSAyKmhleFNpemUgLyAodGhpcy5fb3B0aW9ucy5zcGFjaW5nICogKDEgKyByYXRpbyAvIE1hdGguc3FydCgzKSkpO1xuXG5cdC8qIGNsb3Nlc3Qgc21hbGxlciBmb250U2l6ZSAqL1xuXHRyZXR1cm4gTWF0aC5jZWlsKGZvbnRTaXplKS0xO1xufTtcblxuUk9ULkRpc3BsYXkuSGV4LnByb3RvdHlwZS5ldmVudFRvUG9zaXRpb24gPSBmdW5jdGlvbih4LCB5KSB7XG5cdGlmICh0aGlzLl9vcHRpb25zLnRyYW5zcG9zZSkge1xuXHRcdHggKz0geTtcblx0XHR5ID0geC15O1xuXHRcdHggLT0geTtcblx0XHR2YXIgbm9kZVNpemUgPSB0aGlzLl9jb250ZXh0LmNhbnZhcy53aWR0aDtcblx0fSBlbHNlIHtcblx0XHR2YXIgbm9kZVNpemUgPSB0aGlzLl9jb250ZXh0LmNhbnZhcy5oZWlnaHQ7XG5cdH1cblx0dmFyIHNpemUgPSBub2RlU2l6ZSAvIHRoaXMuX29wdGlvbnMuaGVpZ2h0O1xuXHR5ID0gTWF0aC5mbG9vcih5L3NpemUpO1xuXG5cdGlmICh5Lm1vZCgyKSkgeyAvKiBvZGQgcm93ICovXG5cdFx0eCAtPSB0aGlzLl9zcGFjaW5nWDtcblx0XHR4ID0gMSArIDIqTWF0aC5mbG9vcih4LygyKnRoaXMuX3NwYWNpbmdYKSk7XG5cdH0gZWxzZSB7XG5cdFx0eCA9IDIqTWF0aC5mbG9vcih4LygyKnRoaXMuX3NwYWNpbmdYKSk7XG5cdH1cblxuXHRyZXR1cm4gW3gsIHldO1xufTtcblxuLyoqXG4gKiBBcmd1bWVudHMgYXJlIHBpeGVsIHZhbHVlcy4gSWYgXCJ0cmFuc3Bvc2VkXCIgbW9kZSBpcyBlbmFibGVkLCB0aGVuIHRoZXNlIHR3byBhcmUgYWxyZWFkeSBzd2FwcGVkLlxuICovXG5ST1QuRGlzcGxheS5IZXgucHJvdG90eXBlLl9maWxsID0gZnVuY3Rpb24oY3gsIGN5KSB7XG5cdHZhciBhID0gdGhpcy5faGV4U2l6ZTtcblx0dmFyIGIgPSB0aGlzLl9vcHRpb25zLmJvcmRlcjtcblxuXHR0aGlzLl9jb250ZXh0LmJlZ2luUGF0aCgpO1xuXG5cdGlmICh0aGlzLl9vcHRpb25zLnRyYW5zcG9zZSkge1xuXHRcdHRoaXMuX2NvbnRleHQubW92ZVRvKGN4LWErYixcdGN5KTtcblx0XHR0aGlzLl9jb250ZXh0LmxpbmVUbyhjeC1hLzIrYixcdGN5K3RoaXMuX3NwYWNpbmdYLWIpO1xuXHRcdHRoaXMuX2NvbnRleHQubGluZVRvKGN4K2EvMi1iLFx0Y3krdGhpcy5fc3BhY2luZ1gtYik7XG5cdFx0dGhpcy5fY29udGV4dC5saW5lVG8oY3grYS1iLFx0Y3kpO1xuXHRcdHRoaXMuX2NvbnRleHQubGluZVRvKGN4K2EvMi1iLFx0Y3ktdGhpcy5fc3BhY2luZ1grYik7XG5cdFx0dGhpcy5fY29udGV4dC5saW5lVG8oY3gtYS8yK2IsXHRjeS10aGlzLl9zcGFjaW5nWCtiKTtcblx0XHR0aGlzLl9jb250ZXh0LmxpbmVUbyhjeC1hK2IsXHRjeSk7XG5cdH0gZWxzZSB7XG5cdFx0dGhpcy5fY29udGV4dC5tb3ZlVG8oY3gsXHRcdFx0XHRcdGN5LWErYik7XG5cdFx0dGhpcy5fY29udGV4dC5saW5lVG8oY3grdGhpcy5fc3BhY2luZ1gtYixcdGN5LWEvMitiKTtcblx0XHR0aGlzLl9jb250ZXh0LmxpbmVUbyhjeCt0aGlzLl9zcGFjaW5nWC1iLFx0Y3krYS8yLWIpO1xuXHRcdHRoaXMuX2NvbnRleHQubGluZVRvKGN4LFx0XHRcdFx0XHRjeSthLWIpO1xuXHRcdHRoaXMuX2NvbnRleHQubGluZVRvKGN4LXRoaXMuX3NwYWNpbmdYK2IsXHRjeSthLzItYik7XG5cdFx0dGhpcy5fY29udGV4dC5saW5lVG8oY3gtdGhpcy5fc3BhY2luZ1grYixcdGN5LWEvMitiKTtcblx0XHR0aGlzLl9jb250ZXh0LmxpbmVUbyhjeCxcdFx0XHRcdFx0Y3ktYStiKTtcblx0fVxuXHR0aGlzLl9jb250ZXh0LmZpbGwoKTtcbn07XG4vKipcbiAqIEBjbGFzcyBUaWxlIGJhY2tlbmRcbiAqIEBwcml2YXRlXG4gKi9cblJPVC5EaXNwbGF5LlRpbGUgPSBmdW5jdGlvbihjb250ZXh0KSB7XG5cdFJPVC5EaXNwbGF5LlJlY3QuY2FsbCh0aGlzLCBjb250ZXh0KTtcblx0XG5cdHRoaXMuX29wdGlvbnMgPSB7fTtcblx0dGhpcy5fY29sb3JDYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpO1xufTtcblJPVC5EaXNwbGF5LlRpbGUuZXh0ZW5kKFJPVC5EaXNwbGF5LlJlY3QpO1xuXG5ST1QuRGlzcGxheS5UaWxlLnByb3RvdHlwZS5jb21wdXRlID0gZnVuY3Rpb24ob3B0aW9ucykge1xuXHR0aGlzLl9vcHRpb25zID0gb3B0aW9ucztcblx0dGhpcy5fY29udGV4dC5jYW52YXMud2lkdGggPSBvcHRpb25zLndpZHRoICogb3B0aW9ucy50aWxlV2lkdGg7XG5cdHRoaXMuX2NvbnRleHQuY2FudmFzLmhlaWdodCA9IG9wdGlvbnMuaGVpZ2h0ICogb3B0aW9ucy50aWxlSGVpZ2h0O1xuXHR0aGlzLl9jb2xvckNhbnZhcy53aWR0aCA9IG9wdGlvbnMudGlsZVdpZHRoO1xuXHR0aGlzLl9jb2xvckNhbnZhcy5oZWlnaHQgPSBvcHRpb25zLnRpbGVIZWlnaHQ7XG59O1xuXG5ST1QuRGlzcGxheS5UaWxlLnByb3RvdHlwZS5kcmF3ID0gZnVuY3Rpb24oZGF0YSwgY2xlYXJCZWZvcmUpIHtcblx0dmFyIHggPSBkYXRhWzBdO1xuXHR2YXIgeSA9IGRhdGFbMV07XG5cdHZhciBjaCA9IGRhdGFbMl07XG5cdHZhciBmZyA9IGRhdGFbM107XG5cdHZhciBiZyA9IGRhdGFbNF07XG5cblx0dmFyIHRpbGVXaWR0aCA9IHRoaXMuX29wdGlvbnMudGlsZVdpZHRoO1xuXHR2YXIgdGlsZUhlaWdodCA9IHRoaXMuX29wdGlvbnMudGlsZUhlaWdodDtcblxuXHRpZiAoY2xlYXJCZWZvcmUpIHtcblx0XHRpZiAodGhpcy5fb3B0aW9ucy50aWxlQ29sb3JpemUpIHtcblx0XHRcdHRoaXMuX2NvbnRleHQuY2xlYXJSZWN0KHgqdGlsZVdpZHRoLCB5KnRpbGVIZWlnaHQsIHRpbGVXaWR0aCwgdGlsZUhlaWdodCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuX2NvbnRleHQuZmlsbFN0eWxlID0gYmc7XG5cdFx0XHR0aGlzLl9jb250ZXh0LmZpbGxSZWN0KHgqdGlsZVdpZHRoLCB5KnRpbGVIZWlnaHQsIHRpbGVXaWR0aCwgdGlsZUhlaWdodCk7XG5cdFx0fVxuXHR9XG5cblx0aWYgKCFjaCkgeyByZXR1cm47IH1cblxuXHR2YXIgY2hhcnMgPSBbXS5jb25jYXQoY2gpO1xuXHRmb3IgKHZhciBpPTA7aTxjaGFycy5sZW5ndGg7aSsrKSB7XG5cdFx0dmFyIHRpbGUgPSB0aGlzLl9vcHRpb25zLnRpbGVNYXBbY2hhcnNbaV1dO1xuXHRcdGlmICghdGlsZSkgeyB0aHJvdyBuZXcgRXJyb3IoXCJDaGFyICdcIiArIGNoYXJzW2ldICsgXCInIG5vdCBmb3VuZCBpbiB0aWxlTWFwXCIpOyB9XG5cdFx0XG5cdFx0aWYgKHRoaXMuX29wdGlvbnMudGlsZUNvbG9yaXplKSB7IC8qIGFwcGx5IGNvbG9yaXphdGlvbiAqL1xuXHRcdFx0dmFyIGNhbnZhcyA9IHRoaXMuX2NvbG9yQ2FudmFzO1xuXHRcdFx0dmFyIGNvbnRleHQgPSBjYW52YXMuZ2V0Q29udGV4dChcIjJkXCIpO1xuXHRcdFx0Y29udGV4dC5jbGVhclJlY3QoMCwgMCwgdGlsZVdpZHRoLCB0aWxlSGVpZ2h0KTtcblxuXHRcdFx0Y29udGV4dC5kcmF3SW1hZ2UoXG5cdFx0XHRcdHRoaXMuX29wdGlvbnMudGlsZVNldCxcblx0XHRcdFx0dGlsZVswXSwgdGlsZVsxXSwgdGlsZVdpZHRoLCB0aWxlSGVpZ2h0LFxuXHRcdFx0XHQwLCAwLCB0aWxlV2lkdGgsIHRpbGVIZWlnaHRcblx0XHRcdCk7XG5cblx0XHRcdGlmIChmZyAhPSBcInRyYW5zcGFyZW50XCIpIHtcblx0XHRcdFx0Y29udGV4dC5maWxsU3R5bGUgPSBmZztcblx0XHRcdFx0Y29udGV4dC5nbG9iYWxDb21wb3NpdGVPcGVyYXRpb24gPSBcInNvdXJjZS1hdG9wXCI7XG5cdFx0XHRcdGNvbnRleHQuZmlsbFJlY3QoMCwgMCwgdGlsZVdpZHRoLCB0aWxlSGVpZ2h0KTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKGJnICE9IFwidHJhbnNwYXJlbnRcIikge1xuXHRcdFx0XHRjb250ZXh0LmZpbGxTdHlsZSA9IGJnO1xuXHRcdFx0XHRjb250ZXh0Lmdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbiA9IFwiZGVzdGluYXRpb24tb3ZlclwiO1xuXHRcdFx0XHRjb250ZXh0LmZpbGxSZWN0KDAsIDAsIHRpbGVXaWR0aCwgdGlsZUhlaWdodCk7XG5cdFx0XHR9XG5cblx0XHRcdHRoaXMuX2NvbnRleHQuZHJhd0ltYWdlKGNhbnZhcywgeCp0aWxlV2lkdGgsIHkqdGlsZUhlaWdodCwgdGlsZVdpZHRoLCB0aWxlSGVpZ2h0KTtcblxuXHRcdH0gZWxzZSB7IC8qIG5vIGNvbG9yaXppbmcsIGVhc3kgKi9cblx0XHRcdHRoaXMuX2NvbnRleHQuZHJhd0ltYWdlKFxuXHRcdFx0XHR0aGlzLl9vcHRpb25zLnRpbGVTZXQsXG5cdFx0XHRcdHRpbGVbMF0sIHRpbGVbMV0sIHRpbGVXaWR0aCwgdGlsZUhlaWdodCxcblx0XHRcdFx0eCp0aWxlV2lkdGgsIHkqdGlsZUhlaWdodCwgdGlsZVdpZHRoLCB0aWxlSGVpZ2h0XG5cdFx0XHQpO1xuXHRcdH1cblx0fVxufTtcblxuUk9ULkRpc3BsYXkuVGlsZS5wcm90b3R5cGUuY29tcHV0ZVNpemUgPSBmdW5jdGlvbihhdmFpbFdpZHRoLCBhdmFpbEhlaWdodCkge1xuXHR2YXIgd2lkdGggPSBNYXRoLmZsb29yKGF2YWlsV2lkdGggLyB0aGlzLl9vcHRpb25zLnRpbGVXaWR0aCk7XG5cdHZhciBoZWlnaHQgPSBNYXRoLmZsb29yKGF2YWlsSGVpZ2h0IC8gdGhpcy5fb3B0aW9ucy50aWxlSGVpZ2h0KTtcblx0cmV0dXJuIFt3aWR0aCwgaGVpZ2h0XTtcbn07XG5cblJPVC5EaXNwbGF5LlRpbGUucHJvdG90eXBlLmNvbXB1dGVGb250U2l6ZSA9IGZ1bmN0aW9uKGF2YWlsV2lkdGgsIGF2YWlsSGVpZ2h0KSB7XG5cdHZhciB3aWR0aCA9IE1hdGguZmxvb3IoYXZhaWxXaWR0aCAvIHRoaXMuX29wdGlvbnMud2lkdGgpO1xuXHR2YXIgaGVpZ2h0ID0gTWF0aC5mbG9vcihhdmFpbEhlaWdodCAvIHRoaXMuX29wdGlvbnMuaGVpZ2h0KTtcblx0cmV0dXJuIFt3aWR0aCwgaGVpZ2h0XTtcbn07XG5cblJPVC5EaXNwbGF5LlRpbGUucHJvdG90eXBlLmV2ZW50VG9Qb3NpdGlvbiA9IGZ1bmN0aW9uKHgsIHkpIHtcblx0cmV0dXJuIFtNYXRoLmZsb29yKHgvdGhpcy5fb3B0aW9ucy50aWxlV2lkdGgpLCBNYXRoLmZsb29yKHkvdGhpcy5fb3B0aW9ucy50aWxlSGVpZ2h0KV07XG59O1xuLyoqXG4gKiBAbmFtZXNwYWNlXG4gKiBUaGlzIGNvZGUgaXMgYW4gaW1wbGVtZW50YXRpb24gb2YgQWxlYSBhbGdvcml0aG07IChDKSAyMDEwIEpvaGFubmVzIEJhYWfDuGUuXG4gKiBBbGVhIGlzIGxpY2Vuc2VkIGFjY29yZGluZyB0byB0aGUgaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9NSVRfTGljZW5zZS5cbiAqL1xuUk9ULlJORyA9IHtcblx0LyoqXG5cdCAqIEByZXR1cm5zIHtudW1iZXJ9IFxuXHQgKi9cblx0Z2V0U2VlZDogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIHRoaXMuX3NlZWQ7XG5cdH0sXG5cblx0LyoqXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSBzZWVkIFNlZWQgdGhlIG51bWJlciBnZW5lcmF0b3Jcblx0ICovXG5cdHNldFNlZWQ6IGZ1bmN0aW9uKHNlZWQpIHtcblx0XHRzZWVkID0gKHNlZWQgPCAxID8gMS9zZWVkIDogc2VlZCk7XG5cblx0XHR0aGlzLl9zZWVkID0gc2VlZDtcblx0XHR0aGlzLl9zMCA9IChzZWVkID4+PiAwKSAqIHRoaXMuX2ZyYWM7XG5cblx0XHRzZWVkID0gKHNlZWQqNjkwNjkgKyAxKSA+Pj4gMDtcblx0XHR0aGlzLl9zMSA9IHNlZWQgKiB0aGlzLl9mcmFjO1xuXG5cdFx0c2VlZCA9IChzZWVkKjY5MDY5ICsgMSkgPj4+IDA7XG5cdFx0dGhpcy5fczIgPSBzZWVkICogdGhpcy5fZnJhYztcblxuXHRcdHRoaXMuX2MgPSAxO1xuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXG5cdC8qKlxuXHQgKiBAcmV0dXJucyB7ZmxvYXR9IFBzZXVkb3JhbmRvbSB2YWx1ZSBbMCwxKSwgdW5pZm9ybWx5IGRpc3RyaWJ1dGVkXG5cdCAqL1xuXHRnZXRVbmlmb3JtOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgdCA9IDIwOTE2MzkgKiB0aGlzLl9zMCArIHRoaXMuX2MgKiB0aGlzLl9mcmFjO1xuXHRcdHRoaXMuX3MwID0gdGhpcy5fczE7XG5cdFx0dGhpcy5fczEgPSB0aGlzLl9zMjtcblx0XHR0aGlzLl9jID0gdCB8IDA7XG5cdFx0dGhpcy5fczIgPSB0IC0gdGhpcy5fYztcblx0XHRyZXR1cm4gdGhpcy5fczI7XG5cdH0sXG5cblx0LyoqXG5cdCAqIEBwYXJhbSB7aW50fSBsb3dlckJvdW5kIFRoZSBsb3dlciBlbmQgb2YgdGhlIHJhbmdlIHRvIHJldHVybiBhIHZhbHVlIGZyb20sIGluY2x1c2l2ZVxuXHQgKiBAcGFyYW0ge2ludH0gdXBwZXJCb3VuZCBUaGUgdXBwZXIgZW5kIG9mIHRoZSByYW5nZSB0byByZXR1cm4gYSB2YWx1ZSBmcm9tLCBpbmNsdXNpdmVcblx0ICogQHJldHVybnMge2ludH0gUHNldWRvcmFuZG9tIHZhbHVlIFtsb3dlckJvdW5kLCB1cHBlckJvdW5kXSwgdXNpbmcgUk9ULlJORy5nZXRVbmlmb3JtKCkgdG8gZGlzdHJpYnV0ZSB0aGUgdmFsdWVcblx0ICovXG5cdGdldFVuaWZvcm1JbnQ6IGZ1bmN0aW9uKGxvd2VyQm91bmQsIHVwcGVyQm91bmQpIHtcblx0XHR2YXIgbWF4ID0gTWF0aC5tYXgobG93ZXJCb3VuZCwgdXBwZXJCb3VuZCk7XG5cdFx0dmFyIG1pbiA9IE1hdGgubWluKGxvd2VyQm91bmQsIHVwcGVyQm91bmQpO1xuXHRcdHJldHVybiBNYXRoLmZsb29yKHRoaXMuZ2V0VW5pZm9ybSgpICogKG1heCAtIG1pbiArIDEpKSArIG1pbjtcblx0fSxcblxuXHQvKipcblx0ICogQHBhcmFtIHtmbG9hdH0gW21lYW49MF0gTWVhbiB2YWx1ZVxuXHQgKiBAcGFyYW0ge2Zsb2F0fSBbc3RkZGV2PTFdIFN0YW5kYXJkIGRldmlhdGlvbi4gfjk1JSBvZiB0aGUgYWJzb2x1dGUgdmFsdWVzIHdpbGwgYmUgbG93ZXIgdGhhbiAyKnN0ZGRldi5cblx0ICogQHJldHVybnMge2Zsb2F0fSBBIG5vcm1hbGx5IGRpc3RyaWJ1dGVkIHBzZXVkb3JhbmRvbSB2YWx1ZVxuXHQgKi9cblx0Z2V0Tm9ybWFsOiBmdW5jdGlvbihtZWFuLCBzdGRkZXYpIHtcblx0XHRkbyB7XG5cdFx0XHR2YXIgdSA9IDIqdGhpcy5nZXRVbmlmb3JtKCktMTtcblx0XHRcdHZhciB2ID0gMip0aGlzLmdldFVuaWZvcm0oKS0xO1xuXHRcdFx0dmFyIHIgPSB1KnUgKyB2KnY7XG5cdFx0fSB3aGlsZSAociA+IDEgfHwgciA9PSAwKTtcblxuXHRcdHZhciBnYXVzcyA9IHUgKiBNYXRoLnNxcnQoLTIqTWF0aC5sb2cocikvcik7XG5cdFx0cmV0dXJuIChtZWFuIHx8IDApICsgZ2F1c3MqKHN0ZGRldiB8fCAxKTtcblx0fSxcblxuXHQvKipcblx0ICogQHJldHVybnMge2ludH0gUHNldWRvcmFuZG9tIHZhbHVlIFsxLDEwMF0gaW5jbHVzaXZlLCB1bmlmb3JtbHkgZGlzdHJpYnV0ZWRcblx0ICovXG5cdGdldFBlcmNlbnRhZ2U6IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiAxICsgTWF0aC5mbG9vcih0aGlzLmdldFVuaWZvcm0oKSoxMDApO1xuXHR9LFxuXHRcblx0LyoqXG5cdCAqIEBwYXJhbSB7b2JqZWN0fSBkYXRhIGtleT13aGF0ZXZlciwgdmFsdWU9d2VpZ2h0IChyZWxhdGl2ZSBwcm9iYWJpbGl0eSlcblx0ICogQHJldHVybnMge3N0cmluZ30gd2hhdGV2ZXJcblx0ICovXG5cdGdldFdlaWdodGVkVmFsdWU6IGZ1bmN0aW9uKGRhdGEpIHtcblx0XHR2YXIgdG90YWwgPSAwO1xuXHRcdFxuXHRcdGZvciAodmFyIGlkIGluIGRhdGEpIHtcblx0XHRcdHRvdGFsICs9IGRhdGFbaWRdO1xuXHRcdH1cblx0XHR2YXIgcmFuZG9tID0gdGhpcy5nZXRVbmlmb3JtKCkqdG90YWw7XG5cdFx0XG5cdFx0dmFyIHBhcnQgPSAwO1xuXHRcdGZvciAodmFyIGlkIGluIGRhdGEpIHtcblx0XHRcdHBhcnQgKz0gZGF0YVtpZF07XG5cdFx0XHRpZiAocmFuZG9tIDwgcGFydCkgeyByZXR1cm4gaWQ7IH1cblx0XHR9XG5cblx0XHQvLyBJZiBieSBzb21lIGZsb2F0aW5nLXBvaW50IGFubm95YW5jZSB3ZSBoYXZlXG5cdFx0Ly8gcmFuZG9tID49IHRvdGFsLCBqdXN0IHJldHVybiB0aGUgbGFzdCBpZC5cblx0XHRyZXR1cm4gaWQ7XG5cdH0sXG5cblx0LyoqXG5cdCAqIEdldCBSTkcgc3RhdGUuIFVzZWZ1bCBmb3Igc3RvcmluZyB0aGUgc3RhdGUgYW5kIHJlLXNldHRpbmcgaXQgdmlhIHNldFN0YXRlLlxuXHQgKiBAcmV0dXJucyB7P30gSW50ZXJuYWwgc3RhdGVcblx0ICovXG5cdGdldFN0YXRlOiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gW3RoaXMuX3MwLCB0aGlzLl9zMSwgdGhpcy5fczIsIHRoaXMuX2NdO1xuXHR9LFxuXG5cdC8qKlxuXHQgKiBTZXQgYSBwcmV2aW91c2x5IHJldHJpZXZlZCBzdGF0ZS5cblx0ICogQHBhcmFtIHs/fSBzdGF0ZVxuXHQgKi9cblx0c2V0U3RhdGU6IGZ1bmN0aW9uKHN0YXRlKSB7XG5cdFx0dGhpcy5fczAgPSBzdGF0ZVswXTtcblx0XHR0aGlzLl9zMSA9IHN0YXRlWzFdO1xuXHRcdHRoaXMuX3MyID0gc3RhdGVbMl07XG5cdFx0dGhpcy5fYyAgPSBzdGF0ZVszXTtcblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblxuXHQvKipcblx0ICogUmV0dXJucyBhIGNsb25lZCBSTkdcblx0ICovXG5cdGNsb25lOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgY2xvbmUgPSBPYmplY3QuY3JlYXRlKHRoaXMpO1xuXHRcdGNsb25lLnNldFN0YXRlKHRoaXMuZ2V0U3RhdGUoKSk7XG5cdFx0cmV0dXJuIGNsb25lO1xuXHR9LFxuXG5cdF9zMDogMCxcblx0X3MxOiAwLFxuXHRfczI6IDAsXG5cdF9jOiAwLFxuXHRfZnJhYzogMi4zMjgzMDY0MzY1Mzg2OTYzZS0xMCAvKiAyXi0zMiAqL1xufTtcblxuUk9ULlJORy5zZXRTZWVkKERhdGUubm93KCkpO1xuLyoqXG4gKiBAY2xhc3MgKE1hcmtvdiBwcm9jZXNzKS1iYXNlZCBzdHJpbmcgZ2VuZXJhdG9yLiBcbiAqIENvcGllZCBmcm9tIGEgPGEgaHJlZj1cImh0dHA6Ly93d3cucm9ndWViYXNpbi5yb2d1ZWxpa2VkZXZlbG9wbWVudC5vcmcvaW5kZXgucGhwP3RpdGxlPU5hbWVzX2Zyb21fYV9oaWdoX29yZGVyX01hcmtvdl9Qcm9jZXNzX2FuZF9hX3NpbXBsaWZpZWRfS2F0el9iYWNrLW9mZl9zY2hlbWVcIj5Sb2d1ZUJhc2luIGFydGljbGU8L2E+LiBcbiAqIE9mZmVycyBjb25maWd1cmFibGUgb3JkZXIgYW5kIHByaW9yLlxuICogQHBhcmFtIHtvYmplY3R9IFtvcHRpb25zXVxuICogQHBhcmFtIHtib29sfSBbb3B0aW9ucy53b3Jkcz1mYWxzZV0gVXNlIHdvcmQgbW9kZT9cbiAqIEBwYXJhbSB7aW50fSBbb3B0aW9ucy5vcmRlcj0zXVxuICogQHBhcmFtIHtmbG9hdH0gW29wdGlvbnMucHJpb3I9MC4wMDFdXG4gKi9cblJPVC5TdHJpbmdHZW5lcmF0b3IgPSBmdW5jdGlvbihvcHRpb25zKSB7XG5cdHRoaXMuX29wdGlvbnMgPSB7XG5cdFx0d29yZHM6IGZhbHNlLFxuXHRcdG9yZGVyOiAzLFxuXHRcdHByaW9yOiAwLjAwMVxuXHR9O1xuXHRmb3IgKHZhciBwIGluIG9wdGlvbnMpIHsgdGhpcy5fb3B0aW9uc1twXSA9IG9wdGlvbnNbcF07IH1cblxuXHR0aGlzLl9ib3VuZGFyeSA9IFN0cmluZy5mcm9tQ2hhckNvZGUoMCk7XG5cdHRoaXMuX3N1ZmZpeCA9IHRoaXMuX2JvdW5kYXJ5O1xuXHR0aGlzLl9wcmVmaXggPSBbXTtcblx0Zm9yICh2YXIgaT0wO2k8dGhpcy5fb3B0aW9ucy5vcmRlcjtpKyspIHsgdGhpcy5fcHJlZml4LnB1c2godGhpcy5fYm91bmRhcnkpOyB9XG5cblx0dGhpcy5fcHJpb3JWYWx1ZXMgPSB7fTtcblx0dGhpcy5fcHJpb3JWYWx1ZXNbdGhpcy5fYm91bmRhcnldID0gdGhpcy5fb3B0aW9ucy5wcmlvcjtcblxuXHR0aGlzLl9kYXRhID0ge307XG59O1xuXG4vKipcbiAqIFJlbW92ZSBhbGwgbGVhcm5pbmcgZGF0YVxuICovXG5ST1QuU3RyaW5nR2VuZXJhdG9yLnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uKCkge1xuXHR0aGlzLl9kYXRhID0ge307XG5cdHRoaXMuX3ByaW9yVmFsdWVzID0ge307XG59O1xuXG4vKipcbiAqIEByZXR1cm5zIHtzdHJpbmd9IEdlbmVyYXRlZCBzdHJpbmdcbiAqL1xuUk9ULlN0cmluZ0dlbmVyYXRvci5wcm90b3R5cGUuZ2VuZXJhdGUgPSBmdW5jdGlvbigpIHtcblx0dmFyIHJlc3VsdCA9IFt0aGlzLl9zYW1wbGUodGhpcy5fcHJlZml4KV07XG5cdHdoaWxlIChyZXN1bHRbcmVzdWx0Lmxlbmd0aC0xXSAhPSB0aGlzLl9ib3VuZGFyeSkge1xuXHRcdHJlc3VsdC5wdXNoKHRoaXMuX3NhbXBsZShyZXN1bHQpKTtcblx0fVxuXHRyZXR1cm4gdGhpcy5fam9pbihyZXN1bHQuc2xpY2UoMCwgLTEpKTtcbn07XG5cbi8qKlxuICogT2JzZXJ2ZSAobGVhcm4pIGEgc3RyaW5nIGZyb20gYSB0cmFpbmluZyBzZXRcbiAqL1xuUk9ULlN0cmluZ0dlbmVyYXRvci5wcm90b3R5cGUub2JzZXJ2ZSA9IGZ1bmN0aW9uKHN0cmluZykge1xuXHR2YXIgdG9rZW5zID0gdGhpcy5fc3BsaXQoc3RyaW5nKTtcblxuXHRmb3IgKHZhciBpPTA7IGk8dG9rZW5zLmxlbmd0aDsgaSsrKSB7XG5cdFx0dGhpcy5fcHJpb3JWYWx1ZXNbdG9rZW5zW2ldXSA9IHRoaXMuX29wdGlvbnMucHJpb3I7XG5cdH1cblxuXHR0b2tlbnMgPSB0aGlzLl9wcmVmaXguY29uY2F0KHRva2VucykuY29uY2F0KHRoaXMuX3N1ZmZpeCk7IC8qIGFkZCBib3VuZGFyeSBzeW1ib2xzICovXG5cblx0Zm9yICh2YXIgaT10aGlzLl9vcHRpb25zLm9yZGVyOyBpPHRva2Vucy5sZW5ndGg7IGkrKykge1xuXHRcdHZhciBjb250ZXh0ID0gdG9rZW5zLnNsaWNlKGktdGhpcy5fb3B0aW9ucy5vcmRlciwgaSk7XG5cdFx0dmFyIGV2ZW50ID0gdG9rZW5zW2ldO1xuXHRcdGZvciAodmFyIGo9MDsgajxjb250ZXh0Lmxlbmd0aDsgaisrKSB7XG5cdFx0XHR2YXIgc3ViY29udGV4dCA9IGNvbnRleHQuc2xpY2Uoaik7XG5cdFx0XHR0aGlzLl9vYnNlcnZlRXZlbnQoc3ViY29udGV4dCwgZXZlbnQpO1xuXHRcdH1cblx0fVxufTtcblxuUk9ULlN0cmluZ0dlbmVyYXRvci5wcm90b3R5cGUuZ2V0U3RhdHMgPSBmdW5jdGlvbigpIHtcblx0dmFyIHBhcnRzID0gW107XG5cblx0dmFyIHByaW9yQ291bnQgPSAwO1xuXHRmb3IgKHZhciBwIGluIHRoaXMuX3ByaW9yVmFsdWVzKSB7IHByaW9yQ291bnQrKzsgfVxuXHRwcmlvckNvdW50LS07IC8qIGJvdW5kYXJ5ICovXG5cdHBhcnRzLnB1c2goXCJkaXN0aW5jdCBzYW1wbGVzOiBcIiArIHByaW9yQ291bnQpO1xuXG5cdHZhciBkYXRhQ291bnQgPSAwO1xuXHR2YXIgZXZlbnRDb3VudCA9IDA7XG5cdGZvciAodmFyIHAgaW4gdGhpcy5fZGF0YSkgeyBcblx0XHRkYXRhQ291bnQrKzsgXG5cdFx0Zm9yICh2YXIga2V5IGluIHRoaXMuX2RhdGFbcF0pIHtcblx0XHRcdGV2ZW50Q291bnQrKztcblx0XHR9XG5cdH1cblx0cGFydHMucHVzaChcImRpY3Rpb25hcnkgc2l6ZSAoY29udGV4dHMpOiBcIiArIGRhdGFDb3VudCk7XG5cdHBhcnRzLnB1c2goXCJkaWN0aW9uYXJ5IHNpemUgKGV2ZW50cyk6IFwiICsgZXZlbnRDb3VudCk7XG5cblx0cmV0dXJuIHBhcnRzLmpvaW4oXCIsIFwiKTtcbn07XG5cbi8qKlxuICogQHBhcmFtIHtzdHJpbmd9XG4gKiBAcmV0dXJucyB7c3RyaW5nW119XG4gKi9cblJPVC5TdHJpbmdHZW5lcmF0b3IucHJvdG90eXBlLl9zcGxpdCA9IGZ1bmN0aW9uKHN0cikge1xuXHRyZXR1cm4gc3RyLnNwbGl0KHRoaXMuX29wdGlvbnMud29yZHMgPyAvXFxzKy8gOiBcIlwiKTtcbn07XG5cbi8qKlxuICogQHBhcmFtIHtzdHJpbmdbXX1cbiAqIEByZXR1cm5zIHtzdHJpbmd9IFxuICovXG5ST1QuU3RyaW5nR2VuZXJhdG9yLnByb3RvdHlwZS5fam9pbiA9IGZ1bmN0aW9uKGFycikge1xuXHRyZXR1cm4gYXJyLmpvaW4odGhpcy5fb3B0aW9ucy53b3JkcyA/IFwiIFwiIDogXCJcIik7XG59O1xuXG4vKipcbiAqIEBwYXJhbSB7c3RyaW5nW119IGNvbnRleHRcbiAqIEBwYXJhbSB7c3RyaW5nfSBldmVudFxuICovXG5ST1QuU3RyaW5nR2VuZXJhdG9yLnByb3RvdHlwZS5fb2JzZXJ2ZUV2ZW50ID0gZnVuY3Rpb24oY29udGV4dCwgZXZlbnQpIHtcblx0dmFyIGtleSA9IHRoaXMuX2pvaW4oY29udGV4dCk7XG5cdGlmICghKGtleSBpbiB0aGlzLl9kYXRhKSkgeyB0aGlzLl9kYXRhW2tleV0gPSB7fTsgfVxuXHR2YXIgZGF0YSA9IHRoaXMuX2RhdGFba2V5XTtcblxuXHRpZiAoIShldmVudCBpbiBkYXRhKSkgeyBkYXRhW2V2ZW50XSA9IDA7IH1cblx0ZGF0YVtldmVudF0rKztcbn07XG5cbi8qKlxuICogQHBhcmFtIHtzdHJpbmdbXX1cbiAqIEByZXR1cm5zIHtzdHJpbmd9XG4gKi9cblJPVC5TdHJpbmdHZW5lcmF0b3IucHJvdG90eXBlLl9zYW1wbGUgPSBmdW5jdGlvbihjb250ZXh0KSB7XG5cdGNvbnRleHQgPSB0aGlzLl9iYWNrb2ZmKGNvbnRleHQpO1xuXHR2YXIga2V5ID0gdGhpcy5fam9pbihjb250ZXh0KTtcblx0dmFyIGRhdGEgPSB0aGlzLl9kYXRhW2tleV07XG5cblx0dmFyIGF2YWlsYWJsZSA9IHt9O1xuXG5cdGlmICh0aGlzLl9vcHRpb25zLnByaW9yKSB7XG5cdFx0Zm9yICh2YXIgZXZlbnQgaW4gdGhpcy5fcHJpb3JWYWx1ZXMpIHsgYXZhaWxhYmxlW2V2ZW50XSA9IHRoaXMuX3ByaW9yVmFsdWVzW2V2ZW50XTsgfVxuXHRcdGZvciAodmFyIGV2ZW50IGluIGRhdGEpIHsgYXZhaWxhYmxlW2V2ZW50XSArPSBkYXRhW2V2ZW50XTsgfVxuXHR9IGVsc2UgeyBcblx0XHRhdmFpbGFibGUgPSBkYXRhO1xuXHR9XG5cblx0cmV0dXJuIFJPVC5STkcuZ2V0V2VpZ2h0ZWRWYWx1ZShhdmFpbGFibGUpO1xufTtcblxuLyoqXG4gKiBAcGFyYW0ge3N0cmluZ1tdfVxuICogQHJldHVybnMge3N0cmluZ1tdfVxuICovXG5ST1QuU3RyaW5nR2VuZXJhdG9yLnByb3RvdHlwZS5fYmFja29mZiA9IGZ1bmN0aW9uKGNvbnRleHQpIHtcblx0aWYgKGNvbnRleHQubGVuZ3RoID4gdGhpcy5fb3B0aW9ucy5vcmRlcikge1xuXHRcdGNvbnRleHQgPSBjb250ZXh0LnNsaWNlKC10aGlzLl9vcHRpb25zLm9yZGVyKTtcblx0fSBlbHNlIGlmIChjb250ZXh0Lmxlbmd0aCA8IHRoaXMuX29wdGlvbnMub3JkZXIpIHtcblx0XHRjb250ZXh0ID0gdGhpcy5fcHJlZml4LnNsaWNlKDAsIHRoaXMuX29wdGlvbnMub3JkZXIgLSBjb250ZXh0Lmxlbmd0aCkuY29uY2F0KGNvbnRleHQpO1xuXHR9XG5cblx0d2hpbGUgKCEodGhpcy5fam9pbihjb250ZXh0KSBpbiB0aGlzLl9kYXRhKSAmJiBjb250ZXh0Lmxlbmd0aCA+IDApIHsgY29udGV4dCA9IGNvbnRleHQuc2xpY2UoMSk7IH1cblxuXHRyZXR1cm4gY29udGV4dDtcbn07XG4vKipcbiAqIEBjbGFzcyBHZW5lcmljIGV2ZW50IHF1ZXVlOiBzdG9yZXMgZXZlbnRzIGFuZCByZXRyaWV2ZXMgdGhlbSBiYXNlZCBvbiB0aGVpciB0aW1lXG4gKi9cblJPVC5FdmVudFF1ZXVlID0gZnVuY3Rpb24oKSB7XG5cdHRoaXMuX3RpbWUgPSAwO1xuXHR0aGlzLl9ldmVudHMgPSBbXTtcblx0dGhpcy5fZXZlbnRUaW1lcyA9IFtdO1xufTtcblxuLyoqXG4gKiBAcmV0dXJucyB7bnVtYmVyfSBFbGFwc2VkIHRpbWVcbiAqL1xuUk9ULkV2ZW50UXVldWUucHJvdG90eXBlLmdldFRpbWUgPSBmdW5jdGlvbigpIHtcblx0cmV0dXJuIHRoaXMuX3RpbWU7XG59O1xuXG4vKipcbiAqIENsZWFyIGFsbCBzY2hlZHVsZWQgZXZlbnRzXG4gKi9cblJPVC5FdmVudFF1ZXVlLnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uKCkge1xuXHR0aGlzLl9ldmVudHMgPSBbXTtcblx0dGhpcy5fZXZlbnRUaW1lcyA9IFtdO1xuXHRyZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogQHBhcmFtIHs/fSBldmVudFxuICogQHBhcmFtIHtudW1iZXJ9IHRpbWVcbiAqL1xuUk9ULkV2ZW50UXVldWUucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uKGV2ZW50LCB0aW1lKSB7XG5cdHZhciBpbmRleCA9IHRoaXMuX2V2ZW50cy5sZW5ndGg7XG5cdGZvciAodmFyIGk9MDtpPHRoaXMuX2V2ZW50VGltZXMubGVuZ3RoO2krKykge1xuXHRcdGlmICh0aGlzLl9ldmVudFRpbWVzW2ldID4gdGltZSkge1xuXHRcdFx0aW5kZXggPSBpO1xuXHRcdFx0YnJlYWs7XG5cdFx0fVxuXHR9XG5cblx0dGhpcy5fZXZlbnRzLnNwbGljZShpbmRleCwgMCwgZXZlbnQpO1xuXHR0aGlzLl9ldmVudFRpbWVzLnNwbGljZShpbmRleCwgMCwgdGltZSk7XG59O1xuXG4vKipcbiAqIExvY2F0ZXMgdGhlIG5lYXJlc3QgZXZlbnQsIGFkdmFuY2VzIHRpbWUgaWYgbmVjZXNzYXJ5LiBSZXR1cm5zIHRoYXQgZXZlbnQgYW5kIHJlbW92ZXMgaXQgZnJvbSB0aGUgcXVldWUuXG4gKiBAcmV0dXJucyB7PyB8fCBudWxsfSBUaGUgZXZlbnQgcHJldmlvdXNseSBhZGRlZCBieSBhZGRFdmVudCwgbnVsbCBpZiBubyBldmVudCBhdmFpbGFibGVcbiAqL1xuUk9ULkV2ZW50UXVldWUucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uKCkge1xuXHRpZiAoIXRoaXMuX2V2ZW50cy5sZW5ndGgpIHsgcmV0dXJuIG51bGw7IH1cblxuXHR2YXIgdGltZSA9IHRoaXMuX2V2ZW50VGltZXMuc3BsaWNlKDAsIDEpWzBdO1xuXHRpZiAodGltZSA+IDApIHsgLyogYWR2YW5jZSAqL1xuXHRcdHRoaXMuX3RpbWUgKz0gdGltZTtcblx0XHRmb3IgKHZhciBpPTA7aTx0aGlzLl9ldmVudFRpbWVzLmxlbmd0aDtpKyspIHsgdGhpcy5fZXZlbnRUaW1lc1tpXSAtPSB0aW1lOyB9XG5cdH1cblxuXHRyZXR1cm4gdGhpcy5fZXZlbnRzLnNwbGljZSgwLCAxKVswXTtcbn07XG5cbi8qKlxuICogR2V0IHRoZSB0aW1lIGFzc29jaWF0ZWQgd2l0aCB0aGUgZ2l2ZW4gZXZlbnRcbiAqIEBwYXJhbSB7P30gZXZlbnRcbiAqIEByZXR1cm5zIHtudW1iZXJ9IHRpbWVcbiAqL1xuUk9ULkV2ZW50UXVldWUucHJvdG90eXBlLmdldEV2ZW50VGltZSA9IGZ1bmN0aW9uKGV2ZW50KSB7XG5cdHZhciBpbmRleCA9IHRoaXMuX2V2ZW50cy5pbmRleE9mKGV2ZW50KTtcblx0aWYgKGluZGV4ID09IC0xKSB7IHJldHVybiB1bmRlZmluZWQgfVxuXHRyZXR1cm4gdGhpcy5fZXZlbnRUaW1lc1tpbmRleF07XG59O1xuXG4vKipcbiAqIFJlbW92ZSBhbiBldmVudCBmcm9tIHRoZSBxdWV1ZVxuICogQHBhcmFtIHs/fSBldmVudFxuICogQHJldHVybnMge2Jvb2x9IHN1Y2Nlc3M/XG4gKi9cblJPVC5FdmVudFF1ZXVlLnByb3RvdHlwZS5yZW1vdmUgPSBmdW5jdGlvbihldmVudCkge1xuXHR2YXIgaW5kZXggPSB0aGlzLl9ldmVudHMuaW5kZXhPZihldmVudCk7XG5cdGlmIChpbmRleCA9PSAtMSkgeyByZXR1cm4gZmFsc2UgfVxuXHR0aGlzLl9yZW1vdmUoaW5kZXgpO1xuXHRyZXR1cm4gdHJ1ZTtcbn07XG5cbi8qKlxuICogUmVtb3ZlIGFuIGV2ZW50IGZyb20gdGhlIHF1ZXVlXG4gKiBAcGFyYW0ge2ludH0gaW5kZXhcbiAqL1xuUk9ULkV2ZW50UXVldWUucHJvdG90eXBlLl9yZW1vdmUgPSBmdW5jdGlvbihpbmRleCkge1xuXHR0aGlzLl9ldmVudHMuc3BsaWNlKGluZGV4LCAxKTtcblx0dGhpcy5fZXZlbnRUaW1lcy5zcGxpY2UoaW5kZXgsIDEpO1xufTtcbi8qKlxuICogQGNsYXNzIEFic3RyYWN0IHNjaGVkdWxlclxuICovXG5ST1QuU2NoZWR1bGVyID0gZnVuY3Rpb24oKSB7XG5cdHRoaXMuX3F1ZXVlID0gbmV3IFJPVC5FdmVudFF1ZXVlKCk7XG5cdHRoaXMuX3JlcGVhdCA9IFtdO1xuXHR0aGlzLl9jdXJyZW50ID0gbnVsbDtcbn07XG5cbi8qKlxuICogQHNlZSBST1QuRXZlbnRRdWV1ZSNnZXRUaW1lXG4gKi9cblJPVC5TY2hlZHVsZXIucHJvdG90eXBlLmdldFRpbWUgPSBmdW5jdGlvbigpIHtcblx0cmV0dXJuIHRoaXMuX3F1ZXVlLmdldFRpbWUoKTtcbn07XG5cbi8qKlxuICogQHBhcmFtIHs/fSBpdGVtXG4gKiBAcGFyYW0ge2Jvb2x9IHJlcGVhdFxuICovXG5ST1QuU2NoZWR1bGVyLnByb3RvdHlwZS5hZGQgPSBmdW5jdGlvbihpdGVtLCByZXBlYXQpIHtcblx0aWYgKHJlcGVhdCkgeyB0aGlzLl9yZXBlYXQucHVzaChpdGVtKTsgfVxuXHRyZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogR2V0IHRoZSB0aW1lIHRoZSBnaXZlbiBpdGVtIGlzIHNjaGVkdWxlZCBmb3JcbiAqIEBwYXJhbSB7P30gaXRlbVxuICogQHJldHVybnMge251bWJlcn0gdGltZVxuICovXG5ST1QuU2NoZWR1bGVyLnByb3RvdHlwZS5nZXRUaW1lT2YgPSBmdW5jdGlvbihpdGVtKSB7XG5cdHJldHVybiB0aGlzLl9xdWV1ZS5nZXRFdmVudFRpbWUoaXRlbSk7XG59O1xuXG4vKipcbiAqIENsZWFyIGFsbCBpdGVtc1xuICovXG5ST1QuU2NoZWR1bGVyLnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uKCkge1xuXHR0aGlzLl9xdWV1ZS5jbGVhcigpO1xuXHR0aGlzLl9yZXBlYXQgPSBbXTtcblx0dGhpcy5fY3VycmVudCA9IG51bGw7XG5cdHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBSZW1vdmUgYSBwcmV2aW91c2x5IGFkZGVkIGl0ZW1cbiAqIEBwYXJhbSB7P30gaXRlbVxuICogQHJldHVybnMge2Jvb2x9IHN1Y2Nlc3NmdWw/XG4gKi9cblJPVC5TY2hlZHVsZXIucHJvdG90eXBlLnJlbW92ZSA9IGZ1bmN0aW9uKGl0ZW0pIHtcblx0dmFyIHJlc3VsdCA9IHRoaXMuX3F1ZXVlLnJlbW92ZShpdGVtKTtcblxuXHR2YXIgaW5kZXggPSB0aGlzLl9yZXBlYXQuaW5kZXhPZihpdGVtKTtcblx0aWYgKGluZGV4ICE9IC0xKSB7IHRoaXMuX3JlcGVhdC5zcGxpY2UoaW5kZXgsIDEpOyB9XG5cblx0aWYgKHRoaXMuX2N1cnJlbnQgPT0gaXRlbSkgeyB0aGlzLl9jdXJyZW50ID0gbnVsbDsgfVxuXG5cdHJldHVybiByZXN1bHQ7XG59O1xuXG4vKipcbiAqIFNjaGVkdWxlIG5leHQgaXRlbVxuICogQHJldHVybnMgez99XG4gKi9cblJPVC5TY2hlZHVsZXIucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbigpIHtcblx0dGhpcy5fY3VycmVudCA9IHRoaXMuX3F1ZXVlLmdldCgpO1xuXHRyZXR1cm4gdGhpcy5fY3VycmVudDtcbn07XG4vKipcbiAqIEBjbGFzcyBTaW1wbGUgZmFpciBzY2hlZHVsZXIgKHJvdW5kLXJvYmluIHN0eWxlKVxuICogQGF1Z21lbnRzIFJPVC5TY2hlZHVsZXJcbiAqL1xuUk9ULlNjaGVkdWxlci5TaW1wbGUgPSBmdW5jdGlvbigpIHtcblx0Uk9ULlNjaGVkdWxlci5jYWxsKHRoaXMpO1xufTtcblJPVC5TY2hlZHVsZXIuU2ltcGxlLmV4dGVuZChST1QuU2NoZWR1bGVyKTtcblxuLyoqXG4gKiBAc2VlIFJPVC5TY2hlZHVsZXIjYWRkXG4gKi9cblJPVC5TY2hlZHVsZXIuU2ltcGxlLnByb3RvdHlwZS5hZGQgPSBmdW5jdGlvbihpdGVtLCByZXBlYXQpIHtcblx0dGhpcy5fcXVldWUuYWRkKGl0ZW0sIDApO1xuXHRyZXR1cm4gUk9ULlNjaGVkdWxlci5wcm90b3R5cGUuYWRkLmNhbGwodGhpcywgaXRlbSwgcmVwZWF0KTtcbn07XG5cbi8qKlxuICogQHNlZSBST1QuU2NoZWR1bGVyI25leHRcbiAqL1xuUk9ULlNjaGVkdWxlci5TaW1wbGUucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbigpIHtcblx0aWYgKHRoaXMuX2N1cnJlbnQgJiYgdGhpcy5fcmVwZWF0LmluZGV4T2YodGhpcy5fY3VycmVudCkgIT0gLTEpIHtcblx0XHR0aGlzLl9xdWV1ZS5hZGQodGhpcy5fY3VycmVudCwgMCk7XG5cdH1cblx0cmV0dXJuIFJPVC5TY2hlZHVsZXIucHJvdG90eXBlLm5leHQuY2FsbCh0aGlzKTtcbn07XG4vKipcbiAqIEBjbGFzcyBTcGVlZC1iYXNlZCBzY2hlZHVsZXJcbiAqIEBhdWdtZW50cyBST1QuU2NoZWR1bGVyXG4gKi9cblJPVC5TY2hlZHVsZXIuU3BlZWQgPSBmdW5jdGlvbigpIHtcblx0Uk9ULlNjaGVkdWxlci5jYWxsKHRoaXMpO1xufTtcblJPVC5TY2hlZHVsZXIuU3BlZWQuZXh0ZW5kKFJPVC5TY2hlZHVsZXIpO1xuXG4vKipcbiAqIEBwYXJhbSB7b2JqZWN0fSBpdGVtIGFueXRoaW5nIHdpdGggXCJnZXRTcGVlZFwiIG1ldGhvZFxuICogQHBhcmFtIHtib29sfSByZXBlYXRcbiAqIEBwYXJhbSB7bnVtYmVyfSBbdGltZT0xL2l0ZW0uZ2V0U3BlZWQoKV1cbiAqIEBzZWUgUk9ULlNjaGVkdWxlciNhZGRcbiAqL1xuUk9ULlNjaGVkdWxlci5TcGVlZC5wcm90b3R5cGUuYWRkID0gZnVuY3Rpb24oaXRlbSwgcmVwZWF0LCB0aW1lKSB7XG5cdHRoaXMuX3F1ZXVlLmFkZChpdGVtLCB0aW1lICE9PSB1bmRlZmluZWQgPyB0aW1lIDogMS9pdGVtLmdldFNwZWVkKCkpO1xuXHRyZXR1cm4gUk9ULlNjaGVkdWxlci5wcm90b3R5cGUuYWRkLmNhbGwodGhpcywgaXRlbSwgcmVwZWF0KTtcbn07XG5cbi8qKlxuICogQHNlZSBST1QuU2NoZWR1bGVyI25leHRcbiAqL1xuUk9ULlNjaGVkdWxlci5TcGVlZC5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uKCkge1xuXHRpZiAodGhpcy5fY3VycmVudCAmJiB0aGlzLl9yZXBlYXQuaW5kZXhPZih0aGlzLl9jdXJyZW50KSAhPSAtMSkge1xuXHRcdHRoaXMuX3F1ZXVlLmFkZCh0aGlzLl9jdXJyZW50LCAxL3RoaXMuX2N1cnJlbnQuZ2V0U3BlZWQoKSk7XG5cdH1cblx0cmV0dXJuIFJPVC5TY2hlZHVsZXIucHJvdG90eXBlLm5leHQuY2FsbCh0aGlzKTtcbn07XG4vKipcbiAqIEBjbGFzcyBBY3Rpb24tYmFzZWQgc2NoZWR1bGVyXG4gKiBAYXVnbWVudHMgUk9ULlNjaGVkdWxlclxuICovXG5ST1QuU2NoZWR1bGVyLkFjdGlvbiA9IGZ1bmN0aW9uKCkge1xuXHRST1QuU2NoZWR1bGVyLmNhbGwodGhpcyk7XG5cdHRoaXMuX2RlZmF1bHREdXJhdGlvbiA9IDE7IC8qIGZvciBuZXdseSBhZGRlZCAqL1xuXHR0aGlzLl9kdXJhdGlvbiA9IHRoaXMuX2RlZmF1bHREdXJhdGlvbjsgLyogZm9yIHRoaXMuX2N1cnJlbnQgKi9cbn07XG5ST1QuU2NoZWR1bGVyLkFjdGlvbi5leHRlbmQoUk9ULlNjaGVkdWxlcik7XG5cbi8qKlxuICogQHBhcmFtIHtvYmplY3R9IGl0ZW1cbiAqIEBwYXJhbSB7Ym9vbH0gcmVwZWF0XG4gKiBAcGFyYW0ge251bWJlcn0gW3RpbWU9MV1cbiAqIEBzZWUgUk9ULlNjaGVkdWxlciNhZGRcbiAqL1xuUk9ULlNjaGVkdWxlci5BY3Rpb24ucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uKGl0ZW0sIHJlcGVhdCwgdGltZSkge1xuXHR0aGlzLl9xdWV1ZS5hZGQoaXRlbSwgdGltZSB8fCB0aGlzLl9kZWZhdWx0RHVyYXRpb24pO1xuXHRyZXR1cm4gUk9ULlNjaGVkdWxlci5wcm90b3R5cGUuYWRkLmNhbGwodGhpcywgaXRlbSwgcmVwZWF0KTtcbn07XG5cblJPVC5TY2hlZHVsZXIuQWN0aW9uLnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uKCkge1xuXHR0aGlzLl9kdXJhdGlvbiA9IHRoaXMuX2RlZmF1bHREdXJhdGlvbjtcblx0cmV0dXJuIFJPVC5TY2hlZHVsZXIucHJvdG90eXBlLmNsZWFyLmNhbGwodGhpcyk7XG59O1xuXG5ST1QuU2NoZWR1bGVyLkFjdGlvbi5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24oaXRlbSkge1xuXHRpZiAoaXRlbSA9PSB0aGlzLl9jdXJyZW50KSB7IHRoaXMuX2R1cmF0aW9uID0gdGhpcy5fZGVmYXVsdER1cmF0aW9uOyB9XG5cdHJldHVybiBST1QuU2NoZWR1bGVyLnByb3RvdHlwZS5yZW1vdmUuY2FsbCh0aGlzLCBpdGVtKTtcbn07XG5cbi8qKlxuICogQHNlZSBST1QuU2NoZWR1bGVyI25leHRcbiAqL1xuUk9ULlNjaGVkdWxlci5BY3Rpb24ucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbigpIHtcblx0aWYgKHRoaXMuX2N1cnJlbnQgJiYgdGhpcy5fcmVwZWF0LmluZGV4T2YodGhpcy5fY3VycmVudCkgIT0gLTEpIHtcblx0XHR0aGlzLl9xdWV1ZS5hZGQodGhpcy5fY3VycmVudCwgdGhpcy5fZHVyYXRpb24gfHwgdGhpcy5fZGVmYXVsdER1cmF0aW9uKTtcblx0XHR0aGlzLl9kdXJhdGlvbiA9IHRoaXMuX2RlZmF1bHREdXJhdGlvbjtcblx0fVxuXHRyZXR1cm4gUk9ULlNjaGVkdWxlci5wcm90b3R5cGUubmV4dC5jYWxsKHRoaXMpO1xufTtcblxuLyoqXG4gKiBTZXQgZHVyYXRpb24gZm9yIHRoZSBhY3RpdmUgaXRlbVxuICovXG5ST1QuU2NoZWR1bGVyLkFjdGlvbi5wcm90b3R5cGUuc2V0RHVyYXRpb24gPSBmdW5jdGlvbih0aW1lKSB7XG5cdGlmICh0aGlzLl9jdXJyZW50KSB7IHRoaXMuX2R1cmF0aW9uID0gdGltZTsgfVxuXHRyZXR1cm4gdGhpcztcbn07XG4vKipcbiAqIEBjbGFzcyBBc3luY2hyb25vdXMgbWFpbiBsb29wXG4gKiBAcGFyYW0ge1JPVC5TY2hlZHVsZXJ9IHNjaGVkdWxlclxuICovXG5ST1QuRW5naW5lID0gZnVuY3Rpb24oc2NoZWR1bGVyKSB7XG5cdHRoaXMuX3NjaGVkdWxlciA9IHNjaGVkdWxlcjtcblx0dGhpcy5fbG9jayA9IDE7XG59O1xuXG4vKipcbiAqIFN0YXJ0IHRoZSBtYWluIGxvb3AuIFdoZW4gdGhpcyBjYWxsIHJldHVybnMsIHRoZSBsb29wIGlzIGxvY2tlZC5cbiAqL1xuUk9ULkVuZ2luZS5wcm90b3R5cGUuc3RhcnQgPSBmdW5jdGlvbigpIHtcblx0cmV0dXJuIHRoaXMudW5sb2NrKCk7XG59O1xuXG4vKipcbiAqIEludGVycnVwdCB0aGUgZW5naW5lIGJ5IGFuIGFzeW5jaHJvbm91cyBhY3Rpb25cbiAqL1xuUk9ULkVuZ2luZS5wcm90b3R5cGUubG9jayA9IGZ1bmN0aW9uKCkge1xuXHR0aGlzLl9sb2NrKys7XG5cdHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBSZXN1bWUgZXhlY3V0aW9uIChwYXVzZWQgYnkgYSBwcmV2aW91cyBsb2NrKVxuICovXG5ST1QuRW5naW5lLnByb3RvdHlwZS51bmxvY2sgPSBmdW5jdGlvbigpIHtcblx0aWYgKCF0aGlzLl9sb2NrKSB7IHRocm93IG5ldyBFcnJvcihcIkNhbm5vdCB1bmxvY2sgdW5sb2NrZWQgZW5naW5lXCIpOyB9XG5cdHRoaXMuX2xvY2stLTtcblxuXHR3aGlsZSAoIXRoaXMuX2xvY2spIHtcblx0XHR2YXIgYWN0b3IgPSB0aGlzLl9zY2hlZHVsZXIubmV4dCgpO1xuXHRcdGlmICghYWN0b3IpIHsgcmV0dXJuIHRoaXMubG9jaygpOyB9IC8qIG5vIGFjdG9ycyAqL1xuXHRcdHZhciByZXN1bHQgPSBhY3Rvci5hY3QoKTtcblx0XHRpZiAocmVzdWx0ICYmIHJlc3VsdC50aGVuKSB7IC8qIGFjdG9yIHJldHVybmVkIGEgXCJ0aGVuYWJsZVwiLCBsb29rcyBsaWtlIGEgUHJvbWlzZSAqL1xuXHRcdFx0dGhpcy5sb2NrKCk7XG5cdFx0XHRyZXN1bHQudGhlbih0aGlzLnVubG9jay5iaW5kKHRoaXMpKTtcblx0XHR9XG5cdH1cblxuXHRyZXR1cm4gdGhpcztcbn07XG4vKipcbiAqIEBjbGFzcyBCYXNlIG1hcCBnZW5lcmF0b3JcbiAqIEBwYXJhbSB7aW50fSBbd2lkdGg9Uk9ULkRFRkFVTFRfV0lEVEhdXG4gKiBAcGFyYW0ge2ludH0gW2hlaWdodD1ST1QuREVGQVVMVF9IRUlHSFRdXG4gKi9cblJPVC5NYXAgPSBmdW5jdGlvbih3aWR0aCwgaGVpZ2h0KSB7XG5cdHRoaXMuX3dpZHRoID0gd2lkdGggfHwgUk9ULkRFRkFVTFRfV0lEVEg7XG5cdHRoaXMuX2hlaWdodCA9IGhlaWdodCB8fCBST1QuREVGQVVMVF9IRUlHSFQ7XG59O1xuXG5ST1QuTWFwLnByb3RvdHlwZS5jcmVhdGUgPSBmdW5jdGlvbihjYWxsYmFjaykge307XG5cblJPVC5NYXAucHJvdG90eXBlLl9maWxsTWFwID0gZnVuY3Rpb24odmFsdWUpIHtcblx0dmFyIG1hcCA9IFtdO1xuXHRmb3IgKHZhciBpPTA7aTx0aGlzLl93aWR0aDtpKyspIHtcblx0XHRtYXAucHVzaChbXSk7XG5cdFx0Zm9yICh2YXIgaj0wO2o8dGhpcy5faGVpZ2h0O2orKykgeyBtYXBbaV0ucHVzaCh2YWx1ZSk7IH1cblx0fVxuXHRyZXR1cm4gbWFwO1xufTtcbi8qKlxuICogQGNsYXNzIFNpbXBsZSBlbXB0eSByZWN0YW5ndWxhciByb29tXG4gKiBAYXVnbWVudHMgUk9ULk1hcFxuICovXG5ST1QuTWFwLkFyZW5hID0gZnVuY3Rpb24od2lkdGgsIGhlaWdodCkge1xuXHRST1QuTWFwLmNhbGwodGhpcywgd2lkdGgsIGhlaWdodCk7XG59O1xuUk9ULk1hcC5BcmVuYS5leHRlbmQoUk9ULk1hcCk7XG5cblJPVC5NYXAuQXJlbmEucHJvdG90eXBlLmNyZWF0ZSA9IGZ1bmN0aW9uKGNhbGxiYWNrKSB7XG5cdHZhciB3ID0gdGhpcy5fd2lkdGgtMTtcblx0dmFyIGggPSB0aGlzLl9oZWlnaHQtMTtcblx0Zm9yICh2YXIgaT0wO2k8PXc7aSsrKSB7XG5cdFx0Zm9yICh2YXIgaj0wO2o8PWg7aisrKSB7XG5cdFx0XHR2YXIgZW1wdHkgPSAoaSAmJiBqICYmIGk8dyAmJiBqPGgpO1xuXHRcdFx0Y2FsbGJhY2soaSwgaiwgZW1wdHkgPyAwIDogMSk7XG5cdFx0fVxuXHR9XG5cdHJldHVybiB0aGlzO1xufTtcbi8qKlxuICogQGNsYXNzIFJlY3Vyc2l2ZWx5IGRpdmlkZWQgbWF6ZSwgaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9NYXplX2dlbmVyYXRpb25fYWxnb3JpdGhtI1JlY3Vyc2l2ZV9kaXZpc2lvbl9tZXRob2RcbiAqIEBhdWdtZW50cyBST1QuTWFwXG4gKi9cblJPVC5NYXAuRGl2aWRlZE1hemUgPSBmdW5jdGlvbih3aWR0aCwgaGVpZ2h0KSB7XG5cdFJPVC5NYXAuY2FsbCh0aGlzLCB3aWR0aCwgaGVpZ2h0KTtcblx0dGhpcy5fc3RhY2sgPSBbXTtcbn07XG5ST1QuTWFwLkRpdmlkZWRNYXplLmV4dGVuZChST1QuTWFwKTtcblxuUk9ULk1hcC5EaXZpZGVkTWF6ZS5wcm90b3R5cGUuY3JlYXRlID0gZnVuY3Rpb24oY2FsbGJhY2spIHtcblx0dmFyIHcgPSB0aGlzLl93aWR0aDtcblx0dmFyIGggPSB0aGlzLl9oZWlnaHQ7XG5cdFxuXHR0aGlzLl9tYXAgPSBbXTtcblx0XG5cdGZvciAodmFyIGk9MDtpPHc7aSsrKSB7XG5cdFx0dGhpcy5fbWFwLnB1c2goW10pO1xuXHRcdGZvciAodmFyIGo9MDtqPGg7aisrKSB7XG5cdFx0XHR2YXIgYm9yZGVyID0gKGkgPT0gMCB8fCBqID09IDAgfHwgaSsxID09IHcgfHwgaisxID09IGgpO1xuXHRcdFx0dGhpcy5fbWFwW2ldLnB1c2goYm9yZGVyID8gMSA6IDApO1xuXHRcdH1cblx0fVxuXHRcblx0dGhpcy5fc3RhY2sgPSBbXG5cdFx0WzEsIDEsIHctMiwgaC0yXVxuXHRdO1xuXHR0aGlzLl9wcm9jZXNzKCk7XG5cdFxuXHRmb3IgKHZhciBpPTA7aTx3O2krKykge1xuXHRcdGZvciAodmFyIGo9MDtqPGg7aisrKSB7XG5cdFx0XHRjYWxsYmFjayhpLCBqLCB0aGlzLl9tYXBbaV1bal0pO1xuXHRcdH1cblx0fVxuXHR0aGlzLl9tYXAgPSBudWxsO1xuXHRyZXR1cm4gdGhpcztcbn07XG5cblJPVC5NYXAuRGl2aWRlZE1hemUucHJvdG90eXBlLl9wcm9jZXNzID0gZnVuY3Rpb24oKSB7XG5cdHdoaWxlICh0aGlzLl9zdGFjay5sZW5ndGgpIHtcblx0XHR2YXIgcm9vbSA9IHRoaXMuX3N0YWNrLnNoaWZ0KCk7IC8qIFtsZWZ0LCB0b3AsIHJpZ2h0LCBib3R0b21dICovXG5cdFx0dGhpcy5fcGFydGl0aW9uUm9vbShyb29tKTtcblx0fVxufTtcblxuUk9ULk1hcC5EaXZpZGVkTWF6ZS5wcm90b3R5cGUuX3BhcnRpdGlvblJvb20gPSBmdW5jdGlvbihyb29tKSB7XG5cdHZhciBhdmFpbFggPSBbXTtcblx0dmFyIGF2YWlsWSA9IFtdO1xuXHRcblx0Zm9yICh2YXIgaT1yb29tWzBdKzE7aTxyb29tWzJdO2krKykge1xuXHRcdHZhciB0b3AgPSB0aGlzLl9tYXBbaV1bcm9vbVsxXS0xXTtcblx0XHR2YXIgYm90dG9tID0gdGhpcy5fbWFwW2ldW3Jvb21bM10rMV07XG5cdFx0aWYgKHRvcCAmJiBib3R0b20gJiYgIShpICUgMikpIHsgYXZhaWxYLnB1c2goaSk7IH1cblx0fVxuXHRcblx0Zm9yICh2YXIgaj1yb29tWzFdKzE7ajxyb29tWzNdO2orKykge1xuXHRcdHZhciBsZWZ0ID0gdGhpcy5fbWFwW3Jvb21bMF0tMV1bal07XG5cdFx0dmFyIHJpZ2h0ID0gdGhpcy5fbWFwW3Jvb21bMl0rMV1bal07XG5cdFx0aWYgKGxlZnQgJiYgcmlnaHQgJiYgIShqICUgMikpIHsgYXZhaWxZLnB1c2goaik7IH1cblx0fVxuXG5cdGlmICghYXZhaWxYLmxlbmd0aCB8fCAhYXZhaWxZLmxlbmd0aCkgeyByZXR1cm47IH1cblxuXHR2YXIgeCA9IGF2YWlsWC5yYW5kb20oKTtcblx0dmFyIHkgPSBhdmFpbFkucmFuZG9tKCk7XG5cdFxuXHR0aGlzLl9tYXBbeF1beV0gPSAxO1xuXHRcblx0dmFyIHdhbGxzID0gW107XG5cdFxuXHR2YXIgdyA9IFtdOyB3YWxscy5wdXNoKHcpOyAvKiBsZWZ0IHBhcnQgKi9cblx0Zm9yICh2YXIgaT1yb29tWzBdOyBpPHg7IGkrKykgeyBcblx0XHR0aGlzLl9tYXBbaV1beV0gPSAxO1xuXHRcdHcucHVzaChbaSwgeV0pOyBcblx0fVxuXHRcblx0dmFyIHcgPSBbXTsgd2FsbHMucHVzaCh3KTsgLyogcmlnaHQgcGFydCAqL1xuXHRmb3IgKHZhciBpPXgrMTsgaTw9cm9vbVsyXTsgaSsrKSB7IFxuXHRcdHRoaXMuX21hcFtpXVt5XSA9IDE7XG5cdFx0dy5wdXNoKFtpLCB5XSk7IFxuXHR9XG5cblx0dmFyIHcgPSBbXTsgd2FsbHMucHVzaCh3KTsgLyogdG9wIHBhcnQgKi9cblx0Zm9yICh2YXIgaj1yb29tWzFdOyBqPHk7IGorKykgeyBcblx0XHR0aGlzLl9tYXBbeF1bal0gPSAxO1xuXHRcdHcucHVzaChbeCwgal0pOyBcblx0fVxuXHRcblx0dmFyIHcgPSBbXTsgd2FsbHMucHVzaCh3KTsgLyogYm90dG9tIHBhcnQgKi9cblx0Zm9yICh2YXIgaj15KzE7IGo8PXJvb21bM107IGorKykgeyBcblx0XHR0aGlzLl9tYXBbeF1bal0gPSAxO1xuXHRcdHcucHVzaChbeCwgal0pOyBcblx0fVxuXHRcdFxuXHR2YXIgc29saWQgPSB3YWxscy5yYW5kb20oKTtcblx0Zm9yICh2YXIgaT0wO2k8d2FsbHMubGVuZ3RoO2krKykge1xuXHRcdHZhciB3ID0gd2FsbHNbaV07XG5cdFx0aWYgKHcgPT0gc29saWQpIHsgY29udGludWU7IH1cblx0XHRcblx0XHR2YXIgaG9sZSA9IHcucmFuZG9tKCk7XG5cdFx0dGhpcy5fbWFwW2hvbGVbMF1dW2hvbGVbMV1dID0gMDtcblx0fVxuXG5cdHRoaXMuX3N0YWNrLnB1c2goW3Jvb21bMF0sIHJvb21bMV0sIHgtMSwgeS0xXSk7IC8qIGxlZnQgdG9wICovXG5cdHRoaXMuX3N0YWNrLnB1c2goW3grMSwgcm9vbVsxXSwgcm9vbVsyXSwgeS0xXSk7IC8qIHJpZ2h0IHRvcCAqL1xuXHR0aGlzLl9zdGFjay5wdXNoKFtyb29tWzBdLCB5KzEsIHgtMSwgcm9vbVszXV0pOyAvKiBsZWZ0IGJvdHRvbSAqL1xuXHR0aGlzLl9zdGFjay5wdXNoKFt4KzEsIHkrMSwgcm9vbVsyXSwgcm9vbVszXV0pOyAvKiByaWdodCBib3R0b20gKi9cbn07XG4vKipcbiAqIEBjbGFzcyBJY2V5J3MgTWF6ZSBnZW5lcmF0b3JcbiAqIFNlZSBodHRwOi8vd3d3LnJvZ3VlYmFzaW4ucm9ndWVsaWtlZGV2ZWxvcG1lbnQub3JnL2luZGV4LnBocD90aXRsZT1TaW1wbGVfbWF6ZSBmb3IgZXhwbGFuYXRpb25cbiAqIEBhdWdtZW50cyBST1QuTWFwXG4gKi9cblJPVC5NYXAuSWNleU1hemUgPSBmdW5jdGlvbih3aWR0aCwgaGVpZ2h0LCByZWd1bGFyaXR5KSB7XG5cdFJPVC5NYXAuY2FsbCh0aGlzLCB3aWR0aCwgaGVpZ2h0KTtcblx0dGhpcy5fcmVndWxhcml0eSA9IHJlZ3VsYXJpdHkgfHwgMDtcbn07XG5ST1QuTWFwLkljZXlNYXplLmV4dGVuZChST1QuTWFwKTtcblxuUk9ULk1hcC5JY2V5TWF6ZS5wcm90b3R5cGUuY3JlYXRlID0gZnVuY3Rpb24oY2FsbGJhY2spIHtcblx0dmFyIHdpZHRoID0gdGhpcy5fd2lkdGg7XG5cdHZhciBoZWlnaHQgPSB0aGlzLl9oZWlnaHQ7XG5cdFxuXHR2YXIgbWFwID0gdGhpcy5fZmlsbE1hcCgxKTtcblx0XG5cdHdpZHRoIC09ICh3aWR0aCAlIDIgPyAxIDogMik7XG5cdGhlaWdodCAtPSAoaGVpZ2h0ICUgMiA/IDEgOiAyKTtcblxuXHR2YXIgY3ggPSAwO1xuXHR2YXIgY3kgPSAwO1xuXHR2YXIgbnggPSAwO1xuXHR2YXIgbnkgPSAwO1xuXG5cdHZhciBkb25lID0gMDtcblx0dmFyIGJsb2NrZWQgPSBmYWxzZTtcblx0dmFyIGRpcnMgPSBbXG5cdFx0WzAsIDBdLFxuXHRcdFswLCAwXSxcblx0XHRbMCwgMF0sXG5cdFx0WzAsIDBdXG5cdF07XG5cdGRvIHtcblx0XHRjeCA9IDEgKyAyKk1hdGguZmxvb3IoUk9ULlJORy5nZXRVbmlmb3JtKCkqKHdpZHRoLTEpIC8gMik7XG5cdFx0Y3kgPSAxICsgMipNYXRoLmZsb29yKFJPVC5STkcuZ2V0VW5pZm9ybSgpKihoZWlnaHQtMSkgLyAyKTtcblxuXHRcdGlmICghZG9uZSkgeyBtYXBbY3hdW2N5XSA9IDA7IH1cblx0XHRcblx0XHRpZiAoIW1hcFtjeF1bY3ldKSB7XG5cdFx0XHR0aGlzLl9yYW5kb21pemUoZGlycyk7XG5cdFx0XHRkbyB7XG5cdFx0XHRcdGlmIChNYXRoLmZsb29yKFJPVC5STkcuZ2V0VW5pZm9ybSgpKih0aGlzLl9yZWd1bGFyaXR5KzEpKSA9PSAwKSB7IHRoaXMuX3JhbmRvbWl6ZShkaXJzKTsgfVxuXHRcdFx0XHRibG9ja2VkID0gdHJ1ZTtcblx0XHRcdFx0Zm9yICh2YXIgaT0wO2k8NDtpKyspIHtcblx0XHRcdFx0XHRueCA9IGN4ICsgZGlyc1tpXVswXSoyO1xuXHRcdFx0XHRcdG55ID0gY3kgKyBkaXJzW2ldWzFdKjI7XG5cdFx0XHRcdFx0aWYgKHRoaXMuX2lzRnJlZShtYXAsIG54LCBueSwgd2lkdGgsIGhlaWdodCkpIHtcblx0XHRcdFx0XHRcdG1hcFtueF1bbnldID0gMDtcblx0XHRcdFx0XHRcdG1hcFtjeCArIGRpcnNbaV1bMF1dW2N5ICsgZGlyc1tpXVsxXV0gPSAwO1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRjeCA9IG54O1xuXHRcdFx0XHRcdFx0Y3kgPSBueTtcblx0XHRcdFx0XHRcdGJsb2NrZWQgPSBmYWxzZTtcblx0XHRcdFx0XHRcdGRvbmUrKztcblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fSB3aGlsZSAoIWJsb2NrZWQpO1xuXHRcdH1cblx0fSB3aGlsZSAoZG9uZSsxIDwgd2lkdGgqaGVpZ2h0LzQpO1xuXHRcblx0Zm9yICh2YXIgaT0wO2k8dGhpcy5fd2lkdGg7aSsrKSB7XG5cdFx0Zm9yICh2YXIgaj0wO2o8dGhpcy5faGVpZ2h0O2orKykge1xuXHRcdFx0Y2FsbGJhY2soaSwgaiwgbWFwW2ldW2pdKTtcblx0XHR9XG5cdH1cblx0dGhpcy5fbWFwID0gbnVsbDtcblx0cmV0dXJuIHRoaXM7XG59O1xuXG5ST1QuTWFwLkljZXlNYXplLnByb3RvdHlwZS5fcmFuZG9taXplID0gZnVuY3Rpb24oZGlycykge1xuXHRmb3IgKHZhciBpPTA7aTw0O2krKykge1xuXHRcdGRpcnNbaV1bMF0gPSAwO1xuXHRcdGRpcnNbaV1bMV0gPSAwO1xuXHR9XG5cdFxuXHRzd2l0Y2ggKE1hdGguZmxvb3IoUk9ULlJORy5nZXRVbmlmb3JtKCkqNCkpIHtcblx0XHRjYXNlIDA6XG5cdFx0XHRkaXJzWzBdWzBdID0gLTE7IGRpcnNbMV1bMF0gPSAxO1xuXHRcdFx0ZGlyc1syXVsxXSA9IC0xOyBkaXJzWzNdWzFdID0gMTtcblx0XHRicmVhaztcblx0XHRjYXNlIDE6XG5cdFx0XHRkaXJzWzNdWzBdID0gLTE7IGRpcnNbMl1bMF0gPSAxO1xuXHRcdFx0ZGlyc1sxXVsxXSA9IC0xOyBkaXJzWzBdWzFdID0gMTtcblx0XHRicmVhaztcblx0XHRjYXNlIDI6XG5cdFx0XHRkaXJzWzJdWzBdID0gLTE7IGRpcnNbM11bMF0gPSAxO1xuXHRcdFx0ZGlyc1swXVsxXSA9IC0xOyBkaXJzWzFdWzFdID0gMTtcblx0XHRicmVhaztcblx0XHRjYXNlIDM6XG5cdFx0XHRkaXJzWzFdWzBdID0gLTE7IGRpcnNbMF1bMF0gPSAxO1xuXHRcdFx0ZGlyc1szXVsxXSA9IC0xOyBkaXJzWzJdWzFdID0gMTtcblx0XHRicmVhaztcblx0fVxufTtcblxuUk9ULk1hcC5JY2V5TWF6ZS5wcm90b3R5cGUuX2lzRnJlZSA9IGZ1bmN0aW9uKG1hcCwgeCwgeSwgd2lkdGgsIGhlaWdodCkge1xuXHRpZiAoeCA8IDEgfHwgeSA8IDEgfHwgeCA+PSB3aWR0aCB8fCB5ID49IGhlaWdodCkgeyByZXR1cm4gZmFsc2U7IH1cblx0cmV0dXJuIG1hcFt4XVt5XTtcbn07XG4vKipcbiAqIEBjbGFzcyBNYXplIGdlbmVyYXRvciAtIEVsbGVyJ3MgYWxnb3JpdGhtXG4gKiBTZWUgaHR0cDovL2hvbWVwYWdlcy5jd2kubmwvfnRyb21wL21hemUuaHRtbCBmb3IgZXhwbGFuYXRpb25cbiAqIEBhdWdtZW50cyBST1QuTWFwXG4gKi9cblJPVC5NYXAuRWxsZXJNYXplID0gZnVuY3Rpb24od2lkdGgsIGhlaWdodCkge1xuXHRST1QuTWFwLmNhbGwodGhpcywgd2lkdGgsIGhlaWdodCk7XG59O1xuUk9ULk1hcC5FbGxlck1hemUuZXh0ZW5kKFJPVC5NYXApO1xuXG5ST1QuTWFwLkVsbGVyTWF6ZS5wcm90b3R5cGUuY3JlYXRlID0gZnVuY3Rpb24oY2FsbGJhY2spIHtcblx0dmFyIG1hcCA9IHRoaXMuX2ZpbGxNYXAoMSk7XG5cdHZhciB3ID0gTWF0aC5jZWlsKCh0aGlzLl93aWR0aC0yKS8yKTtcblx0XG5cdHZhciByYW5kID0gOS8yNDtcblx0XG5cdHZhciBMID0gW107XG5cdHZhciBSID0gW107XG5cdFxuXHRmb3IgKHZhciBpPTA7aTx3O2krKykge1xuXHRcdEwucHVzaChpKTtcblx0XHRSLnB1c2goaSk7XG5cdH1cblx0TC5wdXNoKHctMSk7IC8qIGZha2Ugc3RvcC1ibG9jayBhdCB0aGUgcmlnaHQgc2lkZSAqL1xuXG5cdGZvciAodmFyIGo9MTtqKzM8dGhpcy5faGVpZ2h0O2orPTIpIHtcblx0XHQvKiBvbmUgcm93ICovXG5cdFx0Zm9yICh2YXIgaT0wO2k8dztpKyspIHtcblx0XHRcdC8qIGNlbGwgY29vcmRzICh3aWxsIGJlIGFsd2F5cyBlbXB0eSkgKi9cblx0XHRcdHZhciB4ID0gMippKzE7XG5cdFx0XHR2YXIgeSA9IGo7XG5cdFx0XHRtYXBbeF1beV0gPSAwO1xuXHRcdFx0XG5cdFx0XHQvKiByaWdodCBjb25uZWN0aW9uICovXG5cdFx0XHRpZiAoaSAhPSBMW2krMV0gJiYgUk9ULlJORy5nZXRVbmlmb3JtKCkgPiByYW5kKSB7XG5cdFx0XHRcdHRoaXMuX2FkZFRvTGlzdChpLCBMLCBSKTtcblx0XHRcdFx0bWFwW3grMV1beV0gPSAwO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHQvKiBib3R0b20gY29ubmVjdGlvbiAqL1xuXHRcdFx0aWYgKGkgIT0gTFtpXSAmJiBST1QuUk5HLmdldFVuaWZvcm0oKSA+IHJhbmQpIHtcblx0XHRcdFx0LyogcmVtb3ZlIGNvbm5lY3Rpb24gKi9cblx0XHRcdFx0dGhpcy5fcmVtb3ZlRnJvbUxpc3QoaSwgTCwgUik7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQvKiBjcmVhdGUgY29ubmVjdGlvbiAqL1xuXHRcdFx0XHRtYXBbeF1beSsxXSA9IDA7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0LyogbGFzdCByb3cgKi9cblx0Zm9yICh2YXIgaT0wO2k8dztpKyspIHtcblx0XHQvKiBjZWxsIGNvb3JkcyAod2lsbCBiZSBhbHdheXMgZW1wdHkpICovXG5cdFx0dmFyIHggPSAyKmkrMTtcblx0XHR2YXIgeSA9IGo7XG5cdFx0bWFwW3hdW3ldID0gMDtcblx0XHRcblx0XHQvKiByaWdodCBjb25uZWN0aW9uICovXG5cdFx0aWYgKGkgIT0gTFtpKzFdICYmIChpID09IExbaV0gfHwgUk9ULlJORy5nZXRVbmlmb3JtKCkgPiByYW5kKSkge1xuXHRcdFx0LyogZGlnIHJpZ2h0IGFsc28gaWYgdGhlIGNlbGwgaXMgc2VwYXJhdGVkLCBzbyBpdCBnZXRzIGNvbm5lY3RlZCB0byB0aGUgcmVzdCBvZiBtYXplICovXG5cdFx0XHR0aGlzLl9hZGRUb0xpc3QoaSwgTCwgUik7XG5cdFx0XHRtYXBbeCsxXVt5XSA9IDA7XG5cdFx0fVxuXHRcdFxuXHRcdHRoaXMuX3JlbW92ZUZyb21MaXN0KGksIEwsIFIpO1xuXHR9XG5cdFxuXHRmb3IgKHZhciBpPTA7aTx0aGlzLl93aWR0aDtpKyspIHtcblx0XHRmb3IgKHZhciBqPTA7ajx0aGlzLl9oZWlnaHQ7aisrKSB7XG5cdFx0XHRjYWxsYmFjayhpLCBqLCBtYXBbaV1bal0pO1xuXHRcdH1cblx0fVxuXHRcblx0cmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIFJlbW92ZSBcImlcIiBmcm9tIGl0cyBsaXN0XG4gKi9cblJPVC5NYXAuRWxsZXJNYXplLnByb3RvdHlwZS5fcmVtb3ZlRnJvbUxpc3QgPSBmdW5jdGlvbihpLCBMLCBSKSB7XG5cdFJbTFtpXV0gPSBSW2ldO1xuXHRMW1JbaV1dID0gTFtpXTtcblx0UltpXSA9IGk7XG5cdExbaV0gPSBpO1xufTtcblxuLyoqXG4gKiBKb2luIGxpc3RzIHdpdGggXCJpXCIgYW5kIFwiaSsxXCJcbiAqL1xuUk9ULk1hcC5FbGxlck1hemUucHJvdG90eXBlLl9hZGRUb0xpc3QgPSBmdW5jdGlvbihpLCBMLCBSKSB7XG5cdFJbTFtpKzFdXSA9IFJbaV07XG5cdExbUltpXV0gPSBMW2krMV07XG5cdFJbaV0gPSBpKzE7XG5cdExbaSsxXSA9IGk7XG59O1xuLyoqXG4gKiBAY2xhc3MgQ2VsbHVsYXIgYXV0b21hdG9uIG1hcCBnZW5lcmF0b3JcbiAqIEBhdWdtZW50cyBST1QuTWFwXG4gKiBAcGFyYW0ge2ludH0gW3dpZHRoPVJPVC5ERUZBVUxUX1dJRFRIXVxuICogQHBhcmFtIHtpbnR9IFtoZWlnaHQ9Uk9ULkRFRkFVTFRfSEVJR0hUXVxuICogQHBhcmFtIHtvYmplY3R9IFtvcHRpb25zXSBPcHRpb25zXG4gKiBAcGFyYW0ge2ludFtdfSBbb3B0aW9ucy5ib3JuXSBMaXN0IG9mIG5laWdoYm9yIGNvdW50cyBmb3IgYSBuZXcgY2VsbCB0byBiZSBib3JuIGluIGVtcHR5IHNwYWNlXG4gKiBAcGFyYW0ge2ludFtdfSBbb3B0aW9ucy5zdXJ2aXZlXSBMaXN0IG9mIG5laWdoYm9yIGNvdW50cyBmb3IgYW4gZXhpc3RpbmcgIGNlbGwgdG8gc3Vydml2ZVxuICogQHBhcmFtIHtpbnR9IFtvcHRpb25zLnRvcG9sb2d5XSBUb3BvbG9neSA0IG9yIDYgb3IgOFxuICovXG5ST1QuTWFwLkNlbGx1bGFyID0gZnVuY3Rpb24od2lkdGgsIGhlaWdodCwgb3B0aW9ucykge1xuXHRST1QuTWFwLmNhbGwodGhpcywgd2lkdGgsIGhlaWdodCk7XG5cdHRoaXMuX29wdGlvbnMgPSB7XG5cdFx0Ym9ybjogWzUsIDYsIDcsIDhdLFxuXHRcdHN1cnZpdmU6IFs0LCA1LCA2LCA3LCA4XSxcblx0XHR0b3BvbG9neTogOFxuXHR9O1xuXHR0aGlzLnNldE9wdGlvbnMob3B0aW9ucyk7XG5cblx0dGhpcy5fZGlycyA9IFJPVC5ESVJTW3RoaXMuX29wdGlvbnMudG9wb2xvZ3ldO1xuXHR0aGlzLl9tYXAgPSB0aGlzLl9maWxsTWFwKDApO1xufTtcblJPVC5NYXAuQ2VsbHVsYXIuZXh0ZW5kKFJPVC5NYXApO1xuXG4vKipcbiAqIEZpbGwgdGhlIG1hcCB3aXRoIHJhbmRvbSB2YWx1ZXNcbiAqIEBwYXJhbSB7ZmxvYXR9IHByb2JhYmlsaXR5IFByb2JhYmlsaXR5IGZvciBhIGNlbGwgdG8gYmVjb21lIGFsaXZlOyAwID0gYWxsIGVtcHR5LCAxID0gYWxsIGZ1bGxcbiAqL1xuUk9ULk1hcC5DZWxsdWxhci5wcm90b3R5cGUucmFuZG9taXplID0gZnVuY3Rpb24ocHJvYmFiaWxpdHkpIHtcblx0Zm9yICh2YXIgaT0wO2k8dGhpcy5fd2lkdGg7aSsrKSB7XG5cdFx0Zm9yICh2YXIgaj0wO2o8dGhpcy5faGVpZ2h0O2orKykge1xuXHRcdFx0dGhpcy5fbWFwW2ldW2pdID0gKFJPVC5STkcuZ2V0VW5pZm9ybSgpIDwgcHJvYmFiaWxpdHkgPyAxIDogMCk7XG5cdFx0fVxuXHR9XG5cdHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBDaGFuZ2Ugb3B0aW9ucy5cbiAqIEBzZWUgUk9ULk1hcC5DZWxsdWxhclxuICovXG5ST1QuTWFwLkNlbGx1bGFyLnByb3RvdHlwZS5zZXRPcHRpb25zID0gZnVuY3Rpb24ob3B0aW9ucykge1xuXHRmb3IgKHZhciBwIGluIG9wdGlvbnMpIHsgdGhpcy5fb3B0aW9uc1twXSA9IG9wdGlvbnNbcF07IH1cbn07XG5cblJPVC5NYXAuQ2VsbHVsYXIucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uKHgsIHksIHZhbHVlKSB7XG5cdHRoaXMuX21hcFt4XVt5XSA9IHZhbHVlO1xufTtcblxuUk9ULk1hcC5DZWxsdWxhci5wcm90b3R5cGUuY3JlYXRlID0gZnVuY3Rpb24oY2FsbGJhY2spIHtcblx0dmFyIG5ld01hcCA9IHRoaXMuX2ZpbGxNYXAoMCk7XG5cdHZhciBib3JuID0gdGhpcy5fb3B0aW9ucy5ib3JuO1xuXHR2YXIgc3Vydml2ZSA9IHRoaXMuX29wdGlvbnMuc3Vydml2ZTtcblxuXG5cdGZvciAodmFyIGo9MDtqPHRoaXMuX2hlaWdodDtqKyspIHtcblx0XHR2YXIgd2lkdGhTdGVwID0gMTtcblx0XHR2YXIgd2lkdGhTdGFydCA9IDA7XG5cdFx0aWYgKHRoaXMuX29wdGlvbnMudG9wb2xvZ3kgPT0gNikge1xuXHRcdFx0d2lkdGhTdGVwID0gMjtcblx0XHRcdHdpZHRoU3RhcnQgPSBqJTI7XG5cdFx0fVxuXG5cdFx0Zm9yICh2YXIgaT13aWR0aFN0YXJ0OyBpPHRoaXMuX3dpZHRoOyBpKz13aWR0aFN0ZXApIHtcblx0XHRcdHZhciBjdXIgPSB0aGlzLl9tYXBbaV1bal07XG5cdFx0XHR2YXIgbmNvdW50ID0gdGhpcy5fZ2V0TmVpZ2hib3JzKGksIGopO1xuXG5cdFx0XHRpZiAoY3VyICYmIHN1cnZpdmUuaW5kZXhPZihuY291bnQpICE9IC0xKSB7IC8qIHN1cnZpdmUgKi9cblx0XHRcdFx0bmV3TWFwW2ldW2pdID0gMTtcblx0XHRcdH0gZWxzZSBpZiAoIWN1ciAmJiBib3JuLmluZGV4T2YobmNvdW50KSAhPSAtMSkgeyAvKiBib3JuICovXG5cdFx0XHRcdG5ld01hcFtpXVtqXSA9IDE7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0dGhpcy5fbWFwID0gbmV3TWFwO1xuXHRjYWxsYmFjayAmJiB0aGlzLl9zZXJ2aWNlQ2FsbGJhY2soY2FsbGJhY2spO1xufTtcblxuUk9ULk1hcC5DZWxsdWxhci5wcm90b3R5cGUuX3NlcnZpY2VDYWxsYmFjayA9IGZ1bmN0aW9uKGNhbGxiYWNrKSB7XG5cdGZvciAodmFyIGo9MDtqPHRoaXMuX2hlaWdodDtqKyspIHtcblx0XHR2YXIgd2lkdGhTdGVwID0gMTtcblx0XHR2YXIgd2lkdGhTdGFydCA9IDA7XG5cdFx0aWYgKHRoaXMuX29wdGlvbnMudG9wb2xvZ3kgPT0gNikge1xuXHRcdFx0d2lkdGhTdGVwID0gMjtcblx0XHRcdHdpZHRoU3RhcnQgPSBqJTI7XG5cdFx0fVxuXHRcdGZvciAodmFyIGk9d2lkdGhTdGFydDsgaTx0aGlzLl93aWR0aDsgaSs9d2lkdGhTdGVwKSB7XG5cdFx0XHRjYWxsYmFjayhpLCBqLCB0aGlzLl9tYXBbaV1bal0pO1xuXHRcdH1cblx0fVxufTtcblxuLyoqXG4gKiBHZXQgbmVpZ2hib3IgY291bnQgYXQgW2ksal0gaW4gdGhpcy5fbWFwXG4gKi9cblJPVC5NYXAuQ2VsbHVsYXIucHJvdG90eXBlLl9nZXROZWlnaGJvcnMgPSBmdW5jdGlvbihjeCwgY3kpIHtcblx0dmFyIHJlc3VsdCA9IDA7XG5cdGZvciAodmFyIGk9MDtpPHRoaXMuX2RpcnMubGVuZ3RoO2krKykge1xuXHRcdHZhciBkaXIgPSB0aGlzLl9kaXJzW2ldO1xuXHRcdHZhciB4ID0gY3ggKyBkaXJbMF07XG5cdFx0dmFyIHkgPSBjeSArIGRpclsxXTtcblxuXHRcdGlmICh4IDwgMCB8fCB4ID49IHRoaXMuX3dpZHRoIHx8IHkgPCAwIHx8IHkgPj0gdGhpcy5faGVpZ2h0KSB7IGNvbnRpbnVlOyB9XG5cdFx0cmVzdWx0ICs9ICh0aGlzLl9tYXBbeF1beV0gPT0gMSA/IDEgOiAwKTtcblx0fVxuXG5cdHJldHVybiByZXN1bHQ7XG59O1xuXG4vKipcbiAqIE1ha2Ugc3VyZSBldmVyeSBub24td2FsbCBzcGFjZSBpcyBhY2Nlc3NpYmxlLlxuICogQHBhcmFtIHtmdW5jdGlvbn0gY2FsbGJhY2sgdG8gY2FsbCB0byBkaXNwbGF5IG1hcCB3aGVuIGRvXG4gKiBAcGFyYW0ge2ludH0gdmFsdWUgdG8gY29uc2lkZXIgZW1wdHkgc3BhY2UgLSBkZWZhdWx0cyB0byAwXG4gKiBAcGFyYW0ge2Z1bmN0aW9ufSBjYWxsYmFjayB0byBjYWxsIHdoZW4gYSBuZXcgY29ubmVjdGlvbiBpcyBtYWRlXG4gKi9cblJPVC5NYXAuQ2VsbHVsYXIucHJvdG90eXBlLmNvbm5lY3QgPSBmdW5jdGlvbihjYWxsYmFjaywgdmFsdWUsIGNvbm5lY3Rpb25DYWxsYmFjaykge1xuXHRpZiAoIXZhbHVlKSB2YWx1ZSA9IDA7XG5cblx0dmFyIGFsbEZyZWVTcGFjZSA9IFtdO1xuXHR2YXIgbm90Q29ubmVjdGVkID0ge307XG5cblx0Ly8gZmluZCBhbGwgZnJlZSBzcGFjZVxuXHR2YXIgd2lkdGhTdGVwID0gMTtcblx0dmFyIHdpZHRoU3RhcnRzID0gWzAsIDBdO1xuXHRpZiAodGhpcy5fb3B0aW9ucy50b3BvbG9neSA9PSA2KSB7XG5cdFx0d2lkdGhTdGVwID0gMjtcblx0XHR3aWR0aFN0YXJ0cyA9IFswLCAxXTtcblx0fVxuXHRmb3IgKHZhciB5ID0gMDsgeSA8IHRoaXMuX2hlaWdodDsgeSsrKSB7XG5cdFx0Zm9yICh2YXIgeCA9IHdpZHRoU3RhcnRzW3kgJSAyXTsgeCA8IHRoaXMuX3dpZHRoOyB4ICs9IHdpZHRoU3RlcCkge1xuXHRcdFx0aWYgKHRoaXMuX2ZyZWVTcGFjZSh4LCB5LCB2YWx1ZSkpIHtcblx0XHRcdFx0dmFyIHAgPSBbeCwgeV07XG5cdFx0XHRcdG5vdENvbm5lY3RlZFt0aGlzLl9wb2ludEtleShwKV0gPSBwO1xuXHRcdFx0XHRhbGxGcmVlU3BhY2UucHVzaChbeCwgeV0pO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXHR2YXIgc3RhcnQgPSBhbGxGcmVlU3BhY2VbUk9ULlJORy5nZXRVbmlmb3JtSW50KDAsIGFsbEZyZWVTcGFjZS5sZW5ndGggLSAxKV07XG5cblx0dmFyIGtleSA9IHRoaXMuX3BvaW50S2V5KHN0YXJ0KTtcblx0dmFyIGNvbm5lY3RlZCA9IHt9O1xuXHRjb25uZWN0ZWRba2V5XSA9IHN0YXJ0O1xuXHRkZWxldGUgbm90Q29ubmVjdGVkW2tleV07XG5cblx0Ly8gZmluZCB3aGF0J3MgY29ubmVjdGVkIHRvIHRoZSBzdGFydGluZyBwb2ludFxuXHR0aGlzLl9maW5kQ29ubmVjdGVkKGNvbm5lY3RlZCwgbm90Q29ubmVjdGVkLCBbc3RhcnRdLCBmYWxzZSwgdmFsdWUpO1xuXG5cdHdoaWxlIChPYmplY3Qua2V5cyhub3RDb25uZWN0ZWQpLmxlbmd0aCA+IDApIHtcblx0XHQvLyBmaW5kIHR3byBwb2ludHMgZnJvbSBub3RDb25uZWN0ZWQgdG8gY29ubmVjdGVkXG5cdFx0dmFyIHAgPSB0aGlzLl9nZXRGcm9tVG8oY29ubmVjdGVkLCBub3RDb25uZWN0ZWQpO1xuXHRcdHZhciBmcm9tID0gcFswXTsgLy8gbm90Q29ubmVjdGVkXG5cdFx0dmFyIHRvID0gcFsxXTsgLy8gY29ubmVjdGVkXG5cblx0XHQvLyBmaW5kIGV2ZXJ5dGhpbmcgY29ubmVjdGVkIHRvIHRoZSBzdGFydGluZyBwb2ludFxuXHRcdHZhciBsb2NhbCA9IHt9O1xuXHRcdGxvY2FsW3RoaXMuX3BvaW50S2V5KGZyb20pXSA9IGZyb207XG5cdFx0dGhpcy5fZmluZENvbm5lY3RlZChsb2NhbCwgbm90Q29ubmVjdGVkLCBbZnJvbV0sIHRydWUsIHZhbHVlKTtcblxuXHRcdC8vIGNvbm5lY3QgdG8gYSBjb25uZWN0ZWQgY2VsbFxuXHRcdHZhciB0dW5uZWxGbiA9ICh0aGlzLl9vcHRpb25zLnRvcG9sb2d5ID09IDYgPyB0aGlzLl90dW5uZWxUb0Nvbm5lY3RlZDYgOiB0aGlzLl90dW5uZWxUb0Nvbm5lY3RlZCk7XG5cdFx0dHVubmVsRm4uY2FsbCh0aGlzLCB0bywgZnJvbSwgY29ubmVjdGVkLCBub3RDb25uZWN0ZWQsIHZhbHVlLCBjb25uZWN0aW9uQ2FsbGJhY2spO1xuXG5cdFx0Ly8gbm93IGFsbCBvZiBsb2NhbCBpcyBjb25uZWN0ZWRcblx0XHRmb3IgKHZhciBrIGluIGxvY2FsKSB7XG5cdFx0XHR2YXIgcHAgPSBsb2NhbFtrXTtcblx0XHRcdHRoaXMuX21hcFtwcFswXV1bcHBbMV1dID0gdmFsdWU7XG5cdFx0XHRjb25uZWN0ZWRba10gPSBwcDtcblx0XHRcdGRlbGV0ZSBub3RDb25uZWN0ZWRba107XG5cdFx0fVxuXHR9XG5cblx0Y2FsbGJhY2sgJiYgdGhpcy5fc2VydmljZUNhbGxiYWNrKGNhbGxiYWNrKTtcbn07XG5cbi8qKlxuICogRmluZCByYW5kb20gcG9pbnRzIHRvIGNvbm5lY3QuIFNlYXJjaCBmb3IgdGhlIGNsb3Nlc3QgcG9pbnQgaW4gdGhlIGxhcmdlciBzcGFjZS5cbiAqIFRoaXMgaXMgdG8gbWluaW1pemUgdGhlIGxlbmd0aCBvZiB0aGUgcGFzc2FnZSB3aGlsZSBtYWludGFpbmluZyBnb29kIHBlcmZvcm1hbmNlLlxuICovXG5ST1QuTWFwLkNlbGx1bGFyLnByb3RvdHlwZS5fZ2V0RnJvbVRvID0gZnVuY3Rpb24oY29ubmVjdGVkLCBub3RDb25uZWN0ZWQpIHtcblx0dmFyIGZyb20sIHRvLCBkO1xuXHR2YXIgY29ubmVjdGVkS2V5cyA9IE9iamVjdC5rZXlzKGNvbm5lY3RlZCk7XG5cdHZhciBub3RDb25uZWN0ZWRLZXlzID0gT2JqZWN0LmtleXMobm90Q29ubmVjdGVkKTtcblx0Zm9yICh2YXIgaSA9IDA7IGkgPCA1OyBpKyspIHtcblx0XHRpZiAoY29ubmVjdGVkS2V5cy5sZW5ndGggPCBub3RDb25uZWN0ZWRLZXlzLmxlbmd0aCkge1xuXHRcdFx0dmFyIGtleXMgPSBjb25uZWN0ZWRLZXlzO1xuXHRcdFx0dG8gPSBjb25uZWN0ZWRba2V5c1tST1QuUk5HLmdldFVuaWZvcm1JbnQoMCwga2V5cy5sZW5ndGggLSAxKV1dO1xuXHRcdFx0ZnJvbSA9IHRoaXMuX2dldENsb3Nlc3QodG8sIG5vdENvbm5lY3RlZCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHZhciBrZXlzID0gbm90Q29ubmVjdGVkS2V5cztcblx0XHRcdGZyb20gPSBub3RDb25uZWN0ZWRba2V5c1tST1QuUk5HLmdldFVuaWZvcm1JbnQoMCwga2V5cy5sZW5ndGggLSAxKV1dO1xuXHRcdFx0dG8gPSB0aGlzLl9nZXRDbG9zZXN0KGZyb20sIGNvbm5lY3RlZCk7XG5cdFx0fVxuXHRcdGQgPSAoZnJvbVswXSAtIHRvWzBdKSAqIChmcm9tWzBdIC0gdG9bMF0pICsgKGZyb21bMV0gLSB0b1sxXSkgKiAoZnJvbVsxXSAtIHRvWzFdKTtcblx0XHRpZiAoZCA8IDY0KSB7XG5cdFx0XHRicmVhaztcblx0XHR9XG5cdH1cblx0Ly8gY29uc29sZS5sb2coXCI+Pj4gY29ubmVjdGVkPVwiICsgdG8gKyBcIiBub3RDb25uZWN0ZWQ9XCIgKyBmcm9tICsgXCIgZGlzdD1cIiArIGQpO1xuXHRyZXR1cm4gW2Zyb20sIHRvXTtcbn07XG5cblJPVC5NYXAuQ2VsbHVsYXIucHJvdG90eXBlLl9nZXRDbG9zZXN0ID0gZnVuY3Rpb24ocG9pbnQsIHNwYWNlKSB7XG5cdHZhciBtaW5Qb2ludCA9IG51bGw7XG5cdHZhciBtaW5EaXN0ID0gbnVsbDtcblx0Zm9yIChrIGluIHNwYWNlKSB7XG5cdFx0dmFyIHAgPSBzcGFjZVtrXTtcblx0XHR2YXIgZCA9IChwWzBdIC0gcG9pbnRbMF0pICogKHBbMF0gLSBwb2ludFswXSkgKyAocFsxXSAtIHBvaW50WzFdKSAqIChwWzFdIC0gcG9pbnRbMV0pO1xuXHRcdGlmIChtaW5EaXN0ID09IG51bGwgfHwgZCA8IG1pbkRpc3QpIHtcblx0XHRcdG1pbkRpc3QgPSBkO1xuXHRcdFx0bWluUG9pbnQgPSBwO1xuXHRcdH1cblx0fVxuXHRyZXR1cm4gbWluUG9pbnQ7XG59O1xuXG5ST1QuTWFwLkNlbGx1bGFyLnByb3RvdHlwZS5fZmluZENvbm5lY3RlZCA9IGZ1bmN0aW9uKGNvbm5lY3RlZCwgbm90Q29ubmVjdGVkLCBzdGFjaywga2VlcE5vdENvbm5lY3RlZCwgdmFsdWUpIHtcblx0d2hpbGUoc3RhY2subGVuZ3RoID4gMCkge1xuXHRcdHZhciBwID0gc3RhY2suc3BsaWNlKDAsIDEpWzBdO1xuXHRcdHZhciB0ZXN0cztcblxuXHRcdGlmICh0aGlzLl9vcHRpb25zLnRvcG9sb2d5ID09IDYpIHtcblx0XHRcdHRlc3RzID0gW1xuXHRcdFx0XHRbcFswXSArIDIsIHBbMV1dLFxuXHRcdFx0XHRbcFswXSArIDEsIHBbMV0gLSAxXSxcblx0XHRcdFx0W3BbMF0gLSAxLCBwWzFdIC0gMV0sXG5cdFx0XHRcdFtwWzBdIC0gMiwgcFsxXV0sXG5cdFx0XHRcdFtwWzBdIC0gMSwgcFsxXSArIDFdLFxuXHRcdFx0XHRbcFswXSArIDEsIHBbMV0gKyAxXSxcblx0XHRcdF07XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRlc3RzID0gW1xuXHRcdFx0XHRbcFswXSArIDEsIHBbMV1dLFxuXHRcdFx0XHRbcFswXSAtIDEsIHBbMV1dLFxuXHRcdFx0XHRbcFswXSwgICAgIHBbMV0gKyAxXSxcblx0XHRcdFx0W3BbMF0sICAgICBwWzFdIC0gMV1cblx0XHRcdF07XG5cdFx0fVxuXG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCB0ZXN0cy5sZW5ndGg7IGkrKykge1xuXHRcdFx0dmFyIGtleSA9IHRoaXMuX3BvaW50S2V5KHRlc3RzW2ldKTtcblx0XHRcdGlmIChjb25uZWN0ZWRba2V5XSA9PSBudWxsICYmIHRoaXMuX2ZyZWVTcGFjZSh0ZXN0c1tpXVswXSwgdGVzdHNbaV1bMV0sIHZhbHVlKSkge1xuXHRcdFx0XHRjb25uZWN0ZWRba2V5XSA9IHRlc3RzW2ldO1xuXHRcdFx0XHRpZiAoIWtlZXBOb3RDb25uZWN0ZWQpIHtcblx0XHRcdFx0XHRkZWxldGUgbm90Q29ubmVjdGVkW2tleV07XG5cdFx0XHRcdH1cblx0XHRcdFx0c3RhY2sucHVzaCh0ZXN0c1tpXSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG59O1xuXG5ST1QuTWFwLkNlbGx1bGFyLnByb3RvdHlwZS5fdHVubmVsVG9Db25uZWN0ZWQgPSBmdW5jdGlvbih0bywgZnJvbSwgY29ubmVjdGVkLCBub3RDb25uZWN0ZWQsIHZhbHVlLCBjb25uZWN0aW9uQ2FsbGJhY2spIHtcblx0dmFyIGtleSA9IHRoaXMuX3BvaW50S2V5KGZyb20pO1xuXHR2YXIgYSwgYjtcblx0aWYgKGZyb21bMF0gPCB0b1swXSkge1xuXHRcdGEgPSBmcm9tO1xuXHRcdGIgPSB0bztcblx0fSBlbHNlIHtcblx0XHRhID0gdG87XG5cdFx0YiA9IGZyb207XG5cdH1cblx0Zm9yICh2YXIgeHggPSBhWzBdOyB4eCA8PSBiWzBdOyB4eCsrKSB7XG5cdFx0dGhpcy5fbWFwW3h4XVthWzFdXSA9IHZhbHVlO1xuXHRcdHZhciBwID0gW3h4LCBhWzFdXTtcblx0XHR2YXIgcGtleSA9IHRoaXMuX3BvaW50S2V5KHApO1xuXHRcdGNvbm5lY3RlZFtwa2V5XSA9IHA7XG5cdFx0ZGVsZXRlIG5vdENvbm5lY3RlZFtwa2V5XTtcblx0fVxuXHRpZiAoY29ubmVjdGlvbkNhbGxiYWNrICYmIGFbMF0gPCBiWzBdKSB7XG5cdFx0Y29ubmVjdGlvbkNhbGxiYWNrKGEsIFtiWzBdLCBhWzFdXSk7XG5cdH1cblxuXHQvLyB4IGlzIG5vdyBmaXhlZFxuXHR2YXIgeCA9IGJbMF07XG5cblx0aWYgKGZyb21bMV0gPCB0b1sxXSkge1xuXHRcdGEgPSBmcm9tO1xuXHRcdGIgPSB0bztcblx0fSBlbHNlIHtcblx0XHRhID0gdG87XG5cdFx0YiA9IGZyb207XG5cdH1cblx0Zm9yICh2YXIgeXkgPSBhWzFdOyB5eSA8IGJbMV07IHl5KyspIHtcblx0XHR0aGlzLl9tYXBbeF1beXldID0gdmFsdWU7XG5cdFx0dmFyIHAgPSBbeCwgeXldO1xuXHRcdHZhciBwa2V5ID0gdGhpcy5fcG9pbnRLZXkocCk7XG5cdFx0Y29ubmVjdGVkW3BrZXldID0gcDtcblx0XHRkZWxldGUgbm90Q29ubmVjdGVkW3BrZXldO1xuXHR9XG5cdGlmIChjb25uZWN0aW9uQ2FsbGJhY2sgJiYgYVsxXSA8IGJbMV0pIHsgY29ubmVjdGlvbkNhbGxiYWNrKFtiWzBdLCBhWzFdXSwgW2JbMF0sIGJbMV1dKTsgfVxufVxuXG5ST1QuTWFwLkNlbGx1bGFyLnByb3RvdHlwZS5fdHVubmVsVG9Db25uZWN0ZWQ2ID0gZnVuY3Rpb24odG8sIGZyb20sIGNvbm5lY3RlZCwgbm90Q29ubmVjdGVkLCB2YWx1ZSwgY29ubmVjdGlvbkNhbGxiYWNrKSB7XG5cdHZhciBhLCBiO1xuXHRpZiAoZnJvbVswXSA8IHRvWzBdKSB7XG5cdFx0YSA9IGZyb207XG5cdFx0YiA9IHRvO1xuXHR9IGVsc2Uge1xuXHRcdGEgPSB0bztcblx0XHRiID0gZnJvbTtcblx0fVxuXG5cdC8vIHR1bm5lbCBkaWFnb25hbGx5IHVudGlsIGhvcml6b250YWxseSBsZXZlbFxuXHR2YXIgeHggPSBhWzBdO1xuXHR2YXIgeXkgPSBhWzFdO1xuXHR3aGlsZSAoISh4eCA9PSBiWzBdICYmIHl5ID09IGJbMV0pKSB7XG5cdFx0dmFyIHN0ZXBXaWR0aCA9IDI7XG5cdFx0aWYgKHl5IDwgYlsxXSkge1xuXHRcdFx0eXkrKztcblx0XHRcdHN0ZXBXaWR0aCA9IDE7XG5cdFx0fSBlbHNlIGlmICh5eSA+IGJbMV0pIHtcblx0XHRcdHl5LS07XG5cdFx0XHRzdGVwV2lkdGggPSAxO1xuXHRcdH1cblx0XHRpZiAoeHggPCBiWzBdKSB7XG5cdFx0XHR4eCArPSBzdGVwV2lkdGhcblx0XHR9IGVsc2UgaWYgKHh4ID4gYlswXSkge1xuXHRcdFx0eHggLT0gc3RlcFdpZHRoXG5cdFx0fSBlbHNlIGlmIChiWzFdICUgMikge1xuXHRcdFx0Ly8gV29uJ3Qgc3RlcCBvdXRzaWRlIG1hcCBpZiBkZXN0aW5hdGlvbiBvbiBpcyBtYXAncyByaWdodCBlZGdlXG5cdFx0XHR4eCAtPSBzdGVwV2lkdGg7XG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vIGRpdHRvIGZvciBsZWZ0IGVkZ2Vcblx0XHRcdHh4ICs9IHN0ZXBXaWR0aDtcblx0XHR9XG5cdFx0dGhpcy5fbWFwW3h4XVt5eV0gPSB2YWx1ZTtcblx0XHR2YXIgcCA9IFt4eCwgeXldXG5cdFx0dmFyIHBrZXkgPSB0aGlzLl9wb2ludEtleShwKTtcblx0XHRjb25uZWN0ZWRbcGtleV0gPSBwO1xuXHRcdGRlbGV0ZSBub3RDb25uZWN0ZWRbcGtleV07XG5cdH1cblxuXHRpZiAoY29ubmVjdGlvbkNhbGxiYWNrKSB7IGNvbm5lY3Rpb25DYWxsYmFjayhmcm9tLCB0byk7IH1cbn1cblxuUk9ULk1hcC5DZWxsdWxhci5wcm90b3R5cGUuX2ZyZWVTcGFjZSA9IGZ1bmN0aW9uKHgsIHksIHZhbHVlKSB7XG5cdHJldHVybiB4ID49IDAgJiYgeCA8IHRoaXMuX3dpZHRoICYmIHkgPj0gMCAmJiB5IDwgdGhpcy5faGVpZ2h0ICYmIHRoaXMuX21hcFt4XVt5XSA9PSB2YWx1ZTtcbn1cblxuUk9ULk1hcC5DZWxsdWxhci5wcm90b3R5cGUuX3BvaW50S2V5ID0gZnVuY3Rpb24ocCkge1xuXHRyZXR1cm4gcFswXSArIFwiLlwiICsgcFsxXTtcbn1cbi8qKlxuICogQGNsYXNzIER1bmdlb24gbWFwOiBoYXMgcm9vbXMgYW5kIGNvcnJpZG9yc1xuICogQGF1Z21lbnRzIFJPVC5NYXBcbiAqL1xuUk9ULk1hcC5EdW5nZW9uID0gZnVuY3Rpb24od2lkdGgsIGhlaWdodCkge1xuXHRST1QuTWFwLmNhbGwodGhpcywgd2lkdGgsIGhlaWdodCk7XG5cdHRoaXMuX3Jvb21zID0gW107IC8qIGxpc3Qgb2YgYWxsIHJvb21zICovXG5cdHRoaXMuX2NvcnJpZG9ycyA9IFtdO1xufTtcblJPVC5NYXAuRHVuZ2Vvbi5leHRlbmQoUk9ULk1hcCk7XG5cbi8qKlxuICogR2V0IGFsbCBnZW5lcmF0ZWQgcm9vbXNcbiAqIEByZXR1cm5zIHtST1QuTWFwLkZlYXR1cmUuUm9vbVtdfVxuICovXG5ST1QuTWFwLkR1bmdlb24ucHJvdG90eXBlLmdldFJvb21zID0gZnVuY3Rpb24oKSB7XG5cdHJldHVybiB0aGlzLl9yb29tcztcbn07XG5cbi8qKlxuICogR2V0IGFsbCBnZW5lcmF0ZWQgY29ycmlkb3JzXG4gKiBAcmV0dXJucyB7Uk9ULk1hcC5GZWF0dXJlLkNvcnJpZG9yW119XG4gKi9cblJPVC5NYXAuRHVuZ2Vvbi5wcm90b3R5cGUuZ2V0Q29ycmlkb3JzID0gZnVuY3Rpb24oKSB7XG5cdHJldHVybiB0aGlzLl9jb3JyaWRvcnM7XG59O1xuLyoqXG4gKiBAY2xhc3MgUmFuZG9tIGR1bmdlb24gZ2VuZXJhdG9yIHVzaW5nIGh1bWFuLWxpa2UgZGlnZ2luZyBwYXR0ZXJucy5cbiAqIEhlYXZpbHkgYmFzZWQgb24gTWlrZSBBbmRlcnNvbidzIGlkZWFzIGZyb20gdGhlIFwiVHlyYW50XCIgYWxnbywgbWVudGlvbmVkIGF0IFxuICogaHR0cDovL3d3dy5yb2d1ZWJhc2luLnJvZ3VlbGlrZWRldmVsb3BtZW50Lm9yZy9pbmRleC5waHA/dGl0bGU9RHVuZ2Vvbi1CdWlsZGluZ19BbGdvcml0aG0uXG4gKiBAYXVnbWVudHMgUk9ULk1hcC5EdW5nZW9uXG4gKi9cblJPVC5NYXAuRGlnZ2VyID0gZnVuY3Rpb24od2lkdGgsIGhlaWdodCwgb3B0aW9ucykge1xuXHRST1QuTWFwLkR1bmdlb24uY2FsbCh0aGlzLCB3aWR0aCwgaGVpZ2h0KTtcblx0XG5cdHRoaXMuX29wdGlvbnMgPSB7XG5cdFx0cm9vbVdpZHRoOiBbMywgOV0sIC8qIHJvb20gbWluaW11bSBhbmQgbWF4aW11bSB3aWR0aCAqL1xuXHRcdHJvb21IZWlnaHQ6IFszLCA1XSwgLyogcm9vbSBtaW5pbXVtIGFuZCBtYXhpbXVtIGhlaWdodCAqL1xuXHRcdGNvcnJpZG9yTGVuZ3RoOiBbMywgMTBdLCAvKiBjb3JyaWRvciBtaW5pbXVtIGFuZCBtYXhpbXVtIGxlbmd0aCAqL1xuXHRcdGR1Z1BlcmNlbnRhZ2U6IDAuMiwgLyogd2Ugc3RvcCBhZnRlciB0aGlzIHBlcmNlbnRhZ2Ugb2YgbGV2ZWwgYXJlYSBoYXMgYmVlbiBkdWcgb3V0ICovXG5cdFx0dGltZUxpbWl0OiAxMDAwIC8qIHdlIHN0b3AgYWZ0ZXIgdGhpcyBtdWNoIHRpbWUgaGFzIHBhc3NlZCAobXNlYykgKi9cblx0fTtcblx0Zm9yICh2YXIgcCBpbiBvcHRpb25zKSB7IHRoaXMuX29wdGlvbnNbcF0gPSBvcHRpb25zW3BdOyB9XG5cdFxuXHR0aGlzLl9mZWF0dXJlcyA9IHtcblx0XHRcIlJvb21cIjogNCxcblx0XHRcIkNvcnJpZG9yXCI6IDRcblx0fTtcblx0dGhpcy5fZmVhdHVyZUF0dGVtcHRzID0gMjA7IC8qIGhvdyBtYW55IHRpbWVzIGRvIHdlIHRyeSB0byBjcmVhdGUgYSBmZWF0dXJlIG9uIGEgc3VpdGFibGUgd2FsbCAqL1xuXHR0aGlzLl93YWxscyA9IHt9OyAvKiB0aGVzZSBhcmUgYXZhaWxhYmxlIGZvciBkaWdnaW5nICovXG5cdFxuXHR0aGlzLl9kaWdDYWxsYmFjayA9IHRoaXMuX2RpZ0NhbGxiYWNrLmJpbmQodGhpcyk7XG5cdHRoaXMuX2NhbkJlRHVnQ2FsbGJhY2sgPSB0aGlzLl9jYW5CZUR1Z0NhbGxiYWNrLmJpbmQodGhpcyk7XG5cdHRoaXMuX2lzV2FsbENhbGxiYWNrID0gdGhpcy5faXNXYWxsQ2FsbGJhY2suYmluZCh0aGlzKTtcblx0dGhpcy5fcHJpb3JpdHlXYWxsQ2FsbGJhY2sgPSB0aGlzLl9wcmlvcml0eVdhbGxDYWxsYmFjay5iaW5kKHRoaXMpO1xufTtcblJPVC5NYXAuRGlnZ2VyLmV4dGVuZChST1QuTWFwLkR1bmdlb24pO1xuXG4vKipcbiAqIENyZWF0ZSBhIG1hcFxuICogQHNlZSBST1QuTWFwI2NyZWF0ZVxuICovXG5ST1QuTWFwLkRpZ2dlci5wcm90b3R5cGUuY3JlYXRlID0gZnVuY3Rpb24oY2FsbGJhY2spIHtcblx0dGhpcy5fcm9vbXMgPSBbXTtcblx0dGhpcy5fY29ycmlkb3JzID0gW107XG5cdHRoaXMuX21hcCA9IHRoaXMuX2ZpbGxNYXAoMSk7XG5cdHRoaXMuX3dhbGxzID0ge307XG5cdHRoaXMuX2R1ZyA9IDA7XG5cdHZhciBhcmVhID0gKHRoaXMuX3dpZHRoLTIpICogKHRoaXMuX2hlaWdodC0yKTtcblxuXHR0aGlzLl9maXJzdFJvb20oKTtcblx0XG5cdHZhciB0MSA9IERhdGUubm93KCk7XG5cblx0ZG8ge1xuXHRcdHZhciB0MiA9IERhdGUubm93KCk7XG5cdFx0aWYgKHQyIC0gdDEgPiB0aGlzLl9vcHRpb25zLnRpbWVMaW1pdCkgeyBicmVhazsgfVxuXG5cdFx0LyogZmluZCBhIGdvb2Qgd2FsbCAqL1xuXHRcdHZhciB3YWxsID0gdGhpcy5fZmluZFdhbGwoKTtcblx0XHRpZiAoIXdhbGwpIHsgYnJlYWs7IH0gLyogbm8gbW9yZSB3YWxscyAqL1xuXHRcdFxuXHRcdHZhciBwYXJ0cyA9IHdhbGwuc3BsaXQoXCIsXCIpO1xuXHRcdHZhciB4ID0gcGFyc2VJbnQocGFydHNbMF0pO1xuXHRcdHZhciB5ID0gcGFyc2VJbnQocGFydHNbMV0pO1xuXHRcdHZhciBkaXIgPSB0aGlzLl9nZXREaWdnaW5nRGlyZWN0aW9uKHgsIHkpO1xuXHRcdGlmICghZGlyKSB7IGNvbnRpbnVlOyB9IC8qIHRoaXMgd2FsbCBpcyBub3Qgc3VpdGFibGUgKi9cblx0XHRcbi8vXHRcdGNvbnNvbGUubG9nKFwid2FsbFwiLCB4LCB5KTtcblxuXHRcdC8qIHRyeSBhZGRpbmcgYSBmZWF0dXJlICovXG5cdFx0dmFyIGZlYXR1cmVBdHRlbXB0cyA9IDA7XG5cdFx0ZG8ge1xuXHRcdFx0ZmVhdHVyZUF0dGVtcHRzKys7XG5cdFx0XHRpZiAodGhpcy5fdHJ5RmVhdHVyZSh4LCB5LCBkaXJbMF0sIGRpclsxXSkpIHsgLyogZmVhdHVyZSBhZGRlZCAqL1xuXHRcdFx0XHQvL2lmICh0aGlzLl9yb29tcy5sZW5ndGggKyB0aGlzLl9jb3JyaWRvcnMubGVuZ3RoID09IDIpIHsgdGhpcy5fcm9vbXNbMF0uYWRkRG9vcih4LCB5KTsgfSAvKiBmaXJzdCByb29tIG9maWNpYWxseSBoYXMgZG9vcnMgKi9cblx0XHRcdFx0dGhpcy5fcmVtb3ZlU3Vycm91bmRpbmdXYWxscyh4LCB5KTtcblx0XHRcdFx0dGhpcy5fcmVtb3ZlU3Vycm91bmRpbmdXYWxscyh4LWRpclswXSwgeS1kaXJbMV0pO1xuXHRcdFx0XHRicmVhazsgXG5cdFx0XHR9XG5cdFx0fSB3aGlsZSAoZmVhdHVyZUF0dGVtcHRzIDwgdGhpcy5fZmVhdHVyZUF0dGVtcHRzKTtcblx0XHRcblx0XHR2YXIgcHJpb3JpdHlXYWxscyA9IDA7XG5cdFx0Zm9yICh2YXIgaWQgaW4gdGhpcy5fd2FsbHMpIHsgXG5cdFx0XHRpZiAodGhpcy5fd2FsbHNbaWRdID4gMSkgeyBwcmlvcml0eVdhbGxzKys7IH1cblx0XHR9XG5cblx0fSB3aGlsZSAodGhpcy5fZHVnL2FyZWEgPCB0aGlzLl9vcHRpb25zLmR1Z1BlcmNlbnRhZ2UgfHwgcHJpb3JpdHlXYWxscyk7IC8qIGZpeG1lIG51bWJlciBvZiBwcmlvcml0eSB3YWxscyAqL1xuXG5cdHRoaXMuX2FkZERvb3JzKCk7XG5cblx0aWYgKGNhbGxiYWNrKSB7XG5cdFx0Zm9yICh2YXIgaT0wO2k8dGhpcy5fd2lkdGg7aSsrKSB7XG5cdFx0XHRmb3IgKHZhciBqPTA7ajx0aGlzLl9oZWlnaHQ7aisrKSB7XG5cdFx0XHRcdGNhbGxiYWNrKGksIGosIHRoaXMuX21hcFtpXVtqXSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cdFxuXHR0aGlzLl93YWxscyA9IHt9O1xuXHR0aGlzLl9tYXAgPSBudWxsO1xuXG5cdHJldHVybiB0aGlzO1xufTtcblxuUk9ULk1hcC5EaWdnZXIucHJvdG90eXBlLl9kaWdDYWxsYmFjayA9IGZ1bmN0aW9uKHgsIHksIHZhbHVlKSB7XG5cdGlmICh2YWx1ZSA9PSAwIHx8IHZhbHVlID09IDIpIHsgLyogZW1wdHkgKi9cblx0XHR0aGlzLl9tYXBbeF1beV0gPSAwO1xuXHRcdHRoaXMuX2R1ZysrO1xuXHR9IGVsc2UgeyAvKiB3YWxsICovXG5cdFx0dGhpcy5fd2FsbHNbeCtcIixcIit5XSA9IDE7XG5cdH1cbn07XG5cblJPVC5NYXAuRGlnZ2VyLnByb3RvdHlwZS5faXNXYWxsQ2FsbGJhY2sgPSBmdW5jdGlvbih4LCB5KSB7XG5cdGlmICh4IDwgMCB8fCB5IDwgMCB8fCB4ID49IHRoaXMuX3dpZHRoIHx8IHkgPj0gdGhpcy5faGVpZ2h0KSB7IHJldHVybiBmYWxzZTsgfVxuXHRyZXR1cm4gKHRoaXMuX21hcFt4XVt5XSA9PSAxKTtcbn07XG5cblJPVC5NYXAuRGlnZ2VyLnByb3RvdHlwZS5fY2FuQmVEdWdDYWxsYmFjayA9IGZ1bmN0aW9uKHgsIHkpIHtcblx0aWYgKHggPCAxIHx8IHkgPCAxIHx8IHgrMSA+PSB0aGlzLl93aWR0aCB8fCB5KzEgPj0gdGhpcy5faGVpZ2h0KSB7IHJldHVybiBmYWxzZTsgfVxuXHRyZXR1cm4gKHRoaXMuX21hcFt4XVt5XSA9PSAxKTtcbn07XG5cblJPVC5NYXAuRGlnZ2VyLnByb3RvdHlwZS5fcHJpb3JpdHlXYWxsQ2FsbGJhY2sgPSBmdW5jdGlvbih4LCB5KSB7XG5cdHRoaXMuX3dhbGxzW3grXCIsXCIreV0gPSAyO1xufTtcblxuUk9ULk1hcC5EaWdnZXIucHJvdG90eXBlLl9maXJzdFJvb20gPSBmdW5jdGlvbigpIHtcblx0dmFyIGN4ID0gTWF0aC5mbG9vcih0aGlzLl93aWR0aC8yKTtcblx0dmFyIGN5ID0gTWF0aC5mbG9vcih0aGlzLl9oZWlnaHQvMik7XG5cdHZhciByb29tID0gUk9ULk1hcC5GZWF0dXJlLlJvb20uY3JlYXRlUmFuZG9tQ2VudGVyKGN4LCBjeSwgdGhpcy5fb3B0aW9ucyk7XG5cdHRoaXMuX3Jvb21zLnB1c2gocm9vbSk7XG5cdHJvb20uY3JlYXRlKHRoaXMuX2RpZ0NhbGxiYWNrKTtcbn07XG5cbi8qKlxuICogR2V0IGEgc3VpdGFibGUgd2FsbFxuICovXG5ST1QuTWFwLkRpZ2dlci5wcm90b3R5cGUuX2ZpbmRXYWxsID0gZnVuY3Rpb24oKSB7XG5cdHZhciBwcmlvMSA9IFtdO1xuXHR2YXIgcHJpbzIgPSBbXTtcblx0Zm9yICh2YXIgaWQgaW4gdGhpcy5fd2FsbHMpIHtcblx0XHR2YXIgcHJpbyA9IHRoaXMuX3dhbGxzW2lkXTtcblx0XHRpZiAocHJpbyA9PSAyKSB7IFxuXHRcdFx0cHJpbzIucHVzaChpZCk7IFxuXHRcdH0gZWxzZSB7XG5cdFx0XHRwcmlvMS5wdXNoKGlkKTtcblx0XHR9XG5cdH1cblx0XG5cdHZhciBhcnIgPSAocHJpbzIubGVuZ3RoID8gcHJpbzIgOiBwcmlvMSk7XG5cdGlmICghYXJyLmxlbmd0aCkgeyByZXR1cm4gbnVsbDsgfSAvKiBubyB3YWxscyA6LyAqL1xuXHRcblx0dmFyIGlkID0gYXJyLnNvcnQoKS5yYW5kb20oKTsgLy8gc29ydCB0byBtYWtlIHRoZSBvcmRlciBkZXRlcm1pbmlzdGljXG5cdGRlbGV0ZSB0aGlzLl93YWxsc1tpZF07XG5cblx0cmV0dXJuIGlkO1xufTtcblxuLyoqXG4gKiBUcmllcyBhZGRpbmcgYSBmZWF0dXJlXG4gKiBAcmV0dXJucyB7Ym9vbH0gd2FzIHRoaXMgYSBzdWNjZXNzZnVsIHRyeT9cbiAqL1xuUk9ULk1hcC5EaWdnZXIucHJvdG90eXBlLl90cnlGZWF0dXJlID0gZnVuY3Rpb24oeCwgeSwgZHgsIGR5KSB7XG5cdHZhciBmZWF0dXJlID0gUk9ULlJORy5nZXRXZWlnaHRlZFZhbHVlKHRoaXMuX2ZlYXR1cmVzKTtcblx0ZmVhdHVyZSA9IFJPVC5NYXAuRmVhdHVyZVtmZWF0dXJlXS5jcmVhdGVSYW5kb21BdCh4LCB5LCBkeCwgZHksIHRoaXMuX29wdGlvbnMpO1xuXHRcblx0aWYgKCFmZWF0dXJlLmlzVmFsaWQodGhpcy5faXNXYWxsQ2FsbGJhY2ssIHRoaXMuX2NhbkJlRHVnQ2FsbGJhY2spKSB7XG4vL1x0XHRjb25zb2xlLmxvZyhcIm5vdCB2YWxpZFwiKTtcbi8vXHRcdGZlYXR1cmUuZGVidWcoKTtcblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cblx0XG5cdGZlYXR1cmUuY3JlYXRlKHRoaXMuX2RpZ0NhbGxiYWNrKTtcbi8vXHRmZWF0dXJlLmRlYnVnKCk7XG5cblx0aWYgKGZlYXR1cmUgaW5zdGFuY2VvZiBST1QuTWFwLkZlYXR1cmUuUm9vbSkgeyB0aGlzLl9yb29tcy5wdXNoKGZlYXR1cmUpOyB9XG5cdGlmIChmZWF0dXJlIGluc3RhbmNlb2YgUk9ULk1hcC5GZWF0dXJlLkNvcnJpZG9yKSB7IFxuXHRcdGZlYXR1cmUuY3JlYXRlUHJpb3JpdHlXYWxscyh0aGlzLl9wcmlvcml0eVdhbGxDYWxsYmFjayk7XG5cdFx0dGhpcy5fY29ycmlkb3JzLnB1c2goZmVhdHVyZSk7IFxuXHR9XG5cdFxuXHRyZXR1cm4gdHJ1ZTtcbn07XG5cblJPVC5NYXAuRGlnZ2VyLnByb3RvdHlwZS5fcmVtb3ZlU3Vycm91bmRpbmdXYWxscyA9IGZ1bmN0aW9uKGN4LCBjeSkge1xuXHR2YXIgZGVsdGFzID0gUk9ULkRJUlNbNF07XG5cblx0Zm9yICh2YXIgaT0wO2k8ZGVsdGFzLmxlbmd0aDtpKyspIHtcblx0XHR2YXIgZGVsdGEgPSBkZWx0YXNbaV07XG5cdFx0dmFyIHggPSBjeCArIGRlbHRhWzBdO1xuXHRcdHZhciB5ID0gY3kgKyBkZWx0YVsxXTtcblx0XHRkZWxldGUgdGhpcy5fd2FsbHNbeCtcIixcIit5XTtcblx0XHR2YXIgeCA9IGN4ICsgMipkZWx0YVswXTtcblx0XHR2YXIgeSA9IGN5ICsgMipkZWx0YVsxXTtcblx0XHRkZWxldGUgdGhpcy5fd2FsbHNbeCtcIixcIit5XTtcblx0fVxufTtcblxuLyoqXG4gKiBSZXR1cm5zIHZlY3RvciBpbiBcImRpZ2dpbmdcIiBkaXJlY3Rpb24sIG9yIGZhbHNlLCBpZiB0aGlzIGRvZXMgbm90IGV4aXN0IChvciBpcyBub3QgdW5pcXVlKVxuICovXG5ST1QuTWFwLkRpZ2dlci5wcm90b3R5cGUuX2dldERpZ2dpbmdEaXJlY3Rpb24gPSBmdW5jdGlvbihjeCwgY3kpIHtcblx0aWYgKGN4IDw9IDAgfHwgY3kgPD0gMCB8fCBjeCA+PSB0aGlzLl93aWR0aCAtIDEgfHwgY3kgPj0gdGhpcy5faGVpZ2h0IC0gMSkgeyByZXR1cm4gbnVsbDsgfVxuXG5cdHZhciByZXN1bHQgPSBudWxsO1xuXHR2YXIgZGVsdGFzID0gUk9ULkRJUlNbNF07XG5cdFxuXHRmb3IgKHZhciBpPTA7aTxkZWx0YXMubGVuZ3RoO2krKykge1xuXHRcdHZhciBkZWx0YSA9IGRlbHRhc1tpXTtcblx0XHR2YXIgeCA9IGN4ICsgZGVsdGFbMF07XG5cdFx0dmFyIHkgPSBjeSArIGRlbHRhWzFdO1xuXHRcdFxuXHRcdGlmICghdGhpcy5fbWFwW3hdW3ldKSB7IC8qIHRoZXJlIGFscmVhZHkgaXMgYW5vdGhlciBlbXB0eSBuZWlnaGJvciEgKi9cblx0XHRcdGlmIChyZXN1bHQpIHsgcmV0dXJuIG51bGw7IH1cblx0XHRcdHJlc3VsdCA9IGRlbHRhO1xuXHRcdH1cblx0fVxuXHRcblx0Lyogbm8gZW1wdHkgbmVpZ2hib3IgKi9cblx0aWYgKCFyZXN1bHQpIHsgcmV0dXJuIG51bGw7IH1cblx0XG5cdHJldHVybiBbLXJlc3VsdFswXSwgLXJlc3VsdFsxXV07XG59O1xuXG4vKipcbiAqIEZpbmQgZW1wdHkgc3BhY2VzIHN1cnJvdW5kaW5nIHJvb21zLCBhbmQgYXBwbHkgZG9vcnMuXG4gKi9cblJPVC5NYXAuRGlnZ2VyLnByb3RvdHlwZS5fYWRkRG9vcnMgPSBmdW5jdGlvbigpIHtcblx0dmFyIGRhdGEgPSB0aGlzLl9tYXA7XG5cdHZhciBpc1dhbGxDYWxsYmFjayA9IGZ1bmN0aW9uKHgsIHkpIHtcblx0XHRyZXR1cm4gKGRhdGFbeF1beV0gPT0gMSk7XG5cdH07XG5cdGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5fcm9vbXMubGVuZ3RoOyBpKysgKSB7XG5cdFx0dmFyIHJvb20gPSB0aGlzLl9yb29tc1tpXTtcblx0XHRyb29tLmNsZWFyRG9vcnMoKTtcblx0XHRyb29tLmFkZERvb3JzKGlzV2FsbENhbGxiYWNrKTtcblx0fVxufTtcbi8qKlxuICogQGNsYXNzIER1bmdlb24gZ2VuZXJhdG9yIHdoaWNoIHRyaWVzIHRvIGZpbGwgdGhlIHNwYWNlIGV2ZW5seS4gR2VuZXJhdGVzIGluZGVwZW5kZW50IHJvb21zIGFuZCB0cmllcyB0byBjb25uZWN0IHRoZW0uXG4gKiBAYXVnbWVudHMgUk9ULk1hcC5EdW5nZW9uXG4gKi9cblJPVC5NYXAuVW5pZm9ybSA9IGZ1bmN0aW9uKHdpZHRoLCBoZWlnaHQsIG9wdGlvbnMpIHtcblx0Uk9ULk1hcC5EdW5nZW9uLmNhbGwodGhpcywgd2lkdGgsIGhlaWdodCk7XG5cblx0dGhpcy5fb3B0aW9ucyA9IHtcblx0XHRyb29tV2lkdGg6IFszLCA5XSwgLyogcm9vbSBtaW5pbXVtIGFuZCBtYXhpbXVtIHdpZHRoICovXG5cdFx0cm9vbUhlaWdodDogWzMsIDVdLCAvKiByb29tIG1pbmltdW0gYW5kIG1heGltdW0gaGVpZ2h0ICovXG5cdFx0cm9vbUR1Z1BlcmNlbnRhZ2U6IDAuMSwgLyogd2Ugc3RvcCBhZnRlciB0aGlzIHBlcmNlbnRhZ2Ugb2YgbGV2ZWwgYXJlYSBoYXMgYmVlbiBkdWcgb3V0IGJ5IHJvb21zICovXG5cdFx0dGltZUxpbWl0OiAxMDAwIC8qIHdlIHN0b3AgYWZ0ZXIgdGhpcyBtdWNoIHRpbWUgaGFzIHBhc3NlZCAobXNlYykgKi9cblx0fTtcblx0Zm9yICh2YXIgcCBpbiBvcHRpb25zKSB7IHRoaXMuX29wdGlvbnNbcF0gPSBvcHRpb25zW3BdOyB9XG5cblx0dGhpcy5fcm9vbUF0dGVtcHRzID0gMjA7IC8qIG5ldyByb29tIGlzIGNyZWF0ZWQgTi10aW1lcyB1bnRpbCBpcyBjb25zaWRlcmVkIGFzIGltcG9zc2libGUgdG8gZ2VuZXJhdGUgKi9cblx0dGhpcy5fY29ycmlkb3JBdHRlbXB0cyA9IDIwOyAvKiBjb3JyaWRvcnMgYXJlIHRyaWVkIE4tdGltZXMgdW50aWwgdGhlIGxldmVsIGlzIGNvbnNpZGVyZWQgYXMgaW1wb3NzaWJsZSB0byBjb25uZWN0ICovXG5cblx0dGhpcy5fY29ubmVjdGVkID0gW107IC8qIGxpc3Qgb2YgYWxyZWFkeSBjb25uZWN0ZWQgcm9vbXMgKi9cblx0dGhpcy5fdW5jb25uZWN0ZWQgPSBbXTsgLyogbGlzdCBvZiByZW1haW5pbmcgdW5jb25uZWN0ZWQgcm9vbXMgKi9cblx0XG5cdHRoaXMuX2RpZ0NhbGxiYWNrID0gdGhpcy5fZGlnQ2FsbGJhY2suYmluZCh0aGlzKTtcblx0dGhpcy5fY2FuQmVEdWdDYWxsYmFjayA9IHRoaXMuX2NhbkJlRHVnQ2FsbGJhY2suYmluZCh0aGlzKTtcblx0dGhpcy5faXNXYWxsQ2FsbGJhY2sgPSB0aGlzLl9pc1dhbGxDYWxsYmFjay5iaW5kKHRoaXMpO1xufTtcblJPVC5NYXAuVW5pZm9ybS5leHRlbmQoUk9ULk1hcC5EdW5nZW9uKTtcblxuLyoqXG4gKiBDcmVhdGUgYSBtYXAuIElmIHRoZSB0aW1lIGxpbWl0IGhhcyBiZWVuIGhpdCwgcmV0dXJucyBudWxsLlxuICogQHNlZSBST1QuTWFwI2NyZWF0ZVxuICovXG5ST1QuTWFwLlVuaWZvcm0ucHJvdG90eXBlLmNyZWF0ZSA9IGZ1bmN0aW9uKGNhbGxiYWNrKSB7XG5cdHZhciB0MSA9IERhdGUubm93KCk7XG5cdHdoaWxlICgxKSB7XG5cdFx0dmFyIHQyID0gRGF0ZS5ub3coKTtcblx0XHRpZiAodDIgLSB0MSA+IHRoaXMuX29wdGlvbnMudGltZUxpbWl0KSB7IHJldHVybiBudWxsOyB9IC8qIHRpbWUgbGltaXQhICovXG5cdFxuXHRcdHRoaXMuX21hcCA9IHRoaXMuX2ZpbGxNYXAoMSk7XG5cdFx0dGhpcy5fZHVnID0gMDtcblx0XHR0aGlzLl9yb29tcyA9IFtdO1xuXHRcdHRoaXMuX3VuY29ubmVjdGVkID0gW107XG5cdFx0dGhpcy5fZ2VuZXJhdGVSb29tcygpO1xuXHRcdGlmICh0aGlzLl9yb29tcy5sZW5ndGggPCAyKSB7IGNvbnRpbnVlOyB9XG5cdFx0aWYgKHRoaXMuX2dlbmVyYXRlQ29ycmlkb3JzKCkpIHsgYnJlYWs7IH1cblx0fVxuXHRcblx0aWYgKGNhbGxiYWNrKSB7XG5cdFx0Zm9yICh2YXIgaT0wO2k8dGhpcy5fd2lkdGg7aSsrKSB7XG5cdFx0XHRmb3IgKHZhciBqPTA7ajx0aGlzLl9oZWlnaHQ7aisrKSB7XG5cdFx0XHRcdGNhbGxiYWNrKGksIGosIHRoaXMuX21hcFtpXVtqXSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cdFxuXHRyZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogR2VuZXJhdGVzIGEgc3VpdGFibGUgYW1vdW50IG9mIHJvb21zXG4gKi9cblJPVC5NYXAuVW5pZm9ybS5wcm90b3R5cGUuX2dlbmVyYXRlUm9vbXMgPSBmdW5jdGlvbigpIHtcblx0dmFyIHcgPSB0aGlzLl93aWR0aC0yO1xuXHR2YXIgaCA9IHRoaXMuX2hlaWdodC0yO1xuXG5cdGRvIHtcblx0XHR2YXIgcm9vbSA9IHRoaXMuX2dlbmVyYXRlUm9vbSgpO1xuXHRcdGlmICh0aGlzLl9kdWcvKHcqaCkgPiB0aGlzLl9vcHRpb25zLnJvb21EdWdQZXJjZW50YWdlKSB7IGJyZWFrOyB9IC8qIGFjaGlldmVkIHJlcXVlc3RlZCBhbW91bnQgb2YgZnJlZSBzcGFjZSAqL1xuXHR9IHdoaWxlIChyb29tKTtcblxuXHQvKiBlaXRoZXIgZW5vdWdoIHJvb21zLCBvciBub3QgYWJsZSB0byBnZW5lcmF0ZSBtb3JlIG9mIHRoZW0gOikgKi9cbn07XG5cbi8qKlxuICogVHJ5IHRvIGdlbmVyYXRlIG9uZSByb29tXG4gKi9cblJPVC5NYXAuVW5pZm9ybS5wcm90b3R5cGUuX2dlbmVyYXRlUm9vbSA9IGZ1bmN0aW9uKCkge1xuXHR2YXIgY291bnQgPSAwO1xuXHR3aGlsZSAoY291bnQgPCB0aGlzLl9yb29tQXR0ZW1wdHMpIHtcblx0XHRjb3VudCsrO1xuXHRcdFxuXHRcdHZhciByb29tID0gUk9ULk1hcC5GZWF0dXJlLlJvb20uY3JlYXRlUmFuZG9tKHRoaXMuX3dpZHRoLCB0aGlzLl9oZWlnaHQsIHRoaXMuX29wdGlvbnMpO1xuXHRcdGlmICghcm9vbS5pc1ZhbGlkKHRoaXMuX2lzV2FsbENhbGxiYWNrLCB0aGlzLl9jYW5CZUR1Z0NhbGxiYWNrKSkgeyBjb250aW51ZTsgfVxuXHRcdFxuXHRcdHJvb20uY3JlYXRlKHRoaXMuX2RpZ0NhbGxiYWNrKTtcblx0XHR0aGlzLl9yb29tcy5wdXNoKHJvb20pO1xuXHRcdHJldHVybiByb29tO1xuXHR9IFxuXG5cdC8qIG5vIHJvb20gd2FzIGdlbmVyYXRlZCBpbiBhIGdpdmVuIG51bWJlciBvZiBhdHRlbXB0cyAqL1xuXHRyZXR1cm4gbnVsbDtcbn07XG5cbi8qKlxuICogR2VuZXJhdGVzIGNvbm5lY3RvcnMgYmV3ZWVuIHJvb21zXG4gKiBAcmV0dXJucyB7Ym9vbH0gc3VjY2VzcyBXYXMgdGhpcyBhdHRlbXB0IHN1Y2Nlc3NmdWxsP1xuICovXG5ST1QuTWFwLlVuaWZvcm0ucHJvdG90eXBlLl9nZW5lcmF0ZUNvcnJpZG9ycyA9IGZ1bmN0aW9uKCkge1xuXHR2YXIgY250ID0gMDtcblx0d2hpbGUgKGNudCA8IHRoaXMuX2NvcnJpZG9yQXR0ZW1wdHMpIHtcblx0XHRjbnQrKztcblx0XHR0aGlzLl9jb3JyaWRvcnMgPSBbXTtcblxuXHRcdC8qIGRpZyByb29tcyBpbnRvIGEgY2xlYXIgbWFwICovXG5cdFx0dGhpcy5fbWFwID0gdGhpcy5fZmlsbE1hcCgxKTtcblx0XHRmb3IgKHZhciBpPTA7aTx0aGlzLl9yb29tcy5sZW5ndGg7aSsrKSB7IFxuXHRcdFx0dmFyIHJvb20gPSB0aGlzLl9yb29tc1tpXTtcblx0XHRcdHJvb20uY2xlYXJEb29ycygpO1xuXHRcdFx0cm9vbS5jcmVhdGUodGhpcy5fZGlnQ2FsbGJhY2spOyBcblx0XHR9XG5cblx0XHR0aGlzLl91bmNvbm5lY3RlZCA9IHRoaXMuX3Jvb21zLnNsaWNlKCkucmFuZG9taXplKCk7XG5cdFx0dGhpcy5fY29ubmVjdGVkID0gW107XG5cdFx0aWYgKHRoaXMuX3VuY29ubmVjdGVkLmxlbmd0aCkgeyB0aGlzLl9jb25uZWN0ZWQucHVzaCh0aGlzLl91bmNvbm5lY3RlZC5wb3AoKSk7IH0gLyogZmlyc3Qgb25lIGlzIGFsd2F5cyBjb25uZWN0ZWQgKi9cblx0XHRcblx0XHR3aGlsZSAoMSkge1xuXHRcdFx0LyogMS4gcGljayByYW5kb20gY29ubmVjdGVkIHJvb20gKi9cblx0XHRcdHZhciBjb25uZWN0ZWQgPSB0aGlzLl9jb25uZWN0ZWQucmFuZG9tKCk7XG5cdFx0XHRcblx0XHRcdC8qIDIuIGZpbmQgY2xvc2VzdCB1bmNvbm5lY3RlZCAqL1xuXHRcdFx0dmFyIHJvb20xID0gdGhpcy5fY2xvc2VzdFJvb20odGhpcy5fdW5jb25uZWN0ZWQsIGNvbm5lY3RlZCk7XG5cdFx0XHRcblx0XHRcdC8qIDMuIGNvbm5lY3QgaXQgdG8gY2xvc2VzdCBjb25uZWN0ZWQgKi9cblx0XHRcdHZhciByb29tMiA9IHRoaXMuX2Nsb3Nlc3RSb29tKHRoaXMuX2Nvbm5lY3RlZCwgcm9vbTEpO1xuXHRcdFx0XG5cdFx0XHR2YXIgb2sgPSB0aGlzLl9jb25uZWN0Um9vbXMocm9vbTEsIHJvb20yKTtcblx0XHRcdGlmICghb2spIHsgYnJlYWs7IH0gLyogc3RvcCBjb25uZWN0aW5nLCByZS1zaHVmZmxlICovXG5cdFx0XHRcblx0XHRcdGlmICghdGhpcy5fdW5jb25uZWN0ZWQubGVuZ3RoKSB7IHJldHVybiB0cnVlOyB9IC8qIGRvbmU7IG5vIHJvb21zIHJlbWFpbiAqL1xuXHRcdH1cblx0fVxuXHRyZXR1cm4gZmFsc2U7XG59O1xuXG4vKipcbiAqIEZvciBhIGdpdmVuIHJvb20sIGZpbmQgdGhlIGNsb3Nlc3Qgb25lIGZyb20gdGhlIGxpc3RcbiAqL1xuUk9ULk1hcC5Vbmlmb3JtLnByb3RvdHlwZS5fY2xvc2VzdFJvb20gPSBmdW5jdGlvbihyb29tcywgcm9vbSkge1xuXHR2YXIgZGlzdCA9IEluZmluaXR5O1xuXHR2YXIgY2VudGVyID0gcm9vbS5nZXRDZW50ZXIoKTtcblx0dmFyIHJlc3VsdCA9IG51bGw7XG5cdFxuXHRmb3IgKHZhciBpPTA7aTxyb29tcy5sZW5ndGg7aSsrKSB7XG5cdFx0dmFyIHIgPSByb29tc1tpXTtcblx0XHR2YXIgYyA9IHIuZ2V0Q2VudGVyKCk7XG5cdFx0dmFyIGR4ID0gY1swXS1jZW50ZXJbMF07XG5cdFx0dmFyIGR5ID0gY1sxXS1jZW50ZXJbMV07XG5cdFx0dmFyIGQgPSBkeCpkeCtkeSpkeTtcblx0XHRcblx0XHRpZiAoZCA8IGRpc3QpIHtcblx0XHRcdGRpc3QgPSBkO1xuXHRcdFx0cmVzdWx0ID0gcjtcblx0XHR9XG5cdH1cblx0XG5cdHJldHVybiByZXN1bHQ7XG59O1xuXG5ST1QuTWFwLlVuaWZvcm0ucHJvdG90eXBlLl9jb25uZWN0Um9vbXMgPSBmdW5jdGlvbihyb29tMSwgcm9vbTIpIHtcblx0Lypcblx0XHRyb29tMS5kZWJ1ZygpO1xuXHRcdHJvb20yLmRlYnVnKCk7XG5cdCovXG5cblx0dmFyIGNlbnRlcjEgPSByb29tMS5nZXRDZW50ZXIoKTtcblx0dmFyIGNlbnRlcjIgPSByb29tMi5nZXRDZW50ZXIoKTtcblxuXHR2YXIgZGlmZlggPSBjZW50ZXIyWzBdIC0gY2VudGVyMVswXTtcblx0dmFyIGRpZmZZID0gY2VudGVyMlsxXSAtIGNlbnRlcjFbMV07XG5cblx0aWYgKE1hdGguYWJzKGRpZmZYKSA8IE1hdGguYWJzKGRpZmZZKSkgeyAvKiBmaXJzdCB0cnkgY29ubmVjdGluZyBub3J0aC1zb3V0aCB3YWxscyAqL1xuXHRcdHZhciBkaXJJbmRleDEgPSAoZGlmZlkgPiAwID8gMiA6IDApO1xuXHRcdHZhciBkaXJJbmRleDIgPSAoZGlySW5kZXgxICsgMikgJSA0O1xuXHRcdHZhciBtaW4gPSByb29tMi5nZXRMZWZ0KCk7XG5cdFx0dmFyIG1heCA9IHJvb20yLmdldFJpZ2h0KCk7XG5cdFx0dmFyIGluZGV4ID0gMDtcblx0fSBlbHNlIHsgLyogZmlyc3QgdHJ5IGNvbm5lY3RpbmcgZWFzdC13ZXN0IHdhbGxzICovXG5cdFx0dmFyIGRpckluZGV4MSA9IChkaWZmWCA+IDAgPyAxIDogMyk7XG5cdFx0dmFyIGRpckluZGV4MiA9IChkaXJJbmRleDEgKyAyKSAlIDQ7XG5cdFx0dmFyIG1pbiA9IHJvb20yLmdldFRvcCgpO1xuXHRcdHZhciBtYXggPSByb29tMi5nZXRCb3R0b20oKTtcblx0XHR2YXIgaW5kZXggPSAxO1xuXHR9XG5cblx0dmFyIHN0YXJ0ID0gdGhpcy5fcGxhY2VJbldhbGwocm9vbTEsIGRpckluZGV4MSk7IC8qIGNvcnJpZG9yIHdpbGwgc3RhcnQgaGVyZSAqL1xuXHRpZiAoIXN0YXJ0KSB7IHJldHVybiBmYWxzZTsgfVxuXG5cdGlmIChzdGFydFtpbmRleF0gPj0gbWluICYmIHN0YXJ0W2luZGV4XSA8PSBtYXgpIHsgLyogcG9zc2libGUgdG8gY29ubmVjdCB3aXRoIHN0cmFpZ2h0IGxpbmUgKEktbGlrZSkgKi9cblx0XHR2YXIgZW5kID0gc3RhcnQuc2xpY2UoKTtcblx0XHR2YXIgdmFsdWUgPSBudWxsO1xuXHRcdHN3aXRjaCAoZGlySW5kZXgyKSB7XG5cdFx0XHRjYXNlIDA6IHZhbHVlID0gcm9vbTIuZ2V0VG9wKCktMTsgYnJlYWs7XG5cdFx0XHRjYXNlIDE6IHZhbHVlID0gcm9vbTIuZ2V0UmlnaHQoKSsxOyBicmVhaztcblx0XHRcdGNhc2UgMjogdmFsdWUgPSByb29tMi5nZXRCb3R0b20oKSsxOyBicmVhaztcblx0XHRcdGNhc2UgMzogdmFsdWUgPSByb29tMi5nZXRMZWZ0KCktMTsgYnJlYWs7XG5cdFx0fVxuXHRcdGVuZFsoaW5kZXgrMSklMl0gPSB2YWx1ZTtcblx0XHR0aGlzLl9kaWdMaW5lKFtzdGFydCwgZW5kXSk7XG5cdFx0XG5cdH0gZWxzZSBpZiAoc3RhcnRbaW5kZXhdIDwgbWluLTEgfHwgc3RhcnRbaW5kZXhdID4gbWF4KzEpIHsgLyogbmVlZCB0byBzd2l0Y2ggdGFyZ2V0IHdhbGwgKEwtbGlrZSkgKi9cblxuXHRcdHZhciBkaWZmID0gc3RhcnRbaW5kZXhdIC0gY2VudGVyMltpbmRleF07XG5cdFx0c3dpdGNoIChkaXJJbmRleDIpIHtcblx0XHRcdGNhc2UgMDpcblx0XHRcdGNhc2UgMTpcdHZhciByb3RhdGlvbiA9IChkaWZmIDwgMCA/IDMgOiAxKTsgYnJlYWs7XG5cdFx0XHRjYXNlIDI6XG5cdFx0XHRjYXNlIDM6XHR2YXIgcm90YXRpb24gPSAoZGlmZiA8IDAgPyAxIDogMyk7IGJyZWFrO1xuXHRcdH1cblx0XHRkaXJJbmRleDIgPSAoZGlySW5kZXgyICsgcm90YXRpb24pICUgNDtcblx0XHRcblx0XHR2YXIgZW5kID0gdGhpcy5fcGxhY2VJbldhbGwocm9vbTIsIGRpckluZGV4Mik7XG5cdFx0aWYgKCFlbmQpIHsgcmV0dXJuIGZhbHNlOyB9XG5cblx0XHR2YXIgbWlkID0gWzAsIDBdO1xuXHRcdG1pZFtpbmRleF0gPSBzdGFydFtpbmRleF07XG5cdFx0dmFyIGluZGV4MiA9IChpbmRleCsxKSUyO1xuXHRcdG1pZFtpbmRleDJdID0gZW5kW2luZGV4Ml07XG5cdFx0dGhpcy5fZGlnTGluZShbc3RhcnQsIG1pZCwgZW5kXSk7XG5cdFx0XG5cdH0gZWxzZSB7IC8qIHVzZSBjdXJyZW50IHdhbGwgcGFpciwgYnV0IGFkanVzdCB0aGUgbGluZSBpbiB0aGUgbWlkZGxlIChTLWxpa2UpICovXG5cdFxuXHRcdHZhciBpbmRleDIgPSAoaW5kZXgrMSklMjtcblx0XHR2YXIgZW5kID0gdGhpcy5fcGxhY2VJbldhbGwocm9vbTIsIGRpckluZGV4Mik7XG5cdFx0aWYgKCFlbmQpIHsgcmV0dXJuIGZhbHNlOyB9XG5cdFx0dmFyIG1pZCA9IE1hdGgucm91bmQoKGVuZFtpbmRleDJdICsgc3RhcnRbaW5kZXgyXSkvMik7XG5cblx0XHR2YXIgbWlkMSA9IFswLCAwXTtcblx0XHR2YXIgbWlkMiA9IFswLCAwXTtcblx0XHRtaWQxW2luZGV4XSA9IHN0YXJ0W2luZGV4XTtcblx0XHRtaWQxW2luZGV4Ml0gPSBtaWQ7XG5cdFx0bWlkMltpbmRleF0gPSBlbmRbaW5kZXhdO1xuXHRcdG1pZDJbaW5kZXgyXSA9IG1pZDtcblx0XHR0aGlzLl9kaWdMaW5lKFtzdGFydCwgbWlkMSwgbWlkMiwgZW5kXSk7XG5cdH1cblxuXHRyb29tMS5hZGREb29yKHN0YXJ0WzBdLCBzdGFydFsxXSk7XG5cdHJvb20yLmFkZERvb3IoZW5kWzBdLCBlbmRbMV0pO1xuXHRcblx0dmFyIGluZGV4ID0gdGhpcy5fdW5jb25uZWN0ZWQuaW5kZXhPZihyb29tMSk7XG5cdGlmIChpbmRleCAhPSAtMSkge1xuXHRcdHRoaXMuX3VuY29ubmVjdGVkLnNwbGljZShpbmRleCwgMSk7XG5cdFx0dGhpcy5fY29ubmVjdGVkLnB1c2gocm9vbTEpO1xuXHR9XG5cblx0dmFyIGluZGV4ID0gdGhpcy5fdW5jb25uZWN0ZWQuaW5kZXhPZihyb29tMik7XG5cdGlmIChpbmRleCAhPSAtMSkge1xuXHRcdHRoaXMuX3VuY29ubmVjdGVkLnNwbGljZShpbmRleCwgMSk7XG5cdFx0dGhpcy5fY29ubmVjdGVkLnB1c2gocm9vbTIpO1xuXHR9XG5cdFxuXHRyZXR1cm4gdHJ1ZTtcbn07XG5cblJPVC5NYXAuVW5pZm9ybS5wcm90b3R5cGUuX3BsYWNlSW5XYWxsID0gZnVuY3Rpb24ocm9vbSwgZGlySW5kZXgpIHtcblx0dmFyIHN0YXJ0ID0gWzAsIDBdO1xuXHR2YXIgZGlyID0gWzAsIDBdO1xuXHR2YXIgbGVuZ3RoID0gMDtcblx0XG5cdHN3aXRjaCAoZGlySW5kZXgpIHtcblx0XHRjYXNlIDA6XG5cdFx0XHRkaXIgPSBbMSwgMF07XG5cdFx0XHRzdGFydCA9IFtyb29tLmdldExlZnQoKSwgcm9vbS5nZXRUb3AoKS0xXTtcblx0XHRcdGxlbmd0aCA9IHJvb20uZ2V0UmlnaHQoKS1yb29tLmdldExlZnQoKSsxO1xuXHRcdGJyZWFrO1xuXHRcdGNhc2UgMTpcblx0XHRcdGRpciA9IFswLCAxXTtcblx0XHRcdHN0YXJ0ID0gW3Jvb20uZ2V0UmlnaHQoKSsxLCByb29tLmdldFRvcCgpXTtcblx0XHRcdGxlbmd0aCA9IHJvb20uZ2V0Qm90dG9tKCktcm9vbS5nZXRUb3AoKSsxO1xuXHRcdGJyZWFrO1xuXHRcdGNhc2UgMjpcblx0XHRcdGRpciA9IFsxLCAwXTtcblx0XHRcdHN0YXJ0ID0gW3Jvb20uZ2V0TGVmdCgpLCByb29tLmdldEJvdHRvbSgpKzFdO1xuXHRcdFx0bGVuZ3RoID0gcm9vbS5nZXRSaWdodCgpLXJvb20uZ2V0TGVmdCgpKzE7XG5cdFx0YnJlYWs7XG5cdFx0Y2FzZSAzOlxuXHRcdFx0ZGlyID0gWzAsIDFdO1xuXHRcdFx0c3RhcnQgPSBbcm9vbS5nZXRMZWZ0KCktMSwgcm9vbS5nZXRUb3AoKV07XG5cdFx0XHRsZW5ndGggPSByb29tLmdldEJvdHRvbSgpLXJvb20uZ2V0VG9wKCkrMTtcblx0XHRicmVhaztcblx0fVxuXHRcblx0dmFyIGF2YWlsID0gW107XG5cdHZhciBsYXN0QmFkSW5kZXggPSAtMjtcblxuXHRmb3IgKHZhciBpPTA7aTxsZW5ndGg7aSsrKSB7XG5cdFx0dmFyIHggPSBzdGFydFswXSArIGkqZGlyWzBdO1xuXHRcdHZhciB5ID0gc3RhcnRbMV0gKyBpKmRpclsxXTtcblx0XHRhdmFpbC5wdXNoKG51bGwpO1xuXHRcdFxuXHRcdHZhciBpc1dhbGwgPSAodGhpcy5fbWFwW3hdW3ldID09IDEpO1xuXHRcdGlmIChpc1dhbGwpIHtcblx0XHRcdGlmIChsYXN0QmFkSW5kZXggIT0gaS0xKSB7IGF2YWlsW2ldID0gW3gsIHldOyB9XG5cdFx0fSBlbHNlIHtcblx0XHRcdGxhc3RCYWRJbmRleCA9IGk7XG5cdFx0XHRpZiAoaSkgeyBhdmFpbFtpLTFdID0gbnVsbDsgfVxuXHRcdH1cblx0fVxuXHRcblx0Zm9yICh2YXIgaT1hdmFpbC5sZW5ndGgtMTsgaT49MDsgaS0tKSB7XG5cdFx0aWYgKCFhdmFpbFtpXSkgeyBhdmFpbC5zcGxpY2UoaSwgMSk7IH1cblx0fVxuXHRyZXR1cm4gKGF2YWlsLmxlbmd0aCA/IGF2YWlsLnJhbmRvbSgpIDogbnVsbCk7XG59O1xuXG4vKipcbiAqIERpZyBhIHBvbHlsaW5lLlxuICovXG5ST1QuTWFwLlVuaWZvcm0ucHJvdG90eXBlLl9kaWdMaW5lID0gZnVuY3Rpb24ocG9pbnRzKSB7XG5cdGZvciAodmFyIGk9MTtpPHBvaW50cy5sZW5ndGg7aSsrKSB7XG5cdFx0dmFyIHN0YXJ0ID0gcG9pbnRzW2ktMV07XG5cdFx0dmFyIGVuZCA9IHBvaW50c1tpXTtcblx0XHR2YXIgY29ycmlkb3IgPSBuZXcgUk9ULk1hcC5GZWF0dXJlLkNvcnJpZG9yKHN0YXJ0WzBdLCBzdGFydFsxXSwgZW5kWzBdLCBlbmRbMV0pO1xuXHRcdGNvcnJpZG9yLmNyZWF0ZSh0aGlzLl9kaWdDYWxsYmFjayk7XG5cdFx0dGhpcy5fY29ycmlkb3JzLnB1c2goY29ycmlkb3IpO1xuXHR9XG59O1xuXG5ST1QuTWFwLlVuaWZvcm0ucHJvdG90eXBlLl9kaWdDYWxsYmFjayA9IGZ1bmN0aW9uKHgsIHksIHZhbHVlKSB7XG5cdHRoaXMuX21hcFt4XVt5XSA9IHZhbHVlO1xuXHRpZiAodmFsdWUgPT0gMCkgeyB0aGlzLl9kdWcrKzsgfVxufTtcblxuUk9ULk1hcC5Vbmlmb3JtLnByb3RvdHlwZS5faXNXYWxsQ2FsbGJhY2sgPSBmdW5jdGlvbih4LCB5KSB7XG5cdGlmICh4IDwgMCB8fCB5IDwgMCB8fCB4ID49IHRoaXMuX3dpZHRoIHx8IHkgPj0gdGhpcy5faGVpZ2h0KSB7IHJldHVybiBmYWxzZTsgfVxuXHRyZXR1cm4gKHRoaXMuX21hcFt4XVt5XSA9PSAxKTtcbn07XG5cblJPVC5NYXAuVW5pZm9ybS5wcm90b3R5cGUuX2NhbkJlRHVnQ2FsbGJhY2sgPSBmdW5jdGlvbih4LCB5KSB7XG5cdGlmICh4IDwgMSB8fCB5IDwgMSB8fCB4KzEgPj0gdGhpcy5fd2lkdGggfHwgeSsxID49IHRoaXMuX2hlaWdodCkgeyByZXR1cm4gZmFsc2U7IH1cblx0cmV0dXJuICh0aGlzLl9tYXBbeF1beV0gPT0gMSk7XG59O1xuXG4vKipcbiAqIEBhdXRob3IgaHlha3VnZWlcbiAqIEBjbGFzcyBEdW5nZW9uIGdlbmVyYXRvciB3aGljaCB1c2VzIHRoZSBcIm9yZ2luYWxcIiBSb2d1ZSBkdW5nZW9uIGdlbmVyYXRpb24gYWxnb3JpdGhtLiBTZWUgaHR0cDovL2t1b2kuY29tL35rYW1pa2F6ZS9HYW1lRGVzaWduL2FydDA3X3JvZ3VlX2R1bmdlb24ucGhwXG4gKiBAYXVnbWVudHMgUk9ULk1hcFxuICogQHBhcmFtIHtpbnR9IFt3aWR0aD1ST1QuREVGQVVMVF9XSURUSF1cbiAqIEBwYXJhbSB7aW50fSBbaGVpZ2h0PVJPVC5ERUZBVUxUX0hFSUdIVF1cbiAqIEBwYXJhbSB7b2JqZWN0fSBbb3B0aW9uc10gT3B0aW9uc1xuICogQHBhcmFtIHtpbnRbXX0gW29wdGlvbnMuY2VsbFdpZHRoPTNdIE51bWJlciBvZiBjZWxscyB0byBjcmVhdGUgb24gdGhlIGhvcml6b250YWwgKG51bWJlciBvZiByb29tcyBob3Jpem9udGFsbHkpXG4gKiBAcGFyYW0ge2ludFtdfSBbb3B0aW9ucy5jZWxsSGVpZ2h0PTNdIE51bWJlciBvZiBjZWxscyB0byBjcmVhdGUgb24gdGhlIHZlcnRpY2FsIChudW1iZXIgb2Ygcm9vbXMgdmVydGljYWxseSlcbiAqIEBwYXJhbSB7aW50fSBbb3B0aW9ucy5yb29tV2lkdGhdIFJvb20gbWluIGFuZCBtYXggd2lkdGggLSBub3JtYWxseSBzZXQgYXV0by1tYWdpY2FsbHkgdmlhIHRoZSBjb25zdHJ1Y3Rvci5cbiAqIEBwYXJhbSB7aW50fSBbb3B0aW9ucy5yb29tSGVpZ2h0XSBSb29tIG1pbiBhbmQgbWF4IGhlaWdodCAtIG5vcm1hbGx5IHNldCBhdXRvLW1hZ2ljYWxseSB2aWEgdGhlIGNvbnN0cnVjdG9yLlxuICovXG5ST1QuTWFwLlJvZ3VlID0gZnVuY3Rpb24gKHdpZHRoLCBoZWlnaHQsIG9wdGlvbnMpIHtcblx0Uk9ULk1hcC5jYWxsKHRoaXMsIHdpZHRoLCBoZWlnaHQpO1xuXG5cdHRoaXMuX29wdGlvbnMgPSB7XG5cdFx0Y2VsbFdpZHRoOiAzLCAgLy8gTk9URSB0byBzZWxmLCB0aGVzZSBjb3VsZCBwcm9iYWJseSB3b3JrIHRoZSBzYW1lIGFzIHRoZSByb29tV2lkdGgvcm9vbSBIZWlnaHQgdmFsdWVzXG5cdFx0Y2VsbEhlaWdodDogMyAgLy8gICAgIGllLiBhcyBhbiBhcnJheSB3aXRoIG1pbi1tYXggdmFsdWVzIGZvciBlYWNoIGRpcmVjdGlvbi4uLi5cblx0fTtcblxuXHRmb3IgKHZhciBwIGluIG9wdGlvbnMpIHsgdGhpcy5fb3B0aW9uc1twXSA9IG9wdGlvbnNbcF07IH1cblxuXHQvKlxuXHRTZXQgdGhlIHJvb20gc2l6ZXMgYWNjb3JkaW5nIHRvIHRoZSBvdmVyLWFsbCB3aWR0aCBvZiB0aGUgbWFwLFxuXHRhbmQgdGhlIGNlbGwgc2l6ZXMuXG5cdCovXG5cdGlmICghdGhpcy5fb3B0aW9ucy5oYXNPd25Qcm9wZXJ0eShcInJvb21XaWR0aFwiKSkge1xuXHRcdHRoaXMuX29wdGlvbnNbXCJyb29tV2lkdGhcIl0gPSB0aGlzLl9jYWxjdWxhdGVSb29tU2l6ZSh0aGlzLl93aWR0aCwgdGhpcy5fb3B0aW9uc1tcImNlbGxXaWR0aFwiXSk7XG5cdH1cblx0aWYgKCF0aGlzLl9vcHRpb25zLmhhc093blByb3BlcnR5KFwicm9vbUhlaWdodFwiKSkge1xuXHRcdHRoaXMuX29wdGlvbnNbXCJyb29tSGVpZ2h0XCJdID0gdGhpcy5fY2FsY3VsYXRlUm9vbVNpemUodGhpcy5faGVpZ2h0LCB0aGlzLl9vcHRpb25zW1wiY2VsbEhlaWdodFwiXSk7XG5cdH1cblxufTtcblxuUk9ULk1hcC5Sb2d1ZS5leHRlbmQoUk9ULk1hcCk7XG5cbi8qKlxuICogQHNlZSBST1QuTWFwI2NyZWF0ZVxuICovXG5ST1QuTWFwLlJvZ3VlLnByb3RvdHlwZS5jcmVhdGUgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcblx0dGhpcy5tYXAgPSB0aGlzLl9maWxsTWFwKDEpO1xuXHR0aGlzLnJvb21zID0gW107XG5cdHRoaXMuY29ubmVjdGVkQ2VsbHMgPSBbXTtcblxuXHR0aGlzLl9pbml0Um9vbXMoKTtcblx0dGhpcy5fY29ubmVjdFJvb21zKCk7XG5cdHRoaXMuX2Nvbm5lY3RVbmNvbm5lY3RlZFJvb21zKCk7XG5cdHRoaXMuX2NyZWF0ZVJhbmRvbVJvb21Db25uZWN0aW9ucygpO1xuXHR0aGlzLl9jcmVhdGVSb29tcygpO1xuXHR0aGlzLl9jcmVhdGVDb3JyaWRvcnMoKTtcblxuXHRpZiAoY2FsbGJhY2spIHtcblx0XHRmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuX3dpZHRoOyBpKyspIHtcblx0XHRcdGZvciAodmFyIGogPSAwOyBqIDwgdGhpcy5faGVpZ2h0OyBqKyspIHtcblx0XHRcdFx0Y2FsbGJhY2soaSwgaiwgdGhpcy5tYXBbaV1bal0pO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdHJldHVybiB0aGlzO1xufTtcblxuUk9ULk1hcC5Sb2d1ZS5wcm90b3R5cGUuX2NhbGN1bGF0ZVJvb21TaXplID0gZnVuY3Rpb24gKHNpemUsIGNlbGwpIHtcblx0dmFyIG1heCA9IE1hdGguZmxvb3IoKHNpemUvY2VsbCkgKiAwLjgpO1xuXHR2YXIgbWluID0gTWF0aC5mbG9vcigoc2l6ZS9jZWxsKSAqIDAuMjUpO1xuXHRpZiAobWluIDwgMikgeyBtaW4gPSAyOyB9XG5cdGlmIChtYXggPCAyKSB7IG1heCA9IDI7IH1cblx0cmV0dXJuIFttaW4sIG1heF07XG59O1xuXG5ST1QuTWFwLlJvZ3VlLnByb3RvdHlwZS5faW5pdFJvb21zID0gZnVuY3Rpb24gKCkge1xuXHQvLyBjcmVhdGUgcm9vbXMgYXJyYXkuIFRoaXMgaXMgdGhlIFwiZ3JpZFwiIGxpc3QgZnJvbSB0aGUgYWxnby5cblx0Zm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLl9vcHRpb25zLmNlbGxXaWR0aDsgaSsrKSB7XG5cdFx0dGhpcy5yb29tcy5wdXNoKFtdKTtcblx0XHRmb3IodmFyIGogPSAwOyBqIDwgdGhpcy5fb3B0aW9ucy5jZWxsSGVpZ2h0OyBqKyspIHtcblx0XHRcdHRoaXMucm9vbXNbaV0ucHVzaCh7XCJ4XCI6MCwgXCJ5XCI6MCwgXCJ3aWR0aFwiOjAsIFwiaGVpZ2h0XCI6MCwgXCJjb25uZWN0aW9uc1wiOltdLCBcImNlbGx4XCI6aSwgXCJjZWxseVwiOmp9KTtcblx0XHR9XG5cdH1cbn07XG5cblJPVC5NYXAuUm9ndWUucHJvdG90eXBlLl9jb25uZWN0Um9vbXMgPSBmdW5jdGlvbiAoKSB7XG5cdC8vcGljayByYW5kb20gc3RhcnRpbmcgZ3JpZFxuXHR2YXIgY2d4ID0gUk9ULlJORy5nZXRVbmlmb3JtSW50KDAsIHRoaXMuX29wdGlvbnMuY2VsbFdpZHRoLTEpO1xuXHR2YXIgY2d5ID0gUk9ULlJORy5nZXRVbmlmb3JtSW50KDAsIHRoaXMuX29wdGlvbnMuY2VsbEhlaWdodC0xKTtcblxuXHR2YXIgaWR4O1xuXHR2YXIgbmNneDtcblx0dmFyIG5jZ3k7XG5cblx0dmFyIGZvdW5kID0gZmFsc2U7XG5cdHZhciByb29tO1xuXHR2YXIgb3RoZXJSb29tO1xuXG5cdC8vIGZpbmQgIHVuY29ubmVjdGVkIG5laWdoYm91ciBjZWxsc1xuXHRkbyB7XG5cblx0XHQvL3ZhciBkaXJUb0NoZWNrID0gWzAsIDEsIDIsIDMsIDQsIDUsIDYsIDddO1xuXHRcdHZhciBkaXJUb0NoZWNrID0gWzAsIDIsIDQsIDZdO1xuXHRcdGRpclRvQ2hlY2sgPSBkaXJUb0NoZWNrLnJhbmRvbWl6ZSgpO1xuXG5cdFx0ZG8ge1xuXHRcdFx0Zm91bmQgPSBmYWxzZTtcblx0XHRcdGlkeCA9IGRpclRvQ2hlY2sucG9wKCk7XG5cblx0XHRcdG5jZ3ggPSBjZ3ggKyBST1QuRElSU1s4XVtpZHhdWzBdO1xuXHRcdFx0bmNneSA9IGNneSArIFJPVC5ESVJTWzhdW2lkeF1bMV07XG5cblx0XHRcdGlmIChuY2d4IDwgMCB8fCBuY2d4ID49IHRoaXMuX29wdGlvbnMuY2VsbFdpZHRoKSB7IGNvbnRpbnVlOyB9XG5cdFx0XHRpZiAobmNneSA8IDAgfHwgbmNneSA+PSB0aGlzLl9vcHRpb25zLmNlbGxIZWlnaHQpIHsgY29udGludWU7IH1cblxuXHRcdFx0cm9vbSA9IHRoaXMucm9vbXNbY2d4XVtjZ3ldO1xuXG5cdFx0XHRpZiAocm9vbVtcImNvbm5lY3Rpb25zXCJdLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0Ly8gYXMgbG9uZyBhcyB0aGlzIHJvb20gZG9lc24ndCBhbHJlYWR5IGNvb25lY3QgdG8gbWUsIHdlIGFyZSBvayB3aXRoIGl0LlxuXHRcdFx0XHRpZiAocm9vbVtcImNvbm5lY3Rpb25zXCJdWzBdWzBdID09IG5jZ3ggJiYgcm9vbVtcImNvbm5lY3Rpb25zXCJdWzBdWzFdID09IG5jZ3kpIHtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHRvdGhlclJvb20gPSB0aGlzLnJvb21zW25jZ3hdW25jZ3ldO1xuXG5cdFx0XHRpZiAob3RoZXJSb29tW1wiY29ubmVjdGlvbnNcIl0ubGVuZ3RoID09IDApIHtcblx0XHRcdFx0b3RoZXJSb29tW1wiY29ubmVjdGlvbnNcIl0ucHVzaChbY2d4LCBjZ3ldKTtcblxuXHRcdFx0XHR0aGlzLmNvbm5lY3RlZENlbGxzLnB1c2goW25jZ3gsIG5jZ3ldKTtcblx0XHRcdFx0Y2d4ID0gbmNneDtcblx0XHRcdFx0Y2d5ID0gbmNneTtcblx0XHRcdFx0Zm91bmQgPSB0cnVlO1xuXHRcdFx0fVxuXG5cdFx0fSB3aGlsZSAoZGlyVG9DaGVjay5sZW5ndGggPiAwICYmIGZvdW5kID09IGZhbHNlKTtcblxuXHR9IHdoaWxlIChkaXJUb0NoZWNrLmxlbmd0aCA+IDApO1xuXG59O1xuXG5ST1QuTWFwLlJvZ3VlLnByb3RvdHlwZS5fY29ubmVjdFVuY29ubmVjdGVkUm9vbXMgPSBmdW5jdGlvbiAoKSB7XG5cdC8vV2hpbGUgdGhlcmUgYXJlIHVuY29ubmVjdGVkIHJvb21zLCB0cnkgdG8gY29ubmVjdCB0aGVtIHRvIGEgcmFuZG9tIGNvbm5lY3RlZCBuZWlnaGJvclxuXHQvLyhpZiBhIHJvb20gaGFzIG5vIGNvbm5lY3RlZCBuZWlnaGJvcnMgeWV0LCBqdXN0IGtlZXAgY3ljbGluZywgeW91J2xsIGZpbGwgb3V0IHRvIGl0IGV2ZW50dWFsbHkpLlxuXHR2YXIgY3cgPSB0aGlzLl9vcHRpb25zLmNlbGxXaWR0aDtcblx0dmFyIGNoID0gdGhpcy5fb3B0aW9ucy5jZWxsSGVpZ2h0O1xuXG5cdHRoaXMuY29ubmVjdGVkQ2VsbHMgPSB0aGlzLmNvbm5lY3RlZENlbGxzLnJhbmRvbWl6ZSgpO1xuXHR2YXIgcm9vbTtcblx0dmFyIG90aGVyUm9vbTtcblx0dmFyIHZhbGlkUm9vbTtcblxuXHRmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuX29wdGlvbnMuY2VsbFdpZHRoOyBpKyspIHtcblx0XHRmb3IgKHZhciBqID0gMDsgaiA8IHRoaXMuX29wdGlvbnMuY2VsbEhlaWdodDsgaisrKSAge1xuXG5cdFx0XHRyb29tID0gdGhpcy5yb29tc1tpXVtqXTtcblxuXHRcdFx0aWYgKHJvb21bXCJjb25uZWN0aW9uc1wiXS5sZW5ndGggPT0gMCkge1xuXHRcdFx0XHR2YXIgZGlyZWN0aW9ucyA9IFswLCAyLCA0LCA2XTtcblx0XHRcdFx0ZGlyZWN0aW9ucyA9IGRpcmVjdGlvbnMucmFuZG9taXplKCk7XG5cblx0XHRcdFx0dmFsaWRSb29tID0gZmFsc2U7XG5cblx0XHRcdFx0ZG8ge1xuXG5cdFx0XHRcdFx0dmFyIGRpcklkeCA9IGRpcmVjdGlvbnMucG9wKCk7XG5cdFx0XHRcdFx0dmFyIG5ld0kgPSBpICsgUk9ULkRJUlNbOF1bZGlySWR4XVswXTtcblx0XHRcdFx0XHR2YXIgbmV3SiA9IGogKyBST1QuRElSU1s4XVtkaXJJZHhdWzFdO1xuXG5cdFx0XHRcdFx0aWYgKG5ld0kgPCAwIHx8IG5ld0kgPj0gY3cgfHwgbmV3SiA8IDAgfHwgbmV3SiA+PSBjaCkgeyBjb250aW51ZTsgfVxuXG5cdFx0XHRcdFx0b3RoZXJSb29tID0gdGhpcy5yb29tc1tuZXdJXVtuZXdKXTtcblxuXHRcdFx0XHRcdHZhbGlkUm9vbSA9IHRydWU7XG5cblx0XHRcdFx0XHRpZiAob3RoZXJSb29tW1wiY29ubmVjdGlvbnNcIl0ubGVuZ3RoID09IDApIHsgYnJlYWs7IH1cblxuXHRcdFx0XHRcdGZvciAodmFyIGsgPSAwOyBrIDwgb3RoZXJSb29tW1wiY29ubmVjdGlvbnNcIl0ubGVuZ3RoOyBrKyspIHtcblx0XHRcdFx0XHRcdGlmIChvdGhlclJvb21bXCJjb25uZWN0aW9uc1wiXVtrXVswXSA9PSBpICYmIG90aGVyUm9vbVtcImNvbm5lY3Rpb25zXCJdW2tdWzFdID09IGopIHtcblx0XHRcdFx0XHRcdFx0dmFsaWRSb29tID0gZmFsc2U7XG5cdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGlmICh2YWxpZFJvb20pIHsgYnJlYWs7IH1cblxuXHRcdFx0XHR9IHdoaWxlIChkaXJlY3Rpb25zLmxlbmd0aCk7XG5cblx0XHRcdFx0aWYgKHZhbGlkUm9vbSkge1xuXHRcdFx0XHRcdHJvb21bXCJjb25uZWN0aW9uc1wiXS5wdXNoKFtvdGhlclJvb21bXCJjZWxseFwiXSwgb3RoZXJSb29tW1wiY2VsbHlcIl1dKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRjb25zb2xlLmxvZyhcIi0tIFVuYWJsZSB0byBjb25uZWN0IHJvb20uXCIpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG59O1xuXG5ST1QuTWFwLlJvZ3VlLnByb3RvdHlwZS5fY3JlYXRlUmFuZG9tUm9vbUNvbm5lY3Rpb25zID0gZnVuY3Rpb24gKGNvbm5lY3Rpb25zKSB7XG5cdC8vIEVtcHR5IGZvciBub3cuXG59O1xuXG5cblJPVC5NYXAuUm9ndWUucHJvdG90eXBlLl9jcmVhdGVSb29tcyA9IGZ1bmN0aW9uICgpIHtcblx0Ly8gQ3JlYXRlIFJvb21zXG5cblx0dmFyIHcgPSB0aGlzLl93aWR0aDtcblx0dmFyIGggPSB0aGlzLl9oZWlnaHQ7XG5cblx0dmFyIGN3ID0gdGhpcy5fb3B0aW9ucy5jZWxsV2lkdGg7XG5cdHZhciBjaCA9IHRoaXMuX29wdGlvbnMuY2VsbEhlaWdodDtcblxuXHR2YXIgY3dwID0gTWF0aC5mbG9vcih0aGlzLl93aWR0aCAvIGN3KTtcblx0dmFyIGNocCA9IE1hdGguZmxvb3IodGhpcy5faGVpZ2h0IC8gY2gpO1xuXG5cdHZhciByb29tdztcblx0dmFyIHJvb21oO1xuXHR2YXIgcm9vbVdpZHRoID0gdGhpcy5fb3B0aW9uc1tcInJvb21XaWR0aFwiXTtcblx0dmFyIHJvb21IZWlnaHQgPSB0aGlzLl9vcHRpb25zW1wicm9vbUhlaWdodFwiXTtcblx0dmFyIHN4O1xuXHR2YXIgc3k7XG5cdHZhciBvdGhlclJvb207XG5cblx0Zm9yICh2YXIgaSA9IDA7IGkgPCBjdzsgaSsrKSB7XG5cdFx0Zm9yICh2YXIgaiA9IDA7IGogPCBjaDsgaisrKSB7XG5cdFx0XHRzeCA9IGN3cCAqIGk7XG5cdFx0XHRzeSA9IGNocCAqIGo7XG5cblx0XHRcdGlmIChzeCA9PSAwKSB7IHN4ID0gMTsgfVxuXHRcdFx0aWYgKHN5ID09IDApIHsgc3kgPSAxOyB9XG5cblx0XHRcdHJvb213ID0gUk9ULlJORy5nZXRVbmlmb3JtSW50KHJvb21XaWR0aFswXSwgcm9vbVdpZHRoWzFdKTtcblx0XHRcdHJvb21oID0gUk9ULlJORy5nZXRVbmlmb3JtSW50KHJvb21IZWlnaHRbMF0sIHJvb21IZWlnaHRbMV0pO1xuXG5cdFx0XHRpZiAoaiA+IDApIHtcblx0XHRcdFx0b3RoZXJSb29tID0gdGhpcy5yb29tc1tpXVtqLTFdO1xuXHRcdFx0XHR3aGlsZSAoc3kgLSAob3RoZXJSb29tW1wieVwiXSArIG90aGVyUm9vbVtcImhlaWdodFwiXSApIDwgMykge1xuXHRcdFx0XHRcdHN5Kys7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0aWYgKGkgPiAwKSB7XG5cdFx0XHRcdG90aGVyUm9vbSA9IHRoaXMucm9vbXNbaS0xXVtqXTtcblx0XHRcdFx0d2hpbGUoc3ggLSAob3RoZXJSb29tW1wieFwiXSArIG90aGVyUm9vbVtcIndpZHRoXCJdKSA8IDMpIHtcblx0XHRcdFx0XHRzeCsrO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdHZhciBzeE9mZnNldCA9IE1hdGgucm91bmQoUk9ULlJORy5nZXRVbmlmb3JtSW50KDAsIGN3cC1yb29tdykvMik7XG5cdFx0XHR2YXIgc3lPZmZzZXQgPSBNYXRoLnJvdW5kKFJPVC5STkcuZ2V0VW5pZm9ybUludCgwLCBjaHAtcm9vbWgpLzIpO1xuXG5cdFx0XHR3aGlsZSAoc3ggKyBzeE9mZnNldCArIHJvb213ID49IHcpIHtcblx0XHRcdFx0aWYoc3hPZmZzZXQpIHtcblx0XHRcdFx0XHRzeE9mZnNldC0tO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHJvb213LS07XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0d2hpbGUgKHN5ICsgc3lPZmZzZXQgKyByb29taCA+PSBoKSB7XG5cdFx0XHRcdGlmKHN5T2Zmc2V0KSB7XG5cdFx0XHRcdFx0c3lPZmZzZXQtLTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRyb29taC0tO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdHN4ID0gc3ggKyBzeE9mZnNldDtcblx0XHRcdHN5ID0gc3kgKyBzeU9mZnNldDtcblxuXHRcdFx0dGhpcy5yb29tc1tpXVtqXVtcInhcIl0gPSBzeDtcblx0XHRcdHRoaXMucm9vbXNbaV1bal1bXCJ5XCJdID0gc3k7XG5cdFx0XHR0aGlzLnJvb21zW2ldW2pdW1wid2lkdGhcIl0gPSByb29tdztcblx0XHRcdHRoaXMucm9vbXNbaV1bal1bXCJoZWlnaHRcIl0gPSByb29taDtcblxuXHRcdFx0Zm9yICh2YXIgaWkgPSBzeDsgaWkgPCBzeCArIHJvb213OyBpaSsrKSB7XG5cdFx0XHRcdGZvciAodmFyIGpqID0gc3k7IGpqIDwgc3kgKyByb29taDsgamorKykge1xuXHRcdFx0XHRcdHRoaXMubWFwW2lpXVtqal0gPSAwO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG59O1xuXG5ST1QuTWFwLlJvZ3VlLnByb3RvdHlwZS5fZ2V0V2FsbFBvc2l0aW9uID0gZnVuY3Rpb24gKGFSb29tLCBhRGlyZWN0aW9uKSB7XG5cdHZhciByeDtcblx0dmFyIHJ5O1xuXHR2YXIgZG9vcjtcblxuXHRpZiAoYURpcmVjdGlvbiA9PSAxIHx8IGFEaXJlY3Rpb24gPT0gMykge1xuXHRcdHJ4ID0gUk9ULlJORy5nZXRVbmlmb3JtSW50KGFSb29tW1wieFwiXSArIDEsIGFSb29tW1wieFwiXSArIGFSb29tW1wid2lkdGhcIl0gLSAyKTtcblx0XHRpZiAoYURpcmVjdGlvbiA9PSAxKSB7XG5cdFx0XHRyeSA9IGFSb29tW1wieVwiXSAtIDI7XG5cdFx0XHRkb29yID0gcnkgKyAxO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRyeSA9IGFSb29tW1wieVwiXSArIGFSb29tW1wiaGVpZ2h0XCJdICsgMTtcblx0XHRcdGRvb3IgPSByeSAtMTtcblx0XHR9XG5cblx0XHR0aGlzLm1hcFtyeF1bZG9vcl0gPSAwOyAvLyBpJ20gbm90IHNldHRpbmcgYSBzcGVjaWZpYyAnZG9vcicgdGlsZSB2YWx1ZSByaWdodCBub3csIGp1c3QgZW1wdHkgc3BhY2UuXG5cblx0fSBlbHNlIGlmIChhRGlyZWN0aW9uID09IDIgfHwgYURpcmVjdGlvbiA9PSA0KSB7XG5cdFx0cnkgPSBST1QuUk5HLmdldFVuaWZvcm1JbnQoYVJvb21bXCJ5XCJdICsgMSwgYVJvb21bXCJ5XCJdICsgYVJvb21bXCJoZWlnaHRcIl0gLSAyKTtcblx0XHRpZihhRGlyZWN0aW9uID09IDIpIHtcblx0XHRcdHJ4ID0gYVJvb21bXCJ4XCJdICsgYVJvb21bXCJ3aWR0aFwiXSArIDE7XG5cdFx0XHRkb29yID0gcnggLSAxO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRyeCA9IGFSb29tW1wieFwiXSAtIDI7XG5cdFx0XHRkb29yID0gcnggKyAxO1xuXHRcdH1cblxuXHRcdHRoaXMubWFwW2Rvb3JdW3J5XSA9IDA7IC8vIGknbSBub3Qgc2V0dGluZyBhIHNwZWNpZmljICdkb29yJyB0aWxlIHZhbHVlIHJpZ2h0IG5vdywganVzdCBlbXB0eSBzcGFjZS5cblxuXHR9XG5cdHJldHVybiBbcngsIHJ5XTtcbn07XG5cbi8qKipcbiogQHBhcmFtIHN0YXJ0UG9zaXRpb24gYSAyIGVsZW1lbnQgYXJyYXlcbiogQHBhcmFtIGVuZFBvc2l0aW9uIGEgMiBlbGVtZW50IGFycmF5XG4qL1xuUk9ULk1hcC5Sb2d1ZS5wcm90b3R5cGUuX2RyYXdDb3JyaWRvciA9IGZ1bmN0aW9uIChzdGFydFBvc2l0aW9uLCBlbmRQb3NpdGlvbikge1xuXHR2YXIgeE9mZnNldCA9IGVuZFBvc2l0aW9uWzBdIC0gc3RhcnRQb3NpdGlvblswXTtcblx0dmFyIHlPZmZzZXQgPSBlbmRQb3NpdGlvblsxXSAtIHN0YXJ0UG9zaXRpb25bMV07XG5cblx0dmFyIHhwb3MgPSBzdGFydFBvc2l0aW9uWzBdO1xuXHR2YXIgeXBvcyA9IHN0YXJ0UG9zaXRpb25bMV07XG5cblx0dmFyIHRlbXBEaXN0O1xuXHR2YXIgeERpcjtcblx0dmFyIHlEaXI7XG5cblx0dmFyIG1vdmU7IC8vIDIgZWxlbWVudCBhcnJheSwgZWxlbWVudCAwIGlzIHRoZSBkaXJlY3Rpb24sIGVsZW1lbnQgMSBpcyB0aGUgdG90YWwgdmFsdWUgdG8gbW92ZS5cblx0dmFyIG1vdmVzID0gW107IC8vIGEgbGlzdCBvZiAyIGVsZW1lbnQgYXJyYXlzXG5cblx0dmFyIHhBYnMgPSBNYXRoLmFicyh4T2Zmc2V0KTtcblx0dmFyIHlBYnMgPSBNYXRoLmFicyh5T2Zmc2V0KTtcblxuXHR2YXIgcGVyY2VudCA9IFJPVC5STkcuZ2V0VW5pZm9ybSgpOyAvLyB1c2VkIHRvIHNwbGl0IHRoZSBtb3ZlIGF0IGRpZmZlcmVudCBwbGFjZXMgYWxvbmcgdGhlIGxvbmcgYXhpc1xuXHR2YXIgZmlyc3RIYWxmID0gcGVyY2VudDtcblx0dmFyIHNlY29uZEhhbGYgPSAxIC0gcGVyY2VudDtcblxuXHR4RGlyID0geE9mZnNldCA+IDAgPyAyIDogNjtcblx0eURpciA9IHlPZmZzZXQgPiAwID8gNCA6IDA7XG5cblx0aWYgKHhBYnMgPCB5QWJzKSB7XG5cdFx0Ly8gbW92ZSBmaXJzdEhhbGYgb2YgdGhlIHkgb2Zmc2V0XG5cdFx0dGVtcERpc3QgPSBNYXRoLmNlaWwoeUFicyAqIGZpcnN0SGFsZik7XG5cdFx0bW92ZXMucHVzaChbeURpciwgdGVtcERpc3RdKTtcblx0XHQvLyBtb3ZlIGFsbCB0aGUgeCBvZmZzZXRcblx0XHRtb3Zlcy5wdXNoKFt4RGlyLCB4QWJzXSk7XG5cdFx0Ly8gbW92ZSBzZW5kSGFsZiBvZiB0aGUgIHkgb2Zmc2V0XG5cdFx0dGVtcERpc3QgPSBNYXRoLmZsb29yKHlBYnMgKiBzZWNvbmRIYWxmKTtcblx0XHRtb3Zlcy5wdXNoKFt5RGlyLCB0ZW1wRGlzdF0pO1xuXHR9IGVsc2Uge1xuXHRcdC8vICBtb3ZlIGZpcnN0SGFsZiBvZiB0aGUgeCBvZmZzZXRcblx0XHR0ZW1wRGlzdCA9IE1hdGguY2VpbCh4QWJzICogZmlyc3RIYWxmKTtcblx0XHRtb3Zlcy5wdXNoKFt4RGlyLCB0ZW1wRGlzdF0pO1xuXHRcdC8vIG1vdmUgYWxsIHRoZSB5IG9mZnNldFxuXHRcdG1vdmVzLnB1c2goW3lEaXIsIHlBYnNdKTtcblx0XHQvLyBtb3ZlIHNlY29uZEhhbGYgb2YgdGhlIHggb2Zmc2V0LlxuXHRcdHRlbXBEaXN0ID0gTWF0aC5mbG9vcih4QWJzICogc2Vjb25kSGFsZik7XG5cdFx0bW92ZXMucHVzaChbeERpciwgdGVtcERpc3RdKTtcblx0fVxuXG5cdHRoaXMubWFwW3hwb3NdW3lwb3NdID0gMDtcblxuXHR3aGlsZSAobW92ZXMubGVuZ3RoID4gMCkge1xuXHRcdG1vdmUgPSBtb3Zlcy5wb3AoKTtcblx0XHR3aGlsZSAobW92ZVsxXSA+IDApIHtcblx0XHRcdHhwb3MgKz0gUk9ULkRJUlNbOF1bbW92ZVswXV1bMF07XG5cdFx0XHR5cG9zICs9IFJPVC5ESVJTWzhdW21vdmVbMF1dWzFdO1xuXHRcdFx0dGhpcy5tYXBbeHBvc11beXBvc10gPSAwO1xuXHRcdFx0bW92ZVsxXSA9IG1vdmVbMV0gLSAxO1xuXHRcdH1cblx0fVxufTtcblxuUk9ULk1hcC5Sb2d1ZS5wcm90b3R5cGUuX2NyZWF0ZUNvcnJpZG9ycyA9IGZ1bmN0aW9uICgpIHtcblx0Ly8gRHJhdyBDb3JyaWRvcnMgYmV0d2VlbiBjb25uZWN0ZWQgcm9vbXNcblxuXHR2YXIgY3cgPSB0aGlzLl9vcHRpb25zLmNlbGxXaWR0aDtcblx0dmFyIGNoID0gdGhpcy5fb3B0aW9ucy5jZWxsSGVpZ2h0O1xuXHR2YXIgcm9vbTtcblx0dmFyIGNvbm5lY3Rpb247XG5cdHZhciBvdGhlclJvb207XG5cdHZhciB3YWxsO1xuXHR2YXIgb3RoZXJXYWxsO1xuXG5cdGZvciAodmFyIGkgPSAwOyBpIDwgY3c7IGkrKykge1xuXHRcdGZvciAodmFyIGogPSAwOyBqIDwgY2g7IGorKykge1xuXHRcdFx0cm9vbSA9IHRoaXMucm9vbXNbaV1bal07XG5cblx0XHRcdGZvciAodmFyIGsgPSAwOyBrIDwgcm9vbVtcImNvbm5lY3Rpb25zXCJdLmxlbmd0aDsgaysrKSB7XG5cblx0XHRcdFx0Y29ubmVjdGlvbiA9IHJvb21bXCJjb25uZWN0aW9uc1wiXVtrXTtcblxuXHRcdFx0XHRvdGhlclJvb20gPSB0aGlzLnJvb21zW2Nvbm5lY3Rpb25bMF1dW2Nvbm5lY3Rpb25bMV1dO1xuXG5cdFx0XHRcdC8vIGZpZ3VyZSBvdXQgd2hhdCB3YWxsIG91ciBjb3JyaWRvciB3aWxsIHN0YXJ0IG9uZS5cblx0XHRcdFx0Ly8gZmlndXJlIG91dCB3aGF0IHdhbGwgb3VyIGNvcnJpZG9yIHdpbGwgZW5kIG9uLlxuXHRcdFx0XHRpZiAob3RoZXJSb29tW1wiY2VsbHhcIl0gPiByb29tW1wiY2VsbHhcIl0pIHtcblx0XHRcdFx0XHR3YWxsID0gMjtcblx0XHRcdFx0XHRvdGhlcldhbGwgPSA0O1xuXHRcdFx0XHR9IGVsc2UgaWYgKG90aGVyUm9vbVtcImNlbGx4XCJdIDwgcm9vbVtcImNlbGx4XCJdKSB7XG5cdFx0XHRcdFx0d2FsbCA9IDQ7XG5cdFx0XHRcdFx0b3RoZXJXYWxsID0gMjtcblx0XHRcdFx0fSBlbHNlIGlmKG90aGVyUm9vbVtcImNlbGx5XCJdID4gcm9vbVtcImNlbGx5XCJdKSB7XG5cdFx0XHRcdFx0d2FsbCA9IDM7XG5cdFx0XHRcdFx0b3RoZXJXYWxsID0gMTtcblx0XHRcdFx0fSBlbHNlIGlmKG90aGVyUm9vbVtcImNlbGx5XCJdIDwgcm9vbVtcImNlbGx5XCJdKSB7XG5cdFx0XHRcdFx0d2FsbCA9IDE7XG5cdFx0XHRcdFx0b3RoZXJXYWxsID0gMztcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHRoaXMuX2RyYXdDb3JyaWRvcih0aGlzLl9nZXRXYWxsUG9zaXRpb24ocm9vbSwgd2FsbCksIHRoaXMuX2dldFdhbGxQb3NpdGlvbihvdGhlclJvb20sIG90aGVyV2FsbCkpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxufTtcbi8qKlxuICogQGNsYXNzIER1bmdlb24gZmVhdHVyZTsgaGFzIG93biAuY3JlYXRlKCkgbWV0aG9kXG4gKi9cblJPVC5NYXAuRmVhdHVyZSA9IGZ1bmN0aW9uKCkge307XG5ST1QuTWFwLkZlYXR1cmUucHJvdG90eXBlLmlzVmFsaWQgPSBmdW5jdGlvbihjYW5CZUR1Z0NhbGxiYWNrKSB7fTtcblJPVC5NYXAuRmVhdHVyZS5wcm90b3R5cGUuY3JlYXRlID0gZnVuY3Rpb24oZGlnQ2FsbGJhY2spIHt9O1xuUk9ULk1hcC5GZWF0dXJlLnByb3RvdHlwZS5kZWJ1ZyA9IGZ1bmN0aW9uKCkge307XG5ST1QuTWFwLkZlYXR1cmUuY3JlYXRlUmFuZG9tQXQgPSBmdW5jdGlvbih4LCB5LCBkeCwgZHksIG9wdGlvbnMpIHt9O1xuXG4vKipcbiAqIEBjbGFzcyBSb29tXG4gKiBAYXVnbWVudHMgUk9ULk1hcC5GZWF0dXJlXG4gKiBAcGFyYW0ge2ludH0geDFcbiAqIEBwYXJhbSB7aW50fSB5MVxuICogQHBhcmFtIHtpbnR9IHgyXG4gKiBAcGFyYW0ge2ludH0geTJcbiAqIEBwYXJhbSB7aW50fSBbZG9vclhdXG4gKiBAcGFyYW0ge2ludH0gW2Rvb3JZXVxuICovXG5ST1QuTWFwLkZlYXR1cmUuUm9vbSA9IGZ1bmN0aW9uKHgxLCB5MSwgeDIsIHkyLCBkb29yWCwgZG9vclkpIHtcblx0dGhpcy5feDEgPSB4MTtcblx0dGhpcy5feTEgPSB5MTtcblx0dGhpcy5feDIgPSB4Mjtcblx0dGhpcy5feTIgPSB5Mjtcblx0dGhpcy5fZG9vcnMgPSB7fTtcblx0aWYgKGFyZ3VtZW50cy5sZW5ndGggPiA0KSB7IHRoaXMuYWRkRG9vcihkb29yWCwgZG9vclkpOyB9XG59O1xuUk9ULk1hcC5GZWF0dXJlLlJvb20uZXh0ZW5kKFJPVC5NYXAuRmVhdHVyZSk7XG5cbi8qKlxuICogUm9vbSBvZiByYW5kb20gc2l6ZSwgd2l0aCBhIGdpdmVuIGRvb3JzIGFuZCBkaXJlY3Rpb25cbiAqL1xuUk9ULk1hcC5GZWF0dXJlLlJvb20uY3JlYXRlUmFuZG9tQXQgPSBmdW5jdGlvbih4LCB5LCBkeCwgZHksIG9wdGlvbnMpIHtcblx0dmFyIG1pbiA9IG9wdGlvbnMucm9vbVdpZHRoWzBdO1xuXHR2YXIgbWF4ID0gb3B0aW9ucy5yb29tV2lkdGhbMV07XG5cdHZhciB3aWR0aCA9IFJPVC5STkcuZ2V0VW5pZm9ybUludChtaW4sIG1heCk7XG5cdFxuXHR2YXIgbWluID0gb3B0aW9ucy5yb29tSGVpZ2h0WzBdO1xuXHR2YXIgbWF4ID0gb3B0aW9ucy5yb29tSGVpZ2h0WzFdO1xuXHR2YXIgaGVpZ2h0ID0gUk9ULlJORy5nZXRVbmlmb3JtSW50KG1pbiwgbWF4KTtcblx0XG5cdGlmIChkeCA9PSAxKSB7IC8qIHRvIHRoZSByaWdodCAqL1xuXHRcdHZhciB5MiA9IHkgLSBNYXRoLmZsb29yKFJPVC5STkcuZ2V0VW5pZm9ybSgpICogaGVpZ2h0KTtcblx0XHRyZXR1cm4gbmV3IHRoaXMoeCsxLCB5MiwgeCt3aWR0aCwgeTIraGVpZ2h0LTEsIHgsIHkpO1xuXHR9XG5cdFxuXHRpZiAoZHggPT0gLTEpIHsgLyogdG8gdGhlIGxlZnQgKi9cblx0XHR2YXIgeTIgPSB5IC0gTWF0aC5mbG9vcihST1QuUk5HLmdldFVuaWZvcm0oKSAqIGhlaWdodCk7XG5cdFx0cmV0dXJuIG5ldyB0aGlzKHgtd2lkdGgsIHkyLCB4LTEsIHkyK2hlaWdodC0xLCB4LCB5KTtcblx0fVxuXG5cdGlmIChkeSA9PSAxKSB7IC8qIHRvIHRoZSBib3R0b20gKi9cblx0XHR2YXIgeDIgPSB4IC0gTWF0aC5mbG9vcihST1QuUk5HLmdldFVuaWZvcm0oKSAqIHdpZHRoKTtcblx0XHRyZXR1cm4gbmV3IHRoaXMoeDIsIHkrMSwgeDIrd2lkdGgtMSwgeStoZWlnaHQsIHgsIHkpO1xuXHR9XG5cblx0aWYgKGR5ID09IC0xKSB7IC8qIHRvIHRoZSB0b3AgKi9cblx0XHR2YXIgeDIgPSB4IC0gTWF0aC5mbG9vcihST1QuUk5HLmdldFVuaWZvcm0oKSAqIHdpZHRoKTtcblx0XHRyZXR1cm4gbmV3IHRoaXMoeDIsIHktaGVpZ2h0LCB4Mit3aWR0aC0xLCB5LTEsIHgsIHkpO1xuXHR9XG5cbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiZHggb3IgZHkgbXVzdCBiZSAxIG9yIC0xXCIpO1xufTtcblxuLyoqXG4gKiBSb29tIG9mIHJhbmRvbSBzaXplLCBwb3NpdGlvbmVkIGFyb3VuZCBjZW50ZXIgY29vcmRzXG4gKi9cblJPVC5NYXAuRmVhdHVyZS5Sb29tLmNyZWF0ZVJhbmRvbUNlbnRlciA9IGZ1bmN0aW9uKGN4LCBjeSwgb3B0aW9ucykge1xuXHR2YXIgbWluID0gb3B0aW9ucy5yb29tV2lkdGhbMF07XG5cdHZhciBtYXggPSBvcHRpb25zLnJvb21XaWR0aFsxXTtcblx0dmFyIHdpZHRoID0gUk9ULlJORy5nZXRVbmlmb3JtSW50KG1pbiwgbWF4KTtcblx0XG5cdHZhciBtaW4gPSBvcHRpb25zLnJvb21IZWlnaHRbMF07XG5cdHZhciBtYXggPSBvcHRpb25zLnJvb21IZWlnaHRbMV07XG5cdHZhciBoZWlnaHQgPSBST1QuUk5HLmdldFVuaWZvcm1JbnQobWluLCBtYXgpO1xuXG5cdHZhciB4MSA9IGN4IC0gTWF0aC5mbG9vcihST1QuUk5HLmdldFVuaWZvcm0oKSp3aWR0aCk7XG5cdHZhciB5MSA9IGN5IC0gTWF0aC5mbG9vcihST1QuUk5HLmdldFVuaWZvcm0oKSpoZWlnaHQpO1xuXHR2YXIgeDIgPSB4MSArIHdpZHRoIC0gMTtcblx0dmFyIHkyID0geTEgKyBoZWlnaHQgLSAxO1xuXG5cdHJldHVybiBuZXcgdGhpcyh4MSwgeTEsIHgyLCB5Mik7XG59O1xuXG4vKipcbiAqIFJvb20gb2YgcmFuZG9tIHNpemUgd2l0aGluIGEgZ2l2ZW4gZGltZW5zaW9uc1xuICovXG5ST1QuTWFwLkZlYXR1cmUuUm9vbS5jcmVhdGVSYW5kb20gPSBmdW5jdGlvbihhdmFpbFdpZHRoLCBhdmFpbEhlaWdodCwgb3B0aW9ucykge1xuXHR2YXIgbWluID0gb3B0aW9ucy5yb29tV2lkdGhbMF07XG5cdHZhciBtYXggPSBvcHRpb25zLnJvb21XaWR0aFsxXTtcblx0dmFyIHdpZHRoID0gUk9ULlJORy5nZXRVbmlmb3JtSW50KG1pbiwgbWF4KTtcblx0XG5cdHZhciBtaW4gPSBvcHRpb25zLnJvb21IZWlnaHRbMF07XG5cdHZhciBtYXggPSBvcHRpb25zLnJvb21IZWlnaHRbMV07XG5cdHZhciBoZWlnaHQgPSBST1QuUk5HLmdldFVuaWZvcm1JbnQobWluLCBtYXgpO1xuXHRcblx0dmFyIGxlZnQgPSBhdmFpbFdpZHRoIC0gd2lkdGggLSAxO1xuXHR2YXIgdG9wID0gYXZhaWxIZWlnaHQgLSBoZWlnaHQgLSAxO1xuXG5cdHZhciB4MSA9IDEgKyBNYXRoLmZsb29yKFJPVC5STkcuZ2V0VW5pZm9ybSgpKmxlZnQpO1xuXHR2YXIgeTEgPSAxICsgTWF0aC5mbG9vcihST1QuUk5HLmdldFVuaWZvcm0oKSp0b3ApO1xuXHR2YXIgeDIgPSB4MSArIHdpZHRoIC0gMTtcblx0dmFyIHkyID0geTEgKyBoZWlnaHQgLSAxO1xuXG5cdHJldHVybiBuZXcgdGhpcyh4MSwgeTEsIHgyLCB5Mik7XG59O1xuXG5ST1QuTWFwLkZlYXR1cmUuUm9vbS5wcm90b3R5cGUuYWRkRG9vciA9IGZ1bmN0aW9uKHgsIHkpIHtcblx0dGhpcy5fZG9vcnNbeCtcIixcIit5XSA9IDE7XG5cdHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAcGFyYW0ge2Z1bmN0aW9ufVxuICovXG5ST1QuTWFwLkZlYXR1cmUuUm9vbS5wcm90b3R5cGUuZ2V0RG9vcnMgPSBmdW5jdGlvbihjYWxsYmFjaykge1xuXHRmb3IgKHZhciBrZXkgaW4gdGhpcy5fZG9vcnMpIHtcblx0XHR2YXIgcGFydHMgPSBrZXkuc3BsaXQoXCIsXCIpO1xuXHRcdGNhbGxiYWNrKHBhcnNlSW50KHBhcnRzWzBdKSwgcGFyc2VJbnQocGFydHNbMV0pKTtcblx0fVxuXHRyZXR1cm4gdGhpcztcbn07XG5cblJPVC5NYXAuRmVhdHVyZS5Sb29tLnByb3RvdHlwZS5jbGVhckRvb3JzID0gZnVuY3Rpb24oKSB7XG5cdHRoaXMuX2Rvb3JzID0ge307XG5cdHJldHVybiB0aGlzO1xufTtcblxuUk9ULk1hcC5GZWF0dXJlLlJvb20ucHJvdG90eXBlLmFkZERvb3JzID0gZnVuY3Rpb24oaXNXYWxsQ2FsbGJhY2spIHtcblx0dmFyIGxlZnQgPSB0aGlzLl94MS0xO1xuXHR2YXIgcmlnaHQgPSB0aGlzLl94MisxO1xuXHR2YXIgdG9wID0gdGhpcy5feTEtMTtcblx0dmFyIGJvdHRvbSA9IHRoaXMuX3kyKzE7XG5cblx0Zm9yICh2YXIgeD1sZWZ0OyB4PD1yaWdodDsgeCsrKSB7XG5cdFx0Zm9yICh2YXIgeT10b3A7IHk8PWJvdHRvbTsgeSsrKSB7XG5cdFx0XHRpZiAoeCAhPSBsZWZ0ICYmIHggIT0gcmlnaHQgJiYgeSAhPSB0b3AgJiYgeSAhPSBib3R0b20pIHsgY29udGludWU7IH1cblx0XHRcdGlmIChpc1dhbGxDYWxsYmFjayh4LCB5KSkgeyBjb250aW51ZTsgfVxuXG5cdFx0XHR0aGlzLmFkZERvb3IoeCwgeSk7XG5cdFx0fVxuXHR9XG5cblx0cmV0dXJuIHRoaXM7XG59O1xuXG5ST1QuTWFwLkZlYXR1cmUuUm9vbS5wcm90b3R5cGUuZGVidWcgPSBmdW5jdGlvbigpIHtcblx0Y29uc29sZS5sb2coXCJyb29tXCIsIHRoaXMuX3gxLCB0aGlzLl95MSwgdGhpcy5feDIsIHRoaXMuX3kyKTtcbn07XG5cblJPVC5NYXAuRmVhdHVyZS5Sb29tLnByb3RvdHlwZS5pc1ZhbGlkID0gZnVuY3Rpb24oaXNXYWxsQ2FsbGJhY2ssIGNhbkJlRHVnQ2FsbGJhY2spIHsgXG5cdHZhciBsZWZ0ID0gdGhpcy5feDEtMTtcblx0dmFyIHJpZ2h0ID0gdGhpcy5feDIrMTtcblx0dmFyIHRvcCA9IHRoaXMuX3kxLTE7XG5cdHZhciBib3R0b20gPSB0aGlzLl95MisxO1xuXHRcblx0Zm9yICh2YXIgeD1sZWZ0OyB4PD1yaWdodDsgeCsrKSB7XG5cdFx0Zm9yICh2YXIgeT10b3A7IHk8PWJvdHRvbTsgeSsrKSB7XG5cdFx0XHRpZiAoeCA9PSBsZWZ0IHx8IHggPT0gcmlnaHQgfHwgeSA9PSB0b3AgfHwgeSA9PSBib3R0b20pIHtcblx0XHRcdFx0aWYgKCFpc1dhbGxDYWxsYmFjayh4LCB5KSkgeyByZXR1cm4gZmFsc2U7IH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGlmICghY2FuQmVEdWdDYWxsYmFjayh4LCB5KSkgeyByZXR1cm4gZmFsc2U7IH1cblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRyZXR1cm4gdHJ1ZTtcbn07XG5cbi8qKlxuICogQHBhcmFtIHtmdW5jdGlvbn0gZGlnQ2FsbGJhY2sgRGlnIGNhbGxiYWNrIHdpdGggYSBzaWduYXR1cmUgKHgsIHksIHZhbHVlKS4gVmFsdWVzOiAwID0gZW1wdHksIDEgPSB3YWxsLCAyID0gZG9vci4gTXVsdGlwbGUgZG9vcnMgYXJlIGFsbG93ZWQuXG4gKi9cblJPVC5NYXAuRmVhdHVyZS5Sb29tLnByb3RvdHlwZS5jcmVhdGUgPSBmdW5jdGlvbihkaWdDYWxsYmFjaykgeyBcblx0dmFyIGxlZnQgPSB0aGlzLl94MS0xO1xuXHR2YXIgcmlnaHQgPSB0aGlzLl94MisxO1xuXHR2YXIgdG9wID0gdGhpcy5feTEtMTtcblx0dmFyIGJvdHRvbSA9IHRoaXMuX3kyKzE7XG5cdFxuXHR2YXIgdmFsdWUgPSAwO1xuXHRmb3IgKHZhciB4PWxlZnQ7IHg8PXJpZ2h0OyB4KyspIHtcblx0XHRmb3IgKHZhciB5PXRvcDsgeTw9Ym90dG9tOyB5KyspIHtcblx0XHRcdGlmICh4K1wiLFwiK3kgaW4gdGhpcy5fZG9vcnMpIHtcblx0XHRcdFx0dmFsdWUgPSAyO1xuXHRcdFx0fSBlbHNlIGlmICh4ID09IGxlZnQgfHwgeCA9PSByaWdodCB8fCB5ID09IHRvcCB8fCB5ID09IGJvdHRvbSkge1xuXHRcdFx0XHR2YWx1ZSA9IDE7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR2YWx1ZSA9IDA7XG5cdFx0XHR9XG5cdFx0XHRkaWdDYWxsYmFjayh4LCB5LCB2YWx1ZSk7XG5cdFx0fVxuXHR9XG59O1xuXG5ST1QuTWFwLkZlYXR1cmUuUm9vbS5wcm90b3R5cGUuZ2V0Q2VudGVyID0gZnVuY3Rpb24oKSB7XG5cdHJldHVybiBbTWF0aC5yb3VuZCgodGhpcy5feDEgKyB0aGlzLl94MikvMiksIE1hdGgucm91bmQoKHRoaXMuX3kxICsgdGhpcy5feTIpLzIpXTtcbn07XG5cblJPVC5NYXAuRmVhdHVyZS5Sb29tLnByb3RvdHlwZS5nZXRMZWZ0ID0gZnVuY3Rpb24oKSB7XG5cdHJldHVybiB0aGlzLl94MTtcbn07XG5cblJPVC5NYXAuRmVhdHVyZS5Sb29tLnByb3RvdHlwZS5nZXRSaWdodCA9IGZ1bmN0aW9uKCkge1xuXHRyZXR1cm4gdGhpcy5feDI7XG59O1xuXG5ST1QuTWFwLkZlYXR1cmUuUm9vbS5wcm90b3R5cGUuZ2V0VG9wID0gZnVuY3Rpb24oKSB7XG5cdHJldHVybiB0aGlzLl95MTtcbn07XG5cblJPVC5NYXAuRmVhdHVyZS5Sb29tLnByb3RvdHlwZS5nZXRCb3R0b20gPSBmdW5jdGlvbigpIHtcblx0cmV0dXJuIHRoaXMuX3kyO1xufTtcblxuLyoqXG4gKiBAY2xhc3MgQ29ycmlkb3JcbiAqIEBhdWdtZW50cyBST1QuTWFwLkZlYXR1cmVcbiAqIEBwYXJhbSB7aW50fSBzdGFydFhcbiAqIEBwYXJhbSB7aW50fSBzdGFydFlcbiAqIEBwYXJhbSB7aW50fSBlbmRYXG4gKiBAcGFyYW0ge2ludH0gZW5kWVxuICovXG5ST1QuTWFwLkZlYXR1cmUuQ29ycmlkb3IgPSBmdW5jdGlvbihzdGFydFgsIHN0YXJ0WSwgZW5kWCwgZW5kWSkge1xuXHR0aGlzLl9zdGFydFggPSBzdGFydFg7XG5cdHRoaXMuX3N0YXJ0WSA9IHN0YXJ0WTtcblx0dGhpcy5fZW5kWCA9IGVuZFg7IFxuXHR0aGlzLl9lbmRZID0gZW5kWTtcblx0dGhpcy5fZW5kc1dpdGhBV2FsbCA9IHRydWU7XG59O1xuUk9ULk1hcC5GZWF0dXJlLkNvcnJpZG9yLmV4dGVuZChST1QuTWFwLkZlYXR1cmUpO1xuXG5ST1QuTWFwLkZlYXR1cmUuQ29ycmlkb3IuY3JlYXRlUmFuZG9tQXQgPSBmdW5jdGlvbih4LCB5LCBkeCwgZHksIG9wdGlvbnMpIHtcblx0dmFyIG1pbiA9IG9wdGlvbnMuY29ycmlkb3JMZW5ndGhbMF07XG5cdHZhciBtYXggPSBvcHRpb25zLmNvcnJpZG9yTGVuZ3RoWzFdO1xuXHR2YXIgbGVuZ3RoID0gUk9ULlJORy5nZXRVbmlmb3JtSW50KG1pbiwgbWF4KTtcblx0XG5cdHJldHVybiBuZXcgdGhpcyh4LCB5LCB4ICsgZHgqbGVuZ3RoLCB5ICsgZHkqbGVuZ3RoKTtcbn07XG5cblJPVC5NYXAuRmVhdHVyZS5Db3JyaWRvci5wcm90b3R5cGUuZGVidWcgPSBmdW5jdGlvbigpIHtcblx0Y29uc29sZS5sb2coXCJjb3JyaWRvclwiLCB0aGlzLl9zdGFydFgsIHRoaXMuX3N0YXJ0WSwgdGhpcy5fZW5kWCwgdGhpcy5fZW5kWSk7XG59O1xuXG5ST1QuTWFwLkZlYXR1cmUuQ29ycmlkb3IucHJvdG90eXBlLmlzVmFsaWQgPSBmdW5jdGlvbihpc1dhbGxDYWxsYmFjaywgY2FuQmVEdWdDYWxsYmFjayl7IFxuXHR2YXIgc3ggPSB0aGlzLl9zdGFydFg7XG5cdHZhciBzeSA9IHRoaXMuX3N0YXJ0WTtcblx0dmFyIGR4ID0gdGhpcy5fZW5kWC1zeDtcblx0dmFyIGR5ID0gdGhpcy5fZW5kWS1zeTtcblx0dmFyIGxlbmd0aCA9IDEgKyBNYXRoLm1heChNYXRoLmFicyhkeCksIE1hdGguYWJzKGR5KSk7XG5cdFxuXHRpZiAoZHgpIHsgZHggPSBkeC9NYXRoLmFicyhkeCk7IH1cblx0aWYgKGR5KSB7IGR5ID0gZHkvTWF0aC5hYnMoZHkpOyB9XG5cdHZhciBueCA9IGR5O1xuXHR2YXIgbnkgPSAtZHg7XG5cdFxuXHR2YXIgb2sgPSB0cnVlO1xuXHRmb3IgKHZhciBpPTA7IGk8bGVuZ3RoOyBpKyspIHtcblx0XHR2YXIgeCA9IHN4ICsgaSpkeDtcblx0XHR2YXIgeSA9IHN5ICsgaSpkeTtcblxuXHRcdGlmICghY2FuQmVEdWdDYWxsYmFjayggICAgIHgsICAgICAgeSkpIHsgb2sgPSBmYWxzZTsgfVxuXHRcdGlmICghaXNXYWxsQ2FsbGJhY2sgICh4ICsgbngsIHkgKyBueSkpIHsgb2sgPSBmYWxzZTsgfVxuXHRcdGlmICghaXNXYWxsQ2FsbGJhY2sgICh4IC0gbngsIHkgLSBueSkpIHsgb2sgPSBmYWxzZTsgfVxuXHRcdFxuXHRcdGlmICghb2spIHtcblx0XHRcdGxlbmd0aCA9IGk7XG5cdFx0XHR0aGlzLl9lbmRYID0geC1keDtcblx0XHRcdHRoaXMuX2VuZFkgPSB5LWR5O1xuXHRcdFx0YnJlYWs7XG5cdFx0fVxuXHR9XG5cdFxuXHQvKipcblx0ICogSWYgdGhlIGxlbmd0aCBkZWdlbmVyYXRlZCwgdGhpcyBjb3JyaWRvciBtaWdodCBiZSBpbnZhbGlkXG5cdCAqL1xuXHQgXG5cdC8qIG5vdCBzdXBwb3J0ZWQgKi9cblx0aWYgKGxlbmd0aCA9PSAwKSB7IHJldHVybiBmYWxzZTsgfSBcblx0XG5cdCAvKiBsZW5ndGggMSBhbGxvd2VkIG9ubHkgaWYgdGhlIG5leHQgc3BhY2UgaXMgZW1wdHkgKi9cblx0aWYgKGxlbmd0aCA9PSAxICYmIGlzV2FsbENhbGxiYWNrKHRoaXMuX2VuZFggKyBkeCwgdGhpcy5fZW5kWSArIGR5KSkgeyByZXR1cm4gZmFsc2U7IH1cblx0XG5cdC8qKlxuXHQgKiBXZSBkbyBub3Qgd2FudCB0aGUgY29ycmlkb3IgdG8gY3Jhc2ggaW50byBhIGNvcm5lciBvZiBhIHJvb207XG5cdCAqIGlmIGFueSBvZiB0aGUgZW5kaW5nIGNvcm5lcnMgaXMgZW1wdHksIHRoZSBOKzF0aCBjZWxsIG9mIHRoaXMgY29ycmlkb3IgbXVzdCBiZSBlbXB0eSB0b28uXG5cdCAqIFxuXHQgKiBTaXR1YXRpb246XG5cdCAqICMjIyMjIyMxXG5cdCAqIC4uLi4uLi4/XG5cdCAqICMjIyMjIyMyXG5cdCAqIFxuXHQgKiBUaGUgY29ycmlkb3Igd2FzIGR1ZyBmcm9tIGxlZnQgdG8gcmlnaHQuXG5cdCAqIDEsIDIgLSBwcm9ibGVtYXRpYyBjb3JuZXJzLCA/ID0gTisxdGggY2VsbCAobm90IGR1Zylcblx0ICovXG5cdHZhciBmaXJzdENvcm5lckJhZCA9ICFpc1dhbGxDYWxsYmFjayh0aGlzLl9lbmRYICsgZHggKyBueCwgdGhpcy5fZW5kWSArIGR5ICsgbnkpO1xuXHR2YXIgc2Vjb25kQ29ybmVyQmFkID0gIWlzV2FsbENhbGxiYWNrKHRoaXMuX2VuZFggKyBkeCAtIG54LCB0aGlzLl9lbmRZICsgZHkgLSBueSk7XG5cdHRoaXMuX2VuZHNXaXRoQVdhbGwgPSBpc1dhbGxDYWxsYmFjayh0aGlzLl9lbmRYICsgZHgsIHRoaXMuX2VuZFkgKyBkeSk7XG5cdGlmICgoZmlyc3RDb3JuZXJCYWQgfHwgc2Vjb25kQ29ybmVyQmFkKSAmJiB0aGlzLl9lbmRzV2l0aEFXYWxsKSB7IHJldHVybiBmYWxzZTsgfVxuXG5cdHJldHVybiB0cnVlO1xufTtcblxuLyoqXG4gKiBAcGFyYW0ge2Z1bmN0aW9ufSBkaWdDYWxsYmFjayBEaWcgY2FsbGJhY2sgd2l0aCBhIHNpZ25hdHVyZSAoeCwgeSwgdmFsdWUpLiBWYWx1ZXM6IDAgPSBlbXB0eS5cbiAqL1xuUk9ULk1hcC5GZWF0dXJlLkNvcnJpZG9yLnByb3RvdHlwZS5jcmVhdGUgPSBmdW5jdGlvbihkaWdDYWxsYmFjaykgeyBcblx0dmFyIHN4ID0gdGhpcy5fc3RhcnRYO1xuXHR2YXIgc3kgPSB0aGlzLl9zdGFydFk7XG5cdHZhciBkeCA9IHRoaXMuX2VuZFgtc3g7XG5cdHZhciBkeSA9IHRoaXMuX2VuZFktc3k7XG5cdHZhciBsZW5ndGggPSAxK01hdGgubWF4KE1hdGguYWJzKGR4KSwgTWF0aC5hYnMoZHkpKTtcblx0XG5cdGlmIChkeCkgeyBkeCA9IGR4L01hdGguYWJzKGR4KTsgfVxuXHRpZiAoZHkpIHsgZHkgPSBkeS9NYXRoLmFicyhkeSk7IH1cblx0dmFyIG54ID0gZHk7XG5cdHZhciBueSA9IC1keDtcblx0XG5cdGZvciAodmFyIGk9MDsgaTxsZW5ndGg7IGkrKykge1xuXHRcdHZhciB4ID0gc3ggKyBpKmR4O1xuXHRcdHZhciB5ID0gc3kgKyBpKmR5O1xuXHRcdGRpZ0NhbGxiYWNrKHgsIHksIDApO1xuXHR9XG5cdFxuXHRyZXR1cm4gdHJ1ZTtcbn07XG5cblJPVC5NYXAuRmVhdHVyZS5Db3JyaWRvci5wcm90b3R5cGUuY3JlYXRlUHJpb3JpdHlXYWxscyA9IGZ1bmN0aW9uKHByaW9yaXR5V2FsbENhbGxiYWNrKSB7XG5cdGlmICghdGhpcy5fZW5kc1dpdGhBV2FsbCkgeyByZXR1cm47IH1cblxuXHR2YXIgc3ggPSB0aGlzLl9zdGFydFg7XG5cdHZhciBzeSA9IHRoaXMuX3N0YXJ0WTtcblxuXHR2YXIgZHggPSB0aGlzLl9lbmRYLXN4O1xuXHR2YXIgZHkgPSB0aGlzLl9lbmRZLXN5O1xuXHRpZiAoZHgpIHsgZHggPSBkeC9NYXRoLmFicyhkeCk7IH1cblx0aWYgKGR5KSB7IGR5ID0gZHkvTWF0aC5hYnMoZHkpOyB9XG5cdHZhciBueCA9IGR5O1xuXHR2YXIgbnkgPSAtZHg7XG5cblx0cHJpb3JpdHlXYWxsQ2FsbGJhY2sodGhpcy5fZW5kWCArIGR4LCB0aGlzLl9lbmRZICsgZHkpO1xuXHRwcmlvcml0eVdhbGxDYWxsYmFjayh0aGlzLl9lbmRYICsgbngsIHRoaXMuX2VuZFkgKyBueSk7XG5cdHByaW9yaXR5V2FsbENhbGxiYWNrKHRoaXMuX2VuZFggLSBueCwgdGhpcy5fZW5kWSAtIG55KTtcbn07XG4vKipcbiAqIEBjbGFzcyBCYXNlIG5vaXNlIGdlbmVyYXRvclxuICovXG5ST1QuTm9pc2UgPSBmdW5jdGlvbigpIHtcbn07XG5cblJPVC5Ob2lzZS5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24oeCwgeSkge307XG4vKipcbiAqIEEgc2ltcGxlIDJkIGltcGxlbWVudGF0aW9uIG9mIHNpbXBsZXggbm9pc2UgYnkgT25kcmVqIFphcmFcbiAqXG4gKiBCYXNlZCBvbiBhIHNwZWVkLWltcHJvdmVkIHNpbXBsZXggbm9pc2UgYWxnb3JpdGhtIGZvciAyRCwgM0QgYW5kIDREIGluIEphdmEuXG4gKiBXaGljaCBpcyBiYXNlZCBvbiBleGFtcGxlIGNvZGUgYnkgU3RlZmFuIEd1c3RhdnNvbiAoc3RlZ3VAaXRuLmxpdS5zZSkuXG4gKiBXaXRoIE9wdGltaXNhdGlvbnMgYnkgUGV0ZXIgRWFzdG1hbiAocGVhc3RtYW5AZHJpenpsZS5zdGFuZm9yZC5lZHUpLlxuICogQmV0dGVyIHJhbmsgb3JkZXJpbmcgbWV0aG9kIGJ5IFN0ZWZhbiBHdXN0YXZzb24gaW4gMjAxMi5cbiAqL1xuXG4vKipcbiAqIEBjbGFzcyAyRCBzaW1wbGV4IG5vaXNlIGdlbmVyYXRvclxuICogQHBhcmFtIHtpbnR9IFtncmFkaWVudHM9MjU2XSBSYW5kb20gZ3JhZGllbnRzXG4gKi9cblJPVC5Ob2lzZS5TaW1wbGV4ID0gZnVuY3Rpb24oZ3JhZGllbnRzKSB7XG5cdFJPVC5Ob2lzZS5jYWxsKHRoaXMpO1xuXG5cdHRoaXMuX0YyID0gMC41ICogKE1hdGguc3FydCgzKSAtIDEpO1xuXHR0aGlzLl9HMiA9ICgzIC0gTWF0aC5zcXJ0KDMpKSAvIDY7XG5cblx0dGhpcy5fZ3JhZGllbnRzID0gW1xuXHRcdFsgMCwgLTFdLFxuXHRcdFsgMSwgLTFdLFxuXHRcdFsgMSwgIDBdLFxuXHRcdFsgMSwgIDFdLFxuXHRcdFsgMCwgIDFdLFxuXHRcdFstMSwgIDFdLFxuXHRcdFstMSwgIDBdLFxuXHRcdFstMSwgLTFdXG5cdF07XG5cblx0dmFyIHBlcm11dGF0aW9ucyA9IFtdO1xuXHR2YXIgY291bnQgPSBncmFkaWVudHMgfHwgMjU2O1xuXHRmb3IgKHZhciBpPTA7aTxjb3VudDtpKyspIHsgcGVybXV0YXRpb25zLnB1c2goaSk7IH1cblx0cGVybXV0YXRpb25zID0gcGVybXV0YXRpb25zLnJhbmRvbWl6ZSgpO1xuXG5cdHRoaXMuX3Blcm1zID0gW107XG5cdHRoaXMuX2luZGV4ZXMgPSBbXTtcblxuXHRmb3IgKHZhciBpPTA7aTwyKmNvdW50O2krKykge1xuXHRcdHRoaXMuX3Blcm1zLnB1c2gocGVybXV0YXRpb25zW2kgJSBjb3VudF0pO1xuXHRcdHRoaXMuX2luZGV4ZXMucHVzaCh0aGlzLl9wZXJtc1tpXSAlIHRoaXMuX2dyYWRpZW50cy5sZW5ndGgpO1xuXHR9XG5cbn07XG5ST1QuTm9pc2UuU2ltcGxleC5leHRlbmQoUk9ULk5vaXNlKTtcblxuUk9ULk5vaXNlLlNpbXBsZXgucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uKHhpbiwgeWluKSB7XG5cdHZhciBwZXJtcyA9IHRoaXMuX3Blcm1zO1xuXHR2YXIgaW5kZXhlcyA9IHRoaXMuX2luZGV4ZXM7XG5cdHZhciBjb3VudCA9IHBlcm1zLmxlbmd0aC8yO1xuXHR2YXIgRzIgPSB0aGlzLl9HMjtcblxuXHR2YXIgbjAgPTAsIG4xID0gMCwgbjIgPSAwLCBnaTsgLy8gTm9pc2UgY29udHJpYnV0aW9ucyBmcm9tIHRoZSB0aHJlZSBjb3JuZXJzXG5cblx0Ly8gU2tldyB0aGUgaW5wdXQgc3BhY2UgdG8gZGV0ZXJtaW5lIHdoaWNoIHNpbXBsZXggY2VsbCB3ZSdyZSBpblxuXHR2YXIgcyA9ICh4aW4gKyB5aW4pICogdGhpcy5fRjI7IC8vIEhhaXJ5IGZhY3RvciBmb3IgMkRcblx0dmFyIGkgPSBNYXRoLmZsb29yKHhpbiArIHMpO1xuXHR2YXIgaiA9IE1hdGguZmxvb3IoeWluICsgcyk7XG5cdHZhciB0ID0gKGkgKyBqKSAqIEcyO1xuXHR2YXIgWDAgPSBpIC0gdDsgLy8gVW5za2V3IHRoZSBjZWxsIG9yaWdpbiBiYWNrIHRvICh4LHkpIHNwYWNlXG5cdHZhciBZMCA9IGogLSB0O1xuXHR2YXIgeDAgPSB4aW4gLSBYMDsgLy8gVGhlIHgseSBkaXN0YW5jZXMgZnJvbSB0aGUgY2VsbCBvcmlnaW5cblx0dmFyIHkwID0geWluIC0gWTA7XG5cblx0Ly8gRm9yIHRoZSAyRCBjYXNlLCB0aGUgc2ltcGxleCBzaGFwZSBpcyBhbiBlcXVpbGF0ZXJhbCB0cmlhbmdsZS5cblx0Ly8gRGV0ZXJtaW5lIHdoaWNoIHNpbXBsZXggd2UgYXJlIGluLlxuXHR2YXIgaTEsIGoxOyAvLyBPZmZzZXRzIGZvciBzZWNvbmQgKG1pZGRsZSkgY29ybmVyIG9mIHNpbXBsZXggaW4gKGksaikgY29vcmRzXG5cdGlmICh4MCA+IHkwKSB7XG5cdFx0aTEgPSAxO1xuXHRcdGoxID0gMDtcblx0fSBlbHNlIHsgLy8gbG93ZXIgdHJpYW5nbGUsIFhZIG9yZGVyOiAoMCwwKS0+KDEsMCktPigxLDEpXG5cdFx0aTEgPSAwO1xuXHRcdGoxID0gMTtcblx0fSAvLyB1cHBlciB0cmlhbmdsZSwgWVggb3JkZXI6ICgwLDApLT4oMCwxKS0+KDEsMSlcblxuXHQvLyBBIHN0ZXAgb2YgKDEsMCkgaW4gKGksaikgbWVhbnMgYSBzdGVwIG9mICgxLWMsLWMpIGluICh4LHkpLCBhbmRcblx0Ly8gYSBzdGVwIG9mICgwLDEpIGluIChpLGopIG1lYW5zIGEgc3RlcCBvZiAoLWMsMS1jKSBpbiAoeCx5KSwgd2hlcmVcblx0Ly8gYyA9ICgzLXNxcnQoMykpLzZcblx0dmFyIHgxID0geDAgLSBpMSArIEcyOyAvLyBPZmZzZXRzIGZvciBtaWRkbGUgY29ybmVyIGluICh4LHkpIHVuc2tld2VkIGNvb3Jkc1xuXHR2YXIgeTEgPSB5MCAtIGoxICsgRzI7XG5cdHZhciB4MiA9IHgwIC0gMSArIDIqRzI7IC8vIE9mZnNldHMgZm9yIGxhc3QgY29ybmVyIGluICh4LHkpIHVuc2tld2VkIGNvb3Jkc1xuXHR2YXIgeTIgPSB5MCAtIDEgKyAyKkcyO1xuXG5cdC8vIFdvcmsgb3V0IHRoZSBoYXNoZWQgZ3JhZGllbnQgaW5kaWNlcyBvZiB0aGUgdGhyZWUgc2ltcGxleCBjb3JuZXJzXG5cdHZhciBpaSA9IGkubW9kKGNvdW50KTtcblx0dmFyIGpqID0gai5tb2QoY291bnQpO1xuXG5cdC8vIENhbGN1bGF0ZSB0aGUgY29udHJpYnV0aW9uIGZyb20gdGhlIHRocmVlIGNvcm5lcnNcblx0dmFyIHQwID0gMC41IC0geDAqeDAgLSB5MCp5MDtcblx0aWYgKHQwID49IDApIHtcblx0XHR0MCAqPSB0MDtcblx0XHRnaSA9IGluZGV4ZXNbaWkrcGVybXNbampdXTtcblx0XHR2YXIgZ3JhZCA9IHRoaXMuX2dyYWRpZW50c1tnaV07XG5cdFx0bjAgPSB0MCAqIHQwICogKGdyYWRbMF0gKiB4MCArIGdyYWRbMV0gKiB5MCk7XG5cdH1cblx0XG5cdHZhciB0MSA9IDAuNSAtIHgxKngxIC0geTEqeTE7XG5cdGlmICh0MSA+PSAwKSB7XG5cdFx0dDEgKj0gdDE7XG5cdFx0Z2kgPSBpbmRleGVzW2lpK2kxK3Blcm1zW2pqK2oxXV07XG5cdFx0dmFyIGdyYWQgPSB0aGlzLl9ncmFkaWVudHNbZ2ldO1xuXHRcdG4xID0gdDEgKiB0MSAqIChncmFkWzBdICogeDEgKyBncmFkWzFdICogeTEpO1xuXHR9XG5cdFxuXHR2YXIgdDIgPSAwLjUgLSB4Mip4MiAtIHkyKnkyO1xuXHRpZiAodDIgPj0gMCkge1xuXHRcdHQyICo9IHQyO1xuXHRcdGdpID0gaW5kZXhlc1tpaSsxK3Blcm1zW2pqKzFdXTtcblx0XHR2YXIgZ3JhZCA9IHRoaXMuX2dyYWRpZW50c1tnaV07XG5cdFx0bjIgPSB0MiAqIHQyICogKGdyYWRbMF0gKiB4MiArIGdyYWRbMV0gKiB5Mik7XG5cdH1cblxuXHQvLyBBZGQgY29udHJpYnV0aW9ucyBmcm9tIGVhY2ggY29ybmVyIHRvIGdldCB0aGUgZmluYWwgbm9pc2UgdmFsdWUuXG5cdC8vIFRoZSByZXN1bHQgaXMgc2NhbGVkIHRvIHJldHVybiB2YWx1ZXMgaW4gdGhlIGludGVydmFsIFstMSwxXS5cblx0cmV0dXJuIDcwICogKG4wICsgbjEgKyBuMik7XG59XG4vKipcbiAqIEBjbGFzcyBBYnN0cmFjdCBGT1YgYWxnb3JpdGhtXG4gKiBAcGFyYW0ge2Z1bmN0aW9ufSBsaWdodFBhc3Nlc0NhbGxiYWNrIERvZXMgdGhlIGxpZ2h0IHBhc3MgdGhyb3VnaCB4LHk/XG4gKiBAcGFyYW0ge29iamVjdH0gW29wdGlvbnNdXG4gKiBAcGFyYW0ge2ludH0gW29wdGlvbnMudG9wb2xvZ3k9OF0gNC82LzhcbiAqL1xuUk9ULkZPViA9IGZ1bmN0aW9uKGxpZ2h0UGFzc2VzQ2FsbGJhY2ssIG9wdGlvbnMpIHtcblx0dGhpcy5fbGlnaHRQYXNzZXMgPSBsaWdodFBhc3Nlc0NhbGxiYWNrO1xuXHR0aGlzLl9vcHRpb25zID0ge1xuXHRcdHRvcG9sb2d5OiA4XG5cdH07XG5cdGZvciAodmFyIHAgaW4gb3B0aW9ucykgeyB0aGlzLl9vcHRpb25zW3BdID0gb3B0aW9uc1twXTsgfVxufTtcblxuLyoqXG4gKiBDb21wdXRlIHZpc2liaWxpdHkgZm9yIGEgMzYwLWRlZ3JlZSBjaXJjbGVcbiAqIEBwYXJhbSB7aW50fSB4XG4gKiBAcGFyYW0ge2ludH0geVxuICogQHBhcmFtIHtpbnR9IFIgTWF4aW11bSB2aXNpYmlsaXR5IHJhZGl1c1xuICogQHBhcmFtIHtmdW5jdGlvbn0gY2FsbGJhY2tcbiAqL1xuUk9ULkZPVi5wcm90b3R5cGUuY29tcHV0ZSA9IGZ1bmN0aW9uKHgsIHksIFIsIGNhbGxiYWNrKSB7fTtcblxuLyoqXG4gKiBSZXR1cm4gYWxsIG5laWdoYm9ycyBpbiBhIGNvbmNlbnRyaWMgcmluZ1xuICogQHBhcmFtIHtpbnR9IGN4IGNlbnRlci14XG4gKiBAcGFyYW0ge2ludH0gY3kgY2VudGVyLXlcbiAqIEBwYXJhbSB7aW50fSByIHJhbmdlXG4gKi9cblJPVC5GT1YucHJvdG90eXBlLl9nZXRDaXJjbGUgPSBmdW5jdGlvbihjeCwgY3ksIHIpIHtcblx0dmFyIHJlc3VsdCA9IFtdO1xuXHR2YXIgZGlycywgY291bnRGYWN0b3IsIHN0YXJ0T2Zmc2V0O1xuXG5cdHN3aXRjaCAodGhpcy5fb3B0aW9ucy50b3BvbG9neSkge1xuXHRcdGNhc2UgNDpcblx0XHRcdGNvdW50RmFjdG9yID0gMTtcblx0XHRcdHN0YXJ0T2Zmc2V0ID0gWzAsIDFdO1xuXHRcdFx0ZGlycyA9IFtcblx0XHRcdFx0Uk9ULkRJUlNbOF1bN10sXG5cdFx0XHRcdFJPVC5ESVJTWzhdWzFdLFxuXHRcdFx0XHRST1QuRElSU1s4XVszXSxcblx0XHRcdFx0Uk9ULkRJUlNbOF1bNV1cblx0XHRcdF07XG5cdFx0YnJlYWs7XG5cblx0XHRjYXNlIDY6XG5cdFx0XHRkaXJzID0gUk9ULkRJUlNbNl07XG5cdFx0XHRjb3VudEZhY3RvciA9IDE7XG5cdFx0XHRzdGFydE9mZnNldCA9IFstMSwgMV07XG5cdFx0YnJlYWs7XG5cblx0XHRjYXNlIDg6XG5cdFx0XHRkaXJzID0gUk9ULkRJUlNbNF07XG5cdFx0XHRjb3VudEZhY3RvciA9IDI7XG5cdFx0XHRzdGFydE9mZnNldCA9IFstMSwgMV07XG5cdFx0YnJlYWs7XG5cdH1cblxuXHQvKiBzdGFydGluZyBuZWlnaGJvciAqL1xuXHR2YXIgeCA9IGN4ICsgc3RhcnRPZmZzZXRbMF0qcjtcblx0dmFyIHkgPSBjeSArIHN0YXJ0T2Zmc2V0WzFdKnI7XG5cblx0LyogY2lyY2xlICovXG5cdGZvciAodmFyIGk9MDtpPGRpcnMubGVuZ3RoO2krKykge1xuXHRcdGZvciAodmFyIGo9MDtqPHIqY291bnRGYWN0b3I7aisrKSB7XG5cdFx0XHRyZXN1bHQucHVzaChbeCwgeV0pO1xuXHRcdFx0eCArPSBkaXJzW2ldWzBdO1xuXHRcdFx0eSArPSBkaXJzW2ldWzFdO1xuXG5cdFx0fVxuXHR9XG5cblx0cmV0dXJuIHJlc3VsdDtcbn07XG4vKipcbiAqIEBjbGFzcyBEaXNjcmV0ZSBzaGFkb3djYXN0aW5nIGFsZ29yaXRobS4gT2Jzb2xldGVkIGJ5IFByZWNpc2Ugc2hhZG93Y2FzdGluZy5cbiAqIEBhdWdtZW50cyBST1QuRk9WXG4gKi9cblJPVC5GT1YuRGlzY3JldGVTaGFkb3djYXN0aW5nID0gZnVuY3Rpb24obGlnaHRQYXNzZXNDYWxsYmFjaywgb3B0aW9ucykge1xuXHRST1QuRk9WLmNhbGwodGhpcywgbGlnaHRQYXNzZXNDYWxsYmFjaywgb3B0aW9ucyk7XG59O1xuUk9ULkZPVi5EaXNjcmV0ZVNoYWRvd2Nhc3RpbmcuZXh0ZW5kKFJPVC5GT1YpO1xuXG4vKipcbiAqIEBzZWUgUk9ULkZPViNjb21wdXRlXG4gKi9cblJPVC5GT1YuRGlzY3JldGVTaGFkb3djYXN0aW5nLnByb3RvdHlwZS5jb21wdXRlID0gZnVuY3Rpb24oeCwgeSwgUiwgY2FsbGJhY2spIHtcblx0dmFyIGNlbnRlciA9IHRoaXMuX2Nvb3Jkcztcblx0dmFyIG1hcCA9IHRoaXMuX21hcDtcblxuXHQvKiB0aGlzIHBsYWNlIGlzIGFsd2F5cyB2aXNpYmxlICovXG5cdGNhbGxiYWNrKHgsIHksIDAsIDEpO1xuXG5cdC8qIHN0YW5kaW5nIGluIGEgZGFyayBwbGFjZS4gRklYTUUgaXMgdGhpcyBhIGdvb2QgaWRlYT8gICovXG5cdGlmICghdGhpcy5fbGlnaHRQYXNzZXMoeCwgeSkpIHsgcmV0dXJuOyB9XG5cdFxuXHQvKiBzdGFydCBhbmQgZW5kIGFuZ2xlcyAqL1xuXHR2YXIgREFUQSA9IFtdO1xuXHRcblx0dmFyIEEsIEIsIGN4LCBjeSwgYmxvY2tzO1xuXG5cdC8qIGFuYWx5emUgc3Vycm91bmRpbmcgY2VsbHMgaW4gY29uY2VudHJpYyByaW5ncywgc3RhcnRpbmcgZnJvbSB0aGUgY2VudGVyICovXG5cdGZvciAodmFyIHI9MTsgcjw9UjsgcisrKSB7XG5cdFx0dmFyIG5laWdoYm9ycyA9IHRoaXMuX2dldENpcmNsZSh4LCB5LCByKTtcblx0XHR2YXIgYW5nbGUgPSAzNjAgLyBuZWlnaGJvcnMubGVuZ3RoO1xuXG5cdFx0Zm9yICh2YXIgaT0wO2k8bmVpZ2hib3JzLmxlbmd0aDtpKyspIHtcblx0XHRcdGN4ID0gbmVpZ2hib3JzW2ldWzBdO1xuXHRcdFx0Y3kgPSBuZWlnaGJvcnNbaV1bMV07XG5cdFx0XHRBID0gYW5nbGUgKiAoaSAtIDAuNSk7XG5cdFx0XHRCID0gQSArIGFuZ2xlO1xuXHRcdFx0XG5cdFx0XHRibG9ja3MgPSAhdGhpcy5fbGlnaHRQYXNzZXMoY3gsIGN5KTtcblx0XHRcdGlmICh0aGlzLl92aXNpYmxlQ29vcmRzKE1hdGguZmxvb3IoQSksIE1hdGguY2VpbChCKSwgYmxvY2tzLCBEQVRBKSkgeyBjYWxsYmFjayhjeCwgY3ksIHIsIDEpOyB9XG5cdFx0XHRcblx0XHRcdGlmIChEQVRBLmxlbmd0aCA9PSAyICYmIERBVEFbMF0gPT0gMCAmJiBEQVRBWzFdID09IDM2MCkgeyByZXR1cm47IH0gLyogY3V0b2ZmPyAqL1xuXG5cdFx0fSAvKiBmb3IgYWxsIGNlbGxzIGluIHRoaXMgcmluZyAqL1xuXHR9IC8qIGZvciBhbGwgcmluZ3MgKi9cbn07XG5cbi8qKlxuICogQHBhcmFtIHtpbnR9IEEgc3RhcnQgYW5nbGVcbiAqIEBwYXJhbSB7aW50fSBCIGVuZCBhbmdsZVxuICogQHBhcmFtIHtib29sfSBibG9ja3MgRG9lcyBjdXJyZW50IGNlbGwgYmxvY2sgdmlzaWJpbGl0eT9cbiAqIEBwYXJhbSB7aW50W11bXX0gREFUQSBzaGFkb3dlZCBhbmdsZSBwYWlyc1xuICovXG5ST1QuRk9WLkRpc2NyZXRlU2hhZG93Y2FzdGluZy5wcm90b3R5cGUuX3Zpc2libGVDb29yZHMgPSBmdW5jdGlvbihBLCBCLCBibG9ja3MsIERBVEEpIHtcblx0aWYgKEEgPCAwKSB7IFxuXHRcdHZhciB2MSA9IHRoaXMuX3Zpc2libGVDb29yZHMoMCwgQiwgYmxvY2tzLCBEQVRBKTtcblx0XHR2YXIgdjIgPSB0aGlzLl92aXNpYmxlQ29vcmRzKDM2MCtBLCAzNjAsIGJsb2NrcywgREFUQSk7XG5cdFx0cmV0dXJuIHYxIHx8IHYyO1xuXHR9XG5cdFxuXHR2YXIgaW5kZXggPSAwO1xuXHR3aGlsZSAoaW5kZXggPCBEQVRBLmxlbmd0aCAmJiBEQVRBW2luZGV4XSA8IEEpIHsgaW5kZXgrKzsgfVxuXHRcblx0aWYgKGluZGV4ID09IERBVEEubGVuZ3RoKSB7IC8qIGNvbXBsZXRlbHkgbmV3IHNoYWRvdyAqL1xuXHRcdGlmIChibG9ja3MpIHsgREFUQS5wdXNoKEEsIEIpOyB9IFxuXHRcdHJldHVybiB0cnVlO1xuXHR9XG5cdFxuXHR2YXIgY291bnQgPSAwO1xuXHRcblx0aWYgKGluZGV4ICUgMikgeyAvKiB0aGlzIHNoYWRvdyBzdGFydHMgaW4gYW4gZXhpc3Rpbmcgc2hhZG93LCBvciB3aXRoaW4gaXRzIGVuZGluZyBib3VuZGFyeSAqL1xuXHRcdHdoaWxlIChpbmRleCA8IERBVEEubGVuZ3RoICYmIERBVEFbaW5kZXhdIDwgQikge1xuXHRcdFx0aW5kZXgrKztcblx0XHRcdGNvdW50Kys7XG5cdFx0fVxuXHRcdFxuXHRcdGlmIChjb3VudCA9PSAwKSB7IHJldHVybiBmYWxzZTsgfVxuXHRcdFxuXHRcdGlmIChibG9ja3MpIHsgXG5cdFx0XHRpZiAoY291bnQgJSAyKSB7XG5cdFx0XHRcdERBVEEuc3BsaWNlKGluZGV4LWNvdW50LCBjb3VudCwgQik7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHREQVRBLnNwbGljZShpbmRleC1jb3VudCwgY291bnQpO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHRyZXR1cm4gdHJ1ZTtcblxuXHR9IGVsc2UgeyAvKiB0aGlzIHNoYWRvdyBzdGFydHMgb3V0c2lkZSBhbiBleGlzdGluZyBzaGFkb3csIG9yIHdpdGhpbiBhIHN0YXJ0aW5nIGJvdW5kYXJ5ICovXG5cdFx0d2hpbGUgKGluZGV4IDwgREFUQS5sZW5ndGggJiYgREFUQVtpbmRleF0gPCBCKSB7XG5cdFx0XHRpbmRleCsrO1xuXHRcdFx0Y291bnQrKztcblx0XHR9XG5cdFx0XG5cdFx0LyogdmlzaWJsZSB3aGVuIG91dHNpZGUgYW4gZXhpc3Rpbmcgc2hhZG93LCBvciB3aGVuIG92ZXJsYXBwaW5nICovXG5cdFx0aWYgKEEgPT0gREFUQVtpbmRleC1jb3VudF0gJiYgY291bnQgPT0gMSkgeyByZXR1cm4gZmFsc2U7IH1cblx0XHRcblx0XHRpZiAoYmxvY2tzKSB7IFxuXHRcdFx0aWYgKGNvdW50ICUgMikge1xuXHRcdFx0XHREQVRBLnNwbGljZShpbmRleC1jb3VudCwgY291bnQsIEEpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0REFUQS5zcGxpY2UoaW5kZXgtY291bnQsIGNvdW50LCBBLCBCKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0XHRcblx0XHRyZXR1cm4gdHJ1ZTtcblx0fVxufTtcbi8qKlxuICogQGNsYXNzIFByZWNpc2Ugc2hhZG93Y2FzdGluZyBhbGdvcml0aG1cbiAqIEBhdWdtZW50cyBST1QuRk9WXG4gKi9cblJPVC5GT1YuUHJlY2lzZVNoYWRvd2Nhc3RpbmcgPSBmdW5jdGlvbihsaWdodFBhc3Nlc0NhbGxiYWNrLCBvcHRpb25zKSB7XG5cdFJPVC5GT1YuY2FsbCh0aGlzLCBsaWdodFBhc3Nlc0NhbGxiYWNrLCBvcHRpb25zKTtcbn07XG5ST1QuRk9WLlByZWNpc2VTaGFkb3djYXN0aW5nLmV4dGVuZChST1QuRk9WKTtcblxuLyoqXG4gKiBAc2VlIFJPVC5GT1YjY29tcHV0ZVxuICovXG5ST1QuRk9WLlByZWNpc2VTaGFkb3djYXN0aW5nLnByb3RvdHlwZS5jb21wdXRlID0gZnVuY3Rpb24oeCwgeSwgUiwgY2FsbGJhY2spIHtcblx0LyogdGhpcyBwbGFjZSBpcyBhbHdheXMgdmlzaWJsZSAqL1xuXHRjYWxsYmFjayh4LCB5LCAwLCAxKTtcblxuXHQvKiBzdGFuZGluZyBpbiBhIGRhcmsgcGxhY2UuIEZJWE1FIGlzIHRoaXMgYSBnb29kIGlkZWE/ICAqL1xuXHRpZiAoIXRoaXMuX2xpZ2h0UGFzc2VzKHgsIHkpKSB7IHJldHVybjsgfVxuXHRcblx0LyogbGlzdCBvZiBhbGwgc2hhZG93cyAqL1xuXHR2YXIgU0hBRE9XUyA9IFtdO1xuXHRcblx0dmFyIGN4LCBjeSwgYmxvY2tzLCBBMSwgQTIsIHZpc2liaWxpdHk7XG5cblx0LyogYW5hbHl6ZSBzdXJyb3VuZGluZyBjZWxscyBpbiBjb25jZW50cmljIHJpbmdzLCBzdGFydGluZyBmcm9tIHRoZSBjZW50ZXIgKi9cblx0Zm9yICh2YXIgcj0xOyByPD1SOyByKyspIHtcblx0XHR2YXIgbmVpZ2hib3JzID0gdGhpcy5fZ2V0Q2lyY2xlKHgsIHksIHIpO1xuXHRcdHZhciBuZWlnaGJvckNvdW50ID0gbmVpZ2hib3JzLmxlbmd0aDtcblxuXHRcdGZvciAodmFyIGk9MDtpPG5laWdoYm9yQ291bnQ7aSsrKSB7XG5cdFx0XHRjeCA9IG5laWdoYm9yc1tpXVswXTtcblx0XHRcdGN5ID0gbmVpZ2hib3JzW2ldWzFdO1xuXHRcdFx0Lyogc2hpZnQgaGFsZi1hbi1hbmdsZSBiYWNrd2FyZHMgdG8gbWFpbnRhaW4gY29uc2lzdGVuY3kgb2YgMC10aCBjZWxscyAqL1xuXHRcdFx0QTEgPSBbaSA/IDIqaS0xIDogMipuZWlnaGJvckNvdW50LTEsIDIqbmVpZ2hib3JDb3VudF07XG5cdFx0XHRBMiA9IFsyKmkrMSwgMipuZWlnaGJvckNvdW50XTsgXG5cdFx0XHRcblx0XHRcdGJsb2NrcyA9ICF0aGlzLl9saWdodFBhc3NlcyhjeCwgY3kpO1xuXHRcdFx0dmlzaWJpbGl0eSA9IHRoaXMuX2NoZWNrVmlzaWJpbGl0eShBMSwgQTIsIGJsb2NrcywgU0hBRE9XUyk7XG5cdFx0XHRpZiAodmlzaWJpbGl0eSkgeyBjYWxsYmFjayhjeCwgY3ksIHIsIHZpc2liaWxpdHkpOyB9XG5cblx0XHRcdGlmIChTSEFET1dTLmxlbmd0aCA9PSAyICYmIFNIQURPV1NbMF1bMF0gPT0gMCAmJiBTSEFET1dTWzFdWzBdID09IFNIQURPV1NbMV1bMV0pIHsgcmV0dXJuOyB9IC8qIGN1dG9mZj8gKi9cblxuXHRcdH0gLyogZm9yIGFsbCBjZWxscyBpbiB0aGlzIHJpbmcgKi9cblx0fSAvKiBmb3IgYWxsIHJpbmdzICovXG59O1xuXG4vKipcbiAqIEBwYXJhbSB7aW50WzJdfSBBMSBhcmMgc3RhcnRcbiAqIEBwYXJhbSB7aW50WzJdfSBBMiBhcmMgZW5kXG4gKiBAcGFyYW0ge2Jvb2x9IGJsb2NrcyBEb2VzIGN1cnJlbnQgYXJjIGJsb2NrIHZpc2liaWxpdHk/XG4gKiBAcGFyYW0ge2ludFtdW119IFNIQURPV1MgbGlzdCBvZiBhY3RpdmUgc2hhZG93c1xuICovXG5ST1QuRk9WLlByZWNpc2VTaGFkb3djYXN0aW5nLnByb3RvdHlwZS5fY2hlY2tWaXNpYmlsaXR5ID0gZnVuY3Rpb24oQTEsIEEyLCBibG9ja3MsIFNIQURPV1MpIHtcblx0aWYgKEExWzBdID4gQTJbMF0pIHsgLyogc3BsaXQgaW50byB0d28gc3ViLWFyY3MgKi9cblx0XHR2YXIgdjEgPSB0aGlzLl9jaGVja1Zpc2liaWxpdHkoQTEsIFtBMVsxXSwgQTFbMV1dLCBibG9ja3MsIFNIQURPV1MpO1xuXHRcdHZhciB2MiA9IHRoaXMuX2NoZWNrVmlzaWJpbGl0eShbMCwgMV0sIEEyLCBibG9ja3MsIFNIQURPV1MpO1xuXHRcdHJldHVybiAodjErdjIpLzI7XG5cdH1cblxuXHQvKiBpbmRleDE6IGZpcnN0IHNoYWRvdyA+PSBBMSAqL1xuXHR2YXIgaW5kZXgxID0gMCwgZWRnZTEgPSBmYWxzZTtcblx0d2hpbGUgKGluZGV4MSA8IFNIQURPV1MubGVuZ3RoKSB7XG5cdFx0dmFyIG9sZCA9IFNIQURPV1NbaW5kZXgxXTtcblx0XHR2YXIgZGlmZiA9IG9sZFswXSpBMVsxXSAtIEExWzBdKm9sZFsxXTtcblx0XHRpZiAoZGlmZiA+PSAwKSB7IC8qIG9sZCA+PSBBMSAqL1xuXHRcdFx0aWYgKGRpZmYgPT0gMCAmJiAhKGluZGV4MSAlIDIpKSB7IGVkZ2UxID0gdHJ1ZTsgfVxuXHRcdFx0YnJlYWs7XG5cdFx0fVxuXHRcdGluZGV4MSsrO1xuXHR9XG5cblx0LyogaW5kZXgyOiBsYXN0IHNoYWRvdyA8PSBBMiAqL1xuXHR2YXIgaW5kZXgyID0gU0hBRE9XUy5sZW5ndGgsIGVkZ2UyID0gZmFsc2U7XG5cdHdoaWxlIChpbmRleDItLSkge1xuXHRcdHZhciBvbGQgPSBTSEFET1dTW2luZGV4Ml07XG5cdFx0dmFyIGRpZmYgPSBBMlswXSpvbGRbMV0gLSBvbGRbMF0qQTJbMV07XG5cdFx0aWYgKGRpZmYgPj0gMCkgeyAvKiBvbGQgPD0gQTIgKi9cblx0XHRcdGlmIChkaWZmID09IDAgJiYgKGluZGV4MiAlIDIpKSB7IGVkZ2UyID0gdHJ1ZTsgfVxuXHRcdFx0YnJlYWs7XG5cdFx0fVxuXHR9XG5cblx0dmFyIHZpc2libGUgPSB0cnVlO1xuXHRpZiAoaW5kZXgxID09IGluZGV4MiAmJiAoZWRnZTEgfHwgZWRnZTIpKSB7ICAvKiBzdWJzZXQgb2YgZXhpc3Rpbmcgc2hhZG93LCBvbmUgb2YgdGhlIGVkZ2VzIG1hdGNoICovXG5cdFx0dmlzaWJsZSA9IGZhbHNlOyBcblx0fSBlbHNlIGlmIChlZGdlMSAmJiBlZGdlMiAmJiBpbmRleDErMT09aW5kZXgyICYmIChpbmRleDIgJSAyKSkgeyAvKiBjb21wbGV0ZWx5IGVxdWl2YWxlbnQgd2l0aCBleGlzdGluZyBzaGFkb3cgKi9cblx0XHR2aXNpYmxlID0gZmFsc2U7XG5cdH0gZWxzZSBpZiAoaW5kZXgxID4gaW5kZXgyICYmIChpbmRleDEgJSAyKSkgeyAvKiBzdWJzZXQgb2YgZXhpc3Rpbmcgc2hhZG93LCBub3QgdG91Y2hpbmcgKi9cblx0XHR2aXNpYmxlID0gZmFsc2U7XG5cdH1cblx0XG5cdGlmICghdmlzaWJsZSkgeyByZXR1cm4gMDsgfSAvKiBmYXN0IGNhc2U6IG5vdCB2aXNpYmxlICovXG5cdFxuXHR2YXIgdmlzaWJsZUxlbmd0aCwgUDtcblxuXHQvKiBjb21wdXRlIHRoZSBsZW5ndGggb2YgdmlzaWJsZSBhcmMsIGFkanVzdCBsaXN0IG9mIHNoYWRvd3MgKGlmIGJsb2NraW5nKSAqL1xuXHR2YXIgcmVtb3ZlID0gaW5kZXgyLWluZGV4MSsxO1xuXHRpZiAocmVtb3ZlICUgMikge1xuXHRcdGlmIChpbmRleDEgJSAyKSB7IC8qIGZpcnN0IGVkZ2Ugd2l0aGluIGV4aXN0aW5nIHNoYWRvdywgc2Vjb25kIG91dHNpZGUgKi9cblx0XHRcdHZhciBQID0gU0hBRE9XU1tpbmRleDFdO1xuXHRcdFx0dmlzaWJsZUxlbmd0aCA9IChBMlswXSpQWzFdIC0gUFswXSpBMlsxXSkgLyAoUFsxXSAqIEEyWzFdKTtcblx0XHRcdGlmIChibG9ja3MpIHsgU0hBRE9XUy5zcGxpY2UoaW5kZXgxLCByZW1vdmUsIEEyKTsgfVxuXHRcdH0gZWxzZSB7IC8qIHNlY29uZCBlZGdlIHdpdGhpbiBleGlzdGluZyBzaGFkb3csIGZpcnN0IG91dHNpZGUgKi9cblx0XHRcdHZhciBQID0gU0hBRE9XU1tpbmRleDJdO1xuXHRcdFx0dmlzaWJsZUxlbmd0aCA9IChQWzBdKkExWzFdIC0gQTFbMF0qUFsxXSkgLyAoQTFbMV0gKiBQWzFdKTtcblx0XHRcdGlmIChibG9ja3MpIHsgU0hBRE9XUy5zcGxpY2UoaW5kZXgxLCByZW1vdmUsIEExKTsgfVxuXHRcdH1cblx0fSBlbHNlIHtcblx0XHRpZiAoaW5kZXgxICUgMikgeyAvKiBib3RoIGVkZ2VzIHdpdGhpbiBleGlzdGluZyBzaGFkb3dzICovXG5cdFx0XHR2YXIgUDEgPSBTSEFET1dTW2luZGV4MV07XG5cdFx0XHR2YXIgUDIgPSBTSEFET1dTW2luZGV4Ml07XG5cdFx0XHR2aXNpYmxlTGVuZ3RoID0gKFAyWzBdKlAxWzFdIC0gUDFbMF0qUDJbMV0pIC8gKFAxWzFdICogUDJbMV0pO1xuXHRcdFx0aWYgKGJsb2NrcykgeyBTSEFET1dTLnNwbGljZShpbmRleDEsIHJlbW92ZSk7IH1cblx0XHR9IGVsc2UgeyAvKiBib3RoIGVkZ2VzIG91dHNpZGUgZXhpc3Rpbmcgc2hhZG93cyAqL1xuXHRcdFx0aWYgKGJsb2NrcykgeyBTSEFET1dTLnNwbGljZShpbmRleDEsIHJlbW92ZSwgQTEsIEEyKTsgfVxuXHRcdFx0cmV0dXJuIDE7IC8qIHdob2xlIGFyYyB2aXNpYmxlISAqL1xuXHRcdH1cblx0fVxuXG5cdHZhciBhcmNMZW5ndGggPSAoQTJbMF0qQTFbMV0gLSBBMVswXSpBMlsxXSkgLyAoQTFbMV0gKiBBMlsxXSk7XG5cblx0cmV0dXJuIHZpc2libGVMZW5ndGgvYXJjTGVuZ3RoO1xufTtcbi8qKlxuICogQGNsYXNzIFJlY3Vyc2l2ZSBzaGFkb3djYXN0aW5nIGFsZ29yaXRobVxuICogQ3VycmVudGx5IG9ubHkgc3VwcG9ydHMgNC84IHRvcG9sb2dpZXMsIG5vdCBoZXhhZ29uYWwuXG4gKiBCYXNlZCBvbiBQZXRlciBIYXJraW5zJyBpbXBsZW1lbnRhdGlvbiBvZiBCasO2cm4gQmVyZ3N0csO2bSdzIGFsZ29yaXRobSBkZXNjcmliZWQgaGVyZTogaHR0cDovL3d3dy5yb2d1ZWJhc2luLmNvbS9pbmRleC5waHA/dGl0bGU9Rk9WX3VzaW5nX3JlY3Vyc2l2ZV9zaGFkb3djYXN0aW5nXG4gKiBAYXVnbWVudHMgUk9ULkZPVlxuICovXG5ST1QuRk9WLlJlY3Vyc2l2ZVNoYWRvd2Nhc3RpbmcgPSBmdW5jdGlvbihsaWdodFBhc3Nlc0NhbGxiYWNrLCBvcHRpb25zKSB7XG5cdFJPVC5GT1YuY2FsbCh0aGlzLCBsaWdodFBhc3Nlc0NhbGxiYWNrLCBvcHRpb25zKTtcbn07XG5ST1QuRk9WLlJlY3Vyc2l2ZVNoYWRvd2Nhc3RpbmcuZXh0ZW5kKFJPVC5GT1YpO1xuXG4vKiogT2N0YW50cyB1c2VkIGZvciB0cmFuc2xhdGluZyByZWN1cnNpdmUgc2hhZG93Y2FzdGluZyBvZmZzZXRzICovXG5ST1QuRk9WLlJlY3Vyc2l2ZVNoYWRvd2Nhc3RpbmcuT0NUQU5UUyA9IFtcblx0Wy0xLCAgMCwgIDAsICAxXSxcblx0WyAwLCAtMSwgIDEsICAwXSxcblx0WyAwLCAtMSwgLTEsICAwXSxcblx0Wy0xLCAgMCwgIDAsIC0xXSxcblx0WyAxLCAgMCwgIDAsIC0xXSxcblx0WyAwLCAgMSwgLTEsICAwXSxcblx0WyAwLCAgMSwgIDEsICAwXSxcblx0WyAxLCAgMCwgIDAsICAxXVxuXTtcblxuLyoqXG4gKiBDb21wdXRlIHZpc2liaWxpdHkgZm9yIGEgMzYwLWRlZ3JlZSBjaXJjbGVcbiAqIEBwYXJhbSB7aW50fSB4XG4gKiBAcGFyYW0ge2ludH0geVxuICogQHBhcmFtIHtpbnR9IFIgTWF4aW11bSB2aXNpYmlsaXR5IHJhZGl1c1xuICogQHBhcmFtIHtmdW5jdGlvbn0gY2FsbGJhY2tcbiAqL1xuUk9ULkZPVi5SZWN1cnNpdmVTaGFkb3djYXN0aW5nLnByb3RvdHlwZS5jb21wdXRlID0gZnVuY3Rpb24oeCwgeSwgUiwgY2FsbGJhY2spIHtcblx0Ly9Zb3UgY2FuIGFsd2F5cyBzZWUgeW91ciBvd24gdGlsZVxuXHRjYWxsYmFjayh4LCB5LCAwLCAxKTtcblx0Zm9yKHZhciBpID0gMDsgaSA8IFJPVC5GT1YuUmVjdXJzaXZlU2hhZG93Y2FzdGluZy5PQ1RBTlRTLmxlbmd0aDsgaSsrKSB7XG5cdFx0dGhpcy5fcmVuZGVyT2N0YW50KHgsIHksIFJPVC5GT1YuUmVjdXJzaXZlU2hhZG93Y2FzdGluZy5PQ1RBTlRTW2ldLCBSLCBjYWxsYmFjayk7XG5cdH1cbn07XG5cbi8qKlxuICogQ29tcHV0ZSB2aXNpYmlsaXR5IGZvciBhIDE4MC1kZWdyZWUgYXJjXG4gKiBAcGFyYW0ge2ludH0geFxuICogQHBhcmFtIHtpbnR9IHlcbiAqIEBwYXJhbSB7aW50fSBSIE1heGltdW0gdmlzaWJpbGl0eSByYWRpdXNcbiAqIEBwYXJhbSB7aW50fSBkaXIgRGlyZWN0aW9uIHRvIGxvb2sgaW4gKGV4cHJlc3NlZCBpbiBhIFJPVC5ESVJTIHZhbHVlKTtcbiAqIEBwYXJhbSB7ZnVuY3Rpb259IGNhbGxiYWNrXG4gKi9cblJPVC5GT1YuUmVjdXJzaXZlU2hhZG93Y2FzdGluZy5wcm90b3R5cGUuY29tcHV0ZTE4MCA9IGZ1bmN0aW9uKHgsIHksIFIsIGRpciwgY2FsbGJhY2spIHtcblx0Ly9Zb3UgY2FuIGFsd2F5cyBzZWUgeW91ciBvd24gdGlsZVxuXHRjYWxsYmFjayh4LCB5LCAwLCAxKTtcblx0dmFyIHByZXZpb3VzT2N0YW50ID0gKGRpciAtIDEgKyA4KSAlIDg7IC8vTmVlZCB0byByZXRyaWV2ZSB0aGUgcHJldmlvdXMgb2N0YW50IHRvIHJlbmRlciBhIGZ1bGwgMTgwIGRlZ3JlZXNcblx0dmFyIG5leHRQcmV2aW91c09jdGFudCA9IChkaXIgLSAyICsgOCkgJSA4OyAvL05lZWQgdG8gcmV0cmlldmUgdGhlIHByZXZpb3VzIHR3byBvY3RhbnRzIHRvIHJlbmRlciBhIGZ1bGwgMTgwIGRlZ3JlZXNcblx0dmFyIG5leHRPY3RhbnQgPSAoZGlyKyAxICsgOCkgJSA4OyAvL05lZWQgdG8gZ3JhYiB0byBuZXh0IG9jdGFudCB0byByZW5kZXIgYSBmdWxsIDE4MCBkZWdyZWVzXG5cdHRoaXMuX3JlbmRlck9jdGFudCh4LCB5LCBST1QuRk9WLlJlY3Vyc2l2ZVNoYWRvd2Nhc3RpbmcuT0NUQU5UU1tuZXh0UHJldmlvdXNPY3RhbnRdLCBSLCBjYWxsYmFjayk7XG5cdHRoaXMuX3JlbmRlck9jdGFudCh4LCB5LCBST1QuRk9WLlJlY3Vyc2l2ZVNoYWRvd2Nhc3RpbmcuT0NUQU5UU1twcmV2aW91c09jdGFudF0sIFIsIGNhbGxiYWNrKTtcblx0dGhpcy5fcmVuZGVyT2N0YW50KHgsIHksIFJPVC5GT1YuUmVjdXJzaXZlU2hhZG93Y2FzdGluZy5PQ1RBTlRTW2Rpcl0sIFIsIGNhbGxiYWNrKTtcblx0dGhpcy5fcmVuZGVyT2N0YW50KHgsIHksIFJPVC5GT1YuUmVjdXJzaXZlU2hhZG93Y2FzdGluZy5PQ1RBTlRTW25leHRPY3RhbnRdLCBSLCBjYWxsYmFjayk7XG59O1xuXG4vKipcbiAqIENvbXB1dGUgdmlzaWJpbGl0eSBmb3IgYSA5MC1kZWdyZWUgYXJjXG4gKiBAcGFyYW0ge2ludH0geFxuICogQHBhcmFtIHtpbnR9IHlcbiAqIEBwYXJhbSB7aW50fSBSIE1heGltdW0gdmlzaWJpbGl0eSByYWRpdXNcbiAqIEBwYXJhbSB7aW50fSBkaXIgRGlyZWN0aW9uIHRvIGxvb2sgaW4gKGV4cHJlc3NlZCBpbiBhIFJPVC5ESVJTIHZhbHVlKTtcbiAqIEBwYXJhbSB7ZnVuY3Rpb259IGNhbGxiYWNrXG4gKi9cblJPVC5GT1YuUmVjdXJzaXZlU2hhZG93Y2FzdGluZy5wcm90b3R5cGUuY29tcHV0ZTkwID0gZnVuY3Rpb24oeCwgeSwgUiwgZGlyLCBjYWxsYmFjaykge1xuXHQvL1lvdSBjYW4gYWx3YXlzIHNlZSB5b3VyIG93biB0aWxlXG5cdGNhbGxiYWNrKHgsIHksIDAsIDEpO1xuXHR2YXIgcHJldmlvdXNPY3RhbnQgPSAoZGlyIC0gMSArIDgpICUgODsgLy9OZWVkIHRvIHJldHJpZXZlIHRoZSBwcmV2aW91cyBvY3RhbnQgdG8gcmVuZGVyIGEgZnVsbCA5MCBkZWdyZWVzXG5cdHRoaXMuX3JlbmRlck9jdGFudCh4LCB5LCBST1QuRk9WLlJlY3Vyc2l2ZVNoYWRvd2Nhc3RpbmcuT0NUQU5UU1tkaXJdLCBSLCBjYWxsYmFjayk7XG5cdHRoaXMuX3JlbmRlck9jdGFudCh4LCB5LCBST1QuRk9WLlJlY3Vyc2l2ZVNoYWRvd2Nhc3RpbmcuT0NUQU5UU1twcmV2aW91c09jdGFudF0sIFIsIGNhbGxiYWNrKTtcbn07XG5cbi8qKlxuICogUmVuZGVyIG9uZSBvY3RhbnQgKDQ1LWRlZ3JlZSBhcmMpIG9mIHRoZSB2aWV3c2hlZFxuICogQHBhcmFtIHtpbnR9IHhcbiAqIEBwYXJhbSB7aW50fSB5XG4gKiBAcGFyYW0ge2ludH0gb2N0YW50IE9jdGFudCB0byBiZSByZW5kZXJlZFxuICogQHBhcmFtIHtpbnR9IFIgTWF4aW11bSB2aXNpYmlsaXR5IHJhZGl1c1xuICogQHBhcmFtIHtmdW5jdGlvbn0gY2FsbGJhY2tcbiAqL1xuUk9ULkZPVi5SZWN1cnNpdmVTaGFkb3djYXN0aW5nLnByb3RvdHlwZS5fcmVuZGVyT2N0YW50ID0gZnVuY3Rpb24oeCwgeSwgb2N0YW50LCBSLCBjYWxsYmFjaykge1xuXHQvL1JhZGl1cyBpbmNyZW1lbnRlZCBieSAxIHRvIHByb3ZpZGUgc2FtZSBjb3ZlcmFnZSBhcmVhIGFzIG90aGVyIHNoYWRvd2Nhc3RpbmcgcmFkaXVzZXNcblx0dGhpcy5fY2FzdFZpc2liaWxpdHkoeCwgeSwgMSwgMS4wLCAwLjAsIFIgKyAxLCBvY3RhbnRbMF0sIG9jdGFudFsxXSwgb2N0YW50WzJdLCBvY3RhbnRbM10sIGNhbGxiYWNrKTtcbn07XG5cbi8qKlxuICogQWN0dWFsbHkgY2FsY3VsYXRlcyB0aGUgdmlzaWJpbGl0eVxuICogQHBhcmFtIHtpbnR9IHN0YXJ0WCBUaGUgc3RhcnRpbmcgWCBjb29yZGluYXRlXG4gKiBAcGFyYW0ge2ludH0gc3RhcnRZIFRoZSBzdGFydGluZyBZIGNvb3JkaW5hdGVcbiAqIEBwYXJhbSB7aW50fSByb3cgVGhlIHJvdyB0byByZW5kZXJcbiAqIEBwYXJhbSB7ZmxvYXR9IHZpc1Nsb3BlU3RhcnQgVGhlIHNsb3BlIHRvIHN0YXJ0IGF0XG4gKiBAcGFyYW0ge2Zsb2F0fSB2aXNTbG9wZUVuZCBUaGUgc2xvcGUgdG8gZW5kIGF0XG4gKiBAcGFyYW0ge2ludH0gcmFkaXVzIFRoZSByYWRpdXMgdG8gcmVhY2ggb3V0IHRvXG4gKiBAcGFyYW0ge2ludH0geHggXG4gKiBAcGFyYW0ge2ludH0geHkgXG4gKiBAcGFyYW0ge2ludH0geXggXG4gKiBAcGFyYW0ge2ludH0geXkgXG4gKiBAcGFyYW0ge2Z1bmN0aW9ufSBjYWxsYmFjayBUaGUgY2FsbGJhY2sgdG8gdXNlIHdoZW4gd2UgaGl0IGEgYmxvY2sgdGhhdCBpcyB2aXNpYmxlXG4gKi9cblJPVC5GT1YuUmVjdXJzaXZlU2hhZG93Y2FzdGluZy5wcm90b3R5cGUuX2Nhc3RWaXNpYmlsaXR5ID0gZnVuY3Rpb24oc3RhcnRYLCBzdGFydFksIHJvdywgdmlzU2xvcGVTdGFydCwgdmlzU2xvcGVFbmQsIHJhZGl1cywgeHgsIHh5LCB5eCwgeXksIGNhbGxiYWNrKSB7XG5cdGlmKHZpc1Nsb3BlU3RhcnQgPCB2aXNTbG9wZUVuZCkgeyByZXR1cm47IH1cblx0Zm9yKHZhciBpID0gcm93OyBpIDw9IHJhZGl1czsgaSsrKSB7XG5cdFx0dmFyIGR4ID0gLWkgLSAxO1xuXHRcdHZhciBkeSA9IC1pO1xuXHRcdHZhciBibG9ja2VkID0gZmFsc2U7XG5cdFx0dmFyIG5ld1N0YXJ0ID0gMDtcblxuXHRcdC8vJ1JvdycgY291bGQgYmUgY29sdW1uLCBuYW1lcyBoZXJlIGFzc3VtZSBvY3RhbnQgMCBhbmQgd291bGQgYmUgZmxpcHBlZCBmb3IgaGFsZiB0aGUgb2N0YW50c1xuXHRcdHdoaWxlKGR4IDw9IDApIHtcblx0XHRcdGR4ICs9IDE7XG5cblx0XHRcdC8vVHJhbnNsYXRlIGZyb20gcmVsYXRpdmUgY29vcmRpbmF0ZXMgdG8gbWFwIGNvb3JkaW5hdGVzXG5cdFx0XHR2YXIgbWFwWCA9IHN0YXJ0WCArIGR4ICogeHggKyBkeSAqIHh5O1xuXHRcdFx0dmFyIG1hcFkgPSBzdGFydFkgKyBkeCAqIHl4ICsgZHkgKiB5eTtcblxuXHRcdFx0Ly9SYW5nZSBvZiB0aGUgcm93XG5cdFx0XHR2YXIgc2xvcGVTdGFydCA9IChkeCAtIDAuNSkgLyAoZHkgKyAwLjUpO1xuXHRcdFx0dmFyIHNsb3BlRW5kID0gKGR4ICsgMC41KSAvIChkeSAtIDAuNSk7XG5cdFx0XG5cdFx0XHQvL0lnbm9yZSBpZiBub3QgeWV0IGF0IGxlZnQgZWRnZSBvZiBPY3RhbnRcblx0XHRcdGlmKHNsb3BlRW5kID4gdmlzU2xvcGVTdGFydCkgeyBjb250aW51ZTsgfVxuXHRcdFx0XG5cdFx0XHQvL0RvbmUgaWYgcGFzdCByaWdodCBlZGdlXG5cdFx0XHRpZihzbG9wZVN0YXJ0IDwgdmlzU2xvcGVFbmQpIHsgYnJlYWs7IH1cblx0XHRcdFx0XG5cdFx0XHQvL0lmIGl0J3MgaW4gcmFuZ2UsIGl0J3MgdmlzaWJsZVxuXHRcdFx0aWYoKGR4ICogZHggKyBkeSAqIGR5KSA8IChyYWRpdXMgKiByYWRpdXMpKSB7XG5cdFx0XHRcdGNhbGxiYWNrKG1hcFgsIG1hcFksIGksIDEpO1xuXHRcdFx0fVxuXHRcblx0XHRcdGlmKCFibG9ja2VkKSB7XG5cdFx0XHRcdC8vSWYgdGlsZSBpcyBhIGJsb2NraW5nIHRpbGUsIGNhc3QgYXJvdW5kIGl0XG5cdFx0XHRcdGlmKCF0aGlzLl9saWdodFBhc3NlcyhtYXBYLCBtYXBZKSAmJiBpIDwgcmFkaXVzKSB7XG5cdFx0XHRcdFx0YmxvY2tlZCA9IHRydWU7XG5cdFx0XHRcdFx0dGhpcy5fY2FzdFZpc2liaWxpdHkoc3RhcnRYLCBzdGFydFksIGkgKyAxLCB2aXNTbG9wZVN0YXJ0LCBzbG9wZVN0YXJ0LCByYWRpdXMsIHh4LCB4eSwgeXgsIHl5LCBjYWxsYmFjayk7XG5cdFx0XHRcdFx0bmV3U3RhcnQgPSBzbG9wZUVuZDtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly9LZWVwIG5hcnJvd2luZyBpZiBzY2FubmluZyBhY3Jvc3MgYSBibG9ja1xuXHRcdFx0XHRpZighdGhpcy5fbGlnaHRQYXNzZXMobWFwWCwgbWFwWSkpIHtcblx0XHRcdFx0XHRuZXdTdGFydCA9IHNsb3BlRW5kO1xuXHRcdFx0XHRcdGNvbnRpbnVlO1xuXHRcdFx0XHR9XG5cdFx0XHRcblx0XHRcdFx0Ly9CbG9jayBoYXMgZW5kZWRcblx0XHRcdFx0YmxvY2tlZCA9IGZhbHNlO1xuXHRcdFx0XHR2aXNTbG9wZVN0YXJ0ID0gbmV3U3RhcnQ7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdGlmKGJsb2NrZWQpIHsgYnJlYWs7IH1cblx0fVxufTtcbi8qKlxuICogQG5hbWVzcGFjZSBDb2xvciBvcGVyYXRpb25zXG4gKi9cblJPVC5Db2xvciA9IHtcblx0ZnJvbVN0cmluZzogZnVuY3Rpb24oc3RyKSB7XG5cdFx0dmFyIGNhY2hlZCwgcjtcblx0XHRpZiAoc3RyIGluIHRoaXMuX2NhY2hlKSB7XG5cdFx0XHRjYWNoZWQgPSB0aGlzLl9jYWNoZVtzdHJdO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRpZiAoc3RyLmNoYXJBdCgwKSA9PSBcIiNcIikgeyAvKiBoZXggcmdiICovXG5cblx0XHRcdFx0dmFyIHZhbHVlcyA9IHN0ci5tYXRjaCgvWzAtOWEtZl0vZ2kpLm1hcChmdW5jdGlvbih4KSB7IHJldHVybiBwYXJzZUludCh4LCAxNik7IH0pO1xuXHRcdFx0XHRpZiAodmFsdWVzLmxlbmd0aCA9PSAzKSB7XG5cdFx0XHRcdFx0Y2FjaGVkID0gdmFsdWVzLm1hcChmdW5jdGlvbih4KSB7IHJldHVybiB4KjE3OyB9KTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRmb3IgKHZhciBpPTA7aTwzO2krKykge1xuXHRcdFx0XHRcdFx0dmFsdWVzW2krMV0gKz0gMTYqdmFsdWVzW2ldO1xuXHRcdFx0XHRcdFx0dmFsdWVzLnNwbGljZShpLCAxKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0Y2FjaGVkID0gdmFsdWVzO1xuXHRcdFx0XHR9XG5cblx0XHRcdH0gZWxzZSBpZiAoKHIgPSBzdHIubWF0Y2goL3JnYlxcKChbMC05LCBdKylcXCkvaSkpKSB7IC8qIGRlY2ltYWwgcmdiICovXG5cdFx0XHRcdGNhY2hlZCA9IHJbMV0uc3BsaXQoL1xccyosXFxzKi8pLm1hcChmdW5jdGlvbih4KSB7IHJldHVybiBwYXJzZUludCh4KTsgfSk7XG5cdFx0XHR9IGVsc2UgeyAvKiBodG1sIG5hbWUgKi9cblx0XHRcdFx0Y2FjaGVkID0gWzAsIDAsIDBdO1xuXHRcdFx0fVxuXG5cdFx0XHR0aGlzLl9jYWNoZVtzdHJdID0gY2FjaGVkO1xuXHRcdH1cblxuXHRcdHJldHVybiBjYWNoZWQuc2xpY2UoKTtcblx0fSxcblxuXHQvKipcblx0ICogQWRkIHR3byBvciBtb3JlIGNvbG9yc1xuXHQgKiBAcGFyYW0ge251bWJlcltdfSBjb2xvcjFcblx0ICogQHBhcmFtIHtudW1iZXJbXX0gY29sb3IyXG5cdCAqIEByZXR1cm5zIHtudW1iZXJbXX1cblx0ICovXG5cdGFkZDogZnVuY3Rpb24oY29sb3IxLCBjb2xvcjIpIHtcblx0XHR2YXIgcmVzdWx0ID0gY29sb3IxLnNsaWNlKCk7XG5cdFx0Zm9yICh2YXIgaT0wO2k8MztpKyspIHtcblx0XHRcdGZvciAodmFyIGo9MTtqPGFyZ3VtZW50cy5sZW5ndGg7aisrKSB7XG5cdFx0XHRcdHJlc3VsdFtpXSArPSBhcmd1bWVudHNbal1baV07XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiByZXN1bHQ7XG5cdH0sXG5cblx0LyoqXG5cdCAqIEFkZCB0d28gb3IgbW9yZSBjb2xvcnMsIE1PRElGSUVTIEZJUlNUIEFSR1VNRU5UXG5cdCAqIEBwYXJhbSB7bnVtYmVyW119IGNvbG9yMVxuXHQgKiBAcGFyYW0ge251bWJlcltdfSBjb2xvcjJcblx0ICogQHJldHVybnMge251bWJlcltdfVxuXHQgKi9cblx0YWRkXzogZnVuY3Rpb24oY29sb3IxLCBjb2xvcjIpIHtcblx0XHRmb3IgKHZhciBpPTA7aTwzO2krKykge1xuXHRcdFx0Zm9yICh2YXIgaj0xO2o8YXJndW1lbnRzLmxlbmd0aDtqKyspIHtcblx0XHRcdFx0Y29sb3IxW2ldICs9IGFyZ3VtZW50c1tqXVtpXTtcblx0XHRcdH1cblx0XHR9XG5cdFx0cmV0dXJuIGNvbG9yMTtcblx0fSxcblxuXHQvKipcblx0ICogTXVsdGlwbHkgKG1peCkgdHdvIG9yIG1vcmUgY29sb3JzXG5cdCAqIEBwYXJhbSB7bnVtYmVyW119IGNvbG9yMVxuXHQgKiBAcGFyYW0ge251bWJlcltdfSBjb2xvcjJcblx0ICogQHJldHVybnMge251bWJlcltdfVxuXHQgKi9cblx0bXVsdGlwbHk6IGZ1bmN0aW9uKGNvbG9yMSwgY29sb3IyKSB7XG5cdFx0dmFyIHJlc3VsdCA9IGNvbG9yMS5zbGljZSgpO1xuXHRcdGZvciAodmFyIGk9MDtpPDM7aSsrKSB7XG5cdFx0XHRmb3IgKHZhciBqPTE7ajxhcmd1bWVudHMubGVuZ3RoO2orKykge1xuXHRcdFx0XHRyZXN1bHRbaV0gKj0gYXJndW1lbnRzW2pdW2ldIC8gMjU1O1xuXHRcdFx0fVxuXHRcdFx0cmVzdWx0W2ldID0gTWF0aC5yb3VuZChyZXN1bHRbaV0pO1xuXHRcdH1cblx0XHRyZXR1cm4gcmVzdWx0O1xuXHR9LFxuXG5cdC8qKlxuXHQgKiBNdWx0aXBseSAobWl4KSB0d28gb3IgbW9yZSBjb2xvcnMsIE1PRElGSUVTIEZJUlNUIEFSR1VNRU5UXG5cdCAqIEBwYXJhbSB7bnVtYmVyW119IGNvbG9yMVxuXHQgKiBAcGFyYW0ge251bWJlcltdfSBjb2xvcjJcblx0ICogQHJldHVybnMge251bWJlcltdfVxuXHQgKi9cblx0bXVsdGlwbHlfOiBmdW5jdGlvbihjb2xvcjEsIGNvbG9yMikge1xuXHRcdGZvciAodmFyIGk9MDtpPDM7aSsrKSB7XG5cdFx0XHRmb3IgKHZhciBqPTE7ajxhcmd1bWVudHMubGVuZ3RoO2orKykge1xuXHRcdFx0XHRjb2xvcjFbaV0gKj0gYXJndW1lbnRzW2pdW2ldIC8gMjU1O1xuXHRcdFx0fVxuXHRcdFx0Y29sb3IxW2ldID0gTWF0aC5yb3VuZChjb2xvcjFbaV0pO1xuXHRcdH1cblx0XHRyZXR1cm4gY29sb3IxO1xuXHR9LFxuXG5cdC8qKlxuXHQgKiBJbnRlcnBvbGF0ZSAoYmxlbmQpIHR3byBjb2xvcnMgd2l0aCBhIGdpdmVuIGZhY3RvclxuXHQgKiBAcGFyYW0ge251bWJlcltdfSBjb2xvcjFcblx0ICogQHBhcmFtIHtudW1iZXJbXX0gY29sb3IyXG5cdCAqIEBwYXJhbSB7ZmxvYXR9IFtmYWN0b3I9MC41XSAwLi4xXG5cdCAqIEByZXR1cm5zIHtudW1iZXJbXX1cblx0ICovXG5cdGludGVycG9sYXRlOiBmdW5jdGlvbihjb2xvcjEsIGNvbG9yMiwgZmFjdG9yKSB7XG5cdFx0aWYgKGFyZ3VtZW50cy5sZW5ndGggPCAzKSB7IGZhY3RvciA9IDAuNTsgfVxuXHRcdHZhciByZXN1bHQgPSBjb2xvcjEuc2xpY2UoKTtcblx0XHRmb3IgKHZhciBpPTA7aTwzO2krKykge1xuXHRcdFx0cmVzdWx0W2ldID0gTWF0aC5yb3VuZChyZXN1bHRbaV0gKyBmYWN0b3IqKGNvbG9yMltpXS1jb2xvcjFbaV0pKTtcblx0XHR9XG5cdFx0cmV0dXJuIHJlc3VsdDtcblx0fSxcblxuXHQvKipcblx0ICogSW50ZXJwb2xhdGUgKGJsZW5kKSB0d28gY29sb3JzIHdpdGggYSBnaXZlbiBmYWN0b3IgaW4gSFNMIG1vZGVcblx0ICogQHBhcmFtIHtudW1iZXJbXX0gY29sb3IxXG5cdCAqIEBwYXJhbSB7bnVtYmVyW119IGNvbG9yMlxuXHQgKiBAcGFyYW0ge2Zsb2F0fSBbZmFjdG9yPTAuNV0gMC4uMVxuXHQgKiBAcmV0dXJucyB7bnVtYmVyW119XG5cdCAqL1xuXHRpbnRlcnBvbGF0ZUhTTDogZnVuY3Rpb24oY29sb3IxLCBjb2xvcjIsIGZhY3Rvcikge1xuXHRcdGlmIChhcmd1bWVudHMubGVuZ3RoIDwgMykgeyBmYWN0b3IgPSAwLjU7IH1cblx0XHR2YXIgaHNsMSA9IHRoaXMucmdiMmhzbChjb2xvcjEpO1xuXHRcdHZhciBoc2wyID0gdGhpcy5yZ2IyaHNsKGNvbG9yMik7XG5cdFx0Zm9yICh2YXIgaT0wO2k8MztpKyspIHtcblx0XHRcdGhzbDFbaV0gKz0gZmFjdG9yKihoc2wyW2ldLWhzbDFbaV0pO1xuXHRcdH1cblx0XHRyZXR1cm4gdGhpcy5oc2wycmdiKGhzbDEpO1xuXHR9LFxuXG5cdC8qKlxuXHQgKiBDcmVhdGUgYSBuZXcgcmFuZG9tIGNvbG9yIGJhc2VkIG9uIHRoaXMgb25lXG5cdCAqIEBwYXJhbSB7bnVtYmVyW119IGNvbG9yXG5cdCAqIEBwYXJhbSB7bnVtYmVyW119IGRpZmYgU2V0IG9mIHN0YW5kYXJkIGRldmlhdGlvbnNcblx0ICogQHJldHVybnMge251bWJlcltdfVxuXHQgKi9cblx0cmFuZG9taXplOiBmdW5jdGlvbihjb2xvciwgZGlmZikge1xuXHRcdGlmICghKGRpZmYgaW5zdGFuY2VvZiBBcnJheSkpIHsgZGlmZiA9IE1hdGgucm91bmQoUk9ULlJORy5nZXROb3JtYWwoMCwgZGlmZikpOyB9XG5cdFx0dmFyIHJlc3VsdCA9IGNvbG9yLnNsaWNlKCk7XG5cdFx0Zm9yICh2YXIgaT0wO2k8MztpKyspIHtcblx0XHRcdHJlc3VsdFtpXSArPSAoZGlmZiBpbnN0YW5jZW9mIEFycmF5ID8gTWF0aC5yb3VuZChST1QuUk5HLmdldE5vcm1hbCgwLCBkaWZmW2ldKSkgOiBkaWZmKTtcblx0XHR9XG5cdFx0cmV0dXJuIHJlc3VsdDtcblx0fSxcblxuXHQvKipcblx0ICogQ29udmVydHMgYW4gUkdCIGNvbG9yIHZhbHVlIHRvIEhTTC4gRXhwZWN0cyAwLi4yNTUgaW5wdXRzLCBwcm9kdWNlcyAwLi4xIG91dHB1dHMuXG5cdCAqIEBwYXJhbSB7bnVtYmVyW119IGNvbG9yXG5cdCAqIEByZXR1cm5zIHtudW1iZXJbXX1cblx0ICovXG5cdHJnYjJoc2w6IGZ1bmN0aW9uKGNvbG9yKSB7XG5cdFx0dmFyIHIgPSBjb2xvclswXS8yNTU7XG5cdFx0dmFyIGcgPSBjb2xvclsxXS8yNTU7XG5cdFx0dmFyIGIgPSBjb2xvclsyXS8yNTU7XG5cblx0XHR2YXIgbWF4ID0gTWF0aC5tYXgociwgZywgYiksIG1pbiA9IE1hdGgubWluKHIsIGcsIGIpO1xuXHRcdHZhciBoLCBzLCBsID0gKG1heCArIG1pbikgLyAyO1xuXG5cdFx0aWYgKG1heCA9PSBtaW4pIHtcblx0XHRcdGggPSBzID0gMDsgLy8gYWNocm9tYXRpY1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR2YXIgZCA9IG1heCAtIG1pbjtcblx0XHRcdHMgPSAobCA+IDAuNSA/IGQgLyAoMiAtIG1heCAtIG1pbikgOiBkIC8gKG1heCArIG1pbikpO1xuXHRcdFx0c3dpdGNoKG1heCkge1xuXHRcdFx0XHRjYXNlIHI6IGggPSAoZyAtIGIpIC8gZCArIChnIDwgYiA/IDYgOiAwKTsgYnJlYWs7XG5cdFx0XHRcdGNhc2UgZzogaCA9IChiIC0gcikgLyBkICsgMjsgYnJlYWs7XG5cdFx0XHRcdGNhc2UgYjogaCA9IChyIC0gZykgLyBkICsgNDsgYnJlYWs7XG5cdFx0XHR9XG5cdFx0XHRoIC89IDY7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIFtoLCBzLCBsXTtcblx0fSxcblxuXHQvKipcblx0ICogQ29udmVydHMgYW4gSFNMIGNvbG9yIHZhbHVlIHRvIFJHQi4gRXhwZWN0cyAwLi4xIGlucHV0cywgcHJvZHVjZXMgMC4uMjU1IG91dHB1dHMuXG5cdCAqIEBwYXJhbSB7bnVtYmVyW119IGNvbG9yXG5cdCAqIEByZXR1cm5zIHtudW1iZXJbXX1cblx0ICovXG5cdGhzbDJyZ2I6IGZ1bmN0aW9uKGNvbG9yKSB7XG5cdFx0dmFyIGwgPSBjb2xvclsyXTtcblxuXHRcdGlmIChjb2xvclsxXSA9PSAwKSB7XG5cdFx0XHRsID0gTWF0aC5yb3VuZChsKjI1NSk7XG5cdFx0XHRyZXR1cm4gW2wsIGwsIGxdO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR2YXIgaHVlMnJnYiA9IGZ1bmN0aW9uKHAsIHEsIHQpIHtcblx0XHRcdFx0aWYgKHQgPCAwKSB0ICs9IDE7XG5cdFx0XHRcdGlmICh0ID4gMSkgdCAtPSAxO1xuXHRcdFx0XHRpZiAodCA8IDEvNikgcmV0dXJuIHAgKyAocSAtIHApICogNiAqIHQ7XG5cdFx0XHRcdGlmICh0IDwgMS8yKSByZXR1cm4gcTtcblx0XHRcdFx0aWYgKHQgPCAyLzMpIHJldHVybiBwICsgKHEgLSBwKSAqICgyLzMgLSB0KSAqIDY7XG5cdFx0XHRcdHJldHVybiBwO1xuXHRcdFx0fVxuXG5cdFx0XHR2YXIgcyA9IGNvbG9yWzFdO1xuXHRcdFx0dmFyIHEgPSAobCA8IDAuNSA/IGwgKiAoMSArIHMpIDogbCArIHMgLSBsICogcyk7XG5cdFx0XHR2YXIgcCA9IDIgKiBsIC0gcTtcblx0XHRcdHZhciByID0gaHVlMnJnYihwLCBxLCBjb2xvclswXSArIDEvMyk7XG5cdFx0XHR2YXIgZyA9IGh1ZTJyZ2IocCwgcSwgY29sb3JbMF0pO1xuXHRcdFx0dmFyIGIgPSBodWUycmdiKHAsIHEsIGNvbG9yWzBdIC0gMS8zKTtcblx0XHRcdHJldHVybiBbTWF0aC5yb3VuZChyKjI1NSksIE1hdGgucm91bmQoZyoyNTUpLCBNYXRoLnJvdW5kKGIqMjU1KV07XG5cdFx0fVxuXHR9LFxuXG5cdHRvUkdCOiBmdW5jdGlvbihjb2xvcikge1xuXHRcdHJldHVybiBcInJnYihcIiArIHRoaXMuX2NsYW1wKGNvbG9yWzBdKSArIFwiLFwiICsgdGhpcy5fY2xhbXAoY29sb3JbMV0pICsgXCIsXCIgKyB0aGlzLl9jbGFtcChjb2xvclsyXSkgKyBcIilcIjtcblx0fSxcblxuXHR0b0hleDogZnVuY3Rpb24oY29sb3IpIHtcblx0XHR2YXIgcGFydHMgPSBbXTtcblx0XHRmb3IgKHZhciBpPTA7aTwzO2krKykge1xuXHRcdFx0cGFydHMucHVzaCh0aGlzLl9jbGFtcChjb2xvcltpXSkudG9TdHJpbmcoMTYpLmxwYWQoXCIwXCIsIDIpKTtcblx0XHR9XG5cdFx0cmV0dXJuIFwiI1wiICsgcGFydHMuam9pbihcIlwiKTtcblx0fSxcblxuXHRfY2xhbXA6IGZ1bmN0aW9uKG51bSkge1xuXHRcdGlmIChudW0gPCAwKSB7XG5cdFx0XHRyZXR1cm4gMDtcblx0XHR9IGVsc2UgaWYgKG51bSA+IDI1NSkge1xuXHRcdFx0cmV0dXJuIDI1NTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0cmV0dXJuIG51bTtcblx0XHR9XG5cdH0sXG5cblx0X2NhY2hlOiB7XG5cdFx0XCJibGFja1wiOiBbMCwwLDBdLFxuXHRcdFwibmF2eVwiOiBbMCwwLDEyOF0sXG5cdFx0XCJkYXJrYmx1ZVwiOiBbMCwwLDEzOV0sXG5cdFx0XCJtZWRpdW1ibHVlXCI6IFswLDAsMjA1XSxcblx0XHRcImJsdWVcIjogWzAsMCwyNTVdLFxuXHRcdFwiZGFya2dyZWVuXCI6IFswLDEwMCwwXSxcblx0XHRcImdyZWVuXCI6IFswLDEyOCwwXSxcblx0XHRcInRlYWxcIjogWzAsMTI4LDEyOF0sXG5cdFx0XCJkYXJrY3lhblwiOiBbMCwxMzksMTM5XSxcblx0XHRcImRlZXBza3libHVlXCI6IFswLDE5MSwyNTVdLFxuXHRcdFwiZGFya3R1cnF1b2lzZVwiOiBbMCwyMDYsMjA5XSxcblx0XHRcIm1lZGl1bXNwcmluZ2dyZWVuXCI6IFswLDI1MCwxNTRdLFxuXHRcdFwibGltZVwiOiBbMCwyNTUsMF0sXG5cdFx0XCJzcHJpbmdncmVlblwiOiBbMCwyNTUsMTI3XSxcblx0XHRcImFxdWFcIjogWzAsMjU1LDI1NV0sXG5cdFx0XCJjeWFuXCI6IFswLDI1NSwyNTVdLFxuXHRcdFwibWlkbmlnaHRibHVlXCI6IFsyNSwyNSwxMTJdLFxuXHRcdFwiZG9kZ2VyYmx1ZVwiOiBbMzAsMTQ0LDI1NV0sXG5cdFx0XCJmb3Jlc3RncmVlblwiOiBbMzQsMTM5LDM0XSxcblx0XHRcInNlYWdyZWVuXCI6IFs0NiwxMzksODddLFxuXHRcdFwiZGFya3NsYXRlZ3JheVwiOiBbNDcsNzksNzldLFxuXHRcdFwiZGFya3NsYXRlZ3JleVwiOiBbNDcsNzksNzldLFxuXHRcdFwibGltZWdyZWVuXCI6IFs1MCwyMDUsNTBdLFxuXHRcdFwibWVkaXVtc2VhZ3JlZW5cIjogWzYwLDE3OSwxMTNdLFxuXHRcdFwidHVycXVvaXNlXCI6IFs2NCwyMjQsMjA4XSxcblx0XHRcInJveWFsYmx1ZVwiOiBbNjUsMTA1LDIyNV0sXG5cdFx0XCJzdGVlbGJsdWVcIjogWzcwLDEzMCwxODBdLFxuXHRcdFwiZGFya3NsYXRlYmx1ZVwiOiBbNzIsNjEsMTM5XSxcblx0XHRcIm1lZGl1bXR1cnF1b2lzZVwiOiBbNzIsMjA5LDIwNF0sXG5cdFx0XCJpbmRpZ29cIjogWzc1LDAsMTMwXSxcblx0XHRcImRhcmtvbGl2ZWdyZWVuXCI6IFs4NSwxMDcsNDddLFxuXHRcdFwiY2FkZXRibHVlXCI6IFs5NSwxNTgsMTYwXSxcblx0XHRcImNvcm5mbG93ZXJibHVlXCI6IFsxMDAsMTQ5LDIzN10sXG5cdFx0XCJtZWRpdW1hcXVhbWFyaW5lXCI6IFsxMDIsMjA1LDE3MF0sXG5cdFx0XCJkaW1ncmF5XCI6IFsxMDUsMTA1LDEwNV0sXG5cdFx0XCJkaW1ncmV5XCI6IFsxMDUsMTA1LDEwNV0sXG5cdFx0XCJzbGF0ZWJsdWVcIjogWzEwNiw5MCwyMDVdLFxuXHRcdFwib2xpdmVkcmFiXCI6IFsxMDcsMTQyLDM1XSxcblx0XHRcInNsYXRlZ3JheVwiOiBbMTEyLDEyOCwxNDRdLFxuXHRcdFwic2xhdGVncmV5XCI6IFsxMTIsMTI4LDE0NF0sXG5cdFx0XCJsaWdodHNsYXRlZ3JheVwiOiBbMTE5LDEzNiwxNTNdLFxuXHRcdFwibGlnaHRzbGF0ZWdyZXlcIjogWzExOSwxMzYsMTUzXSxcblx0XHRcIm1lZGl1bXNsYXRlYmx1ZVwiOiBbMTIzLDEwNCwyMzhdLFxuXHRcdFwibGF3bmdyZWVuXCI6IFsxMjQsMjUyLDBdLFxuXHRcdFwiY2hhcnRyZXVzZVwiOiBbMTI3LDI1NSwwXSxcblx0XHRcImFxdWFtYXJpbmVcIjogWzEyNywyNTUsMjEyXSxcblx0XHRcIm1hcm9vblwiOiBbMTI4LDAsMF0sXG5cdFx0XCJwdXJwbGVcIjogWzEyOCwwLDEyOF0sXG5cdFx0XCJvbGl2ZVwiOiBbMTI4LDEyOCwwXSxcblx0XHRcImdyYXlcIjogWzEyOCwxMjgsMTI4XSxcblx0XHRcImdyZXlcIjogWzEyOCwxMjgsMTI4XSxcblx0XHRcInNreWJsdWVcIjogWzEzNSwyMDYsMjM1XSxcblx0XHRcImxpZ2h0c2t5Ymx1ZVwiOiBbMTM1LDIwNiwyNTBdLFxuXHRcdFwiYmx1ZXZpb2xldFwiOiBbMTM4LDQzLDIyNl0sXG5cdFx0XCJkYXJrcmVkXCI6IFsxMzksMCwwXSxcblx0XHRcImRhcmttYWdlbnRhXCI6IFsxMzksMCwxMzldLFxuXHRcdFwic2FkZGxlYnJvd25cIjogWzEzOSw2OSwxOV0sXG5cdFx0XCJkYXJrc2VhZ3JlZW5cIjogWzE0MywxODgsMTQzXSxcblx0XHRcImxpZ2h0Z3JlZW5cIjogWzE0NCwyMzgsMTQ0XSxcblx0XHRcIm1lZGl1bXB1cnBsZVwiOiBbMTQ3LDExMiwyMTZdLFxuXHRcdFwiZGFya3Zpb2xldFwiOiBbMTQ4LDAsMjExXSxcblx0XHRcInBhbGVncmVlblwiOiBbMTUyLDI1MSwxNTJdLFxuXHRcdFwiZGFya29yY2hpZFwiOiBbMTUzLDUwLDIwNF0sXG5cdFx0XCJ5ZWxsb3dncmVlblwiOiBbMTU0LDIwNSw1MF0sXG5cdFx0XCJzaWVubmFcIjogWzE2MCw4Miw0NV0sXG5cdFx0XCJicm93blwiOiBbMTY1LDQyLDQyXSxcblx0XHRcImRhcmtncmF5XCI6IFsxNjksMTY5LDE2OV0sXG5cdFx0XCJkYXJrZ3JleVwiOiBbMTY5LDE2OSwxNjldLFxuXHRcdFwibGlnaHRibHVlXCI6IFsxNzMsMjE2LDIzMF0sXG5cdFx0XCJncmVlbnllbGxvd1wiOiBbMTczLDI1NSw0N10sXG5cdFx0XCJwYWxldHVycXVvaXNlXCI6IFsxNzUsMjM4LDIzOF0sXG5cdFx0XCJsaWdodHN0ZWVsYmx1ZVwiOiBbMTc2LDE5NiwyMjJdLFxuXHRcdFwicG93ZGVyYmx1ZVwiOiBbMTc2LDIyNCwyMzBdLFxuXHRcdFwiZmlyZWJyaWNrXCI6IFsxNzgsMzQsMzRdLFxuXHRcdFwiZGFya2dvbGRlbnJvZFwiOiBbMTg0LDEzNCwxMV0sXG5cdFx0XCJtZWRpdW1vcmNoaWRcIjogWzE4Niw4NSwyMTFdLFxuXHRcdFwicm9zeWJyb3duXCI6IFsxODgsMTQzLDE0M10sXG5cdFx0XCJkYXJra2hha2lcIjogWzE4OSwxODMsMTA3XSxcblx0XHRcInNpbHZlclwiOiBbMTkyLDE5MiwxOTJdLFxuXHRcdFwibWVkaXVtdmlvbGV0cmVkXCI6IFsxOTksMjEsMTMzXSxcblx0XHRcImluZGlhbnJlZFwiOiBbMjA1LDkyLDkyXSxcblx0XHRcInBlcnVcIjogWzIwNSwxMzMsNjNdLFxuXHRcdFwiY2hvY29sYXRlXCI6IFsyMTAsMTA1LDMwXSxcblx0XHRcInRhblwiOiBbMjEwLDE4MCwxNDBdLFxuXHRcdFwibGlnaHRncmF5XCI6IFsyMTEsMjExLDIxMV0sXG5cdFx0XCJsaWdodGdyZXlcIjogWzIxMSwyMTEsMjExXSxcblx0XHRcInBhbGV2aW9sZXRyZWRcIjogWzIxNiwxMTIsMTQ3XSxcblx0XHRcInRoaXN0bGVcIjogWzIxNiwxOTEsMjE2XSxcblx0XHRcIm9yY2hpZFwiOiBbMjE4LDExMiwyMTRdLFxuXHRcdFwiZ29sZGVucm9kXCI6IFsyMTgsMTY1LDMyXSxcblx0XHRcImNyaW1zb25cIjogWzIyMCwyMCw2MF0sXG5cdFx0XCJnYWluc2Jvcm9cIjogWzIyMCwyMjAsMjIwXSxcblx0XHRcInBsdW1cIjogWzIyMSwxNjAsMjIxXSxcblx0XHRcImJ1cmx5d29vZFwiOiBbMjIyLDE4NCwxMzVdLFxuXHRcdFwibGlnaHRjeWFuXCI6IFsyMjQsMjU1LDI1NV0sXG5cdFx0XCJsYXZlbmRlclwiOiBbMjMwLDIzMCwyNTBdLFxuXHRcdFwiZGFya3NhbG1vblwiOiBbMjMzLDE1MCwxMjJdLFxuXHRcdFwidmlvbGV0XCI6IFsyMzgsMTMwLDIzOF0sXG5cdFx0XCJwYWxlZ29sZGVucm9kXCI6IFsyMzgsMjMyLDE3MF0sXG5cdFx0XCJsaWdodGNvcmFsXCI6IFsyNDAsMTI4LDEyOF0sXG5cdFx0XCJraGFraVwiOiBbMjQwLDIzMCwxNDBdLFxuXHRcdFwiYWxpY2VibHVlXCI6IFsyNDAsMjQ4LDI1NV0sXG5cdFx0XCJob25leWRld1wiOiBbMjQwLDI1NSwyNDBdLFxuXHRcdFwiYXp1cmVcIjogWzI0MCwyNTUsMjU1XSxcblx0XHRcInNhbmR5YnJvd25cIjogWzI0NCwxNjQsOTZdLFxuXHRcdFwid2hlYXRcIjogWzI0NSwyMjIsMTc5XSxcblx0XHRcImJlaWdlXCI6IFsyNDUsMjQ1LDIyMF0sXG5cdFx0XCJ3aGl0ZXNtb2tlXCI6IFsyNDUsMjQ1LDI0NV0sXG5cdFx0XCJtaW50Y3JlYW1cIjogWzI0NSwyNTUsMjUwXSxcblx0XHRcImdob3N0d2hpdGVcIjogWzI0OCwyNDgsMjU1XSxcblx0XHRcInNhbG1vblwiOiBbMjUwLDEyOCwxMTRdLFxuXHRcdFwiYW50aXF1ZXdoaXRlXCI6IFsyNTAsMjM1LDIxNV0sXG5cdFx0XCJsaW5lblwiOiBbMjUwLDI0MCwyMzBdLFxuXHRcdFwibGlnaHRnb2xkZW5yb2R5ZWxsb3dcIjogWzI1MCwyNTAsMjEwXSxcblx0XHRcIm9sZGxhY2VcIjogWzI1MywyNDUsMjMwXSxcblx0XHRcInJlZFwiOiBbMjU1LDAsMF0sXG5cdFx0XCJmdWNoc2lhXCI6IFsyNTUsMCwyNTVdLFxuXHRcdFwibWFnZW50YVwiOiBbMjU1LDAsMjU1XSxcblx0XHRcImRlZXBwaW5rXCI6IFsyNTUsMjAsMTQ3XSxcblx0XHRcIm9yYW5nZXJlZFwiOiBbMjU1LDY5LDBdLFxuXHRcdFwidG9tYXRvXCI6IFsyNTUsOTksNzFdLFxuXHRcdFwiaG90cGlua1wiOiBbMjU1LDEwNSwxODBdLFxuXHRcdFwiY29yYWxcIjogWzI1NSwxMjcsODBdLFxuXHRcdFwiZGFya29yYW5nZVwiOiBbMjU1LDE0MCwwXSxcblx0XHRcImxpZ2h0c2FsbW9uXCI6IFsyNTUsMTYwLDEyMl0sXG5cdFx0XCJvcmFuZ2VcIjogWzI1NSwxNjUsMF0sXG5cdFx0XCJsaWdodHBpbmtcIjogWzI1NSwxODIsMTkzXSxcblx0XHRcInBpbmtcIjogWzI1NSwxOTIsMjAzXSxcblx0XHRcImdvbGRcIjogWzI1NSwyMTUsMF0sXG5cdFx0XCJwZWFjaHB1ZmZcIjogWzI1NSwyMTgsMTg1XSxcblx0XHRcIm5hdmFqb3doaXRlXCI6IFsyNTUsMjIyLDE3M10sXG5cdFx0XCJtb2NjYXNpblwiOiBbMjU1LDIyOCwxODFdLFxuXHRcdFwiYmlzcXVlXCI6IFsyNTUsMjI4LDE5Nl0sXG5cdFx0XCJtaXN0eXJvc2VcIjogWzI1NSwyMjgsMjI1XSxcblx0XHRcImJsYW5jaGVkYWxtb25kXCI6IFsyNTUsMjM1LDIwNV0sXG5cdFx0XCJwYXBheWF3aGlwXCI6IFsyNTUsMjM5LDIxM10sXG5cdFx0XCJsYXZlbmRlcmJsdXNoXCI6IFsyNTUsMjQwLDI0NV0sXG5cdFx0XCJzZWFzaGVsbFwiOiBbMjU1LDI0NSwyMzhdLFxuXHRcdFwiY29ybnNpbGtcIjogWzI1NSwyNDgsMjIwXSxcblx0XHRcImxlbW9uY2hpZmZvblwiOiBbMjU1LDI1MCwyMDVdLFxuXHRcdFwiZmxvcmFsd2hpdGVcIjogWzI1NSwyNTAsMjQwXSxcblx0XHRcInNub3dcIjogWzI1NSwyNTAsMjUwXSxcblx0XHRcInllbGxvd1wiOiBbMjU1LDI1NSwwXSxcblx0XHRcImxpZ2h0eWVsbG93XCI6IFsyNTUsMjU1LDIyNF0sXG5cdFx0XCJpdm9yeVwiOiBbMjU1LDI1NSwyNDBdLFxuXHRcdFwid2hpdGVcIjogWzI1NSwyNTUsMjU1XVxuXHR9XG59O1xuLyoqXG4gKiBAY2xhc3MgTGlnaHRpbmcgY29tcHV0YXRpb24sIGJhc2VkIG9uIGEgdHJhZGl0aW9uYWwgRk9WIGZvciBtdWx0aXBsZSBsaWdodCBzb3VyY2VzIGFuZCBtdWx0aXBsZSBwYXNzZXMuXG4gKiBAcGFyYW0ge2Z1bmN0aW9ufSByZWZsZWN0aXZpdHlDYWxsYmFjayBDYWxsYmFjayB0byByZXRyaWV2ZSBjZWxsIHJlZmxlY3Rpdml0eSAoMC4uMSlcbiAqIEBwYXJhbSB7b2JqZWN0fSBbb3B0aW9uc11cbiAqIEBwYXJhbSB7aW50fSBbb3B0aW9ucy5wYXNzZXM9MV0gTnVtYmVyIG9mIHBhc3Nlcy4gMSBlcXVhbHMgdG8gc2ltcGxlIEZPViBvZiBhbGwgbGlnaHQgc291cmNlcywgPjEgbWVhbnMgYSAqaGlnaGx5IHNpbXBsaWZpZWQqIHJhZGlvc2l0eS1saWtlIGFsZ29yaXRobS5cbiAqIEBwYXJhbSB7aW50fSBbb3B0aW9ucy5lbWlzc2lvblRocmVzaG9sZD0xMDBdIENlbGxzIHdpdGggZW1pc3Npdml0eSA+IHRocmVzaG9sZCB3aWxsIGJlIHRyZWF0ZWQgYXMgbGlnaHQgc291cmNlIGluIHRoZSBuZXh0IHBhc3MuXG4gKiBAcGFyYW0ge2ludH0gW29wdGlvbnMucmFuZ2U9MTBdIE1heCBsaWdodCByYW5nZVxuICovXG5ST1QuTGlnaHRpbmcgPSBmdW5jdGlvbihyZWZsZWN0aXZpdHlDYWxsYmFjaywgb3B0aW9ucykge1xuXHR0aGlzLl9yZWZsZWN0aXZpdHlDYWxsYmFjayA9IHJlZmxlY3Rpdml0eUNhbGxiYWNrO1xuXHR0aGlzLl9vcHRpb25zID0ge1xuXHRcdHBhc3NlczogMSxcblx0XHRlbWlzc2lvblRocmVzaG9sZDogMTAwLFxuXHRcdHJhbmdlOiAxMFxuXHR9O1xuXHR0aGlzLl9mb3YgPSBudWxsO1xuXG5cdHRoaXMuX2xpZ2h0cyA9IHt9O1xuXHR0aGlzLl9yZWZsZWN0aXZpdHlDYWNoZSA9IHt9O1xuXHR0aGlzLl9mb3ZDYWNoZSA9IHt9O1xuXG5cdHRoaXMuc2V0T3B0aW9ucyhvcHRpb25zKTtcbn07XG5cbi8qKlxuICogQWRqdXN0IG9wdGlvbnMgYXQgcnVudGltZVxuICogQHNlZSBST1QuTGlnaHRpbmdcbiAqIEBwYXJhbSB7b2JqZWN0fSBbb3B0aW9uc11cbiAqL1xuUk9ULkxpZ2h0aW5nLnByb3RvdHlwZS5zZXRPcHRpb25zID0gZnVuY3Rpb24ob3B0aW9ucykge1xuXHRmb3IgKHZhciBwIGluIG9wdGlvbnMpIHsgdGhpcy5fb3B0aW9uc1twXSA9IG9wdGlvbnNbcF07IH1cblx0aWYgKG9wdGlvbnMgJiYgb3B0aW9ucy5yYW5nZSkgeyB0aGlzLnJlc2V0KCk7IH1cblx0cmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIFNldCB0aGUgdXNlZCBGaWVsZC1PZi1WaWV3IGFsZ29cbiAqIEBwYXJhbSB7Uk9ULkZPVn0gZm92XG4gKi9cblJPVC5MaWdodGluZy5wcm90b3R5cGUuc2V0Rk9WID0gZnVuY3Rpb24oZm92KSB7XG5cdHRoaXMuX2ZvdiA9IGZvdjtcblx0dGhpcy5fZm92Q2FjaGUgPSB7fTtcblx0cmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIFNldCAob3IgcmVtb3ZlKSBhIGxpZ2h0IHNvdXJjZVxuICogQHBhcmFtIHtpbnR9IHhcbiAqIEBwYXJhbSB7aW50fSB5XG4gKiBAcGFyYW0ge251bGwgfHwgc3RyaW5nIHx8IG51bWJlclszXX0gY29sb3JcbiAqL1xuUk9ULkxpZ2h0aW5nLnByb3RvdHlwZS5zZXRMaWdodCA9IGZ1bmN0aW9uKHgsIHksIGNvbG9yKSB7XG4gIHZhciBrZXkgPSB4ICsgXCIsXCIgKyB5O1xuXG4gIGlmIChjb2xvcikge1xuICAgIHRoaXMuX2xpZ2h0c1trZXldID0gKHR5cGVvZihjb2xvcikgPT0gXCJzdHJpbmdcIiA/IFJPVC5Db2xvci5mcm9tU3RyaW5nKGNvbG9yKSA6IGNvbG9yKTtcbiAgfSBlbHNlIHtcbiAgICBkZWxldGUgdGhpcy5fbGlnaHRzW2tleV07XG4gIH1cbiAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIFJlbW92ZSBhbGwgbGlnaHQgc291cmNlc1xuICovXG5ST1QuTGlnaHRpbmcucHJvdG90eXBlLmNsZWFyTGlnaHRzID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5fbGlnaHRzID0ge307XG59O1xuXG4vKipcbiAqIFJlc2V0IHRoZSBwcmUtY29tcHV0ZWQgdG9wb2xvZ3kgdmFsdWVzLiBDYWxsIHdoZW5ldmVyIHRoZSB1bmRlcmx5aW5nIG1hcCBjaGFuZ2VzIGl0cyBsaWdodC1wYXNzYWJpbGl0eS5cbiAqL1xuUk9ULkxpZ2h0aW5nLnByb3RvdHlwZS5yZXNldCA9IGZ1bmN0aW9uKCkge1xuXHR0aGlzLl9yZWZsZWN0aXZpdHlDYWNoZSA9IHt9O1xuXHR0aGlzLl9mb3ZDYWNoZSA9IHt9O1xuXG5cdHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBDb21wdXRlIHRoZSBsaWdodGluZ1xuICogQHBhcmFtIHtmdW5jdGlvbn0gbGlnaHRpbmdDYWxsYmFjayBXaWxsIGJlIGNhbGxlZCB3aXRoICh4LCB5LCBjb2xvcikgZm9yIGV2ZXJ5IGxpdCBjZWxsXG4gKi9cblJPVC5MaWdodGluZy5wcm90b3R5cGUuY29tcHV0ZSA9IGZ1bmN0aW9uKGxpZ2h0aW5nQ2FsbGJhY2spIHtcblx0dmFyIGRvbmVDZWxscyA9IHt9O1xuXHR2YXIgZW1pdHRpbmdDZWxscyA9IHt9O1xuXHR2YXIgbGl0Q2VsbHMgPSB7fTtcblxuXHRmb3IgKHZhciBrZXkgaW4gdGhpcy5fbGlnaHRzKSB7IC8qIHByZXBhcmUgZW1pdHRlcnMgZm9yIGZpcnN0IHBhc3MgKi9cblx0XHR2YXIgbGlnaHQgPSB0aGlzLl9saWdodHNba2V5XTtcblx0XHRlbWl0dGluZ0NlbGxzW2tleV0gPSBbMCwgMCwgMF07XG5cdFx0Uk9ULkNvbG9yLmFkZF8oZW1pdHRpbmdDZWxsc1trZXldLCBsaWdodCk7XG5cdH1cblxuXHRmb3IgKHZhciBpPTA7aTx0aGlzLl9vcHRpb25zLnBhc3NlcztpKyspIHsgLyogbWFpbiBsb29wICovXG5cdFx0dGhpcy5fZW1pdExpZ2h0KGVtaXR0aW5nQ2VsbHMsIGxpdENlbGxzLCBkb25lQ2VsbHMpO1xuXHRcdGlmIChpKzEgPT0gdGhpcy5fb3B0aW9ucy5wYXNzZXMpIHsgY29udGludWU7IH0gLyogbm90IGZvciB0aGUgbGFzdCBwYXNzICovXG5cdFx0ZW1pdHRpbmdDZWxscyA9IHRoaXMuX2NvbXB1dGVFbWl0dGVycyhsaXRDZWxscywgZG9uZUNlbGxzKTtcblx0fVxuXG5cdGZvciAodmFyIGxpdEtleSBpbiBsaXRDZWxscykgeyAvKiBsZXQgdGhlIHVzZXIga25vdyB3aGF0IGFuZCBob3cgaXMgbGl0ICovXG5cdFx0dmFyIHBhcnRzID0gbGl0S2V5LnNwbGl0KFwiLFwiKTtcblx0XHR2YXIgeCA9IHBhcnNlSW50KHBhcnRzWzBdKTtcblx0XHR2YXIgeSA9IHBhcnNlSW50KHBhcnRzWzFdKTtcblx0XHRsaWdodGluZ0NhbGxiYWNrKHgsIHksIGxpdENlbGxzW2xpdEtleV0pO1xuXHR9XG5cblx0cmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIENvbXB1dGUgb25lIGl0ZXJhdGlvbiBmcm9tIGFsbCBlbWl0dGluZyBjZWxsc1xuICogQHBhcmFtIHtvYmplY3R9IGVtaXR0aW5nQ2VsbHMgVGhlc2UgZW1pdCBsaWdodFxuICogQHBhcmFtIHtvYmplY3R9IGxpdENlbGxzIEFkZCBwcm9qZWN0ZWQgbGlnaHQgdG8gdGhlc2VcbiAqIEBwYXJhbSB7b2JqZWN0fSBkb25lQ2VsbHMgVGhlc2UgYWxyZWFkeSBlbWl0dGVkLCBmb3JiaWQgdGhlbSBmcm9tIGZ1cnRoZXIgY2FsY3VsYXRpb25zXG4gKi9cblJPVC5MaWdodGluZy5wcm90b3R5cGUuX2VtaXRMaWdodCA9IGZ1bmN0aW9uKGVtaXR0aW5nQ2VsbHMsIGxpdENlbGxzLCBkb25lQ2VsbHMpIHtcblx0Zm9yICh2YXIga2V5IGluIGVtaXR0aW5nQ2VsbHMpIHtcblx0XHR2YXIgcGFydHMgPSBrZXkuc3BsaXQoXCIsXCIpO1xuXHRcdHZhciB4ID0gcGFyc2VJbnQocGFydHNbMF0pO1xuXHRcdHZhciB5ID0gcGFyc2VJbnQocGFydHNbMV0pO1xuXHRcdHRoaXMuX2VtaXRMaWdodEZyb21DZWxsKHgsIHksIGVtaXR0aW5nQ2VsbHNba2V5XSwgbGl0Q2VsbHMpO1xuXHRcdGRvbmVDZWxsc1trZXldID0gMTtcblx0fVxuXHRyZXR1cm4gdGhpcztcbn07XG5cbi8qKlxuICogUHJlcGFyZSBhIGxpc3Qgb2YgZW1pdHRlcnMgZm9yIG5leHQgcGFzc1xuICogQHBhcmFtIHtvYmplY3R9IGxpdENlbGxzXG4gKiBAcGFyYW0ge29iamVjdH0gZG9uZUNlbGxzXG4gKiBAcmV0dXJucyB7b2JqZWN0fVxuICovXG5ST1QuTGlnaHRpbmcucHJvdG90eXBlLl9jb21wdXRlRW1pdHRlcnMgPSBmdW5jdGlvbihsaXRDZWxscywgZG9uZUNlbGxzKSB7XG5cdHZhciByZXN1bHQgPSB7fTtcblxuXHRmb3IgKHZhciBrZXkgaW4gbGl0Q2VsbHMpIHtcblx0XHRpZiAoa2V5IGluIGRvbmVDZWxscykgeyBjb250aW51ZTsgfSAvKiBhbHJlYWR5IGVtaXR0ZWQgKi9cblxuXHRcdHZhciBjb2xvciA9IGxpdENlbGxzW2tleV07XG5cblx0XHRpZiAoa2V5IGluIHRoaXMuX3JlZmxlY3Rpdml0eUNhY2hlKSB7XG5cdFx0XHR2YXIgcmVmbGVjdGl2aXR5ID0gdGhpcy5fcmVmbGVjdGl2aXR5Q2FjaGVba2V5XTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dmFyIHBhcnRzID0ga2V5LnNwbGl0KFwiLFwiKTtcblx0XHRcdHZhciB4ID0gcGFyc2VJbnQocGFydHNbMF0pO1xuXHRcdFx0dmFyIHkgPSBwYXJzZUludChwYXJ0c1sxXSk7XG5cdFx0XHR2YXIgcmVmbGVjdGl2aXR5ID0gdGhpcy5fcmVmbGVjdGl2aXR5Q2FsbGJhY2soeCwgeSk7XG5cdFx0XHR0aGlzLl9yZWZsZWN0aXZpdHlDYWNoZVtrZXldID0gcmVmbGVjdGl2aXR5O1xuXHRcdH1cblxuXHRcdGlmIChyZWZsZWN0aXZpdHkgPT0gMCkgeyBjb250aW51ZTsgfSAvKiB3aWxsIG5vdCByZWZsZWN0IGF0IGFsbCAqL1xuXG5cdFx0LyogY29tcHV0ZSBlbWlzc2lvbiBjb2xvciAqL1xuXHRcdHZhciBlbWlzc2lvbiA9IFtdO1xuXHRcdHZhciBpbnRlbnNpdHkgPSAwO1xuXHRcdGZvciAodmFyIGk9MDtpPDM7aSsrKSB7XG5cdFx0XHR2YXIgcGFydCA9IE1hdGgucm91bmQoY29sb3JbaV0qcmVmbGVjdGl2aXR5KTtcblx0XHRcdGVtaXNzaW9uW2ldID0gcGFydDtcblx0XHRcdGludGVuc2l0eSArPSBwYXJ0O1xuXHRcdH1cblx0XHRpZiAoaW50ZW5zaXR5ID4gdGhpcy5fb3B0aW9ucy5lbWlzc2lvblRocmVzaG9sZCkgeyByZXN1bHRba2V5XSA9IGVtaXNzaW9uOyB9XG5cdH1cblxuXHRyZXR1cm4gcmVzdWx0O1xufTtcblxuLyoqXG4gKiBDb21wdXRlIG9uZSBpdGVyYXRpb24gZnJvbSBvbmUgY2VsbFxuICogQHBhcmFtIHtpbnR9IHhcbiAqIEBwYXJhbSB7aW50fSB5XG4gKiBAcGFyYW0ge251bWJlcltdfSBjb2xvclxuICogQHBhcmFtIHtvYmplY3R9IGxpdENlbGxzIENlbGwgZGF0YSB0byBieSB1cGRhdGVkXG4gKi9cblJPVC5MaWdodGluZy5wcm90b3R5cGUuX2VtaXRMaWdodEZyb21DZWxsID0gZnVuY3Rpb24oeCwgeSwgY29sb3IsIGxpdENlbGxzKSB7XG5cdHZhciBrZXkgPSB4K1wiLFwiK3k7XG5cdGlmIChrZXkgaW4gdGhpcy5fZm92Q2FjaGUpIHtcblx0XHR2YXIgZm92ID0gdGhpcy5fZm92Q2FjaGVba2V5XTtcblx0fSBlbHNlIHtcblx0XHR2YXIgZm92ID0gdGhpcy5fdXBkYXRlRk9WKHgsIHkpO1xuXHR9XG5cblx0Zm9yICh2YXIgZm92S2V5IGluIGZvdikge1xuXHRcdHZhciBmb3JtRmFjdG9yID0gZm92W2ZvdktleV07XG5cblx0XHRpZiAoZm92S2V5IGluIGxpdENlbGxzKSB7IC8qIGFscmVhZHkgbGl0ICovXG5cdFx0XHR2YXIgcmVzdWx0ID0gbGl0Q2VsbHNbZm92S2V5XTtcblx0XHR9IGVsc2UgeyAvKiBuZXdseSBsaXQgKi9cblx0XHRcdHZhciByZXN1bHQgPSBbMCwgMCwgMF07XG5cdFx0XHRsaXRDZWxsc1tmb3ZLZXldID0gcmVzdWx0O1xuXHRcdH1cblxuXHRcdGZvciAodmFyIGk9MDtpPDM7aSsrKSB7IHJlc3VsdFtpXSArPSBNYXRoLnJvdW5kKGNvbG9yW2ldKmZvcm1GYWN0b3IpOyB9IC8qIGFkZCBsaWdodCBjb2xvciAqL1xuXHR9XG5cblx0cmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIENvbXB1dGUgRk9WIChcImZvcm0gZmFjdG9yXCIpIGZvciBhIHBvdGVudGlhbCBsaWdodCBzb3VyY2UgYXQgW3gseV1cbiAqIEBwYXJhbSB7aW50fSB4XG4gKiBAcGFyYW0ge2ludH0geVxuICogQHJldHVybnMge29iamVjdH1cbiAqL1xuUk9ULkxpZ2h0aW5nLnByb3RvdHlwZS5fdXBkYXRlRk9WID0gZnVuY3Rpb24oeCwgeSkge1xuXHR2YXIga2V5MSA9IHgrXCIsXCIreTtcblx0dmFyIGNhY2hlID0ge307XG5cdHRoaXMuX2ZvdkNhY2hlW2tleTFdID0gY2FjaGU7XG5cdHZhciByYW5nZSA9IHRoaXMuX29wdGlvbnMucmFuZ2U7XG5cdHZhciBjYiA9IGZ1bmN0aW9uKHgsIHksIHIsIHZpcykge1xuXHRcdHZhciBrZXkyID0geCtcIixcIit5O1xuXHRcdHZhciBmb3JtRmFjdG9yID0gdmlzICogKDEtci9yYW5nZSk7XG5cdFx0aWYgKGZvcm1GYWN0b3IgPT0gMCkgeyByZXR1cm47IH1cblx0XHRjYWNoZVtrZXkyXSA9IGZvcm1GYWN0b3I7XG5cdH07XG5cdHRoaXMuX2Zvdi5jb21wdXRlKHgsIHksIHJhbmdlLCBjYi5iaW5kKHRoaXMpKTtcblxuXHRyZXR1cm4gY2FjaGU7XG59O1xuLyoqXG4gKiBAY2xhc3MgQWJzdHJhY3QgcGF0aGZpbmRlclxuICogQHBhcmFtIHtpbnR9IHRvWCBUYXJnZXQgWCBjb29yZFxuICogQHBhcmFtIHtpbnR9IHRvWSBUYXJnZXQgWSBjb29yZFxuICogQHBhcmFtIHtmdW5jdGlvbn0gcGFzc2FibGVDYWxsYmFjayBDYWxsYmFjayB0byBkZXRlcm1pbmUgbWFwIHBhc3NhYmlsaXR5XG4gKiBAcGFyYW0ge29iamVjdH0gW29wdGlvbnNdXG4gKiBAcGFyYW0ge2ludH0gW29wdGlvbnMudG9wb2xvZ3k9OF1cbiAqL1xuUk9ULlBhdGggPSBmdW5jdGlvbih0b1gsIHRvWSwgcGFzc2FibGVDYWxsYmFjaywgb3B0aW9ucykge1xuXHR0aGlzLl90b1ggPSB0b1g7XG5cdHRoaXMuX3RvWSA9IHRvWTtcblx0dGhpcy5fZnJvbVggPSBudWxsO1xuXHR0aGlzLl9mcm9tWSA9IG51bGw7XG5cdHRoaXMuX3Bhc3NhYmxlQ2FsbGJhY2sgPSBwYXNzYWJsZUNhbGxiYWNrO1xuXHR0aGlzLl9vcHRpb25zID0ge1xuXHRcdHRvcG9sb2d5OiA4XG5cdH07XG5cdGZvciAodmFyIHAgaW4gb3B0aW9ucykgeyB0aGlzLl9vcHRpb25zW3BdID0gb3B0aW9uc1twXTsgfVxuXG5cdHRoaXMuX2RpcnMgPSBST1QuRElSU1t0aGlzLl9vcHRpb25zLnRvcG9sb2d5XTtcblx0aWYgKHRoaXMuX29wdGlvbnMudG9wb2xvZ3kgPT0gOCkgeyAvKiByZW9yZGVyIGRpcnMgZm9yIG1vcmUgYWVzdGhldGljIHJlc3VsdCAodmVydGljYWwvaG9yaXpvbnRhbCBmaXJzdCkgKi9cblx0XHR0aGlzLl9kaXJzID0gW1xuXHRcdFx0dGhpcy5fZGlyc1swXSxcblx0XHRcdHRoaXMuX2RpcnNbMl0sXG5cdFx0XHR0aGlzLl9kaXJzWzRdLFxuXHRcdFx0dGhpcy5fZGlyc1s2XSxcblx0XHRcdHRoaXMuX2RpcnNbMV0sXG5cdFx0XHR0aGlzLl9kaXJzWzNdLFxuXHRcdFx0dGhpcy5fZGlyc1s1XSxcblx0XHRcdHRoaXMuX2RpcnNbN11cblx0XHRdXG5cdH1cbn07XG5cbi8qKlxuICogQ29tcHV0ZSBhIHBhdGggZnJvbSBhIGdpdmVuIHBvaW50XG4gKiBAcGFyYW0ge2ludH0gZnJvbVhcbiAqIEBwYXJhbSB7aW50fSBmcm9tWVxuICogQHBhcmFtIHtmdW5jdGlvbn0gY2FsbGJhY2sgV2lsbCBiZSBjYWxsZWQgZm9yIGV2ZXJ5IHBhdGggaXRlbSB3aXRoIGFyZ3VtZW50cyBcInhcIiBhbmQgXCJ5XCJcbiAqL1xuUk9ULlBhdGgucHJvdG90eXBlLmNvbXB1dGUgPSBmdW5jdGlvbihmcm9tWCwgZnJvbVksIGNhbGxiYWNrKSB7XG59O1xuXG5ST1QuUGF0aC5wcm90b3R5cGUuX2dldE5laWdoYm9ycyA9IGZ1bmN0aW9uKGN4LCBjeSkge1xuXHR2YXIgcmVzdWx0ID0gW107XG5cdGZvciAodmFyIGk9MDtpPHRoaXMuX2RpcnMubGVuZ3RoO2krKykge1xuXHRcdHZhciBkaXIgPSB0aGlzLl9kaXJzW2ldO1xuXHRcdHZhciB4ID0gY3ggKyBkaXJbMF07XG5cdFx0dmFyIHkgPSBjeSArIGRpclsxXTtcblx0XHRcblx0XHRpZiAoIXRoaXMuX3Bhc3NhYmxlQ2FsbGJhY2soeCwgeSkpIHsgY29udGludWU7IH1cblx0XHRyZXN1bHQucHVzaChbeCwgeV0pO1xuXHR9XG5cdFxuXHRyZXR1cm4gcmVzdWx0O1xufTtcbi8qKlxuICogQGNsYXNzIFNpbXBsaWZpZWQgRGlqa3N0cmEncyBhbGdvcml0aG06IGFsbCBlZGdlcyBoYXZlIGEgdmFsdWUgb2YgMVxuICogQGF1Z21lbnRzIFJPVC5QYXRoXG4gKiBAc2VlIFJPVC5QYXRoXG4gKi9cblJPVC5QYXRoLkRpamtzdHJhID0gZnVuY3Rpb24odG9YLCB0b1ksIHBhc3NhYmxlQ2FsbGJhY2ssIG9wdGlvbnMpIHtcblx0Uk9ULlBhdGguY2FsbCh0aGlzLCB0b1gsIHRvWSwgcGFzc2FibGVDYWxsYmFjaywgb3B0aW9ucyk7XG5cblx0dGhpcy5fY29tcHV0ZWQgPSB7fTtcblx0dGhpcy5fdG9kbyA9IFtdO1xuXHR0aGlzLl9hZGQodG9YLCB0b1ksIG51bGwpO1xufTtcblJPVC5QYXRoLkRpamtzdHJhLmV4dGVuZChST1QuUGF0aCk7XG5cbi8qKlxuICogQ29tcHV0ZSBhIHBhdGggZnJvbSBhIGdpdmVuIHBvaW50XG4gKiBAc2VlIFJPVC5QYXRoI2NvbXB1dGVcbiAqL1xuUk9ULlBhdGguRGlqa3N0cmEucHJvdG90eXBlLmNvbXB1dGUgPSBmdW5jdGlvbihmcm9tWCwgZnJvbVksIGNhbGxiYWNrKSB7XG5cdHZhciBrZXkgPSBmcm9tWCtcIixcIitmcm9tWTtcblx0aWYgKCEoa2V5IGluIHRoaXMuX2NvbXB1dGVkKSkgeyB0aGlzLl9jb21wdXRlKGZyb21YLCBmcm9tWSk7IH1cblx0aWYgKCEoa2V5IGluIHRoaXMuX2NvbXB1dGVkKSkgeyByZXR1cm47IH1cblx0XG5cdHZhciBpdGVtID0gdGhpcy5fY29tcHV0ZWRba2V5XTtcblx0d2hpbGUgKGl0ZW0pIHtcblx0XHRjYWxsYmFjayhpdGVtLngsIGl0ZW0ueSk7XG5cdFx0aXRlbSA9IGl0ZW0ucHJldjtcblx0fVxufTtcblxuLyoqXG4gKiBDb21wdXRlIGEgbm9uLWNhY2hlZCB2YWx1ZVxuICovXG5ST1QuUGF0aC5EaWprc3RyYS5wcm90b3R5cGUuX2NvbXB1dGUgPSBmdW5jdGlvbihmcm9tWCwgZnJvbVkpIHtcblx0d2hpbGUgKHRoaXMuX3RvZG8ubGVuZ3RoKSB7XG5cdFx0dmFyIGl0ZW0gPSB0aGlzLl90b2RvLnNoaWZ0KCk7XG5cdFx0aWYgKGl0ZW0ueCA9PSBmcm9tWCAmJiBpdGVtLnkgPT0gZnJvbVkpIHsgcmV0dXJuOyB9XG5cdFx0XG5cdFx0dmFyIG5laWdoYm9ycyA9IHRoaXMuX2dldE5laWdoYm9ycyhpdGVtLngsIGl0ZW0ueSk7XG5cdFx0XG5cdFx0Zm9yICh2YXIgaT0wO2k8bmVpZ2hib3JzLmxlbmd0aDtpKyspIHtcblx0XHRcdHZhciBuZWlnaGJvciA9IG5laWdoYm9yc1tpXTtcblx0XHRcdHZhciB4ID0gbmVpZ2hib3JbMF07XG5cdFx0XHR2YXIgeSA9IG5laWdoYm9yWzFdO1xuXHRcdFx0dmFyIGlkID0geCtcIixcIit5O1xuXHRcdFx0aWYgKGlkIGluIHRoaXMuX2NvbXB1dGVkKSB7IGNvbnRpbnVlOyB9IC8qIGFscmVhZHkgZG9uZSAqL1x0XG5cdFx0XHR0aGlzLl9hZGQoeCwgeSwgaXRlbSk7IFxuXHRcdH1cblx0fVxufTtcblxuUk9ULlBhdGguRGlqa3N0cmEucHJvdG90eXBlLl9hZGQgPSBmdW5jdGlvbih4LCB5LCBwcmV2KSB7XG5cdHZhciBvYmogPSB7XG5cdFx0eDogeCxcblx0XHR5OiB5LFxuXHRcdHByZXY6IHByZXZcblx0fTtcblx0dGhpcy5fY29tcHV0ZWRbeCtcIixcIit5XSA9IG9iajtcblx0dGhpcy5fdG9kby5wdXNoKG9iaik7XG59O1xuLyoqXG4gKiBAY2xhc3MgU2ltcGxpZmllZCBBKiBhbGdvcml0aG06IGFsbCBlZGdlcyBoYXZlIGEgdmFsdWUgb2YgMVxuICogQGF1Z21lbnRzIFJPVC5QYXRoXG4gKiBAc2VlIFJPVC5QYXRoXG4gKi9cblJPVC5QYXRoLkFTdGFyID0gZnVuY3Rpb24odG9YLCB0b1ksIHBhc3NhYmxlQ2FsbGJhY2ssIG9wdGlvbnMpIHtcblx0Uk9ULlBhdGguY2FsbCh0aGlzLCB0b1gsIHRvWSwgcGFzc2FibGVDYWxsYmFjaywgb3B0aW9ucyk7XG5cblx0dGhpcy5fdG9kbyA9IFtdO1xuXHR0aGlzLl9kb25lID0ge307XG5cdHRoaXMuX2Zyb21YID0gbnVsbDtcblx0dGhpcy5fZnJvbVkgPSBudWxsO1xufTtcblJPVC5QYXRoLkFTdGFyLmV4dGVuZChST1QuUGF0aCk7XG5cbi8qKlxuICogQ29tcHV0ZSBhIHBhdGggZnJvbSBhIGdpdmVuIHBvaW50XG4gKiBAc2VlIFJPVC5QYXRoI2NvbXB1dGVcbiAqL1xuUk9ULlBhdGguQVN0YXIucHJvdG90eXBlLmNvbXB1dGUgPSBmdW5jdGlvbihmcm9tWCwgZnJvbVksIGNhbGxiYWNrKSB7XG5cdHRoaXMuX3RvZG8gPSBbXTtcblx0dGhpcy5fZG9uZSA9IHt9O1xuXHR0aGlzLl9mcm9tWCA9IGZyb21YO1xuXHR0aGlzLl9mcm9tWSA9IGZyb21ZO1xuXHR0aGlzLl9hZGQodGhpcy5fdG9YLCB0aGlzLl90b1ksIG51bGwpO1xuXG5cdHdoaWxlICh0aGlzLl90b2RvLmxlbmd0aCkge1xuXHRcdHZhciBpdGVtID0gdGhpcy5fdG9kby5zaGlmdCgpO1xuXHRcdHZhciBpZCA9IGl0ZW0ueCtcIixcIitpdGVtLnk7XG5cdFx0aWYgKGlkIGluIHRoaXMuX2RvbmUpIHsgY29udGludWU7IH1cblx0XHR0aGlzLl9kb25lW2lkXSA9IGl0ZW07XG5cdFx0aWYgKGl0ZW0ueCA9PSBmcm9tWCAmJiBpdGVtLnkgPT0gZnJvbVkpIHsgYnJlYWs7IH1cblxuXHRcdHZhciBuZWlnaGJvcnMgPSB0aGlzLl9nZXROZWlnaGJvcnMoaXRlbS54LCBpdGVtLnkpO1xuXG5cdFx0Zm9yICh2YXIgaT0wO2k8bmVpZ2hib3JzLmxlbmd0aDtpKyspIHtcblx0XHRcdHZhciBuZWlnaGJvciA9IG5laWdoYm9yc1tpXTtcblx0XHRcdHZhciB4ID0gbmVpZ2hib3JbMF07XG5cdFx0XHR2YXIgeSA9IG5laWdoYm9yWzFdO1xuXHRcdFx0dmFyIGlkID0geCtcIixcIit5O1xuXHRcdFx0aWYgKGlkIGluIHRoaXMuX2RvbmUpIHsgY29udGludWU7IH1cblx0XHRcdHRoaXMuX2FkZCh4LCB5LCBpdGVtKTsgXG5cdFx0fVxuXHR9XG5cdFxuXHR2YXIgaXRlbSA9IHRoaXMuX2RvbmVbZnJvbVgrXCIsXCIrZnJvbVldO1xuXHRpZiAoIWl0ZW0pIHsgcmV0dXJuOyB9XG5cdFxuXHR3aGlsZSAoaXRlbSkge1xuXHRcdGNhbGxiYWNrKGl0ZW0ueCwgaXRlbS55KTtcblx0XHRpdGVtID0gaXRlbS5wcmV2O1xuXHR9XG59O1xuXG5ST1QuUGF0aC5BU3Rhci5wcm90b3R5cGUuX2FkZCA9IGZ1bmN0aW9uKHgsIHksIHByZXYpIHtcblx0dmFyIGggPSB0aGlzLl9kaXN0YW5jZSh4LCB5KTtcblx0dmFyIG9iaiA9IHtcblx0XHR4OiB4LFxuXHRcdHk6IHksXG5cdFx0cHJldjogcHJldixcblx0XHRnOiAocHJldiA/IHByZXYuZysxIDogMCksXG5cdFx0aDogaFxuXHR9O1xuXHRcblx0LyogaW5zZXJ0IGludG8gcHJpb3JpdHkgcXVldWUgKi9cblx0XG5cdHZhciBmID0gb2JqLmcgKyBvYmouaDtcblx0Zm9yICh2YXIgaT0wO2k8dGhpcy5fdG9kby5sZW5ndGg7aSsrKSB7XG5cdFx0dmFyIGl0ZW0gPSB0aGlzLl90b2RvW2ldO1xuXHRcdHZhciBpdGVtRiA9IGl0ZW0uZyArIGl0ZW0uaDtcblx0XHRpZiAoZiA8IGl0ZW1GIHx8IChmID09IGl0ZW1GICYmIGggPCBpdGVtLmgpKSB7XG5cdFx0XHR0aGlzLl90b2RvLnNwbGljZShpLCAwLCBvYmopO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0fVxuXHRcblx0dGhpcy5fdG9kby5wdXNoKG9iaik7XG59O1xuXG5ST1QuUGF0aC5BU3Rhci5wcm90b3R5cGUuX2Rpc3RhbmNlID0gZnVuY3Rpb24oeCwgeSkge1xuXHRzd2l0Y2ggKHRoaXMuX29wdGlvbnMudG9wb2xvZ3kpIHtcblx0XHRjYXNlIDQ6XG5cdFx0XHRyZXR1cm4gKE1hdGguYWJzKHgtdGhpcy5fZnJvbVgpICsgTWF0aC5hYnMoeS10aGlzLl9mcm9tWSkpO1xuXHRcdGJyZWFrO1xuXG5cdFx0Y2FzZSA2OlxuXHRcdFx0dmFyIGR4ID0gTWF0aC5hYnMoeCAtIHRoaXMuX2Zyb21YKTtcblx0XHRcdHZhciBkeSA9IE1hdGguYWJzKHkgLSB0aGlzLl9mcm9tWSk7XG5cdFx0XHRyZXR1cm4gZHkgKyBNYXRoLm1heCgwLCAoZHgtZHkpLzIpO1xuXHRcdGJyZWFrO1xuXG5cdFx0Y2FzZSA4OiBcblx0XHRcdHJldHVybiBNYXRoLm1heChNYXRoLmFicyh4LXRoaXMuX2Zyb21YKSwgTWF0aC5hYnMoeS10aGlzLl9mcm9tWSkpO1xuXHRcdGJyZWFrO1xuXHR9XG5cbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSWxsZWdhbCB0b3BvbG9neVwiKTtcbn07XG4vKipcbiAqIEBjbGFzcyBUZXJtaW5hbCBiYWNrZW5kXG4gKiBAcHJpdmF0ZVxuICovXG5ST1QuRGlzcGxheS5UZXJtID0gZnVuY3Rpb24oY29udGV4dCkge1xuXHRST1QuRGlzcGxheS5CYWNrZW5kLmNhbGwodGhpcywgY29udGV4dCk7XG5cdHRoaXMuX2N4ID0gLTE7XG5cdHRoaXMuX2N5ID0gLTE7XG5cdHRoaXMuX2xhc3RDb2xvciA9IFwiXCI7XG5cdHRoaXMuX29wdGlvbnMgPSB7fTtcblx0dGhpcy5fb3ggPSAwO1xuXHR0aGlzLl9veSA9IDA7XG5cdHRoaXMuX3Rlcm1jb2xvciA9IHt9O1xufVxuUk9ULkRpc3BsYXkuVGVybS5leHRlbmQoUk9ULkRpc3BsYXkuQmFja2VuZCk7XG5cblJPVC5EaXNwbGF5LlRlcm0ucHJvdG90eXBlLmNvbXB1dGUgPSBmdW5jdGlvbihvcHRpb25zKSB7XG5cdHRoaXMuX29wdGlvbnMgPSBvcHRpb25zO1xuXHR0aGlzLl9veCA9IE1hdGguZmxvb3IoKHByb2Nlc3Muc3Rkb3V0LmNvbHVtbnMgLSBvcHRpb25zLndpZHRoKSAvIDIpO1xuXHR0aGlzLl9veSA9IE1hdGguZmxvb3IoKHByb2Nlc3Muc3Rkb3V0LnJvd3MgLSBvcHRpb25zLmhlaWdodCkgLyAyKTtcblx0dGhpcy5fdGVybWNvbG9yID0gbmV3IFJPVC5EaXNwbGF5LlRlcm1bb3B0aW9ucy50ZXJtQ29sb3IuY2FwaXRhbGl6ZSgpXSh0aGlzLl9jb250ZXh0KTtcblx0dGhpcy5fY29udGV4dC5fdGVybWNvbG9yID0gdGhpcy5fdGVybWNvbG9yO1xufVxuXG5ST1QuRGlzcGxheS5UZXJtLnByb3RvdHlwZS5kcmF3ID0gZnVuY3Rpb24oZGF0YSwgY2xlYXJCZWZvcmUpIHtcblx0Ly8gZGV0ZXJtaW5lIHdoZXJlIHRvIGRyYXcgd2hhdCB3aXRoIHdoYXQgY29sb3JzXG5cdHZhciB4ID0gZGF0YVswXTtcblx0dmFyIHkgPSBkYXRhWzFdO1xuXHR2YXIgY2ggPSBkYXRhWzJdO1xuXHR2YXIgZmcgPSBkYXRhWzNdO1xuXHR2YXIgYmcgPSBkYXRhWzRdO1xuXG5cdC8vIGRldGVybWluZSBpZiB3ZSBuZWVkIHRvIG1vdmUgdGhlIHRlcm1pbmFsIGN1cnNvclxuXHR2YXIgZHggPSB0aGlzLl9veCArIHg7XG5cdHZhciBkeSA9IHRoaXMuX295ICsgeTtcblx0aWYgKGR4IDwgMCB8fCBkeCA+PSBwcm9jZXNzLnN0ZG91dC5jb2x1bW5zKSB7IHJldHVybjsgfVxuXHRpZiAoZHkgPCAwIHx8IGR5ID49IHByb2Nlc3Muc3Rkb3V0LnJvd3MpIHsgcmV0dXJuOyB9XG5cdGlmIChkeCAhPT0gdGhpcy5fY3ggfHwgZHkgIT09IHRoaXMuX2N5KSB7XG5cdFx0cHJvY2Vzcy5zdGRvdXQud3JpdGUodGhpcy5fdGVybWNvbG9yLnBvc2l0aW9uVG9BbnNpKGR4LGR5KSk7XG5cdFx0dGhpcy5fY3ggPSBkeDtcblx0XHR0aGlzLl9jeSA9IGR5O1xuXHR9XG5cblx0Ly8gdGVybWluYWxzIGF1dG9tYXRpY2FsbHkgY2xlYXIsIGJ1dCBpZiB3ZSdyZSBjbGVhcmluZyB3aGVuIHdlJ3JlXG5cdC8vIG5vdCBvdGhlcndpc2UgcHJvdmlkZWQgd2l0aCBhIGNoYXJhY3RlciwganVzdCB1c2UgYSBzcGFjZSBpbnN0ZWFkXG5cdGlmIChjbGVhckJlZm9yZSkge1xuXHRcdGlmICghY2gpIHtcblx0XHRcdGNoID0gXCIgXCI7XG5cdFx0fVxuXHR9XG5cdFx0XG5cdC8vIGlmIHdlJ3JlIG5vdCBjbGVhcmluZyBhbmQgbm90IHByb3ZpZGVkIHdpdGggYSBjaGFyYWN0ZXIsIGRvIG5vdGhpbmdcblx0aWYgKCFjaCkgeyByZXR1cm47IH1cblxuXHQvLyBkZXRlcm1pbmUgaWYgd2UgbmVlZCB0byBjaGFuZ2UgY29sb3JzXG5cdHZhciBuZXdDb2xvciA9IHRoaXMuX3Rlcm1jb2xvci5jb2xvclRvQW5zaShmZyxiZyk7XG5cdGlmIChuZXdDb2xvciAhPT0gdGhpcy5fbGFzdENvbG9yKSB7XG5cdFx0cHJvY2Vzcy5zdGRvdXQud3JpdGUobmV3Q29sb3IpO1xuXHRcdHRoaXMuX2xhc3RDb2xvciA9IG5ld0NvbG9yO1xuXHR9XG5cblx0Ly8gd3JpdGUgdGhlIHByb3ZpZGVkIHN5bWJvbCB0byB0aGUgZGlzcGxheVxuXHR2YXIgY2hhcnMgPSBbXS5jb25jYXQoY2gpO1xuXHRwcm9jZXNzLnN0ZG91dC53cml0ZShjaGFyc1swXSk7XG5cblx0Ly8gdXBkYXRlIG91ciBwb3NpdGlvbiwgZ2l2ZW4gdGhhdCB3ZSB3cm90ZSBhIGNoYXJhY3RlclxuXHR0aGlzLl9jeCsrO1xuXHRpZiAodGhpcy5fY3ggPj0gcHJvY2Vzcy5zdGRvdXQuY29sdW1ucykge1xuXHRcdHRoaXMuX2N4ID0gMDtcblx0XHR0aGlzLl9jeSsrO1xuXHR9XG59XG5cblJPVC5EaXNwbGF5LlRlcm0ucHJvdG90eXBlLmNvbXB1dGVTaXplID0gZnVuY3Rpb24oYXZhaWxXaWR0aCwgYXZhaWxIZWlnaHQpIHtcblx0cmV0dXJuIFtwcm9jZXNzLnN0ZG91dC5jb2x1bW5zLCBwcm9jZXNzLnN0ZG91dC5yb3dzXTtcbn1cblxuUk9ULkRpc3BsYXkuVGVybS5wcm90b3R5cGUuY29tcHV0ZUZvbnRTaXplID0gZnVuY3Rpb24oYXZhaWxXaWR0aCwgYXZhaWxIZWlnaHQpIHtcblx0cmV0dXJuIDEyO1xufVxuXG5ST1QuRGlzcGxheS5UZXJtLnByb3RvdHlwZS5ldmVudFRvUG9zaXRpb24gPSBmdW5jdGlvbih4LCB5KSB7XG5cdHJldHVybiBbeCx5XVxufVxuLyoqXG4gKiBAY2xhc3MgQWJzdHJhY3QgdGVybWluYWwgY29kZSBtb2R1bGVcbiAqIEBwcml2YXRlXG4gKi9cblJPVC5EaXNwbGF5LlRlcm0uQ29sb3IgPSBmdW5jdGlvbihjb250ZXh0KSB7XG5cdHRoaXMuX2NvbnRleHQgPSBjb250ZXh0O1xufVxuXG5ST1QuRGlzcGxheS5UZXJtLkNvbG9yLnByb3RvdHlwZS5jbGVhclRvQW5zaSA9IGZ1bmN0aW9uKGJnKSB7XG59XG5cblJPVC5EaXNwbGF5LlRlcm0uQ29sb3IucHJvdG90eXBlLmNvbG9yVG9BbnNpID0gZnVuY3Rpb24oZmcsIGJnKSB7XG59XG5cblJPVC5EaXNwbGF5LlRlcm0uQ29sb3IucHJvdG90eXBlLnBvc2l0aW9uVG9BbnNpID0gZnVuY3Rpb24oeCwgeSkge1xufVxuLyoqXG4gKiBAY2xhc3MgeHRlcm0gdGVybWluYWwgY29kZSBtb2R1bGVcbiAqIEBwcml2YXRlXG4gKi9cblJPVC5EaXNwbGF5LlRlcm0uWHRlcm0gPSBmdW5jdGlvbihjb250ZXh0KSB7XG5cdFJPVC5EaXNwbGF5LlRlcm0uQ29sb3IuY2FsbCh0aGlzLCBjb250ZXh0KTtcbn1cblJPVC5EaXNwbGF5LlRlcm0uWHRlcm0uZXh0ZW5kKFJPVC5EaXNwbGF5LlRlcm0uQ29sb3IpO1xuXG5ST1QuRGlzcGxheS5UZXJtLlh0ZXJtLnByb3RvdHlwZS5jbGVhclRvQW5zaSA9IGZ1bmN0aW9uKGJnKSB7XG5cdHJldHVybiBcIlxceDFiWzA7NDg7NTtcIlxuXHRcdCsgdGhpcy5fdGVybWNvbG9yKGJnKVxuXHRcdCsgXCJtXFx4MWJbMkpcIjtcbn1cblxuUk9ULkRpc3BsYXkuVGVybS5YdGVybS5wcm90b3R5cGUuY29sb3JUb0Fuc2kgPSBmdW5jdGlvbihmZywgYmcpIHtcblx0cmV0dXJuIFwiXFx4MWJbMDszODs1O1wiXG5cdFx0KyB0aGlzLl90ZXJtY29sb3IoZmcpXG5cdFx0KyBcIjs0ODs1O1wiXG5cdFx0KyB0aGlzLl90ZXJtY29sb3IoYmcpXG5cdFx0KyBcIm1cIjtcbn1cblxuUk9ULkRpc3BsYXkuVGVybS5YdGVybS5wcm90b3R5cGUucG9zaXRpb25Ub0Fuc2kgPSBmdW5jdGlvbih4LCB5KSB7XG5cdHJldHVybiBcIlxceDFiW1wiICsgKHkrMSkgKyBcIjtcIiArICh4KzEpICsgXCJIXCI7XG59XG5cblJPVC5EaXNwbGF5LlRlcm0uWHRlcm0ucHJvdG90eXBlLl90ZXJtY29sb3IgPSBmdW5jdGlvbihjb2xvcikge1xuXHR2YXIgU1JDX0NPTE9SUyA9IDI1Ni4wO1xuXHR2YXIgRFNUX0NPTE9SUyA9IDYuMDtcblx0dmFyIENPTE9SX1JBVElPID0gRFNUX0NPTE9SUyAvIFNSQ19DT0xPUlM7XG5cdHZhciByZ2IgPSBST1QuQ29sb3IuZnJvbVN0cmluZyhjb2xvcik7XG5cdHZhciByID0gTWF0aC5mbG9vcihyZ2JbMF0gKiBDT0xPUl9SQVRJTyk7XG5cdHZhciBnID0gTWF0aC5mbG9vcihyZ2JbMV0gKiBDT0xPUl9SQVRJTyk7XG5cdHZhciBiID0gTWF0aC5mbG9vcihyZ2JbMl0gKiBDT0xPUl9SQVRJTyk7XG5cdHJldHVybiByKjM2ICsgZyo2ICsgYioxICsgMTY7XG59XG4vKipcbiAqIEV4cG9ydCB0byBOb2RlLmpzIG1vZHVsZVxuICovXG5mb3IgKHZhciBwIGluIFJPVCkge1xuXHRleHBvcnRzW3BdID0gUk9UW3BdO1xufVxuICByZXR1cm4gUk9UO1xufSkpO1xuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/rot-js/lib/rot.js\n");

/***/ }),

/***/ "./node_modules/webpack/buildin/amd-options.js":
/*!****************************************!*\
  !*** (webpack)/buildin/amd-options.js ***!
  \****************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("/* WEBPACK VAR INJECTION */(function(__webpack_amd_options__) {/* globals __webpack_amd_options__ */\r\nmodule.exports = __webpack_amd_options__;\r\n\n/* WEBPACK VAR INJECTION */}.call(this, {}))\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vKHdlYnBhY2spL2J1aWxkaW4vYW1kLW9wdGlvbnMuanM/MDA4NiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBIiwiZmlsZSI6Ii4vbm9kZV9tb2R1bGVzL3dlYnBhY2svYnVpbGRpbi9hbWQtb3B0aW9ucy5qcy5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qIGdsb2JhbHMgX193ZWJwYWNrX2FtZF9vcHRpb25zX18gKi9cclxubW9kdWxlLmV4cG9ydHMgPSBfX3dlYnBhY2tfYW1kX29wdGlvbnNfXztcclxuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/webpack/buildin/amd-options.js\n");

/***/ }),

/***/ "./node_modules/webpack/buildin/global.js":
/*!***********************************!*\
  !*** (webpack)/buildin/global.js ***!
  \***********************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("var g;\r\n\r\n// This works in non-strict mode\r\ng = (function() {\r\n\treturn this;\r\n})();\r\n\r\ntry {\r\n\t// This works if eval is allowed (see CSP)\r\n\tg = g || Function(\"return this\")() || (1, eval)(\"this\");\r\n} catch (e) {\r\n\t// This works if the window reference is available\r\n\tif (typeof window === \"object\") g = window;\r\n}\r\n\r\n// g can still be undefined, but nothing to do about it...\r\n// We return undefined, instead of nothing here, so it's\r\n// easier to handle this case. if(!global) { ...}\r\n\r\nmodule.exports = g;\r\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vKHdlYnBhY2spL2J1aWxkaW4vZ2xvYmFsLmpzP2NkMDAiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsQ0FBQzs7QUFFRDtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSw0Q0FBNEM7O0FBRTVDIiwiZmlsZSI6Ii4vbm9kZV9tb2R1bGVzL3dlYnBhY2svYnVpbGRpbi9nbG9iYWwuanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgZztcclxuXHJcbi8vIFRoaXMgd29ya3MgaW4gbm9uLXN0cmljdCBtb2RlXHJcbmcgPSAoZnVuY3Rpb24oKSB7XHJcblx0cmV0dXJuIHRoaXM7XHJcbn0pKCk7XHJcblxyXG50cnkge1xyXG5cdC8vIFRoaXMgd29ya3MgaWYgZXZhbCBpcyBhbGxvd2VkIChzZWUgQ1NQKVxyXG5cdGcgPSBnIHx8IEZ1bmN0aW9uKFwicmV0dXJuIHRoaXNcIikoKSB8fCAoMSwgZXZhbCkoXCJ0aGlzXCIpO1xyXG59IGNhdGNoIChlKSB7XHJcblx0Ly8gVGhpcyB3b3JrcyBpZiB0aGUgd2luZG93IHJlZmVyZW5jZSBpcyBhdmFpbGFibGVcclxuXHRpZiAodHlwZW9mIHdpbmRvdyA9PT0gXCJvYmplY3RcIikgZyA9IHdpbmRvdztcclxufVxyXG5cclxuLy8gZyBjYW4gc3RpbGwgYmUgdW5kZWZpbmVkLCBidXQgbm90aGluZyB0byBkbyBhYm91dCBpdC4uLlxyXG4vLyBXZSByZXR1cm4gdW5kZWZpbmVkLCBpbnN0ZWFkIG9mIG5vdGhpbmcgaGVyZSwgc28gaXQnc1xyXG4vLyBlYXNpZXIgdG8gaGFuZGxlIHRoaXMgY2FzZS4gaWYoIWdsb2JhbCkgeyAuLi59XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IGc7XHJcbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/webpack/buildin/global.js\n");

/***/ }),

/***/ "./node_modules/webpack/buildin/module.js":
/*!***********************************!*\
  !*** (webpack)/buildin/module.js ***!
  \***********************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = function(module) {\r\n\tif (!module.webpackPolyfill) {\r\n\t\tmodule.deprecate = function() {};\r\n\t\tmodule.paths = [];\r\n\t\t// module.parent = undefined by default\r\n\t\tif (!module.children) module.children = [];\r\n\t\tObject.defineProperty(module, \"loaded\", {\r\n\t\t\tenumerable: true,\r\n\t\t\tget: function() {\r\n\t\t\t\treturn module.l;\r\n\t\t\t}\r\n\t\t});\r\n\t\tObject.defineProperty(module, \"id\", {\r\n\t\t\tenumerable: true,\r\n\t\t\tget: function() {\r\n\t\t\t\treturn module.i;\r\n\t\t\t}\r\n\t\t});\r\n\t\tmodule.webpackPolyfill = 1;\r\n\t}\r\n\treturn module;\r\n};\r\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vKHdlYnBhY2spL2J1aWxkaW4vbW9kdWxlLmpzP2NlZDIiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6Ii4vbm9kZV9tb2R1bGVzL3dlYnBhY2svYnVpbGRpbi9tb2R1bGUuanMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG1vZHVsZSkge1xyXG5cdGlmICghbW9kdWxlLndlYnBhY2tQb2x5ZmlsbCkge1xyXG5cdFx0bW9kdWxlLmRlcHJlY2F0ZSA9IGZ1bmN0aW9uKCkge307XHJcblx0XHRtb2R1bGUucGF0aHMgPSBbXTtcclxuXHRcdC8vIG1vZHVsZS5wYXJlbnQgPSB1bmRlZmluZWQgYnkgZGVmYXVsdFxyXG5cdFx0aWYgKCFtb2R1bGUuY2hpbGRyZW4pIG1vZHVsZS5jaGlsZHJlbiA9IFtdO1xyXG5cdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG1vZHVsZSwgXCJsb2FkZWRcIiwge1xyXG5cdFx0XHRlbnVtZXJhYmxlOiB0cnVlLFxyXG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdHJldHVybiBtb2R1bGUubDtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobW9kdWxlLCBcImlkXCIsIHtcclxuXHRcdFx0ZW51bWVyYWJsZTogdHJ1ZSxcclxuXHRcdFx0Z2V0OiBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRyZXR1cm4gbW9kdWxlLmk7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdFx0bW9kdWxlLndlYnBhY2tQb2x5ZmlsbCA9IDE7XHJcblx0fVxyXG5cdHJldHVybiBtb2R1bGU7XHJcbn07XHJcbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/webpack/buildin/module.js\n");

/***/ }),

/***/ "./src/ares/parts.ts":
/*!***************************!*\
  !*** ./src/ares/parts.ts ***!
  \***************************/
/*! exports provided: updateMonsterParts, placeMonsterPartsOnGrid, removeMonsterPartsFromGrid */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"updateMonsterParts\", function() { return updateMonsterParts; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"placeMonsterPartsOnGrid\", function() { return placeMonsterPartsOnGrid; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"removeMonsterPartsFromGrid\", function() { return removeMonsterPartsFromGrid; });\n/* harmony import */ var _brew__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../brew */ \"./src/brew.ts\");\n\r\nlet facingPointerLookup = {};\r\nfacingPointerLookup[_brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].xyToKey(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Directions\"].RIGHT)] = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Symbols\"].pointer_right;\r\nfacingPointerLookup[_brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].xyToKey(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Directions\"].LEFT)] = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Symbols\"].pointer_left;\r\nfacingPointerLookup[_brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].xyToKey(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Directions\"].UP)] = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Symbols\"].pointer_up;\r\nfacingPointerLookup[_brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].xyToKey(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Directions\"].DOWN)] = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Symbols\"].pointer_down;\r\nfacingPointerLookup[_brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].xyToKey(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Directions\"].DOWN_LEFT)] = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Symbols\"].pointer_downleft;\r\nfacingPointerLookup[_brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].xyToKey(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Directions\"].DOWN_RIGHT)] = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Symbols\"].pointer_downright;\r\nfacingPointerLookup[_brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].xyToKey(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Directions\"].UP_RIGHT)] = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Symbols\"].pointer_upright;\r\nfacingPointerLookup[_brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].xyToKey(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Directions\"].UP_LEFT)] = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Symbols\"].pointer_upleft;\r\nfunction getFacingPointerForOffset(offset_xy) {\r\n    return facingPointerLookup[_brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].xyToKey(offset_xy)];\r\n}\r\nlet facingDoubleArrowLookup = {};\r\nfacingDoubleArrowLookup[_brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].xyToKey(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Directions\"].RIGHT)] = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Symbols\"].dbl_arrow_right;\r\nfacingDoubleArrowLookup[_brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].xyToKey(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Directions\"].LEFT)] = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Symbols\"].dbl_arrow_left;\r\nfacingDoubleArrowLookup[_brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].xyToKey(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Directions\"].UP)] = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Symbols\"].dbl_arrow_up;\r\nfacingDoubleArrowLookup[_brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].xyToKey(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Directions\"].DOWN)] = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Symbols\"].dbl_arrow_down;\r\nfunction getDoubleArrowForOffset(offset_xy) {\r\n    return facingDoubleArrowLookup[_brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].xyToKey(offset_xy)];\r\n}\r\nfunction updateMonsterParts(gm, actor) {\r\n    if (actor.building_type == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].ComponentPartsBuildingType.None) {\r\n        return;\r\n    }\r\n    else if (actor.building_type == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].ComponentPartsBuildingType.Tank) {\r\n        let turretPower = actor.getPowers().getPowerOfType(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewPowerType.TurretCannon);\r\n        let tank_parts = buildFeaturesForTank(gm, actor.location.clone(), actor.facing_direction, turretPower.facing_direction);\r\n        for (let p of tank_parts) {\r\n            p.setParent(actor);\r\n        }\r\n        actor.setParts(tank_parts);\r\n    }\r\n}\r\nfunction placeMonsterPartsOnGrid(gm, actor) {\r\n    let level = gm.getCurrentLevel();\r\n    let component_parts = actor.getParts();\r\n    for (let tank_part of component_parts) {\r\n        if (level.isValid(tank_part.location)) {\r\n            level.parts.removeAt(tank_part.location);\r\n            level.parts.setAt(tank_part.location, tank_part);\r\n        }\r\n    }\r\n    let triggered = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Movement\"].checkForImpactOfNewParts(gm, actor, component_parts);\r\n    gm.displayList(component_parts.map((f) => { return f.location; }));\r\n}\r\nfunction removeMonsterPartsFromGrid(gm, actor) {\r\n    let level = gm.getCurrentLevel();\r\n    let component_parts = actor.getParts();\r\n    for (let tank_part of component_parts) {\r\n        if (level.isValid(tank_part.location)) {\r\n            level.parts.removeAt(tank_part.location);\r\n        }\r\n    }\r\n    gm.displayList(component_parts.map((f) => { return f.location; }));\r\n}\r\nlet Sqrt2 = Math.sqrt(2);\r\nlet TurnNone = [0, 1];\r\nlet TurnHalf = [Math.PI, 1];\r\nlet TurnQuarter = [Math.PI / 2, 1];\r\nlet TurnOctant = [Math.PI / 4, Sqrt2];\r\nlet TurnThreeOctant = [Math.PI * 3 / 4, Sqrt2];\r\nfunction buildFeaturesForTank(gm, center_xy, tank_facing_dir_xy, turret_facing_dir_xy) {\r\n    // let level = gm.getCurrentLevel()\r\n    let tank_parts = [];\r\n    let feature_part;\r\n    let starting_angle = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].xyToPolar(tank_facing_dir_xy).angle_theta;\r\n    //  wall\r\n    let wall_code = (tank_facing_dir_xy.x != 0) ? \"|\" : _brew__WEBPACK_IMPORTED_MODULE_0__[\"Symbols\"].box_hline;\r\n    for (let turn of [TurnHalf, TurnNone]) {\r\n        feature_part = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].featureFactory(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].FeatureType.TankPart, { code: wall_code });\r\n        feature_part.location = center_xy.add(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].getPolarOffsetCoordinate(starting_angle + turn[0], turn[1]));\r\n        tank_parts.push(feature_part);\r\n    }\r\n    // front wall/pointer\r\n    // wall_code = getFacingArrowForOffset(facing_dir_xy)\r\n    // feature_part = Brew.Definitions.featureFactory(Brew.Definitions.FeatureType.TankWall, { code: wall_code })\r\n    // feature_part.location = center_xy.add(Brew.Utils.getPolarOffsetCoordinate(starting_angle, 1))\r\n    // tank_parts.push(feature_part)\r\n    for (let turn of [TurnOctant, TurnQuarter, TurnThreeOctant]) {\r\n        feature_part = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].featureFactory(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].FeatureType.TankPart, { code: '0' });\r\n        feature_part.location = center_xy.add(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].getPolarOffsetCoordinate(starting_angle + turn[0], turn[1]));\r\n        tank_parts.push(feature_part);\r\n    }\r\n    for (let turn of [TurnOctant, TurnQuarter, TurnThreeOctant]) {\r\n        feature_part = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].featureFactory(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].FeatureType.TankPart, { code: '0' });\r\n        feature_part.location = center_xy.add(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].getPolarOffsetCoordinate(starting_angle - turn[0], turn[1]));\r\n        tank_parts.push(feature_part);\r\n    }\r\n    // driving/forward pointer\r\n    let pointer_char = getFacingPointerForOffset(tank_facing_dir_xy);\r\n    feature_part = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].featureFactory(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].FeatureType.TankPart, { code: pointer_char });\r\n    let facing_xy = feature_part.location = center_xy.add(tank_facing_dir_xy);\r\n    // remove whatever part is there now\r\n    tank_parts = tank_parts.filter((f) => { return (!(f.location.compare(facing_xy))); });\r\n    tank_parts.push(feature_part);\r\n    // turret\r\n    let turret_char = getDoubleArrowForOffset(turret_facing_dir_xy);\r\n    let turret_xy = center_xy;\r\n    // remove whatever part is there now\r\n    // tank_parts = tank_parts.filter((f) => { return (!(f.location.compare(turret_xy))) })\r\n    // put in the new part\r\n    feature_part = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].featureFactory(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].FeatureType.TankPart, { code: turret_char });\r\n    feature_part.location = turret_xy;\r\n    tank_parts.push(feature_part);\r\n    return tank_parts;\r\n}\r\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvYXJlcy9wYXJ0cy50cz8yY2NiIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQStCO0FBRS9CLElBQUksbUJBQW1CLEdBQW1DLEVBQUU7QUFDNUQsbUJBQW1CLENBQUMsMkNBQVUsQ0FBQyxPQUFPLENBQUMsZ0RBQWUsQ0FBQyxLQUFLLENBQUMsQ0FBQyxHQUFHLDZDQUFZLENBQUMsYUFBYTtBQUMzRixtQkFBbUIsQ0FBQywyQ0FBVSxDQUFDLE9BQU8sQ0FBQyxnREFBZSxDQUFDLElBQUksQ0FBQyxDQUFDLEdBQUcsNkNBQVksQ0FBQyxZQUFZO0FBQ3pGLG1CQUFtQixDQUFDLDJDQUFVLENBQUMsT0FBTyxDQUFDLGdEQUFlLENBQUMsRUFBRSxDQUFDLENBQUMsR0FBRyw2Q0FBWSxDQUFDLFVBQVU7QUFDckYsbUJBQW1CLENBQUMsMkNBQVUsQ0FBQyxPQUFPLENBQUMsZ0RBQWUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxHQUFHLDZDQUFZLENBQUMsWUFBWTtBQUN6RixtQkFBbUIsQ0FBQywyQ0FBVSxDQUFDLE9BQU8sQ0FBQyxnREFBZSxDQUFDLFNBQVMsQ0FBQyxDQUFDLEdBQUcsNkNBQVksQ0FBQyxnQkFBZ0I7QUFDbEcsbUJBQW1CLENBQUMsMkNBQVUsQ0FBQyxPQUFPLENBQUMsZ0RBQWUsQ0FBQyxVQUFVLENBQUMsQ0FBQyxHQUFHLDZDQUFZLENBQUMsaUJBQWlCO0FBQ3BHLG1CQUFtQixDQUFDLDJDQUFVLENBQUMsT0FBTyxDQUFDLGdEQUFlLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBRyw2Q0FBWSxDQUFDLGVBQWU7QUFDaEcsbUJBQW1CLENBQUMsMkNBQVUsQ0FBQyxPQUFPLENBQUMsZ0RBQWUsQ0FBQyxPQUFPLENBQUMsQ0FBQyxHQUFHLDZDQUFZLENBQUMsY0FBYztBQUU5RixtQ0FBbUMsU0FBMEI7SUFDekQsTUFBTSxDQUFDLG1CQUFtQixDQUFDLDJDQUFVLENBQUMsT0FBTyxDQUFDLFNBQVMsQ0FBQyxDQUFDO0FBQzdELENBQUM7QUFFRCxJQUFJLHVCQUF1QixHQUFtQyxFQUFFO0FBQ2hFLHVCQUF1QixDQUFDLDJDQUFVLENBQUMsT0FBTyxDQUFDLGdEQUFlLENBQUMsS0FBSyxDQUFDLENBQUMsR0FBRyw2Q0FBWSxDQUFDLGVBQWU7QUFDakcsdUJBQXVCLENBQUMsMkNBQVUsQ0FBQyxPQUFPLENBQUMsZ0RBQWUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxHQUFHLDZDQUFZLENBQUMsY0FBYztBQUMvRix1QkFBdUIsQ0FBQywyQ0FBVSxDQUFDLE9BQU8sQ0FBQyxnREFBZSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEdBQUcsNkNBQVksQ0FBQyxZQUFZO0FBQzNGLHVCQUF1QixDQUFDLDJDQUFVLENBQUMsT0FBTyxDQUFDLGdEQUFlLENBQUMsSUFBSSxDQUFDLENBQUMsR0FBRyw2Q0FBWSxDQUFDLGNBQWM7QUFFL0YsaUNBQWlDLFNBQTBCO0lBQ3ZELE1BQU0sQ0FBQyx1QkFBdUIsQ0FBQywyQ0FBVSxDQUFDLE9BQU8sQ0FBQyxTQUFTLENBQUMsQ0FBQztBQUNqRSxDQUFDO0FBRUssNEJBQTZCLEVBQW1CLEVBQUUsS0FBOEI7SUFDbEYsRUFBRSxDQUFDLENBQUMsS0FBSyxDQUFDLGFBQWEsSUFBSSwyQ0FBVSxDQUFDLDBCQUEwQixDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7UUFDcEUsTUFBTTtJQUNWLENBQUM7SUFBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsS0FBSyxDQUFDLGFBQWEsSUFBSSwyQ0FBVSxDQUFDLDBCQUEwQixDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7UUFDM0UsSUFBSSxXQUFXLEdBQUcsS0FBSyxDQUFDLFNBQVMsRUFBRSxDQUFDLGNBQWMsQ0FBQywyQ0FBVSxDQUFDLGFBQWEsQ0FBQyxZQUFZLENBQUM7UUFFekYsSUFBSSxVQUFVLEdBQUcsb0JBQW9CLENBQUMsRUFBRSxFQUFFLEtBQUssQ0FBQyxRQUFRLENBQUMsS0FBSyxFQUFFLEVBQUUsS0FBSyxDQUFDLGdCQUFnQixFQUFFLFdBQVcsQ0FBQyxnQkFBZ0IsQ0FBQztRQUN2SCxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxVQUFVLENBQUMsQ0FBQyxDQUFDO1lBQ3ZCLENBQUMsQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDO1FBQ3RCLENBQUM7UUFFRCxLQUFLLENBQUMsUUFBUSxDQUFDLFVBQVUsQ0FBQztJQUM5QixDQUFDO0FBQ0wsQ0FBQztBQUVLLGlDQUFrQyxFQUFtQixFQUFFLEtBQThCO0lBQ3ZGLElBQUksS0FBSyxHQUFHLEVBQUUsQ0FBQyxlQUFlLEVBQUU7SUFDaEMsSUFBSSxlQUFlLEdBQUcsS0FBSyxDQUFDLFFBQVEsRUFBRTtJQUV0QyxHQUFHLENBQUMsQ0FBQyxJQUFJLFNBQVMsSUFBSSxlQUFlLENBQUMsQ0FBQyxDQUFDO1FBQ3BDLEVBQUUsQ0FBQyxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUNwQyxLQUFLLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDO1lBQ3hDLEtBQUssQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLFNBQVMsQ0FBQyxRQUFRLEVBQUUsU0FBUyxDQUFDO1FBQ3BELENBQUM7SUFDTCxDQUFDO0lBQ0QsSUFBSSxTQUFTLEdBQUcsOENBQWEsQ0FBQyx3QkFBd0IsQ0FBQyxFQUFFLEVBQUUsS0FBSyxFQUFFLGVBQWUsQ0FBQztJQUNsRixFQUFFLENBQUMsV0FBVyxDQUFDLGVBQWUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxHQUFHLE1BQU0sQ0FBQyxDQUFDLENBQUMsUUFBUSxHQUFDLENBQUMsQ0FBQztBQUNwRSxDQUFDO0FBRUssb0NBQXFDLEVBQW1CLEVBQUUsS0FBOEI7SUFDMUYsSUFBSSxLQUFLLEdBQUcsRUFBRSxDQUFDLGVBQWUsRUFBRTtJQUNoQyxJQUFJLGVBQWUsR0FBRyxLQUFLLENBQUMsUUFBUSxFQUFFO0lBRXRDLEdBQUcsQ0FBQyxDQUFDLElBQUksU0FBUyxJQUFJLGVBQWUsQ0FBQyxDQUFDLENBQUM7UUFDcEMsRUFBRSxDQUFDLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ3BDLEtBQUssQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUM7UUFDNUMsQ0FBQztJQUNMLENBQUM7SUFFRCxFQUFFLENBQUMsV0FBVyxDQUFDLGVBQWUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxHQUFHLE1BQU0sQ0FBQyxDQUFDLENBQUMsUUFBUSxHQUFDLENBQUMsQ0FBQztBQUNwRSxDQUFDO0FBRUQsSUFBSSxLQUFLLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7QUFDeEIsSUFBSSxRQUFRLEdBQUcsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDO0FBQ3JCLElBQUksUUFBUSxHQUFHLENBQUMsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUM7QUFDM0IsSUFBSSxXQUFXLEdBQUcsQ0FBQyxJQUFJLENBQUMsRUFBRSxHQUFHLENBQUMsRUFBRSxDQUFDLENBQUM7QUFDbEMsSUFBSSxVQUFVLEdBQUcsQ0FBQyxJQUFJLENBQUMsRUFBRSxHQUFHLENBQUMsRUFBRSxLQUFLLENBQUM7QUFDckMsSUFBSSxlQUFlLEdBQUcsQ0FBQyxJQUFJLENBQUMsRUFBRSxHQUFHLENBQUMsR0FBRyxDQUFDLEVBQUUsS0FBSyxDQUFDO0FBRTlDLDhCQUE4QixFQUFtQixFQUFFLFNBQTBCLEVBQUUsa0JBQW1DLEVBQUUsb0JBQXFDO0lBRXJKLG1DQUFtQztJQUNuQyxJQUFJLFVBQVUsR0FBb0MsRUFBRTtJQUNwRCxJQUFJLFlBQXNDO0lBRTFDLElBQUksY0FBYyxHQUFHLDJDQUFVLENBQUMsU0FBUyxDQUFDLGtCQUFrQixDQUFDLENBQUMsV0FBVztJQUV6RSxRQUFRO0lBQ1IsSUFBSSxTQUFTLEdBQVksQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsNkNBQVksQ0FBQyxTQUFTO0lBQ25GLEdBQUcsQ0FBQyxDQUFDLElBQUksSUFBSSxJQUFJLENBQUMsUUFBUSxFQUFFLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNwQyxZQUFZLEdBQUcsaURBQWdCLENBQUMsY0FBYyxDQUFDLGlEQUFnQixDQUFDLFdBQVcsQ0FBQyxRQUFRLEVBQUUsRUFBRSxJQUFJLEVBQUUsU0FBUyxFQUFFLENBQUM7UUFDMUcsWUFBWSxDQUFDLFFBQVEsR0FBRyxTQUFTLENBQUMsR0FBRyxDQUFDLDJDQUFVLENBQUMsd0JBQXdCLENBQUMsY0FBYyxHQUFHLElBQUksQ0FBQyxDQUFDLENBQUMsRUFBRSxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUM3RyxVQUFVLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQztJQUNqQyxDQUFDO0lBRUQscUJBQXFCO0lBQ3JCLHFEQUFxRDtJQUNyRCw2R0FBNkc7SUFDN0csZ0dBQWdHO0lBQ2hHLGdDQUFnQztJQUVoQyxHQUFHLENBQUMsQ0FBQyxJQUFJLElBQUksSUFBSSxDQUFDLFVBQVUsRUFBRSxXQUFXLEVBQUUsZUFBZSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQzFELFlBQVksR0FBRyxpREFBZ0IsQ0FBQyxjQUFjLENBQUMsaURBQWdCLENBQUMsV0FBVyxDQUFDLFFBQVEsRUFBRSxFQUFFLElBQUksRUFBRSxHQUFHLEVBQUUsQ0FBQztRQUNwRyxZQUFZLENBQUMsUUFBUSxHQUFHLFNBQVMsQ0FBQyxHQUFHLENBQUMsMkNBQVUsQ0FBQyx3QkFBd0IsQ0FBQyxjQUFjLEdBQUcsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQzdHLFVBQVUsQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDO0lBQ2pDLENBQUM7SUFFRCxHQUFHLENBQUMsQ0FBQyxJQUFJLElBQUksSUFBSSxDQUFDLFVBQVUsRUFBRSxXQUFXLEVBQUUsZUFBZSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQzFELFlBQVksR0FBRyxpREFBZ0IsQ0FBQyxjQUFjLENBQUMsaURBQWdCLENBQUMsV0FBVyxDQUFDLFFBQVEsRUFBRSxFQUFFLElBQUksRUFBRSxHQUFHLEVBQUUsQ0FBQztRQUNwRyxZQUFZLENBQUMsUUFBUSxHQUFHLFNBQVMsQ0FBQyxHQUFHLENBQUMsMkNBQVUsQ0FBQyx3QkFBd0IsQ0FBQyxjQUFjLEdBQUcsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQzdHLFVBQVUsQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDO0lBQ2pDLENBQUM7SUFFRCwwQkFBMEI7SUFDMUIsSUFBSSxZQUFZLEdBQUcseUJBQXlCLENBQUMsa0JBQWtCLENBQUM7SUFDaEUsWUFBWSxHQUFHLGlEQUFnQixDQUFDLGNBQWMsQ0FBQyxpREFBZ0IsQ0FBQyxXQUFXLENBQUMsUUFBUSxFQUFFLEVBQUUsSUFBSSxFQUFFLFlBQVksRUFBRSxDQUFDO0lBQzdHLElBQUksU0FBUyxHQUFHLFlBQVksQ0FBQyxRQUFRLEdBQUcsU0FBUyxDQUFDLEdBQUcsQ0FBQyxrQkFBa0IsQ0FBQztJQUN6RSxvQ0FBb0M7SUFDcEMsVUFBVSxHQUFHLFVBQVUsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxHQUFHLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLEVBQUMsQ0FBQyxDQUFDO0lBQ3BGLFVBQVUsQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDO0lBRTdCLFNBQVM7SUFDVCxJQUFJLFdBQVcsR0FBRyx1QkFBdUIsQ0FBQyxvQkFBb0IsQ0FBQztJQUMvRCxJQUFJLFNBQVMsR0FBRyxTQUFTO0lBQ3pCLG9DQUFvQztJQUNwQyx1RkFBdUY7SUFDdkYsc0JBQXNCO0lBQ3RCLFlBQVksR0FBRyxpREFBZ0IsQ0FBQyxjQUFjLENBQUMsaURBQWdCLENBQUMsV0FBVyxDQUFDLFFBQVEsRUFBRSxFQUFFLElBQUksRUFBRSxXQUFXLEVBQUUsQ0FBQztJQUM1RyxZQUFZLENBQUMsUUFBUSxHQUFHLFNBQVM7SUFDakMsVUFBVSxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUM7SUFFN0IsTUFBTSxDQUFDLFVBQVU7QUFDckIsQ0FBQyIsImZpbGUiOiIuL3NyYy9hcmVzL3BhcnRzLnRzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgQnJldyBmcm9tIFwiLi4vYnJld1wiXHJcblxyXG5sZXQgZmFjaW5nUG9pbnRlckxvb2t1cCA6IHtbb2Zmc2V0X2lkOm51bWJlcl0gOiBzdHJpbmd9ID0ge31cclxuZmFjaW5nUG9pbnRlckxvb2t1cFtCcmV3LlV0aWxzLnh5VG9LZXkoQnJldy5EaXJlY3Rpb25zLlJJR0hUKV0gPSBCcmV3LlN5bWJvbHMucG9pbnRlcl9yaWdodFxyXG5mYWNpbmdQb2ludGVyTG9va3VwW0JyZXcuVXRpbHMueHlUb0tleShCcmV3LkRpcmVjdGlvbnMuTEVGVCldID0gQnJldy5TeW1ib2xzLnBvaW50ZXJfbGVmdFxyXG5mYWNpbmdQb2ludGVyTG9va3VwW0JyZXcuVXRpbHMueHlUb0tleShCcmV3LkRpcmVjdGlvbnMuVVApXSA9IEJyZXcuU3ltYm9scy5wb2ludGVyX3VwXHJcbmZhY2luZ1BvaW50ZXJMb29rdXBbQnJldy5VdGlscy54eVRvS2V5KEJyZXcuRGlyZWN0aW9ucy5ET1dOKV0gPSBCcmV3LlN5bWJvbHMucG9pbnRlcl9kb3duXHJcbmZhY2luZ1BvaW50ZXJMb29rdXBbQnJldy5VdGlscy54eVRvS2V5KEJyZXcuRGlyZWN0aW9ucy5ET1dOX0xFRlQpXSA9IEJyZXcuU3ltYm9scy5wb2ludGVyX2Rvd25sZWZ0XHJcbmZhY2luZ1BvaW50ZXJMb29rdXBbQnJldy5VdGlscy54eVRvS2V5KEJyZXcuRGlyZWN0aW9ucy5ET1dOX1JJR0hUKV0gPSBCcmV3LlN5bWJvbHMucG9pbnRlcl9kb3ducmlnaHRcclxuZmFjaW5nUG9pbnRlckxvb2t1cFtCcmV3LlV0aWxzLnh5VG9LZXkoQnJldy5EaXJlY3Rpb25zLlVQX1JJR0hUKV0gPSBCcmV3LlN5bWJvbHMucG9pbnRlcl91cHJpZ2h0XHJcbmZhY2luZ1BvaW50ZXJMb29rdXBbQnJldy5VdGlscy54eVRvS2V5KEJyZXcuRGlyZWN0aW9ucy5VUF9MRUZUKV0gPSBCcmV3LlN5bWJvbHMucG9pbnRlcl91cGxlZnRcclxuXHJcbmZ1bmN0aW9uIGdldEZhY2luZ1BvaW50ZXJGb3JPZmZzZXQob2Zmc2V0X3h5OiBCcmV3LkNvb3JkaW5hdGUpIDogc3RyaW5nIHtcclxuICAgIHJldHVybiBmYWNpbmdQb2ludGVyTG9va3VwW0JyZXcuVXRpbHMueHlUb0tleShvZmZzZXRfeHkpXVxyXG59XHJcblxyXG5sZXQgZmFjaW5nRG91YmxlQXJyb3dMb29rdXAgOiB7W29mZnNldF9pZDpudW1iZXJdIDogc3RyaW5nfSA9IHt9XHJcbmZhY2luZ0RvdWJsZUFycm93TG9va3VwW0JyZXcuVXRpbHMueHlUb0tleShCcmV3LkRpcmVjdGlvbnMuUklHSFQpXSA9IEJyZXcuU3ltYm9scy5kYmxfYXJyb3dfcmlnaHRcclxuZmFjaW5nRG91YmxlQXJyb3dMb29rdXBbQnJldy5VdGlscy54eVRvS2V5KEJyZXcuRGlyZWN0aW9ucy5MRUZUKV0gPSBCcmV3LlN5bWJvbHMuZGJsX2Fycm93X2xlZnRcclxuZmFjaW5nRG91YmxlQXJyb3dMb29rdXBbQnJldy5VdGlscy54eVRvS2V5KEJyZXcuRGlyZWN0aW9ucy5VUCldID0gQnJldy5TeW1ib2xzLmRibF9hcnJvd191cFxyXG5mYWNpbmdEb3VibGVBcnJvd0xvb2t1cFtCcmV3LlV0aWxzLnh5VG9LZXkoQnJldy5EaXJlY3Rpb25zLkRPV04pXSA9IEJyZXcuU3ltYm9scy5kYmxfYXJyb3dfZG93blxyXG5cclxuZnVuY3Rpb24gZ2V0RG91YmxlQXJyb3dGb3JPZmZzZXQob2Zmc2V0X3h5OiBCcmV3LkNvb3JkaW5hdGUpIDogc3RyaW5nIHtcclxuICAgIHJldHVybiBmYWNpbmdEb3VibGVBcnJvd0xvb2t1cFtCcmV3LlV0aWxzLnh5VG9LZXkob2Zmc2V0X3h5KV1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZU1vbnN0ZXJQYXJ0cyhnbTogQnJldy5HYW1lTWFzdGVyLCBhY3RvcjogQnJldy5HcmlkVGhpbmdzLk1vbnN0ZXIpIHtcclxuICAgIGlmIChhY3Rvci5idWlsZGluZ190eXBlID09IEJyZXcuRW51bXMuQ29tcG9uZW50UGFydHNCdWlsZGluZ1R5cGUuTm9uZSkge1xyXG4gICAgICAgIHJldHVyblxyXG4gICAgfSBlbHNlIGlmIChhY3Rvci5idWlsZGluZ190eXBlID09IEJyZXcuRW51bXMuQ29tcG9uZW50UGFydHNCdWlsZGluZ1R5cGUuVGFuaykge1xyXG4gICAgICAgIGxldCB0dXJyZXRQb3dlciA9IGFjdG9yLmdldFBvd2VycygpLmdldFBvd2VyT2ZUeXBlKEJyZXcuRW51bXMuQnJld1Bvd2VyVHlwZS5UdXJyZXRDYW5ub24pXHJcbiAgICAgICAgXHJcbiAgICAgICAgbGV0IHRhbmtfcGFydHMgPSBidWlsZEZlYXR1cmVzRm9yVGFuayhnbSwgYWN0b3IubG9jYXRpb24uY2xvbmUoKSwgYWN0b3IuZmFjaW5nX2RpcmVjdGlvbiwgdHVycmV0UG93ZXIuZmFjaW5nX2RpcmVjdGlvbilcclxuICAgICAgICBmb3IgKGxldCBwIG9mIHRhbmtfcGFydHMpIHtcclxuICAgICAgICAgICAgcC5zZXRQYXJlbnQoYWN0b3IpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBhY3Rvci5zZXRQYXJ0cyh0YW5rX3BhcnRzKVxyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcGxhY2VNb25zdGVyUGFydHNPbkdyaWQoZ206IEJyZXcuR2FtZU1hc3RlciwgYWN0b3I6IEJyZXcuR3JpZFRoaW5ncy5Nb25zdGVyKSB7XHJcbiAgICBsZXQgbGV2ZWwgPSBnbS5nZXRDdXJyZW50TGV2ZWwoKVxyXG4gICAgbGV0IGNvbXBvbmVudF9wYXJ0cyA9IGFjdG9yLmdldFBhcnRzKClcclxuXHJcbiAgICBmb3IgKGxldCB0YW5rX3BhcnQgb2YgY29tcG9uZW50X3BhcnRzKSB7XHJcbiAgICAgICAgaWYgKGxldmVsLmlzVmFsaWQodGFua19wYXJ0LmxvY2F0aW9uKSkge1xyXG4gICAgICAgICAgICBsZXZlbC5wYXJ0cy5yZW1vdmVBdCh0YW5rX3BhcnQubG9jYXRpb24pXHJcbiAgICAgICAgICAgIGxldmVsLnBhcnRzLnNldEF0KHRhbmtfcGFydC5sb2NhdGlvbiwgdGFua19wYXJ0KSAgICBcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBsZXQgdHJpZ2dlcmVkID0gQnJldy5Nb3ZlbWVudC5jaGVja0ZvckltcGFjdE9mTmV3UGFydHMoZ20sIGFjdG9yLCBjb21wb25lbnRfcGFydHMpXHJcbiAgICBnbS5kaXNwbGF5TGlzdChjb21wb25lbnRfcGFydHMubWFwKChmKSA9PiB7IHJldHVybiBmLmxvY2F0aW9ufSkpXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiByZW1vdmVNb25zdGVyUGFydHNGcm9tR3JpZChnbTogQnJldy5HYW1lTWFzdGVyLCBhY3RvcjogQnJldy5HcmlkVGhpbmdzLk1vbnN0ZXIpIHtcclxuICAgIGxldCBsZXZlbCA9IGdtLmdldEN1cnJlbnRMZXZlbCgpXHJcbiAgICBsZXQgY29tcG9uZW50X3BhcnRzID0gYWN0b3IuZ2V0UGFydHMoKVxyXG5cclxuICAgIGZvciAobGV0IHRhbmtfcGFydCBvZiBjb21wb25lbnRfcGFydHMpIHtcclxuICAgICAgICBpZiAobGV2ZWwuaXNWYWxpZCh0YW5rX3BhcnQubG9jYXRpb24pKSB7XHJcbiAgICAgICAgICAgIGxldmVsLnBhcnRzLnJlbW92ZUF0KHRhbmtfcGFydC5sb2NhdGlvbilcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZ20uZGlzcGxheUxpc3QoY29tcG9uZW50X3BhcnRzLm1hcCgoZikgPT4geyByZXR1cm4gZi5sb2NhdGlvbn0pKSAgICAgICAgXHJcbn1cclxuXHJcbmxldCBTcXJ0MiA9IE1hdGguc3FydCgyKVxyXG5sZXQgVHVybk5vbmUgPSBbMCwgMV1cclxubGV0IFR1cm5IYWxmID0gW01hdGguUEksIDFdXHJcbmxldCBUdXJuUXVhcnRlciA9IFtNYXRoLlBJIC8gMiwgMV1cclxubGV0IFR1cm5PY3RhbnQgPSBbTWF0aC5QSSAvIDQsIFNxcnQyXVxyXG5sZXQgVHVyblRocmVlT2N0YW50ID0gW01hdGguUEkgKiAzIC8gNCwgU3FydDJdXHJcblxyXG5mdW5jdGlvbiBidWlsZEZlYXR1cmVzRm9yVGFuayhnbTogQnJldy5HYW1lTWFzdGVyLCBjZW50ZXJfeHk6IEJyZXcuQ29vcmRpbmF0ZSwgdGFua19mYWNpbmdfZGlyX3h5OiBCcmV3LkNvb3JkaW5hdGUsIHR1cnJldF9mYWNpbmdfZGlyX3h5OiBCcmV3LkNvb3JkaW5hdGUpIDogQXJyYXk8QnJldy5HcmlkVGhpbmdzLkZlYXR1cmU+IHtcclxuXHJcbiAgICAvLyBsZXQgbGV2ZWwgPSBnbS5nZXRDdXJyZW50TGV2ZWwoKVxyXG4gICAgbGV0IHRhbmtfcGFydHMgOiBBcnJheTxCcmV3LkdyaWRUaGluZ3MuRmVhdHVyZT4gPSBbXVxyXG4gICAgbGV0IGZlYXR1cmVfcGFydCA6IEJyZXcuR3JpZFRoaW5ncy5GZWF0dXJlXHJcblxyXG4gICAgbGV0IHN0YXJ0aW5nX2FuZ2xlID0gQnJldy5VdGlscy54eVRvUG9sYXIodGFua19mYWNpbmdfZGlyX3h5KS5hbmdsZV90aGV0YVxyXG5cclxuICAgIC8vICB3YWxsXHJcbiAgICBsZXQgd2FsbF9jb2RlIDogc3RyaW5nID0gKHRhbmtfZmFjaW5nX2Rpcl94eS54ICE9IDApID8gXCJ8XCIgOiBCcmV3LlN5bWJvbHMuYm94X2hsaW5lXHJcbiAgICBmb3IgKGxldCB0dXJuIG9mIFtUdXJuSGFsZiwgVHVybk5vbmVdKSB7XHJcbiAgICAgICAgZmVhdHVyZV9wYXJ0ID0gQnJldy5EZWZpbml0aW9ucy5mZWF0dXJlRmFjdG9yeShCcmV3LkRlZmluaXRpb25zLkZlYXR1cmVUeXBlLlRhbmtQYXJ0LCB7IGNvZGU6IHdhbGxfY29kZSB9KVxyXG4gICAgICAgIGZlYXR1cmVfcGFydC5sb2NhdGlvbiA9IGNlbnRlcl94eS5hZGQoQnJldy5VdGlscy5nZXRQb2xhck9mZnNldENvb3JkaW5hdGUoc3RhcnRpbmdfYW5nbGUgKyB0dXJuWzBdLCB0dXJuWzFdKSlcclxuICAgICAgICB0YW5rX3BhcnRzLnB1c2goZmVhdHVyZV9wYXJ0KVxyXG4gICAgfVxyXG5cclxuICAgIC8vIGZyb250IHdhbGwvcG9pbnRlclxyXG4gICAgLy8gd2FsbF9jb2RlID0gZ2V0RmFjaW5nQXJyb3dGb3JPZmZzZXQoZmFjaW5nX2Rpcl94eSlcclxuICAgIC8vIGZlYXR1cmVfcGFydCA9IEJyZXcuRGVmaW5pdGlvbnMuZmVhdHVyZUZhY3RvcnkoQnJldy5EZWZpbml0aW9ucy5GZWF0dXJlVHlwZS5UYW5rV2FsbCwgeyBjb2RlOiB3YWxsX2NvZGUgfSlcclxuICAgIC8vIGZlYXR1cmVfcGFydC5sb2NhdGlvbiA9IGNlbnRlcl94eS5hZGQoQnJldy5VdGlscy5nZXRQb2xhck9mZnNldENvb3JkaW5hdGUoc3RhcnRpbmdfYW5nbGUsIDEpKVxyXG4gICAgLy8gdGFua19wYXJ0cy5wdXNoKGZlYXR1cmVfcGFydClcclxuXHJcbiAgICBmb3IgKGxldCB0dXJuIG9mIFtUdXJuT2N0YW50LCBUdXJuUXVhcnRlciwgVHVyblRocmVlT2N0YW50XSkge1xyXG4gICAgICAgIGZlYXR1cmVfcGFydCA9IEJyZXcuRGVmaW5pdGlvbnMuZmVhdHVyZUZhY3RvcnkoQnJldy5EZWZpbml0aW9ucy5GZWF0dXJlVHlwZS5UYW5rUGFydCwgeyBjb2RlOiAnMCcgfSlcclxuICAgICAgICBmZWF0dXJlX3BhcnQubG9jYXRpb24gPSBjZW50ZXJfeHkuYWRkKEJyZXcuVXRpbHMuZ2V0UG9sYXJPZmZzZXRDb29yZGluYXRlKHN0YXJ0aW5nX2FuZ2xlICsgdHVyblswXSwgdHVyblsxXSkpXHJcbiAgICAgICAgdGFua19wYXJ0cy5wdXNoKGZlYXR1cmVfcGFydClcclxuICAgIH1cclxuXHJcbiAgICBmb3IgKGxldCB0dXJuIG9mIFtUdXJuT2N0YW50LCBUdXJuUXVhcnRlciwgVHVyblRocmVlT2N0YW50XSkge1xyXG4gICAgICAgIGZlYXR1cmVfcGFydCA9IEJyZXcuRGVmaW5pdGlvbnMuZmVhdHVyZUZhY3RvcnkoQnJldy5EZWZpbml0aW9ucy5GZWF0dXJlVHlwZS5UYW5rUGFydCwgeyBjb2RlOiAnMCcgfSlcclxuICAgICAgICBmZWF0dXJlX3BhcnQubG9jYXRpb24gPSBjZW50ZXJfeHkuYWRkKEJyZXcuVXRpbHMuZ2V0UG9sYXJPZmZzZXRDb29yZGluYXRlKHN0YXJ0aW5nX2FuZ2xlIC0gdHVyblswXSwgdHVyblsxXSkpXHJcbiAgICAgICAgdGFua19wYXJ0cy5wdXNoKGZlYXR1cmVfcGFydClcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gZHJpdmluZy9mb3J3YXJkIHBvaW50ZXJcclxuICAgIGxldCBwb2ludGVyX2NoYXIgPSBnZXRGYWNpbmdQb2ludGVyRm9yT2Zmc2V0KHRhbmtfZmFjaW5nX2Rpcl94eSlcclxuICAgIGZlYXR1cmVfcGFydCA9IEJyZXcuRGVmaW5pdGlvbnMuZmVhdHVyZUZhY3RvcnkoQnJldy5EZWZpbml0aW9ucy5GZWF0dXJlVHlwZS5UYW5rUGFydCwgeyBjb2RlOiBwb2ludGVyX2NoYXIgfSlcclxuICAgIGxldCBmYWNpbmdfeHkgPSBmZWF0dXJlX3BhcnQubG9jYXRpb24gPSBjZW50ZXJfeHkuYWRkKHRhbmtfZmFjaW5nX2Rpcl94eSlcclxuICAgIC8vIHJlbW92ZSB3aGF0ZXZlciBwYXJ0IGlzIHRoZXJlIG5vd1xyXG4gICAgdGFua19wYXJ0cyA9IHRhbmtfcGFydHMuZmlsdGVyKChmKSA9PiB7IHJldHVybiAoIShmLmxvY2F0aW9uLmNvbXBhcmUoZmFjaW5nX3h5KSkpIH0pXHJcbiAgICB0YW5rX3BhcnRzLnB1c2goZmVhdHVyZV9wYXJ0KVxyXG4gICAgXHJcbiAgICAvLyB0dXJyZXRcclxuICAgIGxldCB0dXJyZXRfY2hhciA9IGdldERvdWJsZUFycm93Rm9yT2Zmc2V0KHR1cnJldF9mYWNpbmdfZGlyX3h5KVxyXG4gICAgbGV0IHR1cnJldF94eSA9IGNlbnRlcl94eVxyXG4gICAgLy8gcmVtb3ZlIHdoYXRldmVyIHBhcnQgaXMgdGhlcmUgbm93XHJcbiAgICAvLyB0YW5rX3BhcnRzID0gdGFua19wYXJ0cy5maWx0ZXIoKGYpID0+IHsgcmV0dXJuICghKGYubG9jYXRpb24uY29tcGFyZSh0dXJyZXRfeHkpKSkgfSlcclxuICAgIC8vIHB1dCBpbiB0aGUgbmV3IHBhcnRcclxuICAgIGZlYXR1cmVfcGFydCA9IEJyZXcuRGVmaW5pdGlvbnMuZmVhdHVyZUZhY3RvcnkoQnJldy5EZWZpbml0aW9ucy5GZWF0dXJlVHlwZS5UYW5rUGFydCwgeyBjb2RlOiB0dXJyZXRfY2hhciB9KVxyXG4gICAgZmVhdHVyZV9wYXJ0LmxvY2F0aW9uID0gdHVycmV0X3h5XHJcbiAgICB0YW5rX3BhcnRzLnB1c2goZmVhdHVyZV9wYXJ0KVxyXG5cclxuICAgIHJldHVybiB0YW5rX3BhcnRzXHJcbn0iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/ares/parts.ts\n");

/***/ }),

/***/ "./src/ares/tank.ts":
/*!**************************!*\
  !*** ./src/ares/tank.ts ***!
  \**************************/
/*! exports provided: getFiringArcValues, getDirectionFromKeycode, getRotatedFacingDirectionFromKeycode, rotate_body, rotate_weapon, getPrimaryFacingDirection, getFiringArcRange, processInventory, getLevelAuditReport, helpMessages */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getFiringArcValues\", function() { return getFiringArcValues; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getDirectionFromKeycode\", function() { return getDirectionFromKeycode; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getRotatedFacingDirectionFromKeycode\", function() { return getRotatedFacingDirectionFromKeycode; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"rotate_body\", function() { return rotate_body; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"rotate_weapon\", function() { return rotate_weapon; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getPrimaryFacingDirection\", function() { return getPrimaryFacingDirection; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getFiringArcRange\", function() { return getFiringArcRange; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"processInventory\", function() { return processInventory; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getLevelAuditReport\", function() { return getLevelAuditReport; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"helpMessages\", function() { return helpMessages; });\n/* harmony import */ var _brew__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../brew */ \"./src/brew.ts\");\n\r\nlet BrewFiringArcAngles = {};\r\nBrewFiringArcAngles[_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].FiringArc.FullArc] = Math.PI * 2;\r\nBrewFiringArcAngles[_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].FiringArc.HalfArc] = Math.PI;\r\nBrewFiringArcAngles[_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].FiringArc.QuarterArc] = Math.PI / 2;\r\nBrewFiringArcAngles[_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].FiringArc.OctantArc] = Math.PI / 4;\r\nBrewFiringArcAngles[_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].FiringArc.ThreeOctantArc] = Math.PI * 3 / 4;\r\nBrewFiringArcAngles[_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].FiringArc.ThreeQuarterArc] = Math.PI * 3 / 2;\r\nfunction getFiringArcValues(arc_name) {\r\n    return BrewFiringArcAngles[arc_name];\r\n}\r\nfunction getDirectionFromKeycode(actor, keycode) {\r\n    let direction_xy;\r\n    if (_brew__WEBPACK_IMPORTED_MODULE_0__[\"KeyMap\"].MoveForward.indexOf(keycode) > -1) {\r\n        direction_xy = actor.facing_direction;\r\n    }\r\n    else if (_brew__WEBPACK_IMPORTED_MODULE_0__[\"KeyMap\"].MoveBackward.indexOf(keycode) > -1) {\r\n        let backwards_xy = actor.facing_direction.multiplyScalar(-1);\r\n        direction_xy = backwards_xy;\r\n    }\r\n    else {\r\n        return null;\r\n    }\r\n    return direction_xy;\r\n}\r\nfunction getRotatedFacingDirectionFromKeycode(facing_dir_xy, keycode) {\r\n    let new_facing_xy;\r\n    // let turn_angle = Math.PI / 2\r\n    let current_angle = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].xyToPolar(facing_dir_xy.toUnit()).angle_theta;\r\n    let new_angle;\r\n    if (_brew__WEBPACK_IMPORTED_MODULE_0__[\"KeyMap\"].CWRotateKeys.indexOf(keycode) > -1) {\r\n        new_angle = current_angle + (Math.PI / 2);\r\n    }\r\n    else if (_brew__WEBPACK_IMPORTED_MODULE_0__[\"KeyMap\"].CCWRotateKeys.indexOf(keycode) > -1) {\r\n        new_angle = current_angle - (Math.PI / 2);\r\n    }\r\n    else {\r\n        return null;\r\n    }\r\n    if (Math.abs(new_angle) == Math.PI) {\r\n        new_angle = Math.PI;\r\n    }\r\n    new_facing_xy = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].getPolarOffsetCoordinate(new_angle, 1);\r\n    // console.log(new_angle, new_facing_xy)\r\n    return new_facing_xy;\r\n}\r\nfunction rotate_body(gm, brEvent) {\r\n    let new_facing_xy = brEvent.rotateData.new_facing_xy;\r\n    brEvent.actor.facing_direction = new_facing_xy;\r\n    _brew__WEBPACK_IMPORTED_MODULE_0__[\"Parts\"].removeMonsterPartsFromGrid(gm, brEvent.actor);\r\n    _brew__WEBPACK_IMPORTED_MODULE_0__[\"Parts\"].updateMonsterParts(gm, brEvent.actor);\r\n    _brew__WEBPACK_IMPORTED_MODULE_0__[\"Parts\"].placeMonsterPartsOnGrid(gm, brEvent.actor);\r\n    gm.endEvent(brEvent);\r\n}\r\nfunction rotate_weapon(gm, brEvent) {\r\n    let new_facing_xy = brEvent.rotateData.new_facing_xy;\r\n    let weaponPower = brEvent.rotateData.weaponPower;\r\n    weaponPower.facing_direction = new_facing_xy;\r\n    _brew__WEBPACK_IMPORTED_MODULE_0__[\"Parts\"].removeMonsterPartsFromGrid(gm, brEvent.actor);\r\n    _brew__WEBPACK_IMPORTED_MODULE_0__[\"Parts\"].updateMonsterParts(gm, brEvent.actor);\r\n    _brew__WEBPACK_IMPORTED_MODULE_0__[\"Parts\"].placeMonsterPartsOnGrid(gm, brEvent.actor);\r\n    gm.endEvent(brEvent);\r\n}\r\nfunction getPrimaryFacingDirection(gm, actor) {\r\n    let view_direction;\r\n    let turretPower = actor.getPowers().getPowerOfType(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewPowerType.TurretCannon);\r\n    if (turretPower) {\r\n        view_direction = turretPower.facing_direction;\r\n    }\r\n    else {\r\n        view_direction = actor.facing_direction;\r\n    }\r\n    return view_direction;\r\n}\r\nfunction getFiringArcRange(gm, center_xy, weaponPower) {\r\n    let facing_dir_xy = weaponPower.facing_direction;\r\n    let center_angle = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].xyToPolar(facing_dir_xy).angle_theta;\r\n    let full_arc = getFiringArcValues(weaponPower.firing_arc);\r\n    let half_range = full_arc / 2;\r\n    let min_angle = center_angle - half_range;\r\n    let max_angle = center_angle + half_range;\r\n    return {\r\n        minAngle: min_angle,\r\n        midpointAngle: center_angle,\r\n        maxAngle: max_angle,\r\n    };\r\n}\r\nfunction processInventory(gm) {\r\n    let player = gm.getPlayer();\r\n    let item;\r\n    let turret_gun = player.getPowers().getPowerOfType(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewPowerType.TurretCannon);\r\n    let machine_gun = player.getPowers().getPowerOfType(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewPowerType.MachineGun);\r\n    let audit = {\r\n        civiliansRescued: 0,\r\n        hpRepaired: 0,\r\n        hpOversupplied: false,\r\n        shellsLoaded: 0,\r\n        shellsOversupplied: false,\r\n        bulletsLoaded: 0,\r\n        bulletsOversupplied: false\r\n    };\r\n    for (let inv_key of player.inventory.getKeys()) {\r\n        item = player.inventory.getItemByKey(inv_key);\r\n        // increment health for each supplies\r\n        if (item.isType(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].ItemType.Supplies)) {\r\n            if (player.hp.isMaxed()) {\r\n                audit.hpOversupplied = true;\r\n            }\r\n            player.hp.increment(1);\r\n            audit.hpRepaired += 1;\r\n            player.inventory.removeItemByKey(inv_key);\r\n        }\r\n        else if (item.isType(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].ItemType.Civilian)) {\r\n            audit.civiliansRescued += 1;\r\n            player.score.increment(1, true);\r\n            player.inventory.removeItemByKey(inv_key);\r\n        }\r\n        else if (item.isType(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].ItemType.Shells)) {\r\n            if (turret_gun.charge_stat.isMaxed()) {\r\n                audit.shellsOversupplied = true;\r\n            }\r\n            turret_gun.charge_stat.increment(1);\r\n            audit.shellsLoaded += 1;\r\n            player.inventory.removeItemByKey(inv_key);\r\n        }\r\n        else if (item.isType(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].ItemType.Bullets)) {\r\n            if (machine_gun.charge_stat.isMaxed()) {\r\n                audit.bulletsOversupplied = true;\r\n            }\r\n            machine_gun.charge_stat.increment(1);\r\n            audit.bulletsLoaded += 1;\r\n            player.inventory.removeItemByKey(inv_key);\r\n        }\r\n    }\r\n    return audit;\r\n}\r\nfunction getLevelAuditReport(gm, audit_report) {\r\n    let entryList = [];\r\n    let too_many;\r\n    let rescue_text;\r\n    if (audit_report.civiliansRescued >= 5) {\r\n        rescue_text = \"You rescued \" + audit_report.civiliansRescued + \" civilians! May God bless you!\";\r\n    }\r\n    else if (audit_report.civiliansRescued > 1) {\r\n        rescue_text = \"You rescued \" + audit_report.civiliansRescued + \" civilians. Thank you.\";\r\n    }\r\n    else if (audit_report.civiliansRescued == 1) {\r\n        rescue_text = \"You rescued a single civilian. Please, help us find more.\";\r\n    }\r\n    else {\r\n        rescue_text = \"You rescued no civilians. Surely there must be more survivors?\";\r\n    }\r\n    entryList.push({\r\n        entryType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].GenericMenuEntryType.Cancel,\r\n        entryName: \"Civilians Rescued\",\r\n        entryDescription: rescue_text,\r\n        entryEvent: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].createGenericEventOfType(gm, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.GenericMenuOff, false)\r\n    });\r\n    too_many = (audit_report.hpOversupplied) ? \"; we had more parts than we needed\" : \"\";\r\n    entryList.push({\r\n        entryType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].GenericMenuEntryType.Cancel,\r\n        entryName: \"Tank Repairs\",\r\n        entryDescription: \"We repaired \" + audit_report.hpRepaired + \" units of armor to your tank\" + too_many,\r\n        entryEvent: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].createGenericEventOfType(gm, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.GenericMenuOff, false)\r\n    });\r\n    too_many = (audit_report.shellsOversupplied) ? \"; more than your tank's capacity\" : \"\";\r\n    entryList.push({\r\n        entryType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].GenericMenuEntryType.Cancel,\r\n        entryName: \"Shells Loaded\",\r\n        entryDescription: \"We loaded \" + audit_report.shellsLoaded + \" shells\" + too_many,\r\n        entryEvent: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].createGenericEventOfType(gm, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.GenericMenuOff, false)\r\n    });\r\n    too_many = (audit_report.bulletsOversupplied) ? \"; more than your tank's capacity\" : \"\";\r\n    entryList.push({\r\n        entryType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].GenericMenuEntryType.Cancel,\r\n        entryName: \"Bullets Loaded\",\r\n        entryDescription: \"We loaded \" + audit_report.bulletsLoaded + \" units of ammunition for your machine gun\" + too_many,\r\n        entryEvent: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].createGenericEventOfType(gm, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.GenericMenuOff, false)\r\n    });\r\n    entryList.push({\r\n        entryType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].GenericMenuEntryType.Cancel,\r\n        entryName: \"Onward\",\r\n        entryDescription: \"More battlegrounds await - the wounded are in desparate need of rescue.\",\r\n        entryEvent: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].createGenericEventOfType(gm, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.GenericMenuOff, false)\r\n    });\r\n    let actionReportMenu = {\r\n        eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.GenericMenuOn,\r\n        actor: gm.getPlayer(),\r\n        playerInitiated: false,\r\n        endsTurn: false,\r\n        genericMenuData: {\r\n            allowCancel: false,\r\n            menuTitle: \"Area Action Report\",\r\n            menuDescription: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].randomOf(listEndOfLevelMessages, true),\r\n            menuEntriesList: entryList,\r\n        }\r\n    };\r\n    return actionReportMenu;\r\n}\r\nlet listEndOfLevelMessages = [\r\n    \"welcome friend. We have heard of you and your tank. We'll do what we can to help.\",\r\n    \"Wecome. We heard rumors of your tank from the resistance... it is an amazing sight.\",\r\n    \"We will take the wounded from here - you are needed back on the battlefield. Good luck!\",\r\n    \"Well met. Your reputation preceeds you - we are glad to help a true hero of the resistance.\",\r\n    \"You are doing God's work out there. Please save as many as you can.\",\r\n    \"So that tank is yours! I thought we were doomed for sure. Be careful out there - we will do what we can do help.\",\r\n];\r\nlet helpMessages = [\r\n    \"The resistance has stolen a tank! As the only qualified tank commander, it's your mission to head into the battlefield and rescue as many civilians as you can. Destroy any regime soldiers you come across. We will mark checkpoints (X) on your map - collect as many civilians and supplies as you can. We will repair and resupply your tank before sending you to the next area. Good luck!\",\r\n    \"Your tank \" + _brew__WEBPACK_IMPORTED_MODULE_0__[\"Symbols\"].pointer_up + \" + and turret \" + _brew__WEBPACK_IMPORTED_MODULE_0__[\"Symbols\"].dbl_arrow_up + \" can face different directions, and rotate independently.\",\r\n    \"- CONTROLS -\",\r\n    \"9/0 : Shrink/Enlarge Screen\",\r\n    \"W S : Tank Forward/Back\",\r\n    \"D : Rotate Tank Body Clockwise (tank pointer: \" + _brew__WEBPACK_IMPORTED_MODULE_0__[\"Symbols\"].pointer_left + \")\",\r\n    \"A : Rotate Tank Body Counter-Clockwise\",\r\n    \"E : Rotate TURRET Clockwise (turret pointer: \" + _brew__WEBPACK_IMPORTED_MODULE_0__[\"Symbols\"].dbl_arrow_left + \")\",\r\n    \"Q : Rotate TURRET Counter-Clockwise\",\r\n    \"1 : Fire Main Turret (facing direction only)\",\r\n    \"2 : Fire Machine Gun (all directions)\",\r\n    \"SPACE : Wait, Pickup, Use Exit (X)\",\r\n    \"i : Inventory\",\r\n    \"Z : Heads up Display (arrows to move, ESC/Z/SPACE to exit)\",\r\n    \"X : eXamine nearby\",\r\n    \"- HOW TO PLAY -\",\r\n    \"You can SMASH through most obstacles - including enemies\",\r\n    \"You can carry a limited number of items (\" + _brew__WEBPACK_IMPORTED_MODULE_0__[\"Config\"].max_items + \")\",\r\n    \"Each area has a red exit checkpoint (marked X), bringing different items with you will become your core strategy:\",\r\n    \"@ Rescuing Civilians is the only way to increase your SCORE\",\r\n    \"% Supplies - Repair 1 point of armor for each carried\",\r\n    _brew__WEBPACK_IMPORTED_MODULE_0__[\"Symbols\"].power_sys + \" Shells - Reload 1 unit of ammo for your main turret\",\r\n    \"= Bullets - Reload 1 unit of ammo for your machine gun\",\r\n    \"Get through as many areas as you can - rescue as many civilians as you can. I'm afraid your mission will not end well for you personally... you are doing God's work.\"\r\n];\r\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvYXJlcy90YW5rLnRzPzdlNDciXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7O0FBQStCO0FBRS9CLElBQUksbUJBQW1CLEdBQXFDLEVBQUU7QUFDOUQsbUJBQW1CLENBQUMsMkNBQVUsQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLEdBQUcsSUFBSSxDQUFDLEVBQUUsR0FBRyxDQUFDO0FBQy9ELG1CQUFtQixDQUFDLDJDQUFVLENBQUMsU0FBUyxDQUFDLE9BQU8sQ0FBQyxHQUFHLElBQUksQ0FBQyxFQUFFO0FBQzNELG1CQUFtQixDQUFDLDJDQUFVLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyxHQUFHLElBQUksQ0FBQyxFQUFFLEdBQUcsQ0FBQztBQUNsRSxtQkFBbUIsQ0FBQywyQ0FBVSxDQUFDLFNBQVMsQ0FBQyxTQUFTLENBQUMsR0FBRyxJQUFJLENBQUMsRUFBRSxHQUFHLENBQUM7QUFDakUsbUJBQW1CLENBQUMsMkNBQVUsQ0FBQyxTQUFTLENBQUMsY0FBYyxDQUFDLEdBQUcsSUFBSSxDQUFDLEVBQUUsR0FBRyxDQUFDLEdBQUMsQ0FBQztBQUN4RSxtQkFBbUIsQ0FBQywyQ0FBVSxDQUFDLFNBQVMsQ0FBQyxlQUFlLENBQUMsR0FBRyxJQUFJLENBQUMsRUFBRSxHQUFHLENBQUMsR0FBQyxDQUFDO0FBRW5FLDRCQUE2QixRQUE4QjtJQUM3RCxNQUFNLENBQUMsbUJBQW1CLENBQUMsUUFBUSxDQUFDO0FBQ3hDLENBQUM7QUFFSyxpQ0FBa0MsS0FBOEIsRUFBRSxPQUFlO0lBQ25GLElBQUksWUFBNkI7SUFFakMsRUFBRSxDQUFDLENBQUMsNENBQVcsQ0FBQyxXQUFXLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNoRCxZQUFZLEdBQUcsS0FBSyxDQUFDLGdCQUFnQjtJQUV6QyxDQUFDO0lBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLDRDQUFX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d0Q7SUFDeEQsdUtBQXVLO0NBRTFLIiwiZmlsZSI6Ii4vc3JjL2FyZXMvdGFuay50cy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIEJyZXcgZnJvbSBcIi4uL2JyZXdcIlxyXG5cclxubGV0IEJyZXdGaXJpbmdBcmNBbmdsZXMgOiB7IFthcmNfbmFtZTogc3RyaW5nXSA6IG51bWJlciB9ID0ge31cclxuQnJld0ZpcmluZ0FyY0FuZ2xlc1tCcmV3LkVudW1zLkZpcmluZ0FyYy5GdWxsQXJjXSA9IE1hdGguUEkgKiAyXHJcbkJyZXdGaXJpbmdBcmNBbmdsZXNbQnJldy5FbnVtcy5GaXJpbmdBcmMuSGFsZkFyY10gPSBNYXRoLlBJXHJcbkJyZXdGaXJpbmdBcmNBbmdsZXNbQnJldy5FbnVtcy5GaXJpbmdBcmMuUXVhcnRlckFyY10gPSBNYXRoLlBJIC8gMlxyXG5CcmV3RmlyaW5nQXJjQW5nbGVzW0JyZXcuRW51bXMuRmlyaW5nQXJjLk9jdGFudEFyY10gPSBNYXRoLlBJIC8gNFxyXG5CcmV3RmlyaW5nQXJjQW5nbGVzW0JyZXcuRW51bXMuRmlyaW5nQXJjLlRocmVlT2N0YW50QXJjXSA9IE1hdGguUEkgKiAzLzRcclxuQnJld0ZpcmluZ0FyY0FuZ2xlc1tCcmV3LkVudW1zLkZpcmluZ0FyYy5UaHJlZVF1YXJ0ZXJBcmNdID0gTWF0aC5QSSAqIDMvMlxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldEZpcmluZ0FyY1ZhbHVlcyhhcmNfbmFtZTogQnJldy5FbnVtcy5GaXJpbmdBcmMpIDogbnVtYmVyIHtcclxuICAgIHJldHVybiBCcmV3RmlyaW5nQXJjQW5nbGVzW2FyY19uYW1lXVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0RGlyZWN0aW9uRnJvbUtleWNvZGUoYWN0b3I6IEJyZXcuR3JpZFRoaW5ncy5Nb25zdGVyLCBrZXljb2RlOiBudW1iZXIpOiBCcmV3LkNvb3JkaW5hdGUge1xyXG4gICAgbGV0IGRpcmVjdGlvbl94eTogQnJldy5Db29yZGluYXRlXHJcbiAgICBcclxuICAgIGlmIChCcmV3LktleU1hcC5Nb3ZlRm9yd2FyZC5pbmRleE9mKGtleWNvZGUpID4gLTEpIHtcclxuICAgICAgICBkaXJlY3Rpb25feHkgPSBhY3Rvci5mYWNpbmdfZGlyZWN0aW9uXHJcbiAgICAgICAgXHJcbiAgICB9IGVsc2UgaWYgKEJyZXcuS2V5TWFwLk1vdmVCYWNrd2FyZC5pbmRleE9mKGtleWNvZGUpID4gLTEpIHtcclxuICAgICAgICBsZXQgYmFja3dhcmRzX3h5ID0gYWN0b3IuZmFjaW5nX2RpcmVjdGlvbi5tdWx0aXBseVNjYWxhcigtMSlcclxuICAgICAgICBkaXJlY3Rpb25feHkgPSBiYWNrd2FyZHNfeHlcclxuXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBudWxsXHJcbiAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgcmV0dXJuIGRpcmVjdGlvbl94eVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0Um90YXRlZEZhY2luZ0RpcmVjdGlvbkZyb21LZXljb2RlKGZhY2luZ19kaXJfeHk6IEJyZXcuQ29vcmRpbmF0ZSwga2V5Y29kZTogbnVtYmVyKSA6IEJyZXcuQ29vcmRpbmF0ZSB7XHJcbiAgICBsZXQgbmV3X2ZhY2luZ194eSA6IEJyZXcuQ29vcmRpbmF0ZVxyXG4gICAgLy8gbGV0IHR1cm5fYW5nbGUgPSBNYXRoLlBJIC8gMlxyXG4gICAgbGV0IGN1cnJlbnRfYW5nbGUgPSBCcmV3LlV0aWxzLnh5VG9Qb2xhcihmYWNpbmdfZGlyX3h5LnRvVW5pdCgpKS5hbmdsZV90aGV0YVxyXG4gICAgbGV0IG5ld19hbmdsZSA6IG51bWJlclxyXG5cclxuICAgIGlmIChCcmV3LktleU1hcC5DV1JvdGF0ZUtleXMuaW5kZXhPZihrZXljb2RlKSA+IC0xKSB7XHJcbiAgICAgICAgbmV3X2FuZ2xlID0gY3VycmVudF9hbmdsZSArIChNYXRoLlBJIC8gMilcclxuICAgIH0gZWxzZSBpZiAoQnJldy5LZXlNYXAuQ0NXUm90YXRlS2V5cy5pbmRleE9mKGtleWNvZGUpID4gLTEpIHtcclxuICAgICAgICBuZXdfYW5nbGUgPSBjdXJyZW50X2FuZ2xlIC0gKE1hdGguUEkgLyAyKVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgfVxyXG5cclxuICAgIGlmIChNYXRoLmFicyhuZXdfYW5nbGUpID09IE1hdGguUEkpIHtcclxuICAgICAgICBuZXdfYW5nbGUgPSBNYXRoLlBJXHJcbiAgICB9XHJcblxyXG4gICAgbmV3X2ZhY2luZ194eSA9IEJyZXcuVXRpbHMuZ2V0UG9sYXJPZmZzZXRDb29yZGluYXRlKG5ld19hbmdsZSwgMSlcclxuICAgIC8vIGNvbnNvbGUubG9nKG5ld19hbmdsZSwgbmV3X2ZhY2luZ194eSlcclxuXHJcbiAgICByZXR1cm4gbmV3X2ZhY2luZ194eVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcm90YXRlX2JvZHkoZ206IEJyZXcuR2FtZU1hc3RlciwgYnJFdmVudDogQnJldy5FbnVtcy5JQnJld0V2ZW50KSB7XHJcbiAgICBsZXQgbmV3X2ZhY2luZ194eSA9IGJyRXZlbnQucm90YXRlRGF0YS5uZXdfZmFjaW5nX3h5XHJcbiAgICBickV2ZW50LmFjdG9yLmZhY2luZ19kaXJlY3Rpb24gPSBuZXdfZmFjaW5nX3h5XHJcblxyXG4gICAgQnJldy5QYXJ0cy5yZW1vdmVNb25zdGVyUGFydHNGcm9tR3JpZChnbSwgYnJFdmVudC5hY3RvcilcclxuICAgIEJyZXcuUGFydHMudXBkYXRlTW9uc3RlclBhcnRzKGdtLCBickV2ZW50LmFjdG9yKVxyXG4gICAgQnJldy5QYXJ0cy5wbGFjZU1vbnN0ZXJQYXJ0c09uR3JpZChnbSwgYnJFdmVudC5hY3RvcilcclxuXHJcbiAgICBnbS5lbmRFdmVudChickV2ZW50KVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcm90YXRlX3dlYXBvbihnbTogQnJldy5HYW1lTWFzdGVyLCBickV2ZW50OiBCcmV3LkVudW1zLklCcmV3RXZlbnQpIHtcclxuICAgIGxldCBuZXdfZmFjaW5nX3h5ID0gYnJFdmVudC5yb3RhdGVEYXRhLm5ld19mYWNpbmdfeHlcclxuICAgIGxldCB3ZWFwb25Qb3dlciA9IGJyRXZlbnQucm90YXRlRGF0YS53ZWFwb25Qb3dlclxyXG4gICAgd2VhcG9uUG93ZXIuZmFjaW5nX2RpcmVjdGlvbiA9IG5ld19mYWNpbmdfeHlcclxuXHJcbiAgICBCcmV3LlBhcnRzLnJlbW92ZU1vbnN0ZXJQYXJ0c0Zyb21HcmlkKGdtLCBickV2ZW50LmFjdG9yKVxyXG4gICAgQnJldy5QYXJ0cy51cGRhdGVNb25zdGVyUGFydHMoZ20sIGJyRXZlbnQuYWN0b3IpXHJcbiAgICBCcmV3LlBhcnRzLnBsYWNlTW9uc3RlclBhcnRzT25HcmlkKGdtLCBickV2ZW50LmFjdG9yKVxyXG5cclxuICAgIGdtLmVuZEV2ZW50KGJyRXZlbnQpXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRQcmltYXJ5RmFjaW5nRGlyZWN0aW9uKGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGFjdG9yOiBCcmV3LkdyaWRUaGluZ3MuTW9uc3RlcikgOiBCcmV3LkNvb3JkaW5hdGUge1xyXG4gICAgbGV0IHZpZXdfZGlyZWN0aW9uOiBCcmV3LkNvb3JkaW5hdGVcclxuICAgIGxldCB0dXJyZXRQb3dlciA9IGFjdG9yLmdldFBvd2VycygpLmdldFBvd2VyT2ZUeXBlKEJyZXcuRW51bXMuQnJld1Bvd2VyVHlwZS5UdXJyZXRDYW5ub24pXHJcbiAgICBpZiAodHVycmV0UG93ZXIpIHtcclxuICAgICAgICB2aWV3X2RpcmVjdGlvbiA9IHR1cnJldFBvd2VyLmZhY2luZ19kaXJlY3Rpb25cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdmlld19kaXJlY3Rpb24gPSBhY3Rvci5mYWNpbmdfZGlyZWN0aW9uXHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHZpZXdfZGlyZWN0aW9uXHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgSUZpcmluZ0FyY1JhbmdlIHtcclxuICAgIG1pbkFuZ2xlOiBudW1iZXJcclxuICAgIG1heEFuZ2xlOiBudW1iZXJcclxuICAgIG1pZHBvaW50QW5nbGU6IG51bWJlclxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0RmlyaW5nQXJjUmFuZ2UoZ206IEJyZXcuR2FtZU1hc3RlciwgY2VudGVyX3h5OiBCcmV3LkNvb3JkaW5hdGUsIHdlYXBvblBvd2VyOiBCcmV3LlBvd2Vycy5Qb3dlcikgOiBJRmlyaW5nQXJjUmFuZ2Uge1xyXG5cclxuICAgIGxldCBmYWNpbmdfZGlyX3h5ID0gd2VhcG9uUG93ZXIuZmFjaW5nX2RpcmVjdGlvblxyXG4gICAgbGV0IGNlbnRlcl9hbmdsZSA9IEJyZXcuVXRpbHMueHlUb1BvbGFyKGZhY2luZ19kaXJfeHkpLmFuZ2xlX3RoZXRhXHJcblxyXG4gICAgbGV0IGZ1bGxfYXJjID0gZ2V0RmlyaW5nQXJjVmFsdWVzKHdlYXBvblBvd2VyLmZpcmluZ19hcmMpXHJcbiAgICBsZXQgaGFsZl9yYW5nZSA9IGZ1bGxfYXJjIC8gMlxyXG5cclxuICAgIGxldCBtaW5fYW5nbGUgPSBjZW50ZXJfYW5nbGUgLSBoYWxmX3JhbmdlXHJcbiAgICBsZXQgbWF4X2FuZ2xlID0gY2VudGVyX2FuZ2xlICsgaGFsZl9yYW5nZVxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgbWluQW5nbGU6IG1pbl9hbmdsZSxcclxuICAgICAgICBtaWRwb2ludEFuZ2xlOiBjZW50ZXJfYW5nbGUsXHJcbiAgICAgICAgbWF4QW5nbGU6IG1heF9hbmdsZSxcclxuICAgIH1cclxufVxyXG5cclxuLy8gZXhwb3J0IGZ1bmN0aW9uIGlzVGFyZ2V0V2l0aGluRmlyaW5nQXJjKGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGNlbnRlcl94eTogQnJldy5Db29yZGluYXRlLCB3ZWFwb25Qb3dlcjogQnJldy5Qb3dlcnMuUG93ZXIsIHRhcmdldF94eTogQnJldy5Db29yZGluYXRlKSA6IGJvb2xlYW4ge1xyXG4vLyAgICAgLy8gZmluZCB0aGUgbWF4L21pbiB2YWx1ZXMgb2Ygb3VyIHJhbmdlXHJcbi8vICAgICBsZXQgYXJjX3JhbmdlID0gZ2V0RmlyaW5nQXJjUmFuZ2UoZ20sIGNlbnRlcl94eSwgd2VhcG9uUG93ZXIpXHJcblxyXG4vLyAgICAgLy8gZmlndXJlIG91dCB3aGVyZSB0YXJnZXQgaXMgcmVsYXRpdmUgdG8gY2VudGVyXHJcbi8vICAgICAvLyBsZXQgZGlzdCA9IEJyZXcuVXRpbHMuZGlzdDJkKGNlbnRlcl94eSwgdGFyZ2V0X3h5KVxyXG4vLyAgICAgbGV0IHRhcmdldF9vZmZzZXRfcG9sYXIgPSBCcmV3LlV0aWxzLnh5VG9Qb2xhcih0YXJnZXRfeHksIGNlbnRlcl94eSlcclxuXHJcbi8vICAgICByZXR1cm4gdHJ1ZVxyXG4vLyB9XHJcblxyXG5pbnRlcmZhY2UgSUVuZE9mTGV2ZWxJbnZlbnRvcnlBdWRpdCB7XHJcbiAgICBocFJlcGFpcmVkOiBudW1iZXIsXHJcbiAgICBocE92ZXJzdXBwbGllZDogYm9vbGVhbixcclxuICAgIHNoZWxsc0xvYWRlZDogbnVtYmVyLFxyXG4gICAgc2hlbGxzT3ZlcnN1cHBsaWVkOiBib29sZWFuLFxyXG4gICAgYnVsbGV0c0xvYWRlZDogbnVtYmVyLFxyXG4gICAgYnVsbGV0c092ZXJzdXBwbGllZDogYm9vbGVhbixcclxuICAgIGNpdmlsaWFuc1Jlc2N1ZWQ6IG51bWJlcixcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHByb2Nlc3NJbnZlbnRvcnkoZ206IEJyZXcuR2FtZU1hc3RlcikgOiBJRW5kT2ZMZXZlbEludmVudG9yeUF1ZGl0IHtcclxuICAgIGxldCBwbGF5ZXIgPSBnbS5nZXRQbGF5ZXIoKVxyXG4gICAgbGV0IGl0ZW0gOiBCcmV3LkdyaWRUaGluZ3MuSXRlbVxyXG4gICAgbGV0IHR1cnJldF9ndW4gPSBwbGF5ZXIuZ2V0UG93ZXJzKCkuZ2V0UG93ZXJPZlR5cGUoQnJldy5FbnVtcy5CcmV3UG93ZXJUeXBlLlR1cnJldENhbm5vbilcclxuICAgIGxldCBtYWNoaW5lX2d1biA9IHBsYXllci5nZXRQb3dlcnMoKS5nZXRQb3dlck9mVHlwZShCcmV3LkVudW1zLkJyZXdQb3dlclR5cGUuTWFjaGluZUd1bilcclxuXHJcbiAgICBsZXQgYXVkaXQgOiBJRW5kT2ZMZXZlbEludmVudG9yeUF1ZGl0ID0ge1xyXG4gICAgICAgIGNpdmlsaWFuc1Jlc2N1ZWQ6IDAsXHJcbiAgICAgICAgaHBSZXBhaXJlZDogMCxcclxuICAgICAgICBocE92ZXJzdXBwbGllZDogZmFsc2UsXHJcbiAgICAgICAgc2hlbGxzTG9hZGVkOiAwLFxyXG4gICAgICAgIHNoZWxsc092ZXJzdXBwbGllZDogZmFsc2UsXHJcbiAgICAgICAgYnVsbGV0c0xvYWRlZDogMCxcclxuICAgICAgICBidWxsZXRzT3ZlcnN1cHBsaWVkOiBmYWxzZVxyXG4gICAgfVxyXG5cclxuICAgIGZvciAobGV0IGludl9rZXkgb2YgcGxheWVyLmludmVudG9yeS5nZXRLZXlzKCkpIHtcclxuICAgICAgICBpdGVtID0gcGxheWVyLmludmVudG9yeS5nZXRJdGVtQnlLZXkoaW52X2tleSlcclxuXHJcbiAgICAgICAgLy8gaW5jcmVtZW50IGhlYWx0aCBmb3IgZWFjaCBzdXBwbGllc1xyXG4gICAgICAgIGlmIChpdGVtLmlzVHlwZShCcmV3LkRlZmluaXRpb25zLkl0ZW1UeXBlLlN1cHBsaWVzKSkge1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgaWYgKHBsYXllci5ocC5pc01heGVkKCkpIHtcclxuICAgICAgICAgICAgICAgIGF1ZGl0LmhwT3ZlcnN1cHBsaWVkID0gdHJ1ZVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBwbGF5ZXIuaHAuaW5jcmVtZW50KDEpXHJcbiAgICAgICAgICAgIGF1ZGl0LmhwUmVwYWlyZWQgKz0gMVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcGxheWVyLmludmVudG9yeS5yZW1vdmVJdGVtQnlLZXkoaW52X2tleSlcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgfSBlbHNlIGlmIChpdGVtLmlzVHlwZShCcmV3LkRlZmluaXRpb25zLkl0ZW1UeXBlLkNpdmlsaWFuKSkge1xyXG4gICAgICAgICAgICBhdWRpdC5jaXZpbGlhbnNSZXNjdWVkICs9IDFcclxuICAgICAgICAgICAgcGxheWVyLnNjb3JlLmluY3JlbWVudCgxLCB0cnVlKVxyXG4gICAgICAgICAgICBwbGF5ZXIuaW52ZW50b3J5LnJlbW92ZUl0ZW1CeUtleShpbnZfa2V5KVxyXG5cclxuICAgICAgICB9IGVsc2UgaWYgKGl0ZW0uaXNUeXBlKEJyZXcuRGVmaW5pdGlvbnMuSXRlbVR5cGUuU2hlbGxzKSkge1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgaWYgKHR1cnJldF9ndW4uY2hhcmdlX3N0YXQuaXNNYXhlZCgpKSB7XHJcbiAgICAgICAgICAgICAgICBhdWRpdC5zaGVsbHNPdmVyc3VwcGxpZWQgPSB0cnVlXHJcbiAgICAgICAgICAgIH0gXHJcbiAgICAgICAgICAgIHR1cnJldF9ndW4uY2hhcmdlX3N0YXQuaW5jcmVtZW50KDEpXHJcbiAgICAgICAgICAgIGF1ZGl0LnNoZWxsc0xvYWRlZCArPSAxXHJcbiAgICAgICAgICAgIHBsYXllci5pbnZlbnRvcnkucmVtb3ZlSXRlbUJ5S2V5KGludl9rZXkpXHJcblxyXG4gICAgICAgIH0gZWxzZSBpZiAoaXRlbS5pc1R5cGUoQnJldy5EZWZpbml0aW9ucy5JdGVtVHlwZS5CdWxsZXRzKSkge1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgaWYgKG1hY2hpbmVfZ3VuLmNoYXJnZV9zdGF0LmlzTWF4ZWQoKSkge1xyXG4gICAgICAgICAgICAgICAgYXVkaXQuYnVsbGV0c092ZXJzdXBwbGllZCA9IHRydWVcclxuICAgICAgICAgICAgfSBcclxuICAgICAgICAgICAgbWFjaGluZV9ndW4uY2hhcmdlX3N0YXQuaW5jcmVtZW50KDEpXHJcbiAgICAgICAgICAgIGF1ZGl0LmJ1bGxldHNMb2FkZWQgKz0gMVxyXG4gICAgICAgICAgICBwbGF5ZXIuaW52ZW50b3J5LnJlbW92ZUl0ZW1CeUtleShpbnZfa2V5KVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gYXVkaXRcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldExldmVsQXVkaXRSZXBvcnQoZ206IEJyZXcuR2FtZU1hc3RlciwgYXVkaXRfcmVwb3J0IDogSUVuZE9mTGV2ZWxJbnZlbnRvcnlBdWRpdCkgOiBCcmV3LkVudW1zLklCcmV3RXZlbnQge1xyXG5cclxuICAgIGxldCBlbnRyeUxpc3QgOiBBcnJheTxCcmV3LkVudW1zLklCcmV3R2VuZXJpY01lbnVFbnRyeT4gPSBbXVxyXG4gICAgbGV0IHRvb19tYW55IDogc3RyaW5nXHJcblxyXG4gICAgbGV0IHJlc2N1ZV90ZXh0IDogc3RyaW5nXHJcbiAgICBpZiAoYXVkaXRfcmVwb3J0LmNpdmlsaWFuc1Jlc2N1ZWQgPj0gNSkge1xyXG4gICAgICAgIHJlc2N1ZV90ZXh0ID0gXCJZb3UgcmVzY3VlZCBcIiArIGF1ZGl0X3JlcG9ydC5jaXZpbGlhbnNSZXNjdWVkICsgXCIgY2l2aWxpYW5zISBNYXkgR29kIGJsZXNzIHlvdSFcIlxyXG4gICAgfSBlbHNlIGlmIChhdWRpdF9yZXBvcnQuY2l2aWxpYW5zUmVzY3VlZCA+IDEpIHtcclxuICAgICAgICByZXNjdWVfdGV4dCA9IFwiWW91IHJlc2N1ZWQgXCIgKyBhdWRpdF9yZXBvcnQuY2l2aWxpYW5zUmVzY3VlZCArIFwiIGNpdmlsaWFucy4gVGhhbmsgeW91LlwiXHJcbiAgICB9IGVsc2UgaWYgKGF1ZGl0X3JlcG9ydC5jaXZpbGlhbnNSZXNjdWVkID09IDEpIHtcclxuICAgICAgICByZXNjdWVfdGV4dCA9IFwiWW91IHJlc2N1ZWQgYSBzaW5nbGUgY2l2aWxpYW4uIFBsZWFzZSwgaGVscCB1cyBmaW5kIG1vcmUuXCJcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmVzY3VlX3RleHQgPSBcIllvdSByZXNjdWVkIG5vIGNpdmlsaWFucy4gU3VyZWx5IHRoZXJlIG11c3QgYmUgbW9yZSBzdXJ2aXZvcnM/XCJcclxuICAgIH1cclxuXHJcbiAgICBlbnRyeUxpc3QucHVzaCh7XHJcbiAgICAgICAgZW50cnlUeXBlOiBCcmV3LkVudW1zLkdlbmVyaWNNZW51RW50cnlUeXBlLkNhbmNlbCxcclxuICAgICAgICBlbnRyeU5hbWU6IFwiQ2l2aWxpYW5zIFJlc2N1ZWRcIixcclxuICAgICAgICBlbnRyeURlc2NyaXB0aW9uOiByZXNjdWVfdGV4dCxcclxuICAgICAgICBlbnRyeUV2ZW50OiBCcmV3LkV2ZW50cy5jcmVhdGVHZW5lcmljRXZlbnRPZlR5cGUoZ20sIEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5HZW5lcmljTWVudU9mZiwgZmFsc2UpXHJcbiAgICB9KVxyXG5cclxuICAgIHRvb19tYW55ID0gKGF1ZGl0X3JlcG9ydC5ocE92ZXJzdXBwbGllZCkgPyBcIjsgd2UgaGFkIG1vcmUgcGFydHMgdGhhbiB3ZSBuZWVkZWRcIiA6IFwiXCJcclxuICAgIGVudHJ5TGlzdC5wdXNoKHtcclxuICAgICAgICBlbnRyeVR5cGU6IEJyZXcuRW51bXMuR2VuZXJpY01lbnVFbnRyeVR5cGUuQ2FuY2VsLFxyXG4gICAgICAgIGVudHJ5TmFtZTogXCJUYW5rIFJlcGFpcnNcIixcclxuICAgICAgICBlbnRyeURlc2NyaXB0aW9uOiBcIldlIHJlcGFpcmVkIFwiICsgYXVkaXRfcmVwb3J0LmhwUmVwYWlyZWQgKyBcIiB1bml0cyBvZiBhcm1vciB0byB5b3VyIHRhbmtcIiArIHRvb19tYW55LFxyXG4gICAgICAgIGVudHJ5RXZlbnQ6IEJyZXcuRXZlbnRzLmNyZWF0ZUdlbmVyaWNFdmVudE9mVHlwZShnbSwgQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLkdlbmVyaWNNZW51T2ZmLCBmYWxzZSlcclxuICAgIH0pXHJcblxyXG4gICAgdG9vX21hbnkgPSAoYXVkaXRfcmVwb3J0LnNoZWxsc092ZXJzdXBwbGllZCkgPyBcIjsgbW9yZSB0aGFuIHlvdXIgdGFuaydzIGNhcGFjaXR5XCIgOiBcIlwiXHJcbiAgICBlbnRyeUxpc3QucHVzaCh7XHJcbiAgICAgICAgZW50cnlUeXBlOiBCcmV3LkVudW1zLkdlbmVyaWNNZW51RW50cnlUeXBlLkNhbmNlbCxcclxuICAgICAgICBlbnRyeU5hbWU6IFwiU2hlbGxzIExvYWRlZFwiLFxyXG4gICAgICAgIGVudHJ5RGVzY3JpcHRpb246IFwiV2UgbG9hZGVkIFwiICsgYXVkaXRfcmVwb3J0LnNoZWxsc0xvYWRlZCArIFwiIHNoZWxsc1wiICsgdG9vX21hbnksXHJcbiAgICAgICAgZW50cnlFdmVudDogQnJldy5FdmVudHMuY3JlYXRlR2VuZXJpY0V2ZW50T2ZUeXBlKGdtLCBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuR2VuZXJpY01lbnVPZmYsIGZhbHNlKVxyXG4gICAgfSlcclxuXHJcbiAgICB0b29fbWFueSA9IChhdWRpdF9yZXBvcnQuYnVsbGV0c092ZXJzdXBwbGllZCkgPyBcIjsgbW9yZSB0aGFuIHlvdXIgdGFuaydzIGNhcGFjaXR5XCIgOiBcIlwiXHJcbiAgICBlbnRyeUxpc3QucHVzaCh7XHJcbiAgICAgICAgZW50cnlUeXBlOiBCcmV3LkVudW1zLkdlbmVyaWNNZW51RW50cnlUeXBlLkNhbmNlbCxcclxuICAgICAgICBlbnRyeU5hbWU6IFwiQnVsbGV0cyBMb2FkZWRcIixcclxuICAgICAgICBlbnRyeURlc2NyaXB0aW9uOiBcIldlIGxvYWRlZCBcIiArIGF1ZGl0X3JlcG9ydC5idWxsZXRzTG9hZGVkICsgXCIgdW5pdHMgb2YgYW1tdW5pdGlvbiBmb3IgeW91ciBtYWNoaW5lIGd1blwiICsgdG9vX21hbnksXHJcbiAgICAgICAgZW50cnlFdmVudDogQnJldy5FdmVudHMuY3JlYXRlR2VuZXJpY0V2ZW50T2ZUeXBlKGdtLCBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuR2VuZXJpY01lbnVPZmYsIGZhbHNlKVxyXG4gICAgfSlcclxuXHJcbiAgICBlbnRyeUxpc3QucHVzaCh7XHJcbiAgICAgICAgZW50cnlUeXBlOiBCcmV3LkVudW1zLkdlbmVyaWNNZW51RW50cnlUeXBlLkNhbmNlbCxcclxuICAgICAgICBlbnRyeU5hbWU6IFwiT253YXJkXCIsXHJcbiAgICAgICAgZW50cnlEZXNjcmlwdGlvbjogXCJNb3JlIGJhdHRsZWdyb3VuZHMgYXdhaXQgLSB0aGUgd291bmRlZCBhcmUgaW4gZGVzcGFyYXRlIG5lZWQgb2YgcmVzY3VlLlwiLFxyXG4gICAgICAgIGVudHJ5RXZlbnQ6IEJyZXcuRXZlbnRzLmNyZWF0ZUdlbmVyaWNFdmVudE9mVHlwZShnbSwgQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLkdlbmVyaWNNZW51T2ZmLCBmYWxzZSlcclxuICAgIH0pXHJcblxyXG4gICAgbGV0IGFjdGlvblJlcG9ydE1lbnUgOiBCcmV3LkVudW1zLklCcmV3RXZlbnQgPSB7XHJcbiAgICAgICAgZXZlbnRUeXBlOiBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuR2VuZXJpY01lbnVPbixcclxuICAgICAgICBhY3RvcjogZ20uZ2V0UGxheWVyKCksXHJcbiAgICAgICAgcGxheWVySW5pdGlhdGVkOiBmYWxzZSxcclxuICAgICAgICBlbmRzVHVybjogZmFsc2UsXHJcbiAgICAgICAgZ2VuZXJpY01lbnVEYXRhOiB7XHJcbiAgICAgICAgICAgIGFsbG93Q2FuY2VsOiBmYWxzZSxcclxuICAgICAgICAgICAgbWVudVRpdGxlOiBcIkFyZWEgQWN0aW9uIFJlcG9ydFwiLFxyXG4gICAgICAgICAgICBtZW51RGVzY3JpcHRpb246IEJyZXcuVXRpbHMucmFuZG9tT2YoIGxpc3RFbmRPZkxldmVsTWVzc2FnZXMsIHRydWUpLFxyXG4gICAgICAgICAgICBtZW51RW50cmllc0xpc3Q6ICBlbnRyeUxpc3QsXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBhY3Rpb25SZXBvcnRNZW51XHJcbn1cclxuXHJcbmxldCBsaXN0RW5kT2ZMZXZlbE1lc3NhZ2VzIDogc3RyaW5nW10gPSBbXHJcbiAgICBcIndlbGNvbWUgZnJpZW5kLiBXZSBoYXZlIGhlYXJkIG9mIHlvdSBhbmQgeW91ciB0YW5rLiBXZSdsbCBkbyB3aGF0IHdlIGNhbiB0byBoZWxwLlwiLFxyXG4gICAgXCJXZWNvbWUuIFdlIGhlYXJkIHJ1bW9ycyBvZiB5b3VyIHRhbmsgZnJvbSB0aGUgcmVzaXN0YW5jZS4uLiBpdCBpcyBhbiBhbWF6aW5nIHNpZ2h0LlwiLFxyXG4gICAgXCJXZSB3aWxsIHRha2UgdGhlIHdvdW5kZWQgZnJvbSBoZXJlIC0geW91IGFyZSBuZWVkZWQgYmFjayBvbiB0aGUgYmF0dGxlZmllbGQuIEdvb2QgbHVjayFcIixcclxuICAgIFwiV2VsbCBtZXQuIFlvdXIgcmVwdXRhdGlvbiBwcmVjZWVkcyB5b3UgLSB3ZSBhcmUgZ2xhZCB0byBoZWxwIGEgdHJ1ZSBoZXJvIG9mIHRoZSByZXNpc3RhbmNlLlwiLFxyXG4gICAgXCJZb3UgYXJlIGRvaW5nIEdvZCdzIHdvcmsgb3V0IHRoZXJlLiBQbGVhc2Ugc2F2ZSBhcyBtYW55IGFzIHlvdSBjYW4uXCIsXHJcbiAgICBcIlNvIHRoYXQgdGFuayBpcyB5b3VycyEgSSB0aG91Z2h0IHdlIHdlcmUgZG9vbWVkIGZvciBzdXJlLiBCZSBjYXJlZnVsIG91dCB0aGVyZSAtIHdlIHdpbGwgZG8gd2hhdCB3ZSBjYW4gZG8gaGVscC5cIixcclxuXVxyXG5cclxuZXhwb3J0IGxldCBoZWxwTWVzc2FnZXMgOiBzdHJpbmdbXSA9IFtcclxuICAgIFwiVGhlIHJlc2lzdGFuY2UgaGFzIHN0b2xlbiBhIHRhbmshIEFzIHRoZSBvbmx5IHF1YWxpZmllZCB0YW5rIGNvbW1hbmRlciwgaXQncyB5b3VyIG1pc3Npb24gdG8gaGVhZCBpbnRvIHRoZSBiYXR0bGVmaWVsZCBhbmQgcmVzY3VlIGFzIG1hbnkgY2l2aWxpYW5zIGFzIHlvdSBjYW4uIERlc3Ryb3kgYW55IHJlZ2ltZSBzb2xkaWVycyB5b3UgY29tZSBhY3Jvc3MuIFdlIHdpbGwgbWFyayBjaGVja3BvaW50cyAoWCkgb24geW91ciBtYXAgLSBjb2xsZWN0IGFzIG1hbnkgY2l2aWxpYW5zIGFuZCBzdXBwbGllcyBhcyB5b3UgY2FuLiBXZSB3aWxsIHJlcGFpciBhbmQgcmVzdXBwbHkgeW91ciB0YW5rIGJlZm9yZSBzZW5kaW5nIHlvdSB0byB0aGUgbmV4dCBhcmVhLiBHb29kIGx1Y2shXCIsXHJcbiAgICBcIllvdXIgdGFuayBcIiArIEJyZXcuU3ltYm9scy5wb2ludGVyX3VwICsgXCIgKyBhbmQgdHVycmV0IFwiICsgQnJldy5TeW1ib2xzLmRibF9hcnJvd191cCArIFwiIGNhbiBmYWNlIGRpZmZlcmVudCBkaXJlY3Rpb25zLCBhbmQgcm90YXRlIGluZGVwZW5kZW50bHkuXCIsXHJcbiAgICBcIi0gQ09OVFJPTFMgLVwiLFxyXG4gICAgXCI5LzAgOiBTaHJpbmsvRW5sYXJnZSBTY3JlZW5cIixcclxuICAgIFwiVyBTIDogVGFuayBGb3J3YXJkL0JhY2tcIixcclxuICAgIFwiRCA6IFJvdGF0ZSBUYW5rIEJvZHkgQ2xvY2t3aXNlICh0YW5rIHBvaW50ZXI6IFwiICsgQnJldy5TeW1ib2xzLnBvaW50ZXJfbGVmdCArIFwiKVwiLFxyXG4gICAgXCJBIDogUm90YXRlIFRhbmsgQm9keSBDb3VudGVyLUNsb2Nrd2lzZVwiLFxyXG4gICAgXCJFIDogUm90YXRlIFRVUlJFVCBDbG9ja3dpc2UgKHR1cnJldCBwb2ludGVyOiBcIiArIEJyZXcuU3ltYm9scy5kYmxfYXJyb3dfbGVmdCArIFwiKVwiLFxyXG4gICAgXCJRIDogUm90YXRlIFRVUlJFVCBDb3VudGVyLUNsb2Nrd2lzZVwiLFxyXG4gICAgXCIxIDogRmlyZSBNYWluIFR1cnJldCAoZmFjaW5nIGRpcmVjdGlvbiBvbmx5KVwiLFxyXG4gICAgXCIyIDogRmlyZSBNYWNoaW5lIEd1biAoYWxsIGRpcmVjdGlvbnMpXCIsXHJcbiAgICBcIlNQQUNFIDogV2FpdCwgUGlja3VwLCBVc2UgRXhpdCAoWClcIixcclxuICAgIFwiaSA6IEludmVudG9yeVwiLFxyXG4gICAgXCJaIDogSGVhZHMgdXAgRGlzcGxheSAoYXJyb3dzIHRvIG1vdmUsIEVTQy9aL1NQQUNFIHRvIGV4aXQpXCIsXHJcbiAgICBcIlggOiBlWGFtaW5lIG5lYXJieVwiLFxyXG4gICAgXCItIEhPVyBUTyBQTEFZIC1cIixcclxuICAgIFwiWW91IGNhbiBTTUFTSCB0aHJvdWdoIG1vc3Qgb2JzdGFjbGVzIC0gaW5jbHVkaW5nIGVuZW1pZXNcIixcclxuICAgIFwiWW91IGNhbiBjYXJyeSBhIGxpbWl0ZWQgbnVtYmVyIG9mIGl0ZW1zIChcIiArIEJyZXcuQ29uZmlnLm1heF9pdGVtcyArIFwiKVwiLFxyXG4gICAgXCJFYWNoIGFyZWEgaGFzIGEgcmVkIGV4aXQgY2hlY2twb2ludCAobWFya2VkIFgpLCBicmluZ2luZyBkaWZmZXJlbnQgaXRlbXMgd2l0aCB5b3Ugd2lsbCBiZWNvbWUgeW91ciBjb3JlIHN0cmF0ZWd5OlwiLFxyXG4gICAgXCJAIFJlc2N1aW5nIENpdmlsaWFucyBpcyB0aGUgb25seSB3YXkgdG8gaW5jcmVhc2UgeW91ciBTQ09SRVwiLFxyXG4gICAgXCIlIFN1cHBsaWVzIC0gUmVwYWlyIDEgcG9pbnQgb2YgYXJtb3IgZm9yIGVhY2ggY2FycmllZFwiLFxyXG4gICAgQnJldy5TeW1ib2xzLnBvd2VyX3N5cyArIFwiIFNoZWxscyAtIFJlbG9hZCAxIHVuaXQgb2YgYW1tbyBmb3IgeW91ciBtYWluIHR1cnJldFwiLFxyXG4gICAgXCI9IEJ1bGxldHMgLSBSZWxvYWQgMSB1bml0IG9mIGFtbW8gZm9yIHlvdXIgbWFjaGluZSBndW5cIixcclxuICAgIFwiR2V0IHRocm91Z2ggYXMgbWFueSBhcmVhcyBhcyB5b3UgY2FuIC0gcmVzY3VlIGFzIG1hbnkgY2l2aWxpYW5zIGFzIHlvdSBjYW4uIEknbSBhZnJhaWQgeW91ciBtaXNzaW9uIHdpbGwgbm90IGVuZCB3ZWxsIGZvciB5b3UgcGVyc29uYWxseS4uLiB5b3UgYXJlIGRvaW5nIEdvZCdzIHdvcmsuXCJcclxuXHJcbl1cclxuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/ares/tank.ts\n");

/***/ }),

/***/ "./src/brew.ts":
/*!*********************!*\
  !*** ./src/brew.ts ***!
  \*********************/
/*! exports provided: GameMaster, Enums, Utils, Config, Symbols, Color, Coordinate, CoordinateArea, Directions, Stat, Inventory, Input, Architect, Path, FieldOfView, Timers, Intel, Debug, KeyMap, Powers, Animations, Combat, Movement, Events, Menus, ItemInteraction, Targeting, HUD, GridOfThings, Level, Portal, Definitions, GridThings, LevelGenerator, Display, Turning, Glossary, Parts, Tank, Rooms */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _brew_engine_game_master__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./brew_engine/game_master */ \"./src/brew_engine/game_master.ts\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"GameMaster\", function() { return _brew_engine_game_master__WEBPACK_IMPORTED_MODULE_0__[\"GameMaster\"]; });\n\n/* harmony import */ var _brew_engine_enums__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./brew_engine/enums */ \"./src/brew_engine/enums.ts\");\n/* harmony reexport (module object) */ __webpack_require__.d(__webpack_exports__, \"Enums\", function() { return _brew_engine_enums__WEBPACK_IMPORTED_MODULE_1__; });\n/* harmony import */ var _brew_components_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./brew_components/utils */ \"./src/brew_components/utils.ts\");\n/* harmony reexport (module object) */ __webpack_require__.d(__webpack_exports__, \"Utils\", function() { return _brew_components_utils__WEBPACK_IMPORTED_MODULE_2__; });\n/* harmony import */ var _brew_components_config__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./brew_components/config */ \"./src/brew_components/config.ts\");\n/* harmony reexport (module object) */ __webpack_require__.d(__webpack_exports__, \"Config\", function() { return _brew_components_config__WEBPACK_IMPORTED_MODULE_3__; });\n/* harmony import */ var _brew_components_symbols__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./brew_components/symbols */ \"./src/brew_components/symbols.ts\");\n/* harmony reexport (module object) */ __webpack_require__.d(__webpack_exports__, \"Symbols\", function() { return _brew_components_symbols__WEBPACK_IMPORTED_MODULE_4__; });\n/* harmony import */ var _brew_components_color__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./brew_components/color */ \"./src/brew_components/color.ts\");\n/* harmony reexport (module object) */ __webpack_require__.d(__webpack_exports__, \"Color\", function() { return _brew_components_color__WEBPACK_IMPORTED_MODULE_5__; });\n/* harmony import */ var _brew_components_coordinate__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./brew_components/coordinate */ \"./src/brew_components/coordinate.ts\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"Coordinate\", function() { return _brew_components_coordinate__WEBPACK_IMPORTED_MODULE_6__[\"Coordinate\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"CoordinateArea\", function() { return _brew_components_coordinate__WEBPACK_IMPORTED_MODULE_6__[\"CoordinateArea\"]; });\n\n/* harmony import */ var _brew_components_directions__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./brew_components/directions */ \"./src/brew_components/directions.ts\");\n/* harmony reexport (module object) */ __webpack_require__.d(__webpack_exports__, \"Directions\", function() { return _brew_components_directions__WEBPACK_IMPORTED_MODULE_7__; });\n/* harmony import */ var _brew_components_stat__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./brew_components/stat */ \"./src/brew_components/stat.ts\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"Stat\", function() { return _brew_components_stat__WEBPACK_IMPORTED_MODULE_8__[\"Stat\"]; });\n\n/* harmony import */ var _brew_components_inventory__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./brew_components/inventory */ \"./src/brew_components/inventory.ts\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"Inventory\", function() { return _brew_components_inventory__WEBPACK_IMPORTED_MODULE_9__[\"Inventory\"]; });\n\n/* harmony import */ var _brew_engine_input__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./brew_engine/input */ \"./src/brew_engine/input.ts\");\n/* harmony reexport (module object) */ __webpack_require__.d(__webpack_exports__, \"Input\", function() { return _brew_engine_input__WEBPACK_IMPORTED_MODULE_10__; });\n/* harmony import */ var _brew_engine_architect__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./brew_engine/architect */ \"./src/brew_engine/architect.ts\");\n/* harmony reexport (module object) */ __webpack_require__.d(__webpack_exports__, \"Architect\", function() { return _brew_engine_architect__WEBPACK_IMPORTED_MODULE_11__; });\n/* harmony import */ var _brew_engine_pathmap__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./brew_engine/pathmap */ \"./src/brew_engine/pathmap.ts\");\n/* harmony reexport (module object) */ __webpack_require__.d(__webpack_exports__, \"Path\", function() { return _brew_engine_pathmap__WEBPACK_IMPORTED_MODULE_12__; });\n/* harmony import */ var _brew_components_fov__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./brew_components/fov */ \"./src/brew_components/fov.ts\");\n/* harmony reexport (module object) */ __webpack_require__.d(__webpack_exports__, \"FieldOfView\", function() { return _brew_components_fov__WEBPACK_IMPORTED_MODULE_13__; });\n/* harmony import */ var _brew_engine_timers__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./brew_engine/timers */ \"./src/brew_engine/timers.ts\");\n/* harmony reexport (module object) */ __webpack_require__.d(__webpack_exports__, \"Timers\", function() { return _brew_engine_timers__WEBPACK_IMPORTED_MODULE_14__; });\n/* harmony import */ var _brew_engine_intel__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./brew_engine/intel */ \"./src/brew_engine/intel.ts\");\n/* harmony reexport (module object) */ __webpack_require__.d(__webpack_exports__, \"Intel\", function() { return _brew_engine_intel__WEBPACK_IMPORTED_MODULE_15__; });\n/* harmony import */ var _brew_engine_debug__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./brew_engine/debug */ \"./src/brew_engine/debug.ts\");\n/* harmony reexport (module object) */ __webpack_require__.d(__webpack_exports__, \"Debug\", function() { return _brew_engine_debug__WEBPACK_IMPORTED_MODULE_16__; });\n/* harmony import */ var _brew_engine_keymap__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./brew_engine/keymap */ \"./src/brew_engine/keymap.ts\");\n/* harmony reexport (module object) */ __webpack_require__.d(__webpack_exports__, \"KeyMap\", function() { return _brew_engine_keymap__WEBPACK_IMPORTED_MODULE_17__; });\n/* harmony import */ var _brew_game_powers__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./brew_game/powers */ \"./src/brew_game/powers.ts\");\n/* harmony reexport (module object) */ __webpack_require__.d(__webpack_exports__, \"Powers\", function() { return _brew_game_powers__WEBPACK_IMPORTED_MODULE_18__; });\n/* harmony import */ var _brew_game_animations__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./brew_game/animations */ \"./src/brew_game/animations.ts\");\n/* harmony reexport (module object) */ __webpack_require__.d(__webpack_exports__, \"Animations\", function() { return _brew_game_animations__WEBPACK_IMPORTED_MODULE_19__; });\n/* harmony import */ var _brew_game_combat__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./brew_game/combat */ \"./src/brew_game/combat.ts\");\n/* harmony reexport (module object) */ __webpack_require__.d(__webpack_exports__, \"Combat\", function() { return _brew_game_combat__WEBPACK_IMPORTED_MODULE_20__; });\n/* harmony import */ var _brew_game_movement__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./brew_game/movement */ \"./src/brew_game/movement.ts\");\n/* harmony reexport (module object) */ __webpack_require__.d(__webpack_exports__, \"Movement\", function() { return _brew_game_movement__WEBPACK_IMPORTED_MODULE_21__; });\n/* harmony import */ var _brew_engine_events__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./brew_engine/events */ \"./src/brew_engine/events.ts\");\n/* harmony reexport (module object) */ __webpack_require__.d(__webpack_exports__, \"Events\", function() { return _brew_engine_events__WEBPACK_IMPORTED_MODULE_22__; });\n/* harmony import */ var _brew_game_menus__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./brew_game/menus */ \"./src/brew_game/menus.ts\");\n/* harmony reexport (module object) */ __webpack_require__.d(__webpack_exports__, \"Menus\", function() { return _brew_game_menus__WEBPACK_IMPORTED_MODULE_23__; });\n/* harmony import */ var _brew_game_item_interaction__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ./brew_game/item_interaction */ \"./src/brew_game/item_interaction.ts\");\n/* harmony reexport (module object) */ __webpack_require__.d(__webpack_exports__, \"ItemInteraction\", function() { return _brew_game_item_interaction__WEBPACK_IMPORTED_MODULE_24__; });\n/* harmony import */ var _brew_game_targeting__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ./brew_game/targeting */ \"./src/brew_game/targeting.ts\");\n/* harmony reexport (module object) */ __webpack_require__.d(__webpack_exports__, \"Targeting\", function() { return _brew_game_targeting__WEBPACK_IMPORTED_MODULE_25__; });\n/* harmony import */ var _brew_game_hud_info__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ./brew_game/hud_info */ \"./src/brew_game/hud_info.ts\");\n/* harmony reexport (module object) */ __webpack_require__.d(__webpack_exports__, \"HUD\", function() { return _brew_game_hud_info__WEBPACK_IMPORTED_MODULE_26__; });\n/* harmony import */ var _brew_components_grid__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ./brew_components/grid */ \"./src/brew_components/grid.ts\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"GridOfThings\", function() { return _brew_components_grid__WEBPACK_IMPORTED_MODULE_27__[\"GridOfThings\"]; });\n\n/* harmony import */ var _brew_components_level__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ./brew_components/level */ \"./src/brew_components/level.ts\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"Level\", function() { return _brew_components_level__WEBPACK_IMPORTED_MODULE_28__[\"Level\"]; });\n\n/* harmony import */ var _brew_components_portal__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ./brew_components/portal */ \"./src/brew_components/portal.ts\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"Portal\", function() { return _brew_components_portal__WEBPACK_IMPORTED_MODULE_29__[\"Portal\"]; });\n\n/* harmony import */ var _grid_things_definitions__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! ./grid_things/definitions */ \"./src/grid_things/definitions.ts\");\n/* harmony reexport (module object) */ __webpack_require__.d(__webpack_exports__, \"Definitions\", function() { return _grid_things_definitions__WEBPACK_IMPORTED_MODULE_30__; });\n/* harmony import */ var _grid_things__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! ./grid_things */ \"./src/grid_things/index.ts\");\n/* harmony reexport (module object) */ __webpack_require__.d(__webpack_exports__, \"GridThings\", function() { return _grid_things__WEBPACK_IMPORTED_MODULE_31__; });\n/* harmony import */ var _brew_game_levelgen__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(/*! ./brew_game/levelgen */ \"./src/brew_game/levelgen.ts\");\n/* harmony reexport (module object) */ __webpack_require__.d(__webpack_exports__, \"LevelGenerator\", function() { return _brew_game_levelgen__WEBPACK_IMPORTED_MODULE_32__; });\n/* harmony import */ var _brew_game_display__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(/*! ./brew_game/display */ \"./src/brew_game/display.ts\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"Display\", function() { return _brew_game_display__WEBPACK_IMPORTED_MODULE_33__[\"Display\"]; });\n\n/* harmony import */ var _brew_components_turning__WEBPACK_IMPORTED_MODULE_34__ = __webpack_require__(/*! ./brew_components/turning */ \"./src/brew_components/turning.ts\");\n/* harmony reexport (module object) */ __webpack_require__.d(__webpack_exports__, \"Turning\", function() { return _brew_components_turning__WEBPACK_IMPORTED_MODULE_34__; });\n/* harmony import */ var _brew_game_glossary__WEBPACK_IMPORTED_MODULE_35__ = __webpack_require__(/*! ./brew_game/glossary */ \"./src/brew_game/glossary.ts\");\n/* harmony reexport (module object) */ __webpack_require__.d(__webpack_exports__, \"Glossary\", function() { return _brew_game_glossary__WEBPACK_IMPORTED_MODULE_35__; });\n/* harmony import */ var _ares_parts__WEBPACK_IMPORTED_MODULE_36__ = __webpack_require__(/*! ./ares/parts */ \"./src/ares/parts.ts\");\n/* harmony reexport (module object) */ __webpack_require__.d(__webpack_exports__, \"Parts\", function() { return _ares_parts__WEBPACK_IMPORTED_MODULE_36__; });\n/* harmony import */ var _ares_tank__WEBPACK_IMPORTED_MODULE_37__ = __webpack_require__(/*! ./ares/tank */ \"./src/ares/tank.ts\");\n/* harmony reexport (module object) */ __webpack_require__.d(__webpack_exports__, \"Tank\", function() { return _ares_tank__WEBPACK_IMPORTED_MODULE_37__; });\n/* harmony import */ var _level_generator_rooms__WEBPACK_IMPORTED_MODULE_38__ = __webpack_require__(/*! ./level_generator/rooms */ \"./src/level_generator/rooms.ts\");\n/* harmony reexport (module object) */ __webpack_require__.d(__webpack_exports__, \"Rooms\", function() { return _level_generator_rooms__WEBPACK_IMPORTED_MODULE_38__; });\n\r\n\r\n\r\n\r\n// simpler components - should be pretty basic and self-contained\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// todo: not sure this structure makes sense at all...\r\n\r\n\r\n// todo: breakout power objects from power events I guess\r\n\r\n\r\n// Events\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// grid components\r\n\r\n\r\n\r\n\r\n\r\n\r\n// grid-based things and definitions\r\n\r\n\r\n// build GridThings as its own grouping\r\n// https://stackoverflow.com/a/43198685/904245\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// import * as Warppod from './brew_game/warppod'\r\n// export { Warppod }\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvYnJldy50cz84ZmFmIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQXNEO0FBQ2pDO0FBRXVCO0FBQzVCO0FBR2hCLGlFQUFpRTtBQUNqQjtBQUNoQztBQUVrQztBQUNqQztBQUVtQztBQUNsQztBQUU4QjtBQUNoQztBQUV5RDtBQUNwQztBQUVxQjtBQUNyQztBQUV3QjtBQUM5QjtBQUV3QztBQUNuQztBQUV3QjtBQUM1QjtBQUVvQztBQUNoQztBQUV5QjtBQUM5QjtBQUVxQztBQUM5QjtBQUV3QjtBQUM3QjtBQUcyQjtBQUM1QjtBQUU0QjtBQUM1QjtBQUVoQixzREFBc0Q7QUFDUjtBQUM3QjtBQUVqQix5REFBeUQ7QUFDYjtBQUMzQjtBQUVqQixTQUFTO0FBQzJDO0FBQy9CO0FBRXVCO0FBQzNCO0FBRStCO0FBQzdCO0FBRTJCO0FBQzdCO0FBRXlCO0FBQzFCO0FBRytDO0FBQ3JDO0FBRXdCO0FBQzlCO0FBRXVCO0FBQzdCO0FBRWQsa0JBQWtCO0FBQ21DO0FBQzlCO0FBRXdCO0FBQy9CO0FBRWlDO0FBQ2hDO0FBRWpCLG9DQUFvQztBQUNvQjtBQUNsQztBQUV0Qix1Q0FBdUM7QUFDdkMsOENBQThDO0FBQ0g7QUFDdEI7QUFFaUM7QUFDN0I7QUFFb0I7QUFDM0I7QUFFa0M7QUFDbEM7QUFFbEIsaURBQWlEO0FBQ2pELHFCQUFxQjtBQUUyQjtBQUM3QjtBQUVrQjtBQUNyQjtBQUVtQjtBQUNwQjtBQUVpQztBQUNoQyIsImZpbGUiOiIuL3NyYy9icmV3LnRzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgR2FtZU1hc3RlciB9IGZyb20gJy4vYnJld19lbmdpbmUvZ2FtZV9tYXN0ZXInXHJcbmV4cG9ydCB7IEdhbWVNYXN0ZXIgfVxyXG5cclxuaW1wb3J0ICogYXMgRW51bXMgZnJvbSAnLi9icmV3X2VuZ2luZS9lbnVtcydcclxuZXhwb3J0IHsgRW51bXMgfVxyXG5cclxuXHJcbi8vIHNpbXBsZXIgY29tcG9uZW50cyAtIHNob3VsZCBiZSBwcmV0dHkgYmFzaWMgYW5kIHNlbGYtY29udGFpbmVkXHJcbmltcG9ydCAqIGFzIFV0aWxzIGZyb20gJy4vYnJld19jb21wb25lbnRzL3V0aWxzJ1xyXG5leHBvcnQgeyBVdGlscyB9XHJcblxyXG5pbXBvcnQgKiBhcyBDb25maWcgZnJvbSAnLi9icmV3X2NvbXBvbmVudHMvY29uZmlnJ1xyXG5leHBvcnQgeyBDb25maWcgfVxyXG5cclxuaW1wb3J0ICogYXMgU3ltYm9scyBmcm9tICcuL2JyZXdfY29tcG9uZW50cy9zeW1ib2xzJ1xyXG5leHBvcnQgeyBTeW1ib2xzIH1cclxuXHJcbmltcG9ydCAqIGFzIENvbG9yIGZyb20gJy4vYnJld19jb21wb25lbnRzL2NvbG9yJ1xyXG5leHBvcnQgeyBDb2xvciB9XHJcblxyXG5pbXBvcnQgeyBDb29yZGluYXRlLCBDb29yZGluYXRlQXJlYSB9IGZyb20gJy4vYnJld19jb21wb25lbnRzL2Nvb3JkaW5hdGUnXHJcbmV4cG9ydCB7IENvb3JkaW5hdGUsIENvb3JkaW5hdGVBcmVhIH1cclxuXHJcbmltcG9ydCAqIGFzIERpcmVjdGlvbnMgZnJvbSAnLi9icmV3X2NvbXBvbmVudHMvZGlyZWN0aW9ucydcclxuZXhwb3J0IHsgRGlyZWN0aW9ucyB9XHJcblxyXG5pbXBvcnQgeyBTdGF0IH0gZnJvbSAnLi9icmV3X2NvbXBvbmVudHMvc3RhdCdcclxuZXhwb3J0IHsgU3RhdCB9IFxyXG5cclxuaW1wb3J0IHsgSW52ZW50b3J5IH0gZnJvbSAnLi9icmV3X2NvbXBvbmVudHMvaW52ZW50b3J5J1xyXG5leHBvcnQgeyBJbnZlbnRvcnkgfSBcclxuXHJcbmltcG9ydCAqIGFzIElucHV0IGZyb20gJy4vYnJld19lbmdpbmUvaW5wdXQnXHJcbmV4cG9ydCB7IElucHV0IH1cclxuXHJcbmltcG9ydCAqIGFzIEFyY2hpdGVjdCBmcm9tICcuL2JyZXdfZW5naW5lL2FyY2hpdGVjdCdcclxuZXhwb3J0IHsgQXJjaGl0ZWN0IH1cclxuXHJcbmltcG9ydCAqIGFzIFBhdGggZnJvbSAnLi9icmV3X2VuZ2luZS9wYXRobWFwJ1xyXG5leHBvcnQgeyBQYXRoIH1cclxuXHJcbmltcG9ydCAqIGFzIEZpZWxkT2ZWaWV3IGZyb20gJy4vYnJld19jb21wb25lbnRzL2ZvdidcclxuZXhwb3J0IHsgRmllbGRPZlZpZXcgfVxyXG5cclxuaW1wb3J0ICogYXMgVGltZXJzIGZyb20gJy4vYnJld19lbmdpbmUvdGltZXJzJ1xyXG5leHBvcnQgeyBUaW1lcnMgfVxyXG5cclxuXHJcbmltcG9ydCAqIGFzIEludGVsIGZyb20gJy4vYnJld19lbmdpbmUvaW50ZWwnXHJcbmV4cG9ydCB7IEludGVsIH1cclxuXHJcbmltcG9ydCAqIGFzIERlYnVnIGZyb20gJy4vYnJld19lbmdpbmUvZGVidWcnXHJcbmV4cG9ydCB7IERlYnVnIH1cclxuXHJcbi8vIHRvZG86IG5vdCBzdXJlIHRoaXMgc3RydWN0dXJlIG1ha2VzIHNlbnNlIGF0IGFsbC4uLlxyXG5pbXBvcnQgKiBhcyBLZXlNYXAgZnJvbSAnLi9icmV3X2VuZ2luZS9rZXltYXAnXHJcbmV4cG9ydCB7IEtleU1hcCB9XHJcblxyXG4vLyB0b2RvOiBicmVha291dCBwb3dlciBvYmplY3RzIGZyb20gcG93ZXIgZXZlbnRzIEkgZ3Vlc3NcclxuaW1wb3J0ICogYXMgUG93ZXJzIGZyb20gJy4vYnJld19nYW1lL3Bvd2VycydcclxuZXhwb3J0IHsgUG93ZXJzIH1cclxuXHJcbi8vIEV2ZW50c1xyXG5pbXBvcnQgKiBhcyBBbmltYXRpb25zIGZyb20gJy4vYnJld19nYW1lL2FuaW1hdGlvbnMnIFxyXG5leHBvcnQgeyBBbmltYXRpb25zIH1cclxuXHJcbmltcG9ydCAqIGFzIENvbWJhdCBmcm9tICcuL2JyZXdfZ2FtZS9jb21iYXQnXHJcbmV4cG9ydCB7IENvbWJhdCB9XHJcblxyXG5pbXBvcnQgKiBhcyBNb3ZlbWVudCBmcm9tICcuL2JyZXdfZ2FtZS9tb3ZlbWVudCdcclxuZXhwb3J0IHsgTW92ZW1lbnQgfVxyXG5cclxuaW1wb3J0ICogYXMgRXZlbnRzIGZyb20gJy4vYnJld19lbmdpbmUvZXZlbnRzJ1xyXG5leHBvcnQgeyBFdmVudHMgfVxyXG5cclxuaW1wb3J0ICogYXMgTWVudXMgZnJvbSAnLi9icmV3X2dhbWUvbWVudXMnXHJcbmV4cG9ydCB7IE1lbnVzIH1cclxuXHJcblxyXG5pbXBvcnQgKiBhcyBJdGVtSW50ZXJhY3Rpb24gZnJvbSAnLi9icmV3X2dhbWUvaXRlbV9pbnRlcmFjdGlvbidcclxuZXhwb3J0IHsgSXRlbUludGVyYWN0aW9uIH1cclxuXHJcbmltcG9ydCAqIGFzIFRhcmdldGluZyBmcm9tICcuL2JyZXdfZ2FtZS90YXJnZXRpbmcnXHJcbmV4cG9ydCB7IFRhcmdldGluZyB9XHJcblxyXG5pbXBvcnQgKiBhcyBIVUQgZnJvbSAnLi9icmV3X2dhbWUvaHVkX2luZm8nXHJcbmV4cG9ydCB7IEhVRCB9XHJcblxyXG4vLyBncmlkIGNvbXBvbmVudHNcclxuaW1wb3J0IHsgR3JpZE9mVGhpbmdzIH0gZnJvbSAnLi9icmV3X2NvbXBvbmVudHMvZ3JpZCdcclxuZXhwb3J0IHsgR3JpZE9mVGhpbmdzIH1cclxuXHJcbmltcG9ydCB7IExldmVsIH0gZnJvbSAnLi9icmV3X2NvbXBvbmVudHMvbGV2ZWwnXHJcbmV4cG9ydCB7IExldmVsIH0gXHJcblxyXG5pbXBvcnQgeyBQb3J0YWwgfSBmcm9tICcuL2JyZXdfY29tcG9uZW50cy9wb3J0YWwnXHJcbmV4cG9ydCB7IFBvcnRhbCB9IFxyXG5cclxuLy8gZ3JpZC1iYXNlZCB0aGluZ3MgYW5kIGRlZmluaXRpb25zXHJcbmltcG9ydCAqIGFzIERlZmluaXRpb25zIGZyb20gJy4vZ3JpZF90aGluZ3MvZGVmaW5pdGlvbnMnXHJcbmV4cG9ydCB7IERlZmluaXRpb25zIH1cclxuXHJcbi8vIGJ1aWxkIEdyaWRUaGluZ3MgYXMgaXRzIG93biBncm91cGluZ1xyXG4vLyBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL2EvNDMxOTg2ODUvOTA0MjQ1XHJcbmltcG9ydCAqIGFzIEdyaWRUaGluZ3MgZnJvbSAnLi9ncmlkX3RoaW5ncydcclxuZXhwb3J0IHsgR3JpZFRoaW5ncyB9XHJcblxyXG5pbXBvcnQgKiBhcyBMZXZlbEdlbmVyYXRvciBmcm9tICcuL2JyZXdfZ2FtZS9sZXZlbGdlbidcclxuZXhwb3J0IHsgTGV2ZWxHZW5lcmF0b3IgfVxyXG5cclxuaW1wb3J0IHsgRGlzcGxheSB9IGZyb20gJy4vYnJld19nYW1lL2Rpc3BsYXknXHJcbmV4cG9ydCB7IERpc3BsYXkgfVxyXG5cclxuaW1wb3J0ICogYXMgVHVybmluZyBmcm9tICcuL2JyZXdfY29tcG9uZW50cy90dXJuaW5nJ1xyXG5leHBvcnQgeyBUdXJuaW5nIH1cclxuXHJcbi8vIGltcG9ydCAqIGFzIFdhcnBwb2QgZnJvbSAnLi9icmV3X2dhbWUvd2FycHBvZCdcclxuLy8gZXhwb3J0IHsgV2FycHBvZCB9XHJcblxyXG5pbXBvcnQgKiBhcyBHbG9zc2FyeSBmcm9tICcuL2JyZXdfZ2FtZS9nbG9zc2FyeSdcclxuZXhwb3J0IHsgR2xvc3NhcnkgfVxyXG5cclxuaW1wb3J0ICogYXMgUGFydHMgZnJvbSAnLi9hcmVzL3BhcnRzJ1xyXG5leHBvcnQgeyBQYXJ0cyB9XHJcblxyXG5pbXBvcnQgKiBhcyBUYW5rIGZyb20gJy4vYXJlcy90YW5rJ1xyXG5leHBvcnQgeyBUYW5rIH1cclxuXHJcbmltcG9ydCAqIGFzIFJvb21zIGZyb20gJy4vbGV2ZWxfZ2VuZXJhdG9yL3Jvb21zJ1xyXG5leHBvcnQgeyBSb29tcyB9XHJcbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/brew.ts\n");

/***/ }),

/***/ "./src/brew_components/color.ts":
/*!**************************************!*\
  !*** ./src/brew_components/color.ts ***!
  \**************************************/
/*! exports provided: black, white, blue, orange, green, yellow, red, dark_gray, gray, purple, light_cyan, charcoal, charcoal_complement, violet, indigo, goldenrod, dark_slate_gray, light_slate_gray, dark_red, firebrick, midnight_blue, hero_blue, normal, bg_remote_vision, target_path, target_cursor, target_error, bg_unexplored, bg_memory, memory, damage_flash, power_booster, power_shield, power_cloak, power_phasewalk, power_hack, power_axe, power_warp, color_force, color_stun, color_explosion, color_notes_player, forest_green, primary_shade_0, primary_shade_1, primary_shade_2, primary_shade_3, primary_shade_4, secondary_blue_shade_0, secondary_blue_shade_1, secondary_blue_shade_2, secondary_blue_shade_3, secondary_blue_shade_4, secondary_green_shade_0, secondary_green_shade_1, secondary_green_shade_2, secondary_green_shade_3, secondary_green_shade_4, monster_color */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"black\", function() { return black; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"white\", function() { return white; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"blue\", function() { return blue; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"orange\", function() { return orange; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"green\", function() { return green; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"yellow\", function() { return yellow; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"red\", function() { return red; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"dark_gray\", function() { return dark_gray; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"gray\", function() { return gray; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"purple\", function() { return purple; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"light_cyan\", function() { return light_cyan; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"charcoal\", function() { return charcoal; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"charcoal_complement\", function() { return charcoal_complement; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"violet\", function() { return violet; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"indigo\", function() { return indigo; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"goldenrod\", function() { return goldenrod; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"dark_slate_gray\", function() { return dark_slate_gray; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"light_slate_gray\", function() { return light_slate_gray; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"dark_red\", function() { return dark_red; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"firebrick\", function() { return firebrick; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"midnight_blue\", function() { return midnight_blue; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"hero_blue\", function() { return hero_blue; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"normal\", function() { return normal; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"bg_remote_vision\", function() { return bg_remote_vision; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"target_path\", function() { return target_path; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"target_cursor\", function() { return target_cursor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"target_error\", function() { return target_error; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"bg_unexplored\", function() { return bg_unexplored; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"bg_memory\", function() { return bg_memory; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"memory\", function() { return memory; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"damage_flash\", function() { return damage_flash; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"power_booster\", function() { return power_booster; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"power_shield\", function() { return power_shield; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"power_cloak\", function() { return power_cloak; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"power_phasewalk\", function() { return power_phasewalk; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"power_hack\", function() { return power_hack; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"power_axe\", function() { return power_axe; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"power_warp\", function() { return power_warp; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"color_force\", function() { return color_force; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"color_stun\", function() { return color_stun; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"color_explosion\", function() { return color_explosion; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"color_notes_player\", function() { return color_notes_player; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"forest_green\", function() { return forest_green; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"primary_shade_0\", function() { return primary_shade_0; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"primary_shade_1\", function() { return primary_shade_1; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"primary_shade_2\", function() { return primary_shade_2; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"primary_shade_3\", function() { return primary_shade_3; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"primary_shade_4\", function() { return primary_shade_4; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"secondary_blue_shade_0\", function() { return secondary_blue_shade_0; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"secondary_blue_shade_1\", function() { return secondary_blue_shade_1; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"secondary_blue_shade_2\", function() { return secondary_blue_shade_2; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"secondary_blue_shade_3\", function() { return secondary_blue_shade_3; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"secondary_blue_shade_4\", function() { return secondary_blue_shade_4; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"secondary_green_shade_0\", function() { return secondary_green_shade_0; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"secondary_green_shade_1\", function() { return secondary_green_shade_1; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"secondary_green_shade_2\", function() { return secondary_green_shade_2; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"secondary_green_shade_3\", function() { return secondary_green_shade_3; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"secondary_green_shade_4\", function() { return secondary_green_shade_4; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"monster_color\", function() { return monster_color; });\nlet black = [10, 10, 10];\r\nlet white = [255, 255, 255];\r\nlet blue = [0, 204, 255];\r\nlet orange = [255, 127, 0];\r\nlet green = [0, 204, 0];\r\nlet yellow = [255, 177, 0];\r\nlet red = [204, 0, 0];\r\nlet dark_gray = [64, 64, 64];\r\nlet gray = [102, 102, 102];\r\nlet purple = [138, 43, 226];\r\nlet light_cyan = [224, 255, 255];\r\nlet charcoal = [52, 40, 44];\r\nlet charcoal_complement = [39, 51, 47];\r\nlet violet = [238, 130, 238];\r\nlet indigo = [75, 0, 130];\r\nlet goldenrod = [218, 165, 32];\r\nlet dark_slate_gray = [47, 79, 79];\r\nlet light_slate_gray = [119, 136, 153];\r\nlet dark_red = [139, 0, 0];\r\nlet firebrick = [178, 34, 34];\r\nlet midnight_blue = [25, 25, 112];\r\nlet hero_blue = [0, 207, 255];\r\nlet normal = [150, 150, 150];\r\nlet bg_remote_vision = [51, 102, 153];\r\nlet target_path = yellow;\r\nlet target_cursor = orange;\r\nlet target_error = red;\r\nlet bg_unexplored = charcoal;\r\nlet bg_memory = charcoal_complement;\r\nlet memory = dark_gray;\r\nlet damage_flash = red;\r\nlet power_booster = orange;\r\nlet power_shield = green;\r\nlet power_cloak = yellow;\r\nlet power_phasewalk = violet;\r\nlet power_hack = hero_blue;\r\nlet power_axe = goldenrod;\r\nlet power_warp = firebrick;\r\nlet color_force = orange;\r\nlet color_stun = violet;\r\nlet color_explosion = damage_flash;\r\nlet color_notes_player = white;\r\nlet forest_green = [34, 139, 34];\r\n//#####  Color Palette by Paletton.com\r\n//#####  Palette URL: http://paletton.com/#uid=30x0u0kllllaFw0g0qFqFg0w0aF\r\n// *** Primary color:\r\nlet primary_shade_0 = [170, 111, 57];\r\nlet primary_shade_1 = [255, 211, 170];\r\nlet primary_shade_2 = [212, 157, 106];\r\nlet primary_shade_3 = [128, 72, 21];\r\nlet primary_shade_4 = [85, 41, 0];\r\n// *** Secondary color (1):\r\nlet secondary_blue_shade_0 = [47, 64, 115];\r\nlet secondary_blue_shade_1 = [121, 134, 172];\r\nlet secondary_blue_shade_2 = [80, 96, 143];\r\nlet secondary_blue_shade_3 = [22, 38, 86];\r\nlet secondary_blue_shade_4 = [6, 19, 57];\r\n// *** Secondary color (2):\r\nlet secondary_green_shade_0 = [43, 130, 58];\r\nlet secondary_green_shade_1 = [130, 195, 141];\r\nlet secondary_green_shade_2 = [81, 163, 95];\r\nlet secondary_green_shade_3 = [16, 98, 30];\r\nlet secondary_green_shade_4 = [0, 65, 11];\r\n// #####  Generated by Paletton.com (c) 2002-2014\r\nlet monster_color = [255, 255, 0];\r\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvYnJld19jb21wb25lbnRzL2NvbG9yLnRzPzI5ZjQiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBT08sSUFBSSxLQUFLLEdBQVksQ0FBQyxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsQ0FBQztBQUNqQyxJQUFJLEtBQUssR0FBWSxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxDQUFDO0FBQ3BDLElBQUksSUFBSSxHQUFZLENBQUMsQ0FBQyxFQUFFLEdBQUcsRUFBRSxHQUFHLENBQUM7QUFDakMsSUFBSSxNQUFNLEdBQVksQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQztBQUNuQyxJQUFJLEtBQUssR0FBWSxDQUFDLENBQUMsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO0FBQ2hDLElBQUksTUFBTSxHQUFZLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7QUFDbkMsSUFBSSxHQUFHLEdBQVksQ0FBQyxHQUFHLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQztBQUM5QixJQUFJLFNBQVMsR0FBWSxDQUFDLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxDQUFDO0FBQ3JDLElBQUksSUFBSSxHQUFZLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLENBQUM7QUFDbkMsSUFBSSxNQUFNLEdBQVksQ0FBQyxHQUFHLEVBQUMsRUFBRSxFQUFDLEdBQUcsQ0FBQztBQUNsQyxJQUFJLFVBQVUsR0FBWSxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxDQUFDO0FBQ3pDLElBQUksUUFBUSxHQUFZLENBQUMsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLENBQUM7QUFDcEMsSUFBSSxtQkFBbUIsR0FBWSxDQUFDLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxDQUFDO0FBQy9DLElBQUksTUFB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LEVBQUMsR0FBRyxFQUFFLEVBQUUsQ0FBQztBQUMzQyxJQUFJLHVCQUF1QixHQUFHLENBQUMsR0FBRyxFQUFDLEdBQUcsRUFBQyxHQUFHLENBQUM7QUFDM0MsSUFBSSx1QkFBdUIsR0FBRyxDQUFFLEVBQUUsRUFBQyxHQUFHLEVBQUUsRUFBRSxDQUFDO0FBQzNDLElBQUksdUJBQXVCLEdBQUcsQ0FBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsQ0FBQztBQUMzQyxJQUFJLHVCQUF1QixHQUFHLENBQUcsQ0FBQyxFQUFFLEVBQUUsRUFBRSxFQUFFLENBQUM7QUFFbEQsaURBQWlEO0FBRTFDLElBQUksYUFBYSxHQUFHLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUMiLCJmaWxlIjoiLi9zcmMvYnJld19jb21wb25lbnRzL2NvbG9yLnRzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGludGVyZmFjZSBJQ29sb3IgZXh0ZW5kcyBBcnJheTxudW1iZXI+IHsgXHJcbiAgICAwOiBudW1iZXIsXHJcbiAgICAxOiBudW1iZXIsXHJcbiAgICAyOiBudW1iZXIsXHJcbiAgICBsZW5ndGg6IDNcclxufVxyXG5cclxuZXhwb3J0IGxldCBibGFjayA6IElDb2xvciA9IFsxMCwgMTAsIDEwXVxyXG5leHBvcnQgbGV0IHdoaXRlIDogSUNvbG9yID0gWzI1NSwgMjU1LCAyNTVdXHJcbmV4cG9ydCBsZXQgYmx1ZSA6IElDb2xvciA9IFswLCAyMDQsIDI1NV1cclxuZXhwb3J0IGxldCBvcmFuZ2UgOiBJQ29sb3IgPSBbMjU1LCAxMjcsIDBdXHJcbmV4cG9ydCBsZXQgZ3JlZW4gOiBJQ29sb3IgPSBbMCwgMjA0LCAwXVxyXG5leHBvcnQgbGV0IHllbGxvdyA6IElDb2xvciA9IFsyNTUsIDE3NywgMF1cclxuZXhwb3J0IGxldCByZWQgOiBJQ29sb3IgPSBbMjA0LCAwLCAwXVxyXG5leHBvcnQgbGV0IGRhcmtfZ3JheSA6IElDb2xvciA9IFs2NCwgNjQsIDY0XVxyXG5leHBvcnQgbGV0IGdyYXkgOiBJQ29sb3IgPSBbMTAyLCAxMDIsIDEwMl1cclxuZXhwb3J0IGxldCBwdXJwbGUgOiBJQ29sb3IgPSBbMTM4LDQzLDIyNl1cclxuZXhwb3J0IGxldCBsaWdodF9jeWFuIDogSUNvbG9yID0gWzIyNCwgMjU1LCAyNTVdXHJcbmV4cG9ydCBsZXQgY2hhcmNvYWwgOiBJQ29sb3IgPSBbNTIsIDQwLCA0NF1cclxuZXhwb3J0IGxldCBjaGFyY29hbF9jb21wbGVtZW50IDogSUNvbG9yID0gWzM5LCA1MSwgNDddXHJcbmV4cG9ydCBsZXQgdmlvbGV0IDogSUNvbG9yID0gWzIzOCwgMTMwLCAyMzhdXHJcbmV4cG9ydCBsZXQgaW5kaWdvIDogSUNvbG9yID0gWzc1LCAwLCAxMzBdXHJcbmV4cG9ydCBsZXQgZ29sZGVucm9kIDogSUNvbG9yID0gWzIxOCwgMTY1LCAzMl1cclxuZXhwb3J0IGxldCBkYXJrX3NsYXRlX2dyYXkgOiBJQ29sb3IgPSBbNDcsIDc5LCA3OV1cclxuZXhwb3J0IGxldCBsaWdodF9zbGF0ZV9ncmF5IDogSUNvbG9yID0gWzExOSwgMTM2LCAxNTNdXHJcbmV4cG9ydCBsZXQgZGFya19yZWQgOiBJQ29sb3IgPSBbMTM5LCAwLCAwXVxyXG5leHBvcnQgbGV0IGZpcmVicmljayA6IElDb2xvciA9IFsxNzgsIDM0LCAzNF1cclxuZXhwb3J0IGxldCBtaWRuaWdodF9ibHVlIDogSUNvbG9yID0gWzI1LCAyNSwgMTEyXVxyXG5leHBvcnQgbGV0IGhlcm9fYmx1ZSA6IElDb2xvciA9IFswLCAyMDcsIDI1NV1cclxuXHJcbmV4cG9ydCBsZXQgbm9ybWFsIDogSUNvbG9yID0gWzE1MCwgMTUwLCAxNTBdXHJcbmV4cG9ydCBsZXQgYmdfcmVtb3RlX3Zpc2lvbiA6IElDb2xvciA9IFs1MSwgMTAyLCAxNTNdXHJcblxyXG5leHBvcnQgbGV0IHRhcmdldF9wYXRoID0geWVsbG93XHJcbmV4cG9ydCBsZXQgdGFyZ2V0X2N1cnNvciA9IG9yYW5nZVxyXG5leHBvcnQgbGV0IHRhcmdldF9lcnJvciA9IHJlZFxyXG5leHBvcnQgbGV0IGJnX3VuZXhwbG9yZWQgPSBjaGFyY29hbFxyXG5leHBvcnQgbGV0IGJnX21lbW9yeSA9IGNoYXJjb2FsX2NvbXBsZW1lbnRcclxuZXhwb3J0IGxldCBtZW1vcnkgPSBkYXJrX2dyYXlcclxuZXhwb3J0IGxldCBkYW1hZ2VfZmxhc2ggPSByZWRcclxuZXhwb3J0IGxldCBwb3dlcl9ib29zdGVyID0gb3JhbmdlXHJcbmV4cG9ydCBsZXQgcG93ZXJfc2hpZWxkID0gZ3JlZW5cclxuZXhwb3J0IGxldCBwb3dlcl9jbG9hayAgPSB5ZWxsb3dcclxuZXhwb3J0IGxldCBwb3dlcl9waGFzZXdhbGsgID0gdmlvbGV0XHJcbmV4cG9ydCBsZXQgcG93ZXJfaGFjayA9IGhlcm9fYmx1ZVxyXG5leHBvcnQgbGV0IHBvd2VyX2F4ZSA9IGdvbGRlbnJvZFxyXG5leHBvcnQgbGV0IHBvd2VyX3dhcnAgPSBmaXJlYnJpY2tcclxuXHJcbmV4cG9ydCBsZXQgY29sb3JfZm9yY2UgPSBvcmFuZ2VcclxuZXhwb3J0IGxldCBjb2xvcl9zdHVuID0gdmlvbGV0XHJcbmV4cG9ydCBsZXQgY29sb3JfZXhwbG9zaW9uID0gZGFtYWdlX2ZsYXNoXHJcblxyXG5leHBvcnQgbGV0IGNvbG9yX25vdGVzX3BsYXllciA9IHdoaXRlXHJcblxyXG5leHBvcnQgbGV0IGZvcmVzdF9ncmVlbiA6IElDb2xvciA9IFszNCwgMTM5LCAzNF1cclxuXHJcblxyXG4vLyMjIyMjICBDb2xvciBQYWxldHRlIGJ5IFBhbGV0dG9uLmNvbVxyXG4vLyMjIyMjICBQYWxldHRlIFVSTDogaHR0cDovL3BhbGV0dG9uLmNvbS8jdWlkPTMweDB1MGtsbGxsYUZ3MGcwcUZxRmcwdzBhRlxyXG4vLyAqKiogUHJpbWFyeSBjb2xvcjpcclxuXHJcbmV4cG9ydCBsZXQgcHJpbWFyeV9zaGFkZV8wID0gWzE3MCwxMTEsIDU3XVxyXG5leHBvcnQgbGV0IHByaW1hcnlfc2hhZGVfMSA9IFsyNTUsMjExLDE3MF1cclxuZXhwb3J0IGxldCBwcmltYXJ5X3NoYWRlXzIgPSBbMjEyLDE1NywxMDZdXHJcbmV4cG9ydCBsZXQgcHJpbWFyeV9zaGFkZV8zID0gWzEyOCwgNzIsIDIxXVxyXG5leHBvcnQgbGV0IHByaW1hcnlfc2hhZGVfNCA9IFsgODUsIDQxLCAgMF1cclxuXHJcbi8vICoqKiBTZWNvbmRhcnkgY29sb3IgKDEpOlxyXG5cclxuZXhwb3J0IGxldCBzZWNvbmRhcnlfYmx1ZV9zaGFkZV8wID0gWyA0NywgNjQsMTE1XVxyXG5leHBvcnQgbGV0IHNlY29uZGFyeV9ibHVlX3NoYWRlXzEgPSBbMTIxLDEzNCwxNzJdXHJcbmV4cG9ydCBsZXQgc2Vjb25kYXJ5X2JsdWVfc2hhZGVfMiA9IFsgODAsIDk2LDE0M11cclxuZXhwb3J0IGxldCBzZWNvbmRhcnlfYmx1ZV9zaGFkZV8zID0gWyAyMiwgMzgsIDg2XVxyXG5leHBvcnQgbGV0IHNlY29uZGFyeV9ibHVlX3NoYWRlXzQgPSBbICA2LCAxOSwgNTddXHJcblxyXG4vLyAqKiogU2Vjb25kYXJ5IGNvbG9yICgyKTpcclxuXHJcbmV4cG9ydCBsZXQgc2Vjb25kYXJ5X2dyZWVuX3NoYWRlXzAgPSBbIDQzLDEzMCwgNThdXHJcbmV4cG9ydCBsZXQgc2Vjb25kYXJ5X2dyZWVuX3NoYWRlXzEgPSBbMTMwLDE5NSwxNDFdXHJcbmV4cG9ydCBsZXQgc2Vjb25kYXJ5X2dyZWVuX3NoYWRlXzIgPSBbIDgxLDE2MywgOTVdXHJcbmV4cG9ydCBsZXQgc2Vjb25kYXJ5X2dyZWVuX3NoYWRlXzMgPSBbIDE2LCA5OCwgMzBdXHJcbmV4cG9ydCBsZXQgc2Vjb25kYXJ5X2dyZWVuX3NoYWRlXzQgPSBbICAwLCA2NSwgMTFdXHJcblxyXG4vLyAjIyMjIyAgR2VuZXJhdGVkIGJ5IFBhbGV0dG9uLmNvbSAoYykgMjAwMi0yMDE0XHJcblxyXG5leHBvcnQgbGV0IG1vbnN0ZXJfY29sb3IgPSBbMjU1LCAyNTUsIDBdIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/brew_components/color.ts\n");

/***/ }),

/***/ "./src/brew_components/config.ts":
/*!***************************************!*\
  !*** ./src/brew_components/config.ts ***!
  \***************************************/
/*! exports provided: MAX_GRID_SIZE, screen_width_tiles, screen_height_tiles, font_size, animation_speed, rotjs_topology, ally_hover_range, max_depth, max_powers, max_items, max_health, pack_attack_size, pack_distance, grenade_radius, player_shield_amount, map_width_tiles, map_height_tiles, max_power_charges, max_power_strength, popup_msg_speed, local_sight_range, explosion_damage, turret_damage, machinegun_damage, default_monster_sight_range, default_player_sight_range */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"MAX_GRID_SIZE\", function() { return MAX_GRID_SIZE; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"screen_width_tiles\", function() { return screen_width_tiles; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"screen_height_tiles\", function() { return screen_height_tiles; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"font_size\", function() { return font_size; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"animation_speed\", function() { return animation_speed; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"rotjs_topology\", function() { return rotjs_topology; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ally_hover_range\", function() { return ally_hover_range; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"max_depth\", function() { return max_depth; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"max_powers\", function() { return max_powers; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"max_items\", function() { return max_items; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"max_health\", function() { return max_health; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"pack_attack_size\", function() { return pack_attack_size; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"pack_distance\", function() { return pack_distance; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"grenade_radius\", function() { return grenade_radius; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"player_shield_amount\", function() { return player_shield_amount; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"map_width_tiles\", function() { return map_width_tiles; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"map_height_tiles\", function() { return map_height_tiles; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"max_power_charges\", function() { return max_power_charges; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"max_power_strength\", function() { return max_power_strength; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"popup_msg_speed\", function() { return popup_msg_speed; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"local_sight_range\", function() { return local_sight_range; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"explosion_damage\", function() { return explosion_damage; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"turret_damage\", function() { return turret_damage; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"machinegun_damage\", function() { return machinegun_damage; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default_monster_sight_range\", function() { return default_monster_sight_range; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default_player_sight_range\", function() { return default_player_sight_range; });\n// export let Config : { [name: string]: any } = {\r\n// \tBOSS_MODE: false,\r\n// \tMAX_GRID_SIZE: 1024, // used for converting coordinates to indexes, only change this if either map dimension is ginormous\r\n// \tscreen_width_tiles: 64,\r\n// \tscreen_height_tiles: 32,\r\n// \tfont_size: 12,\r\n// \tanimation_speed: 33,\r\n// \trotjs_topology: 4,\r\n// \tally_hover_range: 3,\r\n// \tmax_depth: 4,\r\n// \tmax_powers: 3,\r\n// \tmax_health: 3,\r\n// \tpack_attack_size: 3,\r\n// \tpack_distance: 4,\r\n// \tgrenade_radius: 5, // todo: move this to the item itself / differentiate by level\r\n// \tplayer_shield_amount: 3, // todo: make this rely on the power rank somehow\r\n// }\r\n// Config.map_width_tiles = Config.screen_width_tiles\r\n// Config.map_height_tiles = Config.screen_height_tiles\r\nlet MAX_GRID_SIZE = 1024; // used for converting coordinates to indexes, only change this if either map dimension is ginormous\r\nlet screen_width_tiles = 60;\r\nlet screen_height_tiles = 30;\r\nlet font_size = 12;\r\nlet animation_speed = 33;\r\nlet rotjs_topology = 4;\r\nlet ally_hover_range = 3;\r\nlet max_depth = 4;\r\nlet max_powers = 3;\r\nlet max_items = 8;\r\nlet max_health = 3;\r\nlet pack_attack_size = 3;\r\nlet pack_distance = 4;\r\nlet grenade_radius = 5; // todo: move this to the item itself / differentiate by level\r\nlet player_shield_amount = 3; // todo: make this rely on the power rank somehow\r\nlet map_width_tiles = screen_width_tiles;\r\nlet map_height_tiles = screen_height_tiles;\r\nlet max_power_charges = 9;\r\nlet max_power_strength = 9;\r\nlet popup_msg_speed = 1500;\r\nlet local_sight_range = 6;\r\nconst explosion_damage = 1;\r\nconst turret_damage = 2;\r\nconst machinegun_damage = 1;\r\nconst default_monster_sight_range = 10;\r\nconst default_player_sight_range = 20;\r\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvYnJld19jb21wb25lbnRzL2NvbmZpZy50cz9hMDk1Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQSxrREFBa0Q7QUFDbEQscUJBQXFCO0FBQ3JCLDZIQUE2SDtBQUM3SCwyQkFBMkI7QUFDM0IsNEJBQTRCO0FBQzVCLGtCQUFrQjtBQUNsQix3QkFBd0I7QUFDeEIsc0JBQXNCO0FBQ3RCLHdCQUF3QjtBQUN4QixpQkFBaUI7QUFDakIsa0JBQWtCO0FBQ2xCLGtCQUFrQjtBQUNsQix3QkFBd0I7QUFDeEIscUJBQXFCO0FBQ3JCLHFGQUFxRjtBQUNyRiw4RUFBOEU7QUFDOUUsSUFBSTtBQUVKLHFEQUFxRDtBQUNyRCx1REFBdUQ7QUFHaEQsSUFBSSxhQUFhLEdBQUcsSUFBSSxFQUFDLG9HQUFvRztBQUM3SCxJQUFJLGtCQUFrQixHQUFHLEVBQUU7QUFDM0IsSUFBSSxtQkFBbUIsR0FBRyxFQUFFO0FBQzVCLElBQUksU0FBUyxHQUFHLEVBQUU7QUFDbEIsSUFBSSxlQUFlLEdBQUcsRUFBRTtBQUN4QixJQUFJLGNBQWMsR0FBRyxDQUFDO0FBQ3RCLElBQUksZ0JBQWdCLEdBQUcsQ0FBQztBQUN4QixJQUFJLFNBQVMsR0FBRyxDQUFDO0FBQ2pCLElBQUksVUFBVSxHQUFHLENBQUM7QUFDbEIsSUFBSSxTQUFTLEdBQUcsQ0FBQztBQUNqQixJQUFJLFVBQVUsR0FBRyxDQUFDO0FBQ2xCLElBQUksZ0JBQWdCLEdBQUcsQ0FBQztBQUN4QixJQUFJLGFBQWEsR0FBRyxDQUFDO0FBQ3JCLElBQUksY0FBYyxHQUFHLENBQUMsRUFBQyw4REFBOEQ7QUFDckYsSUFBSSxvQkFBb0IsR0FBRyxDQUFDLEVBQUMsaURBQWlEO0FBQzlFLElBQUksZUFBZSxHQUFHLGtCQUFrQjtBQUN4QyxJQUFJLGdCQUFnQixHQUFHLG1CQUFtQjtBQUMxQyxJQUFJLGlCQUFpQixHQUFHLENBQUM7QUFDekIsSUFBSSxrQkFBa0IsR0FBRyxDQUFDO0FBQzFCLElBQUksZUFBZSxHQUFHLElBQUk7QUFDMUIsSUFBSSxpQkFBaUIsR0FBRyxDQUFDO0FBRXpCLE1BQU0sZ0JBQWdCLEdBQUcsQ0FBQztBQUMxQixNQUFNLGFBQWEsR0FBRyxDQUFDO0FBQ3ZCLE1BQU0saUJBQWlCLEdBQUcsQ0FBQztBQUUzQixNQUFNLDJCQUEyQixHQUFHLEVBQUU7QUFDdEMsTUFBTSwwQkFBMEIsR0FBRyxFQUFFIiwiZmlsZSI6Ii4vc3JjL2JyZXdfY29tcG9uZW50cy9jb25maWcudHMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBleHBvcnQgbGV0IENvbmZpZyA6IHsgW25hbWU6IHN0cmluZ106IGFueSB9ID0ge1xyXG4vLyBcdEJPU1NfTU9ERTogZmFsc2UsXHJcbi8vIFx0TUFYX0dSSURfU0laRTogMTAyNCwgLy8gdXNlZCBmb3IgY29udmVydGluZyBjb29yZGluYXRlcyB0byBpbmRleGVzLCBvbmx5IGNoYW5nZSB0aGlzIGlmIGVpdGhlciBtYXAgZGltZW5zaW9uIGlzIGdpbm9ybW91c1xyXG4vLyBcdHNjcmVlbl93aWR0aF90aWxlczogNjQsXHJcbi8vIFx0c2NyZWVuX2hlaWdodF90aWxlczogMzIsXHJcbi8vIFx0Zm9udF9zaXplOiAxMixcclxuLy8gXHRhbmltYXRpb25fc3BlZWQ6IDMzLFxyXG4vLyBcdHJvdGpzX3RvcG9sb2d5OiA0LFxyXG4vLyBcdGFsbHlfaG92ZXJfcmFuZ2U6IDMsXHJcbi8vIFx0bWF4X2RlcHRoOiA0LFxyXG4vLyBcdG1heF9wb3dlcnM6IDMsXHJcbi8vIFx0bWF4X2hlYWx0aDogMyxcclxuLy8gXHRwYWNrX2F0dGFja19zaXplOiAzLFxyXG4vLyBcdHBhY2tfZGlzdGFuY2U6IDQsXHJcbi8vIFx0Z3JlbmFkZV9yYWRpdXM6IDUsIC8vIHRvZG86IG1vdmUgdGhpcyB0byB0aGUgaXRlbSBpdHNlbGYgLyBkaWZmZXJlbnRpYXRlIGJ5IGxldmVsXHJcbi8vIFx0cGxheWVyX3NoaWVsZF9hbW91bnQ6IDMsIC8vIHRvZG86IG1ha2UgdGhpcyByZWx5IG9uIHRoZSBwb3dlciByYW5rIHNvbWVob3dcclxuLy8gfVxyXG5cclxuLy8gQ29uZmlnLm1hcF93aWR0aF90aWxlcyA9IENvbmZpZy5zY3JlZW5fd2lkdGhfdGlsZXNcclxuLy8gQ29uZmlnLm1hcF9oZWlnaHRfdGlsZXMgPSBDb25maWcuc2NyZWVuX2hlaWdodF90aWxlc1xyXG5cclxuXHJcbmV4cG9ydCBsZXQgTUFYX0dSSURfU0laRSA9IDEwMjQgLy8gdXNlZCBmb3IgY29udmVydGluZyBjb29yZGluYXRlcyB0byBpbmRleGVzLCBvbmx5IGNoYW5nZSB0aGlzIGlmIGVpdGhlciBtYXAgZGltZW5zaW9uIGlzIGdpbm9ybW91c1xyXG5leHBvcnQgbGV0IHNjcmVlbl93aWR0aF90aWxlcyA9IDYwXHJcbmV4cG9ydCBsZXQgc2NyZWVuX2hlaWdodF90aWxlcyA9IDMwXHJcbmV4cG9ydCBsZXQgZm9udF9zaXplID0gMTJcclxuZXhwb3J0IGxldCBhbmltYXRpb25fc3BlZWQgPSAzM1xyXG5leHBvcnQgbGV0IHJvdGpzX3RvcG9sb2d5ID0gNFxyXG5leHBvcnQgbGV0IGFsbHlfaG92ZXJfcmFuZ2UgPSAzXHJcbmV4cG9ydCBsZXQgbWF4X2RlcHRoID0gNFxyXG5leHBvcnQgbGV0IG1heF9wb3dlcnMgPSAzXHJcbmV4cG9ydCBsZXQgbWF4X2l0ZW1zID0gOFxyXG5leHBvcnQgbGV0IG1heF9oZWFsdGggPSAzXHJcbmV4cG9ydCBsZXQgcGFja19hdHRhY2tfc2l6ZSA9IDNcclxuZXhwb3J0IGxldCBwYWNrX2Rpc3RhbmNlID0gNFxyXG5leHBvcnQgbGV0IGdyZW5hZGVfcmFkaXVzID0gNSAvLyB0b2RvOiBtb3ZlIHRoaXMgdG8gdGhlIGl0ZW0gaXRzZWxmIC8gZGlmZmVyZW50aWF0ZSBieSBsZXZlbFxyXG5leHBvcnQgbGV0IHBsYXllcl9zaGllbGRfYW1vdW50ID0gMyAvLyB0b2RvOiBtYWtlIHRoaXMgcmVseSBvbiB0aGUgcG93ZXIgcmFuayBzb21laG93XHJcbmV4cG9ydCBsZXQgbWFwX3dpZHRoX3RpbGVzID0gc2NyZWVuX3dpZHRoX3RpbGVzXHJcbmV4cG9ydCBsZXQgbWFwX2hlaWdodF90aWxlcyA9IHNjcmVlbl9oZWlnaHRfdGlsZXNcclxuZXhwb3J0IGxldCBtYXhfcG93ZXJfY2hhcmdlcyA9IDlcclxuZXhwb3J0IGxldCBtYXhfcG93ZXJfc3RyZW5ndGggPSA5XHJcbmV4cG9ydCBsZXQgcG9wdXBfbXNnX3NwZWVkID0gMTUwMFxyXG5leHBvcnQgbGV0IGxvY2FsX3NpZ2h0X3JhbmdlID0gNlxyXG5cclxuZXhwb3J0IGNvbnN0IGV4cGxvc2lvbl9kYW1hZ2UgPSAxXHJcbmV4cG9ydCBjb25zdCB0dXJyZXRfZGFtYWdlID0gMlxyXG5leHBvcnQgY29uc3QgbWFjaGluZWd1bl9kYW1hZ2UgPSAxXHJcblxyXG5leHBvcnQgY29uc3QgZGVmYXVsdF9tb25zdGVyX3NpZ2h0X3JhbmdlID0gMTBcclxuZXhwb3J0IGNvbnN0IGRlZmF1bHRfcGxheWVyX3NpZ2h0X3JhbmdlID0gMjBcclxuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/brew_components/config.ts\n");

/***/ }),

/***/ "./src/brew_components/coordinate.ts":
/*!*******************************************!*\
  !*** ./src/brew_components/coordinate.ts ***!
  \*******************************************/
/*! exports provided: Coordinate, CoordinateArea */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Coordinate\", function() { return Coordinate; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"CoordinateArea\", function() { return CoordinateArea; });\n/* harmony import */ var _brew__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../brew */ \"./src/brew.ts\");\n// coordinates & direction constants\r\n\r\nclass Coordinate {\r\n    constructor(xx, yy) {\r\n        this.x = xx;\r\n        this.y = yy;\r\n    }\r\n    toString() {\r\n        return `(${this.x}, ${this.y})`;\r\n    }\r\n    clone() {\r\n        return new Coordinate(this.x, this.y);\r\n    }\r\n    compare(other_xy) {\r\n        return (this.x == other_xy.x) && (this.y == other_xy.y);\r\n    }\r\n    add(other_xy) {\r\n        let xy = new Coordinate(this.x + other_xy.x, this.y + other_xy.y);\r\n        return xy;\r\n    }\r\n    subtract(other_xy) {\r\n        let xy = new Coordinate(this.x - other_xy.x, this.y - other_xy.y);\r\n        return xy;\r\n    }\r\n    multiplyScalar(scalar_amount) {\r\n        let xy = new Coordinate(this.x * scalar_amount, this.y * scalar_amount);\r\n        return xy;\r\n    }\r\n    toUnit() {\r\n        let x_sign = (this.x == 0) ? 0 : (Math.abs(this.x) / this.x);\r\n        let y_sign = (this.y == 0) ? 0 : (Math.abs(this.y) / this.y);\r\n        let xy = new Coordinate(x_sign, y_sign);\r\n        return xy;\r\n    }\r\n    getAdjacent() {\r\n        return [\r\n            this.add(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Directions\"].UP),\r\n            this.add(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Directions\"].DOWN),\r\n            this.add(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Directions\"].LEFT),\r\n            this.add(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Directions\"].RIGHT)\r\n        ];\r\n    }\r\n    getDiagonals() {\r\n        return [\r\n            this.add(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Directions\"].UP_LEFT),\r\n            this.add(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Directions\"].UP_RIGHT),\r\n            this.add(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Directions\"].DOWN_LEFT),\r\n            this.add(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Directions\"].DOWN_RIGHT)\r\n        ];\r\n    }\r\n    getSurrounding() {\r\n        return [\r\n            this.add(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Directions\"].UP),\r\n            this.add(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Directions\"].DOWN),\r\n            this.add(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Directions\"].LEFT),\r\n            this.add(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Directions\"].RIGHT),\r\n            this.add(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Directions\"].DOWN_LEFT),\r\n            this.add(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Directions\"].DOWN_RIGHT),\r\n            this.add(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Directions\"].UP_LEFT),\r\n            this.add(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Directions\"].UP_RIGHT),\r\n        ];\r\n    }\r\n}\r\nclass CoordinateArea {\r\n    constructor(given_xy_list = []) {\r\n        this.list_of_coords = [];\r\n        this.addCoordinates(given_xy_list);\r\n    }\r\n    getCoordinates() {\r\n        return this.list_of_coords;\r\n    }\r\n    addCoordinate(add_xy) {\r\n        // returns true if a new coord, false if already exists in the list\r\n        if (this.hasCoordinate(add_xy)) {\r\n            return false;\r\n        }\r\n        else {\r\n            this.list_of_coords.push(add_xy.clone());\r\n            return true;\r\n        }\r\n    }\r\n    addCoordinates(xy_list) {\r\n        let results = xy_list.map((xy) => {\r\n            return this.addCoordinate(xy);\r\n        });\r\n        return results.every((was_new) => { return was_new; });\r\n    }\r\n    findCoordinate(find_xy) {\r\n        return this.list_of_coords.findIndex((xy) => {\r\n            return xy.compare(find_xy);\r\n        });\r\n    }\r\n    hasCoordinate(has_xy) {\r\n        return this.findCoordinate(has_xy) > -1;\r\n    }\r\n    removeCoordinate(del_xy) {\r\n        let idx = this.findCoordinate(del_xy);\r\n        if (idx > -1) {\r\n            this.list_of_coords.splice(idx, 1);\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    getUnion(other_area) {\r\n        // return elements of A + B\r\n        let combined_area = new CoordinateArea(this.list_of_coords);\r\n        other_area.getCoordinates().forEach((xy) => {\r\n            combined_area.addCoordinate(xy);\r\n        });\r\n        return combined_area;\r\n    }\r\n    getDiff(other_area) {\r\n        // return elements of A not in B\r\n        let diff_area = new CoordinateArea();\r\n        this.getCoordinates().forEach((xy) => {\r\n            if (!(other_area.hasCoordinate(xy))) {\r\n                diff_area.addCoordinate(xy);\r\n            }\r\n        });\r\n        return diff_area;\r\n    }\r\n    getSymmetricDiff(other_area) {\r\n        // return elements of A not in B and B not in A\r\n        let diff_a = this.getDiff(other_area);\r\n        let diff_b = other_area.getDiff(this);\r\n        return diff_a.getUnion(diff_b);\r\n    }\r\n    getCoordinatesExcept(exception_xy_list) {\r\n        let other_area = new CoordinateArea(exception_xy_list);\r\n        return this.getDiff(other_area).getCoordinates();\r\n    }\r\n    filter(filter_fn) {\r\n        return new CoordinateArea(this.list_of_coords.filter(filter_fn));\r\n    }\r\n}\r\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvYnJld19jb21wb25lbnRzL2Nvb3JkaW5hdGUudHM/NTNjYSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFBQTtBQUFBLG9DQUFvQztBQUVMO0FBRXpCO0lBSUYsWUFBYSxFQUFVLEVBQUUsRUFBVTtRQUMvQixJQUFJLENBQUMsQ0FBQyxHQUFHLEVBQUU7UUFDWCxJQUFJLENBQUMsQ0FBQyxHQUFHLEVBQUU7SUFDZixDQUFDO0lBRUQsUUFBUTtRQUNKLE1BQU0sQ0FBQyxJQUFJLElBQUksQ0FBQyxDQUFDLEtBQUssSUFBSSxDQUFDLENBQUMsR0FBRztJQUNuQyxDQUFDO0lBRUQsS0FBSztRQUNELE1BQU0sQ0FBQyxJQUFJLFVBQVUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxFQUFFLElBQUksQ0FBQyxDQUFDLENBQUM7SUFDekMsQ0FBQztJQUVELE9BQU8sQ0FBQyxRQUFvQjtRQUN4QixNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLFFBQVEsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksUUFBUSxDQUFDLENBQUMsQ0FBQztJQUMzRCxDQUFDO0lBRUQsR0FBRyxDQUFFLFFBQW9CO1FBQ3JCLElBQUksRUFBRSxHQUFHLElBQUksVUFBVSxDQUFDLElBQUksQ0FBQyxDQUFDLEdBQUcsUUFBUSxDQUFDLENBQUMsRUFBRSxJQUFJLENBQUMsQ0FBQyxHQUFHLFFBQVEsQ0FBQyxDQUFDLENBQUM7UUFDakUsTUFBTSxDQUFDLEVBQUU7SUFDYixDQUFDO0lBRUQsUUFBUSxDQUFFLFFBQW9CO1FBQzFCLElBQUksRUFBRSxHQUFHLElBQUksVUFBVSxDQUFDLElBQUksQ0FBQyxDQUFDLEdBQUcsUUFBUSxDQUFDLENBQUMsRUFBRSxJQUFJLENBQUMsQ0FBQyxHQUFHLFFBQVEsQ0FBQyxDQUFDLENBQUM7UUFDakUsTUFBTSxDQUFDLEVBQUU7SUFDYixDQUFDO0lBRUQsY0FBYyxDQUFFLGFBQXNC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ZmlsZSI6Ii4vc3JjL2JyZXdfY29tcG9uZW50cy9jb29yZGluYXRlLnRzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy8gY29vcmRpbmF0ZXMgJiBkaXJlY3Rpb24gY29uc3RhbnRzXHJcblxyXG5pbXBvcnQgKiBhcyBCcmV3IGZyb20gXCIuLi9icmV3XCJcclxuXHJcbmV4cG9ydCBjbGFzcyBDb29yZGluYXRlIHtcclxuICAgIHB1YmxpYyB4OiBudW1iZXJcclxuICAgIHB1YmxpYyB5OiBudW1iZXJcclxuICAgIFxyXG4gICAgY29uc3RydWN0b3IgKHh4OiBudW1iZXIsIHl5OiBudW1iZXIpIHtcclxuICAgICAgICB0aGlzLnggPSB4eFxyXG4gICAgICAgIHRoaXMueSA9IHl5XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHRvU3RyaW5nICgpIHtcclxuICAgICAgICByZXR1cm4gYCgke3RoaXMueH0sICR7dGhpcy55fSlgXHJcbiAgICB9XHJcbiAgICBcclxuICAgIGNsb25lICgpIDogQ29vcmRpbmF0ZSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBDb29yZGluYXRlKHRoaXMueCwgdGhpcy55KVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBjb21wYXJlKG90aGVyX3h5OiBDb29yZGluYXRlKSA6IGJvb2xlYW4ge1xyXG4gICAgICAgIHJldHVybiAodGhpcy54ID09IG90aGVyX3h5LngpICYmICh0aGlzLnkgPT0gb3RoZXJfeHkueSlcclxuICAgIH1cclxuICAgIFxyXG4gICAgYWRkIChvdGhlcl94eTogQ29vcmRpbmF0ZSkgOiBDb29yZGluYXRlIHtcclxuICAgICAgICBsZXQgeHkgPSBuZXcgQ29vcmRpbmF0ZSh0aGlzLnggKyBvdGhlcl94eS54LCB0aGlzLnkgKyBvdGhlcl94eS55KVxyXG4gICAgICAgIHJldHVybiB4eVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBzdWJ0cmFjdCAob3RoZXJfeHk6IENvb3JkaW5hdGUpIDogQ29vcmRpbmF0ZSB7XHJcbiAgICAgICAgbGV0IHh5ID0gbmV3IENvb3JkaW5hdGUodGhpcy54IC0gb3RoZXJfeHkueCwgdGhpcy55IC0gb3RoZXJfeHkueSlcclxuICAgICAgICByZXR1cm4geHlcclxuICAgIH1cclxuICAgIFxyXG4gICAgbXVsdGlwbHlTY2FsYXIgKHNjYWxhcl9hbW91bnQgOiBudW1iZXIpIDogQ29vcmRpbmF0ZSB7XHJcbiAgICAgICAgbGV0IHh5ID0gbmV3IENvb3JkaW5hdGUodGhpcy54ICogc2NhbGFyX2Ftb3VudCwgdGhpcy55ICogc2NhbGFyX2Ftb3VudClcclxuICAgICAgICByZXR1cm4geHlcclxuICAgIH1cclxuXHJcbiAgICB0b1VuaXQgKCkgOiBDb29yZGluYXRlIHtcclxuICAgICAgICBsZXQgeF9zaWduIDogbnVtYmVyID0gKHRoaXMueCA9PSAwKSA/IDAgOiAoTWF0aC5hYnModGhpcy54KSAvIHRoaXMueClcclxuICAgICAgICBsZXQgeV9zaWduIDogbnVtYmVyID0gKHRoaXMueSA9PSAwKSA/IDAgOiAoTWF0aC5hYnModGhpcy55KSAvIHRoaXMueSlcclxuICAgICAgICBsZXQgeHkgPSBuZXcgQ29vcmRpbmF0ZSh4X3NpZ24sIHlfc2lnbilcclxuICAgICAgICByZXR1cm4geHlcclxuICAgIH1cclxuICAgIFxyXG4gICAgZ2V0QWRqYWNlbnQoKSA6IEFycmF5PENvb3JkaW5hdGU+IHtcclxuICAgICAgICByZXR1cm4gW1xyXG4gICAgICAgICAgICB0aGlzLmFkZChCcmV3LkRpcmVjdGlvbnMuVVApLFxyXG4gICAgICAgICAgICB0aGlzLmFkZChCcmV3LkRpcmVjdGlvbnMuRE9XTiksXHJcbiAgICAgICAgICAgIHRoaXMuYWRkKEJyZXcuRGlyZWN0aW9ucy5MRUZUKSxcclxuICAgICAgICAgICAgdGhpcy5hZGQoQnJldy5EaXJlY3Rpb25zLlJJR0hUKVxyXG4gICAgICAgIF1cclxuICAgIH1cclxuXHJcbiAgICBnZXREaWFnb25hbHMoKSA6IEFycmF5PENvb3JkaW5hdGU+IHtcclxuICAgICAgICByZXR1cm4gW1xyXG4gICAgICAgICAgICB0aGlzLmFkZChCcmV3LkRpcmVjdGlvbnMuVVBfTEVGVCksXHJcbiAgICAgICAgICAgIHRoaXMuYWRkKEJyZXcuRGlyZWN0aW9ucy5VUF9SSUdIVCksXHJcbiAgICAgICAgICAgIHRoaXMuYWRkKEJyZXcuRGlyZWN0aW9ucy5ET1dOX0xFRlQpLFxyXG4gICAgICAgICAgICB0aGlzLmFkZChCcmV3LkRpcmVjdGlvbnMuRE9XTl9SSUdIVClcclxuICAgICAgICBdXHJcbiAgICB9XHJcblxyXG4gICAgZ2V0U3Vycm91bmRpbmcoKSA6IEFycmF5PENvb3JkaW5hdGU+IHtcclxuICAgICAgICByZXR1cm4gW1xyXG4gICAgICAgICAgICB0aGlzLmFkZChCcmV3LkRpcmVjdGlvbnMuVVApLFxyXG4gICAgICAgICAgICB0aGlzLmFkZChCcmV3LkRpcmVjdGlvbnMuRE9XTiksXHJcbiAgICAgICAgICAgIHRoaXMuYWRkKEJyZXcuRGlyZWN0aW9ucy5MRUZUKSxcclxuICAgICAgICAgICAgdGhpcy5hZGQoQnJldy5EaXJlY3Rpb25zLlJJR0hUKSxcclxuICAgICAgICAgICAgdGhpcy5hZGQoQnJldy5EaXJlY3Rpb25zLkRPV05fTEVGVCksXHJcbiAgICAgICAgICAgIHRoaXMuYWRkKEJyZXcuRGlyZWN0aW9ucy5ET1dOX1JJR0hUKSxcclxuICAgICAgICAgICAgdGhpcy5hZGQoQnJldy5EaXJlY3Rpb25zLlVQX0xFRlQpLFxyXG4gICAgICAgICAgICB0aGlzLmFkZChCcmV3LkRpcmVjdGlvbnMuVVBfUklHSFQpLFxyXG4gICAgICAgIF1cclxuICAgIH1cclxuXHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBDb29yZGluYXRlQXJlYSB7XHJcbiAgICBwcml2YXRlIGxpc3Rfb2ZfY29vcmRzOiBBcnJheTxDb29yZGluYXRlPlxyXG4gICAgY29uc3RydWN0b3IoZ2l2ZW5feHlfbGlzdDogQXJyYXk8Q29vcmRpbmF0ZT4gPSBbXSkge1xyXG4gICAgICAgIHRoaXMubGlzdF9vZl9jb29yZHMgPSBbXVxyXG4gICAgICAgIHRoaXMuYWRkQ29vcmRpbmF0ZXMoZ2l2ZW5feHlfbGlzdClcclxuICAgIH1cclxuXHJcbiAgICBnZXRDb29yZGluYXRlcygpOiBBcnJheTxDb29yZGluYXRlPiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubGlzdF9vZl9jb29yZHNcclxuICAgIH1cclxuXHJcbiAgICBhZGRDb29yZGluYXRlKGFkZF94eTogQ29vcmRpbmF0ZSkgOiBib29sZWFuIHtcclxuICAgICAgICAvLyByZXR1cm5zIHRydWUgaWYgYSBuZXcgY29vcmQsIGZhbHNlIGlmIGFscmVhZHkgZXhpc3RzIGluIHRoZSBsaXN0XHJcbiAgICAgICAgaWYgKHRoaXMuaGFzQ29vcmRpbmF0ZShhZGRfeHkpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMubGlzdF9vZl9jb29yZHMucHVzaChhZGRfeHkuY2xvbmUoKSlcclxuICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgYWRkQ29vcmRpbmF0ZXMoeHlfbGlzdDogQXJyYXk8Q29vcmRpbmF0ZT4pIDogYm9vbGVhbiB7XHJcbiAgICAgICAgbGV0IHJlc3VsdHMgPSB4eV9saXN0Lm1hcCgoeHkpIDogYm9vbGVhbiA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmFkZENvb3JkaW5hdGUoeHkpXHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdHMuZXZlcnkoKHdhc19uZXcpIDogYm9vbGVhbiA9PiB7IHJldHVybiB3YXNfbmV3IH0pXHJcbiAgICB9XHJcblxyXG4gICAgZmluZENvb3JkaW5hdGUoZmluZF94eTogQ29vcmRpbmF0ZSk6IG51bWJlciB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubGlzdF9vZl9jb29yZHMuZmluZEluZGV4KCh4eSkgOiBib29sZWFuID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuIHh5LmNvbXBhcmUoZmluZF94eSlcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIGhhc0Nvb3JkaW5hdGUoaGFzX3h5OiBDb29yZGluYXRlKSA6IGJvb2xlYW4ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmZpbmRDb29yZGluYXRlKGhhc194eSkgPiAtMVxyXG4gICAgfVxyXG5cclxuICAgIHJlbW92ZUNvb3JkaW5hdGUoZGVsX3h5OiBDb29yZGluYXRlKSA6IGJvb2xlYW4ge1xyXG4gICAgICAgIGxldCBpZHggPSB0aGlzLmZpbmRDb29yZGluYXRlKGRlbF94eSlcclxuICAgICAgICBpZiAoaWR4ID4gLTEpIHtcclxuICAgICAgICAgICAgdGhpcy5saXN0X29mX2Nvb3Jkcy5zcGxpY2UoaWR4LCAxKVxyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBnZXRVbmlvbihvdGhlcl9hcmVhOiBDb29yZGluYXRlQXJlYSkgOiBDb29yZGluYXRlQXJlYSB7XHJcbiAgICAgICAgLy8gcmV0dXJuIGVsZW1lbnRzIG9mIEEgKyBCXHJcbiAgICAgICAgbGV0IGNvbWJpbmVkX2FyZWEgPSBuZXcgQ29vcmRpbmF0ZUFyZWEodGhpcy5saXN0X29mX2Nvb3JkcylcclxuICAgICAgICBvdGhlcl9hcmVhLmdldENvb3JkaW5hdGVzKCkuZm9yRWFjaCgoeHkpID0+IHtcclxuICAgICAgICAgICAgY29tYmluZWRfYXJlYS5hZGRDb29yZGluYXRlKHh5KVxyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIHJldHVybiBjb21iaW5lZF9hcmVhXHJcbiAgICB9XHJcblxyXG4gICAgZ2V0RGlmZihvdGhlcl9hcmVhOiBDb29yZGluYXRlQXJlYSkgOiBDb29yZGluYXRlQXJlYSB7XHJcbiAgICAgICAgLy8gcmV0dXJuIGVsZW1lbnRzIG9mIEEgbm90IGluIEJcclxuICAgICAgICBsZXQgZGlmZl9hcmVhID0gbmV3IENvb3JkaW5hdGVBcmVhKClcclxuICAgICAgICB0aGlzLmdldENvb3JkaW5hdGVzKCkuZm9yRWFjaCgoeHkpID0+IHtcclxuICAgICAgICAgICAgaWYgKCEob3RoZXJfYXJlYS5oYXNDb29yZGluYXRlKHh5KSkpIHtcclxuICAgICAgICAgICAgICAgIGRpZmZfYXJlYS5hZGRDb29yZGluYXRlKHh5KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgICAgICByZXR1cm4gZGlmZl9hcmVhXHJcbiAgICB9XHJcblxyXG4gICAgZ2V0U3ltbWV0cmljRGlmZihvdGhlcl9hcmVhOiBDb29yZGluYXRlQXJlYSkgOiBDb29yZGluYXRlQXJlYSB7XHJcbiAgICAgICAgLy8gcmV0dXJuIGVsZW1lbnRzIG9mIEEgbm90IGluIEIgYW5kIEIgbm90IGluIEFcclxuICAgICAgICBcclxuICAgICAgICBsZXQgZGlmZl9hID0gdGhpcy5nZXREaWZmKG90aGVyX2FyZWEpXHJcbiAgICAgICAgbGV0IGRpZmZfYiA9IG90aGVyX2FyZWEuZ2V0RGlmZih0aGlzKVxyXG4gICAgICAgIHJldHVybiBkaWZmX2EuZ2V0VW5pb24oZGlmZl9iKVxyXG4gICAgfVxyXG5cclxuICAgIGdldENvb3JkaW5hdGVzRXhjZXB0KGV4Y2VwdGlvbl94eV9saXN0OiBBcnJheTxDb29yZGluYXRlPikgOiBBcnJheTxDb29yZGluYXRlPiB7XHJcbiAgICAgICAgbGV0IG90aGVyX2FyZWEgPSBuZXcgQ29vcmRpbmF0ZUFyZWEoZXhjZXB0aW9uX3h5X2xpc3QpXHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RGlmZihvdGhlcl9hcmVhKS5nZXRDb29yZGluYXRlcygpXHJcbiAgICB9XHJcblxyXG4gICAgZmlsdGVyKGZpbHRlcl9mbjogSUNvb3JkaW5hdGVBcmVhRmlsdGVyKSA6IENvb3JkaW5hdGVBcmVhIHtcclxuICAgICAgICByZXR1cm4gbmV3IENvb3JkaW5hdGVBcmVhKHRoaXMubGlzdF9vZl9jb29yZHMuZmlsdGVyKGZpbHRlcl9mbikpXHJcbiAgICB9XHJcbn1cclxuXHJcbmludGVyZmFjZSBJQ29vcmRpbmF0ZUFyZWFGaWx0ZXIge1xyXG4gICAgKHh5OiBDb29yZGluYXRlKTogYm9vbGVhblxyXG59Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/brew_components/coordinate.ts\n");

/***/ }),

/***/ "./src/brew_components/directions.ts":
/*!*******************************************!*\
  !*** ./src/brew_components/directions.ts ***!
  \*******************************************/
/*! exports provided: UP, DOWN, LEFT, RIGHT, UP_LEFT, DOWN_LEFT, UP_RIGHT, DOWN_RIGHT */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"UP\", function() { return UP; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DOWN\", function() { return DOWN; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"LEFT\", function() { return LEFT; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"RIGHT\", function() { return RIGHT; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"UP_LEFT\", function() { return UP_LEFT; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DOWN_LEFT\", function() { return DOWN_LEFT; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"UP_RIGHT\", function() { return UP_RIGHT; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DOWN_RIGHT\", function() { return DOWN_RIGHT; });\n/* harmony import */ var _brew__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../brew */ \"./src/brew.ts\");\n\r\nconst UP = new _brew__WEBPACK_IMPORTED_MODULE_0__[\"Coordinate\"](0, -1);\r\nconst DOWN = new _brew__WEBPACK_IMPORTED_MODULE_0__[\"Coordinate\"](0, 1);\r\nconst LEFT = new _brew__WEBPACK_IMPORTED_MODULE_0__[\"Coordinate\"](-1, 0);\r\nconst RIGHT = new _brew__WEBPACK_IMPORTED_MODULE_0__[\"Coordinate\"](1, 0);\r\nconst UP_LEFT = new _brew__WEBPACK_IMPORTED_MODULE_0__[\"Coordinate\"](-1, -1);\r\nconst DOWN_LEFT = new _brew__WEBPACK_IMPORTED_MODULE_0__[\"Coordinate\"](-1, 1);\r\nconst UP_RIGHT = new _brew__WEBPACK_IMPORTED_MODULE_0__[\"Coordinate\"](1, -1);\r\nconst DOWN_RIGHT = new _brew__WEBPACK_IMPORTED_MODULE_0__[\"Coordinate\"](1, 1);\r\n// export const N = Brew.Directions.UP\r\n// export const S = Brew.Directions.DOWN\r\n// export const E = Brew.Directions.RIGHT\r\n// export const W = Brew.Directions.LEFT\r\n// export const NE = Brew.Directions.UP_RIGHT\r\n// export const NW = Brew.Directions.UP_LEFT\r\n// export const SE = Brew.Directions.DOWN_RIGHT\r\n// export const SW = Brew.Directions.DOWN_LEFT\r\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvYnJld19jb21wb25lbnRzL2RpcmVjdGlvbnMudHM/ZWViOCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQStCO0FBRXhCLE1BQU0sRUFBRSxHQUFHLElBQUksZ0RBQWUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7QUFDckMsTUFBTSxJQUFJLEdBQUcsSUFBSSxnREFBZSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUM7QUFDdEMsTUFBTSxJQUFJLEdBQUcsSUFBSSxnREFBZSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQztBQUN2QyxNQUFNLEtBQUssR0FBRyxJQUFJLGdEQUFlLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQztBQUV2QyxNQUFNLE9BQU8sR0FBRyxJQUFJLGdEQUFlLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7QUFDM0MsTUFBTSxTQUFTLEdBQUcsSUFBSSxnREFBZSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQztBQUM1QyxNQUFNLFFBQVEsR0FBRyxJQUFJLGdEQUFlLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO0FBQzNDLE1BQU0sVUFBVSxHQUFHLElBQUksZ0RBQWUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDO0FBQ25ELHNDQUFzQztBQUN0Qyx3Q0FBd0M7QUFDeEMseUNBQXlDO0FBQ3pDLHdDQUF3QztBQUN4Qyw2Q0FBNkM7QUFDN0MsNENBQTRDO0FBQzVDLCtDQUErQztBQUMvQyw4Q0FBOEMiLCJmaWxlIjoiLi9zcmMvYnJld19jb21wb25lbnRzL2RpcmVjdGlvbnMudHMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBCcmV3IGZyb20gXCIuLi9icmV3XCJcclxuXHJcbmV4cG9ydCBjb25zdCBVUCA9IG5ldyBCcmV3LkNvb3JkaW5hdGUoMCwgLTEpXHJcbmV4cG9ydCBjb25zdCBET1dOID0gbmV3IEJyZXcuQ29vcmRpbmF0ZSgwLCAxKVxyXG5leHBvcnQgY29uc3QgTEVGVCA9IG5ldyBCcmV3LkNvb3JkaW5hdGUoLTEsIDApXHJcbmV4cG9ydCBjb25zdCBSSUdIVCA9IG5ldyBCcmV3LkNvb3JkaW5hdGUoMSwgMClcclxuXHJcbmV4cG9ydCBjb25zdCBVUF9MRUZUID0gbmV3IEJyZXcuQ29vcmRpbmF0ZSgtMSwgLTEpXHJcbmV4cG9ydCBjb25zdCBET1dOX0xFRlQgPSBuZXcgQnJldy5Db29yZGluYXRlKC0xLCAxKVxyXG5leHBvcnQgY29uc3QgVVBfUklHSFQgPSBuZXcgQnJldy5Db29yZGluYXRlKDEsIC0xKVxyXG5leHBvcnQgY29uc3QgRE9XTl9SSUdIVCA9IG5ldyBCcmV3LkNvb3JkaW5hdGUoMSwgMSlcclxuLy8gZXhwb3J0IGNvbnN0IE4gPSBCcmV3LkRpcmVjdGlvbnMuVVBcclxuLy8gZXhwb3J0IGNvbnN0IFMgPSBCcmV3LkRpcmVjdGlvbnMuRE9XTlxyXG4vLyBleHBvcnQgY29uc3QgRSA9IEJyZXcuRGlyZWN0aW9ucy5SSUdIVFxyXG4vLyBleHBvcnQgY29uc3QgVyA9IEJyZXcuRGlyZWN0aW9ucy5MRUZUXHJcbi8vIGV4cG9ydCBjb25zdCBORSA9IEJyZXcuRGlyZWN0aW9ucy5VUF9SSUdIVFxyXG4vLyBleHBvcnQgY29uc3QgTlcgPSBCcmV3LkRpcmVjdGlvbnMuVVBfTEVGVFxyXG4vLyBleHBvcnQgY29uc3QgU0UgPSBCcmV3LkRpcmVjdGlvbnMuRE9XTl9SSUdIVFxyXG4vLyBleHBvcnQgY29uc3QgU1cgPSBCcmV3LkRpcmVjdGlvbnMuRE9XTl9MRUZUXHJcbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/brew_components/directions.ts\n");

/***/ }),

/***/ "./src/brew_components/fov.ts":
/*!************************************!*\
  !*** ./src/brew_components/fov.ts ***!
  \************************************/
/*! exports provided: symmetricRecursiveShadowcasting_Directional, symmetricRecursiveShadowcasting */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"symmetricRecursiveShadowcasting_Directional\", function() { return symmetricRecursiveShadowcasting_Directional; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"symmetricRecursiveShadowcasting\", function() { return symmetricRecursiveShadowcasting; });\n/* harmony import */ var _brew__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../brew */ \"./src/brew.ts\");\n\r\n// An array of transforms, each corresponding to one octant.\r\nlet transforms = [\r\n    { xx: 1, xy: 0, yx: 0, yy: 1 },\r\n    { xx: 1, xy: 0, yx: 0, yy: -1 },\r\n    { xx: -1, xy: 0, yx: 0, yy: 1 },\r\n    { xx: -1, xy: 0, yx: 0, yy: -1 },\r\n    { xx: 0, xy: 1, yx: 1, yy: 0 },\r\n    { xx: 0, xy: 1, yx: -1, yy: 0 },\r\n    { xx: 0, xy: -1, yx: 1, yy: 0 },\r\n    { xx: 0, xy: -1, yx: -1, yy: 0 }\r\n];\r\nfunction symmetricRecursiveShadowcasting_Directional(cx, cy, transparent, reveal, facing_dir_xy) {\r\n    let octants = [];\r\n    //  3|1\r\n    // 7 * 5\r\n    // 6 * 4\r\n    //  2|0\r\n    if (facing_dir_xy.compare(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Directions\"].UP)) {\r\n        octants = [3, 1];\r\n    }\r\n    else if (facing_dir_xy.compare(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Directions\"].DOWN)) {\r\n        octants = [2, 0];\r\n    }\r\n    else if (facing_dir_xy.compare(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Directions\"].LEFT)) {\r\n        octants = [7, 6];\r\n    }\r\n    else if (facing_dir_xy.compare(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Directions\"].RIGHT)) {\r\n        octants = [4, 5];\r\n    }\r\n    else {\r\n        // console.warn(\"invalid facing direction\")\r\n        octants = [0, 1, 2, 3, 4, 5, 6, 7];\r\n    }\r\n    symmetricRecursiveShadowcasting(cx, cy, transparent, reveal, octants);\r\n}\r\n/**\r\n * Recursive shadowcasting algorithm.\r\n * This algorithm creates a field of view centered around (x, y).\r\n * Opaque tiles are treated as if they have beveled edges.\r\n * Transparent tiles are visible only if their center is visible, so the\r\n * algorithm is symmetric.\r\n * @param cx - x coordinate of center\r\n * @param cy - y coordinate of center\r\n * @param transparent - function that takes (x, y) as arguments and returns the transparency of that tile\r\n * @param reveal - callback function that reveals the tile at (x, y)\r\n */\r\nfunction symmetricRecursiveShadowcasting(cx, cy, transparent, reveal, octants) {\r\n    if (!(octants)) {\r\n        octants = [0, 1, 2, 3, 4, 5, 6, 7];\r\n    }\r\n    /**\r\n     * Scan one row of one octant.\r\n     * @param y - distance from the row scanned to the center\r\n     * @param start - starting slope\r\n     * @param end - ending slope\r\n     * @param transform - describes the transfrom to apply on x and y; determines the octant\r\n     */\r\n    let scan = (y, start, end, transform) => {\r\n        if (start >= end) {\r\n            return;\r\n        }\r\n        let xmin = Math.round((y - 0.5) * start);\r\n        let xmax = Math.ceil((y + 0.5) * end - 0.5);\r\n        for (let x = xmin; x <= xmax; x++) {\r\n            let realx = cx + transform.xx * x + transform.xy * y;\r\n            let realy = cy + transform.yx * x + transform.yy * y;\r\n            if (transparent(realx, realy)) {\r\n                if (x >= y * start && x <= y * end) {\r\n                    reveal(realx, realy);\r\n                }\r\n            }\r\n            else {\r\n                if (x >= (y - 0.5) * start && x - 0.5 <= y * end) {\r\n                    reveal(realx, realy);\r\n                }\r\n                scan(y + 1, start, (x - 0.5) / y, transform);\r\n                start = (x + 0.5) / y;\r\n                if (start >= end) {\r\n                    return;\r\n                }\r\n            }\r\n        }\r\n        scan(y + 1, start, end, transform);\r\n    };\r\n    reveal(cx, cy);\r\n    // Scan each octant\r\n    for (var i = 0; i < 8; i++) {\r\n        if (octants.indexOf(i) > -1) {\r\n            scan(1, 0, 1, transforms[i]);\r\n        }\r\n    }\r\n}\r\n// }\r\n// window.shadowcast = function(cx, cy, transparent, reveal) {\r\n//     'use strict';\r\n//     /**\r\n//      * Scan one row of one octant.\r\n//      * @param y - distance from the row scanned to the center\r\n//      * @param start - starting slope\r\n//      * @param end - ending slope\r\n//      * @param transform - describes the transfrom to apply on x and y; determines the octant\r\n//      */\r\n//     var scan = function(y, start, end, transform) {\r\n//         if (start >= end) {\r\n//             return;\r\n//         }\r\n//         var xmin = Math.round((y - 0.5) * start);\r\n//         var xmax = Math.ceil((y + 0.5) * end - 0.5);\r\n//         for (var x = xmin; x <= xmax; x++) {\r\n//             var realx = cx + transform.xx * x + transform.xy * y;\r\n//             var realy = cy + transform.yx * x + transform.yy * y;\r\n//             if (transparent(realx, realy)) {\r\n//                 if (x >= y * start && x <= y * end) {\r\n//                     reveal(realx, realy);\r\n//                 }\r\n//             } else {\r\n//                 if (x >= (y - 0.5) * start && x - 0.5 <= y * end) {\r\n//                     reveal(realx, realy);\r\n//                 }\r\n//                 scan(y + 1, start, (x - 0.5) / y, transform);\r\n//                 start = (x + 0.5) / y;\r\n//                 if (start >= end) {\r\n//                     return;\r\n//                 }\r\n//             }\r\n//         }\r\n//         scan(y + 1, start, end, transform);\r\n//     };\r\n//     // An array of transforms, each corresponding to one octant.\r\n//     var transforms = [\r\n//         { xx:  1, xy:  0, yx:  0, yy:  1 },\r\n//         { xx:  1, xy:  0, yx:  0, yy: -1 },\r\n//         { xx: -1, xy:  0, yx:  0, yy:  1 },\r\n//         { xx: -1, xy:  0, yx:  0, yy: -1 },\r\n//         { xx:  0, xy:  1, yx:  1, yy:  0 },\r\n//         { xx:  0, xy:  1, yx: -1, yy:  0 },\r\n//         { xx:  0, xy: -1, yx:  1, yy:  0 },\r\n//         { xx:  0, xy: -1, yx: -1, yy:  0 }\r\n//     ];\r\n//     reveal(cx, cy);\r\n//     // Scan each octant\r\n//     for (var i = 0; i < 8; i++) {\r\n//         scan(1, 0, 1, transforms[i]);\r\n//     }\r\n// };\r\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvYnJld19jb21wb25lbnRzL2Zvdi50cz82YjY2Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBK0I7QUFFL0IsNERBQTREO0FBQzVELElBQUksVUFBVSxHQUFHO0lBQ2IsRUFBRSxFQUFFLEVBQUcsQ0FBQyxFQUFFLEVBQUUsRUFBRyxDQUFDLEVBQUUsRUFBRSxFQUFHLENBQUMsRUFBRSxFQUFFLEVBQUcsQ0FBQyxFQUFFO0lBQ2xDLEVBQUUsRUFBRSxFQUFHLENBQUMsRUFBRSxFQUFFLEVBQUcsQ0FBQyxFQUFFLEVBQUUsRUFBRyxDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUMsQ0FBQyxFQUFFO0lBQ2xDLEVBQUUsRUFBRSxFQUFFLENBQUMsQ0FBQyxFQUFFLEVBQUUsRUFBRyxDQUFDLEVBQUUsRUFBRSxFQUFHLENBQUMsRUFBRSxFQUFFLEVBQUcsQ0FBQyxFQUFFO0lBQ2xDLEVBQUUsRUFBRSxFQUFFLENBQUMsQ0FBQyxFQUFFLEVBQUUsRUFBRyxDQUFDLEVBQUUsRUFBRSxFQUFHLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBQyxDQUFDLEVBQUU7SUFDbEMsRUFBRSxFQUFFLEVBQUcsQ0FBQyxFQUFFLEVBQUUsRUFBRyxDQUFDLEVBQUUsRUFBRSxFQUFHLENBQUMsRUFBRSxFQUFFLEVBQUcsQ0FBQyxFQUFFO0lBQ2xDLEVBQUUsRUFBRSxFQUFHLENBQUMsRUFBRSxFQUFFLEVBQUcsQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDLENBQUMsRUFBRSxFQUFFLEVBQUcsQ0FBQyxFQUFFO0lBQ2xDLEVBQUUsRUFBRSxFQUFHLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBQyxDQUFDLEVBQUUsRUFBRSxFQUFHLENBQUMsRUFBRSxFQUFFLEVBQUcsQ0FBQyxFQUFFO0lBQ2xDLEVBQUUsRUFBRSxFQUFHLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBQyxDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUMsQ0FBQyxFQUFFLEVBQUUsRUFBRyxDQUFD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Q0FBQyxFQUFFLENBQUMsRUFBRSxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDaEMsQ0FBQztJQUNMLENBQUM7QUFDTCxDQUFDO0FBRUQsSUFBSTtBQUNKLDhEQUE4RDtBQUM5RCxvQkFBb0I7QUFDcEIsVUFBVTtBQUNWLHFDQUFxQztBQUNyQyxnRUFBZ0U7QUFDaEUsdUNBQXVDO0FBQ3ZDLG1DQUFtQztBQUNuQywrRkFBK0Y7QUFDL0YsVUFBVTtBQUNWLHNEQUFzRDtBQUN0RCw4QkFBOEI7QUFDOUIsc0JBQXNCO0FBQ3RCLFlBQVk7QUFDWixvREFBb0Q7QUFDcEQsdURBQXVEO0FBQ3ZELCtDQUErQztBQUMvQyxvRUFBb0U7QUFDcEUsb0VBQW9FO0FBQ3BFLCtDQUErQztBQUMvQyx3REFBd0Q7QUFDeEQsNENBQTRDO0FBQzVDLG9CQUFvQjtBQUNwQix1QkFBdUI7QUFDdkIsc0VBQXNFO0FBQ3RFLDRDQUE0QztBQUM1QyxvQkFBb0I7QUFDcEIsZ0VBQWdFO0FBQ2hFLHlDQUF5QztBQUN6QyxzQ0FBc0M7QUFDdEMsOEJBQThCO0FBQzlCLG9CQUFvQjtBQUNwQixnQkFBZ0I7QUFDaEIsWUFBWTtBQUNaLDhDQUE4QztBQUM5QyxTQUFTO0FBQ1QsbUVBQW1FO0FBQ25FLHlCQUF5QjtBQUN6Qiw4Q0FBOEM7QUFDOUMsOENBQThDO0FBQzlDLDhDQUE4QztBQUM5Qyw4Q0FBOEM7QUFDOUMsOENBQThDO0FBQzlDLDhDQUE4QztBQUM5Qyw4Q0FBOEM7QUFDOUMsNkNBQTZDO0FBQzdDLFNBQVM7QUFDVCxzQkFBc0I7QUFDdEIsMEJBQTBCO0FBQzFCLG9DQUFvQztBQUNwQyx3Q0FBd0M7QUFDeEMsUUFBUTtBQUNSLEtBQUsiLCJmaWxlIjoiLi9zcmMvYnJld19jb21wb25lbnRzL2Zvdi50cy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIEJyZXcgZnJvbSBcIi4uL2JyZXdcIlxyXG5cclxuLy8gQW4gYXJyYXkgb2YgdHJhbnNmb3JtcywgZWFjaCBjb3JyZXNwb25kaW5nIHRvIG9uZSBvY3RhbnQuXHJcbmxldCB0cmFuc2Zvcm1zID0gW1xyXG4gICAgeyB4eDogIDEsIHh5OiAgMCwgeXg6ICAwLCB5eTogIDEgfSxcclxuICAgIHsgeHg6ICAxLCB4eTogIDAsIHl4OiAgMCwgeXk6IC0xIH0sXHJcbiAgICB7IHh4OiAtMSwgeHk6ICAwLCB5eDogIDAsIHl5OiAgMSB9LFxyXG4gICAgeyB4eDogLTEsIHh5OiAgMCwgeXg6ICAwLCB5eTogLTEgfSxcclxuICAgIHsgeHg6ICAwLCB4eTogIDEsIHl4OiAgMSwgeXk6ICAwIH0sXHJcbiAgICB7IHh4OiAgMCwgeHk6ICAxLCB5eDogLTEsIHl5OiAgMCB9LFxyXG4gICAgeyB4eDogIDAsIHh5OiAtMSwgeXg6ICAxLCB5eTogIDAgfSxcclxuICAgIHsgeHg6ICAwLCB4eTogLTEsIHl4OiAtMSwgeXk6ICAwIH1cclxuXTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBzeW1tZXRyaWNSZWN1cnNpdmVTaGFkb3djYXN0aW5nX0RpcmVjdGlvbmFsKGN4LCBjeSwgdHJhbnNwYXJlbnQsIHJldmVhbCwgZmFjaW5nX2Rpcl94eTogQnJldy5Db29yZGluYXRlKSB7XHJcbiAgICBsZXQgb2N0YW50cyA6IG51bWJlcltdID0gW11cclxuICAgIC8vICAzfDFcclxuICAgIC8vIDcgKiA1XHJcbiAgICAvLyA2ICogNFxyXG4gICAgLy8gIDJ8MFxyXG4gICAgaWYgKGZhY2luZ19kaXJfeHkuY29tcGFyZShCcmV3LkRpcmVjdGlvbnMuVVApKSB7XHJcbiAgICAgICAgb2N0YW50cyA9IFszLCAxXVxyXG4gICAgfSBlbHNlIGlmIChmYWNpbmdfZGlyX3h5LmNvbXBhcmUoQnJldy5EaXJlY3Rpb25zLkRPV04pKSB7XHJcbiAgICAgICAgb2N0YW50cyA9IFsyLCAwXVxyXG4gICAgfSBlbHNlIGlmIChmYWNpbmdfZGlyX3h5LmNvbXBhcmUoQnJldy5EaXJlY3Rpb25zLkxFRlQpKSB7XHJcbiAgICAgICAgb2N0YW50cyA9IFs3LCA2XVxyXG4gICAgfSBlbHNlIGlmIChmYWNpbmdfZGlyX3h5LmNvbXBhcmUoQnJldy5EaXJlY3Rpb25zLlJJR0hUKSkge1xyXG4gICAgICAgIG9jdGFudHMgPSBbNCwgNV1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy8gY29uc29sZS53YXJuKFwiaW52YWxpZCBmYWNpbmcgZGlyZWN0aW9uXCIpXHJcbiAgICAgICAgb2N0YW50cyA9IFswLCAxLCAyLCAzLCA0LCA1LCA2LCA3XVxyXG4gICAgfVxyXG5cclxuICAgIHN5bW1ldHJpY1JlY3Vyc2l2ZVNoYWRvd2Nhc3RpbmcoY3gsIGN5LCB0cmFuc3BhcmVudCwgcmV2ZWFsLCBvY3RhbnRzKVxyXG59XHJcblxyXG4vKipcclxuICogUmVjdXJzaXZlIHNoYWRvd2Nhc3RpbmcgYWxnb3JpdGhtLlxyXG4gKiBUaGlzIGFsZ29yaXRobSBjcmVhdGVzIGEgZmllbGQgb2YgdmlldyBjZW50ZXJlZCBhcm91bmQgKHgsIHkpLlxyXG4gKiBPcGFxdWUgdGlsZXMgYXJlIHRyZWF0ZWQgYXMgaWYgdGhleSBoYXZlIGJldmVsZWQgZWRnZXMuXHJcbiAqIFRyYW5zcGFyZW50IHRpbGVzIGFyZSB2aXNpYmxlIG9ubHkgaWYgdGhlaXIgY2VudGVyIGlzIHZpc2libGUsIHNvIHRoZVxyXG4gKiBhbGdvcml0aG0gaXMgc3ltbWV0cmljLlxyXG4gKiBAcGFyYW0gY3ggLSB4IGNvb3JkaW5hdGUgb2YgY2VudGVyXHJcbiAqIEBwYXJhbSBjeSAtIHkgY29vcmRpbmF0ZSBvZiBjZW50ZXJcclxuICogQHBhcmFtIHRyYW5zcGFyZW50IC0gZnVuY3Rpb24gdGhhdCB0YWtlcyAoeCwgeSkgYXMgYXJndW1lbnRzIGFuZCByZXR1cm5zIHRoZSB0cmFuc3BhcmVuY3kgb2YgdGhhdCB0aWxlXHJcbiAqIEBwYXJhbSByZXZlYWwgLSBjYWxsYmFjayBmdW5jdGlvbiB0aGF0IHJldmVhbHMgdGhlIHRpbGUgYXQgKHgsIHkpXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gc3ltbWV0cmljUmVjdXJzaXZlU2hhZG93Y2FzdGluZyAgKGN4LCBjeSwgdHJhbnNwYXJlbnQsIHJldmVhbCwgb2N0YW50cz86IG51bWJlcltdKSB7XHJcbiAgICBpZiAoIShvY3RhbnRzKSkge1xyXG4gICAgICAgIG9jdGFudHMgPSBbMCwgMSwgMiwgMywgNCwgNSwgNiwgN11cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFNjYW4gb25lIHJvdyBvZiBvbmUgb2N0YW50LlxyXG4gICAgICogQHBhcmFtIHkgLSBkaXN0YW5jZSBmcm9tIHRoZSByb3cgc2Nhbm5lZCB0byB0aGUgY2VudGVyXHJcbiAgICAgKiBAcGFyYW0gc3RhcnQgLSBzdGFydGluZyBzbG9wZVxyXG4gICAgICogQHBhcmFtIGVuZCAtIGVuZGluZyBzbG9wZVxyXG4gICAgICogQHBhcmFtIHRyYW5zZm9ybSAtIGRlc2NyaWJlcyB0aGUgdHJhbnNmcm9tIHRvIGFwcGx5IG9uIHggYW5kIHk7IGRldGVybWluZXMgdGhlIG9jdGFudFxyXG4gICAgICovXHJcbiAgICBsZXQgc2NhbiA9ICh5OiBudW1iZXIsIHN0YXJ0OiBudW1iZXIsIGVuZDogbnVtYmVyLCB0cmFuc2Zvcm06IGFueSkgPT4ge1xyXG4gICAgICAgIGlmIChzdGFydCA+PSBlbmQpIHtcclxuICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCB4bWluID0gTWF0aC5yb3VuZCgoeSAtIDAuNSkgKiBzdGFydClcclxuICAgICAgICBsZXQgeG1heCA9IE1hdGguY2VpbCgoeSArIDAuNSkgKiBlbmQgLSAwLjUpXHJcbiAgICAgICAgZm9yIChsZXQgeCA9IHhtaW47IHggPD0geG1heDsgeCsrKSB7XHJcbiAgICAgICAgICAgIGxldCByZWFseCA9IGN4ICsgdHJhbnNmb3JtLnh4ICogeCArIHRyYW5zZm9ybS54eSAqIHlcclxuICAgICAgICAgICAgbGV0IHJlYWx5ID0gY3kgKyB0cmFuc2Zvcm0ueXggKiB4ICsgdHJhbnNmb3JtLnl5ICogeVxyXG4gICAgICAgICAgICBpZiAodHJhbnNwYXJlbnQocmVhbHgsIHJlYWx5KSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHggPj0geSAqIHN0YXJ0ICYmIHggPD0geSAqIGVuZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldmVhbChyZWFseCwgcmVhbHkpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoeCA+PSAoeSAtIDAuNSkgKiBzdGFydCAmJiB4IC0gMC41IDw9IHkgKiBlbmQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXZlYWwocmVhbHgsIHJlYWx5KVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgc2Nhbih5ICsgMSwgc3RhcnQsICh4IC0gMC41KSAvIHksIHRyYW5zZm9ybSlcclxuICAgICAgICAgICAgICAgIHN0YXJ0ID0gKHggKyAwLjUpIC8geVxyXG4gICAgICAgICAgICAgICAgaWYgKHN0YXJ0ID49IGVuZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHNjYW4oeSArIDEsIHN0YXJ0LCBlbmQsIHRyYW5zZm9ybSlcclxuICAgIH1cclxuXHJcbiAgICByZXZlYWwoY3gsIGN5KVxyXG4gICAgLy8gU2NhbiBlYWNoIG9jdGFudFxyXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCA4OyBpKyspIHtcclxuICAgICAgICBpZiAob2N0YW50cy5pbmRleE9mKGkpID4gLTEpIHtcclxuICAgICAgICAgICAgc2NhbigxLCAwLCAxLCB0cmFuc2Zvcm1zW2ldKVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cclxuLy8gfVxyXG4vLyB3aW5kb3cuc2hhZG93Y2FzdCA9IGZ1bmN0aW9uKGN4LCBjeSwgdHJhbnNwYXJlbnQsIHJldmVhbCkge1xyXG4vLyAgICAgJ3VzZSBzdHJpY3QnO1xyXG4vLyAgICAgLyoqXHJcbi8vICAgICAgKiBTY2FuIG9uZSByb3cgb2Ygb25lIG9jdGFudC5cclxuLy8gICAgICAqIEBwYXJhbSB5IC0gZGlzdGFuY2UgZnJvbSB0aGUgcm93IHNjYW5uZWQgdG8gdGhlIGNlbnRlclxyXG4vLyAgICAgICogQHBhcmFtIHN0YXJ0IC0gc3RhcnRpbmcgc2xvcGVcclxuLy8gICAgICAqIEBwYXJhbSBlbmQgLSBlbmRpbmcgc2xvcGVcclxuLy8gICAgICAqIEBwYXJhbSB0cmFuc2Zvcm0gLSBkZXNjcmliZXMgdGhlIHRyYW5zZnJvbSB0byBhcHBseSBvbiB4IGFuZCB5OyBkZXRlcm1pbmVzIHRoZSBvY3RhbnRcclxuLy8gICAgICAqL1xyXG4vLyAgICAgdmFyIHNjYW4gPSBmdW5jdGlvbih5LCBzdGFydCwgZW5kLCB0cmFuc2Zvcm0pIHtcclxuLy8gICAgICAgICBpZiAoc3RhcnQgPj0gZW5kKSB7XHJcbi8vICAgICAgICAgICAgIHJldHVybjtcclxuLy8gICAgICAgICB9XHJcbi8vICAgICAgICAgdmFyIHhtaW4gPSBNYXRoLnJvdW5kKCh5IC0gMC41KSAqIHN0YXJ0KTtcclxuLy8gICAgICAgICB2YXIgeG1heCA9IE1hdGguY2VpbCgoeSArIDAuNSkgKiBlbmQgLSAwLjUpO1xyXG4vLyAgICAgICAgIGZvciAodmFyIHggPSB4bWluOyB4IDw9IHhtYXg7IHgrKykge1xyXG4vLyAgICAgICAgICAgICB2YXIgcmVhbHggPSBjeCArIHRyYW5zZm9ybS54eCAqIHggKyB0cmFuc2Zvcm0ueHkgKiB5O1xyXG4vLyAgICAgICAgICAgICB2YXIgcmVhbHkgPSBjeSArIHRyYW5zZm9ybS55eCAqIHggKyB0cmFuc2Zvcm0ueXkgKiB5O1xyXG4vLyAgICAgICAgICAgICBpZiAodHJhbnNwYXJlbnQocmVhbHgsIHJlYWx5KSkge1xyXG4vLyAgICAgICAgICAgICAgICAgaWYgKHggPj0geSAqIHN0YXJ0ICYmIHggPD0geSAqIGVuZCkge1xyXG4vLyAgICAgICAgICAgICAgICAgICAgIHJldmVhbChyZWFseCwgcmVhbHkpO1xyXG4vLyAgICAgICAgICAgICAgICAgfVxyXG4vLyAgICAgICAgICAgICB9IGVsc2Uge1xyXG4vLyAgICAgICAgICAgICAgICAgaWYgKHggPj0gKHkgLSAwLjUpICogc3RhcnQgJiYgeCAtIDAuNSA8PSB5ICogZW5kKSB7XHJcbi8vICAgICAgICAgICAgICAgICAgICAgcmV2ZWFsKHJlYWx4LCByZWFseSk7XHJcbi8vICAgICAgICAgICAgICAgICB9XHJcbi8vICAgICAgICAgICAgICAgICBzY2FuKHkgKyAxLCBzdGFydCwgKHggLSAwLjUpIC8geSwgdHJhbnNmb3JtKTtcclxuLy8gICAgICAgICAgICAgICAgIHN0YXJ0ID0gKHggKyAwLjUpIC8geTtcclxuLy8gICAgICAgICAgICAgICAgIGlmIChzdGFydCA+PSBlbmQpIHtcclxuLy8gICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbi8vICAgICAgICAgICAgICAgICB9XHJcbi8vICAgICAgICAgICAgIH1cclxuLy8gICAgICAgICB9XHJcbi8vICAgICAgICAgc2Nhbih5ICsgMSwgc3RhcnQsIGVuZCwgdHJhbnNmb3JtKTtcclxuLy8gICAgIH07XHJcbi8vICAgICAvLyBBbiBhcnJheSBvZiB0cmFuc2Zvcm1zLCBlYWNoIGNvcnJlc3BvbmRpbmcgdG8gb25lIG9jdGFudC5cclxuLy8gICAgIHZhciB0cmFuc2Zvcm1zID0gW1xyXG4vLyAgICAgICAgIHsgeHg6ICAxLCB4eTogIDAsIHl4OiAgMCwgeXk6ICAxIH0sXHJcbi8vICAgICAgICAgeyB4eDogIDEsIHh5OiAgMCwgeXg6ICAwLCB5eTogLTEgfSxcclxuLy8gICAgICAgICB7IHh4OiAtMSwgeHk6ICAwLCB5eDogIDAsIHl5OiAgMSB9LFxyXG4vLyAgICAgICAgIHsgeHg6IC0xLCB4eTogIDAsIHl4OiAgMCwgeXk6IC0xIH0sXHJcbi8vICAgICAgICAgeyB4eDogIDAsIHh5OiAgMSwgeXg6ICAxLCB5eTogIDAgfSxcclxuLy8gICAgICAgICB7IHh4OiAgMCwgeHk6ICAxLCB5eDogLTEsIHl5OiAgMCB9LFxyXG4vLyAgICAgICAgIHsgeHg6ICAwLCB4eTogLTEsIHl4OiAgMSwgeXk6ICAwIH0sXHJcbi8vICAgICAgICAgeyB4eDogIDAsIHh5OiAtMSwgeXg6IC0xLCB5eTogIDAgfVxyXG4vLyAgICAgXTtcclxuLy8gICAgIHJldmVhbChjeCwgY3kpO1xyXG4vLyAgICAgLy8gU2NhbiBlYWNoIG9jdGFudFxyXG4vLyAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCA4OyBpKyspIHtcclxuLy8gICAgICAgICBzY2FuKDEsIDAsIDEsIHRyYW5zZm9ybXNbaV0pO1xyXG4vLyAgICAgfVxyXG4vLyB9OyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/brew_components/fov.ts\n");

/***/ }),

/***/ "./src/brew_components/grid.ts":
/*!*************************************!*\
  !*** ./src/brew_components/grid.ts ***!
  \*************************************/
/*! exports provided: GridOfThings */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"GridOfThings\", function() { return GridOfThings; });\n/* harmony import */ var _brew__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../brew */ \"./src/brew.ts\");\n\r\nclass GridOfThings {\r\n    constructor() {\r\n        // things: Dict<ThingInterface> = {}\r\n        this.things = {};\r\n    }\r\n    clearAll() {\r\n        this.things = {};\r\n    }\r\n    clone() {\r\n        let new_GoT = new GridOfThings();\r\n        new_GoT.things = Object.assign({}, this.things);\r\n        return new_GoT;\r\n    }\r\n    hasAt(xy) {\r\n        var key = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].xyToKey(xy);\r\n        if (key in this.things) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    getAt(xy) {\r\n        if (this.hasAt(xy)) {\r\n            var key = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].xyToKey(xy);\r\n            return this.things[key];\r\n        }\r\n        else {\r\n            return null;\r\n        }\r\n    }\r\n    // setAt (xy: Brew.Coordinate, something: Thing) : boolean {\r\n    setAt(xy, something) {\r\n        if (this.hasAt(xy)) {\r\n            return false;\r\n        }\r\n        else {\r\n            var key = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].xyToKey(xy);\r\n            this.things[key] = something;\r\n            // if its a Thing, set its location on the object as well \r\n            if (something instanceof _brew__WEBPACK_IMPORTED_MODULE_0__[\"GridThings\"].Thing) {\r\n                something.location = xy;\r\n            }\r\n            // something[\"location\"] = xy\r\n            return true;\r\n        }\r\n    }\r\n    removeAt(xy) {\r\n        // returns true if we removed something, false if not\r\n        if (this.hasAt(xy)) {\r\n            var key = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].xyToKey(xy);\r\n            delete this.things[key];\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    getAllCoordinates() {\r\n        let xy;\r\n        let numberkey;\r\n        let coords = [];\r\n        for (let key in this.things) {\r\n            numberkey = parseInt(key);\r\n            xy = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].keyToXY(numberkey);\r\n            coords.push(xy);\r\n        }\r\n        return coords;\r\n    }\r\n    getAllThings() {\r\n        let values = [];\r\n        for (let key in this.things) {\r\n            values.push(this.things[key]);\r\n        }\r\n        return values;\r\n    }\r\n}\r\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvYnJld19jb21wb25lbnRzL2dyaWQudHM/ZjY5MiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFBK0I7QUFPekI7SUFBTjtRQUVJLG9DQUFvQztRQUNwQyxXQUFNLEdBQXVCLEVBQUU7SUFtRm5DLENBQUM7SUFqRkcsUUFBUTtRQUNKLElBQUksQ0FBQyxNQUFNLEdBQUcsRUFBRTtJQUNwQixDQUFDO0lBRUQsS0FBSztRQUNELElBQUksT0FBTyxHQUFHLElBQUksWUFBWSxFQUFLO1FBQ25DLE9BQU8sQ0FBQyxNQUFNLHFCQUFPLElBQUksQ0FBQyxNQUFNLENBQUM7UUFDakMsTUFBTSxDQUFDLE9BQU87SUFDbEIsQ0FBQztJQUVELEtBQUssQ0FBRSxFQUFtQjtRQUN0QixJQUFJLEdBQUcsR0FBRywyQ0FBVSxDQUFDLE9BQU8sQ0FBQyxFQUFFLENBQUM7UUFFaEMsRUFBRSxDQUFDLENBQUMsR0FBRyxJQUFJLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDO1lBQ3JCLE1BQU0sQ0FBQyxJQUFJO1FBQ2YsQ0FBQztRQUFDLElBQUksQ0FBQyxDQUFDO1lBQ0osTUFBTSxDQUFDLEtBQUs7UUFDaEIsQ0FBQztJQUNMLENBQUM7SUFFRCxLQUFLLENBQUUsRUFBbUI7UUFDdEIsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDakIsSUFBSSxHQUFHLEdBQUcsMkNBQVUsQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDO1lBQ2hDLE1BQU0sQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQztRQUMzQixDQUFDO1FBQUMsSUFBSSxDQUFDLENBQUM7WUFDSixNQUFNLENBQUMsSUFBSTtRQUNmLENBQUM7SUFDTCxDQUFDO0lBRUQsNERBQTREO0lBQzVELEtBQUssQ0FBRSxFQUFtQixFQUFFLFNBQVk7UUFDcEMsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDakIsTUFBTSxDQUFDLEtBQUs7UUFDaEIsQ0FBQztRQUFDLElBQUksQ0FBQyxDQUFDO1lBQ0osSUFBSSxHQUFHLEdBQUcsMkNBQVUsQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDO1lBQ2hDLElBQUksQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLEdBQUcsU0FBUztZQUU1QiwwREFBMEQ7WUFDMUQsRUFBRSxDQUFDLENBQUMsU0FBUyxZQUFZLGdEQUFlLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztnQkFDNUMsU0FBaUIsQ0FBQyxRQUFRLEdBQUcsRUFBRTtZQUNwQyxDQUFDO1lBRUQsNkJBQTZCO1lBRTdCLE1BQU0sQ0FBQyxJQUFJO1FBQ2YsQ0FBQztJQUNMLENBQUM7SUFFRCxRQUFRLENBQUUsRUFBbUI7UUFDekIscURBQXFEO1FBQ3JELEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ2pCLElBQUksR0FBRyxHQUFHLDJDQUFVLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQztZQUNoQyxPQUFPLElBQUksQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDO1lBQ3ZCLE1BQU0sQ0FBQyxJQUFJO1FBQ2YsQ0FBQztRQUFDLElBQUksQ0FBQyxDQUFDO1lBQ0osTUFBTSxDQUFDLEtBQUs7UUFDaEIsQ0FBQztJQUNMLENBQUM7SUFFRCxpQkFBaUI7UUFDYixJQUFJLEVBQW1CO1FBQ3ZCLElBQUksU0FBa0I7UUFDdEIsSUFBSSxNQUFNLEdBQTRCLEVBQUU7UUFFeEMsR0FBRyxDQUFDLENBQUMsSUFBSSxHQUFHLElBQUksSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUM7WUFDMUIsU0FBUyxHQUFHLFFBQVEsQ0FBQyxHQUFHLENBQUM7WUFDekIsRUFBRSxHQUFHLDJDQUFVLENBQUMsT0FBTyxDQUFDLFNBQVMsQ0FBQztZQUNsQyxNQUFNLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQztRQUNuQixDQUFDO1FBRUQsTUFBTSxDQUFDLE1BQU07SUFDakIsQ0FBQztJQUVELFlBQVk7UUFDUixJQUFJLE1BQU0sR0FBYyxFQUFFO1FBQzFCLEdBQUcsQ0FBQyxDQUFDLElBQUksR0FBRyxJQUFJLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDO1lBQzFCLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUNqQyxDQUFDO1FBRUQsTUFBTSxDQUFDLE1BQU07SUFDakIsQ0FBQztDQUNKIiwiZmlsZSI6Ii4vc3JjL2JyZXdfY29tcG9uZW50cy9ncmlkLnRzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgQnJldyBmcm9tIFwiLi4vYnJld1wiXHJcblxyXG5pbnRlcmZhY2UgVGhpbmdJbnRlcmZhY2Uge1xyXG4gICAgbG9jYXRpb246IEJyZXcuQ29vcmRpbmF0ZVxyXG4gICAgY29kZTogc3RyaW5nXHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBHcmlkT2ZUaGluZ3M8VD4ge1xyXG5cclxuICAgIC8vIHRoaW5nczogRGljdDxUaGluZ0ludGVyZmFjZT4gPSB7fVxyXG4gICAgdGhpbmdzOiBCcmV3LlV0aWxzLkRpY3Q8VD4gPSB7fVxyXG4gICAgXHJcbiAgICBjbGVhckFsbCAoKSB7XHJcbiAgICAgICAgdGhpcy50aGluZ3MgPSB7fVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBjbG9uZSgpIDogR3JpZE9mVGhpbmdzPFQ+IHtcclxuICAgICAgICBsZXQgbmV3X0dvVCA9IG5ldyBHcmlkT2ZUaGluZ3M8VD4oKVxyXG4gICAgICAgIG5ld19Hb1QudGhpbmdzID0gey4uLnRoaXMudGhpbmdzfVxyXG4gICAgICAgIHJldHVybiBuZXdfR29UXHJcbiAgICB9XHJcbiAgICBcclxuICAgIGhhc0F0ICh4eTogQnJldy5Db29yZGluYXRlKSA6IGJvb2xlYW4ge1xyXG4gICAgICAgIHZhciBrZXkgPSBCcmV3LlV0aWxzLnh5VG9LZXkoeHkpXHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKGtleSBpbiB0aGlzLnRoaW5ncykge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgIH0gZWxzZSB7IFxyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGdldEF0ICh4eTogQnJldy5Db29yZGluYXRlKSA6IFQge1xyXG4gICAgICAgIGlmICh0aGlzLmhhc0F0KHh5KSkge1xyXG4gICAgICAgICAgICB2YXIga2V5ID0gQnJldy5VdGlscy54eVRvS2V5KHh5KVxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy50aGluZ3Nba2V5XVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBzZXRBdCAoeHk6IEJyZXcuQ29vcmRpbmF0ZSwgc29tZXRoaW5nOiBUaGluZykgOiBib29sZWFuIHtcclxuICAgIHNldEF0ICh4eTogQnJldy5Db29yZGluYXRlLCBzb21ldGhpbmc6IFQpIDogYm9vbGVhbiB7XHJcbiAgICAgICAgaWYgKHRoaXMuaGFzQXQoeHkpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHZhciBrZXkgPSBCcmV3LlV0aWxzLnh5VG9LZXkoeHkpXHJcbiAgICAgICAgICAgIHRoaXMudGhpbmdzW2tleV0gPSBzb21ldGhpbmdcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIGlmIGl0cyBhIFRoaW5nLCBzZXQgaXRzIGxvY2F0aW9uIG9uIHRoZSBvYmplY3QgYXMgd2VsbCBcclxuICAgICAgICAgICAgaWYgKHNvbWV0aGluZyBpbnN0YW5jZW9mIEJyZXcuR3JpZFRoaW5ncy5UaGluZykge1xyXG4gICAgICAgICAgICAgICAgKHNvbWV0aGluZyBhcyBhbnkpLmxvY2F0aW9uID0geHlcclxuICAgICAgICAgICAgfSBcclxuXHJcbiAgICAgICAgICAgIC8vIHNvbWV0aGluZ1tcImxvY2F0aW9uXCJdID0geHlcclxuXHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZW1vdmVBdCAoeHk6IEJyZXcuQ29vcmRpbmF0ZSkgOiBib29sZWFuIHtcclxuICAgICAgICAvLyByZXR1cm5zIHRydWUgaWYgd2UgcmVtb3ZlZCBzb21ldGhpbmcsIGZhbHNlIGlmIG5vdFxyXG4gICAgICAgIGlmICh0aGlzLmhhc0F0KHh5KSkge1xyXG4gICAgICAgICAgICB2YXIga2V5ID0gQnJldy5VdGlscy54eVRvS2V5KHh5KVxyXG4gICAgICAgICAgICBkZWxldGUgdGhpcy50aGluZ3Nba2V5XVxyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgZ2V0QWxsQ29vcmRpbmF0ZXMoKSA6IEFycmF5PEJyZXcuQ29vcmRpbmF0ZT4ge1xyXG4gICAgICAgIGxldCB4eTogQnJldy5Db29yZGluYXRlXHJcbiAgICAgICAgbGV0IG51bWJlcmtleSA6IG51bWJlclxyXG4gICAgICAgIGxldCBjb29yZHMgOiBBcnJheTxCcmV3LkNvb3JkaW5hdGU+ID0gW11cclxuICAgICAgICBcclxuICAgICAgICBmb3IgKGxldCBrZXkgaW4gdGhpcy50aGluZ3MpIHtcclxuICAgICAgICAgICAgbnVtYmVya2V5ID0gcGFyc2VJbnQoa2V5KVxyXG4gICAgICAgICAgICB4eSA9IEJyZXcuVXRpbHMua2V5VG9YWShudW1iZXJrZXkpXHJcbiAgICAgICAgICAgIGNvb3Jkcy5wdXNoKHh5KVxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gY29vcmRzXHJcbiAgICB9XHJcbiAgICBcclxuICAgIGdldEFsbFRoaW5ncygpIDogQXJyYXk8VD4ge1xyXG4gICAgICAgIGxldCB2YWx1ZXMgOiBBcnJheTxUPiA9IFtdXHJcbiAgICAgICAgZm9yIChsZXQga2V5IGluIHRoaXMudGhpbmdzKSB7XHJcbiAgICAgICAgICAgIHZhbHVlcy5wdXNoKHRoaXMudGhpbmdzW2tleV0pXHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiB2YWx1ZXNcclxuICAgIH1cclxufVxyXG5cclxuXHJcbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/brew_components/grid.ts\n");

/***/ }),

/***/ "./src/brew_components/inventory.ts":
/*!******************************************!*\
  !*** ./src/brew_components/inventory.ts ***!
  \******************************************/
/*! exports provided: Inventory */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Inventory\", function() { return Inventory; });\nlet default_inv_keys = ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z'];\r\nclass Inventory {\r\n    // assign_key_fn: () => string\r\n    constructor(max_items, inv_keys = default_inv_keys) {\r\n        this.items = {};\r\n        // this.items = {}\r\n        this.num_items = 0;\r\n        this.max_items = max_items;\r\n        this.inv_keys = inv_keys;\r\n        if (inv_keys.length < max_items) {\r\n            throw new Error(\"Not enough inventory keys given for maximum number of items\");\r\n        }\r\n    }\r\n    hasCapacity() {\r\n        return this.num_items < this.max_items;\r\n    }\r\n    addItem(an_item) {\r\n        // returns false if inv is full\r\n        if (this.num_items == this.max_items) {\r\n            return false;\r\n        }\r\n        let invkey = this.assignInventoryKey(an_item);\r\n        this.items[invkey] = {\r\n            item: an_item,\r\n            num_stacked: 1\r\n        };\r\n        this.num_items += 1;\r\n        return true;\r\n    }\r\n    assignInventoryKey(an_item) {\r\n        for (let key_value of this.inv_keys) {\r\n            // console.log(key_value, (!(key_value in this.items)))\r\n            if (!(key_value in this.items)) {\r\n                return key_value;\r\n            }\r\n        }\r\n        throw new Error(\"Ran out of free inventory keys\");\r\n    }\r\n    getItemByKey(inv_key) {\r\n        if (!(inv_key in this.items)) {\r\n            throw new Error(`No item linked to inventory key: ${inv_key}`);\r\n        }\r\n        return this.items[inv_key].item;\r\n    }\r\n    getInventoryItemByKey(inv_key) {\r\n        if (!(inv_key in this.items)) {\r\n            throw new Error(`No item linked to inventory key: ${inv_key}`);\r\n        }\r\n        return this.items[inv_key];\r\n    }\r\n    removeItemByKey(inv_key) {\r\n        if (!(inv_key in this.items)) {\r\n            throw new Error(`No item linked to inventory key: ${inv_key}`);\r\n        }\r\n        delete this.items[inv_key];\r\n        this.num_items -= 1;\r\n    }\r\n    getItems() {\r\n        let results = [];\r\n        for (let invkey in this.items) {\r\n            results.push(this.items[invkey].item);\r\n        }\r\n        return results;\r\n    }\r\n    getKeys() {\r\n        let results = [];\r\n        for (let invkey in this.items) {\r\n            results.push(invkey);\r\n        }\r\n        return results;\r\n    }\r\n    findKeyForItemOfType(given_type) {\r\n        let found_invkey = null;\r\n        for (let invkey in this.items) {\r\n            let it = this.getItemByKey(invkey);\r\n            if (it.isType(given_type)) {\r\n                found_invkey = invkey;\r\n                break;\r\n            }\r\n        }\r\n        return found_invkey;\r\n    }\r\n}\r\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvYnJld19jb21wb25lbnRzL2ludmVudG9yeS50cz81NjJhIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFXQTtBQUFBLElBQUksZ0JBQWdCLEdBQUcsQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxDQUFDO0FBRW5KO0lBS0YsOEJBQThCO0lBRTlCLFlBQVksU0FBaUIsRUFBRSxXQUFxQixnQkFBZ0I7UUFONUQsVUFBSyxHQUEwQixFQUFFO1FBT3JDLGtCQUFrQjtRQUNsQixJQUFJLENBQUMsU0FBUyxHQUFHLENBQUM7UUFDbEIsSUFBSSxDQUFDLFNBQVMsR0FBRyxTQUFTO1FBQzFCLElBQUksQ0FBQyxRQUFRLEdBQUcsUUFBUTtRQUV4QixFQUFFLENBQUMsQ0FBQyxRQUFRLENBQUMsTUFBTSxHQUFHLFNBQVMsQ0FBQyxDQUFDLENBQUM7WUFDOUIsTUFBTSxJQUFJLEtBQUssQ0FBQyw2REFBNkQsQ0FBQztRQUNsRixDQUFDO0lBQ0wsQ0FBQztJQUVELFdBQVc7UUFDUCxNQUFNLENBQUMsSUFBSSxDQUFDLFNBQVMsR0FBRyxJQUFJLENBQUMsU0FBUztJQUMxQyxDQUFDO0lBRUQsT0FBTyxDQUFDLE9BQTZCO1FBQ2pDLCtCQUErQjtRQUMvQixFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxJQUFJLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDO1lBQ25DLE1BQU0sQ0FBQyxLQUFLO1FBQ2hCLENB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S0FBSztZQUNULENBQUM7UUFDTCxDQUFDO1FBRUQsTUFBTSxDQUFDLFlBQVk7SUFDdkIsQ0FBQztDQUdKIiwiZmlsZSI6Ii4vc3JjL2JyZXdfY29tcG9uZW50cy9pbnZlbnRvcnkudHMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBCcmV3IGZyb20gXCIuLi9icmV3XCJcclxuXHJcbmludGVyZmFjZSBJSW52ZW50b3J5SXRlbUNhdGFsb2cge1xyXG4gICAgW2ludmtleTogc3RyaW5nXTogSUludmVudG9yeUl0ZW1cclxufVxyXG5cclxuaW50ZXJmYWNlIElJbnZlbnRvcnlJdGVtICB7XHJcbiAgICBpdGVtOiBCcmV3LkdyaWRUaGluZ3MuSXRlbVxyXG4gICAgbnVtX3N0YWNrZWQ6IG51bWJlclxyXG59XHJcblxyXG5sZXQgZGVmYXVsdF9pbnZfa2V5cyA9IFsnYScsICdiJywgJ2MnLCAnZCcsICdlJywgJ2YnLCAnZycsICdoJywgJ2knLCAnaicsICdrJywgJ2wnLCAnbScsICduJywgJ28nLCAncCcsICdxJywgJ3InLCAncycsICd0JywgJ3UnLCAndicsICd3JywgJ3gnLCAneScsICd6J11cclxuXHJcbmV4cG9ydCBjbGFzcyBJbnZlbnRvcnkge1xyXG4gICAgcHJpdmF0ZSBpdGVtczogSUludmVudG9yeUl0ZW1DYXRhbG9nID0ge31cclxuICAgIG51bV9pdGVtczogbnVtYmVyXHJcbiAgICBtYXhfaXRlbXM6IG51bWJlclxyXG4gICAgaW52X2tleXM6IHN0cmluZ1tdXHJcbiAgICAvLyBhc3NpZ25fa2V5X2ZuOiAoKSA9PiBzdHJpbmdcclxuICAgICAgICAgICAgXHJcbiAgICBjb25zdHJ1Y3RvcihtYXhfaXRlbXM6IG51bWJlciwgaW52X2tleXM6IHN0cmluZ1tdID0gZGVmYXVsdF9pbnZfa2V5cykge1xyXG4gICAgICAgIC8vIHRoaXMuaXRlbXMgPSB7fVxyXG4gICAgICAgIHRoaXMubnVtX2l0ZW1zID0gMFxyXG4gICAgICAgIHRoaXMubWF4X2l0ZW1zID0gbWF4X2l0ZW1zXHJcbiAgICAgICAgdGhpcy5pbnZfa2V5cyA9IGludl9rZXlzXHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKGludl9rZXlzLmxlbmd0aCA8IG1heF9pdGVtcykge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJOb3QgZW5vdWdoIGludmVudG9yeSBrZXlzIGdpdmVuIGZvciBtYXhpbXVtIG51bWJlciBvZiBpdGVtc1wiKVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgaGFzQ2FwYWNpdHkoKSA6IGJvb2xlYW4ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLm51bV9pdGVtcyA8IHRoaXMubWF4X2l0ZW1zXHJcbiAgICB9XHJcbiAgICBcclxuICAgIGFkZEl0ZW0oYW5faXRlbTogQnJldy5HcmlkVGhpbmdzLkl0ZW0pIDogYm9vbGVhbiB7XHJcbiAgICAgICAgLy8gcmV0dXJucyBmYWxzZSBpZiBpbnYgaXMgZnVsbFxyXG4gICAgICAgIGlmICh0aGlzLm51bV9pdGVtcyA9PSB0aGlzLm1heF9pdGVtcykge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgbGV0IGludmtleSA9IHRoaXMuYXNzaWduSW52ZW50b3J5S2V5KGFuX2l0ZW0pXHJcbiAgICAgICAgdGhpcy5pdGVtc1tpbnZrZXldID0ge1xyXG4gICAgICAgICAgICBpdGVtOiBhbl9pdGVtLFxyXG4gICAgICAgICAgICBudW1fc3RhY2tlZDogMVxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLm51bV9pdGVtcyArPSAxXHJcbiAgICAgICAgcmV0dXJuIHRydWVcclxuICAgIH1cclxuICAgIFxyXG4gICAgYXNzaWduSW52ZW50b3J5S2V5KGFuX2l0ZW06IEJyZXcuR3JpZFRoaW5ncy5JdGVtKSA6IHN0cmluZyB7XHJcbiAgICAgICAgZm9yIChsZXQga2V5X3ZhbHVlIG9mIHRoaXMuaW52X2tleXMpIHtcclxuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coa2V5X3ZhbHVlLCAoIShrZXlfdmFsdWUgaW4gdGhpcy5pdGVtcykpKVxyXG4gICAgICAgICAgICBpZiAoIShrZXlfdmFsdWUgaW4gdGhpcy5pdGVtcykpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBrZXlfdmFsdWVcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJSYW4gb3V0IG9mIGZyZWUgaW52ZW50b3J5IGtleXNcIilcclxuICAgIH1cclxuICAgIFxyXG4gICAgZ2V0SXRlbUJ5S2V5KGludl9rZXk6IHN0cmluZykgOiBCcmV3LkdyaWRUaGluZ3MuSXRlbSB7XHJcbiAgICAgICAgaWYgKCEoaW52X2tleSBpbiB0aGlzLml0ZW1zKSkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYE5vIGl0ZW0gbGlua2VkIHRvIGludmVudG9yeSBrZXk6ICR7aW52X2tleX1gKVxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gdGhpcy5pdGVtc1tpbnZfa2V5XS5pdGVtXHJcbiAgICB9XHJcbiAgICBcclxuICAgIGdldEludmVudG9yeUl0ZW1CeUtleShpbnZfa2V5OiBzdHJpbmcpIDogSUludmVudG9yeUl0ZW0ge1xyXG4gICAgICAgIGlmICghKGludl9rZXkgaW4gdGhpcy5pdGVtcykpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBObyBpdGVtIGxpbmtlZCB0byBpbnZlbnRvcnkga2V5OiAke2ludl9rZXl9YClcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaXRlbXNbaW52X2tleV1cclxuICAgIH1cclxuICAgIFxyXG4gICAgcmVtb3ZlSXRlbUJ5S2V5KGludl9rZXk6IHN0cmluZykgOiB2b2lkIHtcclxuICAgICAgICBpZiAoIShpbnZfa2V5IGluIHRoaXMuaXRlbXMpKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgTm8gaXRlbSBsaW5rZWQgdG8gaW52ZW50b3J5IGtleTogJHtpbnZfa2V5fWApXHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIGRlbGV0ZSB0aGlzLml0ZW1zW2ludl9rZXldXHJcbiAgICAgICAgdGhpcy5udW1faXRlbXMgLT0gMVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBnZXRJdGVtcygpIDogQXJyYXk8QnJldy5HcmlkVGhpbmdzLkl0ZW0+IHtcclxuICAgICAgICBsZXQgcmVzdWx0cyA6IEFycmF5PEJyZXcuR3JpZFRoaW5ncy5JdGVtPiA9IFtdXHJcbiAgICAgICAgXHJcbiAgICAgICAgZm9yIChsZXQgaW52a2V5IGluIHRoaXMuaXRlbXMpIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdHMucHVzaCh0aGlzLml0ZW1zW2ludmtleV0uaXRlbSlcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdHNcclxuICAgIH1cclxuICAgIFxyXG4gICAgZ2V0S2V5cygpIDogQXJyYXk8c3RyaW5nPiB7XHJcbiAgICAgICAgbGV0IHJlc3VsdHMgOiBBcnJheTxzdHJpbmc+ID0gW11cclxuICAgICAgICBcclxuICAgICAgICBmb3IgKGxldCBpbnZrZXkgaW4gdGhpcy5pdGVtcykge1xyXG4gICAgICAgICAgICByZXN1bHRzLnB1c2goaW52a2V5KVxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gcmVzdWx0c1xyXG4gICAgfVxyXG5cclxuICAgIGZpbmRLZXlGb3JJdGVtT2ZUeXBlKGdpdmVuX3R5cGUgOiBCcmV3LkRlZmluaXRpb25zLkl0ZW1UeXBlKSA6IHN0cmluZyB7XHJcbiAgICAgICAgbGV0IGZvdW5kX2ludmtleSA9IG51bGxcclxuICAgICAgICBmb3IgKGxldCBpbnZrZXkgaW4gdGhpcy5pdGVtcykge1xyXG4gICAgICAgICAgICBsZXQgaXQgPSB0aGlzLmdldEl0ZW1CeUtleShpbnZrZXkpXHJcbiAgICAgICAgICAgIGlmIChpdC5pc1R5cGUoZ2l2ZW5fdHlwZSkpIHtcclxuICAgICAgICAgICAgICAgIGZvdW5kX2ludmtleSA9IGludmtleVxyXG4gICAgICAgICAgICAgICAgYnJlYWtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGZvdW5kX2ludmtleVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBcclxufVxyXG5cclxuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/brew_components/inventory.ts\n");

/***/ }),

/***/ "./src/brew_components/level.ts":
/*!**************************************!*\
  !*** ./src/brew_components/level.ts ***!
  \**************************************/
/*! exports provided: Level */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Level\", function() { return Level; });\n/* harmony import */ var _brew__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../brew */ \"./src/brew.ts\");\n\r\nclass Level {\r\n    constructor(width, height, depth) {\r\n        this.isConstructed = false;\r\n        this.id = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].generateID();\r\n        this.width = width;\r\n        this.height = height;\r\n        this.depth = depth || 0;\r\n        this.terrain = new _brew__WEBPACK_IMPORTED_MODULE_0__[\"GridOfThings\"]();\r\n        this.monsters = new _brew__WEBPACK_IMPORTED_MODULE_0__[\"GridOfThings\"]();\r\n        this.items = new _brew__WEBPACK_IMPORTED_MODULE_0__[\"GridOfThings\"]();\r\n        this.features = new _brew__WEBPACK_IMPORTED_MODULE_0__[\"GridOfThings\"]();\r\n        this.above = new _brew__WEBPACK_IMPORTED_MODULE_0__[\"GridOfThings\"]();\r\n        this.portals = new _brew__WEBPACK_IMPORTED_MODULE_0__[\"GridOfThings\"]();\r\n        this.parts = new _brew__WEBPACK_IMPORTED_MODULE_0__[\"GridOfThings\"]();\r\n        this.navigation_tiles = {};\r\n        this.navigation_tiles[_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].LevelNavigationType.Walk] = [];\r\n        this.navigation_tiles[_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].LevelNavigationType.Fly] = [];\r\n    }\r\n    isValid(xy) {\r\n        return (this.isConstructed) && (xy.x >= 0) && (xy.y >= 0) && (xy.x < this.width) && (xy.y < this.height);\r\n    }\r\n    isValid_PointsOnly(xy) {\r\n        return (xy.x >= 0) && (xy.y >= 0) && (xy.x < this.width) && (xy.y < this.height);\r\n    }\r\n    getSafeLocationNear(spot_xy, exclude_location_with_item = false) {\r\n        // returns a safe spot near a given Brew.Coordinate\r\n        // safe = walkable, monster-free, not an exit\r\n        let max_size = 10; // stop after 5 successively bigger squares\r\n        let points;\r\n        for (let size = 1; size < max_size; size++) {\r\n            points = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].getSquarePoints(spot_xy, size);\r\n            for (let xy of points) {\r\n                if (this.isSafe(xy, exclude_location_with_item)) {\r\n                    return xy;\r\n                }\r\n            }\r\n        }\r\n        console.warn(\"unable to find suitable place to exit phasewalk - dumping to potentially dumb random location\");\r\n        let random_xy = this.getSafeLocation();\r\n        return random_xy;\r\n    }\r\n    isSafe(xy, exclude_location_with_item = false) {\r\n        let not_ok;\r\n        not_ok = ((!(this.isValid(xy))) ||\r\n            (this.terrain.getAt(xy).blocks_walking) ||\r\n            (this.monsters.hasAt(xy)) ||\r\n            (this.portals.hasAt(xy)) ||\r\n            (exclude_location_with_item && (this.items.hasAt(xy))) ||\r\n            (xy.compare(this.simple_exit_xy)) ||\r\n            (xy.compare(this.simple_start_xy)));\r\n        return (!(not_ok));\r\n    }\r\n    getSafeLocation() {\r\n        // returns a walkable, monster-free location\r\n        let xy;\r\n        let tries = 0;\r\n        let not_ok;\r\n        while (tries < 50) {\r\n            xy = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].randomOf(this.getWalkableTiles());\r\n            not_ok = ((this.monsters.hasAt(xy)) ||\r\n                (xy.compare(this.simple_exit_xy)) ||\r\n                (xy.compare(this.simple_start_xy)));\r\n            if (!(not_ok)) {\r\n                return xy;\r\n            }\r\n            tries += 1;\r\n        }\r\n        console.error(\"unable to find safe location\");\r\n        return null;\r\n    }\r\n    updateNavigation() {\r\n        let t;\r\n        let xy;\r\n        for (let x = 1; x < (this.width - 1); x++) {\r\n            for (let y = 1; y < (this.height - 1); y++) {\r\n                xy = new _brew__WEBPACK_IMPORTED_MODULE_0__[\"Coordinate\"](x, y);\r\n                t = this.terrain.getAt(xy);\r\n                if (!(t.blocks_walking)) {\r\n                    this.navigation_tiles[_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].LevelNavigationType.Walk].push(xy);\r\n                }\r\n                if (!(t.blocks_flying)) {\r\n                    this.navigation_tiles[_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].LevelNavigationType.Fly].push(xy);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    getWalkableTiles() {\r\n        return this.getNavigableTilesOfType(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].LevelNavigationType.Walk);\r\n    }\r\n    getFlyableTiles() {\r\n        return this.getNavigableTilesOfType(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].LevelNavigationType.Fly);\r\n    }\r\n    getNavigableTilesOfType(navType) {\r\n        return this.navigation_tiles[navType];\r\n    }\r\n}\r\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvYnJld19jb21wb25lbnRzL2xldmVsLnRzP2ZlZmIiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQStCO0FBTXpCO0lBcUJGLFlBQVksS0FBYSxFQUFFLE1BQWMsRUFBRSxLQUFjO1FBRnpELGtCQUFhLEdBQVksS0FBSztRQUcxQixJQUFJLENBQUMsRUFBRSxHQUFHLDJDQUFVLENBQUMsVUFBVSxFQUFFO1FBQ2pDLElBQUksQ0FBQyxLQUFLLEdBQUcsS0FBSztRQUNsQixJQUFJLENBQUMsTUFBTSxHQUFHLE1BQU07UUFDcEIsSUFBSSxDQUFDLEtBQUssR0FBRyxLQUFLLElBQUksQ0FBQztRQUV2QixJQUFJLENBQUMsT0FBTyxHQUFHLElBQUksa0RBQWlCLEVBQTJCO1FBQy9ELElBQUksQ0FBQyxRQUFRLEdBQUcsSUFBSSxrREFBaUIsRUFBMkI7UUFDaEUsSUFBSSxDQUFDLEtBQUssR0FBRyxJQUFJLGtEQUFpQixFQUF3QjtRQUMxRCxJQUFJLENBQUMsUUFBUSxHQUFHLElBQUksa0RBQWlCLEVBQTJCO1FBQ2hFLElBQUksQ0FBQyxLQUFLLEdBQUcsSUFBSSxrREFBaUIsRUFBeUI7UUFDM0QsSUFBSSxDQUFDLE9BQU8sR0FBRyxJQUFJLGtEQUFpQixFQUFlO1FBQ25ELElBQUksQ0FBQyxLQUFLLEdBQUcsSUFBSSxrREFBaUIsRUFBMkI7UUFFN0QsSUFBSSxDQUFDLGdCQUFnQixHQUFHLEVBQUU7UUFDMUIsSUFBSSxDQUFDLGdCQUFnQixDQUFDLDJDQUFVLENBQUMsbUJBQW1CLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRTtRQUMvRCxJQUFJLENBQUMsZ0JBQWdCLENBQUMsMkNBQVUsQ0FBQyxtQkFBbUIsQ0FBQyxHQUFHLENBQUMsR0FBRyxFQUFFO0lBQ2xFLENBQUM7SUFFRCxPQUFPLENBQUUsRUFBbUI7UUFDeEIsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMs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LENBQUMsZ0JBQWdCLENBQUMsMkNBQVUsQ0FBQyxtQkFBbUIsQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDO2dCQUN0RSxDQUFDO1lBQ0wsQ0FBQztRQUNMLENBQUM7SUFDTCxDQUFDO0lBRUQsZ0JBQWdCO1FBQ1osTUFBTSxDQUFDLElBQUksQ0FBQyx1QkFBdUIsQ0FBQywyQ0FBVSxDQUFDLG1CQUFtQixDQUFDLElBQUksQ0FBQztJQUM1RSxDQUFDO0lBRUQsZUFBZTtRQUNYLE1BQU0sQ0FBQyxJQUFJLENBQUMsdUJBQXVCLENBQUMsMkNBQVUsQ0FBQyxtQkFBbUIsQ0FBQyxHQUFHLENBQUM7SUFDM0UsQ0FBQztJQUVELHVCQUF1QixDQUFDLE9BQXdDO1FBQzVELE1BQU0sQ0FBQyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsT0FBTyxDQUFDO0lBQ3pDLENBQUM7Q0FFSiIsImZpbGUiOiIuL3NyYy9icmV3X2NvbXBvbmVudHMvbGV2ZWwudHMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBCcmV3IGZyb20gXCIuLi9icmV3XCJcclxuXHJcbmludGVyZmFjZSBJTmF2aWdhdGlvblRpbGVMaXN0IHtcclxuICAgIFtpZCA6IHN0cmluZ10gOiBBcnJheTxCcmV3LkNvb3JkaW5hdGU+XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBMZXZlbCB7XHJcbiAgICBpZDogbnVtYmVyXHJcbiAgICB3aWR0aDogbnVtYmVyXHJcbiAgICBoZWlnaHQ6IG51bWJlclxyXG4gICAgZGVwdGg6IG51bWJlclxyXG4gICAgc2ltcGxlX3N0YXJ0X3h5OiBCcmV3LkNvb3JkaW5hdGVcclxuICAgIHNpbXBsZV9leGl0X3h5OiBCcmV3LkNvb3JkaW5hdGVcclxuICAgIGZsb29yczogQXJyYXk8QnJldy5Db29yZGluYXRlPlxyXG5cclxuICAgIG5hdmlnYXRpb25fdGlsZXM6IElOYXZpZ2F0aW9uVGlsZUxpc3RcclxuICAgIFxyXG4gICAgbW9uc3RlcnM6IEJyZXcuR3JpZE9mVGhpbmdzPEJyZXcuR3JpZFRoaW5ncy5Nb25zdGVyPlxyXG4gICAgdGVycmFpbjogQnJldy5HcmlkT2ZUaGluZ3M8QnJldy5HcmlkVGhpbmdzLlRlcnJhaW4+XHJcbiAgICBpdGVtczogQnJldy5HcmlkT2ZUaGluZ3M8QnJldy5HcmlkVGhpbmdzLkl0ZW0+XHJcbiAgICBmZWF0dXJlczogQnJldy5HcmlkT2ZUaGluZ3M8QnJldy5HcmlkVGhpbmdzLkZlYXR1cmU+XHJcbiAgICBhYm92ZTogQnJldy5HcmlkT2ZUaGluZ3M8QnJldy5HcmlkVGhpbmdzLkFib3ZlPlxyXG4gICAgcG9ydGFsczogQnJldy5HcmlkT2ZUaGluZ3M8QnJldy5Qb3J0YWw+XHJcbiAgICBwYXJ0czogQnJldy5HcmlkT2ZUaGluZ3M8QnJldy5HcmlkVGhpbmdzLkZlYXR1cmU+XHJcblxyXG4gICAgaXNDb25zdHJ1Y3RlZDogYm9vbGVhbiA9IGZhbHNlXHJcblxyXG4gICAgY29uc3RydWN0b3Iod2lkdGg6IG51bWJlciwgaGVpZ2h0OiBudW1iZXIsIGRlcHRoPzogbnVtYmVyKSB7XHJcbiAgICAgICAgdGhpcy5pZCA9IEJyZXcuVXRpbHMuZ2VuZXJhdGVJRCgpXHJcbiAgICAgICAgdGhpcy53aWR0aCA9IHdpZHRoXHJcbiAgICAgICAgdGhpcy5oZWlnaHQgPSBoZWlnaHRcclxuICAgICAgICB0aGlzLmRlcHRoID0gZGVwdGggfHwgMFxyXG4gICAgICAgIFxyXG4gICAgICAgIHRoaXMudGVycmFpbiA9IG5ldyBCcmV3LkdyaWRPZlRoaW5nczxCcmV3LkdyaWRUaGluZ3MuVGVycmFpbj4oKVxyXG4gICAgICAgIHRoaXMubW9uc3RlcnMgPSBuZXcgQnJldy5HcmlkT2ZUaGluZ3M8QnJldy5HcmlkVGhpbmdzLk1vbnN0ZXI+KClcclxuICAgICAgICB0aGlzLml0ZW1zID0gbmV3IEJyZXcuR3JpZE9mVGhpbmdzPEJyZXcuR3JpZFRoaW5ncy5JdGVtPigpXHJcbiAgICAgICAgdGhpcy5mZWF0dXJlcyA9IG5ldyBCcmV3LkdyaWRPZlRoaW5nczxCcmV3LkdyaWRUaGluZ3MuRmVhdHVyZT4oKVxyXG4gICAgICAgIHRoaXMuYWJvdmUgPSBuZXcgQnJldy5HcmlkT2ZUaGluZ3M8QnJldy5HcmlkVGhpbmdzLkFib3ZlPigpXHJcbiAgICAgICAgdGhpcy5wb3J0YWxzID0gbmV3IEJyZXcuR3JpZE9mVGhpbmdzPEJyZXcuUG9ydGFsPigpXHJcbiAgICAgICAgdGhpcy5wYXJ0cyA9IG5ldyBCcmV3LkdyaWRPZlRoaW5nczxCcmV3LkdyaWRUaGluZ3MuRmVhdHVyZT4oKVxyXG5cclxuICAgICAgICB0aGlzLm5hdmlnYXRpb25fdGlsZXMgPSB7fVxyXG4gICAgICAgIHRoaXMubmF2aWdhdGlvbl90aWxlc1tCcmV3LkVudW1zLkxldmVsTmF2aWdhdGlvblR5cGUuV2Fsa10gPSBbXVxyXG4gICAgICAgIHRoaXMubmF2aWdhdGlvbl90aWxlc1tCcmV3LkVudW1zLkxldmVsTmF2aWdhdGlvblR5cGUuRmx5XSA9IFtdXHJcbiAgICB9XHJcbiAgICBcclxuICAgIGlzVmFsaWQgKHh5OiBCcmV3LkNvb3JkaW5hdGUpIDogYm9vbGVhbiB7XHJcbiAgICAgICAgcmV0dXJuICh0aGlzLmlzQ29uc3RydWN0ZWQpICYmICh4eS54ID49IDApICYmICh4eS55ID49IDApICYmICh4eS54IDwgdGhpcy53aWR0aCkgJiYgKHh5LnkgPCB0aGlzLmhlaWdodCkgXHJcbiAgICB9XHJcblxyXG4gICAgaXNWYWxpZF9Qb2ludHNPbmx5ICh4eTogQnJldy5Db29yZGluYXRlKSA6IGJvb2xlYW4ge1xyXG4gICAgICAgIHJldHVybiAoeHkueCA+PSAwKSAmJiAoeHkueSA+PSAwKSAmJiAoeHkueCA8IHRoaXMud2lkdGgpICYmICh4eS55IDwgdGhpcy5oZWlnaHQpIFxyXG4gICAgfVxyXG5cclxuICAgIGdldFNhZmVMb2NhdGlvbk5lYXIgKHNwb3RfeHkgOiBCcmV3LkNvb3JkaW5hdGUsIGV4Y2x1ZGVfbG9jYXRpb25fd2l0aF9pdGVtIDogYm9vbGVhbiA9IGZhbHNlKTogQnJldy5Db29yZGluYXRlIHtcclxuICAgICAgICAvLyByZXR1cm5zIGEgc2FmZSBzcG90IG5lYXIgYSBnaXZlbiBCcmV3LkNvb3JkaW5hdGVcclxuICAgICAgICAvLyBzYWZlID0gd2Fsa2FibGUsIG1vbnN0ZXItZnJlZSwgbm90IGFuIGV4aXRcclxuICAgICAgICBcclxuICAgICAgICBsZXQgbWF4X3NpemUgPSAxMCAvLyBzdG9wIGFmdGVyIDUgc3VjY2Vzc2l2ZWx5IGJpZ2dlciBzcXVhcmVzXHJcbiAgICAgICAgbGV0IHBvaW50cyA6IEFycmF5PEJyZXcuQ29vcmRpbmF0ZT5cclxuICAgICAgICBmb3IgKGxldCBzaXplID0gMTsgc2l6ZSA8IG1heF9zaXplOyBzaXplKyspIHtcclxuICAgICAgICAgICAgcG9pbnRzID0gQnJldy5VdGlscy5nZXRTcXVhcmVQb2ludHMoc3BvdF94eSwgc2l6ZSlcclxuICAgICAgICAgICAgZm9yIChsZXQgeHkgb2YgcG9pbnRzKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc1NhZmUoeHksIGV4Y2x1ZGVfbG9jYXRpb25fd2l0aF9pdGVtKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB4eVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnNvbGUud2FybihcInVuYWJsZSB0byBmaW5kIHN1aXRhYmxlIHBsYWNlIHRvIGV4aXQgcGhhc2V3YWxrIC0gZHVtcGluZyB0byBwb3RlbnRpYWxseSBkdW1iIHJhbmRvbSBsb2NhdGlvblwiKVxyXG4gICAgICAgIGxldCByYW5kb21feHkgPSB0aGlzLmdldFNhZmVMb2NhdGlvbigpXHJcbiAgICAgICAgcmV0dXJuIHJhbmRvbV94eVxyXG4gICAgfVxyXG5cclxuICAgIGlzU2FmZSAoeHk6IEJyZXcuQ29vcmRpbmF0ZSwgZXhjbHVkZV9sb2NhdGlvbl93aXRoX2l0ZW0gOiBib29sZWFuID0gZmFsc2UpIDogYm9vbGVhbiB7XHJcbiAgICAgICAgbGV0IG5vdF9vayA6IGJvb2xlYW5cclxuXHJcbiAgICAgICAgbm90X29rID0gKFxyXG4gICAgICAgICAgICAoISh0aGlzLmlzVmFsaWQoeHkpKSkgfHwgXHJcbiAgICAgICAgICAgICh0aGlzLnRlcnJhaW4uZ2V0QXQoeHkpLmJsb2Nrc193YWxraW5nKSB8fCBcclxuICAgICAgICAgICAgKHRoaXMubW9uc3RlcnMuaGFzQXQoeHkpKSB8fFxyXG4gICAgICAgICAgICAodGhpcy5wb3J0YWxzLmhhc0F0KHh5KSkgfHwgXHJcbiAgICAgICAgICAgIChleGNsdWRlX2xvY2F0aW9uX3dpdGhfaXRlbSAmJiAodGhpcy5pdGVtcy5oYXNBdCh4eSkpKSB8fCBcclxuICAgICAgICAgICAgKHh5LmNvbXBhcmUodGhpcy5zaW1wbGVfZXhpdF94eSkpIHx8XHJcbiAgICAgICAgICAgICh4eS5jb21wYXJlKHRoaXMuc2ltcGxlX3N0YXJ0X3h5KSlcclxuICAgICAgICApXHJcblxyXG4gICAgICAgIHJldHVybiAoIShub3Rfb2spKVxyXG4gICAgfVxyXG5cclxuICAgIGdldFNhZmVMb2NhdGlvbiAoKSA6IEJyZXcuQ29vcmRpbmF0ZSB7XHJcbiAgICAgICAgLy8gcmV0dXJucyBhIHdhbGthYmxlLCBtb25zdGVyLWZyZWUgbG9jYXRpb25cclxuICAgICAgICBcclxuICAgICAgICBsZXQgeHkgOiBCcmV3LkNvb3JkaW5hdGVcclxuICAgICAgICBsZXQgdHJpZXMgPSAwXHJcbiAgICAgICAgbGV0IG5vdF9vayA6IGJvb2xlYW5cclxuXHJcbiAgICAgICAgd2hpbGUgKHRyaWVzIDwgNTApIHtcclxuICAgICAgICAgICAgeHkgPSBCcmV3LlV0aWxzLnJhbmRvbU9mKHRoaXMuZ2V0V2Fsa2FibGVUaWxlcygpKVxyXG4gICAgICAgICAgICBub3Rfb2sgPSAoXHJcbiAgICAgICAgICAgICAgICAodGhpcy5tb25zdGVycy5oYXNBdCh4eSkpIHx8XHJcbiAgICAgICAgICAgICAgICAoeHkuY29tcGFyZSh0aGlzLnNpbXBsZV9leGl0X3h5KSkgfHxcclxuICAgICAgICAgICAgICAgICh4eS5jb21wYXJlKHRoaXMuc2ltcGxlX3N0YXJ0X3h5KSlcclxuICAgICAgICAgICAgKVxyXG5cclxuICAgICAgICAgICAgaWYgKCEobm90X29rKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHh5XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdHJpZXMgKz0gMVxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwidW5hYmxlIHRvIGZpbmQgc2FmZSBsb2NhdGlvblwiKVxyXG4gICAgICAgIHJldHVybiBudWxsXHJcbiAgICB9XHJcblxyXG4gICAgdXBkYXRlTmF2aWdhdGlvbigpIHtcclxuICAgICAgICBsZXQgdCA6IEJyZXcuR3JpZFRoaW5ncy5UZXJyYWluXHJcbiAgICAgICAgbGV0IHh5IDogQnJldy5Db29yZGluYXRlXHJcblxyXG4gICAgICAgIGZvciAobGV0IHggPSAxOyB4IDwgKHRoaXMud2lkdGggLSAxKTsgeCsrKSB7XHJcbiAgICAgICAgICAgIGZvciAobGV0IHkgPSAxOyB5IDwgKHRoaXMuaGVpZ2h0IC0gMSk7IHkrKykge1xyXG4gICAgICAgICAgICAgICAgeHkgPSBuZXcgQnJldy5Db29yZGluYXRlKHgsIHkpXHJcbiAgICAgICAgICAgICAgICB0ID0gdGhpcy50ZXJyYWluLmdldEF0KHh5KVxyXG5cclxuICAgICAgICAgICAgICAgIGlmICghKHQuYmxvY2tzX3dhbGtpbmcpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5uYXZpZ2F0aW9uX3RpbGVzW0JyZXcuRW51bXMuTGV2ZWxOYXZpZ2F0aW9uVHlwZS5XYWxrXS5wdXNoKHh5KVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmICghKHQuYmxvY2tzX2ZseWluZykpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLm5hdmlnYXRpb25fdGlsZXNbQnJldy5FbnVtcy5MZXZlbE5hdmlnYXRpb25UeXBlLkZseV0ucHVzaCh4eSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBnZXRXYWxrYWJsZVRpbGVzKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmdldE5hdmlnYWJsZVRpbGVzT2ZUeXBlKEJyZXcuRW51bXMuTGV2ZWxOYXZpZ2F0aW9uVHlwZS5XYWxrKVxyXG4gICAgfVxyXG5cclxuICAgIGdldEZseWFibGVUaWxlcygpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5nZXROYXZpZ2FibGVUaWxlc09mVHlwZShCcmV3LkVudW1zLkxldmVsTmF2aWdhdGlvblR5cGUuRmx5KVxyXG4gICAgfVxyXG5cclxuICAgIGdldE5hdmlnYWJsZVRpbGVzT2ZUeXBlKG5hdlR5cGUgOiBCcmV3LkVudW1zLkxldmVsTmF2aWdhdGlvblR5cGUpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5uYXZpZ2F0aW9uX3RpbGVzW25hdlR5cGVdXHJcbiAgICB9XHJcblxyXG59XHJcbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/brew_components/level.ts\n");

/***/ }),

/***/ "./src/brew_components/portal.ts":
/*!***************************************!*\
  !*** ./src/brew_components/portal.ts ***!
  \***************************************/
/*! exports provided: Portal */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Portal\", function() { return Portal; });\nclass Portal {\r\n    constructor(from_level_id, from_level_xy) {\r\n        this.dest_level_id = null;\r\n        this.dest_location_xy = null;\r\n        this.source_level_id = from_level_id;\r\n        this.source_location_xy = from_level_xy;\r\n        this.destinationExists = false;\r\n    }\r\n    attachDestination(to_level_id, to_level_xy) {\r\n        this.dest_level_id = to_level_id;\r\n        this.dest_location_xy = to_level_xy;\r\n        this.destinationExists = true;\r\n        return true; // todo: return false when level gen fails -- can it fail?\r\n    }\r\n    getReversePortal() {\r\n        // return a portal that is the reverse/inverse of this portal\r\n        let reversePortal;\r\n        if (this.destinationExists) {\r\n            reversePortal = new Portal(this.dest_level_id, this.dest_location_xy);\r\n            reversePortal.dest_level_id = this.source_level_id;\r\n            reversePortal.dest_location_xy = this.source_location_xy;\r\n        }\r\n        else {\r\n            console.warn(\"can't reverse a portal without a destination\");\r\n            reversePortal = null;\r\n        }\r\n        return reversePortal;\r\n    }\r\n}\r\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvYnJld19jb21wb25lbnRzL3BvcnRhbC50cz8xMDFkIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBRU07SUFPRixZQUFhLGFBQXNCLEVBQUUsYUFBOEI7UUFIbkUsa0JBQWEsR0FBVyxJQUFJO1FBQzVCLHFCQUFnQixHQUFvQixJQUFJO1FBR3BDLElBQUksQ0FBQyxlQUFlLEdBQUcsYUFBYTtRQUNwQyxJQUFJLENBQUMsa0JBQWtCLEdBQUcsYUFBYTtRQUN2QyxJQUFJLENBQUMsaUJBQWlCLEdBQUcsS0FBSztJQUNsQyxDQUFDO0lBRU0saUJBQWlCLENBQUUsV0FBb0IsRUFBRSxXQUE2QjtRQUN6RSxJQUFJLENBQUMsYUFBYSxHQUFHLFdBQVc7UUFDaEMsSUFBSSxDQUFDLGdCQUFnQixHQUFHLFdBQVc7UUFDbkMsSUFBSSxDQUFDLGlCQUFpQixHQUFHLElBQUk7UUFDN0IsTUFBTSxDQUFDLElBQUksRUFBQywwREFBMEQ7SUFDMUUsQ0FBQztJQUVELGdCQUFnQjtRQUNaLDZEQUE2RDtRQUU3RCxJQUFJLGFBQXNCO1FBRTFCLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDLENBQUM7WUFDekIsYUFBYSxHQUFHLElBQUksTUFBTSxDQUFDLElBQUksQ0FBQyxhQUFhLEVBQUUsSUFBSSxDQUFDLGdCQUFnQixDQUFDO1lBQ3JFLGFBQWEsQ0FBQyxhQUFhLEdBQUcsSUFBSSxDQUFDLGVBQWU7WUFDbEQsYUFBYSxDQUFDLGdCQUFnQixHQUFHLElBQUksQ0FBQyxrQkFBa0I7UUFFNUQsQ0FBQztRQUFDLElBQUksQ0FBQyxDQUFDO1lBQ0osT0FBTyxDQUFDLElBQUksQ0FBQyw4Q0FBOEMsQ0FBQztZQUM1RCxhQUFhLEdBQUcsSUFBSTtRQUN4QixDQUFDO1FBRUQsTUFBTSxDQUFDLGFBQWE7SUFDeEIsQ0FBQztDQUNKIiwiZmlsZSI6Ii4vc3JjL2JyZXdfY29tcG9uZW50cy9wb3J0YWwudHMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBCcmV3IGZyb20gXCIuLi9icmV3XCJcclxuXHJcbmV4cG9ydCBjbGFzcyBQb3J0YWwge1xyXG4gICAgc291cmNlX2xldmVsX2lkOiBudW1iZXJcclxuICAgIHNvdXJjZV9sb2NhdGlvbl94eTogQnJldy5Db29yZGluYXRlXHJcbiAgICBkZXN0aW5hdGlvbkV4aXN0czogYm9vbGVhblxyXG4gICAgZGVzdF9sZXZlbF9pZDogbnVtYmVyID0gbnVsbFxyXG4gICAgZGVzdF9sb2NhdGlvbl94eTogQnJldy5Db29yZGluYXRlID0gbnVsbFxyXG5cclxuICAgIGNvbnN0cnVjdG9yIChmcm9tX2xldmVsX2lkIDogbnVtYmVyLCBmcm9tX2xldmVsX3h5OiBCcmV3LkNvb3JkaW5hdGUpICB7XHJcbiAgICAgICAgdGhpcy5zb3VyY2VfbGV2ZWxfaWQgPSBmcm9tX2xldmVsX2lkXHJcbiAgICAgICAgdGhpcy5zb3VyY2VfbG9jYXRpb25feHkgPSBmcm9tX2xldmVsX3h5XHJcbiAgICAgICAgdGhpcy5kZXN0aW5hdGlvbkV4aXN0cyA9IGZhbHNlXHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGF0dGFjaERlc3RpbmF0aW9uICh0b19sZXZlbF9pZCA6IG51bWJlciwgdG9fbGV2ZWxfeHkgOiBCcmV3LkNvb3JkaW5hdGUpIDogYm9vbGVhbiB7XHJcbiAgICAgICAgdGhpcy5kZXN0X2xldmVsX2lkID0gdG9fbGV2ZWxfaWRcclxuICAgICAgICB0aGlzLmRlc3RfbG9jYXRpb25feHkgPSB0b19sZXZlbF94eVxyXG4gICAgICAgIHRoaXMuZGVzdGluYXRpb25FeGlzdHMgPSB0cnVlXHJcbiAgICAgICAgcmV0dXJuIHRydWUgLy8gdG9kbzogcmV0dXJuIGZhbHNlIHdoZW4gbGV2ZWwgZ2VuIGZhaWxzIC0tIGNhbiBpdCBmYWlsP1xyXG4gICAgfVxyXG5cclxuICAgIGdldFJldmVyc2VQb3J0YWwgKCkgOiBQb3J0YWwge1xyXG4gICAgICAgIC8vIHJldHVybiBhIHBvcnRhbCB0aGF0IGlzIHRoZSByZXZlcnNlL2ludmVyc2Ugb2YgdGhpcyBwb3J0YWxcclxuICAgICAgICBcclxuICAgICAgICBsZXQgcmV2ZXJzZVBvcnRhbCA6IFBvcnRhbFxyXG5cclxuICAgICAgICBpZiAodGhpcy5kZXN0aW5hdGlvbkV4aXN0cykge1xyXG4gICAgICAgICAgICByZXZlcnNlUG9ydGFsID0gbmV3IFBvcnRhbCh0aGlzLmRlc3RfbGV2ZWxfaWQsIHRoaXMuZGVzdF9sb2NhdGlvbl94eSlcclxuICAgICAgICAgICAgcmV2ZXJzZVBvcnRhbC5kZXN0X2xldmVsX2lkID0gdGhpcy5zb3VyY2VfbGV2ZWxfaWRcclxuICAgICAgICAgICAgcmV2ZXJzZVBvcnRhbC5kZXN0X2xvY2F0aW9uX3h5ID0gdGhpcy5zb3VyY2VfbG9jYXRpb25feHlcclxuXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY29uc29sZS53YXJuKFwiY2FuJ3QgcmV2ZXJzZSBhIHBvcnRhbCB3aXRob3V0IGEgZGVzdGluYXRpb25cIilcclxuICAgICAgICAgICAgcmV2ZXJzZVBvcnRhbCA9IG51bGxcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiByZXZlcnNlUG9ydGFsXHJcbiAgICB9XHJcbn0iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/brew_components/portal.ts\n");

/***/ }),

/***/ "./src/brew_components/stat.ts":
/*!*************************************!*\
  !*** ./src/brew_components/stat.ts ***!
  \*************************************/
/*! exports provided: Stat */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Stat\", function() { return Stat; });\nclass Stat {\r\n    constructor(statName, amount) {\r\n        this.statName = statName;\r\n        this.current_amount = amount;\r\n        this.max_amount = amount;\r\n    }\r\n    setCurrentLevel(amount) {\r\n        this.current_amount = amount;\r\n    }\r\n    setMaxLevel(amount) {\r\n        this.max_amount = amount;\r\n    }\r\n    setTo(amount) {\r\n        this.current_amount = amount;\r\n        this.max_amount = amount;\r\n    }\r\n    getCurrentLevel() { return this.current_amount; }\r\n    getMaxLevel() { return this.max_amount; }\r\n    resetToMax() {\r\n        this.current_amount = this.max_amount;\r\n    }\r\n    isMaxed() {\r\n        return this.current_amount == this.max_amount;\r\n    }\r\n    isEmpty() {\r\n        return this.current_amount == 0;\r\n    }\r\n    increment(amount, overrideMax = false) {\r\n        if (overrideMax) {\r\n            this.current_amount += amount;\r\n        }\r\n        else {\r\n            this.current_amount = Math.min(this.max_amount, this.current_amount + amount);\r\n        }\r\n    }\r\n    decrement(amount) {\r\n        this.current_amount = Math.max(0, this.current_amount - amount);\r\n    }\r\n    getType() {\r\n        return this.statName;\r\n    }\r\n}\r\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvYnJld19jb21wb25lbnRzL3N0YXQudHM/YjFlZiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUVNO0lBSUYsWUFBb0IsUUFBOEIsRUFBRSxNQUFjO1FBQTlDLGFBQVEsR0FBUixRQUFRLENBQXNCO1FBQzlDLElBQUksQ0FBQyxjQUFjLEdBQUcsTUFBTTtRQUM1QixJQUFJLENBQUMsVUFBVSxHQUFHLE1BQU07SUFDNUIsQ0FBQztJQUVELGVBQWUsQ0FBQyxNQUFjO1FBQzFCLElBQUksQ0FBQyxjQUFjLEdBQUcsTUFBTTtJQUNoQyxDQUFDO0lBRUQsV0FBVyxDQUFDLE1BQWM7UUFDdEIsSUFBSSxDQUFDLFVBQVUsR0FBRyxNQUFNO0lBQzVCLENBQUM7SUFFRCxLQUFLLENBQUMsTUFBYztRQUNoQixJQUFJLENBQUMsY0FBYyxHQUFHLE1BQU07UUFDNUIsSUFBSSxDQUFDLFVBQVUsR0FBRyxNQUFNO0lBQzVCLENBQUM7SUFFRCxlQUFlLEtBQUssTUFBTSxDQUFDLElBQUksQ0FBQyxjQUFjLEVBQUMsQ0FBQztJQUNoRCxXQUFXLEtBQUssTUFBTSxDQUFDLElBQUksQ0FBQyxVQUFVLEVBQUMsQ0FBQztJQUV4QyxVQUFVO1FBQ04sSUFBSSxDQUFDLGNBQWMsR0FBRyxJQUFJLENBQUMsVUFBVTtJQUN6QyxDQUFDO0lBRUQsT0FBTztRQUNILE1BQU0sQ0FBQyxJQUFJLENBQUMsY0FBYyxJQUFJLElBQUksQ0FBQyxVQUFVO0lBQ2pELENBQUM7SUFFRCxPQUFPO1FBQ0gsTUFBTSxDQUFDLElBQUksQ0FBQyxjQUFjLElBQUksQ0FBQztJQUNuQyxDQUFDO0lBRUQsU0FBUyxDQUFDLE1BQWMsRUFBRSxjQUF3QixLQUFLO1FBQ25ELEVBQUUsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUM7WUFDZCxJQUFJLENBQUMsY0FBYyxJQUFJLE1BQU07UUFDakMsQ0FBQztRQUFDLElBQUksQ0FBQyxDQUFDO1lBQ0osSUFBSSxDQUFDLGNBQWMsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxVQUFVLEVBQUUsSUFBSSxDQUFDLGNBQWMsR0FBRyxNQUFNLENBQUM7UUFDakYsQ0FBQztJQUNMLENBQUM7SUFFRCxTQUFTLENBQUMsTUFBYztRQUNwQixJQUFJLENBQUMsY0FBYyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFLElBQUksQ0FBQyxjQUFjLEdBQUcsTUFBTSxDQUFDO0lBQ25FLENBQUM7SUFFRCxPQUFPO1FBQ0gsTUFBTSxDQUFDLElBQUksQ0FBQyxRQUFRO0lBQ3hCLENBQUM7Q0FDSiIsImZpbGUiOiIuL3NyYy9icmV3X2NvbXBvbmVudHMvc3RhdC50cy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIEJyZXcgZnJvbSBcIi4uL2JyZXdcIlxyXG5cclxuZXhwb3J0IGNsYXNzIFN0YXQge1xyXG4gICAgcHJpdmF0ZSBjdXJyZW50X2Ftb3VudCA6IG51bWJlclxyXG4gICAgcHJpdmF0ZSBtYXhfYW1vdW50IDogbnVtYmVyXHJcblxyXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBzdGF0TmFtZSA6IEJyZXcuRW51bXMuU3RhdE5hbWUsIGFtb3VudDogbnVtYmVyKSB7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50X2Ftb3VudCA9IGFtb3VudFxyXG4gICAgICAgIHRoaXMubWF4X2Ftb3VudCA9IGFtb3VudFxyXG4gICAgfVxyXG5cclxuICAgIHNldEN1cnJlbnRMZXZlbChhbW91bnQ6IG51bWJlcikge1xyXG4gICAgICAgIHRoaXMuY3VycmVudF9hbW91bnQgPSBhbW91bnRcclxuICAgIH1cclxuXHJcbiAgICBzZXRNYXhMZXZlbChhbW91bnQ6IG51bWJlcikge1xyXG4gICAgICAgIHRoaXMubWF4X2Ftb3VudCA9IGFtb3VudFxyXG4gICAgfVxyXG5cclxuICAgIHNldFRvKGFtb3VudDogbnVtYmVyKSB7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50X2Ftb3VudCA9IGFtb3VudFxyXG4gICAgICAgIHRoaXMubWF4X2Ftb3VudCA9IGFtb3VudFxyXG4gICAgfSBcclxuXHJcbiAgICBnZXRDdXJyZW50TGV2ZWwoKSB7IHJldHVybiB0aGlzLmN1cnJlbnRfYW1vdW50IH1cclxuICAgIGdldE1heExldmVsKCkgeyByZXR1cm4gdGhpcy5tYXhfYW1vdW50IH1cclxuICAgIFxyXG4gICAgcmVzZXRUb01heCgpIHtcclxuICAgICAgICB0aGlzLmN1cnJlbnRfYW1vdW50ID0gdGhpcy5tYXhfYW1vdW50XHJcbiAgICB9XHJcblxyXG4gICAgaXNNYXhlZCgpIDogYm9vbGVhbiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY3VycmVudF9hbW91bnQgPT0gdGhpcy5tYXhfYW1vdW50XHJcbiAgICB9XHJcblxyXG4gICAgaXNFbXB0eSgpIDogYm9vbGVhbiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY3VycmVudF9hbW91bnQgPT0gMFxyXG4gICAgfVxyXG5cclxuICAgIGluY3JlbWVudChhbW91bnQ6IG51bWJlciwgb3ZlcnJpZGVNYXggOiBib29sZWFuID0gZmFsc2UpICB7XHJcbiAgICAgICAgaWYgKG92ZXJyaWRlTWF4KSB7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudF9hbW91bnQgKz0gYW1vdW50XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50X2Ftb3VudCA9IE1hdGgubWluKHRoaXMubWF4X2Ftb3VudCwgdGhpcy5jdXJyZW50X2Ftb3VudCArIGFtb3VudClcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZGVjcmVtZW50KGFtb3VudDogbnVtYmVyKSB7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50X2Ftb3VudCA9IE1hdGgubWF4KDAsIHRoaXMuY3VycmVudF9hbW91bnQgLSBhbW91bnQpXHJcbiAgICB9XHJcblxyXG4gICAgZ2V0VHlwZSgpIDogQnJldy5FbnVtcy5TdGF0TmFtZSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc3RhdE5hbWVcclxuICAgIH1cclxufSAgIFxyXG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/brew_components/stat.ts\n");

/***/ }),

/***/ "./src/brew_components/symbols.ts":
/*!****************************************!*\
  !*** ./src/brew_components/symbols.ts ***!
  \****************************************/
/*! exports provided: full_block, smiley_face, power_sys, diamond_full, diamond_empty, jigjags, fourdots, heart_full, heart_empty, pointer_up, pointer_down, pointer_left, pointer_right, pointer_downright, pointer_downleft, pointer_upleft, pointer_upright, radioactive_sign, quad_diamond, double_angle_bracket_left, double_angle_bracket_right, box_hline, box_vline, box_topleft, box_topright, box_bottomleft, box_bottomright, arrow_up, arrow_left, arrow_right, arrow_down, dbl_arrow_left, dbl_arrow_up, dbl_arrow_right, dbl_arrow_down, half_block_lower */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"full_block\", function() { return full_block; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"smiley_face\", function() { return smiley_face; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"power_sys\", function() { return power_sys; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"diamond_full\", function() { return diamond_full; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"diamond_empty\", function() { return diamond_empty; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"jigjags\", function() { return jigjags; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"fourdots\", function() { return fourdots; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"heart_full\", function() { return heart_full; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"heart_empty\", function() { return heart_empty; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"pointer_up\", function() { return pointer_up; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"pointer_down\", function() { return pointer_down; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"pointer_left\", function() { return pointer_left; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"pointer_right\", function() { return pointer_right; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"pointer_downright\", function() { return pointer_downright; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"pointer_downleft\", function() { return pointer_downleft; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"pointer_upleft\", function() { return pointer_upleft; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"pointer_upright\", function() { return pointer_upright; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"radioactive_sign\", function() { return radioactive_sign; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"quad_diamond\", function() { return quad_diamond; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"double_angle_bracket_left\", function() { return double_angle_bracket_left; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"double_angle_bracket_right\", function() { return double_angle_bracket_right; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"box_hline\", function() { return box_hline; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"box_vline\", function() { return box_vline; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"box_topleft\", function() { return box_topleft; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"box_topright\", function() { return box_topright; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"box_bottomleft\", function() { return box_bottomleft; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"box_bottomright\", function() { return box_bottomright; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"arrow_up\", function() { return arrow_up; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"arrow_left\", function() { return arrow_left; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"arrow_right\", function() { return arrow_right; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"arrow_down\", function() { return arrow_down; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"dbl_arrow_left\", function() { return dbl_arrow_left; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"dbl_arrow_up\", function() { return dbl_arrow_up; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"dbl_arrow_right\", function() { return dbl_arrow_right; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"dbl_arrow_down\", function() { return dbl_arrow_down; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"half_block_lower\", function() { return half_block_lower; });\n// http://www.fileformat.info/info/unicode/font/monospaced.bold/grid.htm\r\n// https://www.w3schools.com/charsets/ref_utf_geometric.asp\r\nconst full_block = \"\\u2588\";\r\nconst smiley_face = \"\\u263A\";\r\nconst power_sys = \"\\u00A4\";\r\nconst diamond_full = \"\\u2666\";\r\nconst diamond_empty = \"\\u25C7\";\r\nconst jigjags = \"\\u2652\";\r\nconst fourdots = \"\\u2237\";\r\nconst heart_full = \"\\u2665\";\r\nconst heart_empty = \"\\u2661\";\r\nconst pointer_up = \"\\u25B2\";\r\nconst pointer_down = \"\\u25BC\";\r\nconst pointer_left = \"\\u25C4\";\r\nconst pointer_right = \"\\u25BA\";\r\nconst pointer_downright = \"\\u25E2\";\r\nconst pointer_downleft = \"\\u25E3\";\r\nconst pointer_upleft = \"\\u25E4\";\r\nconst pointer_upright = \"\\u25E5\";\r\nconst radioactive_sign = \"\\u2622\";\r\nconst quad_diamond = \"\\u233a\";\r\nconst double_angle_bracket_left = \"\\u226A\";\r\nconst double_angle_bracket_right = \"\\u226B\";\r\n// box drawing\r\nconst box_hline = \"\\u2500\";\r\nconst box_vline = \"\\u2502\";\r\nconst box_topleft = \"\\u250c\";\r\nconst box_topright = \"\\u2510\";\r\nconst box_bottomleft = \"\\u2514\";\r\nconst box_bottomright = \"\\u2518\";\r\n// arrows\r\nconst arrow_up = \"\\u2191\";\r\nconst arrow_left = \"\\u2190\";\r\nconst arrow_right = \"\\u2192\";\r\nconst arrow_down = \"\\u2193\";\r\nconst dbl_arrow_left = \"\\u219E\";\r\nconst dbl_arrow_up = \"\\u219F\";\r\nconst dbl_arrow_right = \"\\u21A0\";\r\nconst dbl_arrow_down = \"\\u21A1\";\r\nconst half_block_lower = \"\\u2584\";\r\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvYnJld19jb21wb25lbnRzL3N5bWJvbHMudHM/MWEwMSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFDQTtBQUFBLHdFQUF3RTtBQUN4RSwyREFBMkQ7QUFFcEQsTUFBTSxVQUFVLEdBQUcsUUFBUTtBQUMzQixNQUFNLFdBQVcsR0FBRyxRQUFRO0FBQzVCLE1BQU0sU0FBUyxHQUFHLFFBQVE7QUFDMUIsTUFBTSxZQUFZLEdBQUcsUUFBUTtBQUM3QixNQUFNLGFBQWEsR0FBRyxRQUFRO0FBQzlCLE1BQU0sT0FBTyxHQUFHLFFBQVE7QUFDeEIsTUFBTSxRQUFRLEdBQUcsUUFBUTtBQUN6QixNQUFNLFVBQVUsR0FBRyxRQUFRO0FBQzNCLE1BQU0sV0FBVyxHQUFHLFFBQVE7QUFFNUIsTUFBTSxVQUFVLEdBQUcsUUFBUTtBQUMzQixNQUFNLFlBQVksR0FBRyxRQUFRO0FBQzdCLE1BQU0sWUFBWSxHQUFHLFFBQVE7QUFDN0IsTUFBTSxhQUFhLEdBQUcsUUFBUTtBQUU5QixNQUFNLGlCQUFpQixHQUFHLFFBQVE7QUFDbEMsTUFBTSxnQkFBZ0IsR0FBRyxRQUFRO0FBQ2pDLE1BQU0sY0FBYyxHQUFHLFFBQVE7QUFDL0IsTUFBTSxlQUFlLEdBQUcsUUFBUTtBQUVoQyxNQUFNLGdCQUFnQixHQUFHLFFBQVE7QUFDakMsTUFBTSxZQUFZLEdBQUcsUUFBUTtBQUM3QixNQUFNLHlCQUF5QixHQUFHLFFBQVE7QUFDMUMsTUFBTSwwQkFBMEIsR0FBRyxRQUFRO0FBRWxELGNBQWM7QUFDUCxNQUFNLFNBQVMsR0FBRyxRQUFRO0FBQzFCLE1BQU0sU0FBUyxHQUFHLFFBQVE7QUFDMUIsTUFBTSxXQUFXLEdBQUcsUUFBUTtBQUM1QixNQUFNLFlBQVksR0FBRyxRQUFRO0FBQzdCLE1BQU0sY0FBYyxHQUFHLFFBQVE7QUFDL0IsTUFBTSxlQUFlLEdBQUcsUUFBUTtBQUV2QyxTQUFTO0FBQ0YsTUFBTSxRQUFRLEdBQUcsUUFBUTtBQUN6QixNQUFNLFVBQVUsR0FBRyxRQUFRO0FBQzNCLE1BQU0sV0FBVyxHQUFHLFFBQVE7QUFDNUIsTUFBTSxVQUFVLEdBQUcsUUFBUTtBQUMzQixNQUFNLGNBQWMsR0FBRyxRQUFRO0FBQy9CLE1BQU0sWUFBWSxHQUFHLFFBQVE7QUFDN0IsTUFBTSxlQUFlLEdBQUcsUUFBUTtBQUNoQyxNQUFNLGNBQWMsR0FBRyxRQUFRO0FBRS9CLE1BQU0sZ0JBQWdCLEdBQUcsUUFBUSIsImZpbGUiOiIuL3NyYy9icmV3X2NvbXBvbmVudHMvc3ltYm9scy50cy5qcyIsInNvdXJjZXNDb250ZW50IjpbIlxyXG4vLyBodHRwOi8vd3d3LmZpbGVmb3JtYXQuaW5mby9pbmZvL3VuaWNvZGUvZm9udC9tb25vc3BhY2VkLmJvbGQvZ3JpZC5odG1cclxuLy8gaHR0cHM6Ly93d3cudzNzY2hvb2xzLmNvbS9jaGFyc2V0cy9yZWZfdXRmX2dlb21ldHJpYy5hc3BcclxuXHJcbmV4cG9ydCBjb25zdCBmdWxsX2Jsb2NrID0gXCJcXHUyNTg4XCJcclxuZXhwb3J0IGNvbnN0IHNtaWxleV9mYWNlID0gXCJcXHUyNjNBXCJcclxuZXhwb3J0IGNvbnN0IHBvd2VyX3N5cyA9IFwiXFx1MDBBNFwiXHJcbmV4cG9ydCBjb25zdCBkaWFtb25kX2Z1bGwgPSBcIlxcdTI2NjZcIlxyXG5leHBvcnQgY29uc3QgZGlhbW9uZF9lbXB0eSA9IFwiXFx1MjVDN1wiXHJcbmV4cG9ydCBjb25zdCBqaWdqYWdzID0gXCJcXHUyNjUyXCJcclxuZXhwb3J0IGNvbnN0IGZvdXJkb3RzID0gXCJcXHUyMjM3XCJcclxuZXhwb3J0IGNvbnN0IGhlYXJ0X2Z1bGwgPSBcIlxcdTI2NjVcIlxyXG5leHBvcnQgY29uc3QgaGVhcnRfZW1wdHkgPSBcIlxcdTI2NjFcIlxyXG5cclxuZXhwb3J0IGNvbnN0IHBvaW50ZXJfdXAgPSBcIlxcdTI1QjJcIlxyXG5leHBvcnQgY29uc3QgcG9pbnRlcl9kb3duID0gXCJcXHUyNUJDXCJcclxuZXhwb3J0IGNvbnN0IHBvaW50ZXJfbGVmdCA9IFwiXFx1MjVDNFwiXHJcbmV4cG9ydCBjb25zdCBwb2ludGVyX3JpZ2h0ID0gXCJcXHUyNUJBXCJcclxuXHJcbmV4cG9ydCBjb25zdCBwb2ludGVyX2Rvd25yaWdodCA9IFwiXFx1MjVFMlwiXHJcbmV4cG9ydCBjb25zdCBwb2ludGVyX2Rvd25sZWZ0ID0gXCJcXHUyNUUzXCJcclxuZXhwb3J0IGNvbnN0IHBvaW50ZXJfdXBsZWZ0ID0gXCJcXHUyNUU0XCJcclxuZXhwb3J0IGNvbnN0IHBvaW50ZXJfdXByaWdodCA9IFwiXFx1MjVFNVwiXHJcblxyXG5leHBvcnQgY29uc3QgcmFkaW9hY3RpdmVfc2lnbiA9IFwiXFx1MjYyMlwiXHJcbmV4cG9ydCBjb25zdCBxdWFkX2RpYW1vbmQgPSBcIlxcdTIzM2FcIlxyXG5leHBvcnQgY29uc3QgZG91YmxlX2FuZ2xlX2JyYWNrZXRfbGVmdCA9IFwiXFx1MjI2QVwiXHJcbmV4cG9ydCBjb25zdCBkb3VibGVfYW5nbGVfYnJhY2tldF9yaWdodCA9IFwiXFx1MjI2QlwiXHJcblxyXG4vLyBib3ggZHJhd2luZ1xyXG5leHBvcnQgY29uc3QgYm94X2hsaW5lID0gXCJcXHUyNTAwXCJcclxuZXhwb3J0IGNvbnN0IGJveF92bGluZSA9IFwiXFx1MjUwMlwiXHJcbmV4cG9ydCBjb25zdCBib3hfdG9wbGVmdCA9IFwiXFx1MjUwY1wiXHJcbmV4cG9ydCBjb25zdCBib3hfdG9wcmlnaHQgPSBcIlxcdTI1MTBcIlxyXG5leHBvcnQgY29uc3QgYm94X2JvdHRvbWxlZnQgPSBcIlxcdTI1MTRcIlxyXG5leHBvcnQgY29uc3QgYm94X2JvdHRvbXJpZ2h0ID0gXCJcXHUyNTE4XCJcclxuXHJcbi8vIGFycm93c1xyXG5leHBvcnQgY29uc3QgYXJyb3dfdXAgPSBcIlxcdTIxOTFcIlxyXG5leHBvcnQgY29uc3QgYXJyb3dfbGVmdCA9IFwiXFx1MjE5MFwiXHJcbmV4cG9ydCBjb25zdCBhcnJvd19yaWdodCA9IFwiXFx1MjE5MlwiXHJcbmV4cG9ydCBjb25zdCBhcnJvd19kb3duID0gXCJcXHUyMTkzXCJcclxuZXhwb3J0IGNvbnN0IGRibF9hcnJvd19sZWZ0ID0gXCJcXHUyMTlFXCJcclxuZXhwb3J0IGNvbnN0IGRibF9hcnJvd191cCA9IFwiXFx1MjE5RlwiXHJcbmV4cG9ydCBjb25zdCBkYmxfYXJyb3dfcmlnaHQgPSBcIlxcdTIxQTBcIlxyXG5leHBvcnQgY29uc3QgZGJsX2Fycm93X2Rvd24gPSBcIlxcdTIxQTFcIlxyXG5cclxuZXhwb3J0IGNvbnN0IGhhbGZfYmxvY2tfbG93ZXIgPSBcIlxcdTI1ODRcIiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/brew_components/symbols.ts\n");

/***/ }),

/***/ "./src/brew_components/turning.ts":
/*!****************************************!*\
  !*** ./src/brew_components/turning.ts ***!
  \****************************************/
/*! exports provided: getAngleBetween */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getAngleBetween\", function() { return getAngleBetween; });\n/* harmony import */ var _brew__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../brew */ \"./src/brew.ts\");\n\r\nfunction getAngleBetween(coord_from, coord_to) {\r\n    let theta_from = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].xyToPolar(coord_from).angle_theta;\r\n    let theta_to = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].xyToPolar(coord_to).angle_theta;\r\n    let raw_diff = theta_to - theta_from;\r\n    // =IF(G6<-PI(),-1*(G6+PI()),IF(G6>PI(),-1*(G6-PI()),G6))\r\n    let pi = Math.PI;\r\n    let neg_pi = -1 * pi;\r\n    let diff;\r\n    if (raw_diff < neg_pi) {\r\n        diff = -1 * (raw_diff + pi);\r\n    }\r\n    else if (raw_diff > pi) {\r\n        diff = -1 * (raw_diff + neg_pi);\r\n    }\r\n    else {\r\n        diff = raw_diff;\r\n    }\r\n    return diff;\r\n}\r\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvYnJld19jb21wb25lbnRzL3R1cm5pbmcudHM/MGQ4MyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFBK0I7QUFHekIseUJBQTBCLFVBQXNCLEVBQUUsUUFBb0I7SUFDeEUsSUFBSSxVQUFVLEdBQUcsMkNBQVUsQ0FBQyxTQUFTLENBQUMsVUFBVSxDQUFDLENBQUMsV0FBVztJQUM3RCxJQUFJLFFBQVEsR0FBRywyQ0FBVSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxXQUFXO0lBQ3pELElBQUksUUFBUSxHQUFHLFFBQVEsR0FBRyxVQUFVO0lBQ3BDLHlEQUF5RDtJQUN6RCxJQUFJLEVBQUUsR0FBRyxJQUFJLENBQUMsRUFBRTtJQUNoQixJQUFJLE1BQU0sR0FBRyxDQUFDLENBQUMsR0FBRyxFQUFFO0lBRXBCLElBQUksSUFBYTtJQUNqQixFQUFFLENBQUMsQ0FBQyxRQUFRLEdBQUcsTUFBTSxDQUFDLENBQUMsQ0FBQztRQUNwQixJQUFJLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxRQUFRLEdBQUcsRUFBRSxDQUFDO0lBQy9CLENBQUM7SUFBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsUUFBUSxHQUFHLEVBQUUsQ0FBQyxDQUFDLENBQUM7UUFDdkIsSUFBSSxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsUUFBUSxHQUFHLE1BQU0sQ0FBQztJQUNuQyxDQUFDO0lBQUMsSUFBSSxDQUFDLENBQUM7UUFDSixJQUFJLEdBQUcsUUFBUTtJQUNuQixDQUFDO0lBQ0QsTUFBTSxDQUFDLElBQUk7QUFDZixDQUFDIiwiZmlsZSI6Ii4vc3JjL2JyZXdfY29tcG9uZW50cy90dXJuaW5nLnRzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgQnJldyBmcm9tICcuLi9icmV3J1xyXG5pbXBvcnQgeyBDb29yZGluYXRlIH0gZnJvbSAnLi4vYnJld19jb21wb25lbnRzL2Nvb3JkaW5hdGUnXHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0QW5nbGVCZXR3ZWVuKGNvb3JkX2Zyb206IENvb3JkaW5hdGUsIGNvb3JkX3RvOiBDb29yZGluYXRlKTogbnVtYmVyIHtcclxuICAgIGxldCB0aGV0YV9mcm9tID0gQnJldy5VdGlscy54eVRvUG9sYXIoY29vcmRfZnJvbSkuYW5nbGVfdGhldGFcclxuICAgIGxldCB0aGV0YV90byA9IEJyZXcuVXRpbHMueHlUb1BvbGFyKGNvb3JkX3RvKS5hbmdsZV90aGV0YVxyXG4gICAgbGV0IHJhd19kaWZmID0gdGhldGFfdG8gLSB0aGV0YV9mcm9tXHJcbiAgICAvLyA9SUYoRzY8LVBJKCksLTEqKEc2K1BJKCkpLElGKEc2PlBJKCksLTEqKEc2LVBJKCkpLEc2KSlcclxuICAgIGxldCBwaSA9IE1hdGguUElcclxuICAgIGxldCBuZWdfcGkgPSAtMSAqIHBpXHJcblxyXG4gICAgbGV0IGRpZmYgOiBudW1iZXJcclxuICAgIGlmIChyYXdfZGlmZiA8IG5lZ19waSkge1xyXG4gICAgICAgIGRpZmYgPSAtMSAqIChyYXdfZGlmZiArIHBpKVxyXG4gICAgfSBlbHNlIGlmIChyYXdfZGlmZiA+IHBpKSB7XHJcbiAgICAgICAgZGlmZiA9IC0xICogKHJhd19kaWZmICsgbmVnX3BpKVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBkaWZmID0gcmF3X2RpZmZcclxuICAgIH1cclxuICAgIHJldHVybiBkaWZmXHJcbn0iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/brew_components/turning.ts\n");

/***/ }),

/***/ "./src/brew_components/utils.ts":
/*!**************************************!*\
  !*** ./src/brew_components/utils.ts ***!
  \**************************************/
/*! exports provided: generateID, xyToKey, keyToXY, x_and_yToKey, adjacentKeys, randomOf, randomize, remove, mod, clone, getElementsOfEnum, getRandomInt, getDirectionFromKeycode, dist2d, getLineBetweenPoints, getSquarePoints, getCirclePoints, safe_color, getMonstersWithinRadius, getBlastArea, getMonstersWithinCoordinateArea, getPolarOffsetCoordinate, xyToPolar, getTradjectoryCoordinate, intersectionOfCoordinateLists, isCoordinateInListOfCoordinates, roundToPrecision */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"generateID\", function() { return generateID; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"xyToKey\", function() { return xyToKey; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"keyToXY\", function() { return keyToXY; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"x_and_yToKey\", function() { return x_and_yToKey; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"adjacentKeys\", function() { return adjacentKeys; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"randomOf\", function() { return randomOf; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"randomize\", function() { return randomize; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"remove\", function() { return remove; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"mod\", function() { return mod; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"clone\", function() { return clone; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getElementsOfEnum\", function() { return getElementsOfEnum; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getRandomInt\", function() { return getRandomInt; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getDirectionFromKeycode\", function() { return getDirectionFromKeycode; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"dist2d\", function() { return dist2d; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getLineBetweenPoints\", function() { return getLineBetweenPoints; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getSquarePoints\", function() { return getSquarePoints; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getCirclePoints\", function() { return getCirclePoints; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"safe_color\", function() { return safe_color; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getMonstersWithinRadius\", function() { return getMonstersWithinRadius; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getBlastArea\", function() { return getBlastArea; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getMonstersWithinCoordinateArea\", function() { return getMonstersWithinCoordinateArea; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getPolarOffsetCoordinate\", function() { return getPolarOffsetCoordinate; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"xyToPolar\", function() { return xyToPolar; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getTradjectoryCoordinate\", function() { return getTradjectoryCoordinate; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"intersectionOfCoordinateLists\", function() { return intersectionOfCoordinateLists; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isCoordinateInListOfCoordinates\", function() { return isCoordinateInListOfCoordinates; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"roundToPrecision\", function() { return roundToPrecision; });\n/* harmony import */ var rot_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! rot-js */ \"./node_modules/rot-js/lib/rot.js\");\n/* harmony import */ var rot_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(rot_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _brew__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../brew */ \"./src/brew.ts\");\n/* harmony import */ var _brew_components_coordinate__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../brew_components/coordinate */ \"./src/brew_components/coordinate.ts\");\n\r\n\r\n\r\nlet init_id = Math.floor(rot_js__WEBPACK_IMPORTED_MODULE_0__[\"RNG\"].getUniform() * 999) + 1;\r\nfunction generateID() {\r\n    init_id += 1;\r\n    return init_id;\r\n}\r\n// let MAX_GRID_SIZE = Brew.Config.MAX_GRID_SIZE\r\nfunction xyToKey(xy) {\r\n    return (xy.y * _brew__WEBPACK_IMPORTED_MODULE_1__[\"Config\"].MAX_GRID_SIZE) + xy.x;\r\n}\r\nfunction keyToXY(key) {\r\n    return new _brew_components_coordinate__WEBPACK_IMPORTED_MODULE_2__[\"Coordinate\"](key % _brew__WEBPACK_IMPORTED_MODULE_1__[\"Config\"].MAX_GRID_SIZE, Math.floor(key / _brew__WEBPACK_IMPORTED_MODULE_1__[\"Config\"].MAX_GRID_SIZE));\r\n}\r\nfunction x_and_yToKey(x, y) {\r\n    return (y * _brew__WEBPACK_IMPORTED_MODULE_1__[\"Config\"].MAX_GRID_SIZE) + x;\r\n}\r\nfunction adjacentKeys(key) {\r\n    // returns keys of 4 adjacent xy coords\r\n    // TODO: cache this\r\n    return keyToXY(key).getAdjacent().map((xy, index, array) => { return xyToKey(xy); });\r\n}\r\nfunction randomOf(some_array, useROT = true) {\r\n    if (!(some_array.length)) {\r\n        return null;\r\n    }\r\n    if (useROT) {\r\n        return some_array[Math.floor(rot_js__WEBPACK_IMPORTED_MODULE_0__[\"RNG\"].getUniform() * some_array.length)];\r\n    }\r\n    else {\r\n        return some_array[Math.floor(Math.random() * some_array.length)];\r\n    }\r\n}\r\nfunction randomize(some_array, useROT = true) {\r\n    let result = [];\r\n    while (some_array.length) {\r\n        let index = some_array.indexOf(randomOf(some_array, useROT));\r\n        result.push(some_array.splice(index, 1)[0]);\r\n    }\r\n    return result;\r\n}\r\nfunction remove(arr, element) {\r\n    let index = arr.indexOf(element);\r\n    if (index > -1) {\r\n        arr.splice(index, 1);\r\n    }\r\n}\r\nfunction mod(m, n) {\r\n    return ((m % n) + n) % n;\r\n}\r\nfunction clone(obj) {\r\n    // https://stackoverflow.com/questions/728360/most-elegant-way-to-clone-a-javascript-object\r\n    var copy;\r\n    // Handle the 3 simple types, and null or undefined\r\n    if (null == obj || \"object\" != typeof obj)\r\n        return obj;\r\n    // handle coords\r\n    if (obj instanceof _brew__WEBPACK_IMPORTED_MODULE_1__[\"Coordinate\"]) {\r\n        return obj.clone();\r\n    }\r\n    // Handle Date\r\n    if (obj instanceof Date) {\r\n        copy = new Date();\r\n        copy.setTime(obj.getTime());\r\n        return copy;\r\n    }\r\n    // Handle Array\r\n    if (obj instanceof Array) {\r\n        copy = [];\r\n        for (var i = 0, len = obj.length; i < len; i++) {\r\n            copy[i] = clone(obj[i]);\r\n        }\r\n        return copy;\r\n    }\r\n    // Handle Object\r\n    if (obj instanceof Object) {\r\n        copy = {};\r\n        for (var attr in obj) {\r\n            if (obj.hasOwnProperty(attr))\r\n                copy[attr] = clone(obj[attr]);\r\n        }\r\n        return copy;\r\n    }\r\n    throw new Error(\"Unable to copy obj! Its type isn't supported.\");\r\n}\r\nfunction getElementsOfEnum(enum_thing) {\r\n    let enum_numbers = [];\r\n    for (let enum_item in enum_thing) {\r\n        if (!(isNaN(Number(enum_item)))) {\r\n            let enum_number = Number(enum_item);\r\n            enum_numbers.push(enum_number);\r\n        }\r\n    }\r\n    return enum_numbers;\r\n}\r\nfunction getRandomInt(a, b) {\r\n    // return random integer [A, B]\r\n    return Math.floor(rot_js__WEBPACK_IMPORTED_MODULE_0__[\"RNG\"].getUniform() * (b - a + 1)) + a;\r\n}\r\n// enum DiffOrUnion {\r\n//     Diff,\r\n//     Union\r\n// }\r\n// function runDiffAndUnion(which: DiffOrUnion, list_a: Array<Brew.Coordinate>, list_b: Array<Brew.Coordinate>) : Array<Brew.Coordinate> {\r\n//     let key_fn = (value, index, array) : number => { return xyToKey(value) }\r\n//     let keys_a : Array<number> = list_a.map(key_fn)\r\n//     let keys_b : Array<number> = list_b.map(key_fn)\r\n//     let keys_diff : Array<number> = []\r\n//     let keys_union : Array<number> = []\r\n//     keys_a.forEach((value, index, array) => {\r\n//         if (keys_b.indexOf(value) > -1) {\r\n//             keys_union.push(value)\r\n//         } else {\r\n//             keys_diff.push(value)\r\n//         }\r\n//     })\r\n//     // console.log(`{0} new keys`, keys_diff.length)\r\n//     keys_b.forEach((value, index, array) => {\r\n//         if (keys_union.indexOf(value) > -1) {\r\n//             // skip\r\n//             ;\r\n//         } else {\r\n//             keys_diff.push(value)\r\n//         }\r\n//     })\r\n//     // console.log(`{0} new keys`, keys_diff.length)\r\n//     if (which == DiffOrUnion.Diff) {\r\n//         let xy_diff : Array<Brew.Coordinate> = keys_diff.map((value, index, array) : Brew.Coordinate => {\r\n//             return keyToXY(value)\r\n//         })\r\n//         return xy_diff\r\n//     } else {\r\n//         let xy_union : Array<Brew.Coordinate> = keys_union.map((value, index, array) : Brew.Coordinate => {\r\n//             return keyToXY(value)\r\n//         })\r\n//         return xy_union\r\n//     }\r\n// }\r\n// export function diffOfCoordinateArrays(list_a: Array<Brew.Coordinate>, list_b: Array<Brew.Coordinate>) : Array<Brew.Coordinate> {\r\n//     // return elements of A not in B and B not in A\r\n//     return runDiffAndUnion(DiffOrUnion.Diff, list_a, list_b)\r\n// }\r\n// export function unionOfCoordinateArrays(list_a: Array<Brew.Coordinate>, list_b: Array<Brew.Coordinate>) : Array<Brew.Coordinate> {\r\n//     // return elements of A + B\r\n//     return runDiffAndUnion(DiffOrUnion.Union, list_a, list_b)\r\n// }\r\nfunction getDirectionFromKeycode(keycode) {\r\n    let direction_xy;\r\n    if (_brew__WEBPACK_IMPORTED_MODULE_1__[\"KeyMap\"].MoveForward.indexOf(keycode) > -1) {\r\n        direction_xy = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Directions\"].UP;\r\n    }\r\n    else if (_brew__WEBPACK_IMPORTED_MODULE_1__[\"KeyMap\"].MoveBackward.indexOf(keycode) > -1) {\r\n        direction_xy = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Directions\"].DOWN;\r\n    }\r\n    else if (_brew__WEBPACK_IMPORTED_MODULE_1__[\"KeyMap\"].RotateBodyCW.indexOf(keycode) > -1) {\r\n        direction_xy = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Directions\"].RIGHT;\r\n    }\r\n    else if (_brew__WEBPACK_IMPORTED_MODULE_1__[\"KeyMap\"].RotateBodyCCW.indexOf(keycode) > -1) {\r\n        direction_xy = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Directions\"].LEFT;\r\n    }\r\n    else {\r\n        return null;\r\n    }\r\n    return direction_xy;\r\n}\r\nfunction dist2d(from_xy, to_xy) {\r\n    let xdiff = (from_xy.x - to_xy.x);\r\n    let ydiff = (from_xy.y - to_xy.y);\r\n    return Math.sqrt(xdiff * xdiff + ydiff * ydiff);\r\n}\r\nfunction isInteger(value) {\r\n    return typeof value === 'number' &&\r\n        isFinite(value) &&\r\n        Math.floor(value) === value;\r\n}\r\nfunction getLineBetweenPoints(start_xy, end_xy) {\r\n    // uses bresenham's line algorithm\r\n    if ((!(start_xy)) || (!(end_xy))) {\r\n        console.error(\"invalid coords passed to getLineBetweenPoints\");\r\n    }\r\n    let non_integer = [start_xy.x, start_xy.y, end_xy.x, end_xy.y].some((coord_value) => {\r\n        return (!(isInteger(coord_value)));\r\n    });\r\n    if (non_integer) {\r\n        console.error(\"non-integer coordinates passed in\");\r\n    }\r\n    // Bresenham's line algorithm\r\n    let x0 = start_xy.x;\r\n    let y0 = start_xy.y;\r\n    let x1 = end_xy.x;\r\n    let y1 = end_xy.y;\r\n    let dy = y1 - y0;\r\n    let dx = x1 - x0;\r\n    let t = 0.5;\r\n    let points_lst = [new _brew__WEBPACK_IMPORTED_MODULE_1__[\"Coordinate\"](x0, y0)];\r\n    let m;\r\n    if (start_xy.compare(end_xy)) {\r\n        return points_lst;\r\n    }\r\n    if (Math.abs(dx) > Math.abs(dy)) {\r\n        m = dy / (1.0 * dx);\r\n        t += y0;\r\n        if (dx < 0) {\r\n            dx = -1;\r\n        }\r\n        else {\r\n            dx = 1;\r\n        }\r\n        m *= dx;\r\n        while (x0 != x1) {\r\n            x0 += dx;\r\n            t += m;\r\n            // points_lst.push({x: x0, y: Math.floor(t)}) # Coordinates(x0, int(t)))\r\n            points_lst.push(new _brew__WEBPACK_IMPORTED_MODULE_1__[\"Coordinate\"](x0, Math.floor(t)));\r\n        }\r\n    }\r\n    else {\r\n        m = dx / (1.0 * dy);\r\n        t += x0;\r\n        // dy = if (dy < 0) then -1 else 1\r\n        if (dy < 0) {\r\n            dy = -1;\r\n        }\r\n        else {\r\n            dy = 1;\r\n        }\r\n        m *= dy;\r\n        while (y0 != y1) {\r\n            y0 += dy;\r\n            t += m;\r\n            // points_lst.push({x: Math.floor(t), y: y0}) # Coordinates(int(t), y0))\r\n            points_lst.push(new _brew__WEBPACK_IMPORTED_MODULE_1__[\"Coordinate\"](Math.floor(t), y0));\r\n        }\r\n    }\r\n    return points_lst;\r\n}\r\nfunction getSquarePoints(center_xy, size) {\r\n    let points = [];\r\n    if (size <= 0) {\r\n        points.push(center_xy);\r\n    }\r\n    else {\r\n        let top_y = center_xy.y - size;\r\n        let bottom_y = center_xy.y + size;\r\n        let left_x = center_xy.x - size;\r\n        let right_x = center_xy.x + size;\r\n        // top and bottom (include corners)\r\n        for (let x = left_x; x <= right_x; x++) {\r\n            points.push(new _brew_components_coordinate__WEBPACK_IMPORTED_MODULE_2__[\"Coordinate\"](x, top_y));\r\n            points.push(new _brew_components_coordinate__WEBPACK_IMPORTED_MODULE_2__[\"Coordinate\"](x, bottom_y));\r\n        }\r\n        // left and right sides (exclude corners)\r\n        for (let y = top_y + 1; y < bottom_y; y++) {\r\n            points.push(new _brew_components_coordinate__WEBPACK_IMPORTED_MODULE_2__[\"Coordinate\"](left_x, y));\r\n            points.push(new _brew_components_coordinate__WEBPACK_IMPORTED_MODULE_2__[\"Coordinate\"](right_x, y));\r\n        }\r\n    }\r\n    return points;\r\n}\r\nfunction getCirclePoints(center_xy, radius) {\r\n    // Returns the points that make up the radius of a circle\r\n    // http://en.wikipedia.org/wiki/Midpoint_circle_algorithm\r\n    let x0 = center_xy.x;\r\n    let y0 = center_xy.y;\r\n    let point_lst = [];\r\n    let f = 1 - radius;\r\n    let ddF_x = 1;\r\n    let ddF_y = -2 * radius;\r\n    let x = 0;\r\n    let y = radius;\r\n    point_lst.push([x0, y0 + radius]);\r\n    point_lst.push([x0, y0 - radius]);\r\n    point_lst.push([x0 + radius, y0]);\r\n    point_lst.push([x0 - radius, y0]);\r\n    while (x < y) {\r\n        if (f >= 0) {\r\n            y -= 1;\r\n            ddF_y += 2;\r\n            f += ddF_y;\r\n        }\r\n        x += 1;\r\n        ddF_x += 2;\r\n        f += ddF_x;\r\n        point_lst.push([x0 + x, y0 + y]);\r\n        point_lst.push([x0 - x, y0 + y]);\r\n        point_lst.push([x0 + x, y0 - y]);\r\n        point_lst.push([x0 - x, y0 - y]);\r\n        point_lst.push([x0 + y, y0 + x]);\r\n        point_lst.push([x0 - y, y0 + x]);\r\n        point_lst.push([x0 + y, y0 - x]);\r\n        point_lst.push([x0 - y, y0 - x]);\r\n    }\r\n    let point_xy_lst = [];\r\n    point_lst.forEach((xy_arr, index, array) => {\r\n        point_xy_lst.push(new _brew_components_coordinate__WEBPACK_IMPORTED_MODULE_2__[\"Coordinate\"](xy_arr[0], xy_arr[1]));\r\n    });\r\n    return point_xy_lst;\r\n}\r\nfunction safe_color(rgb_val) {\r\n    return rgb_val.map((c, index) => {\r\n        return Math.floor(Math.max(0, Math.min(255, c)));\r\n    });\r\n}\r\nfunction getMonstersWithinRadius(level, center_xy, radius) {\r\n    let dist;\r\n    return level.monsters.getAllThings().filter((mob, index) => {\r\n        dist = dist2d(mob.location, center_xy);\r\n        return dist <= radius;\r\n    });\r\n}\r\nfunction getBlastArea(level, center_xy, radius) {\r\n    // constrains an area based on radius and blocking walls\r\n    let xy;\r\n    let terrain_at;\r\n    let fn_passable = (x, y) => {\r\n        xy = new _brew_components_coordinate__WEBPACK_IMPORTED_MODULE_2__[\"Coordinate\"](x, y);\r\n        if (!(level.isValid(xy))) {\r\n            return false;\r\n        }\r\n        if (xy.compare(center_xy)) {\r\n            return true;\r\n        }\r\n        terrain_at = level.terrain.getAt(xy);\r\n        return (!(terrain_at.blocks_flying));\r\n    };\r\n    let affected_list = [];\r\n    let fn_update = (x, y, r, intensity) => {\r\n        if (r <= radius) {\r\n            xy = new _brew_components_coordinate__WEBPACK_IMPORTED_MODULE_2__[\"Coordinate\"](x, y);\r\n            affected_list.push(xy);\r\n        }\r\n        return true;\r\n    };\r\n    let rot_fov = new rot_js__WEBPACK_IMPORTED_MODULE_0__[\"FOV\"].RecursiveShadowcasting(fn_passable, {});\r\n    rot_fov.compute(center_xy.x, center_xy.y, radius, fn_update);\r\n    let blast_area = new _brew__WEBPACK_IMPORTED_MODULE_1__[\"CoordinateArea\"](affected_list);\r\n    return blast_area;\r\n}\r\nfunction getMonstersWithinCoordinateArea(level, coord_area) {\r\n    let affected_mobs = [];\r\n    let monster_at;\r\n    coord_area.getCoordinates().forEach((xy) => {\r\n        monster_at = level.monsters.getAt(xy);\r\n        if (monster_at) {\r\n            affected_mobs.push(monster_at);\r\n        }\r\n    });\r\n    return affected_mobs;\r\n}\r\n// export function getMonstersWithinAffectedArea(level: Brew.Level, center_xy, radius: number) : Array<Brew.GridThings.Monster> { \r\n//     let affected_area = getBlastArea(level, center_xy, radius)\r\n//     let affected_mobs : Array<Brew.GridThings.Monster> = []\r\n//     let monster_at : Brew.GridThings.Monster\r\n//     affected_area.getCoordinates().forEach((xy: Coordinate) => {\r\n//         monster_at = level.monsters.getAt(xy)\r\n//         if (monster_at) {\r\n//             affected_mobs.push(monster_at)\r\n//         }\r\n//     })\r\n//     return affected_mobs\r\n// }\r\nfunction getPolarOffsetCoordinate(polar_theta, r_distance) {\r\n    // assuming from origin 0,0\r\n    let x = r_distance * Math.cos(polar_theta);\r\n    let y = r_distance * Math.sin(polar_theta);\r\n    x = roundToPrecision(x, 8);\r\n    y = roundToPrecision(y, 8);\r\n    let x_int = Math.floor(x);\r\n    let y_int = Math.floor(y);\r\n    let polar_xy = new _brew_components_coordinate__WEBPACK_IMPORTED_MODULE_2__[\"Coordinate\"](x_int, y_int);\r\n    return polar_xy;\r\n}\r\nfunction xyToPolar(xy, origin_xy) {\r\n    if (!(origin_xy)) {\r\n        origin_xy = new _brew_components_coordinate__WEBPACK_IMPORTED_MODULE_2__[\"Coordinate\"](0, 0);\r\n    }\r\n    let xdiff = xy.x - origin_xy.x;\r\n    let ydiff = xy.y - origin_xy.y;\r\n    let polar_r = Math.sqrt((xdiff * xdiff) + (ydiff * ydiff));\r\n    let polar_theta = Math.atan2(ydiff, xdiff);\r\n    return {\r\n        angle_theta: polar_theta,\r\n        dist_r: polar_r\r\n    };\r\n}\r\nfunction getTradjectoryCoordinate(origin_xy, target_xy, distance) {\r\n    // use polar coords to pick a distant tradjectory for a given target, based on an origination of force/blast/affect\r\n    // convert target to polar coordinate based on origin\r\n    let polar = xyToPolar(target_xy, origin_xy);\r\n    let polar_r = polar.dist_r;\r\n    let polar_theta = polar.angle_theta;\r\n    // extend radius\r\n    let new_r = polar_r + distance;\r\n    // re-calc relative x-y coord\r\n    // let relative_x = new_r * Math.cos(polar_theta)\r\n    // let relative_y = new_r * Math.sin(polar_theta)\r\n    // let rel_xy = new Coordinate(Math.floor(relative_x), Math.floor(relative_y))\r\n    let rel_xy = getPolarOffsetCoordinate(polar_theta, new_r);\r\n    // re-calc actual x-y coord\r\n    let new_xy = origin_xy.add(rel_xy);\r\n    return new_xy;\r\n}\r\nfunction intersectionOfCoordinateLists(coords_a, coords_b) {\r\n    let intersection = [];\r\n    // convert both arrays to number keys\r\n    let keys_a = coords_a.map((xy) => { return xyToKey(xy); });\r\n    let keys_b = coords_b.map((xy) => { return xyToKey(xy); });\r\n    let intersect_keys = keys_a.filter((key_a) => {\r\n        return (keys_b.indexOf(key_a) > -1);\r\n    });\r\n    intersection = intersect_keys.map((key) => { return keyToXY(key); });\r\n    return intersection;\r\n}\r\nfunction isCoordinateInListOfCoordinates(xy, coords_a) {\r\n    return (intersectionOfCoordinateLists([xy], coords_a).length > 0);\r\n}\r\nfunction roundToPrecision(value, decimals) {\r\n    let amount = Math.pow(10, decimals);\r\n    return Math.round(value * amount) / amount;\r\n}\r\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvYnJld19jb21wb25lbnRzL3V0aWxzLnRzPzA4ZDQiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBNkI7QUFDRTtBQUMyQjtBQUUxRCxJQUFJLE9BQU8sR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLDBDQUFPLENBQUMsVUFBVSxFQUFFLEdBQUcsR0FBRyxDQUFDLEdBQUcsQ0FBQztBQUNsRDtJQUNGLE9BQU8sSUFBSSxDQUFDO0lBQ1osTUFBTSxDQUFDLE9BQU87QUFDbEIsQ0FBQztBQU9ELGdEQUFnRDtBQUUxQyxpQkFBa0IsRUFBYztJQUNsQyxNQUFNLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxHQUFHLDRDQUFXLENBQUMsYUFBYSxDQUFDLEdBQUcsRUFBRSxDQUFDLENBQUM7QUFDcEQsQ0FBQztBQUVLLGlCQUFrQixHQUFXO0lBQy9CLE1BQU0sQ0FBQyxJQUFJLHNFQUFVLENBQUMsR0FBRyxHQUFHLDRDQUFXLENBQUMsYUFBYSxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxHQUFHLDRDQUFXLENBQUMsYUFBYSxDQUFDLENBQUM7QUFDdkcsQ0FBQztBQUVLLHNCQUF1QixDQUFVLEVBQUUsQ0FBUztJQUM5QyxNQUFNLENBQUMsQ0FBQyxDQUFDLEdBQUcsNENBQVcsQ0FBQyxhQUFhLENBQUMsR0FBRyxDQUFDO0FBQzlDLENBQUM7QUFFSyxzQkFBdUIsR0FBVztJQUNwQyx1Q0FBdUM7SUFDdkMsbUJBQW1CO0lBQ25CLE1BQU0sQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBa0IsRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLEVBQUUsR0FBRyxNQUFNLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQyxFQUFDLENBQUMsQ0FBQztBQUN2RyxDQUFDO0FBRUssa0JBQW1CLFVBQXNCLEVBQUUsU0FBbUIs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R0FBRyxDQUFDLEdBQUMsQ0FBQztJQUVsRSxNQUFNLENBQUMsWUFBWTtBQUN2QixDQUFDO0FBRUsseUNBQTBDLEVBQWMsRUFBRSxRQUEyQjtJQUN2RixNQUFNLENBQUMsQ0FBQyw2QkFBNkIsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLFFBQVEsQ0FBQyxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUM7QUFDckUsQ0FBQztBQUVLLDBCQUEyQixLQUFhLEVBQUUsUUFBZ0I7SUFDNUQsSUFBSSxNQUFNLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLEVBQUUsUUFBUSxDQUFDO0lBRW5DLE1BQU0sQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLEtBQUssR0FBRyxNQUFNLENBQUMsR0FBRyxNQUFNO0FBQzlDLENBQUMiLCJmaWxlIjoiLi9zcmMvYnJld19jb21wb25lbnRzL3V0aWxzLnRzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgUk9UIGZyb20gJ3JvdC1qcydcclxuaW1wb3J0ICogYXMgQnJldyBmcm9tICcuLi9icmV3J1xyXG5pbXBvcnQgeyBDb29yZGluYXRlIH0gZnJvbSAnLi4vYnJld19jb21wb25lbnRzL2Nvb3JkaW5hdGUnXHJcblxyXG5sZXQgaW5pdF9pZCA9IE1hdGguZmxvb3IoUk9ULlJORy5nZXRVbmlmb3JtKCkgKiA5OTkpICsgMVxyXG5leHBvcnQgZnVuY3Rpb24gZ2VuZXJhdGVJRCgpIDogbnVtYmVyIHtcclxuICAgIGluaXRfaWQgKz0gMVxyXG4gICAgcmV0dXJuIGluaXRfaWRcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBEaWN0PFQ+IHtcclxuICAgIFtrZXk6IG51bWJlcl06IFRcclxufVxyXG5cclxuXHJcbi8vIGxldCBNQVhfR1JJRF9TSVpFID0gQnJldy5Db25maWcuTUFYX0dSSURfU0laRVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHh5VG9LZXkoeHk6IENvb3JkaW5hdGUpIDogbnVtYmVyIHtcclxuICAgIHJldHVybiAoeHkueSAqIEJyZXcuQ29uZmlnLk1BWF9HUklEX1NJWkUpICsgeHkueFxyXG59IFxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGtleVRvWFkoa2V5OiBudW1iZXIpIDogQ29vcmRpbmF0ZSB7XHJcbiAgICByZXR1cm4gbmV3IENvb3JkaW5hdGUoa2V5ICUgQnJldy5Db25maWcuTUFYX0dSSURfU0laRSwgTWF0aC5mbG9vcihrZXkgLyBCcmV3LkNvbmZpZy5NQVhfR1JJRF9TSVpFKSlcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHhfYW5kX3lUb0tleSh4IDogbnVtYmVyLCB5OiBudW1iZXIpIDogbnVtYmVyIHtcclxuICAgIHJldHVybiAoeSAqIEJyZXcuQ29uZmlnLk1BWF9HUklEX1NJWkUpICsgeFxyXG59IFxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGFkamFjZW50S2V5cyhrZXk6IG51bWJlcikgOiBudW1iZXJbXSB7XHJcbiAgICAvLyByZXR1cm5zIGtleXMgb2YgNCBhZGphY2VudCB4eSBjb29yZHNcclxuICAgIC8vIFRPRE86IGNhY2hlIHRoaXNcclxuICAgIHJldHVybiBrZXlUb1hZKGtleSkuZ2V0QWRqYWNlbnQoKS5tYXAoKHh5OkJyZXcuQ29vcmRpbmF0ZSwgaW5kZXgsIGFycmF5KSA9PiB7IHJldHVybiB4eVRvS2V5KHh5KSB9KVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcmFuZG9tT2Yoc29tZV9hcnJheTogQXJyYXk8YW55PiwgdXNlUk9UIDogYm9vbGVhbiA9IHRydWUpIDogYW55IHtcclxuICAgIGlmICghKHNvbWVfYXJyYXkubGVuZ3RoKSkgeyByZXR1cm4gbnVsbCB9XHJcbiAgICBpZiAodXNlUk9UKSB7XHJcbiAgICAgICAgcmV0dXJuIHNvbWVfYXJyYXlbTWF0aC5mbG9vcihST1QuUk5HLmdldFVuaWZvcm0oKSAqIHNvbWVfYXJyYXkubGVuZ3RoKV1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIHNvbWVfYXJyYXlbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogc29tZV9hcnJheS5sZW5ndGgpXVxyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcmFuZG9taXplKHNvbWVfYXJyYXk6IEFycmF5PGFueT4sIHVzZVJPVCA6IGJvb2xlYW4gPSB0cnVlKSA6IEFycmF5PGFueT4ge1xyXG4gICAgbGV0IHJlc3VsdCA9IFtdXHJcbiAgICB3aGlsZSAoc29tZV9hcnJheS5sZW5ndGgpIHtcclxuICAgICAgICBsZXQgaW5kZXggPSBzb21lX2FycmF5LmluZGV4T2YocmFuZG9tT2Yoc29tZV9hcnJheSwgdXNlUk9UKSlcclxuICAgICAgICByZXN1bHQucHVzaChzb21lX2FycmF5LnNwbGljZShpbmRleCwgMSlbMF0pXHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJldHVybiByZXN1bHRcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHJlbW92ZShhcnI6IEFycmF5PGFueT4sIGVsZW1lbnQ6IGFueSkgOiB2b2lkIHtcclxuICAgIGxldCBpbmRleCA9IGFyci5pbmRleE9mKGVsZW1lbnQpXHJcbiAgICBpZiAoaW5kZXggPiAtMSkge1xyXG4gICAgICAgIGFyci5zcGxpY2UoaW5kZXgsIDEpXHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBtb2QobTogbnVtYmVyLCBuOiBudW1iZXIpIDogbnVtYmVyIHtcclxuICAgIHJldHVybiAoKG0gJSBuKSArIG4pICUgblxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY2xvbmUob2JqKSB7XHJcbiAgICAvLyBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy83MjgzNjAvbW9zdC1lbGVnYW50LXdheS10by1jbG9uZS1hLWphdmFzY3JpcHQtb2JqZWN0XHJcbiAgICB2YXIgY29weTtcclxuXHJcbiAgICAvLyBIYW5kbGUgdGhlIDMgc2ltcGxlIHR5cGVzLCBhbmQgbnVsbCBvciB1bmRlZmluZWRcclxuICAgIGlmIChudWxsID09IG9iaiB8fCBcIm9iamVjdFwiICE9IHR5cGVvZiBvYmopIHJldHVybiBvYmo7XHJcblxyXG4gICAgLy8gaGFuZGxlIGNvb3Jkc1xyXG4gICAgaWYgKG9iaiBpbnN0YW5jZW9mIEJyZXcuQ29vcmRpbmF0ZSkge1xyXG4gICAgICAgIHJldHVybiBvYmouY2xvbmUoKVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBIYW5kbGUgRGF0ZVxyXG4gICAgaWYgKG9iaiBpbnN0YW5jZW9mIERhdGUpIHtcclxuICAgICAgICBjb3B5ID0gbmV3IERhdGUoKTtcclxuICAgICAgICBjb3B5LnNldFRpbWUob2JqLmdldFRpbWUoKSk7XHJcbiAgICAgICAgcmV0dXJuIGNvcHk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gSGFuZGxlIEFycmF5XHJcbiAgICBpZiAob2JqIGluc3RhbmNlb2YgQXJyYXkpIHtcclxuICAgICAgICBjb3B5ID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IG9iai5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICAgICAgICBjb3B5W2ldID0gY2xvbmUob2JqW2ldKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGNvcHk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gSGFuZGxlIE9iamVjdFxyXG4gICAgaWYgKG9iaiBpbnN0YW5jZW9mIE9iamVjdCkge1xyXG4gICAgICAgIGNvcHkgPSB7fTtcclxuICAgICAgICBmb3IgKHZhciBhdHRyIGluIG9iaikge1xyXG4gICAgICAgICAgICBpZiAob2JqLmhhc093blByb3BlcnR5KGF0dHIpKSBjb3B5W2F0dHJdID0gY2xvbmUob2JqW2F0dHJdKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGNvcHk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhyb3cgbmV3IEVycm9yKFwiVW5hYmxlIHRvIGNvcHkgb2JqISBJdHMgdHlwZSBpc24ndCBzdXBwb3J0ZWQuXCIpO1xyXG59XHJcblxyXG5cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRFbGVtZW50c09mRW51bShlbnVtX3RoaW5nOiBhbnkpIDogbnVtYmVyW10ge1xyXG4gICAgbGV0IGVudW1fbnVtYmVycyA6IG51bWJlcltdID0gW11cclxuICAgIGZvciAobGV0IGVudW1faXRlbSBpbiBlbnVtX3RoaW5nKSB7XHJcbiAgICAgICAgaWYgKCEoaXNOYU4oTnVtYmVyKGVudW1faXRlbSkpKSkge1xyXG4gICAgICAgICAgICBsZXQgZW51bV9udW1iZXIgOiBudW1iZXIgPSBOdW1iZXIoZW51bV9pdGVtKVxyXG4gICAgICAgICAgICBlbnVtX251bWJlcnMucHVzaChlbnVtX251bWJlcilcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZW51bV9udW1iZXJzXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRSYW5kb21JbnQoYTogbnVtYmVyLCBiOiBudW1iZXIpIDogbnVtYmVyIHtcclxuICAgIC8vIHJldHVybiByYW5kb20gaW50ZWdlciBbQSwgQl1cclxuICAgIHJldHVybiBNYXRoLmZsb29yKFJPVC5STkcuZ2V0VW5pZm9ybSgpICogKGIgLSBhICsgMSkpICsgYVxyXG59XHJcblxyXG4vLyBlbnVtIERpZmZPclVuaW9uIHtcclxuLy8gICAgIERpZmYsXHJcbi8vICAgICBVbmlvblxyXG4vLyB9XHJcblxyXG4vLyBmdW5jdGlvbiBydW5EaWZmQW5kVW5pb24od2hpY2g6IERpZmZPclVuaW9uLCBsaXN0X2E6IEFycmF5PEJyZXcuQ29vcmRpbmF0ZT4sIGxpc3RfYjogQXJyYXk8QnJldy5Db29yZGluYXRlPikgOiBBcnJheTxCcmV3LkNvb3JkaW5hdGU+IHtcclxuLy8gICAgIGxldCBrZXlfZm4gPSAodmFsdWUsIGluZGV4LCBhcnJheSkgOiBudW1iZXIgPT4geyByZXR1cm4geHlUb0tleSh2YWx1ZSkgfVxyXG4vLyAgICAgbGV0IGtleXNfYSA6IEFycmF5PG51bWJlcj4gPSBsaXN0X2EubWFwKGtleV9mbilcclxuLy8gICAgIGxldCBrZXlzX2IgOiBBcnJheTxudW1iZXI+ID0gbGlzdF9iLm1hcChrZXlfZm4pXHJcbiAgICBcclxuLy8gICAgIGxldCBrZXlzX2RpZmYgOiBBcnJheTxudW1iZXI+ID0gW11cclxuLy8gICAgIGxldCBrZXlzX3VuaW9uIDogQXJyYXk8bnVtYmVyPiA9IFtdXHJcbiAgICBcclxuLy8gICAgIGtleXNfYS5mb3JFYWNoKCh2YWx1ZSwgaW5kZXgsIGFycmF5KSA9PiB7XHJcbi8vICAgICAgICAgaWYgKGtleXNfYi5pbmRleE9mKHZhbHVlKSA+IC0xKSB7XHJcbi8vICAgICAgICAgICAgIGtleXNfdW5pb24ucHVzaCh2YWx1ZSlcclxuLy8gICAgICAgICB9IGVsc2Uge1xyXG4vLyAgICAgICAgICAgICBrZXlzX2RpZmYucHVzaCh2YWx1ZSlcclxuLy8gICAgICAgICB9XHJcbi8vICAgICB9KVxyXG4vLyAgICAgLy8gY29uc29sZS5sb2coYHswfSBuZXcga2V5c2AsIGtleXNfZGlmZi5sZW5ndGgpXHJcbiAgICBcclxuLy8gICAgIGtleXNfYi5mb3JFYWNoKCh2YWx1ZSwgaW5kZXgsIGFycmF5KSA9PiB7XHJcbi8vICAgICAgICAgaWYgKGtleXNfdW5pb24uaW5kZXhPZih2YWx1ZSkgPiAtMSkge1xyXG4vLyAgICAgICAgICAgICAvLyBza2lwXHJcbi8vICAgICAgICAgICAgIDtcclxuLy8gICAgICAgICB9IGVsc2Uge1xyXG4vLyAgICAgICAgICAgICBrZXlzX2RpZmYucHVzaCh2YWx1ZSlcclxuLy8gICAgICAgICB9XHJcbi8vICAgICB9KVxyXG4vLyAgICAgLy8gY29uc29sZS5sb2coYHswfSBuZXcga2V5c2AsIGtleXNfZGlmZi5sZW5ndGgpXHJcbiAgICBcclxuLy8gICAgIGlmICh3aGljaCA9PSBEaWZmT3JVbmlvbi5EaWZmKSB7XHJcbi8vICAgICAgICAgbGV0IHh5X2RpZmYgOiBBcnJheTxCcmV3LkNvb3JkaW5hdGU+ID0ga2V5c19kaWZmLm1hcCgodmFsdWUsIGluZGV4LCBhcnJheSkgOiBCcmV3LkNvb3JkaW5hdGUgPT4ge1xyXG4vLyAgICAgICAgICAgICByZXR1cm4ga2V5VG9YWSh2YWx1ZSlcclxuLy8gICAgICAgICB9KVxyXG5cclxuLy8gICAgICAgICByZXR1cm4geHlfZGlmZlxyXG4gICAgICAgIFxyXG4vLyAgICAgfSBlbHNlIHtcclxuLy8gICAgICAgICBsZXQgeHlfdW5pb24gOiBBcnJheTxCcmV3LkNvb3JkaW5hdGU+ID0ga2V5c191bmlvbi5tYXAoKHZhbHVlLCBpbmRleCwgYXJyYXkpIDogQnJldy5Db29yZGluYXRlID0+IHtcclxuLy8gICAgICAgICAgICAgcmV0dXJuIGtleVRvWFkodmFsdWUpXHJcbi8vICAgICAgICAgfSlcclxuXHJcbi8vICAgICAgICAgcmV0dXJuIHh5X3VuaW9uXHJcbi8vICAgICB9XHJcbiAgICBcclxuLy8gfVxyXG5cclxuLy8gZXhwb3J0IGZ1bmN0aW9uIGRpZmZPZkNvb3JkaW5hdGVBcnJheXMobGlzdF9hOiBBcnJheTxCcmV3LkNvb3JkaW5hdGU+LCBsaXN0X2I6IEFycmF5PEJyZXcuQ29vcmRpbmF0ZT4pIDogQXJyYXk8QnJldy5Db29yZGluYXRlPiB7XHJcbi8vICAgICAvLyByZXR1cm4gZWxlbWVudHMgb2YgQSBub3QgaW4gQiBhbmQgQiBub3QgaW4gQVxyXG4vLyAgICAgcmV0dXJuIHJ1bkRpZmZBbmRVbmlvbihEaWZmT3JVbmlvbi5EaWZmLCBsaXN0X2EsIGxpc3RfYilcclxuLy8gfVxyXG5cclxuLy8gZXhwb3J0IGZ1bmN0aW9uIHVuaW9uT2ZDb29yZGluYXRlQXJyYXlzKGxpc3RfYTogQXJyYXk8QnJldy5Db29yZGluYXRlPiwgbGlzdF9iOiBBcnJheTxCcmV3LkNvb3JkaW5hdGU+KSA6IEFycmF5PEJyZXcuQ29vcmRpbmF0ZT4ge1xyXG4vLyAgICAgLy8gcmV0dXJuIGVsZW1lbnRzIG9mIEEgKyBCXHJcbi8vICAgICByZXR1cm4gcnVuRGlmZkFuZFVuaW9uKERpZmZPclVuaW9uLlVuaW9uLCBsaXN0X2EsIGxpc3RfYilcclxuLy8gfVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldERpcmVjdGlvbkZyb21LZXljb2RlKGtleWNvZGU6IG51bWJlcik6IEJyZXcuQ29vcmRpbmF0ZSB7XHJcbiAgICBsZXQgZGlyZWN0aW9uX3h5OiBCcmV3LkNvb3JkaW5hdGVcclxuICAgIFxyXG4gICAgaWYgKEJyZXcuS2V5TWFwLk1vdmVGb3J3YXJkLmluZGV4T2Yoa2V5Y29kZSkgPiAtMSkge1xyXG4gICAgICAgIGRpcmVjdGlvbl94eSA9IEJyZXcuRGlyZWN0aW9ucy5VUFxyXG4gICAgfSBlbHNlIGlmIChCcmV3LktleU1hcC5Nb3ZlQmFja3dhcmQuaW5kZXhPZihrZXljb2RlKSA+IC0xKSB7XHJcbiAgICAgICAgZGlyZWN0aW9uX3h5ID0gQnJldy5EaXJlY3Rpb25zLkRPV05cclxuICAgIH0gZWxzZSBpZiAoQnJldy5LZXlNYXAuUm90YXRlQm9keUNXLmluZGV4T2Yoa2V5Y29kZSkgPiAtMSkge1xyXG4gICAgICAgIGRpcmVjdGlvbl94eSA9IEJyZXcuRGlyZWN0aW9ucy5SSUdIVFxyXG4gICAgfSBlbHNlIGlmIChCcmV3LktleU1hcC5Sb3RhdGVCb2R5Q0NXLmluZGV4T2Yoa2V5Y29kZSkgPiAtMSkge1xyXG4gICAgICAgIGRpcmVjdGlvbl94eSA9IEJyZXcuRGlyZWN0aW9ucy5MRUZUXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBudWxsXHJcbiAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgcmV0dXJuIGRpcmVjdGlvbl94eVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZGlzdDJkKGZyb21feHk6IENvb3JkaW5hdGUsIHRvX3h5OiBDb29yZGluYXRlKSA6IG51bWJlciB7XHJcbiAgICBsZXQgeGRpZmYgPSAoZnJvbV94eS54IC0gdG9feHkueClcclxuICAgIGxldCB5ZGlmZiA9IChmcm9tX3h5LnkgLSB0b194eS55KVxyXG4gICAgXHJcbiAgICByZXR1cm4gTWF0aC5zcXJ0KHhkaWZmKnhkaWZmICsgeWRpZmYqeWRpZmYpXHJcbn1cclxuXHJcbmZ1bmN0aW9uIGlzSW50ZWdlciAodmFsdWU6IG51bWJlcikgOiBib29sZWFuIHtcclxuICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInICYmIFxyXG4gICAgICAgIGlzRmluaXRlKHZhbHVlKSAmJiBcclxuICAgICAgICBNYXRoLmZsb29yKHZhbHVlKSA9PT0gdmFsdWVcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldExpbmVCZXR3ZWVuUG9pbnRzIChzdGFydF94eTogQnJldy5Db29yZGluYXRlLCBlbmRfeHk6IEJyZXcuQ29vcmRpbmF0ZSkgOiBBcnJheTxCcmV3LkNvb3JkaW5hdGU+IHsgXHJcbiAgICAvLyB1c2VzIGJyZXNlbmhhbSdzIGxpbmUgYWxnb3JpdGhtXHJcblxyXG4gICAgaWYgKCghKHN0YXJ0X3h5KSkgfHwgKCEoZW5kX3h5KSkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwiaW52YWxpZCBjb29yZHMgcGFzc2VkIHRvIGdldExpbmVCZXR3ZWVuUG9pbnRzXCIpXHJcbiAgICB9XHJcblxyXG4gICAgbGV0IG5vbl9pbnRlZ2VyID0gW3N0YXJ0X3h5LngsIHN0YXJ0X3h5LnksIGVuZF94eS54LCBlbmRfeHkueV0uc29tZSgoY29vcmRfdmFsdWU6IG51bWJlcikgPT4ge1xyXG4gICAgICAgIHJldHVybiAoIShpc0ludGVnZXIoY29vcmRfdmFsdWUpKSlcclxuICAgIH0pXHJcblxyXG4gICAgaWYgKG5vbl9pbnRlZ2VyKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcIm5vbi1pbnRlZ2VyIGNvb3JkaW5hdGVzIHBhc3NlZCBpblwiKVxyXG4gICAgfVxyXG4gICAgICAgIFxyXG4gICAgLy8gQnJlc2VuaGFtJ3MgbGluZSBhbGdvcml0aG1cclxuICAgIGxldCB4MCA6IG51bWJlciA9IHN0YXJ0X3h5LnhcclxuICAgIGxldCB5MCA6IG51bWJlciA9IHN0YXJ0X3h5LnlcclxuICAgIGxldCB4MSA6IG51bWJlciA9IGVuZF94eS54XHJcbiAgICBsZXQgeTEgOiBudW1iZXIgPSBlbmRfeHkueVxyXG5cclxuICAgIGxldCBkeSA9IHkxIC0geTBcclxuICAgIGxldCBkeCA9IHgxIC0geDBcclxuICAgIGxldCB0ID0gMC41XHJcbiAgICBsZXQgcG9pbnRzX2xzdCA9IFtuZXcgQnJldy5Db29yZGluYXRlKHgwLCB5MCldXHJcbiAgICBsZXQgbSA6IG51bWJlclxyXG4gICAgXHJcbiAgICBpZiAoc3RhcnRfeHkuY29tcGFyZShlbmRfeHkpKSB7XHJcbiAgICAgICAgcmV0dXJuIHBvaW50c19sc3RcclxuICAgIH1cclxuICAgIFxyXG4gICAgaWYgKE1hdGguYWJzKGR4KSA+IE1hdGguYWJzKGR5KSkge1xyXG4gICAgICAgIG0gPSBkeSAvICgxLjAgKiBkeClcclxuICAgICAgICB0ICs9IHkwXHJcbiAgICAgICAgaWYgKGR4IDwgMCkge1xyXG4gICAgICAgICAgICBkeCA9IC0xXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZHggPSAxXHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIG0gKj0gZHhcclxuXHJcbiAgICAgICAgd2hpbGUgKHgwICE9IHgxKSB7XHJcbiAgICAgICAgICAgIHgwICs9IGR4XHJcbiAgICAgICAgICAgIHQgKz0gbVxyXG4gICAgICAgICAgICAvLyBwb2ludHNfbHN0LnB1c2goe3g6IHgwLCB5OiBNYXRoLmZsb29yKHQpfSkgIyBDb29yZGluYXRlcyh4MCwgaW50KHQpKSlcclxuICAgICAgICAgICAgcG9pbnRzX2xzdC5wdXNoKG5ldyBCcmV3LkNvb3JkaW5hdGUoeDAsIE1hdGguZmxvb3IodCkpKVxyXG4gICAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgbSA9IGR4IC8gKDEuMCAqIGR5KVxyXG4gICAgICAgIHQgKz0geDBcclxuICAgICAgICBcclxuICAgICAgICAvLyBkeSA9IGlmIChkeSA8IDApIHRoZW4gLTEgZWxzZSAxXHJcbiAgICAgICAgaWYgKGR5IDwgMCkge1xyXG4gICAgICAgICAgICBkeSA9IC0xIFxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGR5ID0gMVxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBtICo9IGR5XHJcbiAgICAgICAgXHJcbiAgICAgICAgd2hpbGUgKHkwICE9IHkxKSB7XHJcbiAgICAgICAgICAgIHkwICs9IGR5XHJcbiAgICAgICAgICAgIHQgKz0gbVxyXG4gICAgICAgICAgICAvLyBwb2ludHNfbHN0LnB1c2goe3g6IE1hdGguZmxvb3IodCksIHk6IHkwfSkgIyBDb29yZGluYXRlcyhpbnQodCksIHkwKSlcclxuICAgICAgICAgICAgcG9pbnRzX2xzdC5wdXNoKG5ldyBCcmV3LkNvb3JkaW5hdGUoTWF0aC5mbG9vcih0KSwgeTApKVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuIHBvaW50c19sc3RcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldFNxdWFyZVBvaW50cyAoY2VudGVyX3h5OiBDb29yZGluYXRlLCBzaXplOiBudW1iZXIpOiBBcnJheTxDb29yZGluYXRlPiB7XHJcbiAgICBsZXQgcG9pbnRzIDogQXJyYXk8Q29vcmRpbmF0ZT4gPSBbXVxyXG5cclxuICAgIGlmIChzaXplIDw9IDApIHtcclxuICAgICAgICBwb2ludHMucHVzaChjZW50ZXJfeHkpXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGxldCB0b3BfeSA9IGNlbnRlcl94eS55IC0gc2l6ZVxyXG4gICAgICAgIGxldCBib3R0b21feSA9IGNlbnRlcl94eS55ICsgc2l6ZVxyXG4gICAgICAgIGxldCBsZWZ0X3ggPSBjZW50ZXJfeHkueCAtIHNpemVcclxuICAgICAgICBsZXQgcmlnaHRfeCA9IGNlbnRlcl94eS54ICsgc2l6ZVxyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIHRvcCBhbmQgYm90dG9tIChpbmNsdWRlIGNvcm5lcnMpXHJcbiAgICAgICAgZm9yIChsZXQgeCA9IGxlZnRfeDsgeCA8PSByaWdodF94OyB4KyspIHtcclxuICAgICAgICAgICAgcG9pbnRzLnB1c2gobmV3IENvb3JkaW5hdGUoeCwgdG9wX3kpKVxyXG4gICAgICAgICAgICBwb2ludHMucHVzaChuZXcgQ29vcmRpbmF0ZSh4LCBib3R0b21feSkpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBsZWZ0IGFuZCByaWdodCBzaWRlcyAoZXhjbHVkZSBjb3JuZXJzKVxyXG4gICAgICAgIGZvciAobGV0IHkgPSB0b3BfeSArIDE7IHkgPCBib3R0b21feTsgeSsrKSB7XHJcbiAgICAgICAgICAgIHBvaW50cy5wdXNoKG5ldyBDb29yZGluYXRlKGxlZnRfeCwgeSkpXHJcbiAgICAgICAgICAgIHBvaW50cy5wdXNoKG5ldyBDb29yZGluYXRlKHJpZ2h0X3gsIHkpKVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gcG9pbnRzXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRDaXJjbGVQb2ludHMgKGNlbnRlcl94eSA6IENvb3JkaW5hdGUsIHJhZGl1cyA6IG51bWJlcikgOiBDb29yZGluYXRlW10ge1xyXG4gICAgLy8gUmV0dXJucyB0aGUgcG9pbnRzIHRoYXQgbWFrZSB1cCB0aGUgcmFkaXVzIG9mIGEgY2lyY2xlXHJcbiAgICAvLyBodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL01pZHBvaW50X2NpcmNsZV9hbGdvcml0aG1cclxuICAgIGxldCB4MCA9IGNlbnRlcl94eS54XHJcbiAgICBsZXQgeTAgPSBjZW50ZXJfeHkueVxyXG4gICAgXHJcbiAgICBsZXQgcG9pbnRfbHN0ID0gW11cclxuICAgIFxyXG4gICAgbGV0IGYgPSAxIC0gcmFkaXVzXHJcbiAgICBsZXQgZGRGX3ggPSAxXHJcbiAgICBsZXQgZGRGX3kgPSAtMiAqIHJhZGl1c1xyXG4gICAgbGV0IHggPSAwXHJcbiAgICBsZXQgeSA9IHJhZGl1c1xyXG4gICAgXHJcbiAgICBwb2ludF9sc3QucHVzaChbeDAsIHkwICsgcmFkaXVzXSlcclxuICAgIHBvaW50X2xzdC5wdXNoKFt4MCwgeTAgLSByYWRpdXNdKVxyXG4gICAgcG9pbnRfbHN0LnB1c2goW3gwICsgcmFkaXVzLCB5MF0pXHJcbiAgICBwb2ludF9sc3QucHVzaChbeDAgLSByYWRpdXMsIHkwXSlcclxuICAgIFxyXG4gICAgd2hpbGUgKHggPCB5KSB7XHJcbiAgICAgICAgaWYgKGYgPj0gMCkge1xyXG4gICAgICAgICAgICB5IC09IDFcclxuICAgICAgICAgICAgZGRGX3kgKz0gMlxyXG4gICAgICAgICAgICBmICs9IGRkRl95XHJcbiAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICB4ICs9IDFcclxuICAgICAgICBkZEZfeCArPSAyXHJcbiAgICAgICAgZiArPSBkZEZfeFxyXG4gICAgICAgIHBvaW50X2xzdC5wdXNoKFt4MCArIHgsIHkwICsgeV0pXHJcbiAgICAgICAgcG9pbnRfbHN0LnB1c2goW3gwIC0geCwgeTAgKyB5XSlcclxuICAgICAgICBwb2ludF9sc3QucHVzaChbeDAgKyB4LCB5MCAtIHldKVxyXG4gICAgICAgIHBvaW50X2xzdC5wdXNoKFt4MCAtIHgsIHkwIC0geV0pXHJcbiAgICAgICAgcG9pbnRfbHN0LnB1c2goW3gwICsgeSwgeTAgKyB4XSlcclxuICAgICAgICBwb2ludF9sc3QucHVzaChbeDAgLSB5LCB5MCArIHhdKVxyXG4gICAgICAgIHBvaW50X2xzdC5wdXNoKFt4MCArIHksIHkwIC0geF0pXHJcbiAgICAgICAgcG9pbnRfbHN0LnB1c2goW3gwIC0geSwgeTAgLSB4XSlcclxuICAgIH1cclxuICAgICAgICBcclxuICAgIGxldCBwb2ludF94eV9sc3QgPSBbXVxyXG4gICAgcG9pbnRfbHN0LmZvckVhY2goKHh5X2FyciwgaW5kZXgsIGFycmF5KSA9PiB7XHJcbiAgICAgICAgcG9pbnRfeHlfbHN0LnB1c2gobmV3IENvb3JkaW5hdGUoeHlfYXJyWzBdLCB4eV9hcnJbMV0pKVxyXG4gICAgfSlcclxuXHJcbiAgICByZXR1cm4gcG9pbnRfeHlfbHN0XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBzYWZlX2NvbG9yKHJnYl92YWw6IG51bWJlcltdKSB7XHJcbiAgICByZXR1cm4gcmdiX3ZhbC5tYXAoKGM6IG51bWJlciwgaW5kZXg6IG51bWJlcikgPT4ge1xyXG4gICAgICAgIHJldHVybiBNYXRoLmZsb29yKE1hdGgubWF4KDAsIE1hdGgubWluKDI1NSwgYykpKVxyXG4gICAgfSlcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldE1vbnN0ZXJzV2l0aGluUmFkaXVzKGxldmVsOiBCcmV3LkxldmVsLCBjZW50ZXJfeHk6IENvb3JkaW5hdGUsIHJhZGl1czogbnVtYmVyKSA6IEFycmF5PEJyZXcuR3JpZFRoaW5ncy5Nb25zdGVyPiB7XHJcbiAgICBsZXQgZGlzdCA6IG51bWJlclxyXG4gICAgcmV0dXJuIGxldmVsLm1vbnN0ZXJzLmdldEFsbFRoaW5ncygpLmZpbHRlcigobW9iOiBCcmV3LkdyaWRUaGluZ3MuTW9uc3RlciwgaW5kZXg6IG51bWJlcikgPT4ge1xyXG4gICAgICAgIGRpc3QgPSBkaXN0MmQobW9iLmxvY2F0aW9uLCBjZW50ZXJfeHkpXHJcbiAgICAgICAgcmV0dXJuIGRpc3QgPD0gcmFkaXVzXHJcbiAgICB9KVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0Qmxhc3RBcmVhKGxldmVsOiBCcmV3LkxldmVsLCBjZW50ZXJfeHksIHJhZGl1czogbnVtYmVyKSA6IEJyZXcuQ29vcmRpbmF0ZUFyZWEge1xyXG4gICAgLy8gY29uc3RyYWlucyBhbiBhcmVhIGJhc2VkIG9uIHJhZGl1cyBhbmQgYmxvY2tpbmcgd2FsbHNcclxuXHJcbiAgICBsZXQgeHkgOiBDb29yZGluYXRlXHJcbiAgICBsZXQgdGVycmFpbl9hdCA6IEJyZXcuR3JpZFRoaW5ncy5UZXJyYWluXHJcblxyXG4gICAgbGV0IGZuX3Bhc3NhYmxlID0gKHg6IG51bWJlciwgeTogbnVtYmVyKSA9PiB7XHJcbiAgICAgICAgeHkgPSBuZXcgQ29vcmRpbmF0ZSh4LCB5KVxyXG5cclxuICAgICAgICBpZiAoIShsZXZlbC5pc1ZhbGlkKHh5KSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoeHkuY29tcGFyZShjZW50ZXJfeHkpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0ZXJyYWluX2F0ID0gbGV2ZWwudGVycmFpbi5nZXRBdCh4eSlcclxuICAgICAgICByZXR1cm4gKCEodGVycmFpbl9hdC5ibG9ja3NfZmx5aW5nKSlcclxuICAgIH1cclxuXHJcbiAgICBsZXQgYWZmZWN0ZWRfbGlzdCA6IEFycmF5PENvb3JkaW5hdGU+ID0gW11cclxuXHJcbiAgICBsZXQgZm5fdXBkYXRlID0gKHg6IG51bWJlciwgeTogbnVtYmVyLCByOiBudW1iZXIsIGludGVuc2l0eTogbnVtYmVyKSA9PiB7XHJcbiAgICAgICAgaWYgKHIgPD0gcmFkaXVzKSB7XHJcbiAgICAgICAgICAgIHh5ID0gbmV3IENvb3JkaW5hdGUoeCwgeSlcclxuICAgICAgICAgICAgYWZmZWN0ZWRfbGlzdC5wdXNoKHh5KVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgfVxyXG5cclxuICAgIGxldCByb3RfZm92ID0gbmV3IFJPVC5GT1YuUmVjdXJzaXZlU2hhZG93Y2FzdGluZyhmbl9wYXNzYWJsZSwge30pXHJcbiAgICByb3RfZm92LmNvbXB1dGUoY2VudGVyX3h5LngsIGNlbnRlcl94eS55LCByYWRpdXMsIGZuX3VwZGF0ZSkgXHJcblxyXG4gICAgbGV0IGJsYXN0X2FyZWEgPSBuZXcgQnJldy5Db29yZGluYXRlQXJlYShhZmZlY3RlZF9saXN0KVxyXG4gICAgcmV0dXJuIGJsYXN0X2FyZWFcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldE1vbnN0ZXJzV2l0aGluQ29vcmRpbmF0ZUFyZWEobGV2ZWw6IEJyZXcuTGV2ZWwsIGNvb3JkX2FyZWE6IEJyZXcuQ29vcmRpbmF0ZUFyZWEpIDogQXJyYXk8QnJldy5HcmlkVGhpbmdzLk1vbnN0ZXI+IHtcclxuICAgIGxldCBhZmZlY3RlZF9tb2JzIDogQXJyYXk8QnJldy5HcmlkVGhpbmdzLk1vbnN0ZXI+ID0gW11cclxuICAgIGxldCBtb25zdGVyX2F0IDogQnJldy5HcmlkVGhpbmdzLk1vbnN0ZXJcclxuICAgIGNvb3JkX2FyZWEuZ2V0Q29vcmRpbmF0ZXMoKS5mb3JFYWNoKCh4eSkgPT4ge1xyXG4gICAgICAgIG1vbnN0ZXJfYXQgPSBsZXZlbC5tb25zdGVycy5nZXRBdCh4eSlcclxuICAgICAgICBpZiAobW9uc3Rlcl9hdCkge1xyXG4gICAgICAgICAgICBhZmZlY3RlZF9tb2JzLnB1c2gobW9uc3Rlcl9hdClcclxuICAgICAgICB9XHJcbiAgICB9KVxyXG5cclxuICAgIHJldHVybiBhZmZlY3RlZF9tb2JzXHJcbn1cclxuXHJcbi8vIGV4cG9ydCBmdW5jdGlvbiBnZXRNb25zdGVyc1dpdGhpbkFmZmVjdGVkQXJlYShsZXZlbDogQnJldy5MZXZlbCwgY2VudGVyX3h5LCByYWRpdXM6IG51bWJlcikgOiBBcnJheTxCcmV3LkdyaWRUaGluZ3MuTW9uc3Rlcj4geyBcclxuLy8gICAgIGxldCBhZmZlY3RlZF9hcmVhID0gZ2V0Qmxhc3RBcmVhKGxldmVsLCBjZW50ZXJfeHksIHJhZGl1cylcclxuLy8gICAgIGxldCBhZmZlY3RlZF9tb2JzIDogQXJyYXk8QnJldy5HcmlkVGhpbmdzLk1vbnN0ZXI+ID0gW11cclxuLy8gICAgIGxldCBtb25zdGVyX2F0IDogQnJldy5HcmlkVGhpbmdzLk1vbnN0ZXJcclxuXHJcbi8vICAgICBhZmZlY3RlZF9hcmVhLmdldENvb3JkaW5hdGVzKCkuZm9yRWFjaCgoeHk6IENvb3JkaW5hdGUpID0+IHtcclxuLy8gICAgICAgICBtb25zdGVyX2F0ID0gbGV2ZWwubW9uc3RlcnMuZ2V0QXQoeHkpXHJcbi8vICAgICAgICAgaWYgKG1vbnN0ZXJfYXQpIHtcclxuLy8gICAgICAgICAgICAgYWZmZWN0ZWRfbW9icy5wdXNoKG1vbnN0ZXJfYXQpXHJcbi8vICAgICAgICAgfVxyXG4vLyAgICAgfSlcclxuXHJcbi8vICAgICByZXR1cm4gYWZmZWN0ZWRfbW9ic1xyXG4vLyB9XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0UG9sYXJPZmZzZXRDb29yZGluYXRlKHBvbGFyX3RoZXRhOiBudW1iZXIsIHJfZGlzdGFuY2U6IG51bWJlcikgOiBDb29yZGluYXRlIHtcclxuICAgIC8vIGFzc3VtaW5nIGZyb20gb3JpZ2luIDAsMFxyXG5cclxuICAgIGxldCB4ID0gcl9kaXN0YW5jZSAqIE1hdGguY29zKHBvbGFyX3RoZXRhKVxyXG4gICAgbGV0IHkgPSByX2Rpc3RhbmNlICogTWF0aC5zaW4ocG9sYXJfdGhldGEpXHJcbiAgICB4ID0gcm91bmRUb1ByZWNpc2lvbih4LCA4KVxyXG4gICAgeSA9IHJvdW5kVG9QcmVjaXNpb24oeSwgOClcclxuICAgIGxldCB4X2ludCA9IE1hdGguZmxvb3IoeClcclxuICAgIGxldCB5X2ludCA9IE1hdGguZmxvb3IoeSlcclxuXHJcbiAgICBsZXQgcG9sYXJfeHkgPSBuZXcgQ29vcmRpbmF0ZSh4X2ludCwgeV9pbnQpXHJcbiAgICByZXR1cm4gcG9sYXJfeHlcclxufVxyXG5pbnRlcmZhY2UgUG9sYXJDb29yZGluYXRlIHtcclxuICAgIGRpc3RfcjogbnVtYmVyLFxyXG4gICAgYW5nbGVfdGhldGE6IG51bWJlcixcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHh5VG9Qb2xhciAoeHk6IENvb3JkaW5hdGUsIG9yaWdpbl94eT86IENvb3JkaW5hdGUgKSA6IFBvbGFyQ29vcmRpbmF0ZSB7XHJcbiAgICBpZiAoIShvcmlnaW5feHkpKSB7XHJcbiAgICAgICAgb3JpZ2luX3h5ID0gbmV3IENvb3JkaW5hdGUoMCwgMClcclxuICAgIH1cclxuXHJcbiAgICBsZXQgeGRpZmYgPSB4eS54IC0gb3JpZ2luX3h5LnhcclxuICAgIGxldCB5ZGlmZiA9IHh5LnkgLSBvcmlnaW5feHkueVxyXG4gICAgbGV0IHBvbGFyX3IgPSBNYXRoLnNxcnQoKHhkaWZmICogeGRpZmYpICsgKHlkaWZmICogeWRpZmYpKVxyXG4gICAgbGV0IHBvbGFyX3RoZXRhID0gTWF0aC5hdGFuMih5ZGlmZiwgeGRpZmYpXHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBhbmdsZV90aGV0YTogcG9sYXJfdGhldGEsXHJcbiAgICAgICAgZGlzdF9yOiBwb2xhcl9yXHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRUcmFkamVjdG9yeUNvb3JkaW5hdGUob3JpZ2luX3h5OiBDb29yZGluYXRlLCB0YXJnZXRfeHk6IENvb3JkaW5hdGUsIGRpc3RhbmNlOiBudW1iZXIpIDogQ29vcmRpbmF0ZSB7XHJcbiAgICAvLyB1c2UgcG9sYXIgY29vcmRzIHRvIHBpY2sgYSBkaXN0YW50IHRyYWRqZWN0b3J5IGZvciBhIGdpdmVuIHRhcmdldCwgYmFzZWQgb24gYW4gb3JpZ2luYXRpb24gb2YgZm9yY2UvYmxhc3QvYWZmZWN0XHJcblxyXG4gICAgLy8gY29udmVydCB0YXJnZXQgdG8gcG9sYXIgY29vcmRpbmF0ZSBiYXNlZCBvbiBvcmlnaW5cclxuICAgIGxldCBwb2xhciA9IHh5VG9Qb2xhcih0YXJnZXRfeHksIG9yaWdpbl94eSlcclxuICAgIFxyXG4gICAgbGV0IHBvbGFyX3IgPSBwb2xhci5kaXN0X3JcclxuICAgIGxldCBwb2xhcl90aGV0YSA9IHBvbGFyLmFuZ2xlX3RoZXRhXHJcblxyXG4gICAgLy8gZXh0ZW5kIHJhZGl1c1xyXG4gICAgbGV0IG5ld19yID0gcG9sYXJfciArIGRpc3RhbmNlXHJcblxyXG4gICAgLy8gcmUtY2FsYyByZWxhdGl2ZSB4LXkgY29vcmRcclxuICAgIC8vIGxldCByZWxhdGl2ZV94ID0gbmV3X3IgKiBNYXRoLmNvcyhwb2xhcl90aGV0YSlcclxuICAgIC8vIGxldCByZWxhdGl2ZV95ID0gbmV3X3IgKiBNYXRoLnNpbihwb2xhcl90aGV0YSlcclxuICAgIC8vIGxldCByZWxfeHkgPSBuZXcgQ29vcmRpbmF0ZShNYXRoLmZsb29yKHJlbGF0aXZlX3gpLCBNYXRoLmZsb29yKHJlbGF0aXZlX3kpKVxyXG4gICAgbGV0IHJlbF94eSA9IGdldFBvbGFyT2Zmc2V0Q29vcmRpbmF0ZShwb2xhcl90aGV0YSwgbmV3X3IpXHJcbiAgICBcclxuICAgIC8vIHJlLWNhbGMgYWN0dWFsIHgteSBjb29yZFxyXG4gICAgbGV0IG5ld194eSA9IG9yaWdpbl94eS5hZGQocmVsX3h5KVxyXG4gICAgcmV0dXJuIG5ld194eVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaW50ZXJzZWN0aW9uT2ZDb29yZGluYXRlTGlzdHMoY29vcmRzX2EgOiBBcnJheTxDb29yZGluYXRlPiwgY29vcmRzX2I6IEFycmF5PENvb3JkaW5hdGU+KSA6IEFycmF5PENvb3JkaW5hdGU+IHtcclxuICAgIGxldCBpbnRlcnNlY3Rpb24gOiBBcnJheTxDb29yZGluYXRlPiA9IFtdXHJcblxyXG4gICAgLy8gY29udmVydCBib3RoIGFycmF5cyB0byBudW1iZXIga2V5c1xyXG4gICAgbGV0IGtleXNfYSAgPSBjb29yZHNfYS5tYXAoKHh5KSA9PiB7IHJldHVybiB4eVRvS2V5KHh5KX0pXHJcbiAgICBsZXQga2V5c19iICA9IGNvb3Jkc19iLm1hcCgoeHkpID0+IHsgcmV0dXJuIHh5VG9LZXkoeHkpfSlcclxuXHJcbiAgICBsZXQgaW50ZXJzZWN0X2tleXMgPSBrZXlzX2EuZmlsdGVyKChrZXlfYSkgPT4ge1xyXG4gICAgICAgIHJldHVybiAoa2V5c19iLmluZGV4T2Yoa2V5X2EpID4gLTEpXHJcbiAgICB9KVxyXG5cclxuICAgIGludGVyc2VjdGlvbiA9IGludGVyc2VjdF9rZXlzLm1hcCgoa2V5KSA9PiB7IHJldHVybiBrZXlUb1hZKGtleSl9KVxyXG5cclxuICAgIHJldHVybiBpbnRlcnNlY3Rpb25cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGlzQ29vcmRpbmF0ZUluTGlzdE9mQ29vcmRpbmF0ZXMoeHk6IENvb3JkaW5hdGUsIGNvb3Jkc19hOiBBcnJheTxDb29yZGluYXRlPikgOiBib29sZWFuIHtcclxuICAgIHJldHVybiAoaW50ZXJzZWN0aW9uT2ZDb29yZGluYXRlTGlzdHMoW3h5XSwgY29vcmRzX2EpLmxlbmd0aCA+IDApXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiByb3VuZFRvUHJlY2lzaW9uKHZhbHVlOiBudW1iZXIsIGRlY2ltYWxzOiBudW1iZXIpIDogbnVtYmVyIHtcclxuICAgIGxldCBhbW91bnQgPSBNYXRoLnBvdygxMCwgZGVjaW1hbHMpXHJcblxyXG4gICAgcmV0dXJuIE1hdGgucm91bmQodmFsdWUgKiBhbW91bnQpIC8gYW1vdW50XHJcbn0iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/brew_components/utils.ts\n");

/***/ }),

/***/ "./src/brew_engine/architect.ts":
/*!**************************************!*\
  !*** ./src/brew_engine/architect.ts ***!
  \**************************************/
/*! exports provided: architectAI */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"architectAI\", function() { return architectAI; });\n/* harmony import */ var rot_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! rot-js */ \"./node_modules/rot-js/lib/rot.js\");\n/* harmony import */ var rot_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(rot_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _brew__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../brew */ \"./src/brew.ts\");\n\r\n\r\nfunction architectAI(gm, actor) {\r\n    let level = gm.getCurrentLevel();\r\n    // check timers on everything that is not a monster\r\n    for (let timer of gm.timer_monitor.getAllTimers()) {\r\n        if (!(timer.actor instanceof _brew__WEBPACK_IMPORTED_MODULE_1__[\"GridThings\"].Monster)) {\r\n            gm.checkTimersForActor(timer.actor);\r\n        }\r\n    }\r\n    // fireeeee\r\n    level.features.getAllThings().filter((feature) => { return feature.isType(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Definitions\"].FeatureType.Fire); }).forEach((feature) => {\r\n        spreadFire(gm, level, feature);\r\n    });\r\n    // look for ambient effects on on mobs\r\n    level.monsters.getAllThings().forEach((mob) => {\r\n        _brew__WEBPACK_IMPORTED_MODULE_1__[\"Movement\"].checkForAmbientEffects(gm, mob);\r\n    });\r\n    // return an event that does nothing!\r\n    let noEvent = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Events\"].createGenericEventOfType(gm, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].BrewEventType.Special, true);\r\n    let noEvent2 = {\r\n        eventType: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].BrewEventType.Special,\r\n        actor: actor,\r\n        playerInitiated: false,\r\n        endsTurn: true\r\n    };\r\n    return noEvent2;\r\n}\r\nfunction spreadFire(gm, level, fire_feature) {\r\n    let terrain_at;\r\n    let feature_at;\r\n    let feature_spawn;\r\n    terrain_at = level.terrain.getAt(fire_feature.location);\r\n    if (rot_js__WEBPACK_IMPORTED_MODULE_0__[\"RNG\"].getUniform() < 0.25) {\r\n        level.features.removeAt(fire_feature.location);\r\n        gm.timer_monitor.setFlagWithTimer(gm, terrain_at, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].Flag.Burnt, 10);\r\n        gm.displayAt(fire_feature.location);\r\n        return;\r\n    }\r\n    fire_feature.location.getAdjacent().forEach((xy) => {\r\n        if (!(level.isValid(xy))) {\r\n            return;\r\n        }\r\n        terrain_at = level.terrain.getAt(xy);\r\n        if (terrain_at.blocks_flying || terrain_at.blocks_walking) {\r\n            return;\r\n        }\r\n        if (terrain_at.hasFlag(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].Flag.Burnt)) {\r\n            return;\r\n        }\r\n        feature_at = level.features.getAt(xy);\r\n        if (feature_at) {\r\n            if (feature_at.isType(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Definitions\"].FeatureType.Fire)) {\r\n                return;\r\n            }\r\n            else {\r\n                level.features.removeAt(xy);\r\n            }\r\n        }\r\n        feature_spawn = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Definitions\"].featureFactory(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Definitions\"].FeatureType.Fire);\r\n        // feature_spawn.setParent(feature_at)\r\n        level.features.setAt(xy, feature_spawn);\r\n        gm.displayAt(xy);\r\n    });\r\n}\r\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvYnJld19lbmdpbmUvYXJjaGl0ZWN0LnRzPzNjZmYiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBNkI7QUFDRTtBQUd6QixxQkFBc0IsRUFBbUIsRUFBRSxLQUE4QjtJQUUzRSxJQUFJLEtBQUssR0FBRyxFQUFFLENBQUMsZUFBZSxFQUFFO0lBRWhDLG1EQUFtRDtJQUVuRCxHQUFHLENBQUMsQ0FBQyxJQUFJLEtBQUssSUFBSSxFQUFFLENBQUMsYUFBYSxDQUFDLFlBQVksRUFBRSxDQUFDLENBQUMsQ0FBQztRQUNoRCxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLEtBQUssWUFBWSxnREFBZSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUNwRCxFQUFFLENBQUMsbUJBQW1CLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQztRQUN2QyxDQUFDO0lBQ0wsQ0FBQztJQUVELFdBQVc7SUFDWCxLQUFLLENBQUMsUUFBUSxDQUFDLFlBQVksRUFBRSxDQUFDLE1BQU0sQ0FBQyxDQUFDLE9BQU8sRUFBRSxFQUFFLEdBQUcsTUFBTSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsaURBQWdCLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxFQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLE9BQU8sRUFBRSxFQUFFO1FBQ2hJLFVBQVUsQ0FBQyxFQUFFLEVBQUUsS0FBSyxFQUFFLE9BQU8sQ0FBQztJQUNsQyxDQUFDLENBQUM7SUFFRixzQ0FBc0M7SUFDdEMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxZQUFZLEVBQUUsQ0FBQyxPQUFPLENBQUMsQ0FBQyxHQUFHLEVBQUUsRUFBRTtRQUMxQyw4Q0FBYSxDQUFDLHNCQUFzQixDQUFDLEVBQUUsRUFBRSxHQUFHLENBQUM7SUFDakQsQ0FBQyxDQUFDO0lBSUYscUNBQXFDO0lBQ3JDLElBQUksT0FBTyxHQUFHLDRDQUFXLENBQUMsd0JBQXdCLENBQUMsRUFBRSxFQUFFLDJDQUFVLENBQUMsYUFBYSxDQUFDLE9BQU8sRUFBRSxJQUFJLENBQUM7SUFDOUYsSUFBSSxRQUFRLEdBQTJCO1FBQ25DLFNBQVMsRUFBRSwyQ0FBVSxDQUFDLGFBQWEsQ0FBQyxPQUFPO1FBQzNDLEtBQUssRUFBRSxLQUFLO1FBQ1osZUFBZSxFQUFFLEtBQUs7UUFDdEIsUUFBUSxFQUFFLElBQUk7S0FDakI7SUFFRCxNQUFNLENBQUMsUUFBUTtBQUNuQixDQUFDO0FBR0Qsb0JBQW9CLEVBQW1CLEVBQUUsS0FBaUIsRUFBRSxZQUFxQztJQUM3RixJQUFJLFVBQW1DO0lBQ3ZDLElBQUksVUFBbUM7SUFDdkMsSUFBSSxhQUFzQztJQUUxQyxVQUFVLEdBQUcsS0FBSyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsWUFBWSxDQUFDLFFBQVEsQ0FBQztJQUV2RCxFQUFFLENBQUMsQ0FBQywwQ0FBTyxDQUFDLFVBQVUsRUFBRSxHQUFHLElBQUksQ0FBQyxDQUFDLENBQUM7UUFDOUIsS0FBSyxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsWUFBWSxDQUFDLFFBQVEsQ0FBQztRQUM5QyxFQUFFLENBQUMsYUFBYSxDQUFDLGdCQUFnQixDQUFDLEVBQUUsRUFBRSxVQUFVLEVBQUUsMkNBQVUsQ0FBQyxJQUFJLENBQUMsS0FBSyxFQUFFLEVBQUUsQ0FBQztRQUM1RSxFQUFFLENBQUMsU0FBUyxDQUFDLFlBQVksQ0FBQyxRQUFRLENBQUM7UUFDbkMsTUFBTTtJQUNWLENBQUM7SUFFRCxZQUFZLENBQUMsUUFBUSxDQUFDLFdBQVcsRUFBRSxDQUFDLE9BQU8sQ0FBQyxDQUFDLEVBQUUsRUFBRSxFQUFFO1FBQy9DLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ3ZCLE1BQU07UUFDVixDQUFDO1FBRUQsVUFBVSxHQUFHLEtBQUssQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQztRQUNwQyxFQUFFLENBQUMsQ0FBQyxVQUFVLENBQUMsYUFBYSxJQUFJLFVBQVUsQ0FBQyxjQUFjLENBQUMsQ0FBQyxDQUFDO1lBQ3hELE1BQU07UUFDVixDQUFDO1FBRUQsRUFBRSxDQUFDLENBQUMsVUFBVSxDQUFDLE9BQU8sQ0FBQywyQ0FBVSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDNUMsTUFBTTtRQUNWLENBQUM7UUFFRCxVQUFVLEdBQUcsS0FBSyxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDO1FBRXJDLEVBQUUsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUM7WUFDYixFQUFFLENBQUMsQ0FBQyxVQUFVLENBQUMsTUFBTSxDQUFDLGlEQUFnQixDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7Z0JBQ3ZELE1BQU07WUFDVixDQUFDO1lBQUMsSUFBSSxDQUFDLENBQUM7Z0JBQ0osS0FBSyxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsRUFBRSxDQUFDO1lBQy9CLENBQUM7UUFDTCxDQUFDO1FBRUQsYUFBYSxHQUFHLGlEQUFnQixDQUFDLGNBQWMsQ0FBQyxpREFBZ0IsQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDO1FBQ2xGLHNDQUFzQztRQUN0QyxLQUFLLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxFQUFFLEVBQUUsYUFBYSxDQUFDO1FBQ3ZDLEVBQUUsQ0FBQyxTQUFTLENBQUMsRUFBRSxDQUFDO0lBQ3BCLENBQUMsQ0FBQztBQUNOLENBQUMiLCJmaWxlIjoiLi9zcmMvYnJld19lbmdpbmUvYXJjaGl0ZWN0LnRzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgUk9UIGZyb20gJ3JvdC1qcydcclxuaW1wb3J0ICogYXMgQnJldyBmcm9tICcuLi9icmV3J1xyXG5cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBhcmNoaXRlY3RBSShnbTogQnJldy5HYW1lTWFzdGVyLCBhY3RvcjogQnJldy5HcmlkVGhpbmdzLk1vbnN0ZXIpIDogQnJldy5FbnVtcy5JQnJld0V2ZW50IHtcclxuICAgIFxyXG4gICAgbGV0IGxldmVsID0gZ20uZ2V0Q3VycmVudExldmVsKClcclxuXHJcbiAgICAvLyBjaGVjayB0aW1lcnMgb24gZXZlcnl0aGluZyB0aGF0IGlzIG5vdCBhIG1vbnN0ZXJcclxuXHJcbiAgICBmb3IgKGxldCB0aW1lciBvZiBnbS50aW1lcl9tb25pdG9yLmdldEFsbFRpbWVycygpKSB7XHJcbiAgICAgICAgaWYgKCEodGltZXIuYWN0b3IgaW5zdGFuY2VvZiBCcmV3LkdyaWRUaGluZ3MuTW9uc3RlcikpIHtcclxuICAgICAgICAgICAgZ20uY2hlY2tUaW1lcnNGb3JBY3Rvcih0aW1lci5hY3RvcilcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIGZpcmVlZWVlXHJcbiAgICBsZXZlbC5mZWF0dXJlcy5nZXRBbGxUaGluZ3MoKS5maWx0ZXIoKGZlYXR1cmUpID0+IHsgcmV0dXJuIGZlYXR1cmUuaXNUeXBlKEJyZXcuRGVmaW5pdGlvbnMuRmVhdHVyZVR5cGUuRmlyZSkgfSkuZm9yRWFjaCgoZmVhdHVyZSkgPT4ge1xyXG4gICAgICAgIHNwcmVhZEZpcmUoZ20sIGxldmVsLCBmZWF0dXJlKVxyXG4gICAgfSlcclxuXHJcbiAgICAvLyBsb29rIGZvciBhbWJpZW50IGVmZmVjdHMgb24gb24gbW9ic1xyXG4gICAgbGV2ZWwubW9uc3RlcnMuZ2V0QWxsVGhpbmdzKCkuZm9yRWFjaCgobW9iKSA9PiB7XHJcbiAgICAgICAgQnJldy5Nb3ZlbWVudC5jaGVja0ZvckFtYmllbnRFZmZlY3RzKGdtLCBtb2IpXHJcbiAgICB9KVxyXG5cclxuXHJcblxyXG4gICAgLy8gcmV0dXJuIGFuIGV2ZW50IHRoYXQgZG9lcyBub3RoaW5nIVxyXG4gICAgbGV0IG5vRXZlbnQgPSBCcmV3LkV2ZW50cy5jcmVhdGVHZW5lcmljRXZlbnRPZlR5cGUoZ20sIEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5TcGVjaWFsLCB0cnVlKVxyXG4gICAgbGV0IG5vRXZlbnQyIDogQnJldy5FbnVtcy5JQnJld0V2ZW50ID0ge1xyXG4gICAgICAgIGV2ZW50VHlwZTogQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLlNwZWNpYWwsXHJcbiAgICAgICAgYWN0b3I6IGFjdG9yLFxyXG4gICAgICAgIHBsYXllckluaXRpYXRlZDogZmFsc2UsXHJcbiAgICAgICAgZW5kc1R1cm46IHRydWVcclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuIG5vRXZlbnQyXHJcbn1cclxuXHJcblxyXG5mdW5jdGlvbiBzcHJlYWRGaXJlKGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGxldmVsOiBCcmV3LkxldmVsLCBmaXJlX2ZlYXR1cmU6IEJyZXcuR3JpZFRoaW5ncy5GZWF0dXJlICkge1xyXG4gICAgbGV0IHRlcnJhaW5fYXQ6IEJyZXcuR3JpZFRoaW5ncy5UZXJyYWluXHJcbiAgICBsZXQgZmVhdHVyZV9hdDogQnJldy5HcmlkVGhpbmdzLkZlYXR1cmVcclxuICAgIGxldCBmZWF0dXJlX3NwYXduOiBCcmV3LkdyaWRUaGluZ3MuRmVhdHVyZVxyXG4gICAgXHJcbiAgICB0ZXJyYWluX2F0ID0gbGV2ZWwudGVycmFpbi5nZXRBdChmaXJlX2ZlYXR1cmUubG9jYXRpb24pXHJcblxyXG4gICAgaWYgKFJPVC5STkcuZ2V0VW5pZm9ybSgpIDwgMC4yNSkge1xyXG4gICAgICAgIGxldmVsLmZlYXR1cmVzLnJlbW92ZUF0KGZpcmVfZmVhdHVyZS5sb2NhdGlvbilcclxuICAgICAgICBnbS50aW1lcl9tb25pdG9yLnNldEZsYWdXaXRoVGltZXIoZ20sIHRlcnJhaW5fYXQsIEJyZXcuRW51bXMuRmxhZy5CdXJudCwgMTApXHJcbiAgICAgICAgZ20uZGlzcGxheUF0KGZpcmVfZmVhdHVyZS5sb2NhdGlvbilcclxuICAgICAgICByZXR1cm5cclxuICAgIH1cclxuXHJcbiAgICBmaXJlX2ZlYXR1cmUubG9jYXRpb24uZ2V0QWRqYWNlbnQoKS5mb3JFYWNoKCh4eSkgPT4ge1xyXG4gICAgICAgIGlmICghKGxldmVsLmlzVmFsaWQoeHkpKSkge1xyXG4gICAgICAgICAgICByZXR1cm5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRlcnJhaW5fYXQgPSBsZXZlbC50ZXJyYWluLmdldEF0KHh5KVxyXG4gICAgICAgIGlmICh0ZXJyYWluX2F0LmJsb2Nrc19mbHlpbmcgfHwgdGVycmFpbl9hdC5ibG9ja3Nfd2Fsa2luZykge1xyXG4gICAgICAgICAgICByZXR1cm5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0ZXJyYWluX2F0Lmhhc0ZsYWcoQnJldy5FbnVtcy5GbGFnLkJ1cm50KSkge1xyXG4gICAgICAgICAgICByZXR1cm5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZlYXR1cmVfYXQgPSBsZXZlbC5mZWF0dXJlcy5nZXRBdCh4eSlcclxuXHJcbiAgICAgICAgaWYgKGZlYXR1cmVfYXQpIHtcclxuICAgICAgICAgICAgaWYgKGZlYXR1cmVfYXQuaXNUeXBlKEJyZXcuRGVmaW5pdGlvbnMuRmVhdHVyZVR5cGUuRmlyZSkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbGV2ZWwuZmVhdHVyZXMucmVtb3ZlQXQoeHkpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZlYXR1cmVfc3Bhd24gPSBCcmV3LkRlZmluaXRpb25zLmZlYXR1cmVGYWN0b3J5KEJyZXcuRGVmaW5pdGlvbnMuRmVhdHVyZVR5cGUuRmlyZSlcclxuICAgICAgICAvLyBmZWF0dXJlX3NwYXduLnNldFBhcmVudChmZWF0dXJlX2F0KVxyXG4gICAgICAgIGxldmVsLmZlYXR1cmVzLnNldEF0KHh5LCBmZWF0dXJlX3NwYXduKVxyXG4gICAgICAgIGdtLmRpc3BsYXlBdCh4eSlcclxuICAgIH0pXHJcbn0iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/brew_engine/architect.ts\n");

/***/ }),

/***/ "./src/brew_engine/debug.ts":
/*!**********************************!*\
  !*** ./src/brew_engine/debug.ts ***!
  \**********************************/
/*! exports provided: Vision, debug_vision, debug_pathmap, toggleFOV, togglePathmap, createMonsterAt, showCreateMonsterAtMenu, createFeatureAt, showCreateFeatureAtMenu, createTerrainAt, showCreateTerrainAtMenu, toggleBackgroundCover, BOSS_MODE, toggleBossMode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Vision\", function() { return Vision; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"debug_vision\", function() { return debug_vision; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"debug_pathmap\", function() { return debug_pathmap; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"toggleFOV\", function() { return toggleFOV; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"togglePathmap\", function() { return togglePathmap; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"createMonsterAt\", function() { return createMonsterAt; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"showCreateMonsterAtMenu\", function() { return showCreateMonsterAtMenu; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"createFeatureAt\", function() { return createFeatureAt; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"showCreateFeatureAtMenu\", function() { return showCreateFeatureAtMenu; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"createTerrainAt\", function() { return createTerrainAt; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"showCreateTerrainAtMenu\", function() { return showCreateTerrainAtMenu; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"toggleBackgroundCover\", function() { return toggleBackgroundCover; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BOSS_MODE\", function() { return BOSS_MODE; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"toggleBossMode\", function() { return toggleBossMode; });\n/* harmony import */ var _brew__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../brew */ \"./src/brew.ts\");\n\r\nvar Vision;\r\n(function (Vision) {\r\n    Vision[Vision[\"Normal\"] = 0] = \"Normal\";\r\n    Vision[Vision[\"ShowMobs\"] = 1] = \"ShowMobs\";\r\n    Vision[Vision[\"ShowAll\"] = 2] = \"ShowAll\";\r\n})(Vision || (Vision = {}));\r\nlet debug_vision = Vision.Normal;\r\nlet debug_pathmap = null;\r\nlet debug_pathmap_id = 0;\r\nfunction toggleFOV(gm) {\r\n    let i = debug_vision;\r\n    i = (i + 1) % 3;\r\n    let dv = Vision[i];\r\n    debug_vision = Vision[dv];\r\n    let updatefov = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Intel\"].updateFov(gm, gm.getPlayer());\r\n    console.log(\"debug view:\", dv);\r\n    gm.displayAll();\r\n}\r\nfunction togglePathmap(gm, pm) {\r\n    debug_pathmap_id = (debug_pathmap_id + 1) % 5;\r\n    if (debug_pathmap_id == 0) {\r\n        console.log(\"DEBUG PATHMAP: OFF\");\r\n        debug_pathmap = null;\r\n    }\r\n    else if (debug_pathmap_id == 1) {\r\n        console.log(\"DEBUG PATHMAP: Walk To Player\");\r\n        debug_pathmap = gm.pathmaps.getPathmap(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].PathmapCacheType.ToPlayer_Walk);\r\n    }\r\n    else if (debug_pathmap_id == 2) {\r\n        console.log(\"DEBUG PATHMAP: Fly To Player\");\r\n        debug_pathmap = gm.pathmaps.getPathmap(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].PathmapCacheType.ToPlayer_Fly);\r\n    }\r\n    else if (debug_pathmap_id == 3) {\r\n        console.log(\"DEBUG PATHMAP: Walk Away From Player\");\r\n        // let to_map = Path.createGenericMapToPlayer(gm, gm.getCurrentLevel())\r\n        debug_pathmap = gm.pathmaps.getPathmap(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].PathmapCacheType.FromPlayer_Walk);\r\n    }\r\n    else if (debug_pathmap_id == 4) {\r\n        console.log(\"DEBUG PATHMAP: Fly Away From Player\");\r\n        // let to_map = Path.createGenericMapToPlayer(gm, gm.getCurrentLevel())\r\n        debug_pathmap = gm.pathmaps.getPathmap(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].PathmapCacheType.FromPlayer_Fly);\r\n    }\r\n    gm.displayAll();\r\n}\r\nfunction createMonsterAt(gm, brEvent) {\r\n    let level = gm.getCurrentLevel();\r\n    let target_xy = brEvent.moveData.to_xy;\r\n    let monsterDef = brEvent.debugMenuData.monsterTypeDefinition;\r\n    let newMob = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].monsterFactory(gm, monsterDef, { monster_status: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].MonsterStatus.Wander });\r\n    level.monsters.setAt(target_xy, newMob);\r\n    gm.displayAt(target_xy);\r\n    gm.addActorToScheduler(newMob);\r\n    gm.endEvent(brEvent);\r\n}\r\nfunction showCreateMonsterAtMenu(gm, brEvent) {\r\n    let menu_entries = [];\r\n    // https://stackoverflow.com/questions/39372804/typescript-how-to-loop-through-enum-values-for-display-in-radio-buttons\r\n    for (let enum_item in _brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].MonsterType) {\r\n        if (!(isNaN(Number(enum_item)))) {\r\n            let enum_number = Number(enum_item);\r\n            // console.log(enum_item)\r\n            let entryEvent = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].createGenericEventOfType(gm, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.TargetingOn, false);\r\n            entryEvent.startTargetingData = {\r\n                from_xy: gm.getPlayer().location,\r\n                to_xy: gm.getPlayer().location,\r\n                targetingAction: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewTargetingAction.DebugSummonMob\r\n            };\r\n            entryEvent.debugMenuData = {\r\n                monsterTypeDefinition: enum_number\r\n            };\r\n            menu_entries.push({\r\n                entryName: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].MonsterType[enum_number],\r\n                entryType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].GenericMenuEntryType.EventBased,\r\n                entryEvent: entryEvent\r\n            });\r\n        }\r\n    }\r\n    let menuEvent = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].createGenericEventOfType(gm, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.GenericMenuOn);\r\n    menuEvent.genericMenuData = {\r\n        menuTitle: \"Monster\",\r\n        allowCancel: true,\r\n        menuEntriesList: menu_entries\r\n    };\r\n    gm.insertEvent(menuEvent);\r\n    gm.endEvent(brEvent);\r\n}\r\nfunction createFeatureAt(gm, brEvent) {\r\n    let level = gm.getCurrentLevel();\r\n    let target_xy = brEvent.moveData.to_xy;\r\n    let featureDef = brEvent.debugMenuData.featureTypeDefinition;\r\n    let new_feature = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].featureFactory(featureDef);\r\n    level.features.removeAt(target_xy);\r\n    level.features.setAt(target_xy, new_feature);\r\n    gm.displayAt(target_xy);\r\n    gm.endEvent(brEvent);\r\n}\r\nfunction showCreateFeatureAtMenu(gm, brEvent) {\r\n    let menu_entries = [];\r\n    // https://stackoverflow.com/questions/39372804/typescript-how-to-loop-through-enum-values-for-display-in-radio-buttons\r\n    for (let enum_item in _brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].FeatureType) {\r\n        if (!(isNaN(Number(enum_item)))) {\r\n            let enum_number = Number(enum_item);\r\n            // console.log(enum_item)\r\n            let entryEvent = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].createGenericEventOfType(gm, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.TargetingOn, false);\r\n            entryEvent.startTargetingData = {\r\n                from_xy: gm.getPlayer().location,\r\n                to_xy: gm.getPlayer().location,\r\n                targetingAction: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewTargetingAction.DebugMakeFeature\r\n            };\r\n            entryEvent.debugMenuData = {\r\n                featureTypeDefinition: enum_number\r\n            };\r\n            menu_entries.push({\r\n                entryName: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].FeatureType[enum_number],\r\n                entryType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].GenericMenuEntryType.EventBased,\r\n                entryEvent: entryEvent\r\n            });\r\n        }\r\n    }\r\n    let menuEvent = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].createGenericEventOfType(gm, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.GenericMenuOn);\r\n    menuEvent.genericMenuData = {\r\n        menuTitle: \"Feature\",\r\n        allowCancel: true,\r\n        menuEntriesList: menu_entries\r\n    };\r\n    gm.insertEvent(menuEvent);\r\n    gm.endEvent(brEvent);\r\n}\r\nfunction createTerrainAt(gm, brEvent) {\r\n    let level = gm.getCurrentLevel();\r\n    let target_xy = brEvent.moveData.to_xy;\r\n    let terrainDef = brEvent.debugMenuData.terrainTypeDefinition;\r\n    let new_terrain = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].terrainFactory(terrainDef);\r\n    level.terrain.removeAt(target_xy);\r\n    level.terrain.setAt(target_xy, new_terrain);\r\n    gm.displayAt(target_xy);\r\n    gm.endEvent(brEvent);\r\n}\r\nfunction showCreateTerrainAtMenu(gm, brEvent) {\r\n    let menu_entries = [];\r\n    // https://stackoverflow.com/questions/39372804/typescript-how-to-loop-through-enum-values-for-display-in-radio-buttons\r\n    for (let enum_item in _brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].TerrainType) {\r\n        if (!(isNaN(Number(enum_item)))) {\r\n            let enum_number = Number(enum_item);\r\n            // console.log(enum_item)\r\n            let entryEvent = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].createGenericEventOfType(gm, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.TargetingOn, false);\r\n            entryEvent.startTargetingData = {\r\n                from_xy: gm.getPlayer().location,\r\n                to_xy: gm.getPlayer().location,\r\n                targetingAction: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewTargetingAction.DebugMakeTerrain\r\n            };\r\n            entryEvent.debugMenuData = {\r\n                terrainTypeDefinition: enum_number\r\n            };\r\n            menu_entries.push({\r\n                entryName: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].TerrainType[enum_number],\r\n                entryType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].GenericMenuEntryType.EventBased,\r\n                entryEvent: entryEvent\r\n            });\r\n        }\r\n    }\r\n    let menuEvent = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].createGenericEventOfType(gm, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.GenericMenuOn);\r\n    menuEvent.genericMenuData = {\r\n        menuTitle: \"Terrain\",\r\n        allowCancel: true,\r\n        menuEntriesList: menu_entries\r\n    };\r\n    gm.insertEvent(menuEvent);\r\n    gm.endEvent(brEvent);\r\n}\r\n// export function testPathMaps(gm: Brew.GameMaster) {\r\n//     let start_time = Date.now()\r\n//     console.log(start_time)\r\n//     let elapsed_time : number\r\n//     let N = 100\r\n//     for (let i = 0; i < N; i++) {\r\n//         let pm = Path.testCreateGenericMapToPlayer(gm, gm.getCurrentLevel(), LevelNavigationType.Walk, false)\r\n//     }\r\n//     elapsed_time = Date.now() - start_time\r\n//     let avg_time = elapsed_time / N\r\n//     console.log(\"total time\", elapsed_time)\r\n//     console.log(\"average time\", avg_time)\r\n//     let ppm = Path.testCreateGenericMapToPlayer(gm, gm.getCurrentLevel(), LevelNavigationType.Walk, false)\r\n//     debug_pathmap = ppm\r\n//     gm.displayAll()\r\n// }\r\nlet useBackgroundCover = false;\r\nfunction toggleBackgroundCover(gm) {\r\n    useBackgroundCover = (!(useBackgroundCover));\r\n    if (useBackgroundCover) {\r\n        showBackgroundCover(gm);\r\n    }\r\n    else {\r\n        hideBackgroundCover(gm);\r\n    }\r\n}\r\nfunction showBackgroundCover(gm) {\r\n    let fake_img = 'https://assets.bwbx.io/images/users/iqjWHBFdfxIU/iBdiy3Q_YPhk/v2/800x-1.png';\r\n    let imgBackground = (document.getElementById(\"id_img_backgroundcover\"));\r\n    imgBackground.src = fake_img;\r\n}\r\nfunction hideBackgroundCover(gm) {\r\n    let canvas = (gm.display.getDisplay(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].DisplayNames.Game).getContainer());\r\n    let context = canvas.getContext(\"2d\");\r\n    context.drawImage(null, 0, 0);\r\n    gm.displayAll();\r\n}\r\nlet BOSS_MODE = false;\r\nfunction toggleBossMode(to) {\r\n    BOSS_MODE = to;\r\n}\r\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvYnJld19lbmdpbmUvZGVidWcudHM/M2JiMiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7O0FBQStCO0FBRS9CLElBQVksTUFJWDtBQUpELFdBQVksTUFBTTtJQUNkLHVDQUFNO0lBQ04sMkNBQVE7SUFDUix5Q0FBTztBQUNYLENBQUMsRUFKVyxNQUFNLEtBQU4sTUFBTSxRQUlqQjtBQUVNLElBQUksWUFBWSxHQUFZLE1BQU0sQ0FBQyxNQUFNO0FBQ3pDLElBQUksYUFBYSxHQUF1QixJQUFJO0FBQ25ELElBQUksZ0JBQWdCLEdBQVksQ0FBQztBQUUzQixtQkFBb0IsRUFBbUI7SUFDekMsSUFBSSxDQUFDLEdBQVksWUFBWTtJQUM3QixDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQztJQUNmLElBQUksRUFBRSxHQUFXLE1BQU0sQ0FBQyxDQUFDLENBQUM7SUFDMUIsWUFBWSxHQUFHLE1BQU0sQ0FBQyxFQUFFLENBQUM7SUFFekIsSUFBSSxTQUFTLEdBQUcsMkNBQVUsQ0FBQyxTQUFTLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBQyxTQUFTLEVBQUUsQ0FBQztJQUN4RCxPQUFPLENBQUMsR0FBRyxDQUFDLGFBQWEsRUFBRSxFQUFFLENBQUM7SUFDOUIsRUFBRSxDQUFDLFVBQVUsRUFBRTtBQUNuQixDQUFDO0FBRUssdUJBQXdCLEVBQW1CLEVBQUUsRUFBcUI7SUFFcEUsZ0JBQWdCLEdBQUcsQ0FBQyxnQkFBZ0IsR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDO0lBRTdDLEVBQUUsQ0FBQyxDQUFDLGdCQUFnQixJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDeEIsT0FBTyxDQUFDLEdBQUcsQ0FBQyxvQkFBb0IsQ0FBQztRQUNqQyxhQUFhLEdBQUcsSUFBSTtJQUN4QixDQUFDO0lBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLGdCQUFnQixJQUFJLENBQUMsQ0FBQyxDQUFD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QyxDQUFDLENBQUMsa0JBQWtCLENBQUMsQ0FBQztJQUM1QyxFQUFFLENBQUMsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDLENBQUM7UUFDckIsbUJBQW1CLENBQUMsRUFBRSxDQUFDO0lBQzNCLENBQUM7SUFBQyxJQUFJLENBQUMsQ0FBQztRQUNKLG1CQUFtQixDQUFDLEVBQUUsQ0FBQztJQUMzQixDQUFDO0FBQ0wsQ0FBQztBQUVELDZCQUE2QixFQUFtQjtJQUM1QyxJQUFJLFFBQVEsR0FBRyw2RUFBNkU7SUFFNUYsSUFBSSxhQUFhLEdBQXFCLENBQUMsUUFBUSxDQUFDLGNBQWMsQ0FBQyx3QkFBd0IsQ0FBQyxDQUFDO0lBQ3pGLGFBQWEsQ0FBQyxHQUFHLEdBQUcsUUFBUTtBQUVoQyxDQUFDO0FBRUQsNkJBQTZCLEVBQW1CO0lBQzVDLElBQUksTUFBTSxHQUFzQixDQUFDLEVBQUUsQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFDLDJDQUFVLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxDQUFDLFlBQVksRUFBRSxDQUFDO0lBQ3BHLElBQUksT0FBTyxHQUFHLE1BQU0sQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDO0lBQ3JDLE9BQU8sQ0FBQyxTQUFTLENBQUMsSUFBSSxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUM7SUFDN0IsRUFBRSxDQUFDLFVBQVUsRUFBRTtBQUNuQixDQUFDO0FBRU0sSUFBSSxTQUFTLEdBQUcsS0FBSztBQUN0Qix3QkFBeUIsRUFBVztJQUN0QyxTQUFTLEdBQUcsRUFBRTtBQUNsQixDQUFDIiwiZmlsZSI6Ii4vc3JjL2JyZXdfZW5naW5lL2RlYnVnLnRzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgQnJldyBmcm9tIFwiLi4vYnJld1wiXHJcblxyXG5leHBvcnQgZW51bSBWaXNpb24ge1xyXG4gICAgTm9ybWFsLFxyXG4gICAgU2hvd01vYnMsXHJcbiAgICBTaG93QWxsXHJcbn1cclxuXHJcbmV4cG9ydCBsZXQgZGVidWdfdmlzaW9uIDogVmlzaW9uID0gVmlzaW9uLk5vcm1hbFxyXG5leHBvcnQgbGV0IGRlYnVnX3BhdGhtYXAgOiBCcmV3LlBhdGguUGF0aG1hcCA9IG51bGxcclxubGV0IGRlYnVnX3BhdGhtYXBfaWQgOiBudW1iZXIgPSAwXHJcblxyXG5leHBvcnQgZnVuY3Rpb24gdG9nZ2xlRk9WKGdtOiBCcmV3LkdhbWVNYXN0ZXIpIHtcclxuICAgIGxldCBpIDogbnVtYmVyID0gZGVidWdfdmlzaW9uXHJcbiAgICBpID0gKGkgKyAxKSAlIDNcclxuICAgIGxldCBkdiA6c3RyaW5nID0gVmlzaW9uW2ldXHJcbiAgICBkZWJ1Z192aXNpb24gPSBWaXNpb25bZHZdXHJcblxyXG4gICAgbGV0IHVwZGF0ZWZvdiA9IEJyZXcuSW50ZWwudXBkYXRlRm92KGdtLCBnbS5nZXRQbGF5ZXIoKSlcclxuICAgIGNvbnNvbGUubG9nKFwiZGVidWcgdmlldzpcIiwgZHYpXHJcbiAgICBnbS5kaXNwbGF5QWxsKClcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHRvZ2dsZVBhdGhtYXAoZ206IEJyZXcuR2FtZU1hc3RlciwgcG06IEJyZXcuUGF0aC5QYXRobWFwKSB7XHJcbiAgICBcclxuICAgIGRlYnVnX3BhdGhtYXBfaWQgPSAoZGVidWdfcGF0aG1hcF9pZCArIDEpICUgNVxyXG4gICAgXHJcbiAgICBpZiAoZGVidWdfcGF0aG1hcF9pZCA9PSAwKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJERUJVRyBQQVRITUFQOiBPRkZcIilcclxuICAgICAgICBkZWJ1Z19wYXRobWFwID0gbnVsbFxyXG4gICAgfSBlbHNlIGlmIChkZWJ1Z19wYXRobWFwX2lkID09IDEpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIkRFQlVHIFBBVEhNQVA6IFdhbGsgVG8gUGxheWVyXCIpXHJcbiAgICAgICAgZGVidWdfcGF0aG1hcCA9IGdtLnBhdGhtYXBzLmdldFBhdGhtYXAoQnJldy5FbnVtcy5QYXRobWFwQ2FjaGVUeXBlLlRvUGxheWVyX1dhbGspXHJcbiAgICB9IGVsc2UgaWYgKGRlYnVnX3BhdGhtYXBfaWQgPT0gMikge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiREVCVUcgUEFUSE1BUDogRmx5IFRvIFBsYXllclwiKVxyXG4gICAgICAgIGRlYnVnX3BhdGhtYXAgPSBnbS5wYXRobWFwcy5nZXRQYXRobWFwKEJyZXcuRW51bXMuUGF0aG1hcENhY2hlVHlwZS5Ub1BsYXllcl9GbHkpXHJcbiAgICB9IGVsc2UgaWYgKGRlYnVnX3BhdGhtYXBfaWQgPT0gMykge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiREVCVUcgUEFUSE1BUDogV2FsayBBd2F5IEZyb20gUGxheWVyXCIpXHJcbiAgICAgICAgLy8gbGV0IHRvX21hcCA9IFBhdGguY3JlYXRlR2VuZXJpY01hcFRvUGxheWVyKGdtLCBnbS5nZXRDdXJyZW50TGV2ZWwoKSlcclxuICAgICAgICBkZWJ1Z19wYXRobWFwID0gZ20ucGF0aG1hcHMuZ2V0UGF0aG1hcChCcmV3LkVudW1zLlBhdGhtYXBDYWNoZVR5cGUuRnJvbVBsYXllcl9XYWxrKVxyXG4gICAgfSBlbHNlIGlmIChkZWJ1Z19wYXRobWFwX2lkID09IDQpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIkRFQlVHIFBBVEhNQVA6IEZseSBBd2F5IEZyb20gUGxheWVyXCIpXHJcbiAgICAgICAgLy8gbGV0IHRvX21hcCA9IFBhdGguY3JlYXRlR2VuZXJpY01hcFRvUGxheWVyKGdtLCBnbS5nZXRDdXJyZW50TGV2ZWwoKSlcclxuICAgICAgICBkZWJ1Z19wYXRobWFwID0gZ20ucGF0aG1hcHMuZ2V0UGF0aG1hcChCcmV3LkVudW1zLlBhdGhtYXBDYWNoZVR5cGUuRnJvbVBsYXllcl9GbHkpXHJcbiAgICB9XHJcbiAgICBcclxuICAgIGdtLmRpc3BsYXlBbGwoKVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlTW9uc3RlckF0KGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGJyRXZlbnQ6IEJyZXcuRW51bXMuSUJyZXdFdmVudCkge1xyXG4gICAgbGV0IGxldmVsID0gZ20uZ2V0Q3VycmVudExldmVsKClcclxuICAgIGxldCB0YXJnZXRfeHkgPSBickV2ZW50Lm1vdmVEYXRhLnRvX3h5XHJcbiAgICBsZXQgbW9uc3RlckRlZiA6IEJyZXcuRGVmaW5pdGlvbnMuTW9uc3RlclR5cGUgPSBickV2ZW50LmRlYnVnTWVudURhdGEubW9uc3RlclR5cGVEZWZpbml0aW9uXHJcbiAgICBsZXQgbmV3TW9iID0gQnJldy5EZWZpbml0aW9ucy5tb25zdGVyRmFjdG9yeShnbSwgbW9uc3RlckRlZiwge21vbnN0ZXJfc3RhdHVzOiBCcmV3LkVudW1zLk1vbnN0ZXJTdGF0dXMuV2FuZGVyIH0pXHJcbiAgICBcclxuICAgIGxldmVsLm1vbnN0ZXJzLnNldEF0KHRhcmdldF94eSwgbmV3TW9iKVxyXG4gICAgZ20uZGlzcGxheUF0KHRhcmdldF94eSlcclxuICAgIGdtLmFkZEFjdG9yVG9TY2hlZHVsZXIobmV3TW9iKVxyXG4gICAgZ20uZW5kRXZlbnQoYnJFdmVudClcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHNob3dDcmVhdGVNb25zdGVyQXRNZW51KGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGJyRXZlbnQ6IEJyZXcuRW51bXMuSUJyZXdFdmVudCkge1xyXG4gICAgbGV0IG1lbnVfZW50cmllcyA6IEFycmF5PEJyZXcuRW51bXMuSUJyZXdHZW5lcmljTWVudUVudHJ5PiA9IFtdXHJcblxyXG4gICAgLy8gaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMzkzNzI4MDQvdHlwZXNjcmlwdC1ob3ctdG8tbG9vcC10aHJvdWdoLWVudW0tdmFsdWVzLWZvci1kaXNwbGF5LWluLXJhZGlvLWJ1dHRvbnNcclxuICAgIGZvciAobGV0IGVudW1faXRlbSBpbiBCcmV3LkRlZmluaXRpb25zLk1vbnN0ZXJUeXBlKSB7XHJcbiAgICAgICAgaWYgKCEoaXNOYU4oTnVtYmVyKGVudW1faXRlbSkpKSkge1xyXG4gICAgICAgICAgICBsZXQgZW51bV9udW1iZXIgOiBudW1iZXIgPSBOdW1iZXIoZW51bV9pdGVtKVxyXG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhlbnVtX2l0ZW0pXHJcbiAgICAgICAgICAgIGxldCBlbnRyeUV2ZW50IDogQnJldy5FbnVtcy5JQnJld0V2ZW50ID0gQnJldy5FdmVudHMuY3JlYXRlR2VuZXJpY0V2ZW50T2ZUeXBlKGdtLCBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuVGFyZ2V0aW5nT24sIGZhbHNlKVxyXG4gICAgICAgICAgICBlbnRyeUV2ZW50LnN0YXJ0VGFyZ2V0aW5nRGF0YSA9IHtcclxuICAgICAgICAgICAgICAgIGZyb21feHk6IGdtLmdldFBsYXllcigpLmxvY2F0aW9uLFxyXG4gICAgICAgICAgICAgICAgdG9feHk6IGdtLmdldFBsYXllcigpLmxvY2F0aW9uLFxyXG4gICAgICAgICAgICAgICAgdGFyZ2V0aW5nQWN0aW9uOiBCcmV3LkVudW1zLkJyZXdUYXJnZXRpbmdBY3Rpb24uRGVidWdTdW1tb25Nb2JcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbnRyeUV2ZW50LmRlYnVnTWVudURhdGEgPSB7XHJcbiAgICAgICAgICAgICAgICBtb25zdGVyVHlwZURlZmluaXRpb246IGVudW1fbnVtYmVyXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIG1lbnVfZW50cmllcy5wdXNoKHtcclxuICAgICAgICAgICAgICAgIGVudHJ5TmFtZTogQnJldy5EZWZpbml0aW9ucy5Nb25zdGVyVHlwZVtlbnVtX251bWJlcl0sXHJcbiAgICAgICAgICAgICAgICBlbnRyeVR5cGU6IEJyZXcuRW51bXMuR2VuZXJpY01lbnVFbnRyeVR5cGUuRXZlbnRCYXNlZCxcclxuICAgICAgICAgICAgICAgIGVudHJ5RXZlbnQ6IGVudHJ5RXZlbnRcclxuICAgICAgICAgICAgfSlcclxuXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIFxyXG4gICAgbGV0IG1lbnVFdmVudCA9IEJyZXcuRXZlbnRzLmNyZWF0ZUdlbmVyaWNFdmVudE9mVHlwZShnbSwgQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLkdlbmVyaWNNZW51T24pXHJcbiAgICBtZW51RXZlbnQuZ2VuZXJpY01lbnVEYXRhID0ge1xyXG4gICAgICAgIG1lbnVUaXRsZTogXCJNb25zdGVyXCIsXHJcbiAgICAgICAgYWxsb3dDYW5jZWw6IHRydWUsXHJcbiAgICAgICAgbWVudUVudHJpZXNMaXN0OiBtZW51X2VudHJpZXNcclxuICAgIH1cclxuXHJcbiAgICBnbS5pbnNlcnRFdmVudChtZW51RXZlbnQpXHJcbiAgICBnbS5lbmRFdmVudChickV2ZW50KVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlRmVhdHVyZUF0KGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGJyRXZlbnQ6IEJyZXcuRW51bXMuSUJyZXdFdmVudCkge1xyXG4gICAgbGV0IGxldmVsID0gZ20uZ2V0Q3VycmVudExldmVsKClcclxuICAgIGxldCB0YXJnZXRfeHkgPSBickV2ZW50Lm1vdmVEYXRhLnRvX3h5XHJcbiAgICBsZXQgZmVhdHVyZURlZiA6IEJyZXcuRGVmaW5pdGlvbnMuRmVhdHVyZVR5cGUgPSBickV2ZW50LmRlYnVnTWVudURhdGEuZmVhdHVyZVR5cGVEZWZpbml0aW9uXHJcbiAgICBsZXQgbmV3X2ZlYXR1cmUgPSBCcmV3LkRlZmluaXRpb25zLmZlYXR1cmVGYWN0b3J5KGZlYXR1cmVEZWYpXHJcbiAgICBcclxuICAgIGxldmVsLmZlYXR1cmVzLnJlbW92ZUF0KHRhcmdldF94eSlcclxuICAgIGxldmVsLmZlYXR1cmVzLnNldEF0KHRhcmdldF94eSwgbmV3X2ZlYXR1cmUpXHJcbiAgICBnbS5kaXNwbGF5QXQodGFyZ2V0X3h5KVxyXG4gICAgZ20uZW5kRXZlbnQoYnJFdmVudClcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHNob3dDcmVhdGVGZWF0dXJlQXRNZW51KGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGJyRXZlbnQ6IEJyZXcuRW51bXMuSUJyZXdFdmVudCkge1xyXG4gICAgbGV0IG1lbnVfZW50cmllcyA6IEFycmF5PEJyZXcuRW51bXMuSUJyZXdHZW5lcmljTWVudUVudHJ5PiA9IFtdXHJcblxyXG4gICAgLy8gaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMzkzNzI4MDQvdHlwZXNjcmlwdC1ob3ctdG8tbG9vcC10aHJvdWdoLWVudW0tdmFsdWVzLWZvci1kaXNwbGF5LWluLXJhZGlvLWJ1dHRvbnNcclxuICAgIGZvciAobGV0IGVudW1faXRlbSBpbiBCcmV3LkRlZmluaXRpb25zLkZlYXR1cmVUeXBlKSB7XHJcbiAgICAgICAgaWYgKCEoaXNOYU4oTnVtYmVyKGVudW1faXRlbSkpKSkge1xyXG4gICAgICAgICAgICBsZXQgZW51bV9udW1iZXIgOiBudW1iZXIgPSBOdW1iZXIoZW51bV9pdGVtKVxyXG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhlbnVtX2l0ZW0pXHJcbiAgICAgICAgICAgIGxldCBlbnRyeUV2ZW50IDogQnJldy5FbnVtcy5JQnJld0V2ZW50ID0gQnJldy5FdmVudHMuY3JlYXRlR2VuZXJpY0V2ZW50T2ZUeXBlKGdtLCBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuVGFyZ2V0aW5nT24sIGZhbHNlKVxyXG4gICAgICAgICAgICBlbnRyeUV2ZW50LnN0YXJ0VGFyZ2V0aW5nRGF0YSA9IHtcclxuICAgICAgICAgICAgICAgIGZyb21feHk6IGdtLmdldFBsYXllcigpLmxvY2F0aW9uLFxyXG4gICAgICAgICAgICAgICAgdG9feHk6IGdtLmdldFBsYXllcigpLmxvY2F0aW9uLFxyXG4gICAgICAgICAgICAgICAgdGFyZ2V0aW5nQWN0aW9uOiBCcmV3LkVudW1zLkJyZXdUYXJnZXRpbmdBY3Rpb24uRGVidWdNYWtlRmVhdHVyZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVudHJ5RXZlbnQuZGVidWdNZW51RGF0YSA9IHtcclxuICAgICAgICAgICAgICAgIGZlYXR1cmVUeXBlRGVmaW5pdGlvbjogZW51bV9udW1iZXJcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgbWVudV9lbnRyaWVzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgZW50cnlOYW1lOiBCcmV3LkRlZmluaXRpb25zLkZlYXR1cmVUeXBlW2VudW1fbnVtYmVyXSxcclxuICAgICAgICAgICAgICAgIGVudHJ5VHlwZTogQnJldy5FbnVtcy5HZW5lcmljTWVudUVudHJ5VHlwZS5FdmVudEJhc2VkLFxyXG4gICAgICAgICAgICAgICAgZW50cnlFdmVudDogZW50cnlFdmVudFxyXG4gICAgICAgICAgICB9KVxyXG5cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgXHJcbiAgICBsZXQgbWVudUV2ZW50ID0gQnJldy5FdmVudHMuY3JlYXRlR2VuZXJpY0V2ZW50T2ZUeXBlKGdtLCBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuR2VuZXJpY01lbnVPbilcclxuICAgIG1lbnVFdmVudC5nZW5lcmljTWVudURhdGEgPSB7XHJcbiAgICAgICAgbWVudVRpdGxlOiBcIkZlYXR1cmVcIixcclxuICAgICAgICBhbGxvd0NhbmNlbDogdHJ1ZSxcclxuICAgICAgICBtZW51RW50cmllc0xpc3Q6IG1lbnVfZW50cmllc1xyXG4gICAgfVxyXG5cclxuICAgIGdtLmluc2VydEV2ZW50KG1lbnVFdmVudClcclxuICAgIGdtLmVuZEV2ZW50KGJyRXZlbnQpXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVUZXJyYWluQXQoZ206IEJyZXcuR2FtZU1hc3RlciwgYnJFdmVudDogQnJldy5FbnVtcy5JQnJld0V2ZW50KSB7XHJcbiAgICBsZXQgbGV2ZWwgPSBnbS5nZXRDdXJyZW50TGV2ZWwoKVxyXG4gICAgbGV0IHRhcmdldF94eSA9IGJyRXZlbnQubW92ZURhdGEudG9feHlcclxuICAgIGxldCB0ZXJyYWluRGVmIDogQnJldy5EZWZpbml0aW9ucy5UZXJyYWluVHlwZSA9IGJyRXZlbnQuZGVidWdNZW51RGF0YS50ZXJyYWluVHlwZURlZmluaXRpb25cclxuICAgIGxldCBuZXdfdGVycmFpbiA9IEJyZXcuRGVmaW5pdGlvbnMudGVycmFpbkZhY3RvcnkodGVycmFpbkRlZilcclxuICAgIFxyXG4gICAgbGV2ZWwudGVycmFpbi5yZW1vdmVBdCh0YXJnZXRfeHkpXHJcbiAgICBsZXZlbC50ZXJyYWluLnNldEF0KHRhcmdldF94eSwgbmV3X3RlcnJhaW4pXHJcbiAgICBnbS5kaXNwbGF5QXQodGFyZ2V0X3h5KVxyXG4gICAgZ20uZW5kRXZlbnQoYnJFdmVudClcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHNob3dDcmVhdGVUZXJyYWluQXRNZW51KGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGJyRXZlbnQ6IEJyZXcuRW51bXMuSUJyZXdFdmVudCkge1xyXG4gICAgbGV0IG1lbnVfZW50cmllcyA6IEFycmF5PEJyZXcuRW51bXMuSUJyZXdHZW5lcmljTWVudUVudHJ5PiA9IFtdXHJcblxyXG4gICAgLy8gaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMzkzNzI4MDQvdHlwZXNjcmlwdC1ob3ctdG8tbG9vcC10aHJvdWdoLWVudW0tdmFsdWVzLWZvci1kaXNwbGF5LWluLXJhZGlvLWJ1dHRvbnNcclxuICAgIGZvciAobGV0IGVudW1faXRlbSBpbiBCcmV3LkRlZmluaXRpb25zLlRlcnJhaW5UeXBlKSB7XHJcbiAgICAgICAgaWYgKCEoaXNOYU4oTnVtYmVyKGVudW1faXRlbSkpKSkge1xyXG4gICAgICAgICAgICBsZXQgZW51bV9udW1iZXIgOiBudW1iZXIgPSBOdW1iZXIoZW51bV9pdGVtKVxyXG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhlbnVtX2l0ZW0pXHJcbiAgICAgICAgICAgIGxldCBlbnRyeUV2ZW50IDogQnJldy5FbnVtcy5JQnJld0V2ZW50ID0gQnJldy5FdmVudHMuY3JlYXRlR2VuZXJpY0V2ZW50T2ZUeXBlKGdtLCBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuVGFyZ2V0aW5nT24sIGZhbHNlKVxyXG4gICAgICAgICAgICBlbnRyeUV2ZW50LnN0YXJ0VGFyZ2V0aW5nRGF0YSA9IHtcclxuICAgICAgICAgICAgICAgIGZyb21feHk6IGdtLmdldFBsYXllcigpLmxvY2F0aW9uLFxyXG4gICAgICAgICAgICAgICAgdG9feHk6IGdtLmdldFBsYXllcigpLmxvY2F0aW9uLFxyXG4gICAgICAgICAgICAgICAgdGFyZ2V0aW5nQWN0aW9uOiBCcmV3LkVudW1zLkJyZXdUYXJnZXRpbmdBY3Rpb24uRGVidWdNYWtlVGVycmFpblxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVudHJ5RXZlbnQuZGVidWdNZW51RGF0YSA9IHtcclxuICAgICAgICAgICAgICAgIHRlcnJhaW5UeXBlRGVmaW5pdGlvbjogZW51bV9udW1iZXJcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgbWVudV9lbnRyaWVzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgZW50cnlOYW1lOiBCcmV3LkRlZmluaXRpb25zLlRlcnJhaW5UeXBlW2VudW1fbnVtYmVyXSxcclxuICAgICAgICAgICAgICAgIGVudHJ5VHlwZTogQnJldy5FbnVtcy5HZW5lcmljTWVudUVudHJ5VHlwZS5FdmVudEJhc2VkLFxyXG4gICAgICAgICAgICAgICAgZW50cnlFdmVudDogZW50cnlFdmVudFxyXG4gICAgICAgICAgICB9KVxyXG5cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgXHJcbiAgICBsZXQgbWVudUV2ZW50ID0gQnJldy5FdmVudHMuY3JlYXRlR2VuZXJpY0V2ZW50T2ZUeXBlKGdtLCBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuR2VuZXJpY01lbnVPbilcclxuICAgIG1lbnVFdmVudC5nZW5lcmljTWVudURhdGEgPSB7XHJcbiAgICAgICAgbWVudVRpdGxlOiBcIlRlcnJhaW5cIixcclxuICAgICAgICBhbGxvd0NhbmNlbDogdHJ1ZSxcclxuICAgICAgICBtZW51RW50cmllc0xpc3Q6IG1lbnVfZW50cmllc1xyXG4gICAgfVxyXG5cclxuICAgIGdtLmluc2VydEV2ZW50KG1lbnVFdmVudClcclxuICAgIGdtLmVuZEV2ZW50KGJyRXZlbnQpXHJcbn1cclxuXHJcbi8vIGV4cG9ydCBmdW5jdGlvbiB0ZXN0UGF0aE1hcHMoZ206IEJyZXcuR2FtZU1hc3Rlcikge1xyXG4vLyAgICAgbGV0IHN0YXJ0X3RpbWUgPSBEYXRlLm5vdygpXHJcbi8vICAgICBjb25zb2xlLmxvZyhzdGFydF90aW1lKVxyXG4vLyAgICAgbGV0IGVsYXBzZWRfdGltZSA6IG51bWJlclxyXG4vLyAgICAgbGV0IE4gPSAxMDBcclxuXHJcbi8vICAgICBmb3IgKGxldCBpID0gMDsgaSA8IE47IGkrKykge1xyXG4vLyAgICAgICAgIGxldCBwbSA9IFBhdGgudGVzdENyZWF0ZUdlbmVyaWNNYXBUb1BsYXllcihnbSwgZ20uZ2V0Q3VycmVudExldmVsKCksIExldmVsTmF2aWdhdGlvblR5cGUuV2FsaywgZmFsc2UpXHJcbi8vICAgICB9XHJcbi8vICAgICBlbGFwc2VkX3RpbWUgPSBEYXRlLm5vdygpIC0gc3RhcnRfdGltZVxyXG4vLyAgICAgbGV0IGF2Z190aW1lID0gZWxhcHNlZF90aW1lIC8gTlxyXG4vLyAgICAgY29uc29sZS5sb2coXCJ0b3RhbCB0aW1lXCIsIGVsYXBzZWRfdGltZSlcclxuLy8gICAgIGNvbnNvbGUubG9nKFwiYXZlcmFnZSB0aW1lXCIsIGF2Z190aW1lKVxyXG5cclxuLy8gICAgIGxldCBwcG0gPSBQYXRoLnRlc3RDcmVhdGVHZW5lcmljTWFwVG9QbGF5ZXIoZ20sIGdtLmdldEN1cnJlbnRMZXZlbCgpLCBMZXZlbE5hdmlnYXRpb25UeXBlLldhbGssIGZhbHNlKVxyXG4vLyAgICAgZGVidWdfcGF0aG1hcCA9IHBwbVxyXG4vLyAgICAgZ20uZGlzcGxheUFsbCgpXHJcbi8vIH1cclxubGV0IHVzZUJhY2tncm91bmRDb3ZlciA6IGJvb2xlYW4gPSBmYWxzZVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHRvZ2dsZUJhY2tncm91bmRDb3ZlcihnbTogQnJldy5HYW1lTWFzdGVyKSB7XHJcbiAgICB1c2VCYWNrZ3JvdW5kQ292ZXIgPSAoISh1c2VCYWNrZ3JvdW5kQ292ZXIpKVxyXG4gICAgaWYgKHVzZUJhY2tncm91bmRDb3Zlcikge1xyXG4gICAgICAgIHNob3dCYWNrZ3JvdW5kQ292ZXIoZ20pXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGhpZGVCYWNrZ3JvdW5kQ292ZXIoZ20pXHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNob3dCYWNrZ3JvdW5kQ292ZXIoZ206IEJyZXcuR2FtZU1hc3Rlcikge1xyXG4gICAgbGV0IGZha2VfaW1nID0gJ2h0dHBzOi8vYXNzZXRzLmJ3YnguaW8vaW1hZ2VzL3VzZXJzL2lxaldIQkZkZnhJVS9pQmRpeTNRX1lQaGsvdjIvODAweC0xLnBuZydcclxuXHJcbiAgICBsZXQgaW1nQmFja2dyb3VuZCA9IDxIVE1MSW1hZ2VFbGVtZW50Pihkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImlkX2ltZ19iYWNrZ3JvdW5kY292ZXJcIikpXHJcbiAgICBpbWdCYWNrZ3JvdW5kLnNyYyA9IGZha2VfaW1nXHJcblxyXG59XHJcblxyXG5mdW5jdGlvbiBoaWRlQmFja2dyb3VuZENvdmVyKGdtOiBCcmV3LkdhbWVNYXN0ZXIpIHtcclxuICAgIGxldCBjYW52YXMgPSA8SFRNTENhbnZhc0VsZW1lbnQ+KGdtLmRpc3BsYXkuZ2V0RGlzcGxheShCcmV3LkVudW1zLkRpc3BsYXlOYW1lcy5HYW1lKS5nZXRDb250YWluZXIoKSlcclxuICAgIGxldCBjb250ZXh0ID0gY2FudmFzLmdldENvbnRleHQoXCIyZFwiKVxyXG4gICAgY29udGV4dC5kcmF3SW1hZ2UobnVsbCwgMCwgMCkgICAgXHJcbiAgICBnbS5kaXNwbGF5QWxsKClcclxufVxyXG5cclxuZXhwb3J0IGxldCBCT1NTX01PREUgPSBmYWxzZVxyXG5leHBvcnQgZnVuY3Rpb24gdG9nZ2xlQm9zc01vZGUodG86IGJvb2xlYW4pIHtcclxuICAgIEJPU1NfTU9ERSA9IHRvXHJcbn0iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/brew_engine/debug.ts\n");

/***/ }),

/***/ "./src/brew_engine/enums.ts":
/*!**********************************!*\
  !*** ./src/brew_engine/enums.ts ***!
  \**********************************/
/*! exports provided: ComponentPartsBuildingType, BrewObjectType, BrewPowerType, BrewEventType, BrewAnimationType, BrewInputSource, InputHandler, ContextMenuItem, GenericMenuEntryType, BrewTargetingMethod, BrewTargetingAction, BrewVisionSource, Flag, Team, PathmapCacheType, LevelNavigationType, StatName, MonsterStatus, DisplayNames, BrewNoteType, FancyStepType, PowerUpgradeType, FiringArc */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ComponentPartsBuildingType\", function() { return ComponentPartsBuildingType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BrewObjectType\", function() { return BrewObjectType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BrewPowerType\", function() { return BrewPowerType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BrewEventType\", function() { return BrewEventType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BrewAnimationType\", function() { return BrewAnimationType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BrewInputSource\", function() { return BrewInputSource; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"InputHandler\", function() { return InputHandler; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ContextMenuItem\", function() { return ContextMenuItem; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"GenericMenuEntryType\", function() { return GenericMenuEntryType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BrewTargetingMethod\", function() { return BrewTargetingMethod; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BrewTargetingAction\", function() { return BrewTargetingAction; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BrewVisionSource\", function() { return BrewVisionSource; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Flag\", function() { return Flag; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Team\", function() { return Team; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"PathmapCacheType\", function() { return PathmapCacheType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"LevelNavigationType\", function() { return LevelNavigationType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"StatName\", function() { return StatName; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"MonsterStatus\", function() { return MonsterStatus; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DisplayNames\", function() { return DisplayNames; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BrewNoteType\", function() { return BrewNoteType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"FancyStepType\", function() { return FancyStepType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"PowerUpgradeType\", function() { return PowerUpgradeType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"FiringArc\", function() { return FiringArc; });\nvar ComponentPartsBuildingType;\r\n(function (ComponentPartsBuildingType) {\r\n    ComponentPartsBuildingType[ComponentPartsBuildingType[\"None\"] = 0] = \"None\";\r\n    ComponentPartsBuildingType[ComponentPartsBuildingType[\"Tank\"] = 1] = \"Tank\";\r\n})(ComponentPartsBuildingType || (ComponentPartsBuildingType = {}));\r\nvar BrewObjectType;\r\n(function (BrewObjectType) {\r\n    BrewObjectType[BrewObjectType[\"Thing\"] = 1] = \"Thing\";\r\n    BrewObjectType[BrewObjectType[\"Terrain\"] = 2] = \"Terrain\";\r\n    BrewObjectType[BrewObjectType[\"Item\"] = 3] = \"Item\";\r\n    BrewObjectType[BrewObjectType[\"Monster\"] = 4] = \"Monster\";\r\n    BrewObjectType[BrewObjectType[\"Feature\"] = 5] = \"Feature\";\r\n    BrewObjectType[BrewObjectType[\"Above\"] = 6] = \"Above\";\r\n})(BrewObjectType || (BrewObjectType = {}));\r\nvar BrewPowerType;\r\n(function (BrewPowerType) {\r\n    BrewPowerType[BrewPowerType[\"EmptyNone\"] = 1] = \"EmptyNone\";\r\n    BrewPowerType[BrewPowerType[\"TurretCannon\"] = 2] = \"TurretCannon\";\r\n    BrewPowerType[BrewPowerType[\"MachineGun\"] = 3] = \"MachineGun\";\r\n    BrewPowerType[BrewPowerType[\"Scanner\"] = 4] = \"Scanner\";\r\n})(BrewPowerType || (BrewPowerType = {}));\r\nvar BrewEventType;\r\n(function (BrewEventType) {\r\n    BrewEventType[BrewEventType[\"Error\"] = 0] = \"Error\";\r\n    BrewEventType[BrewEventType[\"Info\"] = 1] = \"Info\";\r\n    BrewEventType[BrewEventType[\"Wait\"] = 2] = \"Wait\";\r\n    BrewEventType[BrewEventType[\"Move\"] = 3] = \"Move\";\r\n    BrewEventType[BrewEventType[\"Attack\"] = 4] = \"Attack\";\r\n    BrewEventType[BrewEventType[\"Pickup\"] = 5] = \"Pickup\";\r\n    BrewEventType[BrewEventType[\"Drop\"] = 6] = \"Drop\";\r\n    BrewEventType[BrewEventType[\"Land\"] = 7] = \"Land\";\r\n    BrewEventType[BrewEventType[\"Heave\"] = 8] = \"Heave\";\r\n    BrewEventType[BrewEventType[\"UseItem\"] = 9] = \"UseItem\";\r\n    BrewEventType[BrewEventType[\"SmashAttack\"] = 10] = \"SmashAttack\";\r\n    BrewEventType[BrewEventType[\"ApplyDamage\"] = 11] = \"ApplyDamage\";\r\n    BrewEventType[BrewEventType[\"MassDamage\"] = 12] = \"MassDamage\";\r\n    BrewEventType[BrewEventType[\"Hack\"] = 13] = \"Hack\";\r\n    BrewEventType[BrewEventType[\"HeavyAxeThrow\"] = 14] = \"HeavyAxeThrow\";\r\n    BrewEventType[BrewEventType[\"HeavyAxeRecall\"] = 15] = \"HeavyAxeRecall\";\r\n    BrewEventType[BrewEventType[\"ShieldsUp\"] = 16] = \"ShieldsUp\";\r\n    BrewEventType[BrewEventType[\"CloakOn\"] = 17] = \"CloakOn\";\r\n    BrewEventType[BrewEventType[\"PhaseWalkOn\"] = 18] = \"PhaseWalkOn\";\r\n    BrewEventType[BrewEventType[\"RocketPunch\"] = 19] = \"RocketPunch\";\r\n    BrewEventType[BrewEventType[\"RunAnimation\"] = 20] = \"RunAnimation\";\r\n    BrewEventType[BrewEventType[\"PowerUninstall\"] = 21] = \"PowerUninstall\";\r\n    BrewEventType[BrewEventType[\"PowerSwapSelectMenuOn\"] = 22] = \"PowerSwapSelectMenuOn\";\r\n    BrewEventType[BrewEventType[\"PowerSwapFinalize\"] = 23] = \"PowerSwapFinalize\";\r\n    BrewEventType[BrewEventType[\"PowerInstallPromptOn\"] = 24] = \"PowerInstallPromptOn\";\r\n    BrewEventType[BrewEventType[\"PowerInstallReplacementOn\"] = 25] = \"PowerInstallReplacementOn\";\r\n    BrewEventType[BrewEventType[\"PowerInstallFinalize\"] = 26] = \"PowerInstallFinalize\";\r\n    BrewEventType[BrewEventType[\"TargetingOn\"] = 27] = \"TargetingOn\";\r\n    BrewEventType[BrewEventType[\"TargetingCancel\"] = 28] = \"TargetingCancel\";\r\n    BrewEventType[BrewEventType[\"TargetingFinish\"] = 29] = \"TargetingFinish\";\r\n    BrewEventType[BrewEventType[\"TargetingMove\"] = 30] = \"TargetingMove\";\r\n    BrewEventType[BrewEventType[\"InventoryOn\"] = 31] = \"InventoryOn\";\r\n    BrewEventType[BrewEventType[\"ContextMenuOn\"] = 32] = \"ContextMenuOn\";\r\n    BrewEventType[BrewEventType[\"PowerMenuOn\"] = 33] = \"PowerMenuOn\";\r\n    BrewEventType[BrewEventType[\"HeadsUpDisplayOn\"] = 34] = \"HeadsUpDisplayOn\";\r\n    BrewEventType[BrewEventType[\"GenericMenuOn\"] = 35] = \"GenericMenuOn\";\r\n    BrewEventType[BrewEventType[\"GenericMenuMove\"] = 36] = \"GenericMenuMove\";\r\n    BrewEventType[BrewEventType[\"GenericMenuSelect\"] = 37] = \"GenericMenuSelect\";\r\n    BrewEventType[BrewEventType[\"GenericMenuOff\"] = 38] = \"GenericMenuOff\";\r\n    BrewEventType[BrewEventType[\"PlayerDeath\"] = 39] = \"PlayerDeath\";\r\n    BrewEventType[BrewEventType[\"Victory\"] = 40] = \"Victory\";\r\n    BrewEventType[BrewEventType[\"RestartGame\"] = 41] = \"RestartGame\";\r\n    BrewEventType[BrewEventType[\"UsePortal\"] = 42] = \"UsePortal\";\r\n    BrewEventType[BrewEventType[\"ChangeLevel\"] = 43] = \"ChangeLevel\";\r\n    BrewEventType[BrewEventType[\"DebugCreateMobMenuOn\"] = 44] = \"DebugCreateMobMenuOn\";\r\n    BrewEventType[BrewEventType[\"DebugCreateMobAt\"] = 45] = \"DebugCreateMobAt\";\r\n    BrewEventType[BrewEventType[\"DebugCreateFeatureMenuOn\"] = 46] = \"DebugCreateFeatureMenuOn\";\r\n    BrewEventType[BrewEventType[\"DebugCreateFeatureAt\"] = 47] = \"DebugCreateFeatureAt\";\r\n    BrewEventType[BrewEventType[\"DebugCreateTerrainMenuOn\"] = 48] = \"DebugCreateTerrainMenuOn\";\r\n    BrewEventType[BrewEventType[\"DebugCreateTerrainAt\"] = 49] = \"DebugCreateTerrainAt\";\r\n    BrewEventType[BrewEventType[\"ConfirmPathsOn\"] = 50] = \"ConfirmPathsOn\";\r\n    BrewEventType[BrewEventType[\"ConfirmPathsFinalize\"] = 51] = \"ConfirmPathsFinalize\";\r\n    BrewEventType[BrewEventType[\"ConfirmPathsCancel\"] = 52] = \"ConfirmPathsCancel\";\r\n    BrewEventType[BrewEventType[\"Special\"] = 53] = \"Special\";\r\n    BrewEventType[BrewEventType[\"Knockback\"] = 54] = \"Knockback\";\r\n    BrewEventType[BrewEventType[\"AcquireTarget\"] = 55] = \"AcquireTarget\";\r\n    BrewEventType[BrewEventType[\"WarpBeaconUpgradePower\"] = 56] = \"WarpBeaconUpgradePower\";\r\n    BrewEventType[BrewEventType[\"WarpBeaconIncreasePower\"] = 57] = \"WarpBeaconIncreasePower\";\r\n    BrewEventType[BrewEventType[\"WarpBeaconRechargePower\"] = 58] = \"WarpBeaconRechargePower\";\r\n    BrewEventType[BrewEventType[\"WarpBeaconHeal\"] = 59] = \"WarpBeaconHeal\";\r\n    BrewEventType[BrewEventType[\"WarpBeaconAllyDrop\"] = 60] = \"WarpBeaconAllyDrop\";\r\n    BrewEventType[BrewEventType[\"RotateBody\"] = 61] = \"RotateBody\";\r\n    BrewEventType[BrewEventType[\"RotateWeapon\"] = 62] = \"RotateWeapon\";\r\n    BrewEventType[BrewEventType[\"HelpOn\"] = 63] = \"HelpOn\";\r\n})(BrewEventType || (BrewEventType = {}));\r\nvar BrewAnimationType;\r\n(function (BrewAnimationType) {\r\n    BrewAnimationType[BrewAnimationType[\"Flash\"] = 0] = \"Flash\";\r\n    BrewAnimationType[BrewAnimationType[\"OverPath\"] = 1] = \"OverPath\";\r\n    BrewAnimationType[BrewAnimationType[\"CircleOut\"] = 2] = \"CircleOut\";\r\n    BrewAnimationType[BrewAnimationType[\"CircleIn\"] = 3] = \"CircleIn\";\r\n})(BrewAnimationType || (BrewAnimationType = {}));\r\nvar BrewInputSource;\r\n(function (BrewInputSource) {\r\n    BrewInputSource[BrewInputSource[\"Keyboard\"] = 0] = \"Keyboard\";\r\n    BrewInputSource[BrewInputSource[\"Mouse\"] = 1] = \"Mouse\";\r\n    BrewInputSource[BrewInputSource[\"Touch\"] = 2] = \"Touch\";\r\n})(BrewInputSource || (BrewInputSource = {}));\r\nvar InputHandler;\r\n(function (InputHandler) {\r\n    InputHandler[InputHandler[\"Main\"] = 0] = \"Main\";\r\n    InputHandler[InputHandler[\"Targeting\"] = 1] = \"Targeting\";\r\n    InputHandler[InputHandler[\"ConfirmPaths\"] = 2] = \"ConfirmPaths\";\r\n    InputHandler[InputHandler[\"GenericMenu\"] = 3] = \"GenericMenu\";\r\n    InputHandler[InputHandler[\"WaitToDismiss\"] = 4] = \"WaitToDismiss\";\r\n    InputHandler[InputHandler[\"HeadsUpDisplay\"] = 5] = \"HeadsUpDisplay\";\r\n    InputHandler[InputHandler[\"HelpMenu\"] = 6] = \"HelpMenu\";\r\n})(InputHandler || (InputHandler = {}));\r\nvar ContextMenuItem;\r\n(function (ContextMenuItem) {\r\n    ContextMenuItem[ContextMenuItem[\"Drop\"] = 1] = \"Drop\";\r\n    ContextMenuItem[ContextMenuItem[\"Use\"] = 2] = \"Use\";\r\n    ContextMenuItem[ContextMenuItem[\"Throw\"] = 3] = \"Throw\"; // todo: replace these with generic menu items\r\n})(ContextMenuItem || (ContextMenuItem = {}));\r\nvar GenericMenuEntryType;\r\n(function (GenericMenuEntryType) {\r\n    GenericMenuEntryType[GenericMenuEntryType[\"Yes\"] = 1] = \"Yes\";\r\n    GenericMenuEntryType[GenericMenuEntryType[\"No\"] = 2] = \"No\";\r\n    GenericMenuEntryType[GenericMenuEntryType[\"InventoryItem\"] = 3] = \"InventoryItem\";\r\n    GenericMenuEntryType[GenericMenuEntryType[\"ItemContextAction\"] = 4] = \"ItemContextAction\";\r\n    // PowerSelect,\r\n    GenericMenuEntryType[GenericMenuEntryType[\"Quit\"] = 5] = \"Quit\";\r\n    GenericMenuEntryType[GenericMenuEntryType[\"EventBased\"] = 6] = \"EventBased\";\r\n    GenericMenuEntryType[GenericMenuEntryType[\"Cancel\"] = 7] = \"Cancel\";\r\n})(GenericMenuEntryType || (GenericMenuEntryType = {}));\r\nvar BrewTargetingMethod;\r\n(function (BrewTargetingMethod) {\r\n    BrewTargetingMethod[BrewTargetingMethod[\"PointOnly\"] = 0] = \"PointOnly\";\r\n    BrewTargetingMethod[BrewTargetingMethod[\"StraightLine\"] = 1] = \"StraightLine\";\r\n})(BrewTargetingMethod || (BrewTargetingMethod = {}));\r\nvar BrewTargetingAction;\r\n(function (BrewTargetingAction) {\r\n    BrewTargetingAction[BrewTargetingAction[\"Examine\"] = 0] = \"Examine\";\r\n    BrewTargetingAction[BrewTargetingAction[\"Teleport\"] = 1] = \"Teleport\";\r\n    BrewTargetingAction[BrewTargetingAction[\"ThrowItem\"] = 2] = \"ThrowItem\";\r\n    BrewTargetingAction[BrewTargetingAction[\"HeaveItem\"] = 3] = \"HeaveItem\";\r\n    BrewTargetingAction[BrewTargetingAction[\"RangedAttack\"] = 4] = \"RangedAttack\";\r\n    BrewTargetingAction[BrewTargetingAction[\"Hack\"] = 5] = \"Hack\";\r\n    BrewTargetingAction[BrewTargetingAction[\"RocketPunch\"] = 6] = \"RocketPunch\";\r\n    BrewTargetingAction[BrewTargetingAction[\"ThrowHeavyAxe\"] = 7] = \"ThrowHeavyAxe\";\r\n    BrewTargetingAction[BrewTargetingAction[\"DebugSummonMob\"] = 8] = \"DebugSummonMob\";\r\n    BrewTargetingAction[BrewTargetingAction[\"DebugMakeFeature\"] = 9] = \"DebugMakeFeature\";\r\n    BrewTargetingAction[BrewTargetingAction[\"DebugMakeTerrain\"] = 10] = \"DebugMakeTerrain\";\r\n})(BrewTargetingAction || (BrewTargetingAction = {}));\r\nvar BrewVisionSource;\r\n(function (BrewVisionSource) {\r\n    BrewVisionSource[BrewVisionSource[\"xNoVision\"] = 0] = \"xNoVision\";\r\n    BrewVisionSource[BrewVisionSource[\"xSelf\"] = 1] = \"xSelf\";\r\n    BrewVisionSource[BrewVisionSource[\"xRemote\"] = 2] = \"xRemote\";\r\n})(BrewVisionSource || (BrewVisionSource = {}));\r\nvar Flag;\r\n(function (Flag) {\r\n    Flag[Flag[\"Stunned\"] = 0] = \"Stunned\";\r\n    Flag[Flag[\"Immobile\"] = 1] = \"Immobile\";\r\n    Flag[Flag[\"PackAttack\"] = 2] = \"PackAttack\";\r\n    Flag[Flag[\"KeepsDistance\"] = 3] = \"KeepsDistance\";\r\n    Flag[Flag[\"SeeAll\"] = 4] = \"SeeAll\";\r\n    Flag[Flag[\"Invisible\"] = 5] = \"Invisible\";\r\n    Flag[Flag[\"RemoteScan\"] = 6] = \"RemoteScan\";\r\n    Flag[Flag[\"PhaseWalk\"] = 7] = \"PhaseWalk\";\r\n    Flag[Flag[\"Hacked\"] = 8] = \"Hacked\";\r\n    Flag[Flag[\"Flying\"] = 9] = \"Flying\";\r\n    Flag[Flag[\"Weak\"] = 10] = \"Weak\";\r\n    Flag[Flag[\"Invulnerable\"] = 11] = \"Invulnerable\";\r\n    Flag[Flag[\"CausesWeak\"] = 12] = \"CausesWeak\";\r\n    Flag[Flag[\"CausesStun\"] = 13] = \"CausesStun\";\r\n    Flag[Flag[\"CausesKnockback\"] = 14] = \"CausesKnockback\";\r\n    Flag[Flag[\"OnDeathKnockback\"] = 15] = \"OnDeathKnockback\";\r\n    Flag[Flag[\"CausesInvulnerable\"] = 16] = \"CausesInvulnerable\";\r\n    Flag[Flag[\"NeedsTargetLock\"] = 17] = \"NeedsTargetLock\";\r\n    Flag[Flag[\"Burnt\"] = 18] = \"Burnt\";\r\n    Flag[Flag[\"CausesExplosion\"] = 19] = \"CausesExplosion\";\r\n})(Flag || (Flag = {}));\r\nvar Team;\r\n(function (Team) {\r\n    Team[Team[\"Player\"] = 1] = \"Player\";\r\n    Team[Team[\"PlayerAllied\"] = 2] = \"PlayerAllied\";\r\n    Team[Team[\"Enemy\"] = 3] = \"Enemy\";\r\n})(Team || (Team = {}));\r\nvar PathmapCacheType;\r\n(function (PathmapCacheType) {\r\n    PathmapCacheType[PathmapCacheType[\"ToPlayer_Walk\"] = 0] = \"ToPlayer_Walk\";\r\n    PathmapCacheType[PathmapCacheType[\"ToPlayer_Fly\"] = 1] = \"ToPlayer_Fly\";\r\n    PathmapCacheType[PathmapCacheType[\"FromPlayer_Walk\"] = 2] = \"FromPlayer_Walk\";\r\n    PathmapCacheType[PathmapCacheType[\"FromPlayer_Fly\"] = 3] = \"FromPlayer_Fly\";\r\n})(PathmapCacheType || (PathmapCacheType = {}));\r\nvar LevelNavigationType;\r\n(function (LevelNavigationType) {\r\n    LevelNavigationType[LevelNavigationType[\"Walk\"] = 0] = \"Walk\";\r\n    LevelNavigationType[LevelNavigationType[\"Fly\"] = 1] = \"Fly\";\r\n    //walkable no items no exits\r\n    //ignore radiation\r\n    //walkable safe from radiation\r\n})(LevelNavigationType || (LevelNavigationType = {}));\r\nvar StatName;\r\n(function (StatName) {\r\n    StatName[StatName[\"Health\"] = 1] = \"Health\";\r\n    StatName[StatName[\"Shields\"] = 2] = \"Shields\";\r\n    StatName[StatName[\"PowerCharge\"] = 3] = \"PowerCharge\";\r\n    StatName[StatName[\"StrengthRank\"] = 4] = \"StrengthRank\";\r\n    StatName[StatName[\"Score\"] = 5] = \"Score\";\r\n})(StatName || (StatName = {}));\r\n// module Brew.Flags {\r\n//     export const keeps_distance : IBrewFlag = {\r\n//         // name: \"keeps_distance\",\r\n//         desc_player: null,\r\n//         desc_enemy: \"attacks from a distance\"\r\n//     }\r\n//     export const see_all : IBrewFlag = {\r\n//         desc_player: \"all-seeing\",\r\n//         desc_enemy: \"sees everywhere\"\r\n//     }\r\n//     export const is_invisible: IBrewFlag = {\r\n//         desc_player: \"is invisible\",\r\n//         desc_enemy: \"is invisible\"\r\n//     }\r\n// }\r\nvar MonsterStatus;\r\n(function (MonsterStatus) {\r\n    MonsterStatus[MonsterStatus[\"Sleep\"] = 0] = \"Sleep\";\r\n    MonsterStatus[MonsterStatus[\"Wander\"] = 1] = \"Wander\";\r\n    MonsterStatus[MonsterStatus[\"Hunt\"] = 2] = \"Hunt\";\r\n    MonsterStatus[MonsterStatus[\"Escape\"] = 3] = \"Escape\";\r\n})(MonsterStatus || (MonsterStatus = {}));\r\nvar DisplayNames;\r\n(function (DisplayNames) {\r\n    DisplayNames[DisplayNames[\"Game\"] = 0] = \"Game\";\r\n    // Layer,\r\n    DisplayNames[DisplayNames[\"HUD\"] = 1] = \"HUD\";\r\n    DisplayNames[DisplayNames[\"Footer\"] = 2] = \"Footer\";\r\n    DisplayNames[DisplayNames[\"Header\"] = 3] = \"Header\";\r\n})(DisplayNames || (DisplayNames = {}));\r\n// export enum BrewNoteType {\r\n//     StatusEffect,\r\n//     MonsterInfo\r\n// }\r\nvar BrewNoteType;\r\n(function (BrewNoteType) {\r\n    BrewNoteType[BrewNoteType[\"TimedEffect\"] = 0] = \"TimedEffect\";\r\n    BrewNoteType[BrewNoteType[\"Health\"] = 1] = \"Health\";\r\n    BrewNoteType[BrewNoteType[\"BehavioralFlag\"] = 2] = \"BehavioralFlag\";\r\n    BrewNoteType[BrewNoteType[\"Terrain\"] = 3] = \"Terrain\";\r\n    BrewNoteType[BrewNoteType[\"Feature\"] = 4] = \"Feature\";\r\n    BrewNoteType[BrewNoteType[\"NotableItem\"] = 5] = \"NotableItem\";\r\n    BrewNoteType[BrewNoteType[\"TargetingLock\"] = 6] = \"TargetingLock\";\r\n    BrewNoteType[BrewNoteType[\"Speed\"] = 7] = \"Speed\";\r\n})(BrewNoteType || (BrewNoteType = {}));\r\nvar FancyStepType;\r\n(function (FancyStepType) {\r\n    FancyStepType[FancyStepType[\"None\"] = 0] = \"None\";\r\n    FancyStepType[FancyStepType[\"Squarestep\"] = 1] = \"Squarestep\";\r\n    FancyStepType[FancyStepType[\"Lunge\"] = 2] = \"Lunge\";\r\n})(FancyStepType || (FancyStepType = {}));\r\nvar PowerUpgradeType;\r\n(function (PowerUpgradeType) {\r\n    PowerUpgradeType[PowerUpgradeType[\"IncreaseStrength\"] = 1] = \"IncreaseStrength\";\r\n    PowerUpgradeType[PowerUpgradeType[\"IncreaseNumberOfCharges\"] = 2] = \"IncreaseNumberOfCharges\";\r\n})(PowerUpgradeType || (PowerUpgradeType = {}));\r\nvar FiringArc;\r\n(function (FiringArc) {\r\n    FiringArc[FiringArc[\"OctantArc\"] = 1] = \"OctantArc\";\r\n    FiringArc[FiringArc[\"QuarterArc\"] = 2] = \"QuarterArc\";\r\n    FiringArc[FiringArc[\"ThreeOctantArc\"] = 3] = \"ThreeOctantArc\";\r\n    FiringArc[FiringArc[\"HalfArc\"] = 4] = \"HalfArc\";\r\n    FiringArc[FiringArc[\"ThreeQuarterArc\"] = 5] = \"ThreeQuarterArc\";\r\n    FiringArc[FiringArc[\"FullArc\"] = 6] = \"FullArc\";\r\n})(FiringArc || (FiringArc = {}));\r\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvYnJld19lbmdpbmUvZW51bXMudHM/MWZkYyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFFQSxJQUFZLDBCQUdYO0FBSEQsV0FBWSwwQkFBMEI7SUFDbEMsMkVBQUk7SUFDSiwyRUFBSTtBQUNSLENBQUMsRUFIVywwQkFBMEIsS0FBMUIsMEJBQTBCLFFBR3JDO0FBQ0QsSUFBWSxjQU9YO0FBUEQsV0FBWSxjQUFjO0lBQ3RCLHFEQUFTO0lBQ1QseURBQU87SUFDUCxtREFBSTtJQUNKLHlEQUFPO0lBQ1AseURBQU87SUFDUCxxREFBSztBQUNULENBQUMsRUFQVyxjQUFjLEtBQWQsY0FBYyxRQU96QjtBQUVELElBQVksYUFLWDtBQUxELFdBQVksYUFBYTtJQUNyQiwyREFBYTtJQUNiLGlFQUFZO0lBQ1osNkRBQVU7SUFDVix1REFBTztBQUNYLENBQUMsRUFMVyxhQUFhLEtBQWIsYUFBYSxRQUt4QjtBQUVELElBQVksYUFnRlg7QUFoRkQsV0FBWSxhQUFhO0lBQ3JCLG1EQUFLO0lBQ0wsaURBQUk7SUFDSixpREFBSTtJQUNKLGlEQUFJO0lBQ0oscURBQU07SUFDTixxREFBTTtJQUNOLGlEQUFJO0lBQ0osaURBQUk7SUFDSixtREFBSztJQUNMLHVEQUFPO0lBQ1AsZ0VBQVc7SUFDWCxnRUFBVztJQUNYLDhEQUFVO0lBQ1Ysa0RBQUk7SUFDSixvRUFBYTtJQUNiLHNFQUFjO0lBQ2QsNERBQVM7SUFDVCx3REFBTztJQUNQLGdFQUFXO0lBQ1gsZ0VBQVc7SUFDWCxrRUFBWTtJQUVaLHNFQUFjO0lBRWQsb0ZBQXFCO0lBQ3JCLDRFQUFpQjtJQUVqQixrRkFBb0I7SUFDcEIsNEZBQXlCO0lBQ3pCLGtGQUFvQjtJQUVwQixnRUFBVztJQUNYLHdFQUFlO0lBQ2Ysd0VBQWU7SUFDZixvRUFBYTtJQUViLGdFQUFXO0lBQ1gsb0VBQWE7SUFDYixnRUFBVztJQUNYLDBFQUFnQjtJQUVoQixvRUFBYTtJ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bURBQU07SUFDTixtRUFBYztJQUNkLHFEQUFPO0lBQ1AscURBQU87SUFDUCw2REFBVztJQUNYLGlFQUFhO0lBQ2IsaURBQUs7QUFDVCxDQUFDLEVBVFcsWUFBWSxLQUFaLFlBQVksUUFTdkI7QUFFRCxJQUFZLGFBSVg7QUFKRCxXQUFZLGFBQWE7SUFDckIsaURBQUk7SUFDSiw2REFBVTtJQUNWLG1EQUFLO0FBQ1QsQ0FBQyxFQUpXLGFBQWEsS0FBYixhQUFhLFFBSXhCO0FBT0QsSUFBWSxnQkFHWDtBQUhELFdBQVksZ0JBQWdCO0lBQ3hCLCtFQUFvQjtJQUNwQiw2RkFBdUI7QUFDM0IsQ0FBQyxFQUhXLGdCQUFnQixLQUFoQixnQkFBZ0IsUUFHM0I7QUFFRCxJQUFZLFNBT1g7QUFQRCxXQUFZLFNBQVM7SUFDakIsbURBQWE7SUFDYixxREFBVTtJQUNWLDZEQUFjO0lBQ2QsK0NBQU87SUFDUCwrREFBZTtJQUNmLCtDQUFPO0FBQ1gsQ0FBQyxFQVBXLFNBQVMsS0FBVCxTQUFTLFFBT3BCIiwiZmlsZSI6Ii4vc3JjL2JyZXdfZW5naW5lL2VudW1zLnRzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgQnJldyBmcm9tIFwiLi4vYnJld1wiXHJcblxyXG5leHBvcnQgZW51bSBDb21wb25lbnRQYXJ0c0J1aWxkaW5nVHlwZSB7XHJcbiAgICBOb25lLFxyXG4gICAgVGFuayxcclxufVxyXG5leHBvcnQgZW51bSBCcmV3T2JqZWN0VHlwZSB7XHJcbiAgICBUaGluZyA9IDEsXHJcbiAgICBUZXJyYWluLFxyXG4gICAgSXRlbSxcclxuICAgIE1vbnN0ZXIsXHJcbiAgICBGZWF0dXJlLFxyXG4gICAgQWJvdmVcclxufVxyXG5cclxuZXhwb3J0IGVudW0gQnJld1Bvd2VyVHlwZSB7XHJcbiAgICBFbXB0eU5vbmUgPSAxLFxyXG4gICAgVHVycmV0Q2Fubm9uLFxyXG4gICAgTWFjaGluZUd1bixcclxuICAgIFNjYW5uZXIsXHJcbn1cclxuXHJcbmV4cG9ydCBlbnVtIEJyZXdFdmVudFR5cGUge1xyXG4gICAgRXJyb3IsXHJcbiAgICBJbmZvLFxyXG4gICAgV2FpdCxcclxuICAgIE1vdmUsXHJcbiAgICBBdHRhY2ssXHJcbiAgICBQaWNrdXAsXHJcbiAgICBEcm9wLFxyXG4gICAgTGFuZCxcclxuICAgIEhlYXZlLFxyXG4gICAgVXNlSXRlbSxcclxuICAgIFNtYXNoQXR0YWNrLFxyXG4gICAgQXBwbHlEYW1hZ2UsXHJcbiAgICBNYXNzRGFtYWdlLFxyXG4gICAgSGFjayxcclxuICAgIEhlYXZ5QXhlVGhyb3csXHJcbiAgICBIZWF2eUF4ZVJlY2FsbCxcclxuICAgIFNoaWVsZHNVcCxcclxuICAgIENsb2FrT24sXHJcbiAgICBQaGFzZVdhbGtPbixcclxuICAgIFJvY2tldFB1bmNoLFxyXG4gICAgUnVuQW5pbWF0aW9uLFxyXG4gICAgXHJcbiAgICBQb3dlclVuaW5zdGFsbCxcclxuXHJcbiAgICBQb3dlclN3YXBTZWxlY3RNZW51T24sXHJcbiAgICBQb3dlclN3YXBGaW5hbGl6ZSxcclxuXHJcbiAgICBQb3dlckluc3RhbGxQcm9tcHRPbixcclxuICAgIFBvd2VySW5zdGFsbFJlcGxhY2VtZW50T24sXHJcbiAgICBQb3dlckluc3RhbGxGaW5hbGl6ZSxcclxuXHJcbiAgICBUYXJnZXRpbmdPbixcclxuICAgIFRhcmdldGluZ0NhbmNlbCxcclxuICAgIFRhcmdldGluZ0ZpbmlzaCxcclxuICAgIFRhcmdldGluZ01vdmUsXHJcbiAgICBcclxuICAgIEludmVudG9yeU9uLFxyXG4gICAgQ29udGV4dE1lbnVPbixcclxuICAgIFBvd2VyTWVudU9uLFxyXG4gICAgSGVhZHNVcERpc3BsYXlPbixcclxuXHJcbiAgICBHZW5lcmljTWVudU9uLFxyXG4gICAgR2VuZXJpY01lbnVNb3ZlLFxyXG4gICAgR2VuZXJpY01lbnVTZWxlY3QsXHJcbiAgICBHZW5lcmljTWVudU9mZixcclxuXHJcbiAgICBQbGF5ZXJEZWF0aCxcclxuICAgIFZpY3RvcnksXHJcbiAgICBSZXN0YXJ0R2FtZSxcclxuICAgIFVzZVBvcnRhbCxcclxuICAgIENoYW5nZUxldmVsLFxyXG5cclxuICAgIERlYnVnQ3JlYXRlTW9iTWVudU9uLFxyXG4gICAgRGVidWdDcmVhdGVNb2JBdCxcclxuICAgIFxyXG4gICAgRGVidWdDcmVhdGVGZWF0dXJlTWVudU9uLFxyXG4gICAgRGVidWdDcmVhdGVGZWF0dXJlQXQsXHJcbiAgICBcclxuICAgIERlYnVnQ3JlYXRlVGVycmFpbk1lbnVPbixcclxuICAgIERlYnVnQ3JlYXRlVGVycmFpbkF0LFxyXG5cclxuICAgIENvbmZpcm1QYXRoc09uLFxyXG4gICAgQ29uZmlybVBhdGhzRmluYWxpemUsXHJcbiAgICBDb25maXJtUGF0aHNDYW5jZWwsXHJcbiAgICBTcGVjaWFsLFxyXG5cclxuICAgIEtub2NrYmFjayxcclxuXHJcbiAgICBBY3F1aXJlVGFyZ2V0LFxyXG5cclxuICAgIFdhcnBCZWFjb25VcGdyYWRlUG93ZXIsXHJcbiAgICBXYXJwQmVhY29uSW5jcmVhc2VQb3dlcixcclxuICAgIFdhcnBCZWFjb25SZWNoYXJnZVBvd2VyLFxyXG4gICAgV2FycEJlYWNvbkhlYWwsXHJcbiAgICBXYXJwQmVhY29uQWxseURyb3AsXHJcblxyXG4gICAgUm90YXRlQm9keSxcclxuICAgIFJvdGF0ZVdlYXBvbixcclxuICAgIEhlbHBPbixcclxufVxyXG5cclxuLy8gZXhwb3J0IGludGVyZmFjZSBJQ29udGV4dE1lbnVEYXRhIHtcclxuLy8gICAgIGl0ZW0/OiBCcmV3Lkl0ZW0sXHJcbi8vICAgICBjb250ZXh0X2xpc3Q6IEFycmF5PENvbnRleHRNZW51SXRlbT5cclxuLy8gICAgIHNlbGVjdGVkX2luZGV4OiBudW1iZXJcclxuLy8gfVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBJRGlzcGxheU9wdGlvbnMge1xyXG4gICAgYmxhY2tBbmRXaGl0ZU1vZGU/OiBib29sZWFuXHJcbn1cclxuXHJcbi8vIG1haW4gYnJldyBldmVudCAtPiB0YWNrIG9uIGV4dHJhIGRhdGEgYXMgbmVjZXNzYXJ5LCBhY2NvcmRpbmcgdG8gdHlwZVxyXG5leHBvcnQgaW50ZXJmYWNlIElCcmV3RXZlbnQgZXh0ZW5kcyBJQnJld0V4dHJhRXZlbnREYXRhIHtcclxuICAgIGV2ZW50VHlwZTogQnJld0V2ZW50VHlwZSxcclxuICAgIGFjdG9yOiBCcmV3LkdyaWRUaGluZ3MuTW9uc3RlcixcclxuICAgIGVuZHNUdXJuPzogYm9vbGVhbixcclxuICAgIHBsYXllckluaXRpYXRlZD86IGJvb2xlYW4sXHJcbiAgICBlcnJvck1zZz86IHN0cmluZyxcclxuICAgIC8vIGV2ZW50RGF0YT86IGFueSwgLy8gZ2VuZXJpYyBkYXRhXHJcblxyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIElCcmV3RXh0cmFFdmVudERhdGEge1xyXG4gICAgLy8gc3BlY2lhbGl6ZWQgZXZlbnQgZGF0YVxyXG4gICAgbW92ZURhdGE/OiBJQnJld01vdmVFdmVudERhdGEsXHJcbiAgICB0YXJnZXRpbmdEYXRhPzogSUJyZXdUYXJnZXRpbmdEYXRhLFxyXG4gICAgZGFtYWdlRGF0YT86IElCcmV3RGFtYWdlRXZlbnREYXRhLFxyXG4gICAgYXR0YWNrRGF0YT86IElCcmV3QXR0YWNrRXZlbnREYXRhLFxyXG4gICAgYW5pbWF0aW9uRGF0YT86IElCcmV3QW5pbWF0aW9uRXZlbnREYXRhLFxyXG4gICAgaXRlbURhdGE/OiBJQnJld0l0ZW1FdmVudERhdGEsXHJcbiAgICBwb3dlckRhdGE/OiBJQnJld1Bvd2VyRXZlbnREYXRhLFxyXG4gICAgc3dhcFBvd2VyRGF0YT86IElCcmV3UG93ZXJFdmVudERhdGEsXHJcbiAgICBzdGFydFRhcmdldGluZ0RhdGE/OiBJQnJld1N0YXJ0VGFyZ2V0aW5nRXZlbnREYXRhLFxyXG4gICAgcG9ydGFsRGF0YT86IElCcmV3UG9ydGFsRXZlbnREYXRhLFxyXG4gICAgb2Zmc2V0RGF0YT86IElCcmV3T2Zmc2V0RXZlbnREYXRhLFxyXG4gICAgaW52ZW50b3J5RGF0YT86IElCcmV3SW52ZW50b3J5RXZlbnREYXRhLFxyXG4gICAgY29udGV4dE1lbnVEYXRhPzogSUJyZXdDb250ZXh0TWVudURhdGFcclxuICAgIGdlbmVyaWNNZW51RGF0YT86IElCcmV3R2VuZXJpY01lbnVFdmVudERhdGEsXHJcbiAgICBjb25maXJtUGF0aHNEYXRhPzogSUJyZXdDb25maXJtUGF0aHNFdmVudERhdGEsXHJcbiAgICBkZWJ1Z01lbnVEYXRhPzogSUJyZXdEZWJ1Z01lbnVFdmVudERhdGEsXHJcbiAgICBwYXRoc0RhdGE/OiBJQnJld1BhdGhFdmVudERhdGEsXHJcbiAgICBrbm9ja2JhY2tEYXRhPzogSUJyZXdLbm9ja2JhY2tFdmVudERhdGEsXHJcbiAgICByZXN0YXJ0RGF0YT86IElCcmV3UmVzdGFydEV2ZW50RGF0YSxcclxuICAgIGhlYWRzVXBEYXRhPzogSUJyZXdIZWFkc1VwRXZlbnREYXRhLFxyXG4gICAgcm90YXRlRGF0YT86IElCcmV3Um90YXRlRXZlbnREYXRhLFxyXG4gICAgaGVscERhdGE/OiBJQnJld0hlbHBFdmVudERhdGEsXHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgSUJyZXdSb3RhdGVFdmVudERhdGEge1xyXG4gICAgb2xkX2ZhY2luZ194eTogQnJldy5Db29yZGluYXRlLFxyXG4gICAgbmV3X2ZhY2luZ194eTogQnJldy5Db29yZGluYXRlLFxyXG4gICAgd2VhcG9uUG93ZXI/OiBCcmV3LlBvd2Vycy5Qb3dlclxyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIElCcmV3SGVscEV2ZW50RGF0YSB7XHJcbiAgICBzZWxlY3RlZF9pbmRleDogbnVtYmVyLFxyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIElCcmV3SGVhZHNVcEV2ZW50RGF0YSB7XHJcbiAgICBoZWFkc1VwRGlzcGxheU5vdGVQYWdlczogQXJyYXk8QnJldy5IVUQuSUhlYWRzVXBQYWdlPixcclxuICAgIHNlbGVjdGVkX2luZGV4OiBudW1iZXIsXHJcbn1cclxuXHJcbi8vIGV4cG9ydCBlbnVtIEJyZXdIZWFkc1VwRGlzcGxheVR5cGUge1xyXG4vLyAgICAgSGVhbHRoQW5kU3RhdHVzLFxyXG4vLyAgICAgTW9uc3Rlck5hbWVzLFxyXG4vLyAgICAgQmVoYXZpb3JhbEZsYWdzLFxyXG4vLyAgICAgVGVycmFpbkFuZEZlYXR1cmVzLFxyXG4vLyAgICAgSXRlbXNJblZpZXcsXHJcbi8vIH1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgSUJyZXdQYXRoRXZlbnREYXRhIHtcclxuICAgIGZyb21feHk6IEJyZXcuQ29vcmRpbmF0ZSxcclxuICAgIHRvX3h5OiBCcmV3LkNvb3JkaW5hdGUsXHJcbiAgICBwYXRoOiBBcnJheTxCcmV3LkNvb3JkaW5hdGU+XHJcbn1cclxuXHJcbi8vIHNwZWNpYWxpemVkIGV2ZW50IGRhdGFcclxuZXhwb3J0IGludGVyZmFjZSBJQnJld01vdmVFdmVudERhdGEge1xyXG4gICAgZnJvbV94eTogQnJldy5Db29yZGluYXRlLFxyXG4gICAgdG9feHk6IEJyZXcuQ29vcmRpbmF0ZVxyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIElDb29yZGluYXRlQ29sb3JQYWlyIHtcclxuICAgIHh5OiBCcmV3LkNvb3JkaW5hdGUsXHJcbiAgICBjb2xvcjogbnVtYmVyW11cclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBJQnJld0NvbmZpcm1QYXRoc0V2ZW50RGF0YSB7XHJcbiAgICBmb2xsb3dfZXZlbnQ6IElCcmV3RXZlbnQsXHJcbiAgICBoaWdobGlnaHRzOiBBcnJheTxJQ29vcmRpbmF0ZUNvbG9yUGFpcj4sXHJcbiAgICB2YWxpZF9wYXRoOiBib29sZWFuLFxyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIElCcmV3UG9ydGFsRXZlbnREYXRhIHtcclxuICAgIHBvcnRhbF91c2VkOiBCcmV3LlBvcnRhbFxyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIElCcmV3UmVzdGFydEV2ZW50RGF0YSB7XHJcbiAgICBzZWVkOiBudW1iZXJcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBJQnJld0l0ZW1FdmVudERhdGEge1xyXG4gICAgaXRlbTogQnJldy5HcmlkVGhpbmdzLkl0ZW0sXHJcbiAgICBpbnZrZXk/OiBzdHJpbmcsXHJcbiAgICB0b194eT86IEJyZXcuQ29vcmRpbmF0ZSxcclxuICAgIC8vIGZyb21feHk/OiBCcmV3LkNvb3JkaW5hdGUsXHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgSUJyZXdQb3dlckV2ZW50RGF0YSB7XHJcbiAgICBwb3dlcjogQnJldy5Qb3dlcnMuUG93ZXJcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBJQnJld0ludmVudG9yeUV2ZW50RGF0YSB7XHJcbiAgICBpbnZlbnRvcnk/OiBCcmV3LkludmVudG9yeSxcclxuICAgIHNlbGVjdGVkX2l0ZW1faW5kZXg/OiBudW1iZXIsXHJcbiAgICBkaXJlY3Rpb24/OiBudW1iZXIsXHJcbiAgICBpdGVtPzogQnJldy5HcmlkVGhpbmdzLkl0ZW0sXHJcbiAgICBpbnZrZXk/OiBzdHJpbmdcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBJQnJld0NvbnRleHRNZW51RGF0YSB7XHJcbiAgICBjb250ZXh0X2xpc3Q/OiBBcnJheTxDb250ZXh0TWVudUl0ZW0+LFxyXG4gICAgc2VsZWN0ZWRfaXRlbV9pbmRleD86IG51bWJlcixcclxuICAgIGRpcmVjdGlvbj86IG51bWJlcixcclxuICAgIGl0ZW0/OiBCcmV3LkdyaWRUaGluZ3MuSXRlbSxcclxuICAgIGludmtleT86IHN0cmluZ1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIElCcmV3U3RhcnRUYXJnZXRpbmdFdmVudERhdGEge1xyXG4gICAgZnJvbV94eTogQnJldy5Db29yZGluYXRlLFxyXG4gICAgdG9feHk6IEJyZXcuQ29vcmRpbmF0ZSxcclxuICAgIHRhcmdldGluZ0FjdGlvbjogQnJld1RhcmdldGluZ0FjdGlvbixcclxuICAgIG1pbmltdW1BcmM/OiBudW1iZXIsXHJcbiAgICBtYXhpbXVtQXJjPzogbnVtYmVyLFxyXG4gICAgbWlkcG9pbnRBcmM/OiBudW1iZXIsXHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgSUJyZXdPZmZzZXRFdmVudERhdGEge1xyXG4gICAgb2Zmc2V0X3h5OiBCcmV3LkNvb3JkaW5hdGVcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBJQnJld1RhcmdldGluZ0RhdGEge1xyXG4gICAgb3JpZ2luX3h5OiBCcmV3LkNvb3JkaW5hdGUgXHJcbiAgICBmcm9tX3h5OiBCcmV3LkNvb3JkaW5hdGUsXHJcbiAgICB0b194eTogQnJldy5Db29yZGluYXRlLFxyXG4gICAgbWV0aG9kOiBCcmV3VGFyZ2V0aW5nTWV0aG9kLFxyXG4gICAgYWN0aW9uOiBCcmV3VGFyZ2V0aW5nQWN0aW9uLFxyXG4gICAgZGVzdGluYXRpb25NdXN0QmVXYWxrYWJsZTogYm9vbGVhbixcclxuICAgIGRlc3RpbmF0aW9uTXVzdEJlVmlzaWJsZTogYm9vbGVhbixcclxuICAgIGRlc3RpbmF0aW9uTXVzdEhhdmVNb2I6IGJvb2xlYW4sXHJcbiAgICBwYXRoQmxvY2tlZEJ5Tm9uV2Fsa2FibGU6IGJvb2xlYW4sXHJcbiAgICBwYXRoQmxvY2tlZEJ5Tm9uRmx5YWJsZTogYm9vbGVhbixcclxuICAgIHBhdGhCbG9ja2VkQnlNb2JzOiBib29sZWFuLFxyXG4gICAgbWluaW11bURpc3RhbmNlOiBudW1iZXIsXHJcbiAgICBtYXhpbXVtRGlzdGFuY2U/OiBudW1iZXIsXHJcbiAgICBtaW5pbXVtQXJjPzogbnVtYmVyLFxyXG4gICAgbWF4aW11bUFyYz86IG51bWJlcixcclxuICAgIG1pZHBvaW50QXJjPzogbnVtYmVyLFxyXG4gICAgcGF0aD86IEFycmF5PEJyZXcuQ29vcmRpbmF0ZT5cclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBJQnJld0F0dGFja0V2ZW50RGF0YSB7XHJcbiAgICBmcm9tX3h5OiBCcmV3LkNvb3JkaW5hdGUsXHJcbiAgICB0b194eTogQnJldy5Db29yZGluYXRlLFxyXG4gICAgdGFyZ2V0OiBCcmV3LkdyaWRUaGluZ3MuTW9uc3RlcixcclxuICAgIGlzTWVsZWU6IGJvb2xlYW4sXHJcbiAgICBkYW1hZ2U6IG51bWJlcixcclxuICAgIGVmZmVjdHM/OiBBcnJheTxCcmV3LkVudW1zLkZsYWc+LFxyXG4gICAgYmVoaW5kX3h5PzogQnJldy5Db29yZGluYXRlLFxyXG4gICAgLy8gZG9udEFuaW1hdGU/OiBib29sZWFuXHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgSUJyZXdEYW1hZ2VFdmVudERhdGEge1xyXG4gICAgdGFyZ2V0OiBCcmV3LkdyaWRUaGluZ3MuTW9uc3RlcixcclxuICAgIGRhbWFnZVRvU2hpZWxkczogbnVtYmVyLFxyXG4gICAgZGFtYWdlVG9IUDogbnVtYmVyLFxyXG4gICAgc2hpZWxkVXNlZDogQnJldy5Qb3dlcnMuUG93ZXIsXHJcbiAgICBpc0ZhdGFsOiBib29sZWFuLFxyXG4gICAgZWZmZWN0cz86IEFycmF5PEJyZXcuRW51bXMuRmxhZz5cclxufVxyXG5cclxuZXhwb3J0IGVudW0gQnJld0FuaW1hdGlvblR5cGUge1xyXG4gICAgRmxhc2gsXHJcbiAgICBPdmVyUGF0aCxcclxuICAgIENpcmNsZU91dCxcclxuICAgIENpcmNsZUluLFxyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIElCcmV3QW5pbWF0aW9uRXZlbnREYXRhIHtcclxuICAgIGFuaW1hdGlvblR5cGU6IEJyZXdBbmltYXRpb25UeXBlXHJcbiAgICBmcm9tX3h5OiBCcmV3LkNvb3JkaW5hdGVcclxuICAgIHRvX3h5OiBCcmV3LkNvb3JkaW5hdGVcclxuICAgIHBhdGg/OiBBcnJheTxCcmV3LkNvb3JkaW5hdGU+XHJcbiAgICBjb2xvcj86IG51bWJlcltdXHJcbiAgICBjb2RlPzogc3RyaW5nXHJcbiAgICByYW5nZT86IG51bWJlclxyXG4gICAgLy9hbmltYXRpb25TcGVlZD86IG51bWJlclxyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIElCcmV3S25vY2tiYWNrRXZlbnREYXRhIHtcclxuICAgIHRhcmdldDogQnJldy5HcmlkVGhpbmdzLk1vbnN0ZXIsXHJcbiAgICBvcmlnaW5feHk6IEJyZXcuQ29vcmRpbmF0ZSxcclxuICAgIG1hZ25pdHVkZTogbnVtYmVyXHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgSUJyZXdHZW5lcmljTWVudUVudHJ5IHtcclxuICAgIGVudHJ5VHlwZTogR2VuZXJpY01lbnVFbnRyeVR5cGUsXHJcbiAgICBlbnRyeUV2ZW50OiBCcmV3LkVudW1zLklCcmV3RXZlbnQsXHJcbiAgICBlbnRyeU5hbWU/OiBzdHJpbmcsXHJcbiAgICBlbnRyeURlc2NyaXB0aW9uPzogc3RyaW5nLFxyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIElCcmV3RGVidWdNZW51RXZlbnREYXRhIHtcclxuICAgIG1vbnN0ZXJUeXBlRGVmaW5pdGlvbj86IEJyZXcuRGVmaW5pdGlvbnMuTW9uc3RlclR5cGVcclxuICAgIGZlYXR1cmVUeXBlRGVmaW5pdGlvbj86IEJyZXcuRGVmaW5pdGlvbnMuRmVhdHVyZVR5cGVcclxuICAgIHRlcnJhaW5UeXBlRGVmaW5pdGlvbj86IEJyZXcuRGVmaW5pdGlvbnMuVGVycmFpblR5cGVcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBJQnJld0dlbmVyaWNNZW51RXZlbnREYXRhIHtcclxuICAgIG1lbnVUaXRsZTogc3RyaW5nLFxyXG4gICAgbWVudURlc2NyaXB0aW9uPzogc3RyaW5nLFxyXG4gICAgYWxsb3dDYW5jZWw6IGJvb2xlYW4sXHJcbiAgICBtZW51RW50cmllc0xpc3Q/OiBBcnJheTxJQnJld0dlbmVyaWNNZW51RW50cnk+LFxyXG4gICAgc2VsZWN0ZWRfaW5kZXg/OiBudW1iZXIsXHJcbiAgICBkaXJlY3Rpb24/OiBudW1iZXJcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBJQnJld1R1cm5EYXRhIHtcclxuICAgIGFjdG9yOiBCcmV3LkdyaWRUaGluZ3MuTW9uc3RlclxyXG59XHJcblxyXG5leHBvcnQgZW51bSBCcmV3SW5wdXRTb3VyY2Uge1xyXG4gICAgS2V5Ym9hcmQsXHJcbiAgICBNb3VzZSxcclxuICAgIFRvdWNoXHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgSUJyZXdJbnB1dERhdGEge1xyXG4gICAgc291cmNlOiBCcmV3SW5wdXRTb3VyY2UsXHJcbiAgICBjb2RlPzogbnVtYmVyLFxyXG4gICAgYnV0dG9uPzogbnVtYmVyLFxyXG4gICAganNldmVudD86IGFueVxyXG59XHJcblxyXG5leHBvcnQgZW51bSBJbnB1dEhhbmRsZXIge1xyXG4gICAgTWFpbixcclxuICAgIFRhcmdldGluZyxcclxuICAgIENvbmZpcm1QYXRocyxcclxuICAgIEdlbmVyaWNNZW51LFxyXG4gICAgV2FpdFRvRGlzbWlzcyxcclxuICAgIEhlYWRzVXBEaXNwbGF5LFxyXG4gICAgSGVscE1lbnUsXHJcbn1cclxuXHJcbmV4cG9ydCBlbnVtIENvbnRleHRNZW51SXRlbSB7XHJcbiAgICBEcm9wID0gMSxcclxuICAgIFVzZSxcclxuICAgIFRocm93IC8vIHRvZG86IHJlcGxhY2UgdGhlc2Ugd2l0aCBnZW5lcmljIG1lbnUgaXRlbXNcclxufVxyXG5cclxuZXhwb3J0IGVudW0gR2VuZXJpY01lbnVFbnRyeVR5cGUge1xyXG4gICAgWWVzID0gMSxcclxuICAgIE5vLFxyXG4gICAgSW52ZW50b3J5SXRlbSxcclxuICAgIEl0ZW1Db250ZXh0QWN0aW9uLFxyXG4gICAgLy8gUG93ZXJTZWxlY3QsXHJcbiAgICBRdWl0LFxyXG4gICAgRXZlbnRCYXNlZCxcclxuICAgIENhbmNlbFxyXG59XHJcblxyXG5leHBvcnQgZW51bSBCcmV3VGFyZ2V0aW5nTWV0aG9kIHtcclxuICAgIFBvaW50T25seSxcclxuICAgIFN0cmFpZ2h0TGluZVxyXG59XHJcblxyXG5leHBvcnQgZW51bSBCcmV3VGFyZ2V0aW5nQWN0aW9uIHtcclxuICAgIEV4YW1pbmUsXHJcbiAgICBUZWxlcG9ydCxcclxuICAgIFRocm93SXRlbSxcclxuICAgIEhlYXZlSXRlbSxcclxuICAgIFJhbmdlZEF0dGFjayxcclxuICAgIEhhY2ssXHJcbiAgICBSb2NrZXRQdW5jaCxcclxuICAgIFRocm93SGVhdnlBeGUsXHJcbiAgICBEZWJ1Z1N1bW1vbk1vYixcclxuICAgIERlYnVnTWFrZUZlYXR1cmUsXHJcbiAgICBEZWJ1Z01ha2VUZXJyYWluLFxyXG59XHJcblxyXG5leHBvcnQgZW51bSBCcmV3VmlzaW9uU291cmNlIHtcclxuICAgIHhOb1Zpc2lvbixcclxuICAgIHhTZWxmLFxyXG4gICAgeFJlbW90ZVxyXG59XHJcblxyXG5leHBvcnQgZW51bSBGbGFnIHtcclxuICAgIFN0dW5uZWQsXHJcbiAgICBJbW1vYmlsZSxcclxuICAgIFBhY2tBdHRhY2ssXHJcbiAgICBLZWVwc0Rpc3RhbmNlLFxyXG4gICAgU2VlQWxsLFxyXG4gICAgSW52aXNpYmxlLFxyXG4gICAgUmVtb3RlU2NhbixcclxuICAgIFBoYXNlV2FsayxcclxuICAgIEhhY2tlZCxcclxuICAgIEZseWluZyxcclxuICAgIFdlYWssXHJcbiAgICBJbnZ1bG5lcmFibGUsXHJcbiAgICBDYXVzZXNXZWFrLFxyXG4gICAgQ2F1c2VzU3R1bixcclxuICAgIENhdXNlc0tub2NrYmFjayxcclxuICAgIE9uRGVhdGhLbm9ja2JhY2ssXHJcbiAgICBDYXVzZXNJbnZ1bG5lcmFibGUsXHJcbiAgICBOZWVkc1RhcmdldExvY2ssXHJcbiAgICBCdXJudCxcclxuICAgIENhdXNlc0V4cGxvc2lvbixcclxufVxyXG5cclxuZXhwb3J0IGVudW0gVGVhbSB7XHJcbiAgICBQbGF5ZXIgPSAxLFxyXG4gICAgUGxheWVyQWxsaWVkLFxyXG4gICAgRW5lbXlcclxufVxyXG5cclxuZXhwb3J0IGVudW0gUGF0aG1hcENhY2hlVHlwZSB7XHJcbiAgICBUb1BsYXllcl9XYWxrLFxyXG4gICAgVG9QbGF5ZXJfRmx5LFxyXG4gICAgRnJvbVBsYXllcl9XYWxrLFxyXG4gICAgRnJvbVBsYXllcl9GbHlcclxufVxyXG5cclxuZXhwb3J0IGVudW0gTGV2ZWxOYXZpZ2F0aW9uVHlwZSB7XHJcbiAgICBXYWxrLFxyXG4gICAgRmx5XHJcbiAgICAvL3dhbGthYmxlIG5vIGl0ZW1zIG5vIGV4aXRzXHJcbiAgICAvL2lnbm9yZSByYWRpYXRpb25cclxuICAgIC8vd2Fsa2FibGUgc2FmZSBmcm9tIHJhZGlhdGlvblxyXG59XHJcblxyXG5leHBvcnQgZW51bSBTdGF0TmFtZSB7XHJcbiAgICBIZWFsdGggPSAxLFxyXG4gICAgU2hpZWxkcyxcclxuICAgIFBvd2VyQ2hhcmdlLFxyXG4gICAgU3RyZW5ndGhSYW5rLFxyXG4gICAgU2NvcmUsXHJcbn1cclxuXHJcblxyXG5cclxuXHJcbi8vIG1vZHVsZSBCcmV3LkZsYWdzIHtcclxuLy8gICAgIGV4cG9ydCBjb25zdCBrZWVwc19kaXN0YW5jZSA6IElCcmV3RmxhZyA9IHtcclxuLy8gICAgICAgICAvLyBuYW1lOiBcImtlZXBzX2Rpc3RhbmNlXCIsXHJcbi8vICAgICAgICAgZGVzY19wbGF5ZXI6IG51bGwsXHJcbi8vICAgICAgICAgZGVzY19lbmVteTogXCJhdHRhY2tzIGZyb20gYSBkaXN0YW5jZVwiXHJcbi8vICAgICB9XHJcbi8vICAgICBleHBvcnQgY29uc3Qgc2VlX2FsbCA6IElCcmV3RmxhZyA9IHtcclxuLy8gICAgICAgICBkZXNjX3BsYXllcjogXCJhbGwtc2VlaW5nXCIsXHJcbi8vICAgICAgICAgZGVzY19lbmVteTogXCJzZWVzIGV2ZXJ5d2hlcmVcIlxyXG4vLyAgICAgfVxyXG4vLyAgICAgZXhwb3J0IGNvbnN0IGlzX2ludmlzaWJsZTogSUJyZXdGbGFnID0ge1xyXG4vLyAgICAgICAgIGRlc2NfcGxheWVyOiBcImlzIGludmlzaWJsZVwiLFxyXG4vLyAgICAgICAgIGRlc2NfZW5lbXk6IFwiaXMgaW52aXNpYmxlXCJcclxuLy8gICAgIH1cclxuLy8gfVxyXG5leHBvcnQgZW51bSBNb25zdGVyU3RhdHVzIHtcclxuICAgIFNsZWVwLFxyXG4gICAgV2FuZGVyLFxyXG4gICAgSHVudCxcclxuICAgIEVzY2FwZVxyXG59XHJcblxyXG5leHBvcnQgZW51bSBEaXNwbGF5TmFtZXMge1xyXG4gICAgR2FtZSxcclxuICAgIC8vIExheWVyLFxyXG4gICAgSFVELFxyXG4gICAgRm9vdGVyLFxyXG4gICAgSGVhZGVyLFxyXG59XHJcblxyXG4vLyBleHBvcnQgZW51bSBCcmV3Tm90ZVR5cGUge1xyXG4vLyAgICAgU3RhdHVzRWZmZWN0LFxyXG4vLyAgICAgTW9uc3RlckluZm9cclxuLy8gfVxyXG5cclxuZXhwb3J0IGVudW0gQnJld05vdGVUeXBlIHtcclxuICAgIFRpbWVkRWZmZWN0LFxyXG4gICAgSGVhbHRoLFxyXG4gICAgQmVoYXZpb3JhbEZsYWcsXHJcbiAgICBUZXJyYWluLFxyXG4gICAgRmVhdHVyZSxcclxuICAgIE5vdGFibGVJdGVtLFxyXG4gICAgVGFyZ2V0aW5nTG9jayxcclxuICAgIFNwZWVkLFxyXG59XHJcblxyXG5leHBvcnQgZW51bSBGYW5jeVN0ZXBUeXBlIHtcclxuICAgIE5vbmUsXHJcbiAgICBTcXVhcmVzdGVwLFxyXG4gICAgTHVuZ2UsXHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgSUNoYXJBbmRDb2xvciB7XHJcbiAgICBjaGFyOiBzdHJpbmcsXHJcbiAgICBjb2xvcjogQnJldy5Db2xvci5JQ29sb3JcclxufVxyXG5cclxuZXhwb3J0IGVudW0gUG93ZXJVcGdyYWRlVHlwZSB7XHJcbiAgICBJbmNyZWFzZVN0cmVuZ3RoID0gMSxcclxuICAgIEluY3JlYXNlTnVtYmVyT2ZDaGFyZ2VzXHJcbn1cclxuXHJcbmV4cG9ydCBlbnVtIEZpcmluZ0FyYyB7XHJcbiAgICBPY3RhbnRBcmMgPSAxLFxyXG4gICAgUXVhcnRlckFyYyxcclxuICAgIFRocmVlT2N0YW50QXJjLFxyXG4gICAgSGFsZkFyYyxcclxuICAgIFRocmVlUXVhcnRlckFyYyxcclxuICAgIEZ1bGxBcmMsXHJcbn1cclxuXHJcbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/brew_engine/enums.ts\n");

/***/ }),

/***/ "./src/brew_engine/events.ts":
/*!***********************************!*\
  !*** ./src/brew_engine/events.ts ***!
  \***********************************/
/*! exports provided: mainEventhandler, createGenericEventOfType, addDataToEvent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"mainEventhandler\", function() { return mainEventhandler; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"createGenericEventOfType\", function() { return createGenericEventOfType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"addDataToEvent\", function() { return addDataToEvent; });\n/* harmony import */ var _brew__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../brew */ \"./src/brew.ts\");\n/* harmony import */ var _start__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../start */ \"./src/start.ts\");\n\r\n\r\n// called from postal.js channel\r\nfunction mainEventhandler(gm, data, envelope) {\r\n    if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.Error) {\r\n        if (data.errorMsg) {\r\n            console.log(data.errorMsg);\r\n        }\r\n        return;\r\n    }\r\n    if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.Info) {\r\n        display_info(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.Move) {\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"Movement\"].move(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.RotateBody) {\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"Tank\"].rotate_body(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.RotateWeapon) {\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"Tank\"].rotate_weapon(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.HelpOn) {\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"Menus\"].showHelpMenu(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.Wait) {\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"Movement\"].rest(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.Pickup) {\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"ItemInteraction\"].pickup(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.Drop) {\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"ItemInteraction\"].dropItemAttempt(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.Land) {\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"ItemInteraction\"].doLandingEventAfterThrown(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.Heave) {\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"ItemInteraction\"].doLandingEventAfterHeave(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.UseItem) {\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"ItemInteraction\"].useItem(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.Special) {\r\n        special(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.ApplyDamage) {\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"Combat\"].applyDamage(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.Attack) {\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"Combat\"].attack(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.SmashAttack) {\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"Combat\"].smash_attack(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.Hack) {\r\n        remote_hack(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.ShieldsUp) {\r\n        shields_up(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.CloakOn) {\r\n        cloak_on(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.PhaseWalkOn) {\r\n        phasewalk_on(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.RocketPunch) {\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"Powers\"].rocketPunch(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.TargetingOn) {\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"Targeting\"].targetingOn(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.TargetingCancel) {\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"Targeting\"].targetingCancel(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.TargetingFinish) {\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"Targeting\"].targetingFinish(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.TargetingMove) {\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"Targeting\"].targetingMove(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.InventoryOn) {\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"Menus\"].showInventoryList(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.ContextMenuOn) {\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"Menus\"].showContextMenu(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.HeadsUpDisplayOn) {\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"Menus\"].showHeadsUpDisplay(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.PowerMenuOn) {\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"Menus\"].showPowerManagementMenu(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.PowerUninstall) {\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"Powers\"].uninstallPower(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.PowerSwapSelectMenuOn) {\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"Menus\"].showPowerSwapSelectMenu(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.PowerSwapFinalize) {\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"Powers\"].swapPower(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.PowerInstallPromptOn) {\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"Menus\"].showPowerInstallPromptMenu(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.PowerInstallReplacementOn) {\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"Menus\"].showPowerInstallSelectMenu(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.PowerInstallFinalize) {\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"Powers\"].installPower(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.PlayerDeath) {\r\n        game_over(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.Victory) {\r\n        game_victory(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.RestartGame) {\r\n        restart_game(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.UsePortal) {\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"Movement\"].triggerPortalUse(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.ChangeLevel) {\r\n        change_level(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.RunAnimation) {\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"Animations\"].runAnimationEvent(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.GenericMenuOn) {\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"Menus\"].showGenericMenu(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.GenericMenuOff) {\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"Menus\"].stopShowingGenericMenu(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.GenericMenuMove) {\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"Menus\"].updateGenericMenu(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.GenericMenuSelect) {\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"Menus\"].selectFromGenericMenu(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.ConfirmPathsOn) {\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"Menus\"].showConfirmPaths(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.ConfirmPathsFinalize) {\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"Menus\"].finalizeConfirmPaths(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.ConfirmPathsCancel) {\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"Menus\"].cancelConfirmPaths(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.HeavyAxeThrow) {\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"Powers\"].throw_axe(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.HeavyAxeRecall) {\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"Powers\"].recall_axe(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.DebugCreateMobMenuOn) {\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"Debug\"].showCreateMonsterAtMenu(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.DebugCreateMobAt) {\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"Debug\"].createMonsterAt(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.DebugCreateFeatureMenuOn) {\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"Debug\"].showCreateFeatureAtMenu(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.DebugCreateFeatureAt) {\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"Debug\"].createFeatureAt(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.DebugCreateTerrainAt) {\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"Debug\"].createTerrainAt(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.DebugCreateTerrainMenuOn) {\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"Debug\"].showCreateTerrainAtMenu(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.MassDamage) {\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"Combat\"].applyMassDamage(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.Knockback) {\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"Movement\"].knockback(gm, data);\r\n    }\r\n    else if (data.eventType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.AcquireTarget) {\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"Targeting\"].aquireTargetLockEvent(gm, data);\r\n    }\r\n    else {\r\n        console.error(\"received unknown event type\", data);\r\n    }\r\n}\r\nfunction change_level(gm, data) {\r\n    let portal = data.portalData.portal_used;\r\n    let level_audit = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Tank\"].processInventory(gm);\r\n    gm.getCurrentLevel().monsters.removeAt(gm.getPlayer().location);\r\n    gm.setupLevel(portal.dest_level_id, portal.dest_location_xy);\r\n    // gm.displayAll()\r\n    gm.insertEvent(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Tank\"].getLevelAuditReport(gm, level_audit));\r\n    gm.endEvent(data);\r\n}\r\nfunction special(gm, data) {\r\n    // gm.displayAt(data.actor.location)\r\n    gm.endEvent(data);\r\n}\r\nfunction display_info(gm, data) {\r\n    let level = gm.getCurrentLevel();\r\n    // todo: this is the in-depth highlight tool, vs cursor overview\r\n    // debug show what's there\r\n    let divDebug = (document.getElementById(\"id_div_debug\"));\r\n    divDebug.innerHTML = \"<p>\" + data.moveData.to_xy.toString() + \"</p>\";\r\n    gm.display.drawFooter();\r\n    gm.endEvent(data);\r\n}\r\nfunction remote_hack(gm, data) {\r\n    let target_xy = data.moveData.to_xy;\r\n    let target = gm.getCurrentLevel().monsters.getAt(target_xy);\r\n    // decrement power charge on success\r\n    data.powerData.power.charge_stat.decrement(1);\r\n    if (target.team != _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].Team.Player) {\r\n        target.team = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].Team.PlayerAllied;\r\n        console.log(`${target.name} has been hacked!!`);\r\n        target.color = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].hero_blue;\r\n        gm.displayAt(target.location);\r\n    }\r\n    gm.endEvent(data);\r\n}\r\nfunction shields_up(gm, data) {\r\n    data.actor.shields = new _brew__WEBPACK_IMPORTED_MODULE_0__[\"Stat\"](_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].StatName.Shields, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Config\"].player_shield_amount);\r\n    gm.getPlayer().color = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].power_shield;\r\n    console.log(\"shields activated\");\r\n    // Brew.Animations.animateCircle(gm, data.actor.location, 3, Brew.Color.power_shield, data)\r\n    let animationEvent = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Animations\"].createCircleAnimationEvent(data, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].power_shield, 3);\r\n    // let animationEvent = Brew.Animations.createReverseCircleAnimationEvent(data, Brew.Color.power_shield, 3)\r\n    gm.insertEvent(animationEvent);\r\n    gm.endEvent(data);\r\n}\r\nfunction cloak_on(gm, data) {\r\n    data.actor.setFlag(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].Flag.Invisible);\r\n    gm.timer_monitor.addTimer(new _brew__WEBPACK_IMPORTED_MODULE_0__[\"Timers\"].TurnTimer(data.actor, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].Flag.Invisible, gm.turn_count, 20)); //todo: tie power duration to power level/strengh\r\n    console.log(\"going dark\");\r\n    let animationEvent = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Animations\"].createCircleAnimationEvent(data, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].power_cloak, 3);\r\n    gm.insertEvent(animationEvent);\r\n    gm.endEvent(data);\r\n}\r\nfunction phasewalk_on(gm, data) {\r\n    data.actor.setFlag(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].Flag.PhaseWalk);\r\n    gm.timer_monitor.addTimer(new _brew__WEBPACK_IMPORTED_MODULE_0__[\"Timers\"].TurnTimer(data.actor, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].Flag.PhaseWalk, gm.turn_count, 10));\r\n    console.log(\"ghost mode activated\");\r\n    // Brew.Animations.animateCircle(gm, data.actor.location, 3, Brew.Color.power_phasewalk, data)\r\n    let animationEvent = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Animations\"].createCircleAnimationEvent(data, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].power_phasewalk, 3);\r\n    gm.insertEvent(animationEvent);\r\n    gm.endEvent(data);\r\n}\r\nfunction game_over(gm, data) {\r\n    // gm.display.gameOverDraw()\r\n    // gm.input_handler = InputHandler.WaitToRestart\r\n    // clear out other actors\r\n    gm.getCurrentLevel().monsters.getAllThings().forEach((mob) => {\r\n        if (!(mob.isSameThing(gm.getPlayer()))) {\r\n            gm.scheduler.remove(mob);\r\n        }\r\n    });\r\n    // clear out non-level actors\r\n    gm.scheduler.remove(gm.getArchitect());\r\n    let menu_entries = [];\r\n    menu_entries.push({\r\n        entryName: \"New Game\",\r\n        entryType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].GenericMenuEntryType.EventBased,\r\n        entryEvent: {\r\n            eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.RestartGame,\r\n            actor: gm.getPlayer(),\r\n            playerInitiated: true,\r\n            endsTurn: true\r\n        }\r\n    });\r\n    menu_entries.push({\r\n        entryName: \"Restart Seed\",\r\n        entryType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].GenericMenuEntryType.EventBased,\r\n        entryEvent: {\r\n            eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.RestartGame,\r\n            actor: gm.getPlayer(),\r\n            playerInitiated: true,\r\n            endsTurn: true,\r\n            restartData: { seed: gm.getSeed() }\r\n        }\r\n    });\r\n    let deathMenuEvent = {\r\n        eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.GenericMenuOn,\r\n        actor: gm.getPlayer(),\r\n        playerInitiated: false,\r\n        endsTurn: false,\r\n        genericMenuData: {\r\n            menuTitle: \"Congratulations\",\r\n            menuDescription: \"You have died!\",\r\n            allowCancel: false,\r\n            menuEntriesList: menu_entries\r\n        }\r\n    };\r\n    // clear out pending event queue\r\n    gm.clearEventQueue();\r\n    gm.insertEvent(deathMenuEvent);\r\n    gm.endEvent(data);\r\n}\r\nfunction restart_game(gm, brEvent) {\r\n    let given_seed = null;\r\n    if (brEvent.restartData) {\r\n        // starting_seed = brEvent.restartData.seed\r\n        given_seed = brEvent.restartData.seed;\r\n    }\r\n    Object(_start__WEBPACK_IMPORTED_MODULE_1__[\"startGame\"])(given_seed);\r\n}\r\nfunction createGenericEventOfType(gm, event_type, ends_turn = false) {\r\n    return {\r\n        eventType: event_type,\r\n        actor: gm.getPlayer(),\r\n        playerInitiated: true,\r\n        endsTurn: ends_turn\r\n    };\r\n}\r\nfunction addDataToEvent(brEvent, extraData) {\r\n    let newEvent = Object.assign({}, brEvent);\r\n    for (var key in extraData) {\r\n        if (extraData.hasOwnProperty(key)) {\r\n            var element = extraData[key];\r\n            newEvent[key] = element;\r\n        }\r\n    }\r\n    return newEvent;\r\n}\r\nfunction game_victory(gm, data) {\r\n    // gm.display.gameOverDraw()\r\n    // gm.input_handler = InputHandler.WaitToRestart\r\n    // clear out other actors\r\n    gm.getCurrentLevel().monsters.getAllThings().forEach((mob) => {\r\n        if (!(mob.isSameThing(gm.getPlayer()))) {\r\n            gm.scheduler.remove(mob);\r\n        }\r\n    });\r\n    // clear out non-level actors\r\n    gm.scheduler.remove(gm.getArchitect());\r\n    let menu_entries = [];\r\n    menu_entries.push({\r\n        entryName: \"New Game\",\r\n        entryType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].GenericMenuEntryType.EventBased,\r\n        entryEvent: {\r\n            eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.RestartGame,\r\n            actor: gm.getPlayer(),\r\n            playerInitiated: true,\r\n            endsTurn: true\r\n        }\r\n    });\r\n    menu_entries.push({\r\n        entryName: \"Restart Seed\",\r\n        entryType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].GenericMenuEntryType.EventBased,\r\n        entryEvent: {\r\n            eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.RestartGame,\r\n            actor: gm.getPlayer(),\r\n            playerInitiated: true,\r\n            endsTurn: true,\r\n            restartData: { seed: gm.getSeed() }\r\n        }\r\n    });\r\n    let victoryMenuEvent = {\r\n        eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.GenericMenuOn,\r\n        actor: gm.getPlayer(),\r\n        playerInitiated: false,\r\n        endsTurn: false,\r\n        genericMenuData: {\r\n            menuTitle: \"V I C T O R Y\",\r\n            menuDescription: \"You did it! Congratulations! This victory screen will have to do for now, until high scores are implemented.\",\r\n            allowCancel: false,\r\n            menuEntriesList: menu_entries\r\n        }\r\n    };\r\n    // clear out pending event queue\r\n    gm.clearEventQueue();\r\n    gm.insertEvent(victoryMenuEvent);\r\n    gm.endEvent(data);\r\n}\r\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvYnJld19lbmdpbmUvZXZlbnRzLnRzPzkzOGUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQStCO0FBQ0s7QUFFcEMsZ0NBQWdDO0FBQzFCLDBCQUEyQixFQUFtQixFQUFFLElBQTJCLEVBQUUsUUFBUTtJQUN2RixFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxJQUFJLDJDQUFVLENBQUMsYUFBYSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUM7UUFDbkQsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUM7WUFBQyxPQUFPLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUM7UUFBQyxDQUFDO1FBQ2pELE1BQU07SUFDVixDQUFDO0lBRUQsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsSUFBSSwyQ0FBVSxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO1FBQ2xELFlBQVksQ0FBQyxFQUFFLEVBQUUsSUFBSSxDQUFDO0lBRTFCLENBQUM7SUFBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsSUFBSSwyQ0FBVSxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO1FBQzFELDhDQUFhLENBQUMsSUFBSSxDQUFDLEVBQUUsRUFBRSxJQUFJLENBQUM7SUFFL0IsQ0FBQztJQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxJQUFJLDJDQUFVLENBQUMsYUFBYSxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUM7UUFDL0QsMENBQVMsQ0FBQyxXQUFXLENBQUMsRUFBRSxFQUFFLElBQUksQ0FBQztJQUVuQyxDQUFDO0lBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLElBQUksMkNBQVUsQ0FBQyxhQUFhLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQztRQUNqRSwwQ0FBUyxDQUFDLGFBQWEsQ0FBQyxFQUFFLEVBQUUsSUFBSSxDQUFDO0lBQ3JDLENBQUM7SUFBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsSUFBSSwyQ0FBVSxDQUFDLGFBQWEsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDO1FBQzNELDJDQUFVLENBQUMsWUFBWSxDQUFDLEVBQUUsRUFBRSxJQUFJLENBQUM7SUFFckMsQ0FBQztJQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxJQUFJLDJDQUFVLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7UUFDekQsOENBQWEsQ0FBQyxJQUFJLENBQUMsRUFBRSxFQUFFLElBQUksQ0FBQztJQUVoQyxDQUFDO0lBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLElBQUksMkNBQVUsQ0FBQyxhQUFhLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQztRQUMzRCxxREFBb0IsQ0FBQyxNQUFNLENBQUMsRUFBRSxFQUFFLElBQUksQ0FBQztJQUV6QyxDQUFDO0lBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLElBQUksMkNBQVUsQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztRQUN6RCxxREFBb0IsQ0FBQyxlQUFlLENBQUMsRUFBRSxFQUFFLElBQUksQ0FBQztJQUVsRCxDQUFDO0lBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLElBQUksMkNBQVUsQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztRQUN6RCxxREFBb0IsQ0FBQyx5QkFBeUIsQ0FBQyxFQUFFLEVBQUUsSUFBSSxDQUFDO0lBRTVELENBQUM7SUFBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsSUFBSSwyQ0FBVSxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO1FBQzFELHFEQUFvQixDQUFDLHdCQUF3QixDQUFDLEVBQUUsRUFBRSxJQUFJLENBQUM7SUFFM0QsQ0FBQztJQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxJQUFJLDJDQUFVLENBQUMsYUFBYSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUM7UUFDNUQscURBQW9CLENBQUMsT0FBTyxDQUFDLEVBQUUsRUFBRSxJQUFJLENBQUM7SUFFMUMsQ0FBQztJQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxJQUFJLDJDQUFVLENBQUMsYUFBYSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUM7UUFDNUQsT0FBTyxDQUFDLEVBQUUsRUFBRSxJQUFJLENBQUM7SUFFckIsQ0FBQztJQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxJQUFJLDJDQUFVLENBQUMsYUFBYSxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUM7UUFDaEUsNENBQVcsQ0FBQyxXQUFXLENBQUMsRUFBRSxFQUFFLElBQUksQ0FBQztJQUVyQyxDQUFDO0lBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLElBQUksMkNBQVUsQ0FBQyxhQUFhLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQztRQUMzRCw0Q0FBVyxDQUFDLE1BQU0sQ0FBQyxFQUFFLEVBQUUsSUFBSSxDQUFDO0lBRWhDLENBQUM7SUFBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsSUFBSSwyQ0FBVSxDQUFDLGFBQWEsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDO1FBQ2hFLDRDQUFXLENBQUMsWUFBWSxDQUFDLEVBQUUsRUFBRSxJQUFJLENBQUM7SUFFdEMsQ0FBQztJQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxJQUFJLDJDQUFVLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7UUFDekQsV0FBVyxDQUFDLEVBQUUsRUFBRSxJQUFJLENBQUM7SUFDekIsQ0FBQztJQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxJQUFJLDJDQUFVLENBQUMsYUFBYSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUM7UUFDOUQsVUFBVSxDQUFDLEVBQUUsRUFBRSxJQUFJLENBQUM7SUFDeEIsQ0FBQztJQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxJQUFJLDJDQUFVLENBQUMsYUFBYSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUM7UUFDNUQsUUFBUSxDQUFDLEVBQUUsRUFBRSxJQUFJLENBQUM7SUFDdEIsQ0FBQztJQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxJQUFJLDJDQUFVLENBQUMsYUFBYSxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUM7UUFDaEUsWUFBWSxDQUFDLEVBQUUsRUFBRSxJQUFJLENBQUM7SUFDMUIsQ0FBQztJQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxJQUFJLDJDQUFVLENBQUMsYUFBYSxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUM7UUFDaEUsNENBQVcsQ0FBQyxXQUFXLENBQUMsRUFBRSxFQUFFLElBQUksQ0FBQztJQUVyQyxDQUFDO0lBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLElBQUksMkNBQVUsQ0FBQyxhQUFhLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQztRQUNqRSwrQ0FBYyxDQUFDLFdBQVcsQ0FBQyxFQUFFLEVBQUUsSUFBSSxDQUFDO0lBRXZDLENBQUM7SUFBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsSUFBSSwyQ0FBVSxDQUFDLGFBQWEsQ0FBQyxlQUFlLENBQUMsQ0FBQyxDQUFDO1FBQ3JFLCtDQUFjLENBQUMsZUFBZSxDQUFDLEVBQUUsRUFBRSxJQUFJLENBQUM7SUFFM0MsQ0FBQztJQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxJQUFJLDJDQUFVLENBQUMsYUFBYSxDQUFDLGVBQWUsQ0FBQyxDQUFDLENBQUM7UUFDckUsK0NBQWMsQ0FBQyxlQUFlLENBQUMsRUFBRSxFQUFFLElBQUksQ0FBQztJQUUzQyxDQUFDO0lBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLElBQUksMkNBQVUsQ0FBQyxhQUFhLENBQUMsYUFBYSxDQUFDLENBQUMsQ0FBQztRQUNuRSwrQ0FBYyxDQUFDLGFBQWEsQ0FBQyxFQUFFLEVBQUUsSUFBSSxDQUFDO0lBRXpDLENBQUM7SUFBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsSUFBSSwyQ0FBVSxDQUFDLGFBQWEsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDO1FBQ2hFLDJDQUFVLENBQUMsaUJBQWlCLENBQUMsRUFBRSxFQUFFLElBQUksQ0FBQztJQUUxQyxDQUFDO0lBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLElBQUksMkNBQVUsQ0FBQyxhQUFhLENBQUMsYUFBYSxDQUFDLENBQUMsQ0FBQztRQUNsRSwyQ0FBVSxDQUFDLGVBQWUsQ0FBQyxFQUFFLEVBQUUsSUFBSSxDQUFDO0lBRXhDLENBQUM7SUFBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsSUFBSSwyQ0FBVSxDQUFDLGFBQWEsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLENBQUM7UUFDdEUsMkNBQVUsQ0FBQyxrQkFBa0IsQ0FBQyxFQUFFLEVBQUUsSUFBSSxDQUFDO0lBRTFDLENBQUM7SUFBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsSUFBSSwyQ0FBVSxDQUFDLGFBQWEsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDO1FBQ2hFLDJDQUFVLENBQUMsdUJBQXVCLENBQUMsRUFBRSxFQUFFLElBQUksQ0FBQztJQUVoRCxDQUFDO0lBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLElBQUksMkNBQVUsQ0FBQyxhQUFhLENBQUMsY0FBYyxDQUFDLENBQUMsQ0FBQztRQUNuRSw0Q0FBVyxDQUFDLGNBQWMsQ0FBQyxFQUFFLEVBQUUsSUFBSSxDQUFDO0lBRXhDLENBQUM7SUFBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsSUFBSSwyQ0FBVSxDQUFDLGFBQWEsQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDLENBQUM7UUFDMUUsMkNBQVUsQ0FBQyx1QkFBdUIsQ0FBQyxFQUFFLEVBQUUsSUFBSSxDQUFDO0lBRWhELENBQUM7SUFBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsSUFBSSwyQ0FBVSxDQUFDLGFBQWEsQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDLENBQUM7UUFDdEUsNENBQVcsQ0FBQyxTQUFTLENBQUMsRUFBRSxFQUFFLElBQUksQ0FBQztJQUVuQyxDQUFDO0lBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLElBQUksMkNBQVUsQ0FBQyxhQUFhLENBQUMsb0JBQW9CLENBQUMsQ0FBQyxDQUFDO1FBQ3pFLDJDQUFVLENBQUMsMEJBQTBCLENBQUMsRUFBRSxFQUFFLElBQUksQ0FBQztJQUVuRCxDQUFDO0lBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLElBQUksMkNBQVUsQ0FBQyxhQUFhLENBQUMseUJBQXlCLENBQUMsQ0FBQyxDQUFDO1FBQzlFLDJDQUFVLENBQUMsMEJBQTBCLENBQUMsRUFBRSxFQUFFLElBQUksQ0FBQztJQUVuRCxDQUFDO0lBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLElBQUksMkNBQVUsQ0FBQyxhQUFhLENBQUMsb0JBQW9CLENBQUMsQ0FBQyxDQUFDO1FBQ3pFLDRDQUFXLENBQUMsWUFBWSxDQUFDLEVBQUUsRUFBRSxJQUFJLENBQUM7SUFFdEMsQ0FBQztJQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxJQUFJLDJDQUFVLENBQUMsYUFBYSxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUM7UUFDaEUsU0FBUyxDQUFDLEVBQUUsRUFBRSxJQUFJLENBQUM7SUFFdkIsQ0FBQztJQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxJQUFJLDJDQUFVLENBQUMsYUFBYSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUM7UUFDNUQsWUFBWSxDQUFDLEVBQUUsRUFBRSxJQUFJLENBQUM7SUFFMUIsQ0FBQztJQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxJQUFJLDJDQUFVLENBQUMsYUFBYSxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUM7UUFDaEUsWUFBWSxDQUFDLEVBQUUsRUFBRSxJQUFJLENBQUM7SUFFMUIsQ0FBQztJQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxJQUFJLDJDQUFVLENBQUMsYUFBYSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUM7UUFDL0QsOENBQWEsQ0FBQyxnQkFBZ0IsQ0FBQyxFQUFFLEVBQUUsSUFBSSxDQUFDO0lBRTNDLENBQUM7SUFBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsSUFBSSwyQ0FBVSxDQUFDLGFBQWEsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDO1FBQ2hFLFlBQVksQ0FBQyxFQUFFLEVBQUUsSUFBSSxDQUFDO0lBRTFCLENBQUM7SUFBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsSUFBSSwyQ0FBVSxDQUFDLGFBQWEsQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDO1FBQ2pFLGdEQUFlLENBQUMsaUJBQWlCLENBQUMsRUFBRSxFQUFFLElBQUksQ0FBQztJQUUvQyxDQUFDO0lBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLElBQUksMkNBQVUsQ0FBQyxhQUFhLENBQUMsYUFBYSxDQUFDLENBQUMsQ0FBQztRQUNsRSwyQ0FBVSxDQUFDLGVBQWUsQ0FBQyxFQUFFLEVBQUUsSUFBSSxDQUFDO0lBQ3hDLENBQUM7SUFBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsSUFBSSwyQ0FBVSxDQUFDLGFBQWEsQ0FBQyxjQUFjLENBQUMsQ0FBQyxDQUFDO1FBQ25FLDJDQUFVLENBQUMsc0JBQXNCLENBQUMsRUFBRSxFQUFFLElBQUksQ0FBQztJQUMvQyxDQUFDO0lBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLElBQUksMkNBQVUsQ0FBQyxhQUFhLENBQUMsZUFBZSxDQUFDLENBQUMsQ0FBQztRQUNwRSwyQ0FBVSxDQUFDLGlCQUFpQixDQUFDLEVBQUUsRUFBRSxJQUFJLENBQUM7SUFDMUMsQ0FBQztJQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxJQUFJLDJDQUFVLENBQUMsYUFBYSxDQUFDLGlCQUFpQixDQUFDLENBQUMsQ0FBQztRQUN2RSwyQ0FBVyxDQUFDLHFCQUFxQixDQUFDLEVBQUUsRUFBRSxJQUFJLENBQUM7SUFFOUMsQ0FBQztJQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxJQUFJLDJDQUFVLENBQUMsYUFBYSxDQUFDLGNBQWMsQ0FBQyxDQUFDLENBQUM7UUFDbkUsMkNBQVUsQ0FBQyxnQkFBZ0IsQ0FBQyxFQUFFLEVBQUUsSUFBSSxDQUFDO0lBRXpDLENBQUM7SUFBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsSUFBSSwyQ0FBVSxDQUFDLGFBQWEsQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDLENBQUM7UUFDekUsMkNBQVUsQ0FBQyxvQkFBb0IsQ0FBQyxFQUFFLEVBQUUsSUFBSSxDQUFDO0lBRTdDLENBQUM7SUFBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsSUFBSSwyQ0FBVSxDQUFDLGFBQWEsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDLENBQUM7UUFDdkUsMkNBQVUsQ0FBQyxrQkFBa0IsQ0FBQyxFQUFFLEVBQUUsSUFBSSxDQUFDO0lBRTNDLENBQUM7SUFBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsSUFBSSwyQ0FBVSxDQUFDLGFBQWEsQ0FBQyxhQUFjLENBQUMsQ0FBQyxDQUFDO1FBQ25FLDRDQUFXLENBQUMsU0FBUyxDQUFDLEVBQUUsRUFBRSxJQUFJLENBQUM7SUFFbkMsQ0FBQztJQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxJQUFJLDJDQUFVLENBQUMsYUFBYSxDQUFDLGNBQWUsQ0FBQyxDQUFDLENBQUM7UUFDcEUsNENBQVcsQ0FBQyxVQUFVLENBQUMsRUFBRSxFQUFFLElBQUksQ0FBQztJQUVwQyxDQUFDO0lBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLElBQUksMkNBQVUsQ0FBQyxhQUFhLENBQUMsb0JBQW9CLENBQUMsQ0FBQyxDQUFDO1FBQ3pFLDJDQUFVLENBQUMsdUJBQXVCLENBQUMsRUFBRSxFQUFFLElBQUksQ0FBQztJQUVoRCxDQUFDO0lBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLElBQUksMkNBQVUsQ0FBQyxhQUFhLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxDQUFDO1FBQ3JFLDJDQUFVLENBQUMsZUFBZSxDQUFDLEVBQUUsRUFBRSxJQUFJLENBQUM7SUFFeEMsQ0FBQztJQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxJQUFJLDJDQUFVLENBQUMsYUFBYSxDQUFDLHdCQUF3QixDQUFDLENBQUMsQ0FBQztRQUM3RSwyQ0FBVSxDQUFDLHVCQUF1QixDQUFDLEVBQUUsRUFBRSxJQUFJLENBQUM7SUFFaEQsQ0FBQztJQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxJQUFJLDJDQUFVLENBQUMsYUFBYSxDQUFDLG9CQUFvQixDQUFDLENBQUMsQ0FBQztRQUN6RSwyQ0FBVSxDQUFDLGVBQWUsQ0FBQyxFQUFFLEVBQUUsSUFBSSxDQUFDO0lBRXhDLENBQUM7SUFBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsSUFBSSwyQ0FBVSxDQUFDLGFBQWEsQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDLENBQUM7UUFDekUsMkNBQVUsQ0FBQyxlQUFlLENBQUMsRUFBRSxFQUFFLElBQUksQ0FBQztJQUV4QyxDQUFDO0lBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLElBQUksMkNBQVUsQ0FBQyxhQUFhLENBQUMsd0JBQXdCLENBQUMsQ0FBQyxDQUFDO1FBQzdFLDJDQUFVLENBQUMsdUJBQXVCLENBQUMsRUFBRSxFQUFFLElBQUksQ0FBQztJQUVoRCxDQUFDO0lBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLElBQUksMkNBQVUsQ0FBQyxhQUFhLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQztRQUMvRCw0Q0FBVyxDQUFDLGVBQWUsQ0FBQyxFQUFFLEVBQUUsSUFBSSxDQUFDO0lBRXpDLENBQUM7SUFBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsSUFBSSwyQ0FBVSxDQUFDLGFBQWEsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDO1FBQy9ELDhDQUFhLENBQUMsU0FBUyxDQUFDLEVBQUUsRUFBRSxJQUFJLENBQUM7SUFDcEMsQ0FBQztJQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxJQUFJLDJDQUFVLENBQUMsYUFBYSxDQUFDLGFBQWEsQ0FBQyxDQUFDLENBQUM7UUFDbkUsK0NBQWMsQ0FBQyxxQkFBcUIsQ0FBQyxFQUFFLEVBQUUsSUFBSSxDQUFDO0lBRWpELENBQUM7SUFBQyxJQUFJLENBQUMsQ0FBQztRQUNKLE9BQU8sQ0FBQyxLQUFLLENBQUMsNkJBQTZCLEVBQUUsSUFBSSxDQUFDO0lBQ3RELENBQUM7QUFFTCxDQUFDO0FBRUQsc0JBQXNCLEVBQW1CLEVBQUUsSUFBMkI7SUFDbEUsSUFBSSxNQUFNLEdBQWlCLElBQUksQ0FBQyxVQUFVLENBQUMsV0FBVztJQUN0RCxJQUFJLFdBQVcsR0FBRywwQ0FBUyxDQUFDLGdCQUFnQixDQUFDLEVBQUUsQ0FBQztJQUVoRCxFQUFFLENBQUMsZUFBZSxFQUFFLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUMsU0FBUyxFQUFFLENBQUMsUUFBUSxDQUFDO0lBQy9ELEVBQUUsQ0FBQyxVQUFVLENBQUMsTUFBTSxDQUFDLGFBQWEsRUFBRSxNQUFNLENBQUMsZ0JBQWdCLENBQUM7SUFDNUQsa0JBQWtCO0lBRWxCLEVBQUUsQ0FBQyxXQUFXLENBQUMsMENBQVMsQ0FBQyxtQkFBbUIsQ0FBQyxFQUFFLEVBQUUsV0FBVyxDQUFDLENBQUM7SUFDOUQsRUFBRSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUM7QUFDckIsQ0FBQztBQUVELGlCQUFpQixFQUFtQixFQUFFLElBQTJCO0lBRTdELG9DQUFvQztJQUNwQyxFQUFFLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQztBQUdyQixDQUFDO0FBRUQsc0JBQXNCLEVBQW1CLEVBQUUsSUFBMkI7SUFDbEUsSUFBSSxLQUFLLEdBQUcsRUFBRSxDQUFDLGVBQWUsRUFBRTtJQUNoQyxnRUFBZ0U7SUFFaEUsMEJBQTBCO0lBQzFCLElBQUksUUFBUSxHQUFvQixDQUFDLFFBQVEsQ0FBQyxjQUFjLENBQUMsY0FBYyxDQUFDLENBQUM7SUFDekUsUUFBUSxDQUFDLFNBQVMsR0FBRyxLQUFLLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsUUFBUSxFQUFFLEdBQUcsTUFBTTtJQUNwRSxFQUFFLENBQUMsT0FBTyxDQUFDLFVBQVUsRUFBRTtJQUN2QixFQUFFLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQztBQUNyQixDQUFDO0FBRUQscUJBQXFCLEVBQW1CLEVBQUUsSUFBMkI7SUFDakUsSUFBSSxTQUFTLEdBQXFCLElBQUksQ0FBQyxRQUFRLENBQUMsS0FBSztJQUNyRCxJQUFJLE1BQU0sR0FBRyxFQUFFLENBQUMsZUFBZSxFQUFFLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxTQUFTLENBQUM7SUFFM0Qsb0NBQW9DO0lBQ3BDLElBQUksQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLFdBQVcsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDO0lBRTdDLEVBQUUsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxJQUFJLElBQUksMkNBQVUsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQztRQUN4QyxNQUFNLENBQUMsSUFBSSxHQUFHLDJDQUFVLENBQUMsSUFBSSxDQUFDLFlBQVk7UUFDMUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxHQUFHLE1BQU0sQ0FBQyxJQUFJLG9CQUFvQixDQUFDO1FBQy9DLE1BQU0sQ0FBQyxLQUFLLEdBQUcsMkNBQVUsQ0FBQyxTQUFTO1FBQ25DLEVBQUUsQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQztJQUNqQyxDQUFDO0lBQ0QsRUFBRSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUM7QUFFckIsQ0FBQztBQUVELG9CQUFvQixFQUFtQixFQUFFLElBQTJCO0lBQ2hFLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxHQUFHLElBQUksMENBQVMsQ0FBQywyQ0FBVSxDQUFDLFFBQVEsQ0FBQyxPQUFPLEVBQUUsNENBQVcsQ0FBQyxvQkFBb0IsQ0FBQztJQUNqRyxFQUFFLENBQUMsU0FBUyxFQUFFLENBQUMsS0FBSyxHQUFHLDJDQUFVLENBQUMsWUFBWTtJQUM5QyxPQUFPLENBQUMsR0FBRyxDQUFDLG1CQUFtQixDQUFDO0lBRWhDLDJGQUEyRjtJQUMzRixJQUFJLGNBQWMsR0FBRyxnREFBZSxDQUFDLDBCQUEwQixDQUFDLElBQUksRUFBRSwyQ0FBVSxDQUFDLFlBQVksRUFBRSxDQUFDLENBQUM7SUFDakcsMkdBQTJHO0lBQzNHLEVBQUUsQ0FBQyxXQUFXLENBQUMsY0FBYyxDQUFDO0lBQzlCLEVBQUUsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDO0FBQ3JCLENBQUM7QUFFRCxrQkFBa0IsRUFBbUIsRUFBRSxJQUEyQjtJQUM5RCxJQUFJLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQywyQ0FBVSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUM7SUFDN0MsRUFBRSxDQUFDLGFBQWEsQ0FBQyxRQUFRLENBQUMsSUFBSSw0Q0FBVyxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsS0FBSyxFQUFFLDJDQUFVLENBQUMsSUFBSSxDQUFDLFNBQVMsRUFBRSxFQUFFLENBQUMsVUFBVSxFQUFFLEVBQUUsQ0FBQyxDQUFDLEVBQUMsaURBQWlEO0lBRWhLLE9BQU8sQ0FBQyxHQUFHLENBQUMsWUFBWSxDQUFDO0lBQ3pCLElBQUksY0FBYyxHQUFHLGdEQUFlLENBQUMsMEJBQTBCLENBQUMsSUFBSSxFQUFFLDJDQUFVLENBQUMsV0FBVyxFQUFFLENBQUMsQ0FBQztJQUNoRyxFQUFFLENBQUMsV0FBVyxDQUFDLGNBQWMsQ0FBQztJQUM5QixFQUFFLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQztBQUNyQixDQUFDO0FBRUQsc0JBQXNCLEVBQW9CLEVBQUUsSUFBMkI7SUFDbkUsSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsMkNBQVUsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDO0lBQzdDLEVBQUUsQ0FBQyxhQUFhLENBQUMsUUFBUSxDQUFDLElBQUksNENBQVcsQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLEtBQUssRUFBRSwyQ0FBVSxDQUFDLElBQUksQ0FBQyxTQUFTLEVBQUUsRUFBRSxDQUFDLFVBQVUsRUFBRSxFQUFFLENBQUMsQ0FBQztJQUM5RyxPQUFPLENBQUMsR0FBRyxDQUFDLHNCQUFzQixDQUFDO0lBQ25DLDhGQUE4RjtJQUM5RixJQUFJLGNBQWMsR0FBRyxnREFBZSxDQUFDLDBCQUEwQixDQUFDLElBQUksRUFBRSwyQ0FBVSxDQUFDLGVBQWUsRUFBRSxDQUFDLENBQUM7SUFDcEcsRUFBRSxDQUFDLFdBQVcsQ0FBQyxjQUFjLENBQUM7SUFDOUIsRUFBRSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUM7QUFDckIsQ0FBQztBQUVELG1CQUFtQixFQUFvQixFQUFFLElBQTJCO0lBQ2hFLDRCQUE0QjtJQUM1QixnREFBZ0Q7SUFFaEQseUJBQXlCO0lBQ3pCLEVBQUUsQ0FBQyxlQUFlLEVBQUUsQ0FBQyxRQUFRLENBQUMsWUFBWSxFQUFFLENBQUMsT0FBTyxDQUFDLENBQUMsR0FBNEIsRUFBRSxFQUFFO1FBQ2xGLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsV0FBVyxDQUFDLEVBQUUsQ0FBQyxTQUFTLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ3JDLEVBQUUsQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQztRQUM1QixDQUFDO0lBQ0wsQ0FBQyxDQUFDO0lBQ0YsNkJBQTZCO0lBQzdCLEVBQUUsQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQyxZQUFZLEVBQUUsQ0FBQztJQUV0QyxJQUFJLFlBQVksR0FBNkMsRUFBRTtJQUUvRCxZQUFZLENBQUMsSUFBSSxDQUFDO1FBQ2QsU0FBUyxFQUFFLFVBQVU7UUFDckIsU0FBUyxFQUFFLDJDQUFVLENBQUMsb0JBQW9CLENBQUMsVUFBVTtRQUNyRCxVQUFVLEVBQUU7WUFDUixTQUFTLEVBQUUsMkNBQVUsQ0FBQyxhQUFhLENBQUMsV0FBVztZQUMvQyxLQUFLLEVBQUUsRUFBRSxDQUFDLFNBQVMsRUFBRTtZQUNyQixlQUFlLEVBQUUsSUFBSTtZQUNyQixRQUFRLEVBQUUsSUFBSTtTQUNqQjtLQUNKLENBQUM7SUFFRixZQUFZLENBQUMsSUFBSSxDQUFDO1FBQ2QsU0FBUyxFQUFFLGNBQWM7UUFDekIsU0FBUyxFQUFFLDJDQUFVLENBQUMsb0JBQW9CLENBQUMsVUFBVTtRQUNyRCxVQUFVLEVBQUU7WUFDUixTQUFTLEVBQUUsMkNBQVUsQ0FBQyxhQUFhLENBQUMsV0FBVztZQUMvQyxLQUFLLEVBQUUsRUFBRSxDQUFDLFNBQVMsRUFBRTtZQUNyQixlQUFlLEVBQUUsSUFBSTtZQUNyQixRQUFRLEVBQUUsSUFBSTtZQUNkLFdBQVcsRUFBRSxFQUFFLElBQUksRUFBRSxFQUFFLENBQUMsT0FBTyxFQUFFLEVBQUU7U0FDdEM7S0FDSixDQUFDO0lBRUYsSUFBSSxjQUFjLEdBQTJCO1FBQ3pDLFNBQVMsRUFBRSwyQ0FBVSxDQUFDLGFBQWEsQ0FBQyxhQUFhO1FBQ2pELEtBQUssRUFBRSxFQUFFLENBQUMsU0FBUyxFQUFFO1FBQ3JCLGVBQWUsRUFBRSxLQUFLO1FBQ3RCLFFBQVEsRUFBRSxLQUFLO1FBQ2YsZUFBZSxFQUFFO1lBQ2IsU0FBUyxFQUFFLGlCQUFpQjtZQUM1QixlQUFlLEVBQUUsZ0JBQWdCO1lBQ2pDLFdBQVcsRUFBRSxLQUFLO1lBQ2xCLGVBQWUsRUFBRSxZQUFZO1NBQ2hDO0tBQ0o7SUFFRCxnQ0FBZ0M7SUFDaEMsRUFBRSxDQUFDLGVBQWUsRUFBRTtJQUVwQixFQUFFLENBQUMsV0FBVyxDQUFDLGNBQWMsQ0FBQztJQUM5QixFQUFFLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQztBQUNyQixDQUFDO0FBRUQsc0JBQXNCLEVBQW1CLEVBQUUsT0FBOEI7SUFDckUsSUFBSSxVQUFVLEdBQVksSUFBSTtJQUM5QixFQUFFLENBQUMsQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQztRQUN0QiwyQ0FBMkM7UUFDM0MsVUFBVSxHQUFHLE9BQU8sQ0FBQyxXQUFXLENBQUMsSUFBSTtJQUN6QyxDQUFDO0lBQ0Qsd0RBQVMsQ0FBQyxVQUFVLENBQUM7QUFDekIsQ0FBQztBQUVLLGtDQUFtQyxFQUFvQixFQUFFLFVBQW9DLEVBQUUsWUFBc0IsS0FBSztJQUM1SCxNQUFNLENBQUM7UUFDSCxTQUFTLEVBQUUsVUFBVTtRQUNyQixLQUFLLEVBQUUsRUFBRSxDQUFDLFNBQVMsRUFBRTtRQUNyQixlQUFlLEVBQUUsSUFBSTtRQUNyQixRQUFRLEVBQUUsU0FBUztLQUN0QjtBQUNMLENBQUM7QUFFSyx3QkFBeUIsT0FBK0IsRUFBRSxTQUF5QztJQUNyRyxJQUFJLFFBQVEscUJBQStCLE9BQU8sQ0FBQztJQUVuRCxHQUFHLENBQUMsQ0FBQyxJQUFJLEdBQUcsSUFBSSxTQUFTLENBQUMsQ0FBQyxDQUFDO1FBQ3hCLEVBQUUsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxjQUFjLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ2hDLElBQUksT0FBTyxHQUFHLFNBQVMsQ0FBQyxHQUFHLENBQUM7WUFDNUIsUUFBUSxDQUFDLEdBQUcsQ0FBQyxHQUFHLE9BQU87UUFDM0IsQ0FBQztJQUNMLENBQUM7SUFDRCxNQUFNLENBQUMsUUFBUTtBQUNuQixDQUFDO0FBRUQsc0JBQXNCLEVBQW9CLEVBQUUsSUFBMkI7SUFDbkUsNEJBQTRCO0lBQzVCLGdEQUFnRDtJQUVoRCx5QkFBeUI7SUFDekIsRUFBRSxDQUFDLGVBQWUsRUFBRSxDQUFDLFFBQVEsQ0FBQyxZQUFZLEVBQUUsQ0FBQyxPQUFPLENBQUMsQ0FBQyxHQUE0QixFQUFFLEVBQUU7UUFDbEYsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxXQUFXLENBQUMsRUFBRSxDQUFDLFNBQVMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDckMsRUFBRSxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDO1FBQzVCLENBQUM7SUFDTCxDQUFDLENBQUM7SUFDRiw2QkFBNkI7SUFDN0IsRUFBRSxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLFlBQVksRUFBRSxDQUFDO0lBRXRDLElBQUksWUFBWSxHQUE2QyxFQUFFO0lBRS9ELFlBQVksQ0FBQyxJQUFJLENBQUM7UUFDZCxTQUFTLEVBQUUsVUFBVTtRQUNyQixTQUFTLEVBQUUsMkNBQVUsQ0FBQyxvQkFBb0IsQ0FBQyxVQUFVO1FBQ3JELFVBQVUsRUFBRTtZQUNSLFNBQVMsRUFBRSwyQ0FBVSxDQUFDLGFBQWEsQ0FBQyxXQUFXO1lBQy9DLEtBQUssRUFBRSxFQUFFLENBQUMsU0FBUyxFQUFFO1lBQ3JCLGVBQWUsRUFBRSxJQUFJO1lBQ3JCLFFBQVEsRUFBRSxJQUFJO1NBQ2pCO0tBQ0osQ0FBQztJQUVGLFlBQVksQ0FBQyxJQUFJLENBQUM7UUFDZCxTQUFTLEVBQUUsY0FBYztRQUN6QixTQUFTLEVBQUUsMkNBQVUsQ0FBQyxvQkFBb0IsQ0FBQyxVQUFVO1FBQ3JELFVBQVUsRUFBRTtZQUNSLFNBQVMsRUFBRSwyQ0FBVSxDQUFDLGFBQWEsQ0FBQyxXQUFXO1lBQy9DLEtBQUssRUFBRSxFQUFFLENBQUMsU0FBUyxFQUFFO1lBQ3JCLGVBQWUsRUFBRSxJQUFJO1lBQ3JCLFFBQVEsRUFBRSxJQUFJO1lBQ2QsV0FBVyxFQUFFLEVBQUUsSUFBSSxFQUFFLEVBQUUsQ0FBQyxPQUFPLEVBQUUsRUFBRTtTQUN0QztLQUNKLENBQUM7SUFFRixJQUFJLGdCQUFnQixHQUEyQjtRQUMzQyxTQUFTLEVBQUUsMkNBQVUsQ0FBQyxhQUFhLENBQUMsYUFBYTtRQUNqRCxLQUFLLEVBQUUsRUFBRSxDQUFDLFNBQVMsRUFBRTtRQUNyQixlQUFlLEVBQUUsS0FBSztRQUN0QixRQUFRLEVBQUUsS0FBSztRQUNmLGVBQWUsRUFBRTtZQUNiLFNBQVMsRUFBRSxlQUFlO1lBQzFCLGVBQWUsRUFBRSw4R0FBOEc7WUFDL0gsV0FBVyxFQUFFLEtBQUs7WUFDbEIsZUFBZSxFQUFFLFlBQVk7U0FDaEM7S0FDSjtJQUVELGdDQUFnQztJQUNoQyxFQUFFLENBQUMsZUFBZSxFQUFFO0lBRXBCLEVBQUUsQ0FBQyxXQUFXLENBQUMsZ0JBQWdCLENBQUM7SUFDaEMsRUFBRSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUM7QUFDckIsQ0FBQyIsImZpbGUiOiIuL3NyYy9icmV3X2VuZ2luZS9ldmVudHMudHMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBCcmV3IGZyb20gXCIuLi9icmV3XCJcclxuaW1wb3J0IHsgc3RhcnRHYW1lIH0gZnJvbSBcIi4uL3N0YXJ0XCJcclxuXHJcbi8vIGNhbGxlZCBmcm9tIHBvc3RhbC5qcyBjaGFubmVsXHJcbmV4cG9ydCBmdW5jdGlvbiBtYWluRXZlbnRoYW5kbGVyKGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGRhdGE6IEJyZXcuRW51bXMuSUJyZXdFdmVudCwgZW52ZWxvcGUpICB7XHJcbiAgICBpZiAoZGF0YS5ldmVudFR5cGUgPT0gQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLkVycm9yKSB7XHJcbiAgICAgICAgaWYgKGRhdGEuZXJyb3JNc2cpIHsgY29uc29sZS5sb2coZGF0YS5lcnJvck1zZykgfVxyXG4gICAgICAgIHJldHVyblxyXG4gICAgfSBcclxuICAgIFxyXG4gICAgaWYgKGRhdGEuZXZlbnRUeXBlID09IEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5JbmZvKSB7XHJcbiAgICAgICAgZGlzcGxheV9pbmZvKGdtLCBkYXRhKVxyXG4gICAgICAgIFxyXG4gICAgfSBlbHNlIGlmIChkYXRhLmV2ZW50VHlwZSA9PSBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuTW92ZSkge1xyXG4gICAgICAgQnJldy5Nb3ZlbWVudC5tb3ZlKGdtLCBkYXRhKVxyXG5cclxuICAgIH0gZWxzZSBpZiAoZGF0YS5ldmVudFR5cGUgPT0gQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLlJvdGF0ZUJvZHkpIHtcclxuICAgICAgICBCcmV3LlRhbmsucm90YXRlX2JvZHkoZ20sIGRhdGEpXHJcbiBcclxuICAgIH0gZWxzZSBpZiAoZGF0YS5ldmVudFR5cGUgPT0gQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLlJvdGF0ZVdlYXBvbikge1xyXG4gICAgICAgIEJyZXcuVGFuay5yb3RhdGVfd2VhcG9uKGdtLCBkYXRhKVxyXG4gICAgfSBlbHNlIGlmIChkYXRhLmV2ZW50VHlwZSA9PSBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuSGVscE9uKSB7XHJcbiAgICAgICAgQnJldy5NZW51cy5zaG93SGVscE1lbnUoZ20sIGRhdGEpXHJcblxyXG4gICAgfSBlbHNlIGlmIChkYXRhLmV2ZW50VHlwZSA9PSBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuV2FpdCkge1xyXG4gICAgICAgIEJyZXcuTW92ZW1lbnQucmVzdChnbSwgZGF0YSlcclxuXHJcbiAgICB9IGVsc2UgaWYgKGRhdGEuZXZlbnRUeXBlID09IEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5QaWNrdXApIHtcclxuICAgICAgICBCcmV3Lkl0ZW1JbnRlcmFjdGlvbi5waWNrdXAoZ20sIGRhdGEpXHJcbiAgICBcclxuICAgIH0gZWxzZSBpZiAoZGF0YS5ldmVudFR5cGUgPT0gQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLkRyb3ApIHtcclxuICAgICAgICBCcmV3Lkl0ZW1JbnRlcmFjdGlvbi5kcm9wSXRlbUF0dGVtcHQoZ20sIGRhdGEpXHJcblxyXG4gICAgfSBlbHNlIGlmIChkYXRhLmV2ZW50VHlwZSA9PSBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuTGFuZCkge1xyXG4gICAgICAgIEJyZXcuSXRlbUludGVyYWN0aW9uLmRvTGFuZGluZ0V2ZW50QWZ0ZXJUaHJvd24oZ20sIGRhdGEpXHJcblxyXG4gICAgfSBlbHNlIGlmIChkYXRhLmV2ZW50VHlwZSA9PSBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuSGVhdmUpIHtcclxuICAgICAgICBCcmV3Lkl0ZW1JbnRlcmFjdGlvbi5kb0xhbmRpbmdFdmVudEFmdGVySGVhdmUoZ20sIGRhdGEpXHJcblxyXG4gICAgfSBlbHNlIGlmIChkYXRhLmV2ZW50VHlwZSA9PSBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuVXNlSXRlbSkge1xyXG4gICAgICAgIEJyZXcuSXRlbUludGVyYWN0aW9uLnVzZUl0ZW0oZ20sIGRhdGEpXHJcblxyXG4gICAgfSBlbHNlIGlmIChkYXRhLmV2ZW50VHlwZSA9PSBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuU3BlY2lhbCkge1xyXG4gICAgICAgIHNwZWNpYWwoZ20sIGRhdGEpXHJcbiAgICBcclxuICAgIH0gZWxzZSBpZiAoZGF0YS5ldmVudFR5cGUgPT0gQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLkFwcGx5RGFtYWdlKSB7XHJcbiAgICAgICAgQnJldy5Db21iYXQuYXBwbHlEYW1hZ2UoZ20sIGRhdGEpXHJcblxyXG4gICAgfSBlbHNlIGlmIChkYXRhLmV2ZW50VHlwZSA9PSBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuQXR0YWNrKSB7XHJcbiAgICAgICAgQnJldy5Db21iYXQuYXR0YWNrKGdtLCBkYXRhKVxyXG5cclxuICAgIH0gZWxzZSBpZiAoZGF0YS5ldmVudFR5cGUgPT0gQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLlNtYXNoQXR0YWNrKSB7XHJcbiAgICAgICAgQnJldy5Db21iYXQuc21hc2hfYXR0YWNrKGdtLCBkYXRhKVxyXG4gICAgXHJcbiAgICB9IGVsc2UgaWYgKGRhdGEuZXZlbnRUeXBlID09IEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5IYWNrKSB7XHJcbiAgICAgICAgcmVtb3RlX2hhY2soZ20sIGRhdGEpXHJcbiAgICB9IGVsc2UgaWYgKGRhdGEuZXZlbnRUeXBlID09IEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5TaGllbGRzVXApIHtcclxuICAgICAgICBzaGllbGRzX3VwKGdtLCBkYXRhKVxyXG4gICAgfSBlbHNlIGlmIChkYXRhLmV2ZW50VHlwZSA9PSBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuQ2xvYWtPbikge1xyXG4gICAgICAgIGNsb2FrX29uKGdtLCBkYXRhKVxyXG4gICAgfSBlbHNlIGlmIChkYXRhLmV2ZW50VHlwZSA9PSBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuUGhhc2VXYWxrT24pIHtcclxuICAgICAgICBwaGFzZXdhbGtfb24oZ20sIGRhdGEpXHJcbiAgICB9IGVsc2UgaWYgKGRhdGEuZXZlbnRUeXBlID09IEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5Sb2NrZXRQdW5jaCkge1xyXG4gICAgICAgIEJyZXcuUG93ZXJzLnJvY2tldFB1bmNoKGdtLCBkYXRhKVxyXG5cclxuICAgIH0gZWxzZSBpZiAoZGF0YS5ldmVudFR5cGUgPT0gQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLlRhcmdldGluZ09uKSB7XHJcbiAgICAgICBCcmV3LlRhcmdldGluZy50YXJnZXRpbmdPbihnbSwgZGF0YSlcclxuICAgICAgICBcclxuICAgIH0gZWxzZSBpZiAoZGF0YS5ldmVudFR5cGUgPT0gQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLlRhcmdldGluZ0NhbmNlbCkge1xyXG4gICAgICAgQnJldy5UYXJnZXRpbmcudGFyZ2V0aW5nQ2FuY2VsKGdtLCBkYXRhKVxyXG5cclxuICAgIH0gZWxzZSBpZiAoZGF0YS5ldmVudFR5cGUgPT0gQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLlRhcmdldGluZ0ZpbmlzaCkge1xyXG4gICAgICAgQnJldy5UYXJnZXRpbmcudGFyZ2V0aW5nRmluaXNoKGdtLCBkYXRhKVxyXG5cclxuICAgIH0gZWxzZSBpZiAoZGF0YS5ldmVudFR5cGUgPT0gQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLlRhcmdldGluZ01vdmUpIHtcclxuICAgICAgIEJyZXcuVGFyZ2V0aW5nLnRhcmdldGluZ01vdmUoZ20sIGRhdGEpXHJcblxyXG4gICAgfSBlbHNlIGlmIChkYXRhLmV2ZW50VHlwZSA9PSBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuSW52ZW50b3J5T24pIHtcclxuICAgICAgICBCcmV3Lk1lbnVzLnNob3dJbnZlbnRvcnlMaXN0KGdtLCBkYXRhKVxyXG4gICAgICAgIFxyXG4gICAgfSBlbHNlIGlmIChkYXRhLmV2ZW50VHlwZSA9PSBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuQ29udGV4dE1lbnVPbikge1xyXG4gICAgICAgIEJyZXcuTWVudXMuc2hvd0NvbnRleHRNZW51KGdtLCBkYXRhKVxyXG5cclxuICAgIH0gZWxzZSBpZiAoZGF0YS5ldmVudFR5cGUgPT0gQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLkhlYWRzVXBEaXNwbGF5T24pIHtcclxuICAgICAgIEJyZXcuTWVudXMuc2hvd0hlYWRzVXBEaXNwbGF5KGdtLCBkYXRhKVxyXG5cclxuICAgIH0gZWxzZSBpZiAoZGF0YS5ldmVudFR5cGUgPT0gQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLlBvd2VyTWVudU9uKSB7XHJcbiAgICAgICAgQnJldy5NZW51cy5zaG93UG93ZXJNYW5hZ2VtZW50TWVudShnbSwgZGF0YSlcclxuXHJcbiAgICB9IGVsc2UgaWYgKGRhdGEuZXZlbnRUeXBlID09IEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5Qb3dlclVuaW5zdGFsbCkge1xyXG4gICAgICAgIEJyZXcuUG93ZXJzLnVuaW5zdGFsbFBvd2VyKGdtLCBkYXRhKVxyXG5cclxuICAgIH0gZWxzZSBpZiAoZGF0YS5ldmVudFR5cGUgPT0gQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLlBvd2VyU3dhcFNlbGVjdE1lbnVPbikge1xyXG4gICAgICAgIEJyZXcuTWVudXMuc2hvd1Bvd2VyU3dhcFNlbGVjdE1lbnUoZ20sIGRhdGEpXHJcblxyXG4gICAgfSBlbHNlIGlmIChkYXRhLmV2ZW50VHlwZSA9PSBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuUG93ZXJTd2FwRmluYWxpemUpIHtcclxuICAgICAgICBCcmV3LlBvd2Vycy5zd2FwUG93ZXIoZ20sIGRhdGEpXHJcblxyXG4gICAgfSBlbHNlIGlmIChkYXRhLmV2ZW50VHlwZSA9PSBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuUG93ZXJJbnN0YWxsUHJvbXB0T24pIHtcclxuICAgICAgICBCcmV3Lk1lbnVzLnNob3dQb3dlckluc3RhbGxQcm9tcHRNZW51KGdtLCBkYXRhKVxyXG5cclxuICAgIH0gZWxzZSBpZiAoZGF0YS5ldmVudFR5cGUgPT0gQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLlBvd2VySW5zdGFsbFJlcGxhY2VtZW50T24pIHtcclxuICAgICAgICBCcmV3Lk1lbnVzLnNob3dQb3dlckluc3RhbGxTZWxlY3RNZW51KGdtLCBkYXRhKVxyXG5cclxuICAgIH0gZWxzZSBpZiAoZGF0YS5ldmVudFR5cGUgPT0gQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLlBvd2VySW5zdGFsbEZpbmFsaXplKSB7XHJcbiAgICAgICAgQnJldy5Qb3dlcnMuaW5zdGFsbFBvd2VyKGdtLCBkYXRhKVxyXG5cclxuICAgIH0gZWxzZSBpZiAoZGF0YS5ldmVudFR5cGUgPT0gQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLlBsYXllckRlYXRoKSB7XHJcbiAgICAgICAgZ2FtZV9vdmVyKGdtLCBkYXRhKVxyXG5cclxuICAgIH0gZWxzZSBpZiAoZGF0YS5ldmVudFR5cGUgPT0gQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLlZpY3RvcnkpIHtcclxuICAgICAgICBnYW1lX3ZpY3RvcnkoZ20sIGRhdGEpXHJcblxyXG4gICAgfSBlbHNlIGlmIChkYXRhLmV2ZW50VHlwZSA9PSBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuUmVzdGFydEdhbWUpIHtcclxuICAgICAgICByZXN0YXJ0X2dhbWUoZ20sIGRhdGEpXHJcblxyXG4gICAgfSBlbHNlIGlmIChkYXRhLmV2ZW50VHlwZSA9PSBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuVXNlUG9ydGFsKSB7XHJcbiAgICAgICBCcmV3Lk1vdmVtZW50LnRyaWdnZXJQb3J0YWxVc2UoZ20sIGRhdGEpXHJcblxyXG4gICAgfSBlbHNlIGlmIChkYXRhLmV2ZW50VHlwZSA9PSBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuQ2hhbmdlTGV2ZWwpIHtcclxuICAgICAgICBjaGFuZ2VfbGV2ZWwoZ20sIGRhdGEpXHJcblxyXG4gICAgfSBlbHNlIGlmIChkYXRhLmV2ZW50VHlwZSA9PSBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuUnVuQW5pbWF0aW9uKSB7XHJcbiAgICAgICAgQnJldy5BbmltYXRpb25zLnJ1bkFuaW1hdGlvbkV2ZW50KGdtLCBkYXRhKVxyXG5cclxuICAgIH0gZWxzZSBpZiAoZGF0YS5ldmVudFR5cGUgPT0gQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLkdlbmVyaWNNZW51T24pIHtcclxuICAgICAgICBCcmV3Lk1lbnVzLnNob3dHZW5lcmljTWVudShnbSwgZGF0YSlcclxuICAgIH0gZWxzZSBpZiAoZGF0YS5ldmVudFR5cGUgPT0gQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLkdlbmVyaWNNZW51T2ZmKSB7XHJcbiAgICAgICAgQnJldy5NZW51cy5zdG9wU2hvd2luZ0dlbmVyaWNNZW51KGdtLCBkYXRhKVxyXG4gICAgfSBlbHNlIGlmIChkYXRhLmV2ZW50VHlwZSA9PSBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuR2VuZXJpY01lbnVNb3ZlKSB7XHJcbiAgICAgICAgQnJldy5NZW51cy51cGRhdGVHZW5lcmljTWVudShnbSwgZGF0YSlcclxuICAgIH0gZWxzZSBpZiAoZGF0YS5ldmVudFR5cGUgPT0gQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLkdlbmVyaWNNZW51U2VsZWN0KSB7XHJcbiAgICAgICBCcmV3LiBNZW51cy5zZWxlY3RGcm9tR2VuZXJpY01lbnUoZ20sIGRhdGEpXHJcblxyXG4gICAgfSBlbHNlIGlmIChkYXRhLmV2ZW50VHlwZSA9PSBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuQ29uZmlybVBhdGhzT24pIHtcclxuICAgICAgICBCcmV3Lk1lbnVzLnNob3dDb25maXJtUGF0aHMoZ20sIGRhdGEpXHJcblxyXG4gICAgfSBlbHNlIGlmIChkYXRhLmV2ZW50VHlwZSA9PSBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuQ29uZmlybVBhdGhzRmluYWxpemUpIHtcclxuICAgICAgICBCcmV3Lk1lbnVzLmZpbmFsaXplQ29uZmlybVBhdGhzKGdtLCBkYXRhKVxyXG5cclxuICAgIH0gZWxzZSBpZiAoZGF0YS5ldmVudFR5cGUgPT0gQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLkNvbmZpcm1QYXRoc0NhbmNlbCkge1xyXG4gICAgICAgIEJyZXcuTWVudXMuY2FuY2VsQ29uZmlybVBhdGhzKGdtLCBkYXRhKVxyXG4gICAgXHJcbiAgICB9IGVsc2UgaWYgKGRhdGEuZXZlbnRUeXBlID09IEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5IZWF2eUF4ZVRocm93ICkge1xyXG4gICAgICAgIEJyZXcuUG93ZXJzLnRocm93X2F4ZShnbSwgZGF0YSlcclxuXHJcbiAgICB9IGVsc2UgaWYgKGRhdGEuZXZlbnRUeXBlID09IEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5IZWF2eUF4ZVJlY2FsbCApIHtcclxuICAgICAgICBCcmV3LlBvd2Vycy5yZWNhbGxfYXhlKGdtLCBkYXRhKVxyXG4gICAgICAgIFxyXG4gICAgfSBlbHNlIGlmIChkYXRhLmV2ZW50VHlwZSA9PSBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuRGVidWdDcmVhdGVNb2JNZW51T24pIHtcclxuICAgICAgICBCcmV3LkRlYnVnLnNob3dDcmVhdGVNb25zdGVyQXRNZW51KGdtLCBkYXRhKVxyXG5cclxuICAgIH0gZWxzZSBpZiAoZGF0YS5ldmVudFR5cGUgPT0gQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLkRlYnVnQ3JlYXRlTW9iQXQpIHtcclxuICAgICAgICBCcmV3LkRlYnVnLmNyZWF0ZU1vbnN0ZXJBdChnbSwgZGF0YSlcclxuXHJcbiAgICB9IGVsc2UgaWYgKGRhdGEuZXZlbnRUeXBlID09IEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5EZWJ1Z0NyZWF0ZUZlYXR1cmVNZW51T24pIHtcclxuICAgICAgICBCcmV3LkRlYnVnLnNob3dDcmVhdGVGZWF0dXJlQXRNZW51KGdtLCBkYXRhKVxyXG5cclxuICAgIH0gZWxzZSBpZiAoZGF0YS5ldmVudFR5cGUgPT0gQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLkRlYnVnQ3JlYXRlRmVhdHVyZUF0KSB7XHJcbiAgICAgICAgQnJldy5EZWJ1Zy5jcmVhdGVGZWF0dXJlQXQoZ20sIGRhdGEpXHJcblxyXG4gICAgfSBlbHNlIGlmIChkYXRhLmV2ZW50VHlwZSA9PSBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuRGVidWdDcmVhdGVUZXJyYWluQXQpIHtcclxuICAgICAgICBCcmV3LkRlYnVnLmNyZWF0ZVRlcnJhaW5BdChnbSwgZGF0YSlcclxuXHJcbiAgICB9IGVsc2UgaWYgKGRhdGEuZXZlbnRUeXBlID09IEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5EZWJ1Z0NyZWF0ZVRlcnJhaW5NZW51T24pIHtcclxuICAgICAgICBCcmV3LkRlYnVnLnNob3dDcmVhdGVUZXJyYWluQXRNZW51KGdtLCBkYXRhKVxyXG5cclxuICAgIH0gZWxzZSBpZiAoZGF0YS5ldmVudFR5cGUgPT0gQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLk1hc3NEYW1hZ2UpIHtcclxuICAgICAgICBCcmV3LkNvbWJhdC5hcHBseU1hc3NEYW1hZ2UoZ20sIGRhdGEpXHJcbiAgICBcclxuICAgIH0gZWxzZSBpZiAoZGF0YS5ldmVudFR5cGUgPT0gQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLktub2NrYmFjaykge1xyXG4gICAgICAgQnJldy5Nb3ZlbWVudC5rbm9ja2JhY2soZ20sIGRhdGEpXHJcbiAgICB9IGVsc2UgaWYgKGRhdGEuZXZlbnRUeXBlID09IEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5BY3F1aXJlVGFyZ2V0KSB7XHJcbiAgICAgICBCcmV3LlRhcmdldGluZy5hcXVpcmVUYXJnZXRMb2NrRXZlbnQoZ20sIGRhdGEpXHJcblxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwicmVjZWl2ZWQgdW5rbm93biBldmVudCB0eXBlXCIsIGRhdGEpXHJcbiAgICB9XHJcbiAgICBcclxufVxyXG5cclxuZnVuY3Rpb24gY2hhbmdlX2xldmVsKGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGRhdGE6IEJyZXcuRW51bXMuSUJyZXdFdmVudCkge1xyXG4gICAgbGV0IHBvcnRhbCA6IEJyZXcuUG9ydGFsID0gZGF0YS5wb3J0YWxEYXRhLnBvcnRhbF91c2VkIFxyXG4gICAgbGV0IGxldmVsX2F1ZGl0ID0gQnJldy5UYW5rLnByb2Nlc3NJbnZlbnRvcnkoZ20pXHJcblxyXG4gICAgZ20uZ2V0Q3VycmVudExldmVsKCkubW9uc3RlcnMucmVtb3ZlQXQoZ20uZ2V0UGxheWVyKCkubG9jYXRpb24pXHJcbiAgICBnbS5zZXR1cExldmVsKHBvcnRhbC5kZXN0X2xldmVsX2lkLCBwb3J0YWwuZGVzdF9sb2NhdGlvbl94eSlcclxuICAgIC8vIGdtLmRpc3BsYXlBbGwoKVxyXG5cclxuICAgIGdtLmluc2VydEV2ZW50KEJyZXcuVGFuay5nZXRMZXZlbEF1ZGl0UmVwb3J0KGdtLCBsZXZlbF9hdWRpdCkpXHJcbiAgICBnbS5lbmRFdmVudChkYXRhKVxyXG59XHJcblxyXG5mdW5jdGlvbiBzcGVjaWFsKGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGRhdGE6IEJyZXcuRW51bXMuSUJyZXdFdmVudCkgeyBcclxuICAgIFxyXG4gICAgLy8gZ20uZGlzcGxheUF0KGRhdGEuYWN0b3IubG9jYXRpb24pXHJcbiAgICBnbS5lbmRFdmVudChkYXRhKVxyXG5cclxuXHJcbn1cclxuXHJcbmZ1bmN0aW9uIGRpc3BsYXlfaW5mbyhnbTogQnJldy5HYW1lTWFzdGVyLCBkYXRhOiBCcmV3LkVudW1zLklCcmV3RXZlbnQpIHtcclxuICAgIGxldCBsZXZlbCA9IGdtLmdldEN1cnJlbnRMZXZlbCgpXHJcbiAgICAvLyB0b2RvOiB0aGlzIGlzIHRoZSBpbi1kZXB0aCBoaWdobGlnaHQgdG9vbCwgdnMgY3Vyc29yIG92ZXJ2aWV3XHJcblxyXG4gICAgLy8gZGVidWcgc2hvdyB3aGF0J3MgdGhlcmVcclxuICAgIGxldCBkaXZEZWJ1ZyA9IDxIVE1MRGl2RWxlbWVudD4gKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiaWRfZGl2X2RlYnVnXCIpKVxyXG4gICAgZGl2RGVidWcuaW5uZXJIVE1MID0gXCI8cD5cIiArIGRhdGEubW92ZURhdGEudG9feHkudG9TdHJpbmcoKSArIFwiPC9wPlwiXHJcbiAgICBnbS5kaXNwbGF5LmRyYXdGb290ZXIoKVxyXG4gICAgZ20uZW5kRXZlbnQoZGF0YSlcclxufVxyXG5cclxuZnVuY3Rpb24gcmVtb3RlX2hhY2soZ206IEJyZXcuR2FtZU1hc3RlciwgZGF0YTogQnJldy5FbnVtcy5JQnJld0V2ZW50KSB7XHJcbiAgICBsZXQgdGFyZ2V0X3h5IDogQnJldy5Db29yZGluYXRlID0gZGF0YS5tb3ZlRGF0YS50b194eVxyXG4gICAgbGV0IHRhcmdldCA9IGdtLmdldEN1cnJlbnRMZXZlbCgpLm1vbnN0ZXJzLmdldEF0KHRhcmdldF94eSlcclxuXHJcbiAgICAvLyBkZWNyZW1lbnQgcG93ZXIgY2hhcmdlIG9uIHN1Y2Nlc3NcclxuICAgIGRhdGEucG93ZXJEYXRhLnBvd2VyLmNoYXJnZV9zdGF0LmRlY3JlbWVudCgxKVxyXG4gICAgXHJcbiAgICBpZiAodGFyZ2V0LnRlYW0gIT0gQnJldy5FbnVtcy5UZWFtLlBsYXllcikge1xyXG4gICAgICAgIHRhcmdldC50ZWFtID0gQnJldy5FbnVtcy5UZWFtLlBsYXllckFsbGllZFxyXG4gICAgICAgIGNvbnNvbGUubG9nKGAke3RhcmdldC5uYW1lfSBoYXMgYmVlbiBoYWNrZWQhIWApXHJcbiAgICAgICAgdGFyZ2V0LmNvbG9yID0gQnJldy5Db2xvci5oZXJvX2JsdWVcclxuICAgICAgICBnbS5kaXNwbGF5QXQodGFyZ2V0LmxvY2F0aW9uKVxyXG4gICAgfVxyXG4gICAgZ20uZW5kRXZlbnQoZGF0YSlcclxuXHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNoaWVsZHNfdXAoZ206IEJyZXcuR2FtZU1hc3RlciwgZGF0YTogQnJldy5FbnVtcy5JQnJld0V2ZW50KSB7XHJcbiAgICBkYXRhLmFjdG9yLnNoaWVsZHMgPSBuZXcgQnJldy5TdGF0KEJyZXcuRW51bXMuU3RhdE5hbWUuU2hpZWxkcywgQnJldy5Db25maWcucGxheWVyX3NoaWVsZF9hbW91bnQpXHJcbiAgICBnbS5nZXRQbGF5ZXIoKS5jb2xvciA9IEJyZXcuQ29sb3IucG93ZXJfc2hpZWxkXHJcbiAgICBjb25zb2xlLmxvZyhcInNoaWVsZHMgYWN0aXZhdGVkXCIpXHJcblxyXG4gICAgLy8gQnJldy5BbmltYXRpb25zLmFuaW1hdGVDaXJjbGUoZ20sIGRhdGEuYWN0b3IubG9jYXRpb24sIDMsIEJyZXcuQ29sb3IucG93ZXJfc2hpZWxkLCBkYXRhKVxyXG4gICAgbGV0IGFuaW1hdGlvbkV2ZW50ID0gQnJldy5BbmltYXRpb25zLmNyZWF0ZUNpcmNsZUFuaW1hdGlvbkV2ZW50KGRhdGEsIEJyZXcuQ29sb3IucG93ZXJfc2hpZWxkLCAzKVxyXG4gICAgLy8gbGV0IGFuaW1hdGlvbkV2ZW50ID0gQnJldy5BbmltYXRpb25zLmNyZWF0ZVJldmVyc2VDaXJjbGVBbmltYXRpb25FdmVudChkYXRhLCBCcmV3LkNvbG9yLnBvd2VyX3NoaWVsZCwgMylcclxuICAgIGdtLmluc2VydEV2ZW50KGFuaW1hdGlvbkV2ZW50KVxyXG4gICAgZ20uZW5kRXZlbnQoZGF0YSlcclxufVxyXG5cclxuZnVuY3Rpb24gY2xvYWtfb24oZ206IEJyZXcuR2FtZU1hc3RlciwgZGF0YTogQnJldy5FbnVtcy5JQnJld0V2ZW50KSB7XHJcbiAgICBkYXRhLmFjdG9yLnNldEZsYWcoQnJldy5FbnVtcy5GbGFnLkludmlzaWJsZSlcclxuICAgIGdtLnRpbWVyX21vbml0b3IuYWRkVGltZXIobmV3IEJyZXcuVGltZXJzLlR1cm5UaW1lcihkYXRhLmFjdG9yLCBCcmV3LkVudW1zLkZsYWcuSW52aXNpYmxlLCBnbS50dXJuX2NvdW50LCAyMCkpIC8vdG9kbzogdGllIHBvd2VyIGR1cmF0aW9uIHRvIHBvd2VyIGxldmVsL3N0cmVuZ2hcclxuXHJcbiAgICBjb25zb2xlLmxvZyhcImdvaW5nIGRhcmtcIilcclxuICAgIGxldCBhbmltYXRpb25FdmVudCA9IEJyZXcuQW5pbWF0aW9ucy5jcmVhdGVDaXJjbGVBbmltYXRpb25FdmVudChkYXRhLCBCcmV3LkNvbG9yLnBvd2VyX2Nsb2FrLCAzKVxyXG4gICAgZ20uaW5zZXJ0RXZlbnQoYW5pbWF0aW9uRXZlbnQpXHJcbiAgICBnbS5lbmRFdmVudChkYXRhKVxyXG59XHJcblxyXG5mdW5jdGlvbiBwaGFzZXdhbGtfb24oZ20gOiBCcmV3LkdhbWVNYXN0ZXIsIGRhdGE6IEJyZXcuRW51bXMuSUJyZXdFdmVudCkge1xyXG4gICAgZGF0YS5hY3Rvci5zZXRGbGFnKEJyZXcuRW51bXMuRmxhZy5QaGFzZVdhbGspXHJcbiAgICBnbS50aW1lcl9tb25pdG9yLmFkZFRpbWVyKG5ldyBCcmV3LlRpbWVycy5UdXJuVGltZXIoZGF0YS5hY3RvciwgQnJldy5FbnVtcy5GbGFnLlBoYXNlV2FsaywgZ20udHVybl9jb3VudCwgMTApKVxyXG4gICAgY29uc29sZS5sb2coXCJnaG9zdCBtb2RlIGFjdGl2YXRlZFwiKVxyXG4gICAgLy8gQnJldy5BbmltYXRpb25zLmFuaW1hdGVDaXJjbGUoZ20sIGRhdGEuYWN0b3IubG9jYXRpb24sIDMsIEJyZXcuQ29sb3IucG93ZXJfcGhhc2V3YWxrLCBkYXRhKVxyXG4gICAgbGV0IGFuaW1hdGlvbkV2ZW50ID0gQnJldy5BbmltYXRpb25zLmNyZWF0ZUNpcmNsZUFuaW1hdGlvbkV2ZW50KGRhdGEsIEJyZXcuQ29sb3IucG93ZXJfcGhhc2V3YWxrLCAzKVxyXG4gICAgZ20uaW5zZXJ0RXZlbnQoYW5pbWF0aW9uRXZlbnQpXHJcbiAgICBnbS5lbmRFdmVudChkYXRhKVxyXG59XHJcblxyXG5mdW5jdGlvbiBnYW1lX292ZXIoZ20gOiBCcmV3LkdhbWVNYXN0ZXIsIGRhdGE6IEJyZXcuRW51bXMuSUJyZXdFdmVudCkge1xyXG4gICAgLy8gZ20uZGlzcGxheS5nYW1lT3ZlckRyYXcoKVxyXG4gICAgLy8gZ20uaW5wdXRfaGFuZGxlciA9IElucHV0SGFuZGxlci5XYWl0VG9SZXN0YXJ0XHJcbiAgICBcclxuICAgIC8vIGNsZWFyIG91dCBvdGhlciBhY3RvcnNcclxuICAgIGdtLmdldEN1cnJlbnRMZXZlbCgpLm1vbnN0ZXJzLmdldEFsbFRoaW5ncygpLmZvckVhY2goKG1vYjogQnJldy5HcmlkVGhpbmdzLk1vbnN0ZXIpID0+IHtcclxuICAgICAgICBpZiAoIShtb2IuaXNTYW1lVGhpbmcoZ20uZ2V0UGxheWVyKCkpKSkge1xyXG4gICAgICAgICAgICBnbS5zY2hlZHVsZXIucmVtb3ZlKG1vYilcclxuICAgICAgICB9XHJcbiAgICB9KVxyXG4gICAgLy8gY2xlYXIgb3V0IG5vbi1sZXZlbCBhY3RvcnNcclxuICAgIGdtLnNjaGVkdWxlci5yZW1vdmUoZ20uZ2V0QXJjaGl0ZWN0KCkpXHJcbiAgICBcclxuICAgIGxldCBtZW51X2VudHJpZXMgOiBBcnJheTxCcmV3LkVudW1zLklCcmV3R2VuZXJpY01lbnVFbnRyeT4gPSBbXVxyXG5cclxuICAgIG1lbnVfZW50cmllcy5wdXNoKHtcclxuICAgICAgICBlbnRyeU5hbWU6IFwiTmV3IEdhbWVcIixcclxuICAgICAgICBlbnRyeVR5cGU6IEJyZXcuRW51bXMuR2VuZXJpY01lbnVFbnRyeVR5cGUuRXZlbnRCYXNlZCxcclxuICAgICAgICBlbnRyeUV2ZW50OiB7XHJcbiAgICAgICAgICAgIGV2ZW50VHlwZTogQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLlJlc3RhcnRHYW1lLFxyXG4gICAgICAgICAgICBhY3RvcjogZ20uZ2V0UGxheWVyKCksXHJcbiAgICAgICAgICAgIHBsYXllckluaXRpYXRlZDogdHJ1ZSxcclxuICAgICAgICAgICAgZW5kc1R1cm46IHRydWVcclxuICAgICAgICB9XHJcbiAgICB9KVxyXG5cclxuICAgIG1lbnVfZW50cmllcy5wdXNoKHtcclxuICAgICAgICBlbnRyeU5hbWU6IFwiUmVzdGFydCBTZWVkXCIsXHJcbiAgICAgICAgZW50cnlUeXBlOiBCcmV3LkVudW1zLkdlbmVyaWNNZW51RW50cnlUeXBlLkV2ZW50QmFzZWQsXHJcbiAgICAgICAgZW50cnlFdmVudDoge1xyXG4gICAgICAgICAgICBldmVudFR5cGU6IEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5SZXN0YXJ0R2FtZSxcclxuICAgICAgICAgICAgYWN0b3I6IGdtLmdldFBsYXllcigpLFxyXG4gICAgICAgICAgICBwbGF5ZXJJbml0aWF0ZWQ6IHRydWUsXHJcbiAgICAgICAgICAgIGVuZHNUdXJuOiB0cnVlLFxyXG4gICAgICAgICAgICByZXN0YXJ0RGF0YTogeyBzZWVkOiBnbS5nZXRTZWVkKCkgfVxyXG4gICAgICAgIH1cclxuICAgIH0pXHJcblxyXG4gICAgbGV0IGRlYXRoTWVudUV2ZW50IDogQnJldy5FbnVtcy5JQnJld0V2ZW50ID0ge1xyXG4gICAgICAgIGV2ZW50VHlwZTogQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLkdlbmVyaWNNZW51T24sXHJcbiAgICAgICAgYWN0b3I6IGdtLmdldFBsYXllcigpLFxyXG4gICAgICAgIHBsYXllckluaXRpYXRlZDogZmFsc2UsXHJcbiAgICAgICAgZW5kc1R1cm46IGZhbHNlLFxyXG4gICAgICAgIGdlbmVyaWNNZW51RGF0YToge1xyXG4gICAgICAgICAgICBtZW51VGl0bGU6IFwiQ29uZ3JhdHVsYXRpb25zXCIsXHJcbiAgICAgICAgICAgIG1lbnVEZXNjcmlwdGlvbjogXCJZb3UgaGF2ZSBkaWVkIVwiLFxyXG4gICAgICAgICAgICBhbGxvd0NhbmNlbDogZmFsc2UsXHJcbiAgICAgICAgICAgIG1lbnVFbnRyaWVzTGlzdDogbWVudV9lbnRyaWVzXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIGNsZWFyIG91dCBwZW5kaW5nIGV2ZW50IHF1ZXVlXHJcbiAgICBnbS5jbGVhckV2ZW50UXVldWUoKVxyXG5cclxuICAgIGdtLmluc2VydEV2ZW50KGRlYXRoTWVudUV2ZW50KVxyXG4gICAgZ20uZW5kRXZlbnQoZGF0YSlcclxufVxyXG5cclxuZnVuY3Rpb24gcmVzdGFydF9nYW1lKGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGJyRXZlbnQ6IEJyZXcuRW51bXMuSUJyZXdFdmVudCkge1xyXG4gICAgbGV0IGdpdmVuX3NlZWQgOiBudW1iZXIgPSBudWxsXHJcbiAgICBpZiAoYnJFdmVudC5yZXN0YXJ0RGF0YSkge1xyXG4gICAgICAgIC8vIHN0YXJ0aW5nX3NlZWQgPSBickV2ZW50LnJlc3RhcnREYXRhLnNlZWRcclxuICAgICAgICBnaXZlbl9zZWVkID0gYnJFdmVudC5yZXN0YXJ0RGF0YS5zZWVkXHJcbiAgICB9XHJcbiAgICBzdGFydEdhbWUoZ2l2ZW5fc2VlZClcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUdlbmVyaWNFdmVudE9mVHlwZShnbSA6IEJyZXcuR2FtZU1hc3RlciwgZXZlbnRfdHlwZTogQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLCBlbmRzX3R1cm4gOiBib29sZWFuID0gZmFsc2UpIDogQnJldy5FbnVtcy5JQnJld0V2ZW50IHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgZXZlbnRUeXBlOiBldmVudF90eXBlLFxyXG4gICAgICAgIGFjdG9yOiBnbS5nZXRQbGF5ZXIoKSxcclxuICAgICAgICBwbGF5ZXJJbml0aWF0ZWQ6IHRydWUsXHJcbiAgICAgICAgZW5kc1R1cm46IGVuZHNfdHVyblxyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gYWRkRGF0YVRvRXZlbnQoYnJFdmVudCA6IEJyZXcuRW51bXMuSUJyZXdFdmVudCwgZXh0cmFEYXRhOiBCcmV3LkVudW1zLklCcmV3RXh0cmFFdmVudERhdGEpIDogQnJldy5FbnVtcy5JQnJld0V2ZW50IHtcclxuICAgIGxldCBuZXdFdmVudCA6IEJyZXcuRW51bXMuSUJyZXdFdmVudCA9IHsuLi5ickV2ZW50fVxyXG5cclxuICAgIGZvciAodmFyIGtleSBpbiBleHRyYURhdGEpIHtcclxuICAgICAgICBpZiAoZXh0cmFEYXRhLmhhc093blByb3BlcnR5KGtleSkpIHtcclxuICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSBleHRyYURhdGFba2V5XVxyXG4gICAgICAgICAgICBuZXdFdmVudFtrZXldID0gZWxlbWVudFxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBuZXdFdmVudFxyXG59XHJcblxyXG5mdW5jdGlvbiBnYW1lX3ZpY3RvcnkoZ20gOiBCcmV3LkdhbWVNYXN0ZXIsIGRhdGE6IEJyZXcuRW51bXMuSUJyZXdFdmVudCkge1xyXG4gICAgLy8gZ20uZGlzcGxheS5nYW1lT3ZlckRyYXcoKVxyXG4gICAgLy8gZ20uaW5wdXRfaGFuZGxlciA9IElucHV0SGFuZGxlci5XYWl0VG9SZXN0YXJ0XHJcbiAgICBcclxuICAgIC8vIGNsZWFyIG91dCBvdGhlciBhY3RvcnNcclxuICAgIGdtLmdldEN1cnJlbnRMZXZlbCgpLm1vbnN0ZXJzLmdldEFsbFRoaW5ncygpLmZvckVhY2goKG1vYjogQnJldy5HcmlkVGhpbmdzLk1vbnN0ZXIpID0+IHtcclxuICAgICAgICBpZiAoIShtb2IuaXNTYW1lVGhpbmcoZ20uZ2V0UGxheWVyKCkpKSkge1xyXG4gICAgICAgICAgICBnbS5zY2hlZHVsZXIucmVtb3ZlKG1vYilcclxuICAgICAgICB9XHJcbiAgICB9KVxyXG4gICAgLy8gY2xlYXIgb3V0IG5vbi1sZXZlbCBhY3RvcnNcclxuICAgIGdtLnNjaGVkdWxlci5yZW1vdmUoZ20uZ2V0QXJjaGl0ZWN0KCkpXHJcbiAgICBcclxuICAgIGxldCBtZW51X2VudHJpZXMgOiBBcnJheTxCcmV3LkVudW1zLklCcmV3R2VuZXJpY01lbnVFbnRyeT4gPSBbXVxyXG5cclxuICAgIG1lbnVfZW50cmllcy5wdXNoKHtcclxuICAgICAgICBlbnRyeU5hbWU6IFwiTmV3IEdhbWVcIixcclxuICAgICAgICBlbnRyeVR5cGU6IEJyZXcuRW51bXMuR2VuZXJpY01lbnVFbnRyeVR5cGUuRXZlbnRCYXNlZCxcclxuICAgICAgICBlbnRyeUV2ZW50OiB7XHJcbiAgICAgICAgICAgIGV2ZW50VHlwZTogQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLlJlc3RhcnRHYW1lLFxyXG4gICAgICAgICAgICBhY3RvcjogZ20uZ2V0UGxheWVyKCksXHJcbiAgICAgICAgICAgIHBsYXllckluaXRpYXRlZDogdHJ1ZSxcclxuICAgICAgICAgICAgZW5kc1R1cm46IHRydWVcclxuICAgICAgICB9XHJcbiAgICB9KVxyXG5cclxuICAgIG1lbnVfZW50cmllcy5wdXNoKHtcclxuICAgICAgICBlbnRyeU5hbWU6IFwiUmVzdGFydCBTZWVkXCIsXHJcbiAgICAgICAgZW50cnlUeXBlOiBCcmV3LkVudW1zLkdlbmVyaWNNZW51RW50cnlUeXBlLkV2ZW50QmFzZWQsXHJcbiAgICAgICAgZW50cnlFdmVudDoge1xyXG4gICAgICAgICAgICBldmVudFR5cGU6IEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5SZXN0YXJ0R2FtZSxcclxuICAgICAgICAgICAgYWN0b3I6IGdtLmdldFBsYXllcigpLFxyXG4gICAgICAgICAgICBwbGF5ZXJJbml0aWF0ZWQ6IHRydWUsXHJcbiAgICAgICAgICAgIGVuZHNUdXJuOiB0cnVlLFxyXG4gICAgICAgICAgICByZXN0YXJ0RGF0YTogeyBzZWVkOiBnbS5nZXRTZWVkKCkgfVxyXG4gICAgICAgIH1cclxuICAgIH0pXHJcblxyXG4gICAgbGV0IHZpY3RvcnlNZW51RXZlbnQgOiBCcmV3LkVudW1zLklCcmV3RXZlbnQgPSB7XHJcbiAgICAgICAgZXZlbnRUeXBlOiBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuR2VuZXJpY01lbnVPbixcclxuICAgICAgICBhY3RvcjogZ20uZ2V0UGxheWVyKCksXHJcbiAgICAgICAgcGxheWVySW5pdGlhdGVkOiBmYWxzZSxcclxuICAgICAgICBlbmRzVHVybjogZmFsc2UsXHJcbiAgICAgICAgZ2VuZXJpY01lbnVEYXRhOiB7XHJcbiAgICAgICAgICAgIG1lbnVUaXRsZTogXCJWIEkgQyBUIE8gUiBZXCIsXHJcbiAgICAgICAgICAgIG1lbnVEZXNjcmlwdGlvbjogXCJZb3UgZGlkIGl0ISBDb25ncmF0dWxhdGlvbnMhIFRoaXMgdmljdG9yeSBzY3JlZW4gd2lsbCBoYXZlIHRvIGRvIGZvciBub3csIHVudGlsIGhpZ2ggc2NvcmVzIGFyZSBpbXBsZW1lbnRlZC5cIixcclxuICAgICAgICAgICAgYWxsb3dDYW5jZWw6IGZhbHNlLFxyXG4gICAgICAgICAgICBtZW51RW50cmllc0xpc3Q6IG1lbnVfZW50cmllc1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBjbGVhciBvdXQgcGVuZGluZyBldmVudCBxdWV1ZVxyXG4gICAgZ20uY2xlYXJFdmVudFF1ZXVlKClcclxuXHJcbiAgICBnbS5pbnNlcnRFdmVudCh2aWN0b3J5TWVudUV2ZW50KVxyXG4gICAgZ20uZW5kRXZlbnQoZGF0YSlcclxufSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/brew_engine/events.ts\n");

/***/ }),

/***/ "./src/brew_engine/fastdijkstramap.ts":
/*!********************************************!*\
  !*** ./src/brew_engine/fastdijkstramap.ts ***!
  \********************************************/
/*! exports provided: MAX_INT, PathFunctionWalkable, PathFunctionFlyable, setupDijkstraMap, solveDijkstraMap, getMaxAndMinDijkstraMapValues */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"MAX_INT\", function() { return MAX_INT; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"PathFunctionWalkable\", function() { return PathFunctionWalkable; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"PathFunctionFlyable\", function() { return PathFunctionFlyable; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"setupDijkstraMap\", function() { return setupDijkstraMap; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"solveDijkstraMap\", function() { return solveDijkstraMap; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getMaxAndMinDijkstraMapValues\", function() { return getMaxAndMinDijkstraMapValues; });\n/* harmony import */ var _brew__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../brew */ \"./src/brew.ts\");\n\r\nconst MAX_INT = 1 / 0;\r\nlet MAX_GRID_SIZE = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Config\"].MAX_GRID_SIZE;\r\nlet flood_fill_fn = (x, y, level, pathable_fn, local_map, passable, blocked) => {\r\n    // stop condition: out of bounds\r\n    if ((x < 0) ||\r\n        (y < 0) ||\r\n        (x >= level.width) ||\r\n        (y >= level.height)) {\r\n        return;\r\n    }\r\n    let key = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].x_and_yToKey(x, y).toString();\r\n    // stop condition: already visited\r\n    if (local_map.hasOwnProperty(key)) {\r\n        return;\r\n    }\r\n    // stop condition: blocked\r\n    if (blocked.hasOwnProperty(key)) {\r\n        return;\r\n    }\r\n    // stop condition: hit a wall\r\n    let terrain_at = level.terrain.things[key];\r\n    if (!(pathable_fn(terrain_at))) {\r\n        blocked[key] = true;\r\n        return;\r\n    }\r\n    // otherwise, set value \r\n    local_map[key] = MAX_INT;\r\n    // keep track of passable tiles\r\n    passable[key] = true;\r\n    // recursion\r\n    flood_fill_fn(x + 1, y, level, pathable_fn, local_map, passable, blocked);\r\n    flood_fill_fn(x - 1, y, level, pathable_fn, local_map, passable, blocked);\r\n    flood_fill_fn(x, y + 1, level, pathable_fn, local_map, passable, blocked);\r\n    flood_fill_fn(x, y - 1, level, pathable_fn, local_map, passable, blocked);\r\n    return;\r\n};\r\nlet PathFunctionWalkable;\r\nPathFunctionWalkable = function (terrain_at) {\r\n    return (!(terrain_at.blocks_walking));\r\n};\r\nlet PathFunctionFlyable;\r\nPathFunctionFlyable = function (terrain_at) {\r\n    return (!(terrain_at.blocks_flying));\r\n};\r\nfunction setupDijkstraMap(level, start_xy, pathable_fn) {\r\n    let djMap = {};\r\n    let blocked = {};\r\n    let passable = {};\r\n    // set all passable tiles to MAX-INT\r\n    flood_fill_fn(start_xy.x, start_xy.y, level, pathable_fn, djMap, passable, blocked);\r\n    // set target/goal to 0\r\n    // djMap[Brew.Utils.x_and_yToKey(start_xy.x, start_xy.y)] = 0\r\n    return djMap;\r\n}\r\nfunction getAdjacentKeys(at_key) {\r\n    return [at_key - 1, at_key + 1, at_key - MAX_GRID_SIZE, at_key + MAX_GRID_SIZE];\r\n}\r\nfunction solveDijkstraMap(djMap) {\r\n    let adjacent_map = {};\r\n    let adjacent_keys;\r\n    // let madeChanges = true\r\n    let count_passes = 0;\r\n    let lowest_neighbor_val;\r\n    let map_value;\r\n    let neighbor_val;\r\n    let neighbor_values;\r\n    // let key: string\r\n    // let i : number\r\n    let current_queue = [];\r\n    let next_queue = [];\r\n    for (let kkey in djMap) {\r\n        current_queue.push(Number(kkey));\r\n    }\r\n    while (current_queue.length) {\r\n        count_passes += 1;\r\n        current_queue.forEach((num_key, index, array) => {\r\n            map_value = djMap[num_key];\r\n            // find adjacent neighbor tiles\r\n            if (num_key in adjacent_map) {\r\n                adjacent_keys = adjacent_map[num_key];\r\n            }\r\n            else {\r\n                // if we haven't already looked them up, then calculate them \r\n                adjacent_keys = getAdjacentKeys(num_key).filter((my_key, index, array) => {\r\n                    return (my_key in djMap);\r\n                });\r\n                // .. and store them for later\r\n                adjacent_map[num_key] = adjacent_keys;\r\n            }\r\n            // go through each neighbors and find the lowest value\r\n            lowest_neighbor_val = MAX_INT; // 1/0\r\n            adjacent_keys.forEach((neighbor_key, index, array) => {\r\n                neighbor_val = djMap[neighbor_key];\r\n                if (neighbor_val < lowest_neighbor_val) {\r\n                    lowest_neighbor_val = neighbor_val;\r\n                }\r\n            });\r\n            if ((map_value - lowest_neighbor_val) >= 2) {\r\n                djMap[num_key] = lowest_neighbor_val + 1;\r\n                next_queue = next_queue.concat(adjacent_keys);\r\n                // next_queue.push(num_key)\r\n            }\r\n        });\r\n        current_queue = next_queue.concat([]);\r\n        next_queue = [];\r\n    }\r\n    return count_passes;\r\n}\r\nfunction getMaxAndMinDijkstraMapValues(djmap) {\r\n    let max_value = -(1 / 0);\r\n    let min_value = 1 / 0;\r\n    for (let key in djmap) {\r\n        // if (djmap.hasOwnProperty(key)) {\r\n        let map_value = djmap[key];\r\n        if (map_value != MAX_INT) {\r\n            if (map_value < min_value) {\r\n                min_value = map_value;\r\n            }\r\n            if (map_value > max_value) {\r\n                max_value = map_value;\r\n            }\r\n        }\r\n        // }\r\n    }\r\n    return {\r\n        max: max_value,\r\n        min: min_value\r\n    };\r\n}\r\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvYnJld19lbmdpbmUvZmFzdGRpamtzdHJhbWFwLnRzP2ZmYzMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBK0I7QUFFeEIsTUFBTSxPQUFPLEdBQUcsQ0FBQyxHQUFDLENBQUM7QUFDMUIsSUFBSSxhQUFhLEdBQUcsNENBQVcsQ0FBQyxhQUFhO0FBVTdDLElBQUksYUFBYSxHQUFHLENBQUMsQ0FBUyxFQUFFLENBQVMsRUFBRSxLQUFpQixFQUFFLFdBQThCLEVBQUUsU0FBdUIsRUFBRSxRQUFxQixFQUFFLE9BQW9CLEVBQUUsRUFBRTtJQUNsSyxnQ0FBZ0M7SUFDaEMsRUFBRSxDQUFDLENBQ0MsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ1AsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ1AsQ0FBQyxDQUFDLElBQUksS0FBSyxDQUFDLEtBQUssQ0FBQztRQUNsQixDQUFDLENBQUMsSUFBSSxLQUFLLENBQUMsTUFBTSxDQUN0QixDQUFDLENBQUMsQ0FBQztRQUNDLE1BQU07SUFDVixDQUFDO0lBRUQsSUFBSSxHQUFHLEdBQUcsMkNBQVUsQ0FBQyxZQUFZLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLFFBQVEsRUFBRTtJQUVsRCxrQ0FBa0M7SUFDbEMsRUFBRSxDQUFDLENBQUMsU0FBUyxDQUFDLGNBQWMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDaEMsTUFBTTtJQUNWLENBQUM7SUFFRCwwQkFBMEI7SUFDMUIsRUFBRSxDQUFDLENBQUMsT0FBTyxDQUFDLGNBQWMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDOUIsTUFBTTtJQUNWLENBQUM7SUFFRCw2QkFBNkI7SUFDN0IsSUFBSSxVQUFVLEdBQUcsS0FBSyxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDO0lBQzFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxXQUFXLENBQUMsVUFBVSxDQUFD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LEtBQW9CO0lBQzlELElBQUksU0FBUyxHQUFHLENBQUMsQ0FBQyxDQUFDLEdBQUMsQ0FBQyxDQUFDO0lBQ3RCLElBQUksU0FBUyxHQUFHLENBQUMsR0FBQyxDQUFDO0lBRW5CLEdBQUcsQ0FBQyxDQUFDLElBQUksR0FBRyxJQUFJLEtBQUssQ0FBQyxDQUFDLENBQUM7UUFDcEIsbUNBQW1DO1FBQy9CLElBQUksU0FBUyxHQUFHLEtBQUssQ0FBQyxHQUFHLENBQUM7UUFDMUIsRUFBRSxDQUFDLENBQUMsU0FBUyxJQUFJLE9BQU8sQ0FBQyxDQUFDLENBQUM7WUFDdkIsRUFBRSxDQUFDLENBQUMsU0FBUyxHQUFHLFNBQVMsQ0FBQyxDQUFDLENBQUM7Z0JBQ3hCLFNBQVMsR0FBRyxTQUFTO1lBQ3pCLENBQUM7WUFFRCxFQUFFLENBQUMsQ0FBQyxTQUFTLEdBQUcsU0FBUyxDQUFDLENBQUMsQ0FBQztnQkFDeEIsU0FBUyxHQUFHLFNBQVM7WUFDekIsQ0FBQztRQUNMLENBQUM7UUFDTCxJQUFJO0lBQ1IsQ0FBQztJQUVELE1BQU0sQ0FBQztRQUNILEdBQUcsRUFBRSxTQUFTO1FBQ2QsR0FBRyxFQUFFLFNBQVM7S0FDakI7QUFDTCxDQUFDIiwiZmlsZSI6Ii4vc3JjL2JyZXdfZW5naW5lL2Zhc3RkaWprc3RyYW1hcC50cy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIEJyZXcgZnJvbSBcIi4uL2JyZXdcIlxyXG5cclxuZXhwb3J0IGNvbnN0IE1BWF9JTlQgPSAxLzBcclxubGV0IE1BWF9HUklEX1NJWkUgPSBCcmV3LkNvbmZpZy5NQVhfR1JJRF9TSVpFXHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIElEaWprc3RyYU1hcCB7XHJcbiAgICBba2V5OiBudW1iZXJdIDogbnVtYmVyXHJcbn1cclxuXHJcbmludGVyZmFjZSBJU3RvcmFnZU1hcCB7XHJcbiAgICBba2V5OiBudW1iZXJdIDogYm9vbGVhblxyXG59XHJcblxyXG5sZXQgZmxvb2RfZmlsbF9mbiA9ICh4OiBudW1iZXIsIHk6IG51bWJlciwgbGV2ZWw6IEJyZXcuTGV2ZWwsIHBhdGhhYmxlX2ZuOiBJUGF0aGFibGVGdW5jdGlvbiwgbG9jYWxfbWFwOiBJRGlqa3N0cmFNYXAsIHBhc3NhYmxlOiBJU3RvcmFnZU1hcCwgYmxvY2tlZDogSVN0b3JhZ2VNYXApID0+IHtcclxuICAgIC8vIHN0b3AgY29uZGl0aW9uOiBvdXQgb2YgYm91bmRzXHJcbiAgICBpZiAoXHJcbiAgICAgICAgKHggPCAwKSB8fFxyXG4gICAgICAgICh5IDwgMCkgfHxcclxuICAgICAgICAoeCA+PSBsZXZlbC53aWR0aCkgfHxcclxuICAgICAgICAoeSA+PSBsZXZlbC5oZWlnaHQpXHJcbiAgICApIHtcclxuICAgICAgICByZXR1cm5cclxuICAgIH1cclxuXHJcbiAgICBsZXQga2V5ID0gQnJldy5VdGlscy54X2FuZF95VG9LZXkoeCwgeSkudG9TdHJpbmcoKVxyXG5cclxuICAgIC8vIHN0b3AgY29uZGl0aW9uOiBhbHJlYWR5IHZpc2l0ZWRcclxuICAgIGlmIChsb2NhbF9tYXAuaGFzT3duUHJvcGVydHkoa2V5KSkge1xyXG4gICAgICAgIHJldHVyblxyXG4gICAgfVxyXG5cclxuICAgIC8vIHN0b3AgY29uZGl0aW9uOiBibG9ja2VkXHJcbiAgICBpZiAoYmxvY2tlZC5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XHJcbiAgICAgICAgcmV0dXJuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gc3RvcCBjb25kaXRpb246IGhpdCBhIHdhbGxcclxuICAgIGxldCB0ZXJyYWluX2F0ID0gbGV2ZWwudGVycmFpbi50aGluZ3Nba2V5XVxyXG4gICAgaWYgKCEocGF0aGFibGVfZm4odGVycmFpbl9hdCkpKSB7XHJcbiAgICAgICAgYmxvY2tlZFtrZXldID0gdHJ1ZVxyXG4gICAgICAgIHJldHVyblxyXG4gICAgfVxyXG5cclxuICAgIC8vIG90aGVyd2lzZSwgc2V0IHZhbHVlIFxyXG4gICAgbG9jYWxfbWFwW2tleV0gPSBNQVhfSU5UXHJcblxyXG4gICAgLy8ga2VlcCB0cmFjayBvZiBwYXNzYWJsZSB0aWxlc1xyXG4gICAgcGFzc2FibGVba2V5XSA9IHRydWVcclxuXHJcbiAgICAvLyByZWN1cnNpb25cclxuICAgIGZsb29kX2ZpbGxfZm4oeCsxLCB5LCBsZXZlbCwgcGF0aGFibGVfZm4sIGxvY2FsX21hcCwgcGFzc2FibGUsIGJsb2NrZWQpXHJcbiAgICBmbG9vZF9maWxsX2ZuKHgtMSwgeSwgbGV2ZWwsIHBhdGhhYmxlX2ZuLCBsb2NhbF9tYXAsIHBhc3NhYmxlLCBibG9ja2VkKVxyXG4gICAgZmxvb2RfZmlsbF9mbih4LCB5KzEsIGxldmVsLCBwYXRoYWJsZV9mbiwgbG9jYWxfbWFwLCBwYXNzYWJsZSwgYmxvY2tlZClcclxuICAgIGZsb29kX2ZpbGxfZm4oeCwgeS0xLCBsZXZlbCwgcGF0aGFibGVfZm4sIGxvY2FsX21hcCwgcGFzc2FibGUsIGJsb2NrZWQpXHJcbiAgICByZXR1cm5cclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBJUGF0aGFibGVGdW5jdGlvbiB7XHJcbiAgICAodGVycmFpbl9hdDogQnJldy5HcmlkVGhpbmdzLlRlcnJhaW4pIDogYm9vbGVhblxyXG59XHJcblxyXG5leHBvcnQgbGV0IFBhdGhGdW5jdGlvbldhbGthYmxlIDogSVBhdGhhYmxlRnVuY3Rpb25cclxuUGF0aEZ1bmN0aW9uV2Fsa2FibGUgPSBmdW5jdGlvbih0ZXJyYWluX2F0OiBCcmV3LkdyaWRUaGluZ3MuVGVycmFpbik6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuICghKHRlcnJhaW5fYXQuYmxvY2tzX3dhbGtpbmcpKVxyXG59XHJcblxyXG5leHBvcnQgbGV0IFBhdGhGdW5jdGlvbkZseWFibGUgOiBJUGF0aGFibGVGdW5jdGlvblxyXG5QYXRoRnVuY3Rpb25GbHlhYmxlID0gZnVuY3Rpb24odGVycmFpbl9hdDogQnJldy5HcmlkVGhpbmdzLlRlcnJhaW4pOiBib29sZWFuIHtcclxuICAgIHJldHVybiAoISh0ZXJyYWluX2F0LmJsb2Nrc19mbHlpbmcpKVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gc2V0dXBEaWprc3RyYU1hcChsZXZlbDogQnJldy5MZXZlbCwgc3RhcnRfeHk6IEJyZXcuQ29vcmRpbmF0ZSwgcGF0aGFibGVfZm46IElQYXRoYWJsZUZ1bmN0aW9uKSA6IElEaWprc3RyYU1hcCB7XHJcbiAgICBsZXQgZGpNYXAgOiBJRGlqa3N0cmFNYXAgPSB7fVxyXG4gICAgbGV0IGJsb2NrZWQgOiBJU3RvcmFnZU1hcCA9IHt9XHJcbiAgICBsZXQgcGFzc2FibGUgOiBJU3RvcmFnZU1hcCA9IHt9XHJcblxyXG4gICAgLy8gc2V0IGFsbCBwYXNzYWJsZSB0aWxlcyB0byBNQVgtSU5UXHJcbiAgICBmbG9vZF9maWxsX2ZuKHN0YXJ0X3h5LngsIHN0YXJ0X3h5LnksIGxldmVsLCBwYXRoYWJsZV9mbiwgZGpNYXAsIHBhc3NhYmxlLCBibG9ja2VkKVxyXG5cclxuICAgIC8vIHNldCB0YXJnZXQvZ29hbCB0byAwXHJcbiAgICAvLyBkak1hcFtCcmV3LlV0aWxzLnhfYW5kX3lUb0tleShzdGFydF94eS54LCBzdGFydF94eS55KV0gPSAwXHJcblxyXG4gICAgcmV0dXJuIGRqTWFwXHJcbn1cclxuXHJcblxyXG5mdW5jdGlvbiBnZXRBZGphY2VudEtleXMoYXRfa2V5OiBudW1iZXIpIDogbnVtYmVyW10ge1xyXG4gICAgcmV0dXJuIFthdF9rZXkgLSAxLCBhdF9rZXkgKyAxLCBhdF9rZXkgLSBNQVhfR1JJRF9TSVpFLCBhdF9rZXkgKyBNQVhfR1JJRF9TSVpFXVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gc29sdmVEaWprc3RyYU1hcChkak1hcDogSURpamtzdHJhTWFwKSA6IG51bWJlciB7XHJcbiAgICBsZXQgYWRqYWNlbnRfbWFwIDogeyBba2V5OiBudW1iZXJdIDogbnVtYmVyW10gfSA9IHt9XHJcbiAgICBsZXQgYWRqYWNlbnRfa2V5cyA6IG51bWJlcltdXHJcbiAgICAvLyBsZXQgbWFkZUNoYW5nZXMgPSB0cnVlXHJcbiAgICBsZXQgY291bnRfcGFzc2VzID0gMFxyXG5cclxuICAgIGxldCBsb3dlc3RfbmVpZ2hib3JfdmFsIDogbnVtYmVyXHJcbiAgICBsZXQgbWFwX3ZhbHVlIDogbnVtYmVyXHJcbiAgICBsZXQgbmVpZ2hib3JfdmFsIDogbnVtYmVyXHJcbiAgICBsZXQgbmVpZ2hib3JfdmFsdWVzIDogbnVtYmVyW11cclxuICAgIC8vIGxldCBrZXk6IHN0cmluZ1xyXG4gICAgLy8gbGV0IGkgOiBudW1iZXJcclxuXHJcbiAgICBsZXQgY3VycmVudF9xdWV1ZSA6IG51bWJlcltdID0gW11cclxuICAgIGxldCBuZXh0X3F1ZXVlIDogbnVtYmVyW10gPSBbXVxyXG5cclxuICAgIGZvciAobGV0IGtrZXkgaW4gZGpNYXApIHtcclxuICAgICAgICBjdXJyZW50X3F1ZXVlLnB1c2goTnVtYmVyKGtrZXkpKVxyXG4gICAgfVxyXG5cclxuICAgIHdoaWxlIChjdXJyZW50X3F1ZXVlLmxlbmd0aCkge1xyXG4gICAgICAgIGNvdW50X3Bhc3NlcyArPSAxXHJcblxyXG4gICAgICAgIGN1cnJlbnRfcXVldWUuZm9yRWFjaCgobnVtX2tleTogbnVtYmVyLCBpbmRleDogbnVtYmVyLCBhcnJheSkgPT4ge1xyXG5cclxuICAgICAgICAgICAgbWFwX3ZhbHVlID0gZGpNYXBbbnVtX2tleV1cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIGZpbmQgYWRqYWNlbnQgbmVpZ2hib3IgdGlsZXNcclxuICAgICAgICAgICAgaWYgKG51bV9rZXkgaW4gYWRqYWNlbnRfbWFwKSB7XHJcbiAgICAgICAgICAgICAgICBhZGphY2VudF9rZXlzID0gYWRqYWNlbnRfbWFwW251bV9rZXldXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyBpZiB3ZSBoYXZlbid0IGFscmVhZHkgbG9va2VkIHRoZW0gdXAsIHRoZW4gY2FsY3VsYXRlIHRoZW0gXHJcbiAgICAgICAgICAgICAgICBhZGphY2VudF9rZXlzID0gZ2V0QWRqYWNlbnRLZXlzKG51bV9rZXkpLmZpbHRlcigobXlfa2V5OiBudW1iZXIsIGluZGV4OiBudW1iZXIsIGFycmF5KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChteV9rZXkgaW4gZGpNYXApXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAvLyAuLiBhbmQgc3RvcmUgdGhlbSBmb3IgbGF0ZXJcclxuICAgICAgICAgICAgICAgIGFkamFjZW50X21hcFtudW1fa2V5XSA9IGFkamFjZW50X2tleXNcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gZ28gdGhyb3VnaCBlYWNoIG5laWdoYm9ycyBhbmQgZmluZCB0aGUgbG93ZXN0IHZhbHVlXHJcbiAgICAgICAgICAgIGxvd2VzdF9uZWlnaGJvcl92YWwgID0gTUFYX0lOVC8vIDEvMFxyXG5cclxuICAgICAgICAgICAgYWRqYWNlbnRfa2V5cy5mb3JFYWNoKChuZWlnaGJvcl9rZXk6IG51bWJlciwgaW5kZXg6IG51bWJlciwgYXJyYXkpID0+IHtcclxuICAgICAgICAgICAgICAgIG5laWdoYm9yX3ZhbCA9IGRqTWFwW25laWdoYm9yX2tleV1cclxuICAgICAgICAgICAgICAgIGlmIChuZWlnaGJvcl92YWwgPCBsb3dlc3RfbmVpZ2hib3JfdmFsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbG93ZXN0X25laWdoYm9yX3ZhbCA9IG5laWdoYm9yX3ZhbFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG5cclxuICAgICAgICAgICAgaWYgKChtYXBfdmFsdWUgLSBsb3dlc3RfbmVpZ2hib3JfdmFsKSA+PSAyKSB7XHJcbiAgICAgICAgICAgICAgICBkak1hcFtudW1fa2V5XSA9IGxvd2VzdF9uZWlnaGJvcl92YWwgKyAxXHJcblxyXG4gICAgICAgICAgICAgICAgbmV4dF9xdWV1ZSA9IG5leHRfcXVldWUuY29uY2F0KGFkamFjZW50X2tleXMpXHJcbiAgICAgICAgICAgICAgICAvLyBuZXh0X3F1ZXVlLnB1c2gobnVtX2tleSlcclxuXHJcbiAgICAgICAgICAgIH0gXHJcblxyXG4gICAgICAgIH0pXHJcbiAgICBcclxuICAgIGN1cnJlbnRfcXVldWUgPSBuZXh0X3F1ZXVlLmNvbmNhdChbXSlcclxuICAgIG5leHRfcXVldWUgPSBbXVxyXG59XHJcblxyXG4gICAgcmV0dXJuIGNvdW50X3Bhc3Nlc1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIElNYXhNaW4ge1xyXG4gICAgbWF4OiBudW1iZXIsXHJcbiAgICBtaW46IG51bWJlclxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0TWF4QW5kTWluRGlqa3N0cmFNYXBWYWx1ZXMoZGptYXAgOiBJRGlqa3N0cmFNYXApIDogSU1heE1pbiB7XHJcbiAgICBsZXQgbWF4X3ZhbHVlID0gLSgxLzApXHJcbiAgICBsZXQgbWluX3ZhbHVlID0gMS8wXHJcblxyXG4gICAgZm9yIChsZXQga2V5IGluIGRqbWFwKSB7XHJcbiAgICAgICAgLy8gaWYgKGRqbWFwLmhhc093blByb3BlcnR5KGtleSkpIHtcclxuICAgICAgICAgICAgbGV0IG1hcF92YWx1ZSA9IGRqbWFwW2tleV1cclxuICAgICAgICAgICAgaWYgKG1hcF92YWx1ZSAhPSBNQVhfSU5UKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobWFwX3ZhbHVlIDwgbWluX3ZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbWluX3ZhbHVlID0gbWFwX3ZhbHVlXHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKG1hcF92YWx1ZSA+IG1heF92YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIG1heF92YWx1ZSA9IG1hcF92YWx1ZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgLy8gfVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgbWF4OiBtYXhfdmFsdWUsXHJcbiAgICAgICAgbWluOiBtaW5fdmFsdWVcclxuICAgIH1cclxufVxyXG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/brew_engine/fastdijkstramap.ts\n");

/***/ }),

/***/ "./src/brew_engine/game_master.ts":
/*!****************************************!*\
  !*** ./src/brew_engine/game_master.ts ***!
  \****************************************/
/*! exports provided: GameMaster */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"GameMaster\", function() { return GameMaster; });\n/* harmony import */ var postal__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! postal */ \"./node_modules/postal/lib/postal.js\");\n/* harmony import */ var postal__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(postal__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var rot_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! rot-js */ \"./node_modules/rot-js/lib/rot.js\");\n/* harmony import */ var rot_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(rot_js__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _brew__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../brew */ \"./src/brew.ts\");\n\r\n\r\n\r\nclass GameMaster {\r\n    constructor(given_seed, div_container, input_fn, event_fn, ai_fn, preplayer_fn, postplayer_fn) {\r\n        this.turn_count = 0;\r\n        this.event_queue = [];\r\n        // private postturn_fn : any\r\n        this.input_handler = _brew__WEBPACK_IMPORTED_MODULE_2__[\"Enums\"].InputHandler.Main;\r\n        this.levels = {};\r\n        // init RNG\r\n        this.initRNG(given_seed);\r\n        // instantiate ROTjs engine\r\n        this.scheduler = new rot_js__WEBPACK_IMPORTED_MODULE_1__[\"Scheduler\"].Speed();\r\n        this.engine = new rot_js__WEBPACK_IMPORTED_MODULE_1__[\"Engine\"](this.scheduler);\r\n        this.block_input = true;\r\n        // initiate internal utility classes\r\n        this.timer_monitor = new _brew__WEBPACK_IMPORTED_MODULE_2__[\"Timers\"].TimerMonitor();\r\n        this.pathmaps = new _brew__WEBPACK_IMPORTED_MODULE_2__[\"Path\"].PathmapCache();\r\n        // display class will handle setting up canvas, etc\r\n        this.display = new _brew__WEBPACK_IMPORTED_MODULE_2__[\"Display\"](this, div_container);\r\n        // setup event/input handlers\r\n        // this.initEventListener(div_container)\r\n        // instantiate postal.js channels\r\n        this.channel_event = postal__WEBPACK_IMPORTED_MODULE_0__[\"channel\"](\"event\");\r\n        this.channel_turn = postal__WEBPACK_IMPORTED_MODULE_0__[\"channel\"](\"turn\");\r\n        this.channel_input = postal__WEBPACK_IMPORTED_MODULE_0__[\"channel\"](\"input\");\r\n        this.channel_display = postal__WEBPACK_IMPORTED_MODULE_0__[\"channel\"](\"display\");\r\n        // outsourced functions\r\n        this.event_fn = event_fn;\r\n        this.input_fn = input_fn;\r\n        this.ai_fn = ai_fn;\r\n        this.preplayer_fn = preplayer_fn;\r\n        this.postplayer_fn = postplayer_fn;\r\n        // this.postturn_fn = postturn_fn\r\n        // start feed listeners\r\n        this.feed_turn_start = this.channel_turn.subscribe(\"turn.start\", (data, envelope) => { this.handleTurnStart(data, envelope); });\r\n        this.feed_turn_end = this.channel_turn.subscribe(\"turn.end\", (data, envelope) => { this.handleTurnEnd(data, envelope); });\r\n        this.feed_event = this.channel_event.subscribe(\"event.start\", (data, envelope) => { this.eventFunctionWrapper(data, envelope); });\r\n        this.feed_event = this.channel_event.subscribe(\"event.end\", (data, envelope) => { this.handleEventEnd(data, envelope); });\r\n        this.feed_input = this.channel_input.subscribe(\"input.*\", (data, envelope) => { this.inputFunctionWrapper(data, envelope); });\r\n        this.feed_display = this.channel_display.subscribe(\"display.*\", (data, envelope) => { this.handleDisplay(data, envelope); });\r\n        // set up first level, start engine, define player, etc\r\n        this.setupGame();\r\n        // if (BREW_FIRST_STARTUP) {\r\n        //     this.startMenu()\r\n        // }\r\n    }\r\n    initRNG(given_seed) {\r\n        if (given_seed) {\r\n            this.start_seed = given_seed;\r\n        }\r\n        else {\r\n            this.start_seed = Math.floor(rot_js__WEBPACK_IMPORTED_MODULE_1__[\"RNG\"].getUniform() * 9999);\r\n        }\r\n        rot_js__WEBPACK_IMPORTED_MODULE_1__[\"RNG\"].setSeed(this.start_seed);\r\n        console.log(\"starting with SEED \", this.start_seed);\r\n    }\r\n    getSeed() { return this.start_seed; }\r\n    setupGame() {\r\n        // init player for the first time and add to the scheduler\r\n        let player = buildPlayer(this);\r\n        this.player = player;\r\n        // architect is like a non-mob environmental manager\r\n        this.architect = _brew__WEBPACK_IMPORTED_MODULE_2__[\"Definitions\"].monsterFactory(this, _brew__WEBPACK_IMPORTED_MODULE_2__[\"Definitions\"].MonsterType.Architect);\r\n        // build first level\r\n        let first_level = _brew__WEBPACK_IMPORTED_MODULE_2__[\"LevelGenerator\"].buildLevel(this, 1, false);\r\n        this.addLevel(first_level);\r\n        this.setupLevel(first_level.id, first_level.simple_start_xy);\r\n        this.engine.start();\r\n    }\r\n    addLevel(new_level) {\r\n        let key = new_level.id;\r\n        this.levels[key] = new_level;\r\n    }\r\n    removeLevel(level_id) {\r\n        delete this.levels[level_id];\r\n    }\r\n    getLevelByID(level_id) {\r\n        return this.levels[level_id];\r\n    }\r\n    hasLevel(level_id) {\r\n        return level_id in this.levels;\r\n    }\r\n    setupLevel(level_id, player_start_xy) {\r\n        let player = this.getPlayer();\r\n        this.engine.lock();\r\n        if (!(this.hasLevel(level_id))) {\r\n            throw new Error(`Level with id ${level_id} does not exist`);\r\n        }\r\n        if (this.current_level) {\r\n            player.memory_archive.saveLevelMemory(this.current_level.id, player.memory);\r\n        }\r\n        let new_level = this.levels[level_id];\r\n        // set this as our current level\r\n        this.current_level = new_level;\r\n        // make sure we add player to the level somewhere \r\n        // todo: better starting coords based on entrance/exit portals\r\n        if (new_level.monsters.hasAt(player_start_xy)) {\r\n            console.error(\"monster already exists at player's starting location\");\r\n        }\r\n        new_level.monsters.setAt(player_start_xy, player);\r\n        // figure out facing direction\r\n        let half_x = _brew__WEBPACK_IMPORTED_MODULE_2__[\"Config\"].map_width_tiles / 2;\r\n        let half_y = _brew__WEBPACK_IMPORTED_MODULE_2__[\"Config\"].map_height_tiles / 2;\r\n        let turret = player.getPowers().getPowerOfType(_brew__WEBPACK_IMPORTED_MODULE_2__[\"Enums\"].BrewPowerType.TurretCannon);\r\n        if ((player_start_xy.x < half_x) && (player_start_xy.y < half_y)) {\r\n            turret.facing_direction = _brew__WEBPACK_IMPORTED_MODULE_2__[\"Directions\"].RIGHT.clone();\r\n        }\r\n        else if ((player_start_xy.x < half_x) && (player_start_xy.y >= half_y)) {\r\n            turret.facing_direction = _brew__WEBPACK_IMPORTED_MODULE_2__[\"Directions\"].UP.clone();\r\n        }\r\n        else if ((player_start_xy.x >= half_x) && (player_start_xy.y < half_y)) {\r\n            turret.facing_direction = _brew__WEBPACK_IMPORTED_MODULE_2__[\"Directions\"].LEFT.clone();\r\n        }\r\n        else {\r\n            turret.facing_direction = _brew__WEBPACK_IMPORTED_MODULE_2__[\"Directions\"].DOWN.clone();\r\n        }\r\n        _brew__WEBPACK_IMPORTED_MODULE_2__[\"Parts\"].updateMonsterParts(this, player);\r\n        _brew__WEBPACK_IMPORTED_MODULE_2__[\"Parts\"].placeMonsterPartsOnGrid(this, player);\r\n        // clear memory and reset if we've been on this level before\r\n        this.player.memory.clearAll();\r\n        if (player.memory_archive.hasLevelMemory(new_level.id)) {\r\n            player.memory = player.memory_archive.getLevelMemory(new_level.id);\r\n        }\r\n        _brew__WEBPACK_IMPORTED_MODULE_2__[\"Intel\"].runBeforePlayerTurn(this, player);\r\n        // redo all Brew.Pathmaps\r\n        this.updateAllPathmaps();\r\n        //this.preplayer_fn(this, this.player)\r\n        //this.display.drawAll()\r\n        // schedule all mobs in the level\r\n        this.scheduler.clear();\r\n        this.addActorToScheduler(this.player);\r\n        for (let m of new_level.monsters.getAllThings()) {\r\n            if (!(m.isSameThing(this.player))) {\r\n                this.addActorToScheduler(m);\r\n                _brew__WEBPACK_IMPORTED_MODULE_2__[\"Parts\"].updateMonsterParts(this, m);\r\n                _brew__WEBPACK_IMPORTED_MODULE_2__[\"Parts\"].placeMonsterPartsOnGrid(this, m);\r\n            }\r\n        }\r\n        this.addActorToScheduler(this.getArchitect());\r\n        // this.addActorToScheduler(Definitions.monsterFactory(this, Brew.Definitions.MonsterType.Architect))\r\n        this.displayAll();\r\n        this.display.drawHeader();\r\n        this.engine.unlock();\r\n    }\r\n    updateAllPathmaps() {\r\n        let level = this.getCurrentLevel();\r\n        let to_path_walk = _brew__WEBPACK_IMPORTED_MODULE_2__[\"Path\"].createGenericMapToPlayer(this, level, _brew__WEBPACK_IMPORTED_MODULE_2__[\"Enums\"].LevelNavigationType.Walk, true);\r\n        this.pathmaps.updateCache(_brew__WEBPACK_IMPORTED_MODULE_2__[\"Enums\"].PathmapCacheType.ToPlayer_Walk, to_path_walk);\r\n        this.pathmaps.updateCache(_brew__WEBPACK_IMPORTED_MODULE_2__[\"Enums\"].PathmapCacheType.FromPlayer_Walk, _brew__WEBPACK_IMPORTED_MODULE_2__[\"Path\"].createMapFromPlayer(this, level, to_path_walk, true));\r\n        // update flight maps if we need to\r\n        // let has_flyers : boolean = level.monsters.getAllThings().some((mob: Brew.GridThings.Monster) => {\r\n        //     return mob.hasFlag(Brew.Enums.Flag.Flying)\r\n        // })\r\n        // changing this to always true in case targeters need to use it to shoot over chasms\r\n        let needs_flying_map = true;\r\n        if (needs_flying_map) {\r\n            let to_path_fly = _brew__WEBPACK_IMPORTED_MODULE_2__[\"Path\"].createGenericMapToPlayer(this, level, _brew__WEBPACK_IMPORTED_MODULE_2__[\"Enums\"].LevelNavigationType.Fly, true);\r\n            this.pathmaps.updateCache(_brew__WEBPACK_IMPORTED_MODULE_2__[\"Enums\"].PathmapCacheType.ToPlayer_Fly, to_path_fly);\r\n            this.pathmaps.updateCache(_brew__WEBPACK_IMPORTED_MODULE_2__[\"Enums\"].PathmapCacheType.FromPlayer_Fly, _brew__WEBPACK_IMPORTED_MODULE_2__[\"Path\"].createMapFromPlayer(this, level, to_path_fly, true));\r\n        }\r\n    }\r\n    addActorToScheduler(mob) {\r\n        this.scheduler.add(mob, true);\r\n    }\r\n    removeActorFromScheduler(mob) {\r\n        this.scheduler.remove(mob);\r\n    }\r\n    inputFunctionWrapper(data, envelope) {\r\n        if (this.block_input == true) {\r\n            // console.warn(\"input blocked\")\r\n            ;\r\n        }\r\n        else {\r\n            this.input_fn(this, data, envelope);\r\n        }\r\n    }\r\n    eventFunctionWrapper(data, envelope) {\r\n        if (data.eventType != _brew__WEBPACK_IMPORTED_MODULE_2__[\"Enums\"].BrewEventType.Error) {\r\n            this.block_input = true;\r\n        }\r\n        this.event_fn(this, data, envelope);\r\n    }\r\n    handleDisplay(data, envelope) {\r\n        if (!(data)) {\r\n            // console.warn(\"passed null display data\", data)\r\n            return;\r\n        }\r\n        if (envelope.topic == \"display.all\") {\r\n            this.display.drawAll(data);\r\n        }\r\n        else if (envelope.topic == \"display.at\") {\r\n            this.display.drawAt(data);\r\n        }\r\n        else if (envelope.topic == \"display.list\") {\r\n            for (let i = 0; i < data.length; i++) {\r\n                this.display.drawAt(data[i]);\r\n            }\r\n        }\r\n        else {\r\n            console.error(\"invalid display data\", data);\r\n        }\r\n    }\r\n    handleEventEnd(data, envelope) {\r\n        this.lastEventIncludeErrors = data; // keep track of last events including errors \r\n        if (data.eventType != _brew__WEBPACK_IMPORTED_MODULE_2__[\"Enums\"].BrewEventType.Error) {\r\n            this.lastEvent = data; // keep track of the last non-error event\r\n        }\r\n        if (this.event_queue.length > 0) {\r\n            let nextEvent = this.event_queue.pop();\r\n            // propogate EndsTurn if this event is supposed to end the turn\r\n            if (data.endsTurn == true) {\r\n                // swap/propogate true endsTurn\r\n                data.endsTurn = false;\r\n                nextEvent.endsTurn = true;\r\n            }\r\n            this.channel_event.publish(\"event.start\", nextEvent);\r\n        }\r\n        else {\r\n            if (data.endsTurn) {\r\n                // console.log(\"event end: turn end\")\r\n                this.channel_turn.publish(\"turn.end\", { actor: data.actor });\r\n            }\r\n            else {\r\n                // if it doesn't end turn, allow the player to put in input again\r\n                if (data.actor.isType(_brew__WEBPACK_IMPORTED_MODULE_2__[\"Definitions\"].MonsterType.Hero)) {\r\n                    // console.log(\"input blocking OFF\")\r\n                    this.block_input = false;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    initEventListener(div_container) {\r\n        // add event listeners to page/canvas\r\n        div_container.ownerDocument.addEventListener(\"keydown\", (e) => {\r\n            if (_brew__WEBPACK_IMPORTED_MODULE_2__[\"KeyMap\"].MovementKeys.concat(_brew__WEBPACK_IMPORTED_MODULE_2__[\"KeyMap\"].Action).indexOf(e.keyCode) > -1) {\r\n                e.preventDefault();\r\n            }\r\n            this.channel_input.publish(\"input.keyboard\", {\r\n                source: _brew__WEBPACK_IMPORTED_MODULE_2__[\"Enums\"].BrewInputSource.Keyboard,\r\n                code: e.keyCode,\r\n                jsevent: e\r\n            });\r\n        });\r\n        div_container.addEventListener(\"mousedown\", (e) => {\r\n            this.channel_input.publish(\"input.mouse\", {\r\n                source: _brew__WEBPACK_IMPORTED_MODULE_2__[\"Enums\"].BrewInputSource.Mouse,\r\n                button: e.button,\r\n                jsevent: e\r\n            });\r\n        });\r\n        div_container.addEventListener(\"mousemove\", (e) => {\r\n            this.channel_input.publish(\"input.mouse\", {\r\n                source: _brew__WEBPACK_IMPORTED_MODULE_2__[\"Enums\"].BrewInputSource.Mouse,\r\n                button: e.button,\r\n                jsevent: e\r\n            });\r\n        });\r\n    }\r\n    getPlayer() {\r\n        return this.player;\r\n    }\r\n    getArchitect() {\r\n        return this.architect;\r\n    }\r\n    getCurrentLevel() {\r\n        return this.current_level;\r\n    }\r\n    setPlayer(new_player) {\r\n        this.player = new_player;\r\n    }\r\n    setCurrentLevel(new_level) {\r\n        this.current_level = new_level;\r\n    }\r\n    // postal feed handlers\r\n    handleTurnEnd(data, envelope) {\r\n        let mob = data.actor;\r\n        // console.log(`END TURN: ${mob.name}`)\r\n        // this.postturn_fn(this, mob)\r\n        if (mob.isType(_brew__WEBPACK_IMPORTED_MODULE_2__[\"Definitions\"].MonsterType.Hero)) {\r\n            // console.log(\"input blocking OFF\")\r\n            this.postplayer_fn(this, mob);\r\n        }\r\n        this.engine.unlock();\r\n    }\r\n    handleTurnStart(data, envelope) {\r\n        let mob = data.actor;\r\n        // console.log(`START TURN: ${mob.name}`)\r\n        this.current_turn_actor = mob;\r\n        this.engine.lock();\r\n        this.checkTimersForActor(mob);\r\n        // Movement.checkForAmbientEffects(this, mob)\r\n        if (mob.isType(_brew__WEBPACK_IMPORTED_MODULE_2__[\"Definitions\"].MonsterType.Hero)) {\r\n            // console.log(\"input blocking OFF\")\r\n            this.preplayer_fn(this, mob);\r\n            this.block_input = false;\r\n        }\r\n        else {\r\n            let ai_event;\r\n            ai_event = this.ai_fn(this, mob);\r\n            this.channel_event.publish(\"event.start\", ai_event);\r\n        }\r\n    }\r\n    //endEvent(data: Brew.Enums.IBrewEvent, nextEventData? : Brew.Enums.IBrewEvent) {\r\n    endEvent(data) {\r\n        this.channel_event.publish(\"event.end\", data);\r\n        //twp: need to handle inserted events first\r\n        // if (nextEventData) {\r\n        //     this.channel_event.publish(\"event.start\", nextEventData)\r\n        // }\r\n    }\r\n    insertEvent_Next(inserted_event) {\r\n        // inserts event after the next upcoming event (2nd from the end)\r\n        this.event_queue.splice(-2, 0, inserted_event);\r\n        return true;\r\n    }\r\n    insertEvent(inserted_event) {\r\n        // insert into a waiting queue to trigger before we go back to the pipeline\r\n        this.event_queue.unshift(inserted_event);\r\n        return true;\r\n    }\r\n    clearEventQueue() {\r\n        this.event_queue = [];\r\n    }\r\n    getLastEvent(includeErrors = false) {\r\n        if (includeErrors) {\r\n            return this.lastEventIncludeErrors;\r\n        }\r\n        else {\r\n            return this.lastEvent;\r\n        }\r\n    }\r\n    copyEventDataFromLastEvent(modified_event) {\r\n        let lastEvent = this.getLastEvent();\r\n        let ignoreList = [\"actor\", \"playerInitiated\", \"endsTurn\", \"eventType\"];\r\n        for (let key in lastEvent) {\r\n            if (lastEvent.hasOwnProperty(key)) {\r\n                if (ignoreList.indexOf(key) == -1) {\r\n                    var element = lastEvent[key];\r\n                    modified_event[key] = element;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    // display shortcuts\r\n    displayAt(xy) {\r\n        if (!(xy)) {\r\n            console.warn(\"passed in null xy coords to displayAt\", xy);\r\n        }\r\n        this.channel_display.publish(\"display.at\", xy);\r\n    }\r\n    displayAll(display_options = {}) {\r\n        this.channel_display.publish(\"display.all\", display_options);\r\n    }\r\n    displayList(xy_list) {\r\n        this.channel_display.publish(\"display.list\", xy_list);\r\n    }\r\n    // turn Brew.Timers\r\n    checkTimersForActor(actor) {\r\n        let timer_list = this.timer_monitor.getAllTimersTriggeredFor(actor, this.turn_count);\r\n        if (timer_list.length > 0) {\r\n            for (let timer of timer_list) {\r\n                actor.removeFlag(timer.flag);\r\n                this.displayAt(actor.location);\r\n                this.timer_monitor.removeTimer(timer.actor, timer.flag); //todo: need centralized way of doing Brew.Timers\r\n            }\r\n        }\r\n    }\r\n}\r\nfunction buildPlayer(gm, player_name = \"Hero\") {\r\n    let player = _brew__WEBPACK_IMPORTED_MODULE_2__[\"Definitions\"].monsterFactory(gm, _brew__WEBPACK_IMPORTED_MODULE_2__[\"Definitions\"].MonsterType.Hero);\r\n    player.name = player_name;\r\n    // player.code = Symbols.smiley_face\r\n    player.inventory = new _brew__WEBPACK_IMPORTED_MODULE_2__[\"Inventory\"](_brew__WEBPACK_IMPORTED_MODULE_2__[\"Config\"].max_items);\r\n    player.power_suite = new _brew__WEBPACK_IMPORTED_MODULE_2__[\"Powers\"].PowerSuite(_brew__WEBPACK_IMPORTED_MODULE_2__[\"Config\"].max_powers);\r\n    player.team = _brew__WEBPACK_IMPORTED_MODULE_2__[\"Enums\"].Team.Player;\r\n    player.setFacing(_brew__WEBPACK_IMPORTED_MODULE_2__[\"Directions\"].DOWN.clone());\r\n    player.building_type = _brew__WEBPACK_IMPORTED_MODULE_2__[\"Enums\"].ComponentPartsBuildingType.Tank;\r\n    let turretPower = _brew__WEBPACK_IMPORTED_MODULE_2__[\"Powers\"].createBasicPowerOfType(_brew__WEBPACK_IMPORTED_MODULE_2__[\"Enums\"].BrewPowerType.TurretCannon);\r\n    turretPower.facing_direction = _brew__WEBPACK_IMPORTED_MODULE_2__[\"Directions\"].DOWN.clone();\r\n    turretPower.firing_arc = _brew__WEBPACK_IMPORTED_MODULE_2__[\"Enums\"].FiringArc.QuarterArc;\r\n    turretPower.charge_stat.setTo(8);\r\n    let machineGun = _brew__WEBPACK_IMPORTED_MODULE_2__[\"Powers\"].createBasicPowerOfType(_brew__WEBPACK_IMPORTED_MODULE_2__[\"Enums\"].BrewPowerType.MachineGun);\r\n    machineGun.charge_stat.setTo(16);\r\n    player.power_suite.addPower(turretPower);\r\n    player.power_suite.addPower(machineGun);\r\n    // for (let i = 0; i < 8; i++) {\r\n    //     player.inventory.addItem(Brew.Definitions.itemFactory(Brew.Definitions.ItemType.Supplies))\r\n    // }\r\n    return player;\r\n}\r\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvYnJld19lbmdpbmUvZ2FtZV9tYXN0ZXIudHM/ZjVkOCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQWdDO0FBQ0g7QUFDRTtBQUV6QjtJQXdERixZQUFZLFVBQWtCLEVBQUUsYUFBNkIsRUFBRSxRQUFhLEVBQUUsUUFBYSxFQUFFLEtBQVUsRUFBRSxZQUFpQixFQUFFLGFBQWtCO1FBbkQ5SSxlQUFVLEdBQVksQ0FBQztRQW1CZixnQkFBVyxHQUFrQyxFQUFFO1FBdUJ2RCw0QkFBNEI7UUFFckIsa0JBQWEsR0FBNkIsMkNBQVUsQ0FBQyxZQUFZLENBQUMsSUFBSTtRQUtyRSxXQUFNLEdBQWlDLEVBQUU7UUFJN0MsV0FBVztRQUNYLElBQUksQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFDO1FBRXhCLDJCQUEyQjtRQUMzQixJQUFJLENBQUMsU0FBUyxHQUFHLElBQUksZ0RBQWEsQ0FBQyxLQUFLLEVBQUU7UUFDMUMsSUFBSSxDQUFDLE1BQU0sR0FBRyxJQUFJLDZDQUFVLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQztRQUM1QyxJQUFJLENBQUMsV0FBVyxHQUFHLElBQUk7UUFFdkIsb0NBQW9DO1FBQ3BDLElBQUksQ0FBQyxhQUFhLEdBQUcsSUFBSSw0Q0FBVyxDQUFDLFlBQVksRUFBRTtRQUNuRCxJQUFJLENBQUMsUUFBUSxHQUFHLElBQUksMENBQVMsQ0FBQyxZQUFZLEVBQUU7UUFFNUMsbURBQW1EO1FBQ25ELElBQUksQ0FBQyxPQUFPLEdBQUcsSUFBSSw2Q0FBWSxDQUFDLElBQUksRUFBRSxhQUFhLENBQUM7UUFFcEQsNkJBQTZCO1FBQzdCLHdDQUF3QztRQUV4QyxpQ0FBaUM7UUFDakMsSUFBSSxDQUFDLGFBQWEsR0FBRyw4Q0FBYyxDQUFDLE9BQU8sQ0FBQztRQUM1QyxJQUFJLENBQUMsWUFBWSxHQUFHLDhDQUFjLENBQUMsTUFBTSxDQUFDO1FBQzFDLElBQUksQ0FBQyxhQUFhLEdBQUcsOENBQWMsQ0FBQyxP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QUFJO0lBQ2pFLElBQUksV0FBVyxHQUFHLDRDQUFXLENBQUMsc0JBQXNCLENBQUMsMkNBQVUsQ0FBQyxhQUFhLENBQUMsWUFBWSxDQUFDO0lBQzNGLFdBQVcsQ0FBQyxnQkFBZ0IsR0FBRyxnREFBZSxDQUFDLElBQUksQ0FBQyxLQUFLLEVBQUU7SUFDM0QsV0FBVyxDQUFDLFVBQVUsR0FBRywyQ0FBVSxDQUFDLFNBQVMsQ0FBQyxVQUFVO0lBQ3hELFdBQVcsQ0FBQyxXQUFXLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztJQUVoQyxJQUFJLFVBQVUsR0FBRyw0Q0FBVyxDQUFDLHNCQUFzQixDQUFDLDJDQUFVLENBQUMsYUFBYSxDQUFDLFVBQVUsQ0FBQztJQUN4RixVQUFVLENBQUMsV0FBVyxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUM7SUFFaEMsTUFBTSxDQUFDLFdBQVcsQ0FBQyxRQUFRLENBQUMsV0FBVyxDQUFDO0lBQ3hDLE1BQU0sQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLFVBQVUsQ0FBQztJQUV2QyxnQ0FBZ0M7SUFDaEMsaUdBQWlHO0lBQ2pHLElBQUk7SUFDSixNQUFNLENBQUMsTUFBTTtBQUNqQixDQUFDIiwiZmlsZSI6Ii4vc3JjL2JyZXdfZW5naW5lL2dhbWVfbWFzdGVyLnRzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgcG9zdGFsIGZyb20gJ3Bvc3RhbCdcclxuaW1wb3J0ICogYXMgUk9UIGZyb20gJ3JvdC1qcydcclxuaW1wb3J0ICogYXMgQnJldyBmcm9tICcuLi9icmV3J1xyXG5cclxuZXhwb3J0IGNsYXNzIEdhbWVNYXN0ZXIge1xyXG4gICAgXHJcbiAgICAvLyBtYWluIFJPVCBlbmdpbmVcclxuICAgIHNjaGVkdWxlciA6IFJPVC5TY2hlZHVsZXIuU3BlZWRcclxuICAgIGVuZ2luZSA6IFJPVC5FbmdpbmVcclxuICAgIHR1cm5fY291bnQgOiBudW1iZXIgPSAwXHJcbiAgICBmaXJzdF9zdGFydHVwIDogYm9vbGVhblxyXG5cclxuICAgIC8vIFJPVGpzIGRpc3BsYXlzXHJcbiAgICBwdWJsaWMgZGlzcGxheSA6IEJyZXcuRGlzcGxheVxyXG4gICAgXHJcbiAgICAvLyBwb3N0YWwuanMgY2hhbm5lbHNcclxuICAgIHB1YmxpYyBjaGFubmVsX2V2ZW50IDogSUNoYW5uZWxEZWZpbml0aW9uPEJyZXcuRW51bXMuSUJyZXdFdmVudD4gLy8gbWFpbiBjaGFubmVsIGZvciBhbGwgZ2FtZSBldmVudHNcclxuICAgIHB1YmxpYyBjaGFubmVsX3R1cm4gOiBJQ2hhbm5lbERlZmluaXRpb248QnJldy5FbnVtcy5JQnJld1R1cm5EYXRhPiAvLyBoYW5kbGUgdHVybiBzdGFydC9lbmRcclxuICAgIHB1YmxpYyBjaGFubmVsX2lucHV0IDogSUNoYW5uZWxEZWZpbml0aW9uPEJyZXcuRW51bXMuSUJyZXdJbnB1dERhdGE+IC8vIGNoYW5uZWwgZm9yIGV4dGVybmFsIHVzZXIgaW5wdXQgIFxyXG4gICAgcHVibGljIGNoYW5uZWxfZGlzcGxheSA6IElDaGFubmVsRGVmaW5pdGlvbjxhbnk+IC8vIGNoYW5uZWwgZm9yIGV4dGVybmFsIHVzZXIgaW5wdXQgIFxyXG5cclxuICAgIC8vIGNoYW5uZWwgbGlzdGVuZXJzXHJcbiAgICBwcml2YXRlIGZlZWRfZXZlbnQgOiBJU3Vic2NyaXB0aW9uRGVmaW5pdGlvbjxhbnk+XHJcbiAgICBwcml2YXRlIGZlZWRfdHVybl9zdGFydCA6IElTdWJzY3JpcHRpb25EZWZpbml0aW9uPGFueT5cclxuICAgIHByaXZhdGUgZmVlZF90dXJuX2VuZCA6IElTdWJzY3JpcHRpb25EZWZpbml0aW9uPGFueT5cclxuICAgIHByaXZhdGUgZmVlZF9pbnB1dCA6IElTdWJzY3JpcHRpb25EZWZpbml0aW9uPGFueT5cclxuICAgIHByaXZhdGUgZmVlZF9kaXNwbGF5IDogSVN1YnNjcmlwdGlvbkRlZmluaXRpb248YW55PlxyXG4gICAgXHJcbiAgICBwcml2YXRlIGV2ZW50X3F1ZXVlIDogQXJyYXk8QnJldy5FbnVtcy5JQnJld0V2ZW50PiA9IFtdXHJcblxyXG4gICAgLy8gcHJpdmF0ZSB2YXJpYWJsZXNcclxuICAgIHByaXZhdGUgc3RhcnRfc2VlZCA6IG51bWJlclxyXG4gICAgcHJpdmF0ZSBwbGF5ZXIgOiBCcmV3LkdyaWRUaGluZ3MuTW9uc3RlclxyXG4gICAgcHJpdmF0ZSBhcmNoaXRlY3QgOiBCcmV3LkdyaWRUaGluZ3MuTW9uc3RlclxyXG5cclxuICAgIHByaXZhdGUgY3VycmVudF9sZXZlbCA6IGFueSBcclxuICAgIHByaXZhdGUgYmxvY2tfaW5wdXQgOiBib29sZWFuXHJcbiAgICBwcml2YXRlIGN1cnJlbnRfdHVybl9hY3RvciA6IGFueVxyXG4gICAgLy8gcHVibGljIEJyZXcuUGF0aG1hcF90b19wbGF5ZXIgOiBCcmV3LlBhdGguUGF0aG1hcFxyXG4gICAgLy8gcHVibGljIEJyZXcuUGF0aG1hcF90b19wbGF5ZXJhbGx5IDogQnJldy5QYXRoLlBhdGhtYXBcclxuICAgIC8vIHB1YmxpYyBCcmV3LlBhdGhtYXBfZnJvbV9wbGF5ZXIgOiBCcmV3LlBhdGguUGF0aG1hcFxyXG4gICAgLy8gcHVibGljIEJyZXcuUGF0aG1hcF9mcm9tX3BsYXllcmFsbHkgOiBCcmV3LlBhdGguUGF0aG1hcCAvLyB0b2RvOiBkaWN0aW9uYXJ5IG9mIEJyZXcuUGF0aG1hcHMgaW5zdGVhZCBvZiB0aGlzXHJcbiAgICBwdWJsaWMgcGF0aG1hcHMgOiBCcmV3LlBhdGguUGF0aG1hcENhY2hlXHJcbiAgICBwdWJsaWMgdGltZXJfbW9uaXRvciA6IEJyZXcuVGltZXJzLlRpbWVyTW9uaXRvclxyXG5cclxuICAgIC8vIG91dHNvdXJjZWQgZnVuY3Rpb25zXHJcbiAgICBwcml2YXRlIGV2ZW50X2ZuOiBhbnlcclxuICAgIHByaXZhdGUgaW5wdXRfZm46IGFueVxyXG4gICAgcHJpdmF0ZSBhaV9mbjogYW55XHJcbiAgICBwcml2YXRlIHByZXBsYXllcl9mbjogYW55XHJcbiAgICBwcml2YXRlIHBvc3RwbGF5ZXJfZm46IGFueVxyXG4gICAgLy8gcHJpdmF0ZSBwb3N0dHVybl9mbiA6IGFueVxyXG5cclxuICAgIHB1YmxpYyBpbnB1dF9oYW5kbGVyIDogQnJldy5FbnVtcy5JbnB1dEhhbmRsZXIgPSBCcmV3LkVudW1zLklucHV0SGFuZGxlci5NYWluXHJcblxyXG4gICAgcHJpdmF0ZSBsYXN0RXZlbnQgOiBCcmV3LkVudW1zLklCcmV3RXZlbnRcclxuICAgIHByaXZhdGUgbGFzdEV2ZW50SW5jbHVkZUVycm9ycyA6IEJyZXcuRW51bXMuSUJyZXdFdmVudFxyXG4gICAgXHJcbiAgICBwcml2YXRlIGxldmVscyA6IEJyZXcuVXRpbHMuRGljdDxCcmV3LkxldmVsPiA9IHt9XHJcblxyXG4gICAgY29uc3RydWN0b3IoZ2l2ZW5fc2VlZCA6bnVtYmVyLCBkaXZfY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCwgaW5wdXRfZm46IGFueSwgZXZlbnRfZm46IGFueSwgYWlfZm46IGFueSwgcHJlcGxheWVyX2ZuOiBhbnksIHBvc3RwbGF5ZXJfZm46IGFueSkge1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIGluaXQgUk5HXHJcbiAgICAgICAgdGhpcy5pbml0Uk5HKGdpdmVuX3NlZWQpXHJcblxyXG4gICAgICAgIC8vIGluc3RhbnRpYXRlIFJPVGpzIGVuZ2luZVxyXG4gICAgICAgIHRoaXMuc2NoZWR1bGVyID0gbmV3IFJPVC5TY2hlZHVsZXIuU3BlZWQoKVxyXG4gICAgICAgIHRoaXMuZW5naW5lID0gbmV3IFJPVC5FbmdpbmUodGhpcy5zY2hlZHVsZXIpXHJcbiAgICAgICAgdGhpcy5ibG9ja19pbnB1dCA9IHRydWVcclxuXHJcbiAgICAgICAgLy8gaW5pdGlhdGUgaW50ZXJuYWwgdXRpbGl0eSBjbGFzc2VzXHJcbiAgICAgICAgdGhpcy50aW1lcl9tb25pdG9yID0gbmV3IEJyZXcuVGltZXJzLlRpbWVyTW9uaXRvcigpXHJcbiAgICAgICAgdGhpcy5wYXRobWFwcyA9IG5ldyBCcmV3LlBhdGguUGF0aG1hcENhY2hlKClcclxuXHJcbiAgICAgICAgLy8gZGlzcGxheSBjbGFzcyB3aWxsIGhhbmRsZSBzZXR0aW5nIHVwIGNhbnZhcywgZXRjXHJcbiAgICAgICAgdGhpcy5kaXNwbGF5ID0gbmV3IEJyZXcuRGlzcGxheSh0aGlzLCBkaXZfY29udGFpbmVyKVxyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIHNldHVwIGV2ZW50L2lucHV0IGhhbmRsZXJzXHJcbiAgICAgICAgLy8gdGhpcy5pbml0RXZlbnRMaXN0ZW5lcihkaXZfY29udGFpbmVyKVxyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIGluc3RhbnRpYXRlIHBvc3RhbC5qcyBjaGFubmVsc1xyXG4gICAgICAgIHRoaXMuY2hhbm5lbF9ldmVudCA9IHBvc3RhbC5jaGFubmVsKFwiZXZlbnRcIilcclxuICAgICAgICB0aGlzLmNoYW5uZWxfdHVybiA9IHBvc3RhbC5jaGFubmVsKFwidHVyblwiKVxyXG4gICAgICAgIHRoaXMuY2hhbm5lbF9pbnB1dCA9IHBvc3RhbC5jaGFubmVsKFwiaW5wdXRcIilcclxuICAgICAgICB0aGlzLmNoYW5uZWxfZGlzcGxheSA9IHBvc3RhbC5jaGFubmVsKFwiZGlzcGxheVwiKVxyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIG91dHNvdXJjZWQgZnVuY3Rpb25zXHJcbiAgICAgICAgdGhpcy5ldmVudF9mbiA9IGV2ZW50X2ZuXHJcbiAgICAgICAgdGhpcy5pbnB1dF9mbiA9IGlucHV0X2ZuXHJcbiAgICAgICAgdGhpcy5haV9mbiA9IGFpX2ZuXHJcbiAgICAgICAgdGhpcy5wcmVwbGF5ZXJfZm4gPSBwcmVwbGF5ZXJfZm5cclxuICAgICAgICB0aGlzLnBvc3RwbGF5ZXJfZm4gPSBwb3N0cGxheWVyX2ZuXHJcbiAgICAgICAgLy8gdGhpcy5wb3N0dHVybl9mbiA9IHBvc3R0dXJuX2ZuXHJcblxyXG4gICAgICAgIC8vIHN0YXJ0IGZlZWQgbGlzdGVuZXJzXHJcbiAgICAgICAgdGhpcy5mZWVkX3R1cm5fc3RhcnQgPSB0aGlzLmNoYW5uZWxfdHVybi5zdWJzY3JpYmUoXCJ0dXJuLnN0YXJ0XCIsIChkYXRhOiBCcmV3LkVudW1zLklCcmV3VHVybkRhdGEsIGVudmVsb3BlKSA9PiB7dGhpcy5oYW5kbGVUdXJuU3RhcnQoZGF0YSwgZW52ZWxvcGUpfSkgXHJcbiAgICAgICAgdGhpcy5mZWVkX3R1cm5fZW5kID0gdGhpcy5jaGFubmVsX3R1cm4uc3Vic2NyaWJlKFwidHVybi5lbmRcIiwgKGRhdGE6IEJyZXcuRW51bXMuSUJyZXdUdXJuRGF0YSwgZW52ZWxvcGUpID0+IHt0aGlzLmhhbmRsZVR1cm5FbmQoZGF0YSwgZW52ZWxvcGUpfSkgXHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5mZWVkX2V2ZW50ID0gdGhpcy5jaGFubmVsX2V2ZW50LnN1YnNjcmliZShcImV2ZW50LnN0YXJ0XCIsIChkYXRhOiBCcmV3LkVudW1zLklCcmV3RXZlbnQsIGVudmVsb3BlKSA9PiB7IHRoaXMuZXZlbnRGdW5jdGlvbldyYXBwZXIoZGF0YSwgZW52ZWxvcGUpIH0pXHJcbiAgICAgICAgdGhpcy5mZWVkX2V2ZW50ID0gdGhpcy5jaGFubmVsX2V2ZW50LnN1YnNjcmliZShcImV2ZW50LmVuZFwiLCAoZGF0YTogQnJldy5FbnVtcy5JQnJld0V2ZW50LCBlbnZlbG9wZSkgPT4geyB0aGlzLmhhbmRsZUV2ZW50RW5kKGRhdGEsIGVudmVsb3BlKSB9KVxyXG4gICAgICAgIFxyXG4gICAgICAgIHRoaXMuZmVlZF9pbnB1dCA9IHRoaXMuY2hhbm5lbF9pbnB1dC5zdWJzY3JpYmUoXCJpbnB1dC4qXCIsIChkYXRhOiBCcmV3LkVudW1zLklCcmV3SW5wdXREYXRhLCBlbnZlbG9wZSkgPT4geyB0aGlzLmlucHV0RnVuY3Rpb25XcmFwcGVyKGRhdGEsIGVudmVsb3BlKSB9KSBcclxuICAgICAgICBcclxuICAgICAgICB0aGlzLmZlZWRfZGlzcGxheSA9IHRoaXMuY2hhbm5lbF9kaXNwbGF5LnN1YnNjcmliZShcImRpc3BsYXkuKlwiLCAoZGF0YSwgZW52ZWxvcGUpID0+IHsgdGhpcy5oYW5kbGVEaXNwbGF5KGRhdGEsIGVudmVsb3BlKSB9KVxyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIHNldCB1cCBmaXJzdCBsZXZlbCwgc3RhcnQgZW5naW5lLCBkZWZpbmUgcGxheWVyLCBldGNcclxuICAgICAgICB0aGlzLnNldHVwR2FtZSgpXHJcblxyXG4gICAgICAgIC8vIGlmIChCUkVXX0ZJUlNUX1NUQVJUVVApIHtcclxuICAgICAgICAvLyAgICAgdGhpcy5zdGFydE1lbnUoKVxyXG4gICAgICAgIC8vIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgaW5pdFJORyhnaXZlbl9zZWVkOiBudW1iZXIpIHtcclxuICAgICAgICBpZiAoZ2l2ZW5fc2VlZCkge1xyXG4gICAgICAgICAgICB0aGlzLnN0YXJ0X3NlZWQgPSBnaXZlbl9zZWVkXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5zdGFydF9zZWVkID0gTWF0aC5mbG9vcihST1QuUk5HLmdldFVuaWZvcm0oKSAqIDk5OTkpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBST1QuUk5HLnNldFNlZWQodGhpcy5zdGFydF9zZWVkKVxyXG4gICAgICAgIGNvbnNvbGUubG9nKFwic3RhcnRpbmcgd2l0aCBTRUVEIFwiLCB0aGlzLnN0YXJ0X3NlZWQpXHJcbiAgICB9XHJcblxyXG4gICAgZ2V0U2VlZCgpIHsgcmV0dXJuIHRoaXMuc3RhcnRfc2VlZCB9XHJcbiAgICBcclxuICAgIHNldHVwR2FtZSgpIHtcclxuXHJcbiAgICAgICAgLy8gaW5pdCBwbGF5ZXIgZm9yIHRoZSBmaXJzdCB0aW1lIGFuZCBhZGQgdG8gdGhlIHNjaGVkdWxlclxyXG4gICAgICAgIGxldCBwbGF5ZXIgPSBidWlsZFBsYXllcih0aGlzKVxyXG4gICAgICAgIHRoaXMucGxheWVyID0gcGxheWVyIFxyXG5cclxuICAgICAgICAvLyBhcmNoaXRlY3QgaXMgbGlrZSBhIG5vbi1tb2IgZW52aXJvbm1lbnRhbCBtYW5hZ2VyXHJcbiAgICAgICAgdGhpcy5hcmNoaXRlY3QgPSBCcmV3LkRlZmluaXRpb25zLm1vbnN0ZXJGYWN0b3J5KHRoaXMsIEJyZXcuRGVmaW5pdGlvbnMuTW9uc3RlclR5cGUuQXJjaGl0ZWN0KVxyXG5cclxuICAgICAgICAvLyBidWlsZCBmaXJzdCBsZXZlbFxyXG4gICAgICAgIGxldCBmaXJzdF9sZXZlbCA9IEJyZXcuTGV2ZWxHZW5lcmF0b3IuYnVpbGRMZXZlbCh0aGlzLCAxLCBmYWxzZSlcclxuICAgICAgICB0aGlzLmFkZExldmVsKGZpcnN0X2xldmVsKVxyXG5cclxuICAgICAgICB0aGlzLnNldHVwTGV2ZWwoZmlyc3RfbGV2ZWwuaWQsIGZpcnN0X2xldmVsLnNpbXBsZV9zdGFydF94eSlcclxuICAgICAgICB0aGlzLmVuZ2luZS5zdGFydCgpXHJcbiAgICB9XHJcbiAgICBcclxuICAgIGFkZExldmVsKG5ld19sZXZlbCA6IEJyZXcuTGV2ZWwpIHtcclxuICAgICAgICBsZXQga2V5ID0gbmV3X2xldmVsLmlkXHJcbiAgICAgICAgdGhpcy5sZXZlbHNba2V5XSA9IG5ld19sZXZlbFxyXG4gICAgfVxyXG5cclxuICAgIHJlbW92ZUxldmVsKGxldmVsX2lkIDogbnVtYmVyKSB7XHJcbiAgICAgICAgZGVsZXRlIHRoaXMubGV2ZWxzW2xldmVsX2lkXVxyXG4gICAgfVxyXG5cclxuICAgIGdldExldmVsQnlJRChsZXZlbF9pZDogbnVtYmVyKSA6IEJyZXcuTGV2ZWwge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmxldmVsc1tsZXZlbF9pZF1cclxuICAgIH1cclxuXHJcbiAgICBoYXNMZXZlbChsZXZlbF9pZCA6IG51bWJlcikgOiBib29sZWFuIHtcclxuICAgICAgICByZXR1cm4gbGV2ZWxfaWQgaW4gdGhpcy5sZXZlbHNcclxuICAgIH1cclxuXHJcbiAgICBzZXR1cExldmVsKGxldmVsX2lkIDogbnVtYmVyLCBwbGF5ZXJfc3RhcnRfeHkgOiBCcmV3LkNvb3JkaW5hdGUpIHtcclxuICAgICAgICBsZXQgcGxheWVyID0gdGhpcy5nZXRQbGF5ZXIoKVxyXG4gICAgICAgIHRoaXMuZW5naW5lLmxvY2soKVxyXG4gICAgICAgIFxyXG4gICAgICAgIGlmICghKHRoaXMuaGFzTGV2ZWwobGV2ZWxfaWQpKSkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYExldmVsIHdpdGggaWQgJHtsZXZlbF9pZH0gZG9lcyBub3QgZXhpc3RgKVxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBpZiAodGhpcy5jdXJyZW50X2xldmVsKSB7XHJcbiAgICAgICAgICAgIHBsYXllci5tZW1vcnlfYXJjaGl2ZS5zYXZlTGV2ZWxNZW1vcnkodGhpcy5jdXJyZW50X2xldmVsLmlkLCBwbGF5ZXIubWVtb3J5KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IG5ld19sZXZlbCA9IHRoaXMubGV2ZWxzW2xldmVsX2lkXVxyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIHNldCB0aGlzIGFzIG91ciBjdXJyZW50IGxldmVsXHJcbiAgICAgICAgdGhpcy5jdXJyZW50X2xldmVsID0gbmV3X2xldmVsXHJcblxyXG4gICAgICAgIC8vIG1ha2Ugc3VyZSB3ZSBhZGQgcGxheWVyIHRvIHRoZSBsZXZlbCBzb21ld2hlcmUgXHJcbiAgICAgICAgLy8gdG9kbzogYmV0dGVyIHN0YXJ0aW5nIGNvb3JkcyBiYXNlZCBvbiBlbnRyYW5jZS9leGl0IHBvcnRhbHNcclxuICAgICAgICBpZiAobmV3X2xldmVsLm1vbnN0ZXJzLmhhc0F0KHBsYXllcl9zdGFydF94eSkpIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIm1vbnN0ZXIgYWxyZWFkeSBleGlzdHMgYXQgcGxheWVyJ3Mgc3RhcnRpbmcgbG9jYXRpb25cIilcclxuICAgICAgICB9ICAgICAgICBcclxuICAgICAgICBcclxuICAgICAgICBuZXdfbGV2ZWwubW9uc3RlcnMuc2V0QXQocGxheWVyX3N0YXJ0X3h5LCBwbGF5ZXIpXHJcblxyXG4gICAgICAgIC8vIGZpZ3VyZSBvdXQgZmFjaW5nIGRpcmVjdGlvblxyXG4gICAgICAgIGxldCBoYWxmX3ggPSBCcmV3LkNvbmZpZy5tYXBfd2lkdGhfdGlsZXMgLyAyXHJcbiAgICAgICAgbGV0IGhhbGZfeSA9IEJyZXcuQ29uZmlnLm1hcF9oZWlnaHRfdGlsZXMgLyAyXHJcblxyXG4gICAgICAgIGxldCB0dXJyZXQgPSBwbGF5ZXIuZ2V0UG93ZXJzKCkuZ2V0UG93ZXJPZlR5cGUoQnJldy5FbnVtcy5CcmV3UG93ZXJUeXBlLlR1cnJldENhbm5vbilcclxuICAgICAgICBpZiAoKHBsYXllcl9zdGFydF94eS54IDwgaGFsZl94KSAmJiAocGxheWVyX3N0YXJ0X3h5LnkgPCBoYWxmX3kpKSB7XHJcbiAgICAgICAgICAgIHR1cnJldC5mYWNpbmdfZGlyZWN0aW9uID0gQnJldy5EaXJlY3Rpb25zLlJJR0hULmNsb25lKClcclxuICAgICAgICB9IGVsc2UgaWYgKChwbGF5ZXJfc3RhcnRfeHkueCA8IGhhbGZfeCkgJiYgKHBsYXllcl9zdGFydF94eS55ID49IGhhbGZfeSkpIHtcclxuICAgICAgICAgICAgdHVycmV0LmZhY2luZ19kaXJlY3Rpb24gPSBCcmV3LkRpcmVjdGlvbnMuVVAuY2xvbmUoKVxyXG4gICAgICAgIH0gZWxzZSBpZiAoKHBsYXllcl9zdGFydF94eS54ID49IGhhbGZfeCkgJiYgKHBsYXllcl9zdGFydF94eS55IDwgaGFsZl95KSkge1xyXG4gICAgICAgICAgICB0dXJyZXQuZmFjaW5nX2RpcmVjdGlvbiA9IEJyZXcuRGlyZWN0aW9ucy5MRUZULmNsb25lKClcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0dXJyZXQuZmFjaW5nX2RpcmVjdGlvbiA9IEJyZXcuRGlyZWN0aW9ucy5ET1dOLmNsb25lKClcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIEJyZXcuUGFydHMudXBkYXRlTW9uc3RlclBhcnRzKHRoaXMsIHBsYXllcilcclxuICAgICAgICBCcmV3LlBhcnRzLnBsYWNlTW9uc3RlclBhcnRzT25HcmlkKHRoaXMsIHBsYXllcilcclxuICAgIFxyXG4gICAgICAgIC8vIGNsZWFyIG1lbW9yeSBhbmQgcmVzZXQgaWYgd2UndmUgYmVlbiBvbiB0aGlzIGxldmVsIGJlZm9yZVxyXG4gICAgICAgIHRoaXMucGxheWVyLm1lbW9yeS5jbGVhckFsbCgpXHJcbiAgICAgICAgaWYgKHBsYXllci5tZW1vcnlfYXJjaGl2ZS5oYXNMZXZlbE1lbW9yeShuZXdfbGV2ZWwuaWQpKSB7XHJcbiAgICAgICAgICAgIHBsYXllci5tZW1vcnkgPSBwbGF5ZXIubWVtb3J5X2FyY2hpdmUuZ2V0TGV2ZWxNZW1vcnkobmV3X2xldmVsLmlkKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgQnJldy5JbnRlbC5ydW5CZWZvcmVQbGF5ZXJUdXJuKHRoaXMsIHBsYXllcilcclxuXHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gcmVkbyBhbGwgQnJldy5QYXRobWFwc1xyXG4gICAgICAgIHRoaXMudXBkYXRlQWxsUGF0aG1hcHMoKVxyXG4gICAgICAgIC8vdGhpcy5wcmVwbGF5ZXJfZm4odGhpcywgdGhpcy5wbGF5ZXIpXHJcbiAgICAgICAgLy90aGlzLmRpc3BsYXkuZHJhd0FsbCgpXHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gc2NoZWR1bGUgYWxsIG1vYnMgaW4gdGhlIGxldmVsXHJcbiAgICAgICAgdGhpcy5zY2hlZHVsZXIuY2xlYXIoKVxyXG4gICAgICAgIHRoaXMuYWRkQWN0b3JUb1NjaGVkdWxlcih0aGlzLnBsYXllcilcclxuICAgICAgICBmb3IgKGxldCBtIG9mIG5ld19sZXZlbC5tb25zdGVycy5nZXRBbGxUaGluZ3MoKSkge1xyXG4gICAgICAgICAgICBpZiAoIShtLmlzU2FtZVRoaW5nKHRoaXMucGxheWVyKSkpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWRkQWN0b3JUb1NjaGVkdWxlcihtKVxyXG4gICAgICAgICAgICAgICAgQnJldy5QYXJ0cy51cGRhdGVNb25zdGVyUGFydHModGhpcywgbSlcclxuICAgICAgICAgICAgICAgIEJyZXcuUGFydHMucGxhY2VNb25zdGVyUGFydHNPbkdyaWQodGhpcywgbSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5hZGRBY3RvclRvU2NoZWR1bGVyKHRoaXMuZ2V0QXJjaGl0ZWN0KCkpXHJcbiAgICAgICAgLy8gdGhpcy5hZGRBY3RvclRvU2NoZWR1bGVyKERlZmluaXRpb25zLm1vbnN0ZXJGYWN0b3J5KHRoaXMsIEJyZXcuRGVmaW5pdGlvbnMuTW9uc3RlclR5cGUuQXJjaGl0ZWN0KSlcclxuICAgICAgICB0aGlzLmRpc3BsYXlBbGwoKVxyXG4gICAgICAgIHRoaXMuZGlzcGxheS5kcmF3SGVhZGVyKClcclxuICAgICAgICBcclxuICAgICAgICB0aGlzLmVuZ2luZS51bmxvY2soKVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICB1cGRhdGVBbGxQYXRobWFwcygpIHtcclxuICAgICAgICBsZXQgbGV2ZWwgPSB0aGlzLmdldEN1cnJlbnRMZXZlbCgpXHJcbiAgICAgICAgXHJcbiAgICAgICAgbGV0IHRvX3BhdGhfd2FsayA9IEJyZXcuUGF0aC5jcmVhdGVHZW5lcmljTWFwVG9QbGF5ZXIodGhpcywgbGV2ZWwsIEJyZXcuRW51bXMuTGV2ZWxOYXZpZ2F0aW9uVHlwZS5XYWxrLCB0cnVlKVxyXG4gICAgICAgIHRoaXMucGF0aG1hcHMudXBkYXRlQ2FjaGUoQnJldy5FbnVtcy5QYXRobWFwQ2FjaGVUeXBlLlRvUGxheWVyX1dhbGssIHRvX3BhdGhfd2FsaylcclxuICAgICAgICB0aGlzLnBhdGhtYXBzLnVwZGF0ZUNhY2hlKEJyZXcuRW51bXMuUGF0aG1hcENhY2hlVHlwZS5Gcm9tUGxheWVyX1dhbGssIEJyZXcuUGF0aC5jcmVhdGVNYXBGcm9tUGxheWVyKHRoaXMsIGxldmVsLCB0b19wYXRoX3dhbGssIHRydWUpKVxyXG5cclxuICAgICAgICAvLyB1cGRhdGUgZmxpZ2h0IG1hcHMgaWYgd2UgbmVlZCB0b1xyXG4gICAgICAgIC8vIGxldCBoYXNfZmx5ZXJzIDogYm9vbGVhbiA9IGxldmVsLm1vbnN0ZXJzLmdldEFsbFRoaW5ncygpLnNvbWUoKG1vYjogQnJldy5HcmlkVGhpbmdzLk1vbnN0ZXIpID0+IHtcclxuICAgICAgICAvLyAgICAgcmV0dXJuIG1vYi5oYXNGbGFnKEJyZXcuRW51bXMuRmxhZy5GbHlpbmcpXHJcbiAgICAgICAgLy8gfSlcclxuICAgICAgICAvLyBjaGFuZ2luZyB0aGlzIHRvIGFsd2F5cyB0cnVlIGluIGNhc2UgdGFyZ2V0ZXJzIG5lZWQgdG8gdXNlIGl0IHRvIHNob290IG92ZXIgY2hhc21zXHJcbiAgICAgICAgbGV0IG5lZWRzX2ZseWluZ19tYXAgPSB0cnVlXHJcbiAgICAgICAgaWYgKG5lZWRzX2ZseWluZ19tYXApIHtcclxuICAgICAgICAgICAgbGV0IHRvX3BhdGhfZmx5ID0gQnJldy5QYXRoLmNyZWF0ZUdlbmVyaWNNYXBUb1BsYXllcih0aGlzLCBsZXZlbCwgQnJldy5FbnVtcy5MZXZlbE5hdmlnYXRpb25UeXBlLkZseSwgdHJ1ZSlcclxuICAgICAgICAgICAgdGhpcy5wYXRobWFwcy51cGRhdGVDYWNoZShCcmV3LkVudW1zLlBhdGhtYXBDYWNoZVR5cGUuVG9QbGF5ZXJfRmx5LCB0b19wYXRoX2ZseSlcclxuICAgICAgICAgICAgdGhpcy5wYXRobWFwcy51cGRhdGVDYWNoZShCcmV3LkVudW1zLlBhdGhtYXBDYWNoZVR5cGUuRnJvbVBsYXllcl9GbHksIEJyZXcuUGF0aC5jcmVhdGVNYXBGcm9tUGxheWVyKHRoaXMsIGxldmVsLCB0b19wYXRoX2ZseSwgdHJ1ZSkpXHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICBhZGRBY3RvclRvU2NoZWR1bGVyKG1vYjogQnJldy5HcmlkVGhpbmdzLk1vbnN0ZXIpIHtcclxuICAgICAgICB0aGlzLnNjaGVkdWxlci5hZGQobW9iLCB0cnVlKVxyXG4gICAgfVxyXG5cclxuICAgIHJlbW92ZUFjdG9yRnJvbVNjaGVkdWxlcihtb2I6IEJyZXcuR3JpZFRoaW5ncy5Nb25zdGVyKSB7XHJcbiAgICAgICAgdGhpcy5zY2hlZHVsZXIucmVtb3ZlKG1vYilcclxuICAgIH1cclxuXHJcbiAgICBpbnB1dEZ1bmN0aW9uV3JhcHBlcihkYXRhLCBlbnZlbG9wZSkge1xyXG4gICAgICAgIGlmICh0aGlzLmJsb2NrX2lucHV0ID09IHRydWUpIHtcclxuICAgICAgICAgICAgLy8gY29uc29sZS53YXJuKFwiaW5wdXQgYmxvY2tlZFwiKVxyXG4gICAgICAgICAgICA7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5pbnB1dF9mbih0aGlzLCBkYXRhLCBlbnZlbG9wZSlcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGV2ZW50RnVuY3Rpb25XcmFwcGVyKGRhdGE6IEJyZXcuRW51bXMuSUJyZXdFdmVudCwgZW52ZWxvcGUpIHtcclxuICAgICAgICBpZiAoZGF0YS5ldmVudFR5cGUgIT0gQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLkVycm9yKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYmxvY2tfaW5wdXQgPSB0cnVlXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmV2ZW50X2ZuKHRoaXMsIGRhdGEsIGVudmVsb3BlKVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBoYW5kbGVEaXNwbGF5KGRhdGEsIGVudmVsb3BlOiBJRW52ZWxvcGU8YW55Pikge1xyXG4gICAgICAgIGlmICghKGRhdGEpKSB7XHJcbiAgICAgICAgICAgIC8vIGNvbnNvbGUud2FybihcInBhc3NlZCBudWxsIGRpc3BsYXkgZGF0YVwiLCBkYXRhKVxyXG4gICAgICAgICAgICByZXR1cm5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChlbnZlbG9wZS50b3BpYyA9PSBcImRpc3BsYXkuYWxsXCIpIHtcclxuICAgICAgICAgICAgdGhpcy5kaXNwbGF5LmRyYXdBbGwoZGF0YSlcclxuICAgICAgICB9IGVsc2UgaWYgKGVudmVsb3BlLnRvcGljID09IFwiZGlzcGxheS5hdFwiKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZGlzcGxheS5kcmF3QXQoZGF0YSlcclxuICAgICAgICB9IGVsc2UgaWYgKGVudmVsb3BlLnRvcGljID09IFwiZGlzcGxheS5saXN0XCIpIHtcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkYXRhLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRpc3BsYXkuZHJhd0F0KGRhdGFbaV0pXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiaW52YWxpZCBkaXNwbGF5IGRhdGFcIiwgZGF0YSlcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGhhbmRsZUV2ZW50RW5kKGRhdGE6IEJyZXcuRW51bXMuSUJyZXdFdmVudCwgZW52ZWxvcGUpIHtcclxuXHJcbiAgICAgICAgdGhpcy5sYXN0RXZlbnRJbmNsdWRlRXJyb3JzID0gZGF0YSAvLyBrZWVwIHRyYWNrIG9mIGxhc3QgZXZlbnRzIGluY2x1ZGluZyBlcnJvcnMgXHJcbiAgICAgICAgaWYgKGRhdGEuZXZlbnRUeXBlICE9IEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5FcnJvcikge1xyXG4gICAgICAgICAgICB0aGlzLmxhc3RFdmVudCA9IGRhdGEgLy8ga2VlcCB0cmFjayBvZiB0aGUgbGFzdCBub24tZXJyb3IgZXZlbnRcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKHRoaXMuZXZlbnRfcXVldWUubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgbGV0IG5leHRFdmVudCA9IHRoaXMuZXZlbnRfcXVldWUucG9wKClcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIHByb3BvZ2F0ZSBFbmRzVHVybiBpZiB0aGlzIGV2ZW50IGlzIHN1cHBvc2VkIHRvIGVuZCB0aGUgdHVyblxyXG4gICAgICAgICAgICBpZiAoZGF0YS5lbmRzVHVybiA9PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBzd2FwL3Byb3BvZ2F0ZSB0cnVlIGVuZHNUdXJuXHJcbiAgICAgICAgICAgICAgICBkYXRhLmVuZHNUdXJuID0gZmFsc2VcclxuICAgICAgICAgICAgICAgIG5leHRFdmVudC5lbmRzVHVybiA9IHRydWVcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB9IFxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdGhpcy5jaGFubmVsX2V2ZW50LnB1Ymxpc2goXCJldmVudC5zdGFydFwiLCBuZXh0RXZlbnQpXHJcblxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGlmIChkYXRhLmVuZHNUdXJuKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhcImV2ZW50IGVuZDogdHVybiBlbmRcIilcclxuICAgICAgICAgICAgICAgIHRoaXMuY2hhbm5lbF90dXJuLnB1Ymxpc2goXCJ0dXJuLmVuZFwiLCB7YWN0b3I6IGRhdGEuYWN0b3J9KVxyXG5cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIGlmIGl0IGRvZXNuJ3QgZW5kIHR1cm4sIGFsbG93IHRoZSBwbGF5ZXIgdG8gcHV0IGluIGlucHV0IGFnYWluXHJcbiAgICAgICAgICAgICAgICBpZiAoZGF0YS5hY3Rvci5pc1R5cGUoQnJldy5EZWZpbml0aW9ucy5Nb25zdGVyVHlwZS5IZXJvKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwiaW5wdXQgYmxvY2tpbmcgT0ZGXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ibG9ja19pbnB1dCA9IGZhbHNlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGluaXRFdmVudExpc3RlbmVyKGRpdl9jb250YWluZXI6IEhUTUxEaXZFbGVtZW50KSB7XHJcbiAgICAgICAgLy8gYWRkIGV2ZW50IGxpc3RlbmVycyB0byBwYWdlL2NhbnZhc1xyXG4gICAgICAgIGRpdl9jb250YWluZXIub3duZXJEb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCAoZSkgPT4ge1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgaWYgKEJyZXcuS2V5TWFwLk1vdmVtZW50S2V5cy5jb25jYXQoQnJldy5LZXlNYXAuQWN0aW9uKS5pbmRleE9mKGUua2V5Q29kZSkgPiAtMSkge1xyXG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpICAgIFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB0aGlzLmNoYW5uZWxfaW5wdXQucHVibGlzaChcImlucHV0LmtleWJvYXJkXCIsIHtcclxuICAgICAgICAgICAgICAgIHNvdXJjZTogQnJldy5FbnVtcy5CcmV3SW5wdXRTb3VyY2UuS2V5Ym9hcmQsXHJcbiAgICAgICAgICAgICAgICBjb2RlOiBlLmtleUNvZGUsIFxyXG4gICAgICAgICAgICAgICAganNldmVudDogZVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgXHJcbiAgICAgICAgZGl2X2NvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChlKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuY2hhbm5lbF9pbnB1dC5wdWJsaXNoKFwiaW5wdXQubW91c2VcIiwge1xyXG4gICAgICAgICAgICAgICAgc291cmNlOiBCcmV3LkVudW1zLkJyZXdJbnB1dFNvdXJjZS5Nb3VzZSxcclxuICAgICAgICAgICAgICAgIGJ1dHRvbjogZS5idXR0b24sXHJcbiAgICAgICAgICAgICAgICBqc2V2ZW50OiBlXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSlcclxuICAgICAgICBcclxuICAgICAgICBkaXZfY29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW1vdmVcIiwgKGUpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5jaGFubmVsX2lucHV0LnB1Ymxpc2goXCJpbnB1dC5tb3VzZVwiLCB7XHJcbiAgICAgICAgICAgICAgICBzb3VyY2U6IEJyZXcuRW51bXMuQnJld0lucHV0U291cmNlLk1vdXNlLFxyXG4gICAgICAgICAgICAgICAgYnV0dG9uOiBlLmJ1dHRvbixcclxuICAgICAgICAgICAgICAgIGpzZXZlbnQ6IGVcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9KVxyXG5cclxuICAgIH1cclxuICAgIFxyXG4gICAgZ2V0UGxheWVyKCkgOiBCcmV3LkdyaWRUaGluZ3MuTW9uc3RlciB7IFxyXG4gICAgICAgIHJldHVybiB0aGlzLnBsYXllclxyXG4gICAgfVxyXG5cclxuICAgIGdldEFyY2hpdGVjdCgpIDogQnJldy5HcmlkVGhpbmdzLk1vbnN0ZXIge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmFyY2hpdGVjdFxyXG4gICAgfVxyXG5cclxuICAgIGdldEN1cnJlbnRMZXZlbCgpIDogQnJldy5MZXZlbCB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY3VycmVudF9sZXZlbFxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBzZXRQbGF5ZXIobmV3X3BsYXllcjogQnJldy5HcmlkVGhpbmdzLk1vbnN0ZXIpIDogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5wbGF5ZXIgPSBuZXdfcGxheWVyXHJcbiAgICB9XHJcbiAgICBcclxuICAgIHNldEN1cnJlbnRMZXZlbChuZXdfbGV2ZWw6IGFueSkgOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmN1cnJlbnRfbGV2ZWwgPSBuZXdfbGV2ZWxcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gcG9zdGFsIGZlZWQgaGFuZGxlcnNcclxuICAgIGhhbmRsZVR1cm5FbmQoZGF0YTogQnJldy5FbnVtcy5JQnJld1R1cm5EYXRhLCBlbnZlbG9wZTogSUVudmVsb3BlPGFueT4pICB7XHJcbiAgICAgICAgbGV0IG1vYiA9IGRhdGEuYWN0b3JcclxuICAgICAgICAvLyBjb25zb2xlLmxvZyhgRU5EIFRVUk46ICR7bW9iLm5hbWV9YClcclxuICAgICAgICAvLyB0aGlzLnBvc3R0dXJuX2ZuKHRoaXMsIG1vYilcclxuXHJcbiAgICAgICAgaWYgKG1vYi5pc1R5cGUoQnJldy5EZWZpbml0aW9ucy5Nb25zdGVyVHlwZS5IZXJvKSkge1xyXG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhcImlucHV0IGJsb2NraW5nIE9GRlwiKVxyXG4gICAgICAgICAgICB0aGlzLnBvc3RwbGF5ZXJfZm4odGhpcywgbW9iKVxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICB0aGlzLmVuZ2luZS51bmxvY2soKVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBoYW5kbGVUdXJuU3RhcnQoZGF0YTogQnJldy5FbnVtcy5JQnJld1R1cm5EYXRhLCBlbnZlbG9wZTogSUVudmVsb3BlPGFueT4pIHtcclxuICAgICAgICBsZXQgbW9iID0gZGF0YS5hY3RvclxyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKGBTVEFSVCBUVVJOOiAke21vYi5uYW1lfWApXHJcblxyXG4gICAgICAgIHRoaXMuY3VycmVudF90dXJuX2FjdG9yID0gbW9iIFxyXG4gICAgICAgIFxyXG4gICAgICAgIHRoaXMuZW5naW5lLmxvY2soKVxyXG4gICAgICAgIHRoaXMuY2hlY2tUaW1lcnNGb3JBY3Rvcihtb2IpXHJcbiAgICAgICAgLy8gTW92ZW1lbnQuY2hlY2tGb3JBbWJpZW50RWZmZWN0cyh0aGlzLCBtb2IpXHJcblxyXG4gICAgICAgIGlmIChtb2IuaXNUeXBlKEJyZXcuRGVmaW5pdGlvbnMuTW9uc3RlclR5cGUuSGVybykpIHsvL3RvZG86IGNoYW5nZSB0aGlzIHRvIGlzUGxheWVyXHJcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwiaW5wdXQgYmxvY2tpbmcgT0ZGXCIpXHJcbiAgICAgICAgICAgIHRoaXMucHJlcGxheWVyX2ZuKHRoaXMsIG1vYilcclxuICAgICAgICAgICAgdGhpcy5ibG9ja19pbnB1dCA9IGZhbHNlXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGxldCBhaV9ldmVudCA6IEJyZXcuRW51bXMuSUJyZXdFdmVudFxyXG4gICAgICAgICAgICBhaV9ldmVudCA9IHRoaXMuYWlfZm4odGhpcywgbW9iKVxyXG4gICAgICAgICAgICB0aGlzLmNoYW5uZWxfZXZlbnQucHVibGlzaChcImV2ZW50LnN0YXJ0XCIsIGFpX2V2ZW50KVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgLy9lbmRFdmVudChkYXRhOiBCcmV3LkVudW1zLklCcmV3RXZlbnQsIG5leHRFdmVudERhdGE/IDogQnJldy5FbnVtcy5JQnJld0V2ZW50KSB7XHJcbiAgICBlbmRFdmVudChkYXRhOiBCcmV3LkVudW1zLklCcmV3RXZlbnQpIHtcclxuICAgICAgICB0aGlzLmNoYW5uZWxfZXZlbnQucHVibGlzaChcImV2ZW50LmVuZFwiLCBkYXRhKVxyXG4gICAgICAgIC8vdHdwOiBuZWVkIHRvIGhhbmRsZSBpbnNlcnRlZCBldmVudHMgZmlyc3RcclxuICAgICAgICAvLyBpZiAobmV4dEV2ZW50RGF0YSkge1xyXG4gICAgICAgIC8vICAgICB0aGlzLmNoYW5uZWxfZXZlbnQucHVibGlzaChcImV2ZW50LnN0YXJ0XCIsIG5leHRFdmVudERhdGEpXHJcbiAgICAgICAgLy8gfVxyXG4gICAgfVxyXG5cclxuICAgIGluc2VydEV2ZW50X05leHQoaW5zZXJ0ZWRfZXZlbnQgOiBCcmV3LkVudW1zLklCcmV3RXZlbnQpIDogYm9vbGVhbiB7XHJcbiAgICAgICAgLy8gaW5zZXJ0cyBldmVudCBhZnRlciB0aGUgbmV4dCB1cGNvbWluZyBldmVudCAoMm5kIGZyb20gdGhlIGVuZClcclxuXHJcbiAgICAgICAgdGhpcy5ldmVudF9xdWV1ZS5zcGxpY2UoLTIsIDAsIGluc2VydGVkX2V2ZW50KVxyXG5cclxuICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgfVxyXG5cclxuICAgIGluc2VydEV2ZW50KGluc2VydGVkX2V2ZW50IDogQnJldy5FbnVtcy5JQnJld0V2ZW50KSA6IGJvb2xlYW4ge1xyXG4gICAgICAgIC8vIGluc2VydCBpbnRvIGEgd2FpdGluZyBxdWV1ZSB0byB0cmlnZ2VyIGJlZm9yZSB3ZSBnbyBiYWNrIHRvIHRoZSBwaXBlbGluZVxyXG4gICAgICAgIHRoaXMuZXZlbnRfcXVldWUudW5zaGlmdChpbnNlcnRlZF9ldmVudClcclxuICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgfVxyXG5cclxuICAgIGNsZWFyRXZlbnRRdWV1ZSgpIHtcclxuICAgICAgICB0aGlzLmV2ZW50X3F1ZXVlID0gW11cclxuICAgIH1cclxuICAgIFxyXG4gICAgZ2V0TGFzdEV2ZW50KGluY2x1ZGVFcnJvcnM6IGJvb2xlYW4gPSBmYWxzZSkge1xyXG4gICAgICAgIGlmIChpbmNsdWRlRXJyb3JzKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmxhc3RFdmVudEluY2x1ZGVFcnJvcnNcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5sYXN0RXZlbnRcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGNvcHlFdmVudERhdGFGcm9tTGFzdEV2ZW50KG1vZGlmaWVkX2V2ZW50OiBCcmV3LkVudW1zLklCcmV3RXZlbnQpIHtcclxuICAgICAgICBsZXQgbGFzdEV2ZW50ID0gdGhpcy5nZXRMYXN0RXZlbnQoKVxyXG4gICAgICAgIGxldCBpZ25vcmVMaXN0ID0gW1wiYWN0b3JcIiwgXCJwbGF5ZXJJbml0aWF0ZWRcIiwgXCJlbmRzVHVyblwiLCBcImV2ZW50VHlwZVwiXVxyXG4gICAgICAgIGZvciAobGV0IGtleSBpbiBsYXN0RXZlbnQpIHtcclxuICAgICAgICAgICAgaWYgKGxhc3RFdmVudC5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaWdub3JlTGlzdC5pbmRleE9mKGtleSkgPT0gLTEpIHsgLy8gbm90IG9uIHRoZSBpZ25vcmUgbGlzdFxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBlbGVtZW50ID0gbGFzdEV2ZW50W2tleV1cclxuICAgICAgICAgICAgICAgICAgICBtb2RpZmllZF9ldmVudFtrZXldID0gZWxlbWVudFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIGRpc3BsYXkgc2hvcnRjdXRzXHJcbiAgICBkaXNwbGF5QXQoeHk6IEJyZXcuQ29vcmRpbmF0ZSkgOiB2b2lkIHtcclxuICAgICAgICBpZiAoISh4eSkpIHtcclxuICAgICAgICAgICAgY29uc29sZS53YXJuKFwicGFzc2VkIGluIG51bGwgeHkgY29vcmRzIHRvIGRpc3BsYXlBdFwiLCB4eSlcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jaGFubmVsX2Rpc3BsYXkucHVibGlzaChcImRpc3BsYXkuYXRcIiwgeHkpXHJcbiAgICB9XHJcbiAgICBcclxuICAgIGRpc3BsYXlBbGwoZGlzcGxheV9vcHRpb25zIDogQnJldy5FbnVtcy5JRGlzcGxheU9wdGlvbnMgPSB7fSkgOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmNoYW5uZWxfZGlzcGxheS5wdWJsaXNoKFwiZGlzcGxheS5hbGxcIiwgZGlzcGxheV9vcHRpb25zKVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBkaXNwbGF5TGlzdCh4eV9saXN0OiBBcnJheTxCcmV3LkNvb3JkaW5hdGU+KSA6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuY2hhbm5lbF9kaXNwbGF5LnB1Ymxpc2goXCJkaXNwbGF5Lmxpc3RcIiwgeHlfbGlzdClcclxuICAgIH1cclxuXHJcbiAgICAvLyB0dXJuIEJyZXcuVGltZXJzXHJcbiAgICBjaGVja1RpbWVyc0ZvckFjdG9yKGFjdG9yOiBCcmV3LkdyaWRUaGluZ3MuVGhpbmcpIHtcclxuICAgICAgICBsZXQgdGltZXJfbGlzdCA9IHRoaXMudGltZXJfbW9uaXRvci5nZXRBbGxUaW1lcnNUcmlnZ2VyZWRGb3IoYWN0b3IsIHRoaXMudHVybl9jb3VudClcclxuICAgICAgICBpZiAodGltZXJfbGlzdC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIGZvciAobGV0IHRpbWVyIG9mIHRpbWVyX2xpc3QpIHtcclxuICAgICAgICAgICAgICAgIGFjdG9yLnJlbW92ZUZsYWcodGltZXIuZmxhZylcclxuICAgICAgICAgICAgICAgIHRoaXMuZGlzcGxheUF0KGFjdG9yLmxvY2F0aW9uKVxyXG4gICAgICAgICAgICAgICAgdGhpcy50aW1lcl9tb25pdG9yLnJlbW92ZVRpbWVyKHRpbWVyLmFjdG9yLCB0aW1lci5mbGFnKS8vdG9kbzogbmVlZCBjZW50cmFsaXplZCB3YXkgb2YgZG9pbmcgQnJldy5UaW1lcnNcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG59XHJcblxyXG5mdW5jdGlvbiBidWlsZFBsYXllcihnbSA6IEdhbWVNYXN0ZXIsIHBsYXllcl9uYW1lIDogc3RyaW5nID0gXCJIZXJvXCIpIDogQnJldy5HcmlkVGhpbmdzLk1vbnN0ZXIge1xyXG5cclxuICAgIGxldCBwbGF5ZXIgPSBCcmV3LkRlZmluaXRpb25zLm1vbnN0ZXJGYWN0b3J5KGdtLCBCcmV3LkRlZmluaXRpb25zLk1vbnN0ZXJUeXBlLkhlcm8pXHJcblxyXG4gICAgcGxheWVyLm5hbWUgPSBwbGF5ZXJfbmFtZVxyXG4gICAgLy8gcGxheWVyLmNvZGUgPSBTeW1ib2xzLnNtaWxleV9mYWNlXHJcbiAgICBwbGF5ZXIuaW52ZW50b3J5ID0gbmV3IEJyZXcuSW52ZW50b3J5KEJyZXcuQ29uZmlnLm1heF9pdGVtcylcclxuICAgIHBsYXllci5wb3dlcl9zdWl0ZSA9IG5ldyBCcmV3LlBvd2Vycy5Qb3dlclN1aXRlKEJyZXcuQ29uZmlnLm1heF9wb3dlcnMpXHJcbiAgICBwbGF5ZXIudGVhbSA9IEJyZXcuRW51bXMuVGVhbS5QbGF5ZXJcclxuXHJcbiAgICBwbGF5ZXIuc2V0RmFjaW5nKEJyZXcuRGlyZWN0aW9ucy5ET1dOLmNsb25lKCkpXHJcbiAgICBwbGF5ZXIuYnVpbGRpbmdfdHlwZSA9IEJyZXcuRW51bXMuQ29tcG9uZW50UGFydHNCdWlsZGluZ1R5cGUuVGFua1xyXG4gICAgbGV0IHR1cnJldFBvd2VyID0gQnJldy5Qb3dlcnMuY3JlYXRlQmFzaWNQb3dlck9mVHlwZShCcmV3LkVudW1zLkJyZXdQb3dlclR5cGUuVHVycmV0Q2Fubm9uKVxyXG4gICAgdHVycmV0UG93ZXIuZmFjaW5nX2RpcmVjdGlvbiA9IEJyZXcuRGlyZWN0aW9ucy5ET1dOLmNsb25lKClcclxuICAgIHR1cnJldFBvd2VyLmZpcmluZ19hcmMgPSBCcmV3LkVudW1zLkZpcmluZ0FyYy5RdWFydGVyQXJjXHJcbiAgICB0dXJyZXRQb3dlci5jaGFyZ2Vfc3RhdC5zZXRUbyg4KVxyXG4gICAgXHJcbiAgICBsZXQgbWFjaGluZUd1biA9IEJyZXcuUG93ZXJzLmNyZWF0ZUJhc2ljUG93ZXJPZlR5cGUoQnJldy5FbnVtcy5CcmV3UG93ZXJUeXBlLk1hY2hpbmVHdW4pXHJcbiAgICBtYWNoaW5lR3VuLmNoYXJnZV9zdGF0LnNldFRvKDE2KVxyXG4gICAgXHJcbiAgICBwbGF5ZXIucG93ZXJfc3VpdGUuYWRkUG93ZXIodHVycmV0UG93ZXIpXHJcbiAgICBwbGF5ZXIucG93ZXJfc3VpdGUuYWRkUG93ZXIobWFjaGluZUd1bilcclxuXHJcbiAgICAvLyBmb3IgKGxldCBpID0gMDsgaSA8IDg7IGkrKykge1xyXG4gICAgLy8gICAgIHBsYXllci5pbnZlbnRvcnkuYWRkSXRlbShCcmV3LkRlZmluaXRpb25zLml0ZW1GYWN0b3J5KEJyZXcuRGVmaW5pdGlvbnMuSXRlbVR5cGUuU3VwcGxpZXMpKVxyXG4gICAgLy8gfVxyXG4gICAgcmV0dXJuIHBsYXllclxyXG59XHJcbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/brew_engine/game_master.ts\n");

/***/ }),

/***/ "./src/brew_engine/input.ts":
/*!**********************************!*\
  !*** ./src/brew_engine/input.ts ***!
  \**********************************/
/*! exports provided: handleAllInput */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"handleAllInput\", function() { return handleAllInput; });\n/* harmony import */ var _brew__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../brew */ \"./src/brew.ts\");\n\r\nfunction inputError(errorMsg) {\r\n    return {\r\n        eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.Error,\r\n        actor: null,\r\n        playerInitiated: true,\r\n        endsTurn: false,\r\n        errorMsg: errorMsg\r\n    };\r\n}\r\n// called from postal.js channel\r\nfunction handleAllInput(gm, data, envelope) {\r\n    let myEvent;\r\n    // default main handler\r\n    if (gm.input_handler == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].InputHandler.Main) {\r\n        myEvent = mainInputHandler(gm, data, envelope);\r\n        // targeting handler\r\n    }\r\n    else if (gm.input_handler == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].InputHandler.Targeting) {\r\n        myEvent = targetingInputHandler(gm, data, envelope);\r\n        // generic menu handler\r\n    }\r\n    else if (gm.input_handler == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].InputHandler.GenericMenu) {\r\n        myEvent = genericMenuHandler(gm, data);\r\n    }\r\n    else if (gm.input_handler == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].InputHandler.WaitToDismiss) {\r\n        myEvent = waitToDismissHandler(gm, data);\r\n    }\r\n    else if (gm.input_handler == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].InputHandler.HeadsUpDisplay) {\r\n        myEvent = headsUpDisplayHandler(gm, data);\r\n    }\r\n    else if (gm.input_handler == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].InputHandler.HelpMenu) {\r\n        myEvent = helpMenuHandler(gm, data);\r\n        // } else if (gm.input_handler == Brew.Enums.InputHandler.WaitToRestart) {\r\n        //     myEvent = waitToRestartHandler(gm, data, envelope)\r\n    }\r\n    else if (gm.input_handler == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].InputHandler.ConfirmPaths) {\r\n        myEvent = confirmPathsHandler(gm, data, envelope);\r\n    }\r\n    else {\r\n        console.error(`unknown input handler ${gm.input_handler}`);\r\n    }\r\n    // post to events channel here ?\r\n    gm.channel_event.publish(\"event.start\", myEvent);\r\n}\r\n// function waitToRestartHandler(gm: Brew.GameMaster, data: Brew.Enums.IBrewInputData, envelope) : Brew.Enums.IBrewEvent {\r\n//     let keycode = data.code\r\n//     if (KeyMap.Action.indexOf(keycode) > -1) {\r\n//         let resetEvent : Brew.Enums.IBrewEvent = {\r\n//             eventType: Brew.Enums.BrewEventType.RestartGame,\r\n//             actor: gm.getPlayer(),\r\n//             playerInitiated: true,\r\n//             endsTurn: true\r\n//         }\r\n//         return resetEvent\r\n//     } else {\r\n//         return inputError(\"game over - press ACTION to restart\")\r\n//     }\r\n// }\r\nfunction waitToDismissHandler(gm, data) {\r\n    let keycode = data.code;\r\n    if ((_brew__WEBPACK_IMPORTED_MODULE_0__[\"KeyMap\"].Escape.indexOf(keycode) > -1) || (_brew__WEBPACK_IMPORTED_MODULE_0__[\"KeyMap\"].Action.indexOf(keycode) > -1)) {\r\n        return _brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].createGenericEventOfType(gm, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.GenericMenuOff, false);\r\n    }\r\n    else {\r\n        return inputError(\"waiting to dismiss first\");\r\n    }\r\n}\r\nfunction headsUpDisplayHandler(gm, brEvent) {\r\n    let keycode = brEvent.code;\r\n    let hudEvent;\r\n    let prevMenuEvent = gm.getLastEvent();\r\n    if ((_brew__WEBPACK_IMPORTED_MODULE_0__[\"KeyMap\"].Escape.indexOf(keycode) > -1) || (_brew__WEBPACK_IMPORTED_MODULE_0__[\"KeyMap\"].Action.indexOf(keycode) > -1) || (_brew__WEBPACK_IMPORTED_MODULE_0__[\"KeyMap\"].HeadsUp.indexOf(keycode) > -1)) {\r\n        return _brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].createGenericEventOfType(gm, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.GenericMenuOff, false);\r\n    }\r\n    else if (_brew__WEBPACK_IMPORTED_MODULE_0__[\"KeyMap\"].MovementKeys.indexOf(keycode) > -1) {\r\n        let cycle_dir = getCycleIncrementValueFromKeypress(keycode);\r\n        let new_page_index = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].mod(prevMenuEvent.headsUpData.selected_index + cycle_dir, prevMenuEvent.headsUpData.headsUpDisplayNotePages.length);\r\n        console.log(new_page_index, prevMenuEvent.headsUpData.headsUpDisplayNotePages.length);\r\n        hudEvent = {\r\n            eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.HeadsUpDisplayOn,\r\n            actor: gm.getPlayer(),\r\n            playerInitiated: true,\r\n            endsTurn: false,\r\n            headsUpData: {\r\n                headsUpDisplayNotePages: prevMenuEvent.headsUpData.headsUpDisplayNotePages,\r\n                selected_index: new_page_index,\r\n            }\r\n        };\r\n        return hudEvent;\r\n    }\r\n    else {\r\n        return inputError(\"generic menu - unknown keypress\");\r\n    }\r\n}\r\nfunction confirmPathsHandler(gm, data, envelope) {\r\n    let keycode = data.code;\r\n    let confirmPathsEvent;\r\n    // make sure path was actually valid\r\n    let lastEvent = gm.getLastEvent();\r\n    let valid_path = lastEvent.confirmPathsData.valid_path;\r\n    if ((_brew__WEBPACK_IMPORTED_MODULE_0__[\"KeyMap\"].Action.indexOf(keycode) > -1) && (valid_path)) {\r\n        confirmPathsEvent = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].createGenericEventOfType(gm, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.ConfirmPathsFinalize, false);\r\n    }\r\n    else {\r\n        confirmPathsEvent = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].createGenericEventOfType(gm, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.ConfirmPathsCancel, false);\r\n    }\r\n    return confirmPathsEvent;\r\n}\r\nfunction getCycleIncrementValueFromKeypress(keycode) {\r\n    // return 1 or -1 depending on which keys were pressed, for menu/toggling\r\n    let cycle_dir;\r\n    let offset_xy = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].getDirectionFromKeycode(keycode);\r\n    if ((offset_xy.x < 0) || (offset_xy.y < 0)) {\r\n        cycle_dir = -1;\r\n    }\r\n    else if ((offset_xy.x > 0) || (offset_xy.y > 0)) {\r\n        cycle_dir = 1;\r\n    }\r\n    else {\r\n        throw new Error(\"Some kind of weird direction thingy happened\");\r\n    }\r\n    return cycle_dir;\r\n}\r\nfunction genericMenuHandler(gm, brEvent) {\r\n    let keycode = brEvent.code;\r\n    let genericMenuEvent;\r\n    let prevMenuEvent = gm.getLastEvent();\r\n    let allowCancel = prevMenuEvent.genericMenuData.allowCancel;\r\n    if ((_brew__WEBPACK_IMPORTED_MODULE_0__[\"KeyMap\"].Escape.indexOf(keycode) > -1) && allowCancel) {\r\n        genericMenuEvent = {\r\n            eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.GenericMenuOff,\r\n            actor: gm.getPlayer(),\r\n            playerInitiated: true,\r\n            endsTurn: false\r\n        };\r\n        return genericMenuEvent;\r\n    }\r\n    else if (_brew__WEBPACK_IMPORTED_MODULE_0__[\"KeyMap\"].MovementKeys.indexOf(keycode) > -1) {\r\n        let cycle_dir = getCycleIncrementValueFromKeypress(keycode);\r\n        genericMenuEvent = {\r\n            eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.GenericMenuMove,\r\n            actor: gm.getPlayer(),\r\n            playerInitiated: true,\r\n            endsTurn: false,\r\n            genericMenuData: {\r\n                menuTitle: prevMenuEvent.genericMenuData.menuTitle,\r\n                menuDescription: prevMenuEvent.genericMenuData.menuDescription,\r\n                allowCancel: allowCancel,\r\n                direction: cycle_dir\r\n            }\r\n        };\r\n        return genericMenuEvent;\r\n    }\r\n    else if (_brew__WEBPACK_IMPORTED_MODULE_0__[\"KeyMap\"].Action.indexOf(keycode) > -1) {\r\n        genericMenuEvent = {\r\n            eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.GenericMenuSelect,\r\n            actor: gm.getPlayer(),\r\n            playerInitiated: true,\r\n            endsTurn: false\r\n        };\r\n        return genericMenuEvent;\r\n    }\r\n    else {\r\n        return inputError(\"generic menu - unknown keypress\");\r\n    }\r\n}\r\nfunction targetingInputHandler(gm, data, envelope) {\r\n    let tgtEvent;\r\n    let lastEvent = gm.getLastEvent();\r\n    if (data.source == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewInputSource.Keyboard) {\r\n        let keycode = data.code;\r\n        if (_brew__WEBPACK_IMPORTED_MODULE_0__[\"KeyMap\"].MovementKeys.indexOf(keycode) > -1) {\r\n            // move target\r\n            let offset_xy = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].getDirectionFromKeycode(keycode);\r\n            let current_target_xy = lastEvent.targetingData.to_xy.clone();\r\n            let new_target_xy = current_target_xy.add(offset_xy);\r\n            if (!(gm.getCurrentLevel().isValid(new_target_xy))) {\r\n                return inputError(\"can't move target over there\");\r\n            }\r\n            // new move event\r\n            tgtEvent = {\r\n                eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.TargetingMove,\r\n                actor: gm.getPlayer(),\r\n                playerInitiated: true,\r\n                endsTurn: false,\r\n                offsetData: {\r\n                    offset_xy: offset_xy\r\n                }\r\n            };\r\n            // copy targeting data over from last event\r\n            tgtEvent.targetingData = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].clone(lastEvent.targetingData);\r\n            tgtEvent.targetingData.to_xy = lastEvent.targetingData.to_xy.clone();\r\n            tgtEvent.targetingData.from_xy = lastEvent.targetingData.from_xy.clone();\r\n        }\r\n        else if ((_brew__WEBPACK_IMPORTED_MODULE_0__[\"KeyMap\"].Action.indexOf(keycode) > -1) || (_brew__WEBPACK_IMPORTED_MODULE_0__[\"KeyMap\"].Examine.indexOf(keycode) > -1) || (_brew__WEBPACK_IMPORTED_MODULE_0__[\"KeyMap\"].HotKeys.indexOf(keycode) > -1)) {\r\n            // todo: make this trigger the actual thing we are targeting for\r\n            // finish targeting\r\n            tgtEvent = {\r\n                eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.TargetingFinish,\r\n                actor: gm.getPlayer(),\r\n                playerInitiated: true,\r\n                endsTurn: false\r\n            };\r\n            // copy targeting data over from last event\r\n            tgtEvent.targetingData = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].clone(gm.getLastEvent().targetingData);\r\n        }\r\n        else {\r\n            // cancel it\r\n            tgtEvent = {\r\n                eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.TargetingCancel,\r\n                actor: gm.getPlayer(),\r\n                playerInitiated: true,\r\n                endsTurn: false\r\n            };\r\n        }\r\n    }\r\n    else if (data.source == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewInputSource.Mouse) {\r\n        let screen_xy = getScreenCoordsFromMouseEvent(gm, data);\r\n        if (!(screen_xy)) {\r\n            return inputError(\"click outside of screen\");\r\n        }\r\n        let map_xy = gm.display.convertScreenToMap(screen_xy);\r\n        if (data.jsevent.type == \"mousedown\") {\r\n            // finish targeting\r\n            tgtEvent = {\r\n                eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.TargetingFinish,\r\n                actor: gm.getPlayer(),\r\n                playerInitiated: true,\r\n                endsTurn: false\r\n            };\r\n            // copy targeting data over from last event\r\n            tgtEvent.targetingData = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].clone(gm.getLastEvent().targetingData);\r\n        }\r\n        else if (data.jsevent.type == \"mousemove\") {\r\n            let current_target_xy = lastEvent.targetingData.to_xy.clone();\r\n            let new_target_xy = map_xy;\r\n            // new move event\r\n            tgtEvent = {\r\n                eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.TargetingMove,\r\n                actor: gm.getPlayer(),\r\n                playerInitiated: true,\r\n                endsTurn: false,\r\n                offsetData: {\r\n                    offset_xy: map_xy.subtract(current_target_xy)\r\n                }\r\n            };\r\n            // copy targeting data over from last event\r\n            tgtEvent.targetingData = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].clone(lastEvent.targetingData);\r\n            tgtEvent.targetingData.to_xy = lastEvent.targetingData.to_xy.clone();\r\n            tgtEvent.targetingData.from_xy = lastEvent.targetingData.from_xy.clone();\r\n        }\r\n    }\r\n    return tgtEvent;\r\n}\r\nfunction mainInputHandler(gm, data, envelope) {\r\n    let playerEvent;\r\n    if (data.source == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewInputSource.Keyboard) {\r\n        playerEvent = translateKeyboardInputIntoEvent(gm, data, envelope);\r\n    }\r\n    else if (data.source == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewInputSource.Mouse) {\r\n        playerEvent = translateMouseInputIntoEvent(gm, data, envelope);\r\n    }\r\n    else {\r\n        console.error(\"unexpected input type\");\r\n    }\r\n    return playerEvent;\r\n}\r\nfunction translateKeyboardInputIntoEvent(gm, data, envelope) {\r\n    let ev;\r\n    ev = {\r\n        eventType: null,\r\n        actor: gm.getPlayer(),\r\n        playerInitiated: true\r\n    };\r\n    let keycode = data.code;\r\n    if (_brew__WEBPACK_IMPORTED_MODULE_0__[\"KeyMap\"].DirectionalMovementKeys.indexOf(keycode) > -1) {\r\n        return inputDirectionalMovement(gm, keycode);\r\n    }\r\n    else if (_brew__WEBPACK_IMPORTED_MODULE_0__[\"KeyMap\"].RotationalMovementKeys.indexOf(keycode) > -1) {\r\n        return inputRotationalMovement(gm, keycode);\r\n    }\r\n    else if (_brew__WEBPACK_IMPORTED_MODULE_0__[\"KeyMap\"].RotationalWeaponKeys.indexOf(keycode) > -1) {\r\n        return inputRotationalWeapon(gm, keycode);\r\n    }\r\n    else if (_brew__WEBPACK_IMPORTED_MODULE_0__[\"KeyMap\"].Help.indexOf(keycode) > -1) {\r\n        return inputHelp(gm);\r\n    }\r\n    else if (_brew__WEBPACK_IMPORTED_MODULE_0__[\"KeyMap\"].Action.indexOf(keycode) > -1) {\r\n        return inputAction(gm, keycode);\r\n    }\r\n    else if (_brew__WEBPACK_IMPORTED_MODULE_0__[\"KeyMap\"].Examine.indexOf(keycode) > -1) {\r\n        return inputExamine(gm, keycode);\r\n    }\r\n    else if (_brew__WEBPACK_IMPORTED_MODULE_0__[\"KeyMap\"].HeadsUp.indexOf(keycode) > -1) {\r\n        return inputHeadsUp(gm, keycode);\r\n    }\r\n    else if (_brew__WEBPACK_IMPORTED_MODULE_0__[\"KeyMap\"].DebugFOV.indexOf(keycode) > -1) {\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"Debug\"].toggleFOV(gm);\r\n        // } else if (Brew.KeyMap.DebugPaths.indexOf(keycode) > -1) {\r\n        //     Brew.Debug.togglePathmap(gm, null)\r\n    }\r\n    else if (_brew__WEBPACK_IMPORTED_MODULE_0__[\"KeyMap\"].Inventory.indexOf(keycode) > -1) {\r\n        return inputInventory(gm, keycode);\r\n    }\r\n    else if (_brew__WEBPACK_IMPORTED_MODULE_0__[\"KeyMap\"].Menu.indexOf(keycode) > -1) {\r\n        return inputPowerMenu(gm, keycode);\r\n    }\r\n    else if (_brew__WEBPACK_IMPORTED_MODULE_0__[\"KeyMap\"].HotKeys.indexOf(keycode) > -1) {\r\n        return inputHotkey(gm, keycode, keycode - 49);\r\n    }\r\n    else if (_brew__WEBPACK_IMPORTED_MODULE_0__[\"KeyMap\"].DebugMenu.indexOf(keycode) > -1) {\r\n        return inputDebugMenu(gm, keycode);\r\n    }\r\n    else if (_brew__WEBPACK_IMPORTED_MODULE_0__[\"KeyMap\"].BossMode.indexOf(keycode) > -1) {\r\n        return inputBossMode(gm, keycode);\r\n    }\r\n    else if (_brew__WEBPACK_IMPORTED_MODULE_0__[\"KeyMap\"].ScreenSizeControl.indexOf(keycode) > -1) {\r\n        return inputScreenResize(gm, keycode);\r\n    }\r\n    return inputError(\"\");\r\n}\r\nfunction inputRotationalMovement(gm, keycode) {\r\n    let player = gm.getPlayer();\r\n    let new_facing_dir_xy = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Tank\"].getRotatedFacingDirectionFromKeycode(player.facing_direction, keycode);\r\n    // player.facing_direction = new_facing_dir_xy\r\n    let rotateEvent = {\r\n        eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.RotateBody,\r\n        actor: gm.getPlayer(),\r\n        playerInitiated: true,\r\n        endsTurn: true,\r\n        rotateData: {\r\n            old_facing_xy: player.facing_direction.clone(),\r\n            new_facing_xy: new_facing_dir_xy\r\n        }\r\n    };\r\n    return rotateEvent;\r\n}\r\nfunction inputRotationalWeapon(gm, keycode) {\r\n    let player = gm.getPlayer();\r\n    let turretPower = player.getPowers().getPowerOfType(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewPowerType.TurretCannon);\r\n    let new_facing_dir_xy = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Tank\"].getRotatedFacingDirectionFromKeycode(turretPower.facing_direction, keycode);\r\n    // player.facing_direction = new_facing_dir_xy\r\n    let moveEvent = {\r\n        eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.RotateWeapon,\r\n        actor: gm.getPlayer(),\r\n        playerInitiated: true,\r\n        endsTurn: true,\r\n        rotateData: {\r\n            old_facing_xy: player.facing_direction.clone(),\r\n            new_facing_xy: new_facing_dir_xy,\r\n            weaponPower: turretPower\r\n        }\r\n    };\r\n    return moveEvent;\r\n}\r\nfunction inputDirectionalMovement(gm, keycode) {\r\n    let level = gm.getCurrentLevel();\r\n    // determine offset\r\n    // let offset_xy : Brew.Coordinate = Brew.Utils.getDirectionFromKeycode(keycode)\r\n    let offset_xy = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Tank\"].getDirectionFromKeycode(gm.getPlayer(), keycode);\r\n    if (!(offset_xy)) {\r\n        return inputError(\"invalid movement key - no direction\");\r\n    }\r\n    // check whats over there\r\n    let new_xy = gm.getPlayer().location.add(offset_xy);\r\n    if (!(level.isValid(new_xy))) {\r\n        return inputError(\"You can't go there\");\r\n    }\r\n    // let t: Brew.Terrain = level.terrain.getAt(new_xy)\r\n    if (!(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Movement\"].canMoveToLocation(gm, gm.getPlayer(), new_xy))) {\r\n        return inputError(\"You can't go to there\");\r\n    }\r\n    let old_xy = gm.getPlayer().location.clone();\r\n    let m = level.monsters.getAt(new_xy);\r\n    if (m) {\r\n        return playerMeleeAttack(gm, m);\r\n    }\r\n    // move event\r\n    let moveEvent = {\r\n        eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.Move,\r\n        actor: gm.getPlayer(),\r\n        playerInitiated: true,\r\n        endsTurn: true,\r\n        moveData: {\r\n            from_xy: old_xy,\r\n            to_xy: new_xy\r\n        }\r\n    };\r\n    return moveEvent;\r\n}\r\nfunction playerMeleeAttack(gm, target) {\r\n    let player = gm.getPlayer();\r\n    let level = gm.getCurrentLevel();\r\n    let player_damage = 1;\r\n    let attack_type = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.Attack;\r\n    // check for wall smashing\r\n    // let can_wallsmash = Brew.Combat.checkForWallSmash(gm, player, target)\r\n    // if (can_wallsmash) {\r\n    //     attack_type = Brew.Enums.BrewEventType.SmashAttack\r\n    //     player_damage = 2\r\n    // }\r\n    let attackEvent = {\r\n        eventType: attack_type,\r\n        actor: gm.getPlayer(),\r\n        playerInitiated: true,\r\n        endsTurn: true,\r\n        attackData: {\r\n            from_xy: gm.getPlayer().location,\r\n            to_xy: target.location,\r\n            target: target,\r\n            isMelee: true,\r\n            damage: player_damage\r\n        }\r\n    };\r\n    attackEvent = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Combat\"].possiblyConvertAttackToSmashAttack(gm, attackEvent);\r\n    return attackEvent;\r\n}\r\nfunction inputAction(gm, keycode) {\r\n    // pickup / rest\r\n    // lets see whats here\r\n    let level = gm.getCurrentLevel();\r\n    let player = gm.getPlayer();\r\n    let item_here = level.items.getAt(player.location);\r\n    // if the item here is a power system then it is a special case\r\n    let system_item_here = null;\r\n    if ((item_here) && (item_here.isType(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].ItemType.PowerSystem))) {\r\n        system_item_here = item_here;\r\n        item_here = null;\r\n    }\r\n    let portal_here = level.portals.getAt(player.location);\r\n    let monster_nearby;\r\n    // find out if there is a monster nearby\r\n    monster_nearby = false;\r\n    player.knowledge.getAllThings().forEach((thingy, index, array) => {\r\n        if ((thingy instanceof _brew__WEBPACK_IMPORTED_MODULE_0__[\"GridThings\"].Monster) && (!(thingy.isSameThing(player))) && (_brew__WEBPACK_IMPORTED_MODULE_0__[\"Intel\"].isEnemy(player, thingy))) {\r\n            monster_nearby = true;\r\n        }\r\n    });\r\n    if (monster_nearby) {\r\n        gm.display.drawPopupMessage(\"Waiting - enemy in range\", player.location, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].violet);\r\n        return _brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].createGenericEventOfType(gm, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.Wait, true);\r\n    }\r\n    // build up a list of options and then show a menu only if we need to\r\n    let menu_entries = [];\r\n    if (portal_here) {\r\n        // menu_entries.push({\r\n        //     entryType: Brew.Enums.GenericMenuEntryType.EventBased,\r\n        //     entryEvent: Brew.Events.addDataToEvent(Brew.Events.createGenericEventOfType(gm, Brew.Enums.BrewEventType.UsePortal), {portalData: {portal_used: portal_here}})\r\n        // })\r\n        return _brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].addDataToEvent(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].createGenericEventOfType(gm, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.UsePortal), { portalData: { portal_used: portal_here } });\r\n    }\r\n    let can_pickup = player.inventory.hasCapacity();\r\n    if (item_here && (!(can_pickup))) {\r\n        gm.display.drawPopupMessage(\"Inventory is full!\", player.location, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].violet);\r\n    }\r\n    if (item_here && can_pickup && item_here.canPickup) {\r\n        // menu_entries.push({\r\n        //     entryType: Brew.Enums.GenericMenuEntryType.EventBased,\r\n        //     entryEvent: {\r\n        //         eventType: Brew.Enums.BrewEventType.Pickup,\r\n        //         actor: player,\r\n        //         playerInitiated: true,\r\n        //         endsTurn: true,\r\n        //             itemData: {\r\n        //                 item: item_here\r\n        //         }\r\n        //     }\r\n        // })\r\n        return {\r\n            eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.Pickup,\r\n            actor: player,\r\n            playerInitiated: true,\r\n            endsTurn: true,\r\n            itemData: {\r\n                item: item_here\r\n            }\r\n        };\r\n    }\r\n    // if (item_here && item_here.canHeave) {\r\n    //     let heaveEvent = Brew.Events.createGenericEventOfType(gm, Brew.Enums.BrewEventType.TargetingOn, false)\r\n    //     heaveEvent.itemData = {\r\n    //         item: item_here\r\n    //     }\r\n    //     heaveEvent.startTargetingData = {\r\n    //         from_xy: player.location,\r\n    //         to_xy: player.location,\r\n    //         targetingAction: Brew.Enums.BrewTargetingAction.HeaveItem\r\n    //     }\r\n    //     menu_entries.push({\r\n    //         entryName: \"Heave\",\r\n    //         entryDescription: \"Dramatically heave this wreckage into another target\",\r\n    //         entryType: Brew.Enums.GenericMenuEntryType.EventBased,\r\n    //         entryEvent: heaveEvent\r\n    //     })\r\n    // }\r\n    // // handle powers/systems\r\n    // if (system_item_here) {\r\n    //     menu_entries.push({\r\n    //         entryType: Brew.Enums.GenericMenuEntryType.EventBased,\r\n    //         entryName: \"Install this Power\",\r\n    //         entryDescription: \"Brings up the power installation menu - will prompt you to swap out an existing power.\",\r\n    //         entryEvent: {\r\n    //             eventType: Brew.Enums.BrewEventType.PowerInstallPromptOn,\r\n    //             actor: player,\r\n    //             playerInitiated: true,\r\n    //             endsTurn: false,\r\n    //             powerData: {\r\n    //                 power: system_item_here.power\r\n    //             }\r\n    //         }\r\n    //     })\r\n    // }\r\n    return _brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].createGenericEventOfType(gm, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.Wait, true);\r\n    // put together a menu if we need to, or just generate the most obvious event action\r\n    // let finalEvent : Brew.Enums.IBrewEvent\r\n    // let waitEvent = Brew.Events.createGenericEventOfType(gm, Brew.Enums.BrewEventType.Wait, true)\r\n    // // console.log(\"monster nearby?\", monster_nearby)\r\n    // if (menu_entries.length == 0) {\r\n    //     finalEvent = waitEvent\r\n    // } else if ((menu_entries.length == 1) && (!(monster_nearby))) {    \r\n    //     finalEvent = menu_entries[0].entryEvent\r\n    // } else {\r\n    //     let menuEvent = Brew.Events.createGenericEventOfType(gm, Brew.Enums.BrewEventType.GenericMenuOn)\r\n    //     menu_entries.push({\r\n    //         entryType: Brew.Enums.GenericMenuEntryType.EventBased,\r\n    //         entryDescription: \"Rest (ends your turn)\",\r\n    //         entryEvent: waitEvent\r\n    //     })\r\n    //     menu_entries.unshift({\r\n    //         entryType: Brew.Enums.GenericMenuEntryType.Cancel,\r\n    //         entryEvent: Brew.Events.createGenericEventOfType(gm, Brew.Enums.BrewEventType.GenericMenuOff)\r\n    //     })\r\n    //     menuEvent.genericMenuData = {\r\n    //         menuTitle: \"Ambiguous Input\",\r\n    //         menuDescription: \"There are multiple actions you may be trying to take and there is an enemy near by, confirm your action.\",\r\n    //         allowCancel: true,\r\n    //         menuEntriesList: menu_entries\r\n    //     }\r\n    //     finalEvent = menuEvent\r\n    // }\r\n    // return finalEvent\r\n}\r\nfunction inputExamine(gm, keycode) {\r\n    let examineEvent = {\r\n        eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.TargetingOn,\r\n        actor: gm.getPlayer(),\r\n        playerInitiated: true,\r\n        endsTurn: false,\r\n        startTargetingData: {\r\n            from_xy: gm.getPlayer().location,\r\n            to_xy: gm.getPlayer().location,\r\n            targetingAction: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewTargetingAction.Examine\r\n        }\r\n    };\r\n    return examineEvent;\r\n}\r\nfunction inputHeadsUp(gm, keycode) {\r\n    let notes = _brew__WEBPACK_IMPORTED_MODULE_0__[\"HUD\"].getCurrentNotes(gm);\r\n    let note_pages = _brew__WEBPACK_IMPORTED_MODULE_0__[\"HUD\"].getHUDPages(gm, notes);\r\n    let hudEvent = {\r\n        eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.HeadsUpDisplayOn,\r\n        actor: gm.getPlayer(),\r\n        playerInitiated: true,\r\n        endsTurn: false,\r\n        headsUpData: {\r\n            selected_index: 0,\r\n            headsUpDisplayNotePages: note_pages\r\n        }\r\n    };\r\n    return hudEvent;\r\n}\r\nfunction inputHotkey(gm, keycode, hotkey) {\r\n    let player = gm.getPlayer();\r\n    let validPower = player.getPowers().getPowerByIndex(hotkey);\r\n    if (!(validPower)) {\r\n        return inputError(\"hotkey not assigned to a valid power\");\r\n    }\r\n    // if its empty and not already activated, no dice\r\n    if (validPower.charge_stat.isEmpty() && (!(validPower.activated))) {\r\n        return inputError(\"Not enough charges on that power\");\r\n    }\r\n    let powerEvent = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Powers\"].triggerPower(gm, player, validPower);\r\n    return powerEvent;\r\n}\r\nfunction inputInventory(gm, keycode) {\r\n    let invEvent = {\r\n        eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.InventoryOn,\r\n        actor: gm.getPlayer(),\r\n        playerInitiated: true,\r\n        endsTurn: false,\r\n        inventoryData: {\r\n            inventory: gm.getPlayer().inventory\r\n        }\r\n    };\r\n    return invEvent;\r\n}\r\nfunction inputPowerMenu(gm, keycode) {\r\n    let player = gm.getPlayer();\r\n    let power_entries = [];\r\n    let powers = player.getPowers();\r\n    power_entries = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Menus\"].getMenuData_Entries_for_Powers(gm, player, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.PowerMenuOn, false);\r\n    let menuEvent = {\r\n        eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.GenericMenuOn,\r\n        actor: gm.getPlayer(),\r\n        playerInitiated: true,\r\n        endsTurn: false,\r\n        genericMenuData: {\r\n            menuTitle: \"Active Powers\",\r\n            allowCancel: true,\r\n            menuEntriesList: power_entries\r\n        },\r\n    };\r\n    return menuEvent;\r\n}\r\nfunction inputDebugMenu(gm, keycode) {\r\n    let player = gm.getPlayer();\r\n    let menu_entries = [];\r\n    let powers = player.getPowers();\r\n    menu_entries.push({\r\n        entryName: \"Create Mob\",\r\n        entryType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].GenericMenuEntryType.EventBased,\r\n        entryEvent: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].createGenericEventOfType(gm, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.DebugCreateMobMenuOn, false)\r\n    });\r\n    menu_entries.push({\r\n        entryName: \"Create Feature\",\r\n        entryType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].GenericMenuEntryType.EventBased,\r\n        entryEvent: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].createGenericEventOfType(gm, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.DebugCreateFeatureMenuOn, false)\r\n    });\r\n    menu_entries.push({\r\n        entryName: \"Create Terrain\",\r\n        entryType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].GenericMenuEntryType.EventBased,\r\n        entryEvent: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].createGenericEventOfType(gm, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.DebugCreateTerrainMenuOn, false)\r\n    });\r\n    let menuEvent = {\r\n        eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.GenericMenuOn,\r\n        actor: gm.getPlayer(),\r\n        playerInitiated: true,\r\n        endsTurn: false,\r\n        genericMenuData: {\r\n            menuTitle: \"Debug\",\r\n            allowCancel: true,\r\n            menuEntriesList: menu_entries\r\n        }\r\n    };\r\n    return menuEvent;\r\n}\r\nfunction getScreenCoordsFromMouseEvent(gm, data) {\r\n    // use ROT to translate on screen coords\r\n    let rot_coords;\r\n    rot_coords = gm.display.getDisplay(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].DisplayNames.Game).eventToPosition(data.jsevent);\r\n    if (rot_coords[0] == -1) {\r\n        return null;\r\n    }\r\n    let screen_xy = new _brew__WEBPACK_IMPORTED_MODULE_0__[\"Coordinate\"](rot_coords[0], rot_coords[1]);\r\n    return screen_xy;\r\n}\r\nfunction translateMouseInputIntoEvent(gm, data, envelope) {\r\n    let screen_xy = getScreenCoordsFromMouseEvent(gm, data);\r\n    if (!(screen_xy)) {\r\n        return inputError(\"click outside of screen\");\r\n    }\r\n    let map_xy = gm.display.convertScreenToMap(screen_xy);\r\n    if (data.jsevent.type != \"mousedown\") {\r\n        return inputHover(gm, map_xy);\r\n    }\r\n    if (data.button == 0) {\r\n        // regular click\r\n        // return inputClick(gm, map_xy)\r\n        return inputError(\"temporarily disabled clicking\");\r\n    }\r\n    else {\r\n        // return inputAltClick(gm, data, map_xy)\r\n        return inputError(\"no alt clicking allowed\");\r\n    }\r\n}\r\nfunction inputHover(gm, map_xy) {\r\n    let infoEvent = {\r\n        eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.Info,\r\n        actor: gm.getPlayer(),\r\n        playerInitiated: true,\r\n        endsTurn: false,\r\n        moveData: {\r\n            from_xy: map_xy,\r\n            to_xy: map_xy\r\n        }\r\n    };\r\n    return infoEvent;\r\n}\r\nfunction inputClick(gm, map_xy) {\r\n    let specialEvent = {\r\n        eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.Special,\r\n        actor: gm.getPlayer(),\r\n        playerInitiated: true,\r\n        endsTurn: true,\r\n        moveData: {\r\n            from_xy: null,\r\n            to_xy: map_xy\r\n        }\r\n    };\r\n    return specialEvent;\r\n}\r\nfunction inputBossMode(gm, keycode) {\r\n    _brew__WEBPACK_IMPORTED_MODULE_0__[\"Debug\"].toggleBackgroundCover(gm);\r\n    return inputError(\"ok\");\r\n}\r\nfunction inputScreenResize(gm, keycode) {\r\n    let font_size = gm.display.getDisplay(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].DisplayNames.Game).getOptions().fontSize;\r\n    let new_font_size;\r\n    if (_brew__WEBPACK_IMPORTED_MODULE_0__[\"KeyMap\"].ScreenEnlarge.indexOf(keycode) > -1) {\r\n        new_font_size = font_size + 2;\r\n    }\r\n    else {\r\n        new_font_size = font_size - 2;\r\n    }\r\n    for (let disp of [_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].DisplayNames.Game, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].DisplayNames.HUD, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].DisplayNames.Footer, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].DisplayNames.Header]) {\r\n        gm.display.getDisplay(disp).setOptions({ fontSize: new_font_size });\r\n    }\r\n    gm.display.drawAll({});\r\n    return inputError(\"ok\");\r\n}\r\nfunction inputHelp(gm) {\r\n    let helpEvent = {\r\n        eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.HelpOn,\r\n        actor: gm.getPlayer(),\r\n        playerInitiated: true,\r\n        endsTurn: false,\r\n        helpData: {\r\n            selected_index: 0\r\n        }\r\n    };\r\n    return helpEvent;\r\n}\r\nfunction helpMenuHandler(gm, brEvent) {\r\n    let keycode = brEvent.code;\r\n    let helpEvent;\r\n    let prevMenuEvent = gm.getLastEvent();\r\n    if ((_brew__WEBPACK_IMPORTED_MODULE_0__[\"KeyMap\"].Escape.indexOf(keycode) > -1) || (_brew__WEBPACK_IMPORTED_MODULE_0__[\"KeyMap\"].Action.indexOf(keycode) > -1) || (_brew__WEBPACK_IMPORTED_MODULE_0__[\"KeyMap\"].Help.indexOf(keycode) > -1)) {\r\n        return _brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].createGenericEventOfType(gm, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.GenericMenuOff, false);\r\n    }\r\n    else if (_brew__WEBPACK_IMPORTED_MODULE_0__[\"KeyMap\"].MovementKeys.indexOf(keycode) > -1) {\r\n        let cycle_dir = getCycleIncrementValueFromKeypress(keycode);\r\n        let new_page_index = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].mod(prevMenuEvent.helpData.selected_index + cycle_dir, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Tank\"].helpMessages.length);\r\n        // console.log(new_page_index, prevMenuEvent.headsUpData.headsUpDisplayNotePages.length)\r\n        helpEvent = {\r\n            eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.HelpOn,\r\n            actor: gm.getPlayer(),\r\n            playerInitiated: true,\r\n            endsTurn: false,\r\n            helpData: {\r\n                // headsUpDisplayNotePages: prevMenuEvent.headsUpData.headsUpDisplayNotePages,\r\n                selected_index: new_page_index,\r\n            }\r\n        };\r\n        return helpEvent;\r\n    }\r\n    else {\r\n        return inputError(\"help menu - unknown keypress\");\r\n    }\r\n}\r\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvYnJld19lbmdpbmUvaW5wdXQudHM/OWU1YyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFBK0I7QUFFL0Isb0JBQW9CLFFBQWdCO0lBQ2hDLE1BQU0sQ0FBQztRQUNILFNBQVMsRUFBRSwyQ0FBVSxDQUFDLGFBQWEsQ0FBQyxLQUFLO1FBQ3pDLEtBQUssRUFBRSxJQUFJO1FBQ1gsZUFBZSxFQUFFLElBQUk7UUFDckIsUUFBUSxFQUFFLEtBQUs7UUFDZixRQUFRLEVBQUUsUUFBUTtLQUNyQjtBQUNMLENBQUM7QUFFRCxnQ0FBZ0M7QUFDMUIsd0JBQXlCLEVBQW1CLEVBQUUsSUFBK0IsRUFBRSxRQUFRO0lBRXpGLElBQUksT0FBK0I7SUFFbkMsdUJBQXVCO0lBQ3ZCLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxhQUFhLElBQUksMkNBQVUsQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztRQUNuRCxPQUFPLEdBQUcsZ0JBQWdCLENBQUMsRUFBRSxFQUFFLElBQUksRUFBRSxRQUFRLENBQUM7UUFFbEQsb0JBQW9CO0lBQ3BCLENBQUM7SUFBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLGFBQWEsSUFBSSwyQ0FBVSxDQUFDLFlBQVksQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDO1FBQy9ELE9BQU8sR0FBRyxxQkFBcUIsQ0FBQyxFQUFFLEVBQUUsSUFBSSxFQUFFLFFBQVEsQ0FBQztRQUV2RCx1QkFBdUI7SUFDdkIsQ0FBQztJQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsYUFBYSxJQUFJLDJDQUFVLENBQUMsWUFBWSxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUM7UUFDakUsT0FBTyxHQUFHLGtCQUFrQixDQUFDLEVBQUUsRUFBRSxJQUFJLENBQUM7SUFFMUMsQ0FBQztJQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsYUFBYSxJQUFJLDJDQUFV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QUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ3ZJLE1BQU0sQ0FBQyw0Q0FBVyxDQUFDLHdCQUF3QixDQUFDLEVBQUUsRUFBRSwyQ0FBVSxDQUFDLGFBQWEsQ0FBQyxjQUFjLEVBQUUsS0FBSyxDQUFDO0lBRW5HLENBQUM7SUFBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsNENBQVcsQ0FBQyxZQUFZLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUN4RCxJQUFJLFNBQVMsR0FBRyxrQ0FBa0MsQ0FBQyxPQUFPLENBQUM7UUFDM0QsSUFBSSxjQUFjLEdBQUcsMkNBQVUsQ0FBQyxHQUFHLENBQUMsYUFBYSxDQUFDLFFBQVEsQ0FBQyxjQUFjLEdBQUcsU0FBUyxFQUFFLDBDQUFTLENBQUMsWUFBWSxDQUFDLE1BQU0sQ0FBQztRQUNySCx3RkFBd0Y7UUFDeEYsU0FBUyxHQUFHO1lBQ1IsU0FBUyxFQUFFLDJDQUFVLENBQUMsYUFBYSxDQUFDLE1BQU07WUFDMUMsS0FBSyxFQUFFLEVBQUUsQ0FBQyxTQUFTLEVBQUU7WUFDckIsZUFBZSxFQUFFLElBQUk7WUFDckIsUUFBUSxFQUFFLEtBQUs7WUFDZixRQUFRLEVBQUU7Z0JBQ04sOEVBQThFO2dCQUM5RSxjQUFjLEVBQUUsY0FBYzthQUNqQztTQUNKO1FBRUQsTUFBTSxDQUFDLFNBQVM7SUFFcEIsQ0FBQztJQUFDLElBQUksQ0FBQyxDQUFDO1FBRUosTUFBTSxDQUFDLFVBQVUsQ0FBQyw4QkFBOEIsQ0FBQztJQUNyRCxDQUFDO0FBQ0wsQ0FBQyIsImZpbGUiOiIuL3NyYy9icmV3X2VuZ2luZS9pbnB1dC50cy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIEJyZXcgZnJvbSBcIi4uL2JyZXdcIlxyXG5cclxuZnVuY3Rpb24gaW5wdXRFcnJvcihlcnJvck1zZzogc3RyaW5nKSA6IEJyZXcuRW51bXMuSUJyZXdFdmVudCB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIGV2ZW50VHlwZTogQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLkVycm9yLFxyXG4gICAgICAgIGFjdG9yOiBudWxsLFxyXG4gICAgICAgIHBsYXllckluaXRpYXRlZDogdHJ1ZSxcclxuICAgICAgICBlbmRzVHVybjogZmFsc2UsXHJcbiAgICAgICAgZXJyb3JNc2c6IGVycm9yTXNnXHJcbiAgICB9XHJcbn1cclxuICAgIFxyXG4vLyBjYWxsZWQgZnJvbSBwb3N0YWwuanMgY2hhbm5lbFxyXG5leHBvcnQgZnVuY3Rpb24gaGFuZGxlQWxsSW5wdXQoZ206IEJyZXcuR2FtZU1hc3RlciwgZGF0YTogQnJldy5FbnVtcy5JQnJld0lucHV0RGF0YSwgZW52ZWxvcGUpIHtcclxuICAgIFxyXG4gICAgbGV0IG15RXZlbnQgOiBCcmV3LkVudW1zLklCcmV3RXZlbnRcclxuICAgIFxyXG4gICAgLy8gZGVmYXVsdCBtYWluIGhhbmRsZXJcclxuICAgIGlmIChnbS5pbnB1dF9oYW5kbGVyID09IEJyZXcuRW51bXMuSW5wdXRIYW5kbGVyLk1haW4pIHtcclxuICAgICAgICBteUV2ZW50ID0gbWFpbklucHV0SGFuZGxlcihnbSwgZGF0YSwgZW52ZWxvcGUpXHJcbiAgICAgICAgXHJcbiAgICAvLyB0YXJnZXRpbmcgaGFuZGxlclxyXG4gICAgfSBlbHNlIGlmIChnbS5pbnB1dF9oYW5kbGVyID09IEJyZXcuRW51bXMuSW5wdXRIYW5kbGVyLlRhcmdldGluZykge1xyXG4gICAgICAgIG15RXZlbnQgPSB0YXJnZXRpbmdJbnB1dEhhbmRsZXIoZ20sIGRhdGEsIGVudmVsb3BlKVxyXG4gICAgICAgIFxyXG4gICAgLy8gZ2VuZXJpYyBtZW51IGhhbmRsZXJcclxuICAgIH0gZWxzZSBpZiAoZ20uaW5wdXRfaGFuZGxlciA9PSBCcmV3LkVudW1zLklucHV0SGFuZGxlci5HZW5lcmljTWVudSkge1xyXG4gICAgICAgIG15RXZlbnQgPSBnZW5lcmljTWVudUhhbmRsZXIoZ20sIGRhdGEpXHJcblxyXG4gICAgfSBlbHNlIGlmIChnbS5pbnB1dF9oYW5kbGVyID09IEJyZXcuRW51bXMuSW5wdXRIYW5kbGVyLldhaXRUb0Rpc21pc3MpIHtcclxuICAgICAgICBteUV2ZW50ID0gd2FpdFRvRGlzbWlzc0hhbmRsZXIoZ20sIGRhdGEpXHJcblxyXG4gICAgfSBlbHNlIGlmIChnbS5pbnB1dF9oYW5kbGVyID09IEJyZXcuRW51bXMuSW5wdXRIYW5kbGVyLkhlYWRzVXBEaXNwbGF5KSB7XHJcbiAgICAgICAgbXlFdmVudCA9IGhlYWRzVXBEaXNwbGF5SGFuZGxlcihnbSwgZGF0YSlcclxuXHJcbiAgICB9IGVsc2UgaWYgKGdtLmlucHV0X2hhbmRsZXIgPT0gQnJldy5FbnVtcy5JbnB1dEhhbmRsZXIuSGVscE1lbnUpIHtcclxuICAgICAgICBteUV2ZW50ID0gaGVscE1lbnVIYW5kbGVyKGdtLCBkYXRhKVxyXG5cclxuICAgIC8vIH0gZWxzZSBpZiAoZ20uaW5wdXRfaGFuZGxlciA9PSBCcmV3LkVudW1zLklucHV0SGFuZGxlci5XYWl0VG9SZXN0YXJ0KSB7XHJcbiAgICAvLyAgICAgbXlFdmVudCA9IHdhaXRUb1Jlc3RhcnRIYW5kbGVyKGdtLCBkYXRhLCBlbnZlbG9wZSlcclxuXHJcbiAgICB9IGVsc2UgaWYgKGdtLmlucHV0X2hhbmRsZXIgPT0gQnJldy5FbnVtcy5JbnB1dEhhbmRsZXIuQ29uZmlybVBhdGhzKSB7XHJcbiAgICAgICAgbXlFdmVudCA9IGNvbmZpcm1QYXRoc0hhbmRsZXIoZ20sIGRhdGEsIGVudmVsb3BlKVxyXG4gICAgICAgIFxyXG4gICAgICAgIFxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKGB1bmtub3duIGlucHV0IGhhbmRsZXIgJHtnbS5pbnB1dF9oYW5kbGVyfWApXHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIHBvc3QgdG8gZXZlbnRzIGNoYW5uZWwgaGVyZSA/XHJcbiAgICBnbS5jaGFubmVsX2V2ZW50LnB1Ymxpc2goXCJldmVudC5zdGFydFwiLCBteUV2ZW50KVxyXG59XHJcblxyXG4vLyBmdW5jdGlvbiB3YWl0VG9SZXN0YXJ0SGFuZGxlcihnbTogQnJldy5HYW1lTWFzdGVyLCBkYXRhOiBCcmV3LkVudW1zLklCcmV3SW5wdXREYXRhLCBlbnZlbG9wZSkgOiBCcmV3LkVudW1zLklCcmV3RXZlbnQge1xyXG4vLyAgICAgbGV0IGtleWNvZGUgPSBkYXRhLmNvZGVcclxuICAgIFxyXG5cclxuLy8gICAgIGlmIChLZXlNYXAuQWN0aW9uLmluZGV4T2Yoa2V5Y29kZSkgPiAtMSkge1xyXG4vLyAgICAgICAgIGxldCByZXNldEV2ZW50IDogQnJldy5FbnVtcy5JQnJld0V2ZW50ID0ge1xyXG4vLyAgICAgICAgICAgICBldmVudFR5cGU6IEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5SZXN0YXJ0R2FtZSxcclxuLy8gICAgICAgICAgICAgYWN0b3I6IGdtLmdldFBsYXllcigpLFxyXG4vLyAgICAgICAgICAgICBwbGF5ZXJJbml0aWF0ZWQ6IHRydWUsXHJcbi8vICAgICAgICAgICAgIGVuZHNUdXJuOiB0cnVlXHJcbi8vICAgICAgICAgfVxyXG5cclxuLy8gICAgICAgICByZXR1cm4gcmVzZXRFdmVudFxyXG4vLyAgICAgfSBlbHNlIHtcclxuLy8gICAgICAgICByZXR1cm4gaW5wdXRFcnJvcihcImdhbWUgb3ZlciAtIHByZXNzIEFDVElPTiB0byByZXN0YXJ0XCIpXHJcbi8vICAgICB9XHJcbi8vIH1cclxuXHJcbmZ1bmN0aW9uIHdhaXRUb0Rpc21pc3NIYW5kbGVyKGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGRhdGE6IEJyZXcuRW51bXMuSUJyZXdJbnB1dERhdGEpIDogQnJldy5FbnVtcy5JQnJld0V2ZW50IHtcclxuICAgIGxldCBrZXljb2RlID0gZGF0YS5jb2RlXHJcbiAgICBcclxuICAgIGlmICgoQnJldy5LZXlNYXAuRXNjYXBlLmluZGV4T2Yoa2V5Y29kZSkgPiAtMSkgfHwgKEJyZXcuS2V5TWFwLkFjdGlvbi5pbmRleE9mKGtleWNvZGUpID4gLTEpKSB7XHJcbiAgICAgICAgcmV0dXJuIEJyZXcuRXZlbnRzLmNyZWF0ZUdlbmVyaWNFdmVudE9mVHlwZShnbSwgQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLkdlbmVyaWNNZW51T2ZmLCBmYWxzZSlcclxuXHJcbiAgICB9IGVsc2Uge1xyXG5cclxuICAgICAgICByZXR1cm4gaW5wdXRFcnJvcihcIndhaXRpbmcgdG8gZGlzbWlzcyBmaXJzdFwiKVxyXG4gICAgfVxyXG5cclxufVxyXG5cclxuZnVuY3Rpb24gaGVhZHNVcERpc3BsYXlIYW5kbGVyKGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGJyRXZlbnQ6IEJyZXcuRW51bXMuSUJyZXdJbnB1dERhdGEpIDogQnJldy5FbnVtcy5JQnJld0V2ZW50IHtcclxuICAgIGxldCBrZXljb2RlID0gYnJFdmVudC5jb2RlXHJcbiAgICBsZXQgaHVkRXZlbnQgOiBCcmV3LkVudW1zLklCcmV3RXZlbnRcclxuICAgIGxldCBwcmV2TWVudUV2ZW50ID0gZ20uZ2V0TGFzdEV2ZW50KClcclxuXHJcbiAgICBpZiAoKEJyZXcuS2V5TWFwLkVzY2FwZS5pbmRleE9mKGtleWNvZGUpID4gLTEpIHx8IChCcmV3LktleU1hcC5BY3Rpb24uaW5kZXhPZihrZXljb2RlKSA+IC0xKSB8fCAoQnJldy5LZXlNYXAuSGVhZHNVcC5pbmRleE9mKGtleWNvZGUpID4gLTEpKSB7XHJcbiAgICAgICAgcmV0dXJuIEJyZXcuRXZlbnRzLmNyZWF0ZUdlbmVyaWNFdmVudE9mVHlwZShnbSwgQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLkdlbmVyaWNNZW51T2ZmLCBmYWxzZSlcclxuICAgIFxyXG4gICAgfSBlbHNlIGlmIChCcmV3LktleU1hcC5Nb3ZlbWVudEtleXMuaW5kZXhPZihrZXljb2RlKSA+IC0xKSB7XHJcbiAgICAgICAgbGV0IGN5Y2xlX2RpciA9IGdldEN5Y2xlSW5jcmVtZW50VmFsdWVGcm9tS2V5cHJlc3Moa2V5Y29kZSlcclxuICAgICAgICBsZXQgbmV3X3BhZ2VfaW5kZXggPSBCcmV3LlV0aWxzLm1vZChwcmV2TWVudUV2ZW50LmhlYWRzVXBEYXRhLnNlbGVjdGVkX2luZGV4ICsgY3ljbGVfZGlyLCBwcmV2TWVudUV2ZW50LmhlYWRzVXBEYXRhLmhlYWRzVXBEaXNwbGF5Tm90ZVBhZ2VzLmxlbmd0aClcclxuICAgICAgICBjb25zb2xlLmxvZyhuZXdfcGFnZV9pbmRleCwgcHJldk1lbnVFdmVudC5oZWFkc1VwRGF0YS5oZWFkc1VwRGlzcGxheU5vdGVQYWdlcy5sZW5ndGgpXHJcbiAgICAgICAgaHVkRXZlbnQgPSB7XHJcbiAgICAgICAgICAgIGV2ZW50VHlwZTogQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLkhlYWRzVXBEaXNwbGF5T24sXHJcbiAgICAgICAgICAgIGFjdG9yOiBnbS5nZXRQbGF5ZXIoKSxcclxuICAgICAgICAgICAgcGxheWVySW5pdGlhdGVkOiB0cnVlLFxyXG4gICAgICAgICAgICBlbmRzVHVybjogZmFsc2UsXHJcbiAgICAgICAgICAgIGhlYWRzVXBEYXRhOiB7XHJcbiAgICAgICAgICAgICAgICBoZWFkc1VwRGlzcGxheU5vdGVQYWdlczogcHJldk1lbnVFdmVudC5oZWFkc1VwRGF0YS5oZWFkc1VwRGlzcGxheU5vdGVQYWdlcyxcclxuICAgICAgICAgICAgICAgIHNlbGVjdGVkX2luZGV4OiBuZXdfcGFnZV9pbmRleCxcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gaHVkRXZlbnRcclxuICAgICAgICBcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIGlucHV0RXJyb3IoXCJnZW5lcmljIG1lbnUgLSB1bmtub3duIGtleXByZXNzXCIpXHJcbiAgICB9XHJcbn1cclxuXHJcblxyXG5mdW5jdGlvbiBjb25maXJtUGF0aHNIYW5kbGVyKGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGRhdGE6IEJyZXcuRW51bXMuSUJyZXdJbnB1dERhdGEsIGVudmVsb3BlKSA6IEJyZXcuRW51bXMuSUJyZXdFdmVudCB7XHJcbiAgICBsZXQga2V5Y29kZSA9IGRhdGEuY29kZVxyXG4gICAgbGV0IGNvbmZpcm1QYXRoc0V2ZW50IDogQnJldy5FbnVtcy5JQnJld0V2ZW50XHJcbiAgICBcclxuICAgIC8vIG1ha2Ugc3VyZSBwYXRoIHdhcyBhY3R1YWxseSB2YWxpZFxyXG4gICAgbGV0IGxhc3RFdmVudCA9IGdtLmdldExhc3RFdmVudCgpXHJcbiAgICBsZXQgdmFsaWRfcGF0aCA9IGxhc3RFdmVudC5jb25maXJtUGF0aHNEYXRhLnZhbGlkX3BhdGhcclxuXHJcbiAgICBpZiAoKEJyZXcuS2V5TWFwLkFjdGlvbi5pbmRleE9mKGtleWNvZGUpID4gLTEpICYmICh2YWxpZF9wYXRoKSkge1xyXG4gICAgICAgIGNvbmZpcm1QYXRoc0V2ZW50ID0gQnJldy5FdmVudHMuY3JlYXRlR2VuZXJpY0V2ZW50T2ZUeXBlKGdtLCBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuQ29uZmlybVBhdGhzRmluYWxpemUsIGZhbHNlKVxyXG5cclxuICAgIH0gZWxzZSB7XHJcblxyXG4gICAgICAgIGNvbmZpcm1QYXRoc0V2ZW50ID0gQnJldy5FdmVudHMuY3JlYXRlR2VuZXJpY0V2ZW50T2ZUeXBlKGdtLCBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuQ29uZmlybVBhdGhzQ2FuY2VsLCBmYWxzZSlcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gY29uZmlybVBhdGhzRXZlbnRcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0Q3ljbGVJbmNyZW1lbnRWYWx1ZUZyb21LZXlwcmVzcyhrZXljb2RlOiBudW1iZXIpIDogbnVtYmVyIHtcclxuICAgIC8vIHJldHVybiAxIG9yIC0xIGRlcGVuZGluZyBvbiB3aGljaCBrZXlzIHdlcmUgcHJlc3NlZCwgZm9yIG1lbnUvdG9nZ2xpbmdcclxuICAgIGxldCBjeWNsZV9kaXIgOiBudW1iZXJcclxuICAgICAgICBcclxuICAgIGxldCBvZmZzZXRfeHkgPSBCcmV3LlV0aWxzLmdldERpcmVjdGlvbkZyb21LZXljb2RlKGtleWNvZGUpXHJcbiAgICBcclxuICAgIGlmICgob2Zmc2V0X3h5LnggPCAwKSB8fCAob2Zmc2V0X3h5LnkgPCAwKSkge1xyXG4gICAgICAgIGN5Y2xlX2RpciA9IC0xXHJcbiAgICB9IGVsc2UgaWYgKChvZmZzZXRfeHkueCA+IDApIHx8IChvZmZzZXRfeHkueSA+IDApKSB7XHJcbiAgICAgICAgY3ljbGVfZGlyID0gMVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJTb21lIGtpbmQgb2Ygd2VpcmQgZGlyZWN0aW9uIHRoaW5neSBoYXBwZW5lZFwiKVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBjeWNsZV9kaXJcclxufVxyXG5cclxuZnVuY3Rpb24gZ2VuZXJpY01lbnVIYW5kbGVyKGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGJyRXZlbnQ6IEJyZXcuRW51bXMuSUJyZXdJbnB1dERhdGEpIDogQnJldy5FbnVtcy5JQnJld0V2ZW50IHtcclxuICAgIGxldCBrZXljb2RlID0gYnJFdmVudC5jb2RlXHJcbiAgICBsZXQgZ2VuZXJpY01lbnVFdmVudCA6IEJyZXcuRW51bXMuSUJyZXdFdmVudFxyXG4gICAgbGV0IHByZXZNZW51RXZlbnQgPSBnbS5nZXRMYXN0RXZlbnQoKVxyXG4gICAgbGV0IGFsbG93Q2FuY2VsID0gcHJldk1lbnVFdmVudC5nZW5lcmljTWVudURhdGEuYWxsb3dDYW5jZWxcclxuXHJcbiAgICBpZiAoKEJyZXcuS2V5TWFwLkVzY2FwZS5pbmRleE9mKGtleWNvZGUpID4gLTEpICYmIGFsbG93Q2FuY2VsKSB7XHJcbiAgICAgICAgZ2VuZXJpY01lbnVFdmVudCA9IHtcclxuICAgICAgICAgICAgZXZlbnRUeXBlOiBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuR2VuZXJpY01lbnVPZmYsXHJcbiAgICAgICAgICAgIGFjdG9yOiBnbS5nZXRQbGF5ZXIoKSxcclxuICAgICAgICAgICAgcGxheWVySW5pdGlhdGVkOiB0cnVlLFxyXG4gICAgICAgICAgICBlbmRzVHVybjogZmFsc2VcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIGdlbmVyaWNNZW51RXZlbnRcclxuICAgIFxyXG4gICAgfSBlbHNlIGlmIChCcmV3LktleU1hcC5Nb3ZlbWVudEtleXMuaW5kZXhPZihrZXljb2RlKSA+IC0xKSB7XHJcbiAgICAgICAgbGV0IGN5Y2xlX2RpciA9IGdldEN5Y2xlSW5jcmVtZW50VmFsdWVGcm9tS2V5cHJlc3Moa2V5Y29kZSlcclxuICAgICAgICBcclxuICAgICAgICBnZW5lcmljTWVudUV2ZW50ID0ge1xyXG4gICAgICAgICAgICBldmVudFR5cGU6IEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5HZW5lcmljTWVudU1vdmUsXHJcbiAgICAgICAgICAgIGFjdG9yOiBnbS5nZXRQbGF5ZXIoKSxcclxuICAgICAgICAgICAgcGxheWVySW5pdGlhdGVkOiB0cnVlLFxyXG4gICAgICAgICAgICBlbmRzVHVybjogZmFsc2UsXHJcbiAgICAgICAgICAgIGdlbmVyaWNNZW51RGF0YToge1xyXG4gICAgICAgICAgICAgICAgbWVudVRpdGxlOiBwcmV2TWVudUV2ZW50LmdlbmVyaWNNZW51RGF0YS5tZW51VGl0bGUsXHJcbiAgICAgICAgICAgICAgICBtZW51RGVzY3JpcHRpb246IHByZXZNZW51RXZlbnQuZ2VuZXJpY01lbnVEYXRhLm1lbnVEZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgIGFsbG93Q2FuY2VsOiBhbGxvd0NhbmNlbCxcclxuICAgICAgICAgICAgICAgIGRpcmVjdGlvbjogY3ljbGVfZGlyXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIGdlbmVyaWNNZW51RXZlbnRcclxuICAgICAgICBcclxuICAgIH0gZWxzZSBpZiAoQnJldy5LZXlNYXAuQWN0aW9uLmluZGV4T2Yoa2V5Y29kZSkgPiAtMSkge1xyXG4gICAgICAgIFxyXG4gICAgICAgIGdlbmVyaWNNZW51RXZlbnQgPSB7XHJcbiAgICAgICAgICAgIGV2ZW50VHlwZTogQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLkdlbmVyaWNNZW51U2VsZWN0LFxyXG4gICAgICAgICAgICBhY3RvcjogZ20uZ2V0UGxheWVyKCksXHJcbiAgICAgICAgICAgIHBsYXllckluaXRpYXRlZDogdHJ1ZSxcclxuICAgICAgICAgICAgZW5kc1R1cm46IGZhbHNlXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBnZW5lcmljTWVudUV2ZW50XHJcbiAgICAgICAgXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiBpbnB1dEVycm9yKFwiZ2VuZXJpYyBtZW51IC0gdW5rbm93biBrZXlwcmVzc1wiKVxyXG4gICAgICAgICAgICBcclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gdGFyZ2V0aW5nSW5wdXRIYW5kbGVyKGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGRhdGE6IEJyZXcuRW51bXMuSUJyZXdJbnB1dERhdGEsIGVudmVsb3BlKSA6IEJyZXcuRW51bXMuSUJyZXdFdmVudCB7XHJcbiAgICBcclxuICAgIGxldCB0Z3RFdmVudCA6IEJyZXcuRW51bXMuSUJyZXdFdmVudFxyXG4gICAgbGV0IGxhc3RFdmVudCA9IGdtLmdldExhc3RFdmVudCgpXHJcbiAgICBcclxuICAgIGlmIChkYXRhLnNvdXJjZSA9PSBCcmV3LkVudW1zLkJyZXdJbnB1dFNvdXJjZS5LZXlib2FyZCkge1xyXG4gICAgICAgIGxldCBrZXljb2RlID0gZGF0YS5jb2RlXHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKEJyZXcuS2V5TWFwLk1vdmVtZW50S2V5cy5pbmRleE9mKGtleWNvZGUpID4gLTEpIHtcclxuXHJcbiAgICAgICAgICAgIC8vIG1vdmUgdGFyZ2V0XHJcbiAgICAgICAgICAgIGxldCBvZmZzZXRfeHkgOiBCcmV3LkNvb3JkaW5hdGUgPSBCcmV3LlV0aWxzLmdldERpcmVjdGlvbkZyb21LZXljb2RlKGtleWNvZGUpXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBsZXQgY3VycmVudF90YXJnZXRfeHkgPSBsYXN0RXZlbnQudGFyZ2V0aW5nRGF0YS50b194eS5jbG9uZSgpXHJcbiAgICAgICAgICAgIGxldCBuZXdfdGFyZ2V0X3h5ID0gY3VycmVudF90YXJnZXRfeHkuYWRkKG9mZnNldF94eSlcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGlmICghKGdtLmdldEN1cnJlbnRMZXZlbCgpLmlzVmFsaWQobmV3X3RhcmdldF94eSkpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaW5wdXRFcnJvcihcImNhbid0IG1vdmUgdGFyZ2V0IG92ZXIgdGhlcmVcIilcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gbmV3IG1vdmUgZXZlbnRcclxuICAgICAgICAgICAgdGd0RXZlbnQgPSB7XHJcbiAgICAgICAgICAgICAgICBldmVudFR5cGU6IEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5UYXJnZXRpbmdNb3ZlLFxyXG4gICAgICAgICAgICAgICAgYWN0b3I6IGdtLmdldFBsYXllcigpLFxyXG4gICAgICAgICAgICAgICAgcGxheWVySW5pdGlhdGVkOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgZW5kc1R1cm46IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgb2Zmc2V0RGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgIG9mZnNldF94eTogb2Zmc2V0X3h5XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIGNvcHkgdGFyZ2V0aW5nIGRhdGEgb3ZlciBmcm9tIGxhc3QgZXZlbnRcclxuICAgICAgICAgICAgdGd0RXZlbnQudGFyZ2V0aW5nRGF0YSA9IEJyZXcuVXRpbHMuY2xvbmUobGFzdEV2ZW50LnRhcmdldGluZ0RhdGEpXHJcbiAgICAgICAgICAgIHRndEV2ZW50LnRhcmdldGluZ0RhdGEudG9feHkgPSBsYXN0RXZlbnQudGFyZ2V0aW5nRGF0YS50b194eS5jbG9uZSgpXHJcbiAgICAgICAgICAgIHRndEV2ZW50LnRhcmdldGluZ0RhdGEuZnJvbV94eSA9IGxhc3RFdmVudC50YXJnZXRpbmdEYXRhLmZyb21feHkuY2xvbmUoKVxyXG4gICAgICAgICAgICBcclxuICAgICAgICB9IGVsc2UgaWYgKChCcmV3LktleU1hcC5BY3Rpb24uaW5kZXhPZihrZXljb2RlKSA+IC0xKSB8fCAoQnJldy5LZXlNYXAuRXhhbWluZS5pbmRleE9mKGtleWNvZGUpID4gLTEpIHx8IChCcmV3LktleU1hcC5Ib3RLZXlzLmluZGV4T2Yoa2V5Y29kZSkgPiAtMSkpIHsgXHJcbiAgICAgICAgICAgIC8vIHRvZG86IG1ha2UgdGhpcyB0cmlnZ2VyIHRoZSBhY3R1YWwgdGhpbmcgd2UgYXJlIHRhcmdldGluZyBmb3JcclxuICAgICAgICAgICAgLy8gZmluaXNoIHRhcmdldGluZ1xyXG4gICAgICAgICAgICB0Z3RFdmVudCA9IHtcclxuICAgICAgICAgICAgICAgIGV2ZW50VHlwZTogQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLlRhcmdldGluZ0ZpbmlzaCxcclxuICAgICAgICAgICAgICAgIGFjdG9yOiBnbS5nZXRQbGF5ZXIoKSxcclxuICAgICAgICAgICAgICAgIHBsYXllckluaXRpYXRlZDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGVuZHNUdXJuOiBmYWxzZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBjb3B5IHRhcmdldGluZyBkYXRhIG92ZXIgZnJvbSBsYXN0IGV2ZW50XHJcbiAgICAgICAgICAgIHRndEV2ZW50LnRhcmdldGluZ0RhdGEgPSBCcmV3LlV0aWxzLmNsb25lKGdtLmdldExhc3RFdmVudCgpLnRhcmdldGluZ0RhdGEpXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIGNhbmNlbCBpdFxyXG4gICAgICAgICAgICB0Z3RFdmVudCA9IHtcclxuICAgICAgICAgICAgICAgIGV2ZW50VHlwZTogQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLlRhcmdldGluZ0NhbmNlbCxcclxuICAgICAgICAgICAgICAgIGFjdG9yOiBnbS5nZXRQbGF5ZXIoKSxcclxuICAgICAgICAgICAgICAgIHBsYXllckluaXRpYXRlZDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGVuZHNUdXJuOiBmYWxzZVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH1cclxuICAgIH0gZWxzZSBpZiAoZGF0YS5zb3VyY2UgPT0gQnJldy5FbnVtcy5CcmV3SW5wdXRTb3VyY2UuTW91c2UpIHtcclxuICAgICAgICBsZXQgc2NyZWVuX3h5ID0gZ2V0U2NyZWVuQ29vcmRzRnJvbU1vdXNlRXZlbnQoZ20sIGRhdGEpXHJcbiAgICAgICAgaWYgKCEoc2NyZWVuX3h5KSkge1xyXG4gICAgICAgICAgICByZXR1cm4gaW5wdXRFcnJvcihcImNsaWNrIG91dHNpZGUgb2Ygc2NyZWVuXCIpXHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIGxldCBtYXBfeHkgPSBnbS5kaXNwbGF5LmNvbnZlcnRTY3JlZW5Ub01hcChzY3JlZW5feHkpXHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKGRhdGEuanNldmVudC50eXBlID09IFwibW91c2Vkb3duXCIpIHtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIGZpbmlzaCB0YXJnZXRpbmdcclxuICAgICAgICAgICAgdGd0RXZlbnQgPSB7XHJcbiAgICAgICAgICAgICAgICBldmVudFR5cGU6IEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5UYXJnZXRpbmdGaW5pc2gsXHJcbiAgICAgICAgICAgICAgICBhY3RvcjogZ20uZ2V0UGxheWVyKCksXHJcbiAgICAgICAgICAgICAgICBwbGF5ZXJJbml0aWF0ZWQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBlbmRzVHVybjogZmFsc2VcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gY29weSB0YXJnZXRpbmcgZGF0YSBvdmVyIGZyb20gbGFzdCBldmVudFxyXG4gICAgICAgICAgICB0Z3RFdmVudC50YXJnZXRpbmdEYXRhID0gQnJldy5VdGlscy5jbG9uZShnbS5nZXRMYXN0RXZlbnQoKS50YXJnZXRpbmdEYXRhKVxyXG4gICAgICAgICAgICBcclxuICAgICAgICB9IGVsc2UgaWYgKGRhdGEuanNldmVudC50eXBlID09IFwibW91c2Vtb3ZlXCIpIHtcclxuXHJcbiAgICAgICAgICAgIGxldCBjdXJyZW50X3RhcmdldF94eSA9IGxhc3RFdmVudC50YXJnZXRpbmdEYXRhLnRvX3h5LmNsb25lKClcclxuICAgICAgICAgICAgbGV0IG5ld190YXJnZXRfeHkgPSBtYXBfeHlcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIG5ldyBtb3ZlIGV2ZW50XHJcbiAgICAgICAgICAgIHRndEV2ZW50ID0ge1xyXG4gICAgICAgICAgICAgICAgZXZlbnRUeXBlOiBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuVGFyZ2V0aW5nTW92ZSxcclxuICAgICAgICAgICAgICAgIGFjdG9yOiBnbS5nZXRQbGF5ZXIoKSxcclxuICAgICAgICAgICAgICAgIHBsYXllckluaXRpYXRlZDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGVuZHNUdXJuOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgIG9mZnNldERhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICBvZmZzZXRfeHk6IG1hcF94eS5zdWJ0cmFjdChjdXJyZW50X3RhcmdldF94eSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gY29weSB0YXJnZXRpbmcgZGF0YSBvdmVyIGZyb20gbGFzdCBldmVudFxyXG4gICAgICAgICAgICB0Z3RFdmVudC50YXJnZXRpbmdEYXRhID0gQnJldy5VdGlscy5jbG9uZShsYXN0RXZlbnQudGFyZ2V0aW5nRGF0YSlcclxuICAgICAgICAgICAgdGd0RXZlbnQudGFyZ2V0aW5nRGF0YS50b194eSA9IGxhc3RFdmVudC50YXJnZXRpbmdEYXRhLnRvX3h5LmNsb25lKClcclxuICAgICAgICAgICAgdGd0RXZlbnQudGFyZ2V0aW5nRGF0YS5mcm9tX3h5ID0gbGFzdEV2ZW50LnRhcmdldGluZ0RhdGEuZnJvbV94eS5jbG9uZSgpXHJcblxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gdGd0RXZlbnRcclxufVxyXG4gICAgXHJcbmZ1bmN0aW9uIG1haW5JbnB1dEhhbmRsZXIoZ206IEJyZXcuR2FtZU1hc3RlciwgZGF0YTogQnJldy5FbnVtcy5JQnJld0lucHV0RGF0YSwgZW52ZWxvcGUpIDogQnJldy5FbnVtcy5JQnJld0V2ZW50IHtcclxuICAgIFxyXG4gICAgbGV0IHBsYXllckV2ZW50IDogQnJldy5FbnVtcy5JQnJld0V2ZW50XHJcbiAgICBcclxuICAgIFxyXG4gICAgaWYgKGRhdGEuc291cmNlID09IEJyZXcuRW51bXMuQnJld0lucHV0U291cmNlLktleWJvYXJkKSB7XHJcbiAgICAgICAgcGxheWVyRXZlbnQgPSB0cmFuc2xhdGVLZXlib2FyZElucHV0SW50b0V2ZW50KGdtLCBkYXRhLCBlbnZlbG9wZSlcclxuICAgIH0gZWxzZSBpZiAoZGF0YS5zb3VyY2UgPT0gQnJldy5FbnVtcy5CcmV3SW5wdXRTb3VyY2UuTW91c2UpIHtcclxuICAgICAgICBwbGF5ZXJFdmVudCA9IHRyYW5zbGF0ZU1vdXNlSW5wdXRJbnRvRXZlbnQoZ20sIGRhdGEsIGVudmVsb3BlKVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwidW5leHBlY3RlZCBpbnB1dCB0eXBlXCIpXHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJldHVybiBwbGF5ZXJFdmVudFxyXG59XHJcblxyXG5mdW5jdGlvbiB0cmFuc2xhdGVLZXlib2FyZElucHV0SW50b0V2ZW50KGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGRhdGE6IEJyZXcuRW51bXMuSUJyZXdJbnB1dERhdGEsIGVudmVsb3BlKSA6IEJyZXcuRW51bXMuSUJyZXdFdmVudCB7XHJcblxyXG4gICAgbGV0IGV2IDogQnJldy5FbnVtcy5JQnJld0V2ZW50XHJcbiAgICBldiA9IHtcclxuICAgICAgICBldmVudFR5cGU6IG51bGwsXHJcbiAgICAgICAgYWN0b3I6IGdtLmdldFBsYXllcigpLFxyXG4gICAgICAgIHBsYXllckluaXRpYXRlZDogdHJ1ZVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBsZXQga2V5Y29kZSA9IGRhdGEuY29kZVxyXG4gICAgXHJcbiAgICBpZiAoQnJldy5LZXlNYXAuRGlyZWN0aW9uYWxNb3ZlbWVudEtleXMuaW5kZXhPZihrZXljb2RlKSA+IC0xKSB7XHJcbiAgICAgICAgcmV0dXJuIGlucHV0RGlyZWN0aW9uYWxNb3ZlbWVudChnbSwga2V5Y29kZSlcclxuICAgIH0gZWxzZSBpZiAoQnJldy5LZXlNYXAuUm90YXRpb25hbE1vdmVtZW50S2V5cy5pbmRleE9mKGtleWNvZGUpID4gLTEpIHtcclxuICAgICAgICByZXR1cm4gaW5wdXRSb3RhdGlvbmFsTW92ZW1lbnQoZ20sIGtleWNvZGUpXHJcbiAgICB9IGVsc2UgaWYgKEJyZXcuS2V5TWFwLlJvdGF0aW9uYWxXZWFwb25LZXlzLmluZGV4T2Yoa2V5Y29kZSkgPiAtMSkge1xyXG4gICAgICAgIHJldHVybiBpbnB1dFJvdGF0aW9uYWxXZWFwb24oZ20sIGtleWNvZGUpXHJcbiAgICB9IGVsc2UgaWYgKEJyZXcuS2V5TWFwLkhlbHAuaW5kZXhPZihrZXljb2RlKSA+IC0xKSB7XHJcbiAgICAgICAgcmV0dXJuIGlucHV0SGVscChnbSlcclxuICAgIH0gZWxzZSBpZiAoQnJldy5LZXlNYXAuQWN0aW9uLmluZGV4T2Yoa2V5Y29kZSkgPiAtMSkge1xyXG4gICAgICAgIHJldHVybiBpbnB1dEFjdGlvbihnbSwga2V5Y29kZSlcclxuICAgIH0gZWxzZSBpZiAoQnJldy5LZXlNYXAuRXhhbWluZS5pbmRleE9mKGtleWNvZGUpID4gLTEpIHtcclxuICAgICAgICByZXR1cm4gaW5wdXRFeGFtaW5lKGdtLCBrZXljb2RlKVxyXG4gICAgfSBlbHNlIGlmIChCcmV3LktleU1hcC5IZWFkc1VwLmluZGV4T2Yoa2V5Y29kZSkgPiAtMSkge1xyXG4gICAgICAgIHJldHVybiBpbnB1dEhlYWRzVXAoZ20sIGtleWNvZGUpXHJcbiAgICB9IGVsc2UgaWYgKEJyZXcuS2V5TWFwLkRlYnVnRk9WLmluZGV4T2Yoa2V5Y29kZSkgPiAtMSkge1xyXG4gICAgICAgIEJyZXcuRGVidWcudG9nZ2xlRk9WKGdtKVxyXG4gICAgLy8gfSBlbHNlIGlmIChCcmV3LktleU1hcC5EZWJ1Z1BhdGhzLmluZGV4T2Yoa2V5Y29kZSkgPiAtMSkge1xyXG4gICAgLy8gICAgIEJyZXcuRGVidWcudG9nZ2xlUGF0aG1hcChnbSwgbnVsbClcclxuICAgIH0gZWxzZSBpZiAoQnJldy5LZXlNYXAuSW52ZW50b3J5LmluZGV4T2Yoa2V5Y29kZSkgPiAtMSkge1xyXG4gICAgICAgIHJldHVybiBpbnB1dEludmVudG9yeShnbSwga2V5Y29kZSlcclxuICAgIH0gZWxzZSBpZiAoQnJldy5LZXlNYXAuTWVudS5pbmRleE9mKGtleWNvZGUpID4gLTEpIHtcclxuICAgICAgICByZXR1cm4gaW5wdXRQb3dlck1lbnUoZ20sIGtleWNvZGUpXHJcbiAgICB9IGVsc2UgaWYgKEJyZXcuS2V5TWFwLkhvdEtleXMuaW5kZXhPZihrZXljb2RlKSA+IC0xKSB7XHJcbiAgICAgICAgcmV0dXJuIGlucHV0SG90a2V5KGdtLCBrZXljb2RlLCBrZXljb2RlLTQ5KVxyXG4gICAgfSBlbHNlIGlmIChCcmV3LktleU1hcC5EZWJ1Z01lbnUuaW5kZXhPZihrZXljb2RlKSA+IC0xKSB7XHJcbiAgICAgICAgcmV0dXJuIGlucHV0RGVidWdNZW51KGdtLCBrZXljb2RlKVxyXG4gICAgfSBlbHNlIGlmIChCcmV3LktleU1hcC5Cb3NzTW9kZS5pbmRleE9mKGtleWNvZGUpID4gLTEpIHtcclxuICAgICAgICByZXR1cm4gaW5wdXRCb3NzTW9kZShnbSwga2V5Y29kZSlcclxuICAgIH0gZWxzZSBpZiAoQnJldy5LZXlNYXAuU2NyZWVuU2l6ZUNvbnRyb2wuaW5kZXhPZihrZXljb2RlKSA+IC0xKSB7XHJcbiAgICAgICAgcmV0dXJuIGlucHV0U2NyZWVuUmVzaXplKGdtLCBrZXljb2RlKVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4gaW5wdXRFcnJvcihcIlwiKVxyXG59XHJcblxyXG5mdW5jdGlvbiBpbnB1dFJvdGF0aW9uYWxNb3ZlbWVudChnbTogQnJldy5HYW1lTWFzdGVyLCBrZXljb2RlOiBudW1iZXIpIDogQnJldy5FbnVtcy5JQnJld0V2ZW50IHtcclxuICAgIGxldCBwbGF5ZXIgPSBnbS5nZXRQbGF5ZXIoKVxyXG5cclxuICAgIGxldCBuZXdfZmFjaW5nX2Rpcl94eSA6IEJyZXcuQ29vcmRpbmF0ZSA9IEJyZXcuVGFuay5nZXRSb3RhdGVkRmFjaW5nRGlyZWN0aW9uRnJvbUtleWNvZGUocGxheWVyLmZhY2luZ19kaXJlY3Rpb24sIGtleWNvZGUpXHJcbiAgICAvLyBwbGF5ZXIuZmFjaW5nX2RpcmVjdGlvbiA9IG5ld19mYWNpbmdfZGlyX3h5XHJcbiAgICBsZXQgcm90YXRlRXZlbnQgOiBCcmV3LkVudW1zLklCcmV3RXZlbnQgPSB7XHJcbiAgICAgICAgZXZlbnRUeXBlOiBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuUm90YXRlQm9keSxcclxuICAgICAgICBhY3RvcjogZ20uZ2V0UGxheWVyKCksXHJcbiAgICAgICAgcGxheWVySW5pdGlhdGVkOiB0cnVlLFxyXG4gICAgICAgIGVuZHNUdXJuOiB0cnVlLFxyXG4gICAgICAgIHJvdGF0ZURhdGE6IHtcclxuICAgICAgICAgICAgb2xkX2ZhY2luZ194eTogcGxheWVyLmZhY2luZ19kaXJlY3Rpb24uY2xvbmUoKSxcclxuICAgICAgICAgICAgbmV3X2ZhY2luZ194eTogbmV3X2ZhY2luZ19kaXJfeHlcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcm90YXRlRXZlbnRcclxufVxyXG5cclxuZnVuY3Rpb24gaW5wdXRSb3RhdGlvbmFsV2VhcG9uKGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGtleWNvZGU6IG51bWJlcikgOiBCcmV3LkVudW1zLklCcmV3RXZlbnQge1xyXG4gICAgbGV0IHBsYXllciA9IGdtLmdldFBsYXllcigpXHJcbiAgICBsZXQgdHVycmV0UG93ZXIgPSBwbGF5ZXIuZ2V0UG93ZXJzKCkuZ2V0UG93ZXJPZlR5cGUoQnJldy5FbnVtcy5CcmV3UG93ZXJUeXBlLlR1cnJldENhbm5vbilcclxuXHJcbiAgICBsZXQgbmV3X2ZhY2luZ19kaXJfeHkgOiBCcmV3LkNvb3JkaW5hdGUgPSBCcmV3LlRhbmsuZ2V0Um90YXRlZEZhY2luZ0RpcmVjdGlvbkZyb21LZXljb2RlKHR1cnJldFBvd2VyLmZhY2luZ19kaXJlY3Rpb24sIGtleWNvZGUpXHJcbiAgICAvLyBwbGF5ZXIuZmFjaW5nX2RpcmVjdGlvbiA9IG5ld19mYWNpbmdfZGlyX3h5XHJcbiAgICBsZXQgbW92ZUV2ZW50IDogQnJldy5FbnVtcy5JQnJld0V2ZW50ID0ge1xyXG4gICAgICAgIGV2ZW50VHlwZTogQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLlJvdGF0ZVdlYXBvbixcclxuICAgICAgICBhY3RvcjogZ20uZ2V0UGxheWVyKCksXHJcbiAgICAgICAgcGxheWVySW5pdGlhdGVkOiB0cnVlLFxyXG4gICAgICAgIGVuZHNUdXJuOiB0cnVlLFxyXG4gICAgICAgIHJvdGF0ZURhdGE6IHtcclxuICAgICAgICAgICAgb2xkX2ZhY2luZ194eTogcGxheWVyLmZhY2luZ19kaXJlY3Rpb24uY2xvbmUoKSxcclxuICAgICAgICAgICAgbmV3X2ZhY2luZ194eTogbmV3X2ZhY2luZ19kaXJfeHksXHJcbiAgICAgICAgICAgIHdlYXBvblBvd2VyOiB0dXJyZXRQb3dlclxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBtb3ZlRXZlbnRcclxufVxyXG5cclxuZnVuY3Rpb24gaW5wdXREaXJlY3Rpb25hbE1vdmVtZW50KGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGtleWNvZGU6IG51bWJlcikgOiBCcmV3LkVudW1zLklCcmV3RXZlbnQge1xyXG4gICAgXHJcbiAgICBsZXQgbGV2ZWwgPSBnbS5nZXRDdXJyZW50TGV2ZWwoKVxyXG4gICAgXHJcbiAgICAvLyBkZXRlcm1pbmUgb2Zmc2V0XHJcbiAgICAvLyBsZXQgb2Zmc2V0X3h5IDogQnJldy5Db29yZGluYXRlID0gQnJldy5VdGlscy5nZXREaXJlY3Rpb25Gcm9tS2V5Y29kZShrZXljb2RlKVxyXG4gICAgbGV0IG9mZnNldF94eSA6IEJyZXcuQ29vcmRpbmF0ZSA9IEJyZXcuVGFuay5nZXREaXJlY3Rpb25Gcm9tS2V5Y29kZShnbS5nZXRQbGF5ZXIoKSwga2V5Y29kZSlcclxuXHJcbiAgICBpZiAoIShvZmZzZXRfeHkpKSB7XHJcbiAgICAgICAgcmV0dXJuIGlucHV0RXJyb3IoXCJpbnZhbGlkIG1vdmVtZW50IGtleSAtIG5vIGRpcmVjdGlvblwiKVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBjaGVjayB3aGF0cyBvdmVyIHRoZXJlXHJcbiAgICBsZXQgbmV3X3h5ID0gZ20uZ2V0UGxheWVyKCkubG9jYXRpb24uYWRkKG9mZnNldF94eSlcclxuICAgIFxyXG4gICAgaWYgKCEobGV2ZWwuaXNWYWxpZChuZXdfeHkpKSkge1xyXG4gICAgICAgIHJldHVybiBpbnB1dEVycm9yKFwiWW91IGNhbid0IGdvIHRoZXJlXCIpXHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIGxldCB0OiBCcmV3LlRlcnJhaW4gPSBsZXZlbC50ZXJyYWluLmdldEF0KG5ld194eSlcclxuICAgIGlmICghKEJyZXcuTW92ZW1lbnQuY2FuTW92ZVRvTG9jYXRpb24oZ20sIGdtLmdldFBsYXllcigpLCBuZXdfeHkpKSkge1xyXG4gICAgICAgIHJldHVybiBpbnB1dEVycm9yKFwiWW91IGNhbid0IGdvIHRvIHRoZXJlXCIpXHJcbiAgICB9XHJcblxyXG4gICAgbGV0IG9sZF94eSA9IGdtLmdldFBsYXllcigpLmxvY2F0aW9uLmNsb25lKClcclxuXHJcbiAgICBsZXQgbTogQnJldy5HcmlkVGhpbmdzLk1vbnN0ZXIgPSBsZXZlbC5tb25zdGVycy5nZXRBdChuZXdfeHkpXHJcbiAgICBpZiAobSkge1xyXG4gICAgICAgIHJldHVybiBwbGF5ZXJNZWxlZUF0dGFjayhnbSwgbSlcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gbW92ZSBldmVudFxyXG4gICAgXHJcbiAgICBsZXQgbW92ZUV2ZW50IDogQnJldy5FbnVtcy5JQnJld0V2ZW50ID0ge1xyXG4gICAgICAgIGV2ZW50VHlwZTogQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLk1vdmUsXHJcbiAgICAgICAgYWN0b3I6IGdtLmdldFBsYXllcigpLFxyXG4gICAgICAgIHBsYXllckluaXRpYXRlZDogdHJ1ZSxcclxuICAgICAgICBlbmRzVHVybjogdHJ1ZSxcclxuICAgICAgICBtb3ZlRGF0YToge1xyXG4gICAgICAgICAgICBmcm9tX3h5OiBvbGRfeHksXHJcbiAgICAgICAgICAgIHRvX3h5OiBuZXdfeHlcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbW92ZUV2ZW50XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHBsYXllck1lbGVlQXR0YWNrKGdtOiBCcmV3LkdhbWVNYXN0ZXIsIHRhcmdldDogQnJldy5HcmlkVGhpbmdzLk1vbnN0ZXIpIDogQnJldy5FbnVtcy5JQnJld0V2ZW50IHtcclxuICAgIGxldCBwbGF5ZXIgPSBnbS5nZXRQbGF5ZXIoKVxyXG4gICAgbGV0IGxldmVsID0gZ20uZ2V0Q3VycmVudExldmVsKClcclxuICAgIFxyXG4gICAgbGV0IHBsYXllcl9kYW1hZ2UgID0gMVxyXG4gICAgbGV0IGF0dGFja190eXBlID0gQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLkF0dGFja1xyXG5cclxuICAgIC8vIGNoZWNrIGZvciB3YWxsIHNtYXNoaW5nXHJcbiAgICAvLyBsZXQgY2FuX3dhbGxzbWFzaCA9IEJyZXcuQ29tYmF0LmNoZWNrRm9yV2FsbFNtYXNoKGdtLCBwbGF5ZXIsIHRhcmdldClcclxuICAgIFxyXG4gICAgLy8gaWYgKGNhbl93YWxsc21hc2gpIHtcclxuICAgIC8vICAgICBhdHRhY2tfdHlwZSA9IEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5TbWFzaEF0dGFja1xyXG4gICAgLy8gICAgIHBsYXllcl9kYW1hZ2UgPSAyXHJcbiAgICAvLyB9XHJcblxyXG4gICAgbGV0IGF0dGFja0V2ZW50IDogQnJldy5FbnVtcy5JQnJld0V2ZW50ID0ge1xyXG4gICAgICAgIGV2ZW50VHlwZTogYXR0YWNrX3R5cGUsXHJcbiAgICAgICAgYWN0b3I6IGdtLmdldFBsYXllcigpLFxyXG4gICAgICAgIHBsYXllckluaXRpYXRlZDogdHJ1ZSxcclxuICAgICAgICBlbmRzVHVybjogdHJ1ZSxcclxuICAgICAgICBhdHRhY2tEYXRhOiB7XHJcbiAgICAgICAgICAgIGZyb21feHk6IGdtLmdldFBsYXllcigpLmxvY2F0aW9uLFxyXG4gICAgICAgICAgICB0b194eTogdGFyZ2V0LmxvY2F0aW9uLFxyXG4gICAgICAgICAgICB0YXJnZXQ6IHRhcmdldCxcclxuICAgICAgICAgICAgaXNNZWxlZTogdHJ1ZSxcclxuICAgICAgICAgICAgZGFtYWdlOiBwbGF5ZXJfZGFtYWdlXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgYXR0YWNrRXZlbnQgPSBCcmV3LkNvbWJhdC5wb3NzaWJseUNvbnZlcnRBdHRhY2tUb1NtYXNoQXR0YWNrKGdtLCBhdHRhY2tFdmVudClcclxuICAgIFxyXG4gICAgcmV0dXJuIGF0dGFja0V2ZW50XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGlucHV0QWN0aW9uKGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGtleWNvZGU6IG51bWJlcikgOiBCcmV3LkVudW1zLklCcmV3RXZlbnQge1xyXG4gICAgLy8gcGlja3VwIC8gcmVzdFxyXG4gICAgXHJcbiAgICAvLyBsZXRzIHNlZSB3aGF0cyBoZXJlXHJcbiAgICBsZXQgbGV2ZWwgPSBnbS5nZXRDdXJyZW50TGV2ZWwoKVxyXG4gICAgbGV0IHBsYXllciA9IGdtLmdldFBsYXllcigpXHJcbiAgICBsZXQgaXRlbV9oZXJlID0gbGV2ZWwuaXRlbXMuZ2V0QXQocGxheWVyLmxvY2F0aW9uKVxyXG4gICAgXHJcbiAgICAvLyBpZiB0aGUgaXRlbSBoZXJlIGlzIGEgcG93ZXIgc3lzdGVtIHRoZW4gaXQgaXMgYSBzcGVjaWFsIGNhc2VcclxuICAgIGxldCBzeXN0ZW1faXRlbV9oZXJlID0gbnVsbFxyXG4gICAgaWYgKChpdGVtX2hlcmUpICYmIChpdGVtX2hlcmUuaXNUeXBlKEJyZXcuRGVmaW5pdGlvbnMuSXRlbVR5cGUuUG93ZXJTeXN0ZW0pKSkge1xyXG4gICAgICAgIHN5c3RlbV9pdGVtX2hlcmUgPSBpdGVtX2hlcmVcclxuICAgICAgICBpdGVtX2hlcmUgPSBudWxsXHJcbiAgICB9XHJcblxyXG4gICAgbGV0IHBvcnRhbF9oZXJlID0gbGV2ZWwucG9ydGFscy5nZXRBdChwbGF5ZXIubG9jYXRpb24pXHJcbiAgICBsZXQgbW9uc3Rlcl9uZWFyYnkgOiBib29sZWFuXHJcbiAgICBcclxuICAgIC8vIGZpbmQgb3V0IGlmIHRoZXJlIGlzIGEgbW9uc3RlciBuZWFyYnlcclxuICAgIG1vbnN0ZXJfbmVhcmJ5ID0gZmFsc2VcclxuICAgIHBsYXllci5rbm93bGVkZ2UuZ2V0QWxsVGhpbmdzKCkuZm9yRWFjaCgodGhpbmd5OiBCcmV3LkdyaWRUaGluZ3MuVGhpbmcsIGluZGV4OiBudW1iZXIsIGFycmF5KSA9PiB7XHJcbiAgICAgICAgaWYgKCh0aGluZ3kgaW5zdGFuY2VvZiBCcmV3LkdyaWRUaGluZ3MuTW9uc3RlcikgJiYgKCEodGhpbmd5LmlzU2FtZVRoaW5nKHBsYXllcikpKSAmJiAoQnJldy5JbnRlbC5pc0VuZW15KHBsYXllciwgdGhpbmd5KSkpIHtcclxuICAgICAgICAgICAgbW9uc3Rlcl9uZWFyYnkgPSB0cnVlXHJcbiAgICAgICAgfVxyXG4gICAgfSlcclxuXHJcbiAgICBpZiAobW9uc3Rlcl9uZWFyYnkpIHtcclxuICAgICAgICBnbS5kaXNwbGF5LmRyYXdQb3B1cE1lc3NhZ2UoXCJXYWl0aW5nIC0gZW5lbXkgaW4gcmFuZ2VcIiwgcGxheWVyLmxvY2F0aW9uLCBCcmV3LkNvbG9yLnZpb2xldClcclxuICAgICAgICByZXR1cm4gQnJldy5FdmVudHMuY3JlYXRlR2VuZXJpY0V2ZW50T2ZUeXBlKGdtLCBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuV2FpdCwgdHJ1ZSlcclxuICAgIH1cclxuXHJcbiAgICAvLyBidWlsZCB1cCBhIGxpc3Qgb2Ygb3B0aW9ucyBhbmQgdGhlbiBzaG93IGEgbWVudSBvbmx5IGlmIHdlIG5lZWQgdG9cclxuICAgIGxldCBtZW51X2VudHJpZXMgOiBBcnJheTxCcmV3LkVudW1zLklCcmV3R2VuZXJpY01lbnVFbnRyeT4gPSBbXVxyXG4gICAgXHJcbiAgICBpZiAocG9ydGFsX2hlcmUpIHtcclxuICAgICAgICAvLyBtZW51X2VudHJpZXMucHVzaCh7XHJcbiAgICAgICAgLy8gICAgIGVudHJ5VHlwZTogQnJldy5FbnVtcy5HZW5lcmljTWVudUVudHJ5VHlwZS5FdmVudEJhc2VkLFxyXG4gICAgICAgIC8vICAgICBlbnRyeUV2ZW50OiBCcmV3LkV2ZW50cy5hZGREYXRhVG9FdmVudChCcmV3LkV2ZW50cy5jcmVhdGVHZW5lcmljRXZlbnRPZlR5cGUoZ20sIEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5Vc2VQb3J0YWwpLCB7cG9ydGFsRGF0YToge3BvcnRhbF91c2VkOiBwb3J0YWxfaGVyZX19KVxyXG4gICAgICAgIC8vIH0pXHJcbiAgICAgICAgcmV0dXJuIEJyZXcuRXZlbnRzLmFkZERhdGFUb0V2ZW50KEJyZXcuRXZlbnRzLmNyZWF0ZUdlbmVyaWNFdmVudE9mVHlwZShnbSwgQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLlVzZVBvcnRhbCksIHtwb3J0YWxEYXRhOiB7cG9ydGFsX3VzZWQ6IHBvcnRhbF9oZXJlfX0pXHJcbiAgICB9XHJcblxyXG5cclxuICAgIGxldCBjYW5fcGlja3VwID0gcGxheWVyLmludmVudG9yeS5oYXNDYXBhY2l0eSgpIFxyXG4gICAgaWYgKGl0ZW1faGVyZSAmJiAoIShjYW5fcGlja3VwKSkpIHtcclxuICAgICAgICBnbS5kaXNwbGF5LmRyYXdQb3B1cE1lc3NhZ2UoXCJJbnZlbnRvcnkgaXMgZnVsbCFcIiwgcGxheWVyLmxvY2F0aW9uLCBCcmV3LkNvbG9yLnZpb2xldClcclxuICAgIH1cclxuICAgIFxyXG4gICAgaWYgKGl0ZW1faGVyZSAmJiBjYW5fcGlja3VwICYmIGl0ZW1faGVyZS5jYW5QaWNrdXApIHtcclxuICAgICAgICAvLyBtZW51X2VudHJpZXMucHVzaCh7XHJcbiAgICAgICAgLy8gICAgIGVudHJ5VHlwZTogQnJldy5FbnVtcy5HZW5lcmljTWVudUVudHJ5VHlwZS5FdmVudEJhc2VkLFxyXG4gICAgICAgIC8vICAgICBlbnRyeUV2ZW50OiB7XHJcbiAgICAgICAgLy8gICAgICAgICBldmVudFR5cGU6IEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5QaWNrdXAsXHJcbiAgICAgICAgLy8gICAgICAgICBhY3RvcjogcGxheWVyLFxyXG4gICAgICAgIC8vICAgICAgICAgcGxheWVySW5pdGlhdGVkOiB0cnVlLFxyXG4gICAgICAgIC8vICAgICAgICAgZW5kc1R1cm46IHRydWUsXHJcbiAgICAgICAgLy8gICAgICAgICAgICAgaXRlbURhdGE6IHtcclxuICAgICAgICAvLyAgICAgICAgICAgICAgICAgaXRlbTogaXRlbV9oZXJlXHJcbiAgICAgICAgLy8gICAgICAgICB9XHJcbiAgICAgICAgLy8gICAgIH1cclxuICAgICAgICAvLyB9KVxyXG4gICAgICAgIHJldHVybiAge1xyXG4gICAgICAgICAgICBldmVudFR5cGU6IEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5QaWNrdXAsXHJcbiAgICAgICAgICAgIGFjdG9yOiBwbGF5ZXIsXHJcbiAgICAgICAgICAgIHBsYXllckluaXRpYXRlZDogdHJ1ZSxcclxuICAgICAgICAgICAgZW5kc1R1cm46IHRydWUsXHJcbiAgICAgICAgICAgICAgICBpdGVtRGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW06IGl0ZW1faGVyZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIGlmIChpdGVtX2hlcmUgJiYgaXRlbV9oZXJlLmNhbkhlYXZlKSB7XHJcbiAgICAvLyAgICAgbGV0IGhlYXZlRXZlbnQgPSBCcmV3LkV2ZW50cy5jcmVhdGVHZW5lcmljRXZlbnRPZlR5cGUoZ20sIEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5UYXJnZXRpbmdPbiwgZmFsc2UpXHJcbiAgICAvLyAgICAgaGVhdmVFdmVudC5pdGVtRGF0YSA9IHtcclxuICAgIC8vICAgICAgICAgaXRlbTogaXRlbV9oZXJlXHJcbiAgICAvLyAgICAgfVxyXG4gICAgLy8gICAgIGhlYXZlRXZlbnQuc3RhcnRUYXJnZXRpbmdEYXRhID0ge1xyXG4gICAgLy8gICAgICAgICBmcm9tX3h5OiBwbGF5ZXIubG9jYXRpb24sXHJcbiAgICAvLyAgICAgICAgIHRvX3h5OiBwbGF5ZXIubG9jYXRpb24sXHJcbiAgICAvLyAgICAgICAgIHRhcmdldGluZ0FjdGlvbjogQnJldy5FbnVtcy5CcmV3VGFyZ2V0aW5nQWN0aW9uLkhlYXZlSXRlbVxyXG4gICAgLy8gICAgIH1cclxuXHJcbiAgICAvLyAgICAgbWVudV9lbnRyaWVzLnB1c2goe1xyXG4gICAgLy8gICAgICAgICBlbnRyeU5hbWU6IFwiSGVhdmVcIixcclxuICAgIC8vICAgICAgICAgZW50cnlEZXNjcmlwdGlvbjogXCJEcmFtYXRpY2FsbHkgaGVhdmUgdGhpcyB3cmVja2FnZSBpbnRvIGFub3RoZXIgdGFyZ2V0XCIsXHJcbiAgICAvLyAgICAgICAgIGVudHJ5VHlwZTogQnJldy5FbnVtcy5HZW5lcmljTWVudUVudHJ5VHlwZS5FdmVudEJhc2VkLFxyXG4gICAgLy8gICAgICAgICBlbnRyeUV2ZW50OiBoZWF2ZUV2ZW50XHJcbiAgICAvLyAgICAgfSlcclxuICAgIC8vIH1cclxuXHJcbiAgICAvLyAvLyBoYW5kbGUgcG93ZXJzL3N5c3RlbXNcclxuICAgIC8vIGlmIChzeXN0ZW1faXRlbV9oZXJlKSB7XHJcbiAgICAvLyAgICAgbWVudV9lbnRyaWVzLnB1c2goe1xyXG4gICAgLy8gICAgICAgICBlbnRyeVR5cGU6IEJyZXcuRW51bXMuR2VuZXJpY01lbnVFbnRyeVR5cGUuRXZlbnRCYXNlZCxcclxuICAgIC8vICAgICAgICAgZW50cnlOYW1lOiBcIkluc3RhbGwgdGhpcyBQb3dlclwiLFxyXG4gICAgLy8gICAgICAgICBlbnRyeURlc2NyaXB0aW9uOiBcIkJyaW5ncyB1cCB0aGUgcG93ZXIgaW5zdGFsbGF0aW9uIG1lbnUgLSB3aWxsIHByb21wdCB5b3UgdG8gc3dhcCBvdXQgYW4gZXhpc3RpbmcgcG93ZXIuXCIsXHJcbiAgICAvLyAgICAgICAgIGVudHJ5RXZlbnQ6IHtcclxuICAgIC8vICAgICAgICAgICAgIGV2ZW50VHlwZTogQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLlBvd2VySW5zdGFsbFByb21wdE9uLFxyXG4gICAgLy8gICAgICAgICAgICAgYWN0b3I6IHBsYXllcixcclxuICAgIC8vICAgICAgICAgICAgIHBsYXllckluaXRpYXRlZDogdHJ1ZSxcclxuICAgIC8vICAgICAgICAgICAgIGVuZHNUdXJuOiBmYWxzZSxcclxuICAgIC8vICAgICAgICAgICAgIHBvd2VyRGF0YToge1xyXG4gICAgLy8gICAgICAgICAgICAgICAgIHBvd2VyOiBzeXN0ZW1faXRlbV9oZXJlLnBvd2VyXHJcbiAgICAvLyAgICAgICAgICAgICB9XHJcbiAgICAvLyAgICAgICAgIH1cclxuICAgIC8vICAgICB9KVxyXG4gICAgLy8gfVxyXG5cclxuICAgIHJldHVybiBCcmV3LkV2ZW50cy5jcmVhdGVHZW5lcmljRXZlbnRPZlR5cGUoZ20sIEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5XYWl0LCB0cnVlKVxyXG4gICAgLy8gcHV0IHRvZ2V0aGVyIGEgbWVudSBpZiB3ZSBuZWVkIHRvLCBvciBqdXN0IGdlbmVyYXRlIHRoZSBtb3N0IG9idmlvdXMgZXZlbnQgYWN0aW9uXHJcbiAgICAvLyBsZXQgZmluYWxFdmVudCA6IEJyZXcuRW51bXMuSUJyZXdFdmVudFxyXG4gICAgLy8gbGV0IHdhaXRFdmVudCA9IEJyZXcuRXZlbnRzLmNyZWF0ZUdlbmVyaWNFdmVudE9mVHlwZShnbSwgQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLldhaXQsIHRydWUpXHJcbiAgICAvLyAvLyBjb25zb2xlLmxvZyhcIm1vbnN0ZXIgbmVhcmJ5P1wiLCBtb25zdGVyX25lYXJieSlcclxuXHJcbiAgICAvLyBpZiAobWVudV9lbnRyaWVzLmxlbmd0aCA9PSAwKSB7XHJcbiAgICAvLyAgICAgZmluYWxFdmVudCA9IHdhaXRFdmVudFxyXG4gICAgLy8gfSBlbHNlIGlmICgobWVudV9lbnRyaWVzLmxlbmd0aCA9PSAxKSAmJiAoIShtb25zdGVyX25lYXJieSkpKSB7ICAgIFxyXG4gICAgLy8gICAgIGZpbmFsRXZlbnQgPSBtZW51X2VudHJpZXNbMF0uZW50cnlFdmVudFxyXG5cclxuICAgIC8vIH0gZWxzZSB7XHJcbiAgICAvLyAgICAgbGV0IG1lbnVFdmVudCA9IEJyZXcuRXZlbnRzLmNyZWF0ZUdlbmVyaWNFdmVudE9mVHlwZShnbSwgQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLkdlbmVyaWNNZW51T24pXHJcbiAgICAvLyAgICAgbWVudV9lbnRyaWVzLnB1c2goe1xyXG4gICAgLy8gICAgICAgICBlbnRyeVR5cGU6IEJyZXcuRW51bXMuR2VuZXJpY01lbnVFbnRyeVR5cGUuRXZlbnRCYXNlZCxcclxuICAgIC8vICAgICAgICAgZW50cnlEZXNjcmlwdGlvbjogXCJSZXN0IChlbmRzIHlvdXIgdHVybilcIixcclxuICAgIC8vICAgICAgICAgZW50cnlFdmVudDogd2FpdEV2ZW50XHJcbiAgICAvLyAgICAgfSlcclxuICAgIC8vICAgICBtZW51X2VudHJpZXMudW5zaGlmdCh7XHJcbiAgICAvLyAgICAgICAgIGVudHJ5VHlwZTogQnJldy5FbnVtcy5HZW5lcmljTWVudUVudHJ5VHlwZS5DYW5jZWwsXHJcbiAgICAvLyAgICAgICAgIGVudHJ5RXZlbnQ6IEJyZXcuRXZlbnRzLmNyZWF0ZUdlbmVyaWNFdmVudE9mVHlwZShnbSwgQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLkdlbmVyaWNNZW51T2ZmKVxyXG4gICAgLy8gICAgIH0pXHJcbiAgICAvLyAgICAgbWVudUV2ZW50LmdlbmVyaWNNZW51RGF0YSA9IHtcclxuICAgIC8vICAgICAgICAgbWVudVRpdGxlOiBcIkFtYmlndW91cyBJbnB1dFwiLFxyXG4gICAgLy8gICAgICAgICBtZW51RGVzY3JpcHRpb246IFwiVGhlcmUgYXJlIG11bHRpcGxlIGFjdGlvbnMgeW91IG1heSBiZSB0cnlpbmcgdG8gdGFrZSBhbmQgdGhlcmUgaXMgYW4gZW5lbXkgbmVhciBieSwgY29uZmlybSB5b3VyIGFjdGlvbi5cIixcclxuICAgIC8vICAgICAgICAgYWxsb3dDYW5jZWw6IHRydWUsXHJcbiAgICAvLyAgICAgICAgIG1lbnVFbnRyaWVzTGlzdDogbWVudV9lbnRyaWVzXHJcbiAgICAvLyAgICAgfVxyXG5cclxuICAgIC8vICAgICBmaW5hbEV2ZW50ID0gbWVudUV2ZW50XHJcbiAgICAvLyB9XHJcblxyXG4gICAgXHJcbiAgICAvLyByZXR1cm4gZmluYWxFdmVudFxyXG59XHJcblxyXG5mdW5jdGlvbiBpbnB1dEV4YW1pbmUoZ206IEJyZXcuR2FtZU1hc3Rlciwga2V5Y29kZTogbnVtYmVyKSA6IEJyZXcuRW51bXMuSUJyZXdFdmVudCB7XHJcbiAgICBsZXQgZXhhbWluZUV2ZW50IDogQnJldy5FbnVtcy5JQnJld0V2ZW50ID0ge1xyXG4gICAgICAgIGV2ZW50VHlwZTogQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLlRhcmdldGluZ09uLFxyXG4gICAgICAgIGFjdG9yOiBnbS5nZXRQbGF5ZXIoKSxcclxuICAgICAgICBwbGF5ZXJJbml0aWF0ZWQ6IHRydWUsXHJcbiAgICAgICAgZW5kc1R1cm46IGZhbHNlLFxyXG4gICAgICAgIHN0YXJ0VGFyZ2V0aW5nRGF0YToge1xyXG4gICAgICAgICAgICBmcm9tX3h5OiBnbS5nZXRQbGF5ZXIoKS5sb2NhdGlvbixcclxuICAgICAgICAgICAgdG9feHk6IGdtLmdldFBsYXllcigpLmxvY2F0aW9uLFxyXG4gICAgICAgICAgICB0YXJnZXRpbmdBY3Rpb246IEJyZXcuRW51bXMuQnJld1RhcmdldGluZ0FjdGlvbi5FeGFtaW5lXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4gZXhhbWluZUV2ZW50XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGlucHV0SGVhZHNVcChnbTogQnJldy5HYW1lTWFzdGVyLCBrZXljb2RlOiBudW1iZXIpIDogQnJldy5FbnVtcy5JQnJld0V2ZW50IHtcclxuICAgIGxldCBub3RlcyA9IEJyZXcuSFVELmdldEN1cnJlbnROb3RlcyhnbSlcclxuICAgIGxldCBub3RlX3BhZ2VzID0gQnJldy5IVUQuZ2V0SFVEUGFnZXMoZ20sIG5vdGVzKVxyXG5cclxuICAgIGxldCBodWRFdmVudCA6IEJyZXcuRW51bXMuSUJyZXdFdmVudCA9IHtcclxuICAgICAgICBldmVudFR5cGU6IEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5IZWFkc1VwRGlzcGxheU9uLFxyXG4gICAgICAgIGFjdG9yOiBnbS5nZXRQbGF5ZXIoKSxcclxuICAgICAgICBwbGF5ZXJJbml0aWF0ZWQ6IHRydWUsXHJcbiAgICAgICAgZW5kc1R1cm46IGZhbHNlLFxyXG4gICAgICAgIGhlYWRzVXBEYXRhOiB7XHJcbiAgICAgICAgICAgIHNlbGVjdGVkX2luZGV4OiAwLFxyXG4gICAgICAgICAgICBoZWFkc1VwRGlzcGxheU5vdGVQYWdlczogbm90ZV9wYWdlc1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuIGh1ZEV2ZW50XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGlucHV0SG90a2V5KGdtIDogQnJldy5HYW1lTWFzdGVyLCBrZXljb2RlIDogbnVtYmVyLCBob3RrZXkgOiBudW1iZXIpIHtcclxuICAgIGxldCBwbGF5ZXIgPSBnbS5nZXRQbGF5ZXIoKVxyXG4gICAgbGV0IHZhbGlkUG93ZXIgPSBwbGF5ZXIuZ2V0UG93ZXJzKCkuZ2V0UG93ZXJCeUluZGV4KGhvdGtleSlcclxuXHJcbiAgICBpZiAoISh2YWxpZFBvd2VyKSkge1xyXG4gICAgICAgIHJldHVybiBpbnB1dEVycm9yKFwiaG90a2V5IG5vdCBhc3NpZ25lZCB0byBhIHZhbGlkIHBvd2VyXCIpXHJcbiAgICB9XHJcblxyXG4gICAgLy8gaWYgaXRzIGVtcHR5IGFuZCBub3QgYWxyZWFkeSBhY3RpdmF0ZWQsIG5vIGRpY2VcclxuICAgIGlmICh2YWxpZFBvd2VyLmNoYXJnZV9zdGF0LmlzRW1wdHkoKSAmJiAoISh2YWxpZFBvd2VyLmFjdGl2YXRlZCkpKSB7XHJcbiAgICAgICAgcmV0dXJuIGlucHV0RXJyb3IoXCJOb3QgZW5vdWdoIGNoYXJnZXMgb24gdGhhdCBwb3dlclwiKVxyXG4gICAgfVxyXG5cclxuICAgIGxldCBwb3dlckV2ZW50ID0gQnJldy5Qb3dlcnMudHJpZ2dlclBvd2VyKGdtLCBwbGF5ZXIsIHZhbGlkUG93ZXIpXHJcbiAgICByZXR1cm4gcG93ZXJFdmVudFxyXG59XHJcblxyXG5mdW5jdGlvbiBpbnB1dEludmVudG9yeShnbTogQnJldy5HYW1lTWFzdGVyLCBrZXljb2RlOiBudW1iZXIpIDogQnJldy5FbnVtcy5JQnJld0V2ZW50IHtcclxuICAgIGxldCBpbnZFdmVudCA6IEJyZXcuRW51bXMuSUJyZXdFdmVudCA9IHtcclxuICAgICAgICBldmVudFR5cGU6IEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5JbnZlbnRvcnlPbixcclxuICAgICAgICBhY3RvcjogZ20uZ2V0UGxheWVyKCksXHJcbiAgICAgICAgcGxheWVySW5pdGlhdGVkOiB0cnVlLFxyXG4gICAgICAgIGVuZHNUdXJuOiBmYWxzZSxcclxuICAgICAgICBpbnZlbnRvcnlEYXRhOiB7XHJcbiAgICAgICAgICAgIGludmVudG9yeTogZ20uZ2V0UGxheWVyKCkuaW52ZW50b3J5XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGludkV2ZW50XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGlucHV0UG93ZXJNZW51KGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGtleWNvZGU6IG51bWJlcikgOiBCcmV3LkVudW1zLklCcmV3RXZlbnQge1xyXG4gICAgbGV0IHBsYXllciA9IGdtLmdldFBsYXllcigpXHJcbiAgICBsZXQgcG93ZXJfZW50cmllcyA6IEFycmF5PEJyZXcuRW51bXMuSUJyZXdHZW5lcmljTWVudUVudHJ5PiA9IFtdXHJcbiAgICBsZXQgcG93ZXJzID0gcGxheWVyLmdldFBvd2VycygpXHJcblxyXG4gICAgcG93ZXJfZW50cmllcyA9IEJyZXcuTWVudXMuZ2V0TWVudURhdGFfRW50cmllc19mb3JfUG93ZXJzKGdtLCBwbGF5ZXIsIEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5Qb3dlck1lbnVPbiwgZmFsc2UpXHJcblxyXG4gICAgbGV0IG1lbnVFdmVudCA6IEJyZXcuRW51bXMuSUJyZXdFdmVudCA9IHtcclxuICAgICAgICBldmVudFR5cGU6IEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5HZW5lcmljTWVudU9uLFxyXG4gICAgICAgIGFjdG9yOiBnbS5nZXRQbGF5ZXIoKSxcclxuICAgICAgICBwbGF5ZXJJbml0aWF0ZWQ6IHRydWUsXHJcbiAgICAgICAgZW5kc1R1cm46IGZhbHNlLFxyXG4gICAgICAgIGdlbmVyaWNNZW51RGF0YToge1xyXG4gICAgICAgICAgICBtZW51VGl0bGU6IFwiQWN0aXZlIFBvd2Vyc1wiLFxyXG4gICAgICAgICAgICBhbGxvd0NhbmNlbDogdHJ1ZSxcclxuICAgICAgICAgICAgbWVudUVudHJpZXNMaXN0OiBwb3dlcl9lbnRyaWVzXHJcbiAgICAgICAgfSxcclxuICAgIH1cclxuICAgIHJldHVybiBtZW51RXZlbnRcclxufVxyXG5cclxuZnVuY3Rpb24gaW5wdXREZWJ1Z01lbnUoZ206IEJyZXcuR2FtZU1hc3Rlciwga2V5Y29kZTogbnVtYmVyKSA6IEJyZXcuRW51bXMuSUJyZXdFdmVudCB7XHJcbiAgICBsZXQgcGxheWVyID0gZ20uZ2V0UGxheWVyKClcclxuICAgIGxldCBtZW51X2VudHJpZXMgOiBBcnJheTxCcmV3LkVudW1zLklCcmV3R2VuZXJpY01lbnVFbnRyeT4gPSBbXVxyXG4gICAgbGV0IHBvd2VycyA9IHBsYXllci5nZXRQb3dlcnMoKVxyXG5cclxuICAgIG1lbnVfZW50cmllcy5wdXNoKHtcclxuICAgICAgICBlbnRyeU5hbWU6IFwiQ3JlYXRlIE1vYlwiLFxyXG4gICAgICAgIGVudHJ5VHlwZTogQnJldy5FbnVtcy5HZW5lcmljTWVudUVudHJ5VHlwZS5FdmVudEJhc2VkLFxyXG4gICAgICAgIGVudHJ5RXZlbnQ6IEJyZXcuRXZlbnRzLmNyZWF0ZUdlbmVyaWNFdmVudE9mVHlwZShnbSwgQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLkRlYnVnQ3JlYXRlTW9iTWVudU9uLCBmYWxzZSlcclxuICAgIH0pXHJcblxyXG4gICAgbWVudV9lbnRyaWVzLnB1c2goe1xyXG4gICAgICAgIGVudHJ5TmFtZTogXCJDcmVhdGUgRmVhdHVyZVwiLFxyXG4gICAgICAgIGVudHJ5VHlwZTogQnJldy5FbnVtcy5HZW5lcmljTWVudUVudHJ5VHlwZS5FdmVudEJhc2VkLFxyXG4gICAgICAgIGVudHJ5RXZlbnQ6IEJyZXcuRXZlbnRzLmNyZWF0ZUdlbmVyaWNFdmVudE9mVHlwZShnbSwgQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLkRlYnVnQ3JlYXRlRmVhdHVyZU1lbnVPbiwgZmFsc2UpXHJcbiAgICB9KVxyXG5cclxuICAgIG1lbnVfZW50cmllcy5wdXNoKHtcclxuICAgICAgICBlbnRyeU5hbWU6IFwiQ3JlYXRlIFRlcnJhaW5cIixcclxuICAgICAgICBlbnRyeVR5cGU6IEJyZXcuRW51bXMuR2VuZXJpY01lbnVFbnRyeVR5cGUuRXZlbnRCYXNlZCxcclxuICAgICAgICBlbnRyeUV2ZW50OiBCcmV3LkV2ZW50cy5jcmVhdGVHZW5lcmljRXZlbnRPZlR5cGUoZ20sIEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5EZWJ1Z0NyZWF0ZVRlcnJhaW5NZW51T24sIGZhbHNlKVxyXG4gICAgfSlcclxuXHJcbiAgICBsZXQgbWVudUV2ZW50IDogQnJldy5FbnVtcy5JQnJld0V2ZW50ID0ge1xyXG4gICAgICAgIGV2ZW50VHlwZTogQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLkdlbmVyaWNNZW51T24sXHJcbiAgICAgICAgYWN0b3I6IGdtLmdldFBsYXllcigpLFxyXG4gICAgICAgIHBsYXllckluaXRpYXRlZDogdHJ1ZSxcclxuICAgICAgICBlbmRzVHVybjogZmFsc2UsXHJcbiAgICAgICAgZ2VuZXJpY01lbnVEYXRhOiB7XHJcbiAgICAgICAgICAgIG1lbnVUaXRsZTogXCJEZWJ1Z1wiLFxyXG4gICAgICAgICAgICBhbGxvd0NhbmNlbDogdHJ1ZSxcclxuICAgICAgICAgICAgbWVudUVudHJpZXNMaXN0OiBtZW51X2VudHJpZXNcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbWVudUV2ZW50XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdldFNjcmVlbkNvb3Jkc0Zyb21Nb3VzZUV2ZW50KGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGRhdGE6IEJyZXcuRW51bXMuSUJyZXdJbnB1dERhdGEpIDogQnJldy5Db29yZGluYXRlIHtcclxuICAgIFxyXG4gICAgLy8gdXNlIFJPVCB0byB0cmFuc2xhdGUgb24gc2NyZWVuIGNvb3Jkc1xyXG4gICAgbGV0IHJvdF9jb29yZHMgOiBudW1iZXIgfCBbbnVtYmVyLCBudW1iZXJdXHJcbiAgICByb3RfY29vcmRzID0gZ20uZGlzcGxheS5nZXREaXNwbGF5KEJyZXcuRW51bXMuRGlzcGxheU5hbWVzLkdhbWUpLmV2ZW50VG9Qb3NpdGlvbihkYXRhLmpzZXZlbnQpXHJcbiAgICBcclxuICAgIGlmIChyb3RfY29vcmRzWzBdID09IC0xKSAgeyAvLyByb3Q6IGNvb3JkIG91dHNpZGUgb2YgY2FudmFzXHJcbiAgICAgICAgcmV0dXJuIG51bGxcclxuICAgIH1cclxuICAgIFxyXG4gICAgbGV0IHNjcmVlbl94eSA9IG5ldyBCcmV3LkNvb3JkaW5hdGUocm90X2Nvb3Jkc1swXSwgcm90X2Nvb3Jkc1sxXSlcclxuICAgIFxyXG4gICAgcmV0dXJuIHNjcmVlbl94eVxyXG59XHJcblxyXG5mdW5jdGlvbiB0cmFuc2xhdGVNb3VzZUlucHV0SW50b0V2ZW50KGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGRhdGE6IEJyZXcuRW51bXMuSUJyZXdJbnB1dERhdGEsIGVudmVsb3BlKSA6IEJyZXcuRW51bXMuSUJyZXdFdmVudCB7XHJcbiAgICBcclxuICAgIGxldCBzY3JlZW5feHkgPSBnZXRTY3JlZW5Db29yZHNGcm9tTW91c2VFdmVudChnbSwgZGF0YSlcclxuICAgIGlmICghKHNjcmVlbl94eSkpIHtcclxuICAgICAgICByZXR1cm4gaW5wdXRFcnJvcihcImNsaWNrIG91dHNpZGUgb2Ygc2NyZWVuXCIpXHJcbiAgICB9XHJcbiAgICBcclxuICAgIGxldCBtYXBfeHkgPSBnbS5kaXNwbGF5LmNvbnZlcnRTY3JlZW5Ub01hcChzY3JlZW5feHkpXHJcbiAgICBcclxuICAgIGlmIChkYXRhLmpzZXZlbnQudHlwZSAhPSBcIm1vdXNlZG93blwiKSB7XHJcbiAgICAgICAgcmV0dXJuIGlucHV0SG92ZXIoZ20sIG1hcF94eSlcclxuICAgIH1cclxuICAgIFxyXG4gICAgaWYgKGRhdGEuYnV0dG9uID09IDApIHtcclxuICAgICAgICAvLyByZWd1bGFyIGNsaWNrXHJcbiAgICAgICAgLy8gcmV0dXJuIGlucHV0Q2xpY2soZ20sIG1hcF94eSlcclxuICAgICAgICByZXR1cm4gaW5wdXRFcnJvcihcInRlbXBvcmFyaWx5IGRpc2FibGVkIGNsaWNraW5nXCIpXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vIHJldHVybiBpbnB1dEFsdENsaWNrKGdtLCBkYXRhLCBtYXBfeHkpXHJcbiAgICAgICAgcmV0dXJuIGlucHV0RXJyb3IoXCJubyBhbHQgY2xpY2tpbmcgYWxsb3dlZFwiKVxyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBpbnB1dEhvdmVyKGdtOiBCcmV3LkdhbWVNYXN0ZXIsIG1hcF94eTogQnJldy5Db29yZGluYXRlKSB7XHJcbiAgICBsZXQgaW5mb0V2ZW50IDogQnJldy5FbnVtcy5JQnJld0V2ZW50ID0ge1xyXG4gICAgICAgIGV2ZW50VHlwZTogQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLkluZm8sXHJcbiAgICAgICAgYWN0b3I6IGdtLmdldFBsYXllcigpLFxyXG4gICAgICAgIHBsYXllckluaXRpYXRlZDogdHJ1ZSxcclxuICAgICAgICBlbmRzVHVybjogZmFsc2UsXHJcbiAgICAgICAgbW92ZURhdGE6IHtcclxuICAgICAgICAgICAgZnJvbV94eTogbWFwX3h5LFxyXG4gICAgICAgICAgICB0b194eTogbWFwX3h5XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4gaW5mb0V2ZW50XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGlucHV0Q2xpY2soZ206IEJyZXcuR2FtZU1hc3RlciwgbWFwX3h5OiBCcmV3LkNvb3JkaW5hdGUpIHtcclxuICAgIGxldCBzcGVjaWFsRXZlbnQgOiBCcmV3LkVudW1zLklCcmV3RXZlbnQgPSB7XHJcbiAgICAgICAgZXZlbnRUeXBlOiBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuU3BlY2lhbCxcclxuICAgICAgICBhY3RvcjogZ20uZ2V0UGxheWVyKCksXHJcbiAgICAgICAgcGxheWVySW5pdGlhdGVkOiB0cnVlLFxyXG4gICAgICAgIGVuZHNUdXJuOiB0cnVlLFxyXG4gICAgICAgIG1vdmVEYXRhOiB7XHJcbiAgICAgICAgICAgIGZyb21feHk6IG51bGwsXHJcbiAgICAgICAgICAgIHRvX3h5OiBtYXBfeHlcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJldHVybiBzcGVjaWFsRXZlbnRcclxufVxyXG4gICAgXHJcbmZ1bmN0aW9uIGlucHV0Qm9zc01vZGUoZ206IEJyZXcuR2FtZU1hc3Rlciwga2V5Y29kZTogbnVtYmVyKSA6IEJyZXcuRW51bXMuSUJyZXdFdmVudCB7XHJcbiAgICBCcmV3LkRlYnVnLnRvZ2dsZUJhY2tncm91bmRDb3ZlcihnbSlcclxuICAgIHJldHVybiBpbnB1dEVycm9yKFwib2tcIilcclxufVxyXG5cclxuZnVuY3Rpb24gaW5wdXRTY3JlZW5SZXNpemUoZ206IEJyZXcuR2FtZU1hc3Rlciwga2V5Y29kZTogbnVtYmVyKSA6IEJyZXcuRW51bXMuSUJyZXdFdmVudCB7XHJcbiAgICBcclxuICAgIGxldCBmb250X3NpemUgPSBnbS5kaXNwbGF5LmdldERpc3BsYXkoQnJldy5FbnVtcy5EaXNwbGF5TmFtZXMuR2FtZSkuZ2V0T3B0aW9ucygpLmZvbnRTaXplXHJcbiAgICBsZXQgbmV3X2ZvbnRfc2l6ZSA6IG51bWJlciBcclxuXHJcbiAgICBpZiAoQnJldy5LZXlNYXAuU2NyZWVuRW5sYXJnZS5pbmRleE9mKGtleWNvZGUpID4gLTEpIHtcclxuICAgICAgICBuZXdfZm9udF9zaXplID0gZm9udF9zaXplICsgMlxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBuZXdfZm9udF9zaXplID0gZm9udF9zaXplIC0gMlxyXG4gICAgfVxyXG5cclxuICAgIGZvciAobGV0IGRpc3Agb2YgW0JyZXcuRW51bXMuRGlzcGxheU5hbWVzLkdhbWUsIEJyZXcuRW51bXMuRGlzcGxheU5hbWVzLkhVRCwgQnJldy5FbnVtcy5EaXNwbGF5TmFtZXMuRm9vdGVyLCBCcmV3LkVudW1zLkRpc3BsYXlOYW1lcy5IZWFkZXJdKSB7XHJcbiAgICAgICAgZ20uZGlzcGxheS5nZXREaXNwbGF5KGRpc3ApLnNldE9wdGlvbnMoeyBmb250U2l6ZTogbmV3X2ZvbnRfc2l6ZX0pXHJcbiAgICB9XHJcblxyXG4gICAgZ20uZGlzcGxheS5kcmF3QWxsKHt9KVxyXG4gICAgcmV0dXJuIGlucHV0RXJyb3IoXCJva1wiKVxyXG59XHJcblxyXG5mdW5jdGlvbiBpbnB1dEhlbHAoZ206IEJyZXcuR2FtZU1hc3RlcikgOiBCcmV3LkVudW1zLklCcmV3RXZlbnQge1xyXG4gICAgbGV0IGhlbHBFdmVudCA6IEJyZXcuRW51bXMuSUJyZXdFdmVudCA9IHtcclxuICAgICAgICBldmVudFR5cGU6IEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5IZWxwT24sXHJcbiAgICAgICAgYWN0b3I6IGdtLmdldFBsYXllcigpLFxyXG4gICAgICAgIHBsYXllckluaXRpYXRlZDogdHJ1ZSxcclxuICAgICAgICBlbmRzVHVybjogZmFsc2UsXHJcbiAgICAgICAgaGVscERhdGE6IHtcclxuICAgICAgICAgICAgc2VsZWN0ZWRfaW5kZXg6IDBcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gaGVscEV2ZW50XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhlbHBNZW51SGFuZGxlcihnbTogQnJldy5HYW1lTWFzdGVyLCBickV2ZW50OiBCcmV3LkVudW1zLklCcmV3SW5wdXREYXRhKSA6IEJyZXcuRW51bXMuSUJyZXdFdmVudCB7XHJcbiAgICBsZXQga2V5Y29kZSA9IGJyRXZlbnQuY29kZVxyXG4gICAgbGV0IGhlbHBFdmVudCA6IEJyZXcuRW51bXMuSUJyZXdFdmVudFxyXG4gICAgbGV0IHByZXZNZW51RXZlbnQgPSBnbS5nZXRMYXN0RXZlbnQoKVxyXG5cclxuICAgIGlmICgoQnJldy5LZXlNYXAuRXNjYXBlLmluZGV4T2Yoa2V5Y29kZSkgPiAtMSkgfHwgKEJyZXcuS2V5TWFwLkFjdGlvbi5pbmRleE9mKGtleWNvZGUpID4gLTEpIHx8IChCcmV3LktleU1hcC5IZWxwLmluZGV4T2Yoa2V5Y29kZSkgPiAtMSkpIHtcclxuICAgICAgICByZXR1cm4gQnJldy5FdmVudHMuY3JlYXRlR2VuZXJpY0V2ZW50T2ZUeXBlKGdtLCBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuR2VuZXJpY01lbnVPZmYsIGZhbHNlKVxyXG4gICAgXHJcbiAgICB9IGVsc2UgaWYgKEJyZXcuS2V5TWFwLk1vdmVtZW50S2V5cy5pbmRleE9mKGtleWNvZGUpID4gLTEpIHtcclxuICAgICAgICBsZXQgY3ljbGVfZGlyID0gZ2V0Q3ljbGVJbmNyZW1lbnRWYWx1ZUZyb21LZXlwcmVzcyhrZXljb2RlKVxyXG4gICAgICAgIGxldCBuZXdfcGFnZV9pbmRleCA9IEJyZXcuVXRpbHMubW9kKHByZXZNZW51RXZlbnQuaGVscERhdGEuc2VsZWN0ZWRfaW5kZXggKyBjeWNsZV9kaXIsIEJyZXcuVGFuay5oZWxwTWVzc2FnZXMubGVuZ3RoKVxyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKG5ld19wYWdlX2luZGV4LCBwcmV2TWVudUV2ZW50LmhlYWRzVXBEYXRhLmhlYWRzVXBEaXNwbGF5Tm90ZVBhZ2VzLmxlbmd0aClcclxuICAgICAgICBoZWxwRXZlbnQgPSB7XHJcbiAgICAgICAgICAgIGV2ZW50VHlwZTogQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLkhlbHBPbixcclxuICAgICAgICAgICAgYWN0b3I6IGdtLmdldFBsYXllcigpLFxyXG4gICAgICAgICAgICBwbGF5ZXJJbml0aWF0ZWQ6IHRydWUsXHJcbiAgICAgICAgICAgIGVuZHNUdXJuOiBmYWxzZSxcclxuICAgICAgICAgICAgaGVscERhdGE6IHtcclxuICAgICAgICAgICAgICAgIC8vIGhlYWRzVXBEaXNwbGF5Tm90ZVBhZ2VzOiBwcmV2TWVudUV2ZW50LmhlYWRzVXBEYXRhLmhlYWRzVXBEaXNwbGF5Tm90ZVBhZ2VzLFxyXG4gICAgICAgICAgICAgICAgc2VsZWN0ZWRfaW5kZXg6IG5ld19wYWdlX2luZGV4LFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiBoZWxwRXZlbnRcclxuICAgICAgICBcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIGlucHV0RXJyb3IoXCJoZWxwIG1lbnUgLSB1bmtub3duIGtleXByZXNzXCIpXHJcbiAgICB9XHJcbn1cclxuXHJcbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/brew_engine/input.ts\n");

/***/ }),

/***/ "./src/brew_engine/intel.ts":
/*!**********************************!*\
  !*** ./src/brew_engine/intel.ts ***!
  \**********************************/
/*! exports provided: mainAiHandler, getPathFromAStar, runBeforePlayerTurn, runAfterPlayerTurn, isPlayer, updateFov, updateMemoryAt, isEnemy, getMonstersKnownBy, getItemsKnownBy */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"mainAiHandler\", function() { return mainAiHandler; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getPathFromAStar\", function() { return getPathFromAStar; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"runBeforePlayerTurn\", function() { return runBeforePlayerTurn; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"runAfterPlayerTurn\", function() { return runAfterPlayerTurn; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isPlayer\", function() { return isPlayer; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"updateFov\", function() { return updateFov; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"updateMemoryAt\", function() { return updateMemoryAt; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isEnemy\", function() { return isEnemy; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getMonstersKnownBy\", function() { return getMonstersKnownBy; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getItemsKnownBy\", function() { return getItemsKnownBy; });\n/* harmony import */ var rot_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! rot-js */ \"./node_modules/rot-js/lib/rot.js\");\n/* harmony import */ var rot_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(rot_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _brew__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../brew */ \"./src/brew.ts\");\n\r\n\r\nfunction alliedMonsterHandler(gm, actor) {\r\n    let allyEvent;\r\n    let target_list = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Targeting\"].getClosestTargets(gm, actor).filter((m, index, array) => {\r\n        return m.team == _brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].Team.Enemy;\r\n    });\r\n    if (target_list.length == 0) {\r\n        // no targets, do we know where the player is?\r\n        if (!(actor.hasKnowledgeOf(gm.getPlayer()))) {\r\n            let movingNotWaiting = false;\r\n            // do we have a last known location for the player?\r\n            if (actor.destination_xy) {\r\n                let move_xy = getNextStepFromAStar(gm, actor, actor.destination_xy);\r\n                if (move_xy) {\r\n                    movingNotWaiting = true;\r\n                    allyEvent = {\r\n                        eventType: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].BrewEventType.Move,\r\n                        actor: actor,\r\n                        endsTurn: true,\r\n                        playerInitiated: false,\r\n                        moveData: {\r\n                            from_xy: actor.location.clone(),\r\n                            to_xy: move_xy.clone()\r\n                        }\r\n                    };\r\n                }\r\n            }\r\n            if (!(movingNotWaiting)) {\r\n                // if not, wait\r\n                allyEvent = {\r\n                    eventType: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].BrewEventType.Wait,\r\n                    actor: actor,\r\n                    endsTurn: true,\r\n                    playerInitiated: false\r\n                };\r\n            }\r\n        }\r\n        else {\r\n            // got the player, hover around\r\n            let dist_from_player = Math.floor(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Utils\"].dist2d(actor.location, gm.getPlayer().location));\r\n            let hover_range = Math.max(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Config\"].ally_hover_range, actor.attack_range);\r\n            // let hover_range = Config.ally_hover_range\r\n            let move_xy = actor.location;\r\n            // update last known location\r\n            actor.destination_xy = gm.getPlayer().location.clone();\r\n            let goal_type;\r\n            let event_type = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].BrewEventType.Move;\r\n            if (dist_from_player < hover_range) {\r\n                goal_type = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Path\"].PathmapGoalType.EscapeTarget;\r\n                let travel_pathmap = getAppropriatePathmap(gm, goal_type, actor, false);\r\n                move_xy = travel_pathmap.getUnblockedDownhillNeighbor(actor.location, gm.getCurrentLevel(), true);\r\n                if ((!(move_xy)) || (move_xy.compare(actor.location))) {\r\n                    event_type = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].BrewEventType.Wait;\r\n                }\r\n            }\r\n            else {\r\n                // goal_type = Brew.Path.PathmapGoalType.ToTarget\r\n                move_xy = getNextStepFromAStar(gm, actor, actor.destination_xy);\r\n                if ((!(move_xy)) || (move_xy.compare(actor.location))) {\r\n                    event_type = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].BrewEventType.Wait;\r\n                }\r\n            }\r\n            allyEvent = {\r\n                eventType: event_type,\r\n                actor: actor,\r\n                endsTurn: true,\r\n                playerInitiated: false,\r\n                moveData: {\r\n                    from_xy: actor.location.clone(),\r\n                    to_xy: move_xy.clone()\r\n                }\r\n            };\r\n        }\r\n    }\r\n    else {\r\n        // let's hunt the nearest target...\r\n        // let first_target = target_list[0]\r\n        // let reposition_result = aiHuntReposition(gm, actor, first_target)\r\n        // if (reposition_result.shouldMove) {\r\n        // allyEvent = reposition_result.moveEvent\r\n        // } else {\r\n        // allyEvent = aiHuntTarget(gm, actor, first_target)\r\n        // }\r\n        let first_target = target_list[0];\r\n        allyEvent = aiHuntTarget(gm, actor, first_target);\r\n        // allyEvent = {\r\n        //     eventType: Brew.Enums.BrewEventType.Attack,\r\n        //     actor: actor,\r\n        //     endsTurn: true,\r\n        //     playerInitiated: false,\r\n        //     attackData: {\r\n        //         from_xy: actor.location.clone(),\r\n        //         to_xy: target.location.clone(),\r\n        //         target: target,\r\n        //         isMelee: (actor.attack_range == 1),\r\n        //         damage: 1\r\n        //     }\r\n        // }\r\n    }\r\n    return allyEvent;\r\n}\r\nfunction aiWander(gm, actor) {\r\n    // if we dont have a wander destination, get one\r\n    if (!(actor.destination_xy)) {\r\n        actor.destination_xy = getSafeLocation(gm, actor);\r\n        actor.giveup = 0;\r\n    }\r\n    if (actor.location.compare(actor.destination_xy)) {\r\n        // reached our destination, get a new one\r\n        actor.destination_xy = getSafeLocation(gm, actor);\r\n        actor.giveup = 0;\r\n    }\r\n    else {\r\n        // haven't reached our destination yet\r\n        if (actor.giveup > 4) {\r\n            // waited too long, get a new one\r\n            actor.destination_xy = getSafeLocation(gm, actor);\r\n            actor.giveup = 0;\r\n            console.log(`${actor.name} gives up`);\r\n        }\r\n        else {\r\n            // keep our existing destination\r\n        }\r\n    }\r\n    // go toward destination if possible\r\n    let wanderEvent;\r\n    let new_xy = getNextStepFromAStar(gm, actor, actor.destination_xy);\r\n    if (new_xy) {\r\n        // got a valid path\r\n        wanderEvent = {\r\n            eventType: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].BrewEventType.Move,\r\n            actor: actor,\r\n            playerInitiated: false,\r\n            endsTurn: true,\r\n            moveData: {\r\n                from_xy: actor.location.clone(),\r\n                to_xy: new_xy\r\n            }\r\n        };\r\n    }\r\n    else {\r\n        // couldn't pathfind, increase giveup count\r\n        actor.giveup += 1;\r\n        wanderEvent = {\r\n            eventType: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].BrewEventType.Wait,\r\n            actor: actor,\r\n            playerInitiated: false,\r\n            endsTurn: true\r\n        };\r\n    }\r\n    return wanderEvent;\r\n}\r\nfunction findNearbyPackMembers(gm, actor, target) {\r\n    let level = gm.getCurrentLevel();\r\n    let monsters = level.monsters.getAllThings().filter((m, index, array) => {\r\n        return ((actor.hasKnowledgeOf(m)) &&\r\n            (!(m.isSameThing(actor))) &&\r\n            (!(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Intel\"].isEnemy(actor, m))) &&\r\n            (m.isType(actor.getDefinition())));\r\n    });\r\n    return monsters;\r\n}\r\nfunction aiHuntReposition(gm, actor, target) {\r\n    //\r\n    let repositionEvent;\r\n    let dist;\r\n    let pathmap;\r\n    let new_xy;\r\n    // \r\n    let response = {\r\n        shouldMove: false\r\n    };\r\n    if (actor.hasFlag(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].Flag.Immobile)) {\r\n        return response;\r\n    }\r\n    // figure out how close we are to our closest target\r\n    dist = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Utils\"].dist2d(actor.location, target.location);\r\n    // let pathmap_to = getAppropriatePathmap(gm, Brew.Path.PathmapGoalType.ToTarget, actor)\r\n    // let path_value = pathmap_to.field.getAt(actor.location)\r\n    // if (!(path_value)) { throw new Error(\"missing pathmap value at location\")}\r\n    // use distance because we may not be able to see someone\r\n    // check pack\r\n    let pack_attack = actor.hasFlag(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].Flag.PackAttack);\r\n    let pack_members = findNearbyPackMembers(gm, actor, target);\r\n    let attack_range;\r\n    let keeps_distance;\r\n    if (pack_attack && (pack_members.length < (_brew__WEBPACK_IMPORTED_MODULE_1__[\"Config\"].pack_attack_size - 1))) {\r\n        attack_range = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Config\"].pack_distance;\r\n        keeps_distance = true;\r\n    }\r\n    else {\r\n        attack_range = actor.attack_range;\r\n        keeps_distance = actor.hasFlag(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].Flag.KeepsDistance);\r\n    }\r\n    // check keeps distance\r\n    if (keeps_distance) {\r\n        if (dist < (attack_range - 1)) {\r\n            // move away\r\n            response.shouldMove = true;\r\n            pathmap = getAppropriatePathmap(gm, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Path\"].PathmapGoalType.EscapeTarget, actor, false);\r\n            new_xy = pathmap.getUnblockedDownhillNeighbor(actor.location, gm.getCurrentLevel());\r\n        }\r\n        else if (dist > attack_range) {\r\n            // move closer\r\n            response.shouldMove = true;\r\n            // ranged shooters can still probably (??) shoot over chasms\r\n            let useRangedAttackOverride = (actor.attack_range > 1);\r\n            pathmap = getAppropriatePathmap(gm, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Path\"].PathmapGoalType.ToTarget, actor, useRangedAttackOverride);\r\n            new_xy = pathmap.getUnblockedDownhillNeighbor(actor.location, gm.getCurrentLevel());\r\n            if (useRangedAttackOverride && (!(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Movement\"].canMoveToLocation(gm, actor, new_xy)))) {\r\n                pathmap = getAppropriatePathmap(gm, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Path\"].PathmapGoalType.EscapeTarget, actor, false);\r\n                new_xy = pathmap.getUnblockedDownhillNeighbor(actor.location, gm.getCurrentLevel());\r\n            }\r\n        }\r\n        if (response.shouldMove) {\r\n            if (new_xy) {\r\n                // valid movement from pathmap\r\n                response.moveEvent = {\r\n                    eventType: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].BrewEventType.Move,\r\n                    actor: actor,\r\n                    playerInitiated: false,\r\n                    endsTurn: true,\r\n                    moveData: {\r\n                        from_xy: actor.location.clone(),\r\n                        to_xy: new_xy\r\n                    }\r\n                };\r\n            }\r\n            else {\r\n                // invalid pathmap response, no move event\r\n                response.shouldMove = false;\r\n            }\r\n        }\r\n    }\r\n    // for everyone else, move unless we can attack\r\n    if ((!(response.shouldMove)) && (dist > actor.attack_range)) {\r\n        // move closer\r\n        response.shouldMove = true;\r\n        new_xy = getNextStepFromAStar(gm, actor, target.location.clone());\r\n        if (new_xy) {\r\n            // valid movement from AStar\r\n            response.moveEvent = {\r\n                eventType: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].BrewEventType.Move,\r\n                actor: actor,\r\n                playerInitiated: false,\r\n                endsTurn: true,\r\n                moveData: {\r\n                    from_xy: actor.location.clone(),\r\n                    to_xy: new_xy\r\n                }\r\n            };\r\n        }\r\n        else {\r\n            // invalid AStar response, no move event\r\n            response.shouldMove = false;\r\n        }\r\n    }\r\n    return response;\r\n}\r\nfunction aiHunt(gm, actor) {\r\n    // step 0 - find closest threat\r\n    let target;\r\n    target = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Targeting\"].getClosestTarget(gm, actor);\r\n    return aiHuntTarget(gm, actor, target);\r\n}\r\nfunction aiHuntTarget(gm, actor, target) {\r\n    let dist;\r\n    let new_xy;\r\n    let pathmap;\r\n    let huntEvent;\r\n    let is_melee;\r\n    // step 1 - reposition if we need to\r\n    let reposition_result = aiHuntReposition(gm, actor, target);\r\n    if (reposition_result.shouldMove) {\r\n        huntEvent = reposition_result.moveEvent;\r\n        return huntEvent;\r\n    }\r\n    // step 2 - try and attack since we seem to be well positioned\r\n    let valid_attack = false;\r\n    dist = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Utils\"].dist2d(actor.location, target.location);\r\n    if (dist <= actor.attack_range) {\r\n        // inside attack range - make sure we can hit something\r\n        is_melee = (dist == 1);\r\n        huntEvent = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Targeting\"].createTestTargetingEvent(actor, target, 1, 2);\r\n        // make sure out path is clear\r\n        let rangedAttackCheck = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Targeting\"].checkTargetingPath(gm, huntEvent);\r\n        if (rangedAttackCheck.is_valid || is_melee) {\r\n            valid_attack = true;\r\n        }\r\n    }\r\n    if (!(valid_attack)) {\r\n        // one of two things - \r\n        // within range but something is blocking us\r\n        // outside attack range but apparently we didnt need to move?\r\n        console.log(`${actor.name}:${actor.getID()} is stuck`);\r\n        huntEvent = {\r\n            eventType: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].BrewEventType.Wait,\r\n            actor: actor,\r\n            playerInitiated: false,\r\n            endsTurn: true\r\n        };\r\n    }\r\n    return huntEvent;\r\n}\r\n// called from postal.js channel\r\nfunction mainAiHandler(gm, actor) {\r\n    if (actor.isType(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Definitions\"].MonsterType.Architect)) {\r\n        return _brew__WEBPACK_IMPORTED_MODULE_1__[\"Architect\"].architectAI(gm, actor);\r\n    }\r\n    // handle hacked/allied monsters\r\n    if (actor.team == _brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].Team.PlayerAllied) {\r\n        return alliedMonsterHandler(gm, actor);\r\n    }\r\n    if (actor.hasFlag(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].Flag.Stunned)) {\r\n        let stunnedEvent = {\r\n            eventType: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].BrewEventType.Wait,\r\n            actor: actor,\r\n            playerInitiated: false,\r\n            endsTurn: true\r\n        };\r\n        return stunnedEvent;\r\n    }\r\n    let level = gm.getCurrentLevel();\r\n    let player = gm.getPlayer();\r\n    // update FOV\r\n    // todo: need this every turn for each monster?\r\n    updateFov(gm, actor);\r\n    // change status\r\n    let is_changed;\r\n    is_changed = updateMonsterStatus(gm, actor);\r\n    // find action\r\n    let aiActionEvent;\r\n    if (actor.monster_status == _brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].MonsterStatus.Sleep) {\r\n        // do nothing\r\n        aiActionEvent = {\r\n            eventType: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].BrewEventType.Wait,\r\n            actor: actor,\r\n            playerInitiated: false,\r\n            endsTurn: true\r\n        };\r\n    }\r\n    else if (actor.monster_status == _brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].MonsterStatus.Wander) {\r\n        aiActionEvent = aiWander(gm, actor);\r\n    }\r\n    else if (actor.monster_status == _brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].MonsterStatus.Hunt) {\r\n        aiActionEvent = aiHunt(gm, actor);\r\n    }\r\n    else if (actor.monster_status == _brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].MonsterStatus.Escape) {\r\n        // todo: escape\r\n    }\r\n    else {\r\n        throw new Error(`unknown monster status ${actor.monster_status} for ${actor.getID()}`);\r\n    }\r\n    // adjust for targeting locks\r\n    if (aiActionEvent.eventType == _brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].BrewEventType.Attack) {\r\n        let needs_lock = actor.hasFlag(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].Flag.NeedsTargetLock);\r\n        let has_lock = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Targeting\"].hasTargetLock(actor, aiActionEvent.attackData.target);\r\n        if (needs_lock && (!(has_lock))) {\r\n            aiActionEvent.eventType = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].BrewEventType.AcquireTarget;\r\n        }\r\n    }\r\n    return aiActionEvent;\r\n}\r\nfunction updateMonsterStatus(gm, actor) {\r\n    let init_status = actor.monster_status;\r\n    let new_status;\r\n    let player_in_fov = actor.inFOV(gm.getPlayer()) && (!(gm.getPlayer().hasFlag(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].Flag.Invisible)));\r\n    let enemy_in_view = false;\r\n    _brew__WEBPACK_IMPORTED_MODULE_1__[\"Targeting\"].getClosestTargets(gm, actor).forEach((m, index, array) => {\r\n        if ([_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].Team.Player, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].Team.PlayerAllied].indexOf(m.team) > -1) {\r\n            enemy_in_view = true;\r\n        }\r\n    });\r\n    if (actor.monster_status == _brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].MonsterStatus.Sleep) {\r\n        new_status = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].MonsterStatus.Sleep;\r\n    }\r\n    else if (actor.monster_status == _brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].MonsterStatus.Wander) {\r\n        if (player_in_fov || enemy_in_view) {\r\n            // see the player for the 'first' time\r\n            new_status = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].MonsterStatus.Hunt;\r\n            actor.destination_xy = gm.getPlayer().location;\r\n        }\r\n        else {\r\n            // keep wandering\r\n            new_status = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].MonsterStatus.Wander;\r\n        }\r\n    }\r\n    else if (actor.monster_status == _brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].MonsterStatus.Hunt) {\r\n        if (player_in_fov || enemy_in_view) {\r\n            // still hunting\r\n            new_status = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].MonsterStatus.Hunt;\r\n            actor.destination_xy = gm.getPlayer().location; // keep track of where we last saw the player\r\n        }\r\n        else {\r\n            // stop hunting\r\n            new_status = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].MonsterStatus.Wander;\r\n        }\r\n    }\r\n    else if (actor.monster_status == _brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].MonsterStatus.Escape) {\r\n        // todo: escape\r\n        new_status = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].MonsterStatus.Escape;\r\n    }\r\n    else {\r\n        throw new Error(`unknown monster status ${actor.monster_status} for ${actor.getID()}`);\r\n    }\r\n    actor.monster_status = new_status;\r\n    return init_status == new_status;\r\n}\r\nfunction getAppropriatePathmap(gm, goal_type, actor, rangedAttackOverride) {\r\n    let is_flying = actor.hasFlag(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].Flag.Flying) || rangedAttackOverride;\r\n    let use_escape = goal_type == _brew__WEBPACK_IMPORTED_MODULE_1__[\"Path\"].PathmapGoalType.EscapeTarget;\r\n    let pathmap;\r\n    if (is_flying && use_escape) {\r\n        pathmap = gm.pathmaps.getPathmap(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].PathmapCacheType.FromPlayer_Fly);\r\n    }\r\n    else if (is_flying && (!(use_escape))) {\r\n        pathmap = gm.pathmaps.getPathmap(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].PathmapCacheType.ToPlayer_Fly);\r\n    }\r\n    else if ((!(is_flying)) && use_escape) {\r\n        pathmap = gm.pathmaps.getPathmap(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].PathmapCacheType.FromPlayer_Walk);\r\n    }\r\n    else if ((!(is_flying)) && (!(use_escape))) {\r\n        pathmap = gm.pathmaps.getPathmap(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].PathmapCacheType.ToPlayer_Walk);\r\n    }\r\n    return pathmap;\r\n}\r\nfunction getNavigationType(gm, actor) {\r\n    if (actor.hasFlag(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].Flag.Flying)) {\r\n        return _brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].LevelNavigationType.Fly;\r\n    }\r\n    else {\r\n        return _brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].LevelNavigationType.Walk;\r\n    }\r\n}\r\nfunction getNextStepFromAStar(gm, actor, destination_xy) {\r\n    let path = getPathFromAStar(gm, actor, destination_xy);\r\n    if (path.length <= 1) {\r\n        return null;\r\n    }\r\n    else {\r\n        return path[1];\r\n    }\r\n}\r\nfunction getPathFromAStar(gm, actor, destination_xy, ignoreOtherMonsters = false) {\r\n    let level = gm.getCurrentLevel();\r\n    let fn_passable = (x, y) => {\r\n        let xy = new _brew__WEBPACK_IMPORTED_MODULE_1__[\"Coordinate\"](x, y);\r\n        if (!(level.isValid(xy))) {\r\n            return false;\r\n        }\r\n        if (level.monsters.hasAt(xy)) {\r\n            let monster_at = level.monsters.getAt(xy);\r\n            if (monster_at.isSameThing(actor)) {\r\n                return true;\r\n            }\r\n            else if (xy.compare(destination_xy)) {\r\n                return true;\r\n            }\r\n            else if (ignoreOtherMonsters) {\r\n                return true;\r\n            }\r\n            else {\r\n                return false;\r\n            }\r\n        }\r\n        // if (level.monsters.hasAt(xy) && (!(actor.location.compare(xy))))  {\r\n        //     return false\r\n        // }\r\n        let t = level.terrain.getAt(xy);\r\n        let can_move = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Movement\"].canMoveToLocation(gm, actor, xy);\r\n        return can_move;\r\n    };\r\n    let path = [];\r\n    let fn_update_path = (x, y) => {\r\n        // let xy = new Brew.Coordinate(x, y)\r\n        path.push(new _brew__WEBPACK_IMPORTED_MODULE_1__[\"Coordinate\"](x, y));\r\n    };\r\n    let astar = new rot_js__WEBPACK_IMPORTED_MODULE_0__[\"Path\"].AStar(destination_xy.x, destination_xy.y, fn_passable, { topology: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Config\"].rotjs_topology });\r\n    // let astar = new ROT.Path.Dijkstra(destination_xy.x, destination_xy.y, fn_passable, {topology: Brew.Config.rotjs_topology})\r\n    astar.compute(actor.location.x, actor.location.y, fn_update_path);\r\n    return path;\r\n}\r\nfunction getSafeLocation(gm, actor) {\r\n    // returns a walkable, monster-free location\r\n    let xy;\r\n    let tries = 0;\r\n    while (tries < 50) {\r\n        xy = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Utils\"].randomOf(gm.getCurrentLevel().getWalkableTiles());\r\n        if (!(gm.getCurrentLevel().monsters.hasAt(xy))) {\r\n            return xy;\r\n        }\r\n        tries += 1;\r\n    }\r\n    console.error(\"unable to find safe location\");\r\n    return null;\r\n}\r\nfunction runBeforePlayerTurn(gm, actor) {\r\n    gm.updateAllPathmaps();\r\n    let updates = updateFov(gm, actor);\r\n    gm.display.drawFooter();\r\n    gm.displayList(updates);\r\n}\r\nfunction runAfterPlayerTurn(gm, actor) {\r\n    // gm.pathmap_to_player = Brew.Path.createGenericMapToPlayer(gm, gm.getCurrentLevel())\r\n    // gm.pathmap_to_playerally = Brew.Path.createGenericMapToPlayerAlly(gm, gm.getCurrentLevel())\r\n    // gm.pathmap_from_player = Brew.Path.createMapFromPlayer(gm, gm.getCurrentLevel(), gm.pathmap_to_player)\r\n    // gm.pathmap_from_playerally = Brew.Path.createMapFromPlayer(gm, gm.getCurrentLevel(), gm.pathmap_to_playerally)\r\n    let updates;\r\n    let all_updates = [];\r\n    // update fov for everyone\r\n    gm.getCurrentLevel().monsters.getAllThings().forEach((mob) => {\r\n        if (isPlayer(gm, mob)) {\r\n            return;\r\n        }\r\n        updates = updateFov(gm, mob);\r\n        all_updates.concat(updates);\r\n    });\r\n    gm.displayList(all_updates);\r\n    gm.updateAllPathmaps();\r\n    gm.turn_count += 1;\r\n}\r\nfunction isPlayer(gm, actor) {\r\n    // return actor.isType(Brew.Definitions.MonsterType.Hero)\r\n    return actor.isSameThing(gm.getPlayer());\r\n}\r\nfunction createAllowVisionFn(gm, actor, active_range) {\r\n    let xy;\r\n    let level = gm.getCurrentLevel();\r\n    let t;\r\n    let fn_allow_vision = (x, y) => {\r\n        xy = new _brew__WEBPACK_IMPORTED_MODULE_1__[\"Coordinate\"](x, y);\r\n        // can never see outside the level\r\n        if (!(level.isValid(xy))) {\r\n            return false;\r\n        }\r\n        //  can always see where you are standing\r\n        if (xy.compare(actor.location)) {\r\n            return true;\r\n        }\r\n        if (_brew__WEBPACK_IMPORTED_MODULE_1__[\"Utils\"].dist2d(actor.location, xy) > active_range) {\r\n            return false;\r\n        }\r\n        t = level.terrain.getAt(xy);\r\n        return (!(t.blocks_vision));\r\n    };\r\n    return fn_allow_vision;\r\n}\r\nfunction updateFov(gm, actor) {\r\n    let old_fov = actor.fov.getAllCoordinates();\r\n    let xy;\r\n    let numberkey;\r\n    actor.clearFov();\r\n    actor.clearKnowledge();\r\n    let level = gm.getCurrentLevel();\r\n    let t;\r\n    let fn_allow_vision = createAllowVisionFn(gm, actor, actor.sight_range);\r\n    let fn_allow_vision_limited = createAllowVisionFn(gm, actor, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Config\"].local_sight_range);\r\n    // let fn_update_fov = (x, y, r, visibility) => {\r\n    let fn_update_fov = (x, y) => {\r\n        // TODO: also update level for lightcasting\r\n        // ye_level.setLightAt(new Brew.Coordinate(x, y), 1)\r\n        xy = new _brew__WEBPACK_IMPORTED_MODULE_1__[\"Coordinate\"](x, y);\r\n        if (level.isValid(xy)) {\r\n            actor.fov.setAt(xy, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].BrewVisionSource.xSelf);\r\n            updateMemoryAt(gm, actor, gm.getCurrentLevel().id, xy);\r\n            // check for monsters and add them to our knowledge\r\n            let m_at = level.monsters.getAt(xy);\r\n            if ((m_at) && (!(m_at.hasFlag(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].Flag.Invisible)))) {\r\n                actor.knowledge.setAt(xy, m_at);\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n    // debug fov: see all\r\n    if (isPlayer(gm, actor) && (_brew__WEBPACK_IMPORTED_MODULE_1__[\"Debug\"].debug_vision == _brew__WEBPACK_IMPORTED_MODULE_1__[\"Debug\"].Vision.ShowAll)) {\r\n        level.terrain.getAllCoordinates().forEach((xy, index, array) => {\r\n            actor.fov.setAt(xy, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].BrewVisionSource.xSelf);\r\n        });\r\n    }\r\n    else {\r\n        // otherwise, run FOV normally\r\n        // let rot_fov = new ROT.FOV.PreciseShadowcasting(fn_allow_vision, {})\r\n        // rot_fov.compute(actor.location.x, actor.location.y, actor.sight_range, fn_update_fov)\r\n        let view_direction = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Tank\"].getPrimaryFacingDirection(gm, actor);\r\n        let turretPower = actor.getPowers().getPowerOfType(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].BrewPowerType.TurretCannon);\r\n        _brew__WEBPACK_IMPORTED_MODULE_1__[\"FieldOfView\"].symmetricRecursiveShadowcasting_Directional(actor.location.x, actor.location.y, fn_allow_vision, fn_update_fov, view_direction);\r\n        _brew__WEBPACK_IMPORTED_MODULE_1__[\"FieldOfView\"].symmetricRecursiveShadowcasting(actor.location.x, actor.location.y, fn_allow_vision_limited, fn_update_fov);\r\n    }\r\n    // debug fov: add other monster view\r\n    // todo: add different types of view for shading/whatever (e.g. not just boolean true/false)\r\n    if (isPlayer(gm, actor) && (_brew__WEBPACK_IMPORTED_MODULE_1__[\"Debug\"].debug_vision == _brew__WEBPACK_IMPORTED_MODULE_1__[\"Debug\"].Vision.ShowMobs)) {\r\n        actor.clearFov();\r\n    }\r\n    // if player has remote scan on, then show other mob FOV\r\n    if ((isPlayer(gm, actor) && (_brew__WEBPACK_IMPORTED_MODULE_1__[\"Debug\"].debug_vision == _brew__WEBPACK_IMPORTED_MODULE_1__[\"Debug\"].Vision.ShowMobs)) ||\r\n        (isPlayer(gm, actor) && (actor.hasFlag(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].Flag.RemoteScan)))) {\r\n        // actor.clearFov()\r\n        level.monsters.getAllThings().forEach((mob, index, array) => {\r\n            if (mob.isSameThing(actor)) {\r\n                return;\r\n            }\r\n            mob.fov.getAllCoordinates().forEach((xy, index, array) => {\r\n                actor.fov.setAt(xy, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].BrewVisionSource.xRemote);\r\n            });\r\n        });\r\n    }\r\n    // let diff_xy_list = Brew.Utils.diffOfCoordinateArrays(old_fov, actor.fov.getAllCoordinates())\r\n    let old_fov_coords = new _brew__WEBPACK_IMPORTED_MODULE_1__[\"CoordinateArea\"](old_fov);\r\n    let new_fov_coords = new _brew__WEBPACK_IMPORTED_MODULE_1__[\"CoordinateArea\"](actor.fov.getAllCoordinates());\r\n    let diff_xy_list = old_fov_coords.getSymmetricDiff(new_fov_coords).getCoordinates();\r\n    return diff_xy_list;\r\n}\r\nfunction updateMemoryAt(gm, actor, level_id, xy) {\r\n    let level = gm.getCurrentLevel();\r\n    if (actor.memory.hasAt(xy)) {\r\n        actor.memory.removeAt(xy);\r\n    }\r\n    let terrain = level.terrain.getAt(xy);\r\n    actor.memory.setAt(xy, terrain);\r\n    let feature = level.features.getAt(xy);\r\n    if (feature && (!(terrain.alwaysOnTop))) {\r\n        actor.memory.removeAt(xy);\r\n        actor.memory.setAt(xy, feature);\r\n    }\r\n    let it = level.items.getAt(xy);\r\n    if (it) {\r\n        actor.memory.removeAt(xy);\r\n        actor.memory.setAt(xy, it);\r\n    }\r\n}\r\nfunction isEnemy(actor1, actor2) {\r\n    // todo: move this and canMove / can / is stuff to Brew.Utils or some other useful area\r\n    let is_enemy;\r\n    if (actor1.team == actor2.team) {\r\n        is_enemy = false;\r\n    }\r\n    else if (actor1.team == _brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].Team.Enemy) {\r\n        // is_enemy = ([Team.Player, Team.PlayerAllied].indexOf(actor2.team) > -1)\r\n        is_enemy = (actor2.team != _brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].Team.Enemy);\r\n    }\r\n    else {\r\n        is_enemy = (actor2.team == _brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].Team.Enemy);\r\n    }\r\n    return is_enemy;\r\n}\r\nfunction getMonstersKnownBy(gm, actor) {\r\n    // return all monsters that I know about except myself\r\n    let level = gm.getCurrentLevel();\r\n    return level.monsters.getAllThings().filter((m, index, array) => {\r\n        // let dist2d = Math.floor(Brew.Utils.dist2d(actor.location, m.location))\r\n        return ((actor.hasKnowledgeOf(m)) &&\r\n            (actor.fov.hasAt(m.location)) &&\r\n            (!(m.isSameThing(actor))));\r\n    });\r\n}\r\nfunction getItemsKnownBy(gm, actor) {\r\n    // return all monsters that I know about except myself\r\n    let level = gm.getCurrentLevel();\r\n    return level.items.getAllThings().filter((i, index, array) => {\r\n        // let dist2d = Math.floor(Brew.Utils.dist2d(actor.location, m.location))\r\n        return (\r\n        // (actor.hasKnowledgeOf(i)) &&\r\n        (actor.fov.hasAt(i.location)));\r\n    });\r\n}\r\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvYnJld19lbmdpbmUvaW50ZWwudHM/MTBiMSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUE2QjtBQUNFO0FBRS9CLDhCQUE4QixFQUFtQixFQUFFLEtBQThCO0lBRTdFLElBQUksU0FBaUM7SUFFckMsSUFBSSxXQUFXLEdBQUcsK0NBQWMsQ0FBQyxpQkFBaUIsQ0FBQyxFQUFFLEVBQUUsS0FBSyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsRUFBRTtRQUNyRixNQUFNLENBQUMsQ0FBQyxDQUFDLElBQUksSUFBSSwyQ0FBVSxDQUFDLElBQUksQ0FBQyxLQUFLO0lBQzFDLENBQUMsQ0FBQztJQUVGLEVBQUUsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxNQUFNLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUUxQiw4Q0FBOEM7UUFDOUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxjQUFjLENBQUMsRUFBRSxDQUFDLFNBQVMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFFMUMsSUFBSSxnQkFBZ0IsR0FBYSxLQUFLO1lBQ3RDLG1EQUFtRDtZQUNuRCxFQUFFLENBQUMsQ0FBQyxLQUFLLENBQUMsY0FBYyxDQUFDLENBQUMsQ0FBQztnQkFDdkIsSUFBSSxPQUFPLEdBQUcsb0JBQW9CLENBQUMsRUFBRSxFQUFFLEtBQUssRUFBRSxLQUFLLENBQUMsY0FBYyxDQUFDO2dCQUVuRSxFQUFFLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDO29CQUNWLGdCQUFnQixHQUFHLElBQUk7b0JBQ3ZCLFNBQVMsR0FBRzt3QkFDUixTQUFTLEVBQUUsMkNBQVUsQ0FBQyxhQUFhLENBQUMsSUFBSTt3QkFDeEMsS0FBSyxFQUFFLEtBQUs7d0JBQ1osUUFBUSxFQUFFLElBQUk7d0JBQ2QsZUFBZSxFQUFFLEtBQUs7d0JBQ3RCLFFBQVEsRUFB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LEtBQUssQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUM7WUFDN0IsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQzVCO0lBQ0wsQ0FBQyxDQUFDO0FBQ04sQ0FBQztBQUVLLHlCQUEwQixFQUFtQixFQUFFLEtBQThCO0lBQy9FLHNEQUFzRDtJQUN0RCxJQUFJLEtBQUssR0FBRyxFQUFFLENBQUMsZUFBZSxFQUFFO0lBRWhDLE1BQU0sQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLFlBQVksRUFBRSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLEVBQUU7UUFDekQseUVBQXlFO1FBQ3pFLE1BQU0sQ0FBQztRQUNILCtCQUErQjtRQUMvQixDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUNoQztJQUNMLENBQUMsQ0FBQztBQUNOLENBQUMiLCJmaWxlIjoiLi9zcmMvYnJld19lbmdpbmUvaW50ZWwudHMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBST1QgZnJvbSAncm90LWpzJ1xyXG5pbXBvcnQgKiBhcyBCcmV3IGZyb20gXCIuLi9icmV3XCJcclxuXHJcbmZ1bmN0aW9uIGFsbGllZE1vbnN0ZXJIYW5kbGVyKGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGFjdG9yOiBCcmV3LkdyaWRUaGluZ3MuTW9uc3RlcikgOiBCcmV3LkVudW1zLklCcmV3RXZlbnQge1xyXG4gICAgXHJcbiAgICBsZXQgYWxseUV2ZW50IDogQnJldy5FbnVtcy5JQnJld0V2ZW50XHJcblxyXG4gICAgbGV0IHRhcmdldF9saXN0ID0gQnJldy5UYXJnZXRpbmcuZ2V0Q2xvc2VzdFRhcmdldHMoZ20sIGFjdG9yKS5maWx0ZXIoKG0sIGluZGV4LCBhcnJheSkgPT4ge1xyXG4gICAgICAgIHJldHVybiBtLnRlYW0gPT0gQnJldy5FbnVtcy5UZWFtLkVuZW15XHJcbiAgICB9KVxyXG4gICAgXHJcbiAgICBpZiAodGFyZ2V0X2xpc3QubGVuZ3RoID09IDApIHtcclxuICAgICAgICBcclxuICAgICAgICAvLyBubyB0YXJnZXRzLCBkbyB3ZSBrbm93IHdoZXJlIHRoZSBwbGF5ZXIgaXM/XHJcbiAgICAgICAgaWYgKCEoYWN0b3IuaGFzS25vd2xlZGdlT2YoZ20uZ2V0UGxheWVyKCkpKSkge1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgbGV0IG1vdmluZ05vdFdhaXRpbmcgOiBib29sZWFuID0gZmFsc2VcclxuICAgICAgICAgICAgLy8gZG8gd2UgaGF2ZSBhIGxhc3Qga25vd24gbG9jYXRpb24gZm9yIHRoZSBwbGF5ZXI/XHJcbiAgICAgICAgICAgIGlmIChhY3Rvci5kZXN0aW5hdGlvbl94eSkge1xyXG4gICAgICAgICAgICAgICAgbGV0IG1vdmVfeHkgPSBnZXROZXh0U3RlcEZyb21BU3RhcihnbSwgYWN0b3IsIGFjdG9yLmRlc3RpbmF0aW9uX3h5KVxyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBpZiAobW92ZV94eSkge1xyXG4gICAgICAgICAgICAgICAgICAgIG1vdmluZ05vdFdhaXRpbmcgPSB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgYWxseUV2ZW50ID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBldmVudFR5cGU6IEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5Nb3ZlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY3RvcjogYWN0b3IsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuZHNUdXJuOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXJJbml0aWF0ZWQ6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBtb3ZlRGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnJvbV94eTogYWN0b3IubG9jYXRpb24uY2xvbmUoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvX3h5OiBtb3ZlX3h5LmNsb25lKClcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgaWYgKCEobW92aW5nTm90V2FpdGluZykpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBpZiBub3QsIHdhaXRcclxuICAgICAgICAgICAgICAgIGFsbHlFdmVudCA9IHtcclxuICAgICAgICAgICAgICAgICAgICBldmVudFR5cGU6IEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5XYWl0LFxyXG4gICAgICAgICAgICAgICAgICAgIGFjdG9yOiBhY3RvcixcclxuICAgICAgICAgICAgICAgICAgICBlbmRzVHVybjogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBwbGF5ZXJJbml0aWF0ZWQ6IGZhbHNlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gZ290IHRoZSBwbGF5ZXIsIGhvdmVyIGFyb3VuZFxyXG4gICAgICAgICAgICBsZXQgZGlzdF9mcm9tX3BsYXllciA9IE1hdGguZmxvb3IoQnJldy5VdGlscy5kaXN0MmQoYWN0b3IubG9jYXRpb24sIGdtLmdldFBsYXllcigpLmxvY2F0aW9uKSlcclxuICAgICAgICAgICAgbGV0IGhvdmVyX3JhbmdlID0gTWF0aC5tYXgoQnJldy5Db25maWcuYWxseV9ob3Zlcl9yYW5nZSwgYWN0b3IuYXR0YWNrX3JhbmdlKVxyXG4gICAgICAgICAgICAvLyBsZXQgaG92ZXJfcmFuZ2UgPSBDb25maWcuYWxseV9ob3Zlcl9yYW5nZVxyXG4gICAgICAgICAgICBsZXQgbW92ZV94eSA9IGFjdG9yLmxvY2F0aW9uXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyB1cGRhdGUgbGFzdCBrbm93biBsb2NhdGlvblxyXG4gICAgICAgICAgICBhY3Rvci5kZXN0aW5hdGlvbl94eSA9IGdtLmdldFBsYXllcigpLmxvY2F0aW9uLmNsb25lKClcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGxldCBnb2FsX3R5cGUgOiBCcmV3LlBhdGguUGF0aG1hcEdvYWxUeXBlXHJcbiAgICAgICAgICAgIGxldCBldmVudF90eXBlIDogQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlID0gQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLk1vdmVcclxuXHJcbiAgICAgICAgICAgIGlmIChkaXN0X2Zyb21fcGxheWVyIDwgaG92ZXJfcmFuZ2UpIHtcclxuICAgICAgICAgICAgICAgIGdvYWxfdHlwZSA9IEJyZXcuUGF0aC5QYXRobWFwR29hbFR5cGUuRXNjYXBlVGFyZ2V0XHJcbiAgICAgICAgICAgICAgICBsZXQgdHJhdmVsX3BhdGhtYXAgOiBCcmV3LlBhdGguUGF0aG1hcCA9IGdldEFwcHJvcHJpYXRlUGF0aG1hcChnbSwgZ29hbF90eXBlLCBhY3RvciwgZmFsc2UpXHJcbiAgICAgICAgICAgICAgICBtb3ZlX3h5ID0gdHJhdmVsX3BhdGhtYXAuZ2V0VW5ibG9ja2VkRG93bmhpbGxOZWlnaGJvcihhY3Rvci5sb2NhdGlvbiwgZ20uZ2V0Q3VycmVudExldmVsKCksIHRydWUpXHJcbiAgICAgICAgICAgICAgICBpZiAoKCEobW92ZV94eSkpIHx8IChtb3ZlX3h5LmNvbXBhcmUoYWN0b3IubG9jYXRpb24pKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50X3R5cGUgPSBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuV2FpdFxyXG4gICAgICAgICAgICAgICAgfSAgICAgICAgICAgICBcclxuXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyBnb2FsX3R5cGUgPSBCcmV3LlBhdGguUGF0aG1hcEdvYWxUeXBlLlRvVGFyZ2V0XHJcblxyXG4gICAgICAgICAgICAgICAgbW92ZV94eSA9IGdldE5leHRTdGVwRnJvbUFTdGFyKGdtLCBhY3RvciwgYWN0b3IuZGVzdGluYXRpb25feHkpXHJcbiAgICAgICAgICAgICAgICBpZiAoKCEobW92ZV94eSkpIHx8IChtb3ZlX3h5LmNvbXBhcmUoYWN0b3IubG9jYXRpb24pKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50X3R5cGUgPSBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuV2FpdFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGFsbHlFdmVudCA9IHtcclxuICAgICAgICAgICAgICAgIGV2ZW50VHlwZTogZXZlbnRfdHlwZSxcclxuICAgICAgICAgICAgICAgIGFjdG9yOiBhY3RvcixcclxuICAgICAgICAgICAgICAgIGVuZHNUdXJuOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgcGxheWVySW5pdGlhdGVkOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgIG1vdmVEYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZnJvbV94eTogYWN0b3IubG9jYXRpb24uY2xvbmUoKSxcclxuICAgICAgICAgICAgICAgICAgICB0b194eTogbW92ZV94eS5jbG9uZSgpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy8gbGV0J3MgaHVudCB0aGUgbmVhcmVzdCB0YXJnZXQuLi5cclxuICAgICAgICAvLyBsZXQgZmlyc3RfdGFyZ2V0ID0gdGFyZ2V0X2xpc3RbMF1cclxuICAgICAgICAvLyBsZXQgcmVwb3NpdGlvbl9yZXN1bHQgPSBhaUh1bnRSZXBvc2l0aW9uKGdtLCBhY3RvciwgZmlyc3RfdGFyZ2V0KVxyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIGlmIChyZXBvc2l0aW9uX3Jlc3VsdC5zaG91bGRNb3ZlKSB7XHJcbiAgICAgICAgICAgIC8vIGFsbHlFdmVudCA9IHJlcG9zaXRpb25fcmVzdWx0Lm1vdmVFdmVudFxyXG4gICAgICAgIC8vIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIGFsbHlFdmVudCA9IGFpSHVudFRhcmdldChnbSwgYWN0b3IsIGZpcnN0X3RhcmdldClcclxuICAgICAgICAvLyB9XHJcbiAgICAgICAgbGV0IGZpcnN0X3RhcmdldCA9IHRhcmdldF9saXN0WzBdXHJcbiAgICAgICAgYWxseUV2ZW50ID0gYWlIdW50VGFyZ2V0KGdtLCBhY3RvciwgZmlyc3RfdGFyZ2V0KVxyXG5cclxuICAgICAgICAvLyBhbGx5RXZlbnQgPSB7XHJcbiAgICAgICAgLy8gICAgIGV2ZW50VHlwZTogQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLkF0dGFjayxcclxuICAgICAgICAvLyAgICAgYWN0b3I6IGFjdG9yLFxyXG4gICAgICAgIC8vICAgICBlbmRzVHVybjogdHJ1ZSxcclxuICAgICAgICAvLyAgICAgcGxheWVySW5pdGlhdGVkOiBmYWxzZSxcclxuICAgICAgICAvLyAgICAgYXR0YWNrRGF0YToge1xyXG4gICAgICAgIC8vICAgICAgICAgZnJvbV94eTogYWN0b3IubG9jYXRpb24uY2xvbmUoKSxcclxuICAgICAgICAvLyAgICAgICAgIHRvX3h5OiB0YXJnZXQubG9jYXRpb24uY2xvbmUoKSxcclxuICAgICAgICAvLyAgICAgICAgIHRhcmdldDogdGFyZ2V0LFxyXG4gICAgICAgIC8vICAgICAgICAgaXNNZWxlZTogKGFjdG9yLmF0dGFja19yYW5nZSA9PSAxKSxcclxuICAgICAgICAvLyAgICAgICAgIGRhbWFnZTogMVxyXG4gICAgICAgIC8vICAgICB9XHJcbiAgICAgICAgLy8gfVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBhbGx5RXZlbnRcclxufVxyXG5cclxuXHJcbmZ1bmN0aW9uIGFpV2FuZGVyKGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGFjdG9yOiBCcmV3LkdyaWRUaGluZ3MuTW9uc3RlcikgOiBCcmV3LkVudW1zLklCcmV3RXZlbnQge1xyXG5cclxuICAgIC8vIGlmIHdlIGRvbnQgaGF2ZSBhIHdhbmRlciBkZXN0aW5hdGlvbiwgZ2V0IG9uZVxyXG4gICAgaWYgKCEoYWN0b3IuZGVzdGluYXRpb25feHkpKSB7XHJcbiAgICAgICAgYWN0b3IuZGVzdGluYXRpb25feHkgPSBnZXRTYWZlTG9jYXRpb24oZ20sIGFjdG9yKVxyXG4gICAgICAgIGFjdG9yLmdpdmV1cCA9IDBcclxuICAgIH1cclxuICAgIFxyXG4gICAgaWYgKGFjdG9yLmxvY2F0aW9uLmNvbXBhcmUoYWN0b3IuZGVzdGluYXRpb25feHkpKSB7XHJcbiAgICAgICAgLy8gcmVhY2hlZCBvdXIgZGVzdGluYXRpb24sIGdldCBhIG5ldyBvbmVcclxuICAgICAgICBhY3Rvci5kZXN0aW5hdGlvbl94eSA9IGdldFNhZmVMb2NhdGlvbihnbSwgYWN0b3IpXHJcbiAgICAgICAgYWN0b3IuZ2l2ZXVwID0gMFxyXG4gICAgICAgICAgICBcclxuICAgIH0gZWxzZSAge1xyXG4gICAgICAgIC8vIGhhdmVuJ3QgcmVhY2hlZCBvdXIgZGVzdGluYXRpb24geWV0XHJcbiAgICAgICAgaWYgKGFjdG9yLmdpdmV1cCA+IDQpIHtcclxuICAgICAgICAgICAgLy8gd2FpdGVkIHRvbyBsb25nLCBnZXQgYSBuZXcgb25lXHJcbiAgICAgICAgICAgIGFjdG9yLmRlc3RpbmF0aW9uX3h5ID0gZ2V0U2FmZUxvY2F0aW9uKGdtLCBhY3RvcilcclxuICAgICAgICAgICAgYWN0b3IuZ2l2ZXVwID0gMFxyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgJHthY3Rvci5uYW1lfSBnaXZlcyB1cGApXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8ga2VlcCBvdXIgZXhpc3RpbmcgZGVzdGluYXRpb25cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIGdvIHRvd2FyZCBkZXN0aW5hdGlvbiBpZiBwb3NzaWJsZVxyXG4gICAgbGV0IHdhbmRlckV2ZW50IDogQnJldy5FbnVtcy5JQnJld0V2ZW50XHJcbiAgICBsZXQgbmV3X3h5ID0gZ2V0TmV4dFN0ZXBGcm9tQVN0YXIoZ20sIGFjdG9yLCBhY3Rvci5kZXN0aW5hdGlvbl94eSlcclxuICAgIFxyXG4gICAgaWYgKG5ld194eSkge1xyXG4gICAgICAgIC8vIGdvdCBhIHZhbGlkIHBhdGhcclxuICAgICAgICB3YW5kZXJFdmVudCA9IHtcclxuICAgICAgICAgICAgZXZlbnRUeXBlOiBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuTW92ZSxcclxuICAgICAgICAgICAgYWN0b3I6IGFjdG9yLFxyXG4gICAgICAgICAgICBwbGF5ZXJJbml0aWF0ZWQ6IGZhbHNlLFxyXG4gICAgICAgICAgICBlbmRzVHVybjogdHJ1ZSxcclxuICAgICAgICAgICAgbW92ZURhdGE6IHtcclxuICAgICAgICAgICAgICAgIGZyb21feHk6IGFjdG9yLmxvY2F0aW9uLmNsb25lKCksXHJcbiAgICAgICAgICAgICAgICB0b194eTogbmV3X3h5XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICAvLyBjb3VsZG4ndCBwYXRoZmluZCwgaW5jcmVhc2UgZ2l2ZXVwIGNvdW50XHJcbiAgICAgICAgYWN0b3IuZ2l2ZXVwICs9IDFcclxuICAgICAgICB3YW5kZXJFdmVudCA9IHtcclxuICAgICAgICAgICAgZXZlbnRUeXBlOiBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuV2FpdCxcclxuICAgICAgICAgICAgYWN0b3I6IGFjdG9yLFxyXG4gICAgICAgICAgICBwbGF5ZXJJbml0aWF0ZWQ6IGZhbHNlLFxyXG4gICAgICAgICAgICBlbmRzVHVybjogdHJ1ZVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gd2FuZGVyRXZlbnRcclxufVxyXG5cclxuaW50ZXJmYWNlIElSZXBvc2l0aW9uUmVzdWx0IHtcclxuICAgIHNob3VsZE1vdmU6IGJvb2xlYW5cclxuICAgIG1vdmVFdmVudD86IEJyZXcuRW51bXMuSUJyZXdFdmVudFxyXG59XHJcblxyXG5mdW5jdGlvbiBmaW5kTmVhcmJ5UGFja01lbWJlcnMoZ206IEJyZXcuR2FtZU1hc3RlciwgYWN0b3I6IEJyZXcuR3JpZFRoaW5ncy5Nb25zdGVyLCB0YXJnZXQ6IEJyZXcuR3JpZFRoaW5ncy5Nb25zdGVyKSA6IEFycmF5PEJyZXcuR3JpZFRoaW5ncy5Nb25zdGVyPiB7XHJcbiAgICBsZXQgbGV2ZWwgPSBnbS5nZXRDdXJyZW50TGV2ZWwoKVxyXG5cclxuICAgIGxldCBtb25zdGVycyA6IEFycmF5PEJyZXcuR3JpZFRoaW5ncy5Nb25zdGVyPiAgPSBsZXZlbC5tb25zdGVycy5nZXRBbGxUaGluZ3MoKS5maWx0ZXIoKG0sIGluZGV4LCBhcnJheSkgPT4ge1xyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgIChhY3Rvci5oYXNLbm93bGVkZ2VPZihtKSkgJiZcclxuICAgICAgICAgICAgKCEobS5pc1NhbWVUaGluZyhhY3RvcikpKSAmJlxyXG4gICAgICAgICAgICAoIShCcmV3LkludGVsLmlzRW5lbXkoYWN0b3IsIG0pKSkgJiZcclxuICAgICAgICAgICAgKG0uaXNUeXBlKGFjdG9yLmdldERlZmluaXRpb24oKSkpXHJcbiAgICAgICAgKVxyXG4gICAgfSlcclxuXHJcbiAgICByZXR1cm4gbW9uc3RlcnNcclxufVxyXG5cclxuZnVuY3Rpb24gYWlIdW50UmVwb3NpdGlvbihnbTogQnJldy5HYW1lTWFzdGVyLCBhY3RvcjogQnJldy5HcmlkVGhpbmdzLk1vbnN0ZXIsIHRhcmdldDogQnJldy5HcmlkVGhpbmdzLk1vbnN0ZXIpIDogSVJlcG9zaXRpb25SZXN1bHQge1xyXG4gICAgXHJcbiAgICAvL1xyXG4gICAgbGV0IHJlcG9zaXRpb25FdmVudCA6IEJyZXcuRW51bXMuSUJyZXdFdmVudFxyXG4gICAgbGV0IGRpc3QgOiBudW1iZXJcclxuICAgIGxldCBwYXRobWFwIDogQnJldy5QYXRoLlBhdGhtYXBcclxuICAgIGxldCBuZXdfeHkgOiBCcmV3LkNvb3JkaW5hdGVcclxuXHJcbiAgICAvLyBcclxuICAgIGxldCByZXNwb25zZSA6IElSZXBvc2l0aW9uUmVzdWx0ID0ge1xyXG4gICAgICAgIHNob3VsZE1vdmU6IGZhbHNlXHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGFjdG9yLmhhc0ZsYWcoQnJldy5FbnVtcy5GbGFnLkltbW9iaWxlKSkge1xyXG4gICAgICAgIHJldHVybiByZXNwb25zZVxyXG4gICAgfVxyXG5cclxuICAgIC8vIGZpZ3VyZSBvdXQgaG93IGNsb3NlIHdlIGFyZSB0byBvdXIgY2xvc2VzdCB0YXJnZXRcclxuICAgIGRpc3QgPSBCcmV3LlV0aWxzLmRpc3QyZChhY3Rvci5sb2NhdGlvbiwgdGFyZ2V0LmxvY2F0aW9uKVxyXG5cclxuICAgIC8vIGxldCBwYXRobWFwX3RvID0gZ2V0QXBwcm9wcmlhdGVQYXRobWFwKGdtLCBCcmV3LlBhdGguUGF0aG1hcEdvYWxUeXBlLlRvVGFyZ2V0LCBhY3RvcilcclxuICAgIC8vIGxldCBwYXRoX3ZhbHVlID0gcGF0aG1hcF90by5maWVsZC5nZXRBdChhY3Rvci5sb2NhdGlvbilcclxuICAgIC8vIGlmICghKHBhdGhfdmFsdWUpKSB7IHRocm93IG5ldyBFcnJvcihcIm1pc3NpbmcgcGF0aG1hcCB2YWx1ZSBhdCBsb2NhdGlvblwiKX1cclxuICAgIFxyXG4gICAgLy8gdXNlIGRpc3RhbmNlIGJlY2F1c2Ugd2UgbWF5IG5vdCBiZSBhYmxlIHRvIHNlZSBzb21lb25lXHJcblxyXG4gICAgLy8gY2hlY2sgcGFja1xyXG4gICAgbGV0IHBhY2tfYXR0YWNrID0gYWN0b3IuaGFzRmxhZyhCcmV3LkVudW1zLkZsYWcuUGFja0F0dGFjaylcclxuICAgIGxldCBwYWNrX21lbWJlcnMgPSBmaW5kTmVhcmJ5UGFja01lbWJlcnMoZ20sIGFjdG9yLCB0YXJnZXQpXHJcbiAgICBsZXQgYXR0YWNrX3JhbmdlIDogbnVtYmVyXHJcbiAgICBsZXQga2VlcHNfZGlzdGFuY2UgOiBib29sZWFuXHJcblxyXG4gICAgaWYgKHBhY2tfYXR0YWNrICYmIChwYWNrX21lbWJlcnMubGVuZ3RoIDwgKEJyZXcuQ29uZmlnLnBhY2tfYXR0YWNrX3NpemUgLSAxKSkpIHsgLy8gc2VsZiBpbmNsdWRlZFxyXG4gICAgICAgIGF0dGFja19yYW5nZSA9IEJyZXcuQ29uZmlnLnBhY2tfZGlzdGFuY2VcclxuICAgICAgICBrZWVwc19kaXN0YW5jZSA9IHRydWVcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgYXR0YWNrX3JhbmdlID0gYWN0b3IuYXR0YWNrX3JhbmdlXHJcbiAgICAgICAga2VlcHNfZGlzdGFuY2UgPSBhY3Rvci5oYXNGbGFnKEJyZXcuRW51bXMuRmxhZy5LZWVwc0Rpc3RhbmNlKVxyXG4gICAgfVxyXG5cclxuICAgIC8vIGNoZWNrIGtlZXBzIGRpc3RhbmNlXHJcbiAgICBpZiAoa2VlcHNfZGlzdGFuY2UpIHtcclxuXHJcbiAgICAgICAgaWYgKGRpc3QgPCAoYXR0YWNrX3JhbmdlIC0gMSkpIHtcclxuICAgICAgICAgICAgLy8gbW92ZSBhd2F5XHJcbiAgICAgICAgICAgIHJlc3BvbnNlLnNob3VsZE1vdmUgPSB0cnVlXHJcbiAgICAgICAgICAgIHBhdGhtYXAgPSBnZXRBcHByb3ByaWF0ZVBhdGhtYXAoZ20sIEJyZXcuUGF0aC5QYXRobWFwR29hbFR5cGUuRXNjYXBlVGFyZ2V0LCBhY3RvciwgZmFsc2UpXHJcbiAgICAgICAgICAgIG5ld194eSA9IHBhdGhtYXAuZ2V0VW5ibG9ja2VkRG93bmhpbGxOZWlnaGJvcihhY3Rvci5sb2NhdGlvbiwgZ20uZ2V0Q3VycmVudExldmVsKCkpXHJcblxyXG4gICAgICAgIH0gZWxzZSBpZiAoZGlzdCA+IGF0dGFja19yYW5nZSkge1xyXG4gICAgICAgICAgICAvLyBtb3ZlIGNsb3NlclxyXG4gICAgICAgICAgICByZXNwb25zZS5zaG91bGRNb3ZlID0gdHJ1ZVxyXG5cclxuICAgICAgICAgICAgLy8gcmFuZ2VkIHNob290ZXJzIGNhbiBzdGlsbCBwcm9iYWJseSAoPz8pIHNob290IG92ZXIgY2hhc21zXHJcbiAgICAgICAgICAgIGxldCB1c2VSYW5nZWRBdHRhY2tPdmVycmlkZSA9IChhY3Rvci5hdHRhY2tfcmFuZ2UgPiAxKVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcGF0aG1hcCA9IGdldEFwcHJvcHJpYXRlUGF0aG1hcChnbSwgQnJldy5QYXRoLlBhdGhtYXBHb2FsVHlwZS5Ub1RhcmdldCwgYWN0b3IsIHVzZVJhbmdlZEF0dGFja092ZXJyaWRlKVxyXG4gICAgICAgICAgICBuZXdfeHkgPSBwYXRobWFwLmdldFVuYmxvY2tlZERvd25oaWxsTmVpZ2hib3IoYWN0b3IubG9jYXRpb24sIGdtLmdldEN1cnJlbnRMZXZlbCgpKVxyXG5cclxuICAgICAgICAgICAgaWYgKHVzZVJhbmdlZEF0dGFja092ZXJyaWRlICYmICghKEJyZXcuTW92ZW1lbnQuY2FuTW92ZVRvTG9jYXRpb24oZ20sIGFjdG9yLCBuZXdfeHkpKSkpIHtcclxuICAgICAgICAgICAgICAgIHBhdGhtYXAgPSBnZXRBcHByb3ByaWF0ZVBhdGhtYXAoZ20sIEJyZXcuUGF0aC5QYXRobWFwR29hbFR5cGUuRXNjYXBlVGFyZ2V0LCBhY3RvciwgZmFsc2UpXHJcbiAgICAgICAgICAgICAgICBuZXdfeHkgPSBwYXRobWFwLmdldFVuYmxvY2tlZERvd25oaWxsTmVpZ2hib3IoYWN0b3IubG9jYXRpb24sIGdtLmdldEN1cnJlbnRMZXZlbCgpKSAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAocmVzcG9uc2Uuc2hvdWxkTW92ZSkge1xyXG4gICAgICAgICAgICBpZiAobmV3X3h5KSB7XHJcbiAgICAgICAgICAgICAgICAvLyB2YWxpZCBtb3ZlbWVudCBmcm9tIHBhdGhtYXBcclxuICAgICAgICAgICAgICAgIHJlc3BvbnNlLm1vdmVFdmVudCA9IHtcclxuICAgICAgICAgICAgICAgICAgICBldmVudFR5cGU6IEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5Nb3ZlLFxyXG4gICAgICAgICAgICAgICAgICAgIGFjdG9yOiBhY3RvcixcclxuICAgICAgICAgICAgICAgICAgICBwbGF5ZXJJbml0aWF0ZWQ6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgIGVuZHNUdXJuOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIG1vdmVEYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZyb21feHk6IGFjdG9yLmxvY2F0aW9uLmNsb25lKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvX3h5OiBuZXdfeHlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyBpbnZhbGlkIHBhdGhtYXAgcmVzcG9uc2UsIG5vIG1vdmUgZXZlbnRcclxuICAgICAgICAgICAgICAgIHJlc3BvbnNlLnNob3VsZE1vdmUgPSBmYWxzZVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIGZvciBldmVyeW9uZSBlbHNlLCBtb3ZlIHVubGVzcyB3ZSBjYW4gYXR0YWNrXHJcbiAgICBpZiAoKCEocmVzcG9uc2Uuc2hvdWxkTW92ZSkpICYmIChkaXN0ID4gYWN0b3IuYXR0YWNrX3JhbmdlKSkge1xyXG4gICAgICAgIC8vIG1vdmUgY2xvc2VyXHJcbiAgICAgICAgcmVzcG9uc2Uuc2hvdWxkTW92ZSA9IHRydWVcclxuXHJcbiAgICAgICAgbmV3X3h5ID0gZ2V0TmV4dFN0ZXBGcm9tQVN0YXIoZ20sIGFjdG9yLCB0YXJnZXQubG9jYXRpb24uY2xvbmUoKSlcclxuXHJcbiAgICAgICAgaWYgKG5ld194eSkge1xyXG4gICAgICAgICAgICAvLyB2YWxpZCBtb3ZlbWVudCBmcm9tIEFTdGFyXHJcbiAgICAgICAgICAgIHJlc3BvbnNlLm1vdmVFdmVudCA9IHtcclxuICAgICAgICAgICAgICAgIGV2ZW50VHlwZTogQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLk1vdmUsXHJcbiAgICAgICAgICAgICAgICBhY3RvcjogYWN0b3IsXHJcbiAgICAgICAgICAgICAgICBwbGF5ZXJJbml0aWF0ZWQ6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgZW5kc1R1cm46IHRydWUsXHJcbiAgICAgICAgICAgICAgICBtb3ZlRGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgIGZyb21feHk6IGFjdG9yLmxvY2F0aW9uLmNsb25lKCksXHJcbiAgICAgICAgICAgICAgICAgICAgdG9feHk6IG5ld194eVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gaW52YWxpZCBBU3RhciByZXNwb25zZSwgbm8gbW92ZSBldmVudFxyXG4gICAgICAgICAgICByZXNwb25zZS5zaG91bGRNb3ZlID0gZmFsc2VcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJldHVybiByZXNwb25zZSAgICAgICBcclxufVxyXG5cclxuZnVuY3Rpb24gYWlIdW50KGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGFjdG9yOiBCcmV3LkdyaWRUaGluZ3MuTW9uc3RlcikgOiBCcmV3LkVudW1zLklCcmV3RXZlbnQge1xyXG4gICAgLy8gc3RlcCAwIC0gZmluZCBjbG9zZXN0IHRocmVhdFxyXG4gICAgbGV0IHRhcmdldCA6IEJyZXcuR3JpZFRoaW5ncy5Nb25zdGVyXHJcbiAgICB0YXJnZXQgPSBCcmV3LlRhcmdldGluZy5nZXRDbG9zZXN0VGFyZ2V0KGdtLCBhY3RvcilcclxuICAgIHJldHVybiBhaUh1bnRUYXJnZXQoZ20sIGFjdG9yLCB0YXJnZXQpXHJcbn1cclxuXHJcblxyXG5mdW5jdGlvbiBhaUh1bnRUYXJnZXQoZ206IEJyZXcuR2FtZU1hc3RlciwgYWN0b3I6IEJyZXcuR3JpZFRoaW5ncy5Nb25zdGVyLCB0YXJnZXQ6IEJyZXcuR3JpZFRoaW5ncy5Nb25zdGVyKSA6IEJyZXcuRW51bXMuSUJyZXdFdmVudCB7XHJcblxyXG4gICAgbGV0IGRpc3Q6IG51bWJlclxyXG4gICAgbGV0IG5ld194eSA6IEJyZXcuQ29vcmRpbmF0ZVxyXG4gICAgbGV0IHBhdGhtYXAgOiBCcmV3LlBhdGguUGF0aG1hcFxyXG4gICAgbGV0IGh1bnRFdmVudCA6IEJyZXcuRW51bXMuSUJyZXdFdmVudFxyXG4gICAgbGV0IGlzX21lbGVlIDogYm9vbGVhblxyXG5cclxuICAgIC8vIHN0ZXAgMSAtIHJlcG9zaXRpb24gaWYgd2UgbmVlZCB0b1xyXG4gICAgbGV0IHJlcG9zaXRpb25fcmVzdWx0ID0gYWlIdW50UmVwb3NpdGlvbihnbSwgYWN0b3IsIHRhcmdldClcclxuICAgIGlmIChyZXBvc2l0aW9uX3Jlc3VsdC5zaG91bGRNb3ZlKSB7XHJcbiAgICAgICAgaHVudEV2ZW50ID0gcmVwb3NpdGlvbl9yZXN1bHQubW92ZUV2ZW50XHJcbiAgICAgICAgcmV0dXJuIGh1bnRFdmVudFxyXG4gICAgfVxyXG5cclxuICAgIC8vIHN0ZXAgMiAtIHRyeSBhbmQgYXR0YWNrIHNpbmNlIHdlIHNlZW0gdG8gYmUgd2VsbCBwb3NpdGlvbmVkXHJcbiAgICBsZXQgdmFsaWRfYXR0YWNrID0gZmFsc2VcclxuICAgIGRpc3QgPSBCcmV3LlV0aWxzLmRpc3QyZChhY3Rvci5sb2NhdGlvbiwgdGFyZ2V0LmxvY2F0aW9uKVxyXG4gICAgaWYgKGRpc3QgPD0gYWN0b3IuYXR0YWNrX3JhbmdlKSB7XHJcbiAgICAgICAgLy8gaW5zaWRlIGF0dGFjayByYW5nZSAtIG1ha2Ugc3VyZSB3ZSBjYW4gaGl0IHNvbWV0aGluZ1xyXG4gICAgICAgIGlzX21lbGVlID0gKGRpc3QgPT0gMSlcclxuXHJcbiAgICAgICAgaHVudEV2ZW50ID0gQnJldy5UYXJnZXRpbmcuY3JlYXRlVGVzdFRhcmdldGluZ0V2ZW50KGFjdG9yLCB0YXJnZXQsIDEsIDIpXHJcblxyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIG1ha2Ugc3VyZSBvdXQgcGF0aCBpcyBjbGVhclxyXG4gICAgICAgIGxldCByYW5nZWRBdHRhY2tDaGVjayA9IEJyZXcuVGFyZ2V0aW5nLmNoZWNrVGFyZ2V0aW5nUGF0aChnbSwgaHVudEV2ZW50KVxyXG4gICAgICAgIGlmIChyYW5nZWRBdHRhY2tDaGVjay5pc192YWxpZCB8fCBpc19tZWxlZSkge1xyXG4gICAgICAgICAgICB2YWxpZF9hdHRhY2sgPSB0cnVlXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGlmICghKHZhbGlkX2F0dGFjaykpIHtcclxuICAgICAgICAvLyBvbmUgb2YgdHdvIHRoaW5ncyAtIFxyXG4gICAgICAgIC8vIHdpdGhpbiByYW5nZSBidXQgc29tZXRoaW5nIGlzIGJsb2NraW5nIHVzXHJcbiAgICAgICAgLy8gb3V0c2lkZSBhdHRhY2sgcmFuZ2UgYnV0IGFwcGFyZW50bHkgd2UgZGlkbnQgbmVlZCB0byBtb3ZlP1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGAke2FjdG9yLm5hbWV9OiR7YWN0b3IuZ2V0SUQoKX0gaXMgc3R1Y2tgKVxyXG4gICAgICAgIGh1bnRFdmVudCA9IHtcclxuICAgICAgICAgICAgZXZlbnRUeXBlOiBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuV2FpdCxcclxuICAgICAgICAgICAgYWN0b3I6IGFjdG9yLFxyXG4gICAgICAgICAgICBwbGF5ZXJJbml0aWF0ZWQ6IGZhbHNlLFxyXG4gICAgICAgICAgICBlbmRzVHVybjogdHJ1ZVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gaHVudEV2ZW50XHJcbn1cclxuXHJcblxyXG5cclxuXHJcbi8vIGNhbGxlZCBmcm9tIHBvc3RhbC5qcyBjaGFubmVsXHJcbmV4cG9ydCBmdW5jdGlvbiBtYWluQWlIYW5kbGVyKGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGFjdG9yOiBCcmV3LkdyaWRUaGluZ3MuTW9uc3RlcikgOiBCcmV3LkVudW1zLklCcmV3RXZlbnQge1xyXG5cclxuICAgIGlmIChhY3Rvci5pc1R5cGUoQnJldy5EZWZpbml0aW9ucy5Nb25zdGVyVHlwZS5BcmNoaXRlY3QpKSB7XHJcbiAgICAgICAgcmV0dXJuIEJyZXcuQXJjaGl0ZWN0LmFyY2hpdGVjdEFJKGdtLCBhY3RvcilcclxuICAgIH1cclxuXHJcbiAgICAvLyBoYW5kbGUgaGFja2VkL2FsbGllZCBtb25zdGVyc1xyXG4gICAgaWYgKGFjdG9yLnRlYW0gPT0gQnJldy5FbnVtcy5UZWFtLlBsYXllckFsbGllZCkge1xyXG4gICAgICAgIHJldHVybiBhbGxpZWRNb25zdGVySGFuZGxlcihnbSwgYWN0b3IpXHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGFjdG9yLmhhc0ZsYWcoQnJldy5FbnVtcy5GbGFnLlN0dW5uZWQpKSB7XHJcbiAgICAgICAgbGV0IHN0dW5uZWRFdmVudCA9IHtcclxuICAgICAgICAgICAgZXZlbnRUeXBlOiBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuV2FpdCxcclxuICAgICAgICAgICAgYWN0b3I6IGFjdG9yLFxyXG4gICAgICAgICAgICBwbGF5ZXJJbml0aWF0ZWQ6IGZhbHNlLFxyXG4gICAgICAgICAgICBlbmRzVHVybjogdHJ1ZVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHN0dW5uZWRFdmVudFxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBsZXQgbGV2ZWwgPSBnbS5nZXRDdXJyZW50TGV2ZWwoKVxyXG4gICAgbGV0IHBsYXllciA9IGdtLmdldFBsYXllcigpXHJcbiAgICBcclxuICAgIC8vIHVwZGF0ZSBGT1ZcclxuICAgIC8vIHRvZG86IG5lZWQgdGhpcyBldmVyeSB0dXJuIGZvciBlYWNoIG1vbnN0ZXI/XHJcbiAgICB1cGRhdGVGb3YoZ20sIGFjdG9yKVxyXG5cclxuICAgIC8vIGNoYW5nZSBzdGF0dXNcclxuICAgIGxldCBpc19jaGFuZ2VkIDogYm9vbGVhblxyXG4gICAgaXNfY2hhbmdlZCA9IHVwZGF0ZU1vbnN0ZXJTdGF0dXMoZ20sIGFjdG9yKVxyXG4gICAgXHJcbiAgICAvLyBmaW5kIGFjdGlvblxyXG4gICAgbGV0IGFpQWN0aW9uRXZlbnQgOiBCcmV3LkVudW1zLklCcmV3RXZlbnRcclxuXHJcbiAgICBpZiAoYWN0b3IubW9uc3Rlcl9zdGF0dXMgPT0gQnJldy5FbnVtcy5Nb25zdGVyU3RhdHVzLlNsZWVwKSB7XHJcbiAgICAgICAgLy8gZG8gbm90aGluZ1xyXG4gICAgICAgIGFpQWN0aW9uRXZlbnQgPSB7XHJcbiAgICAgICAgICAgIGV2ZW50VHlwZTogQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLldhaXQsXHJcbiAgICAgICAgICAgIGFjdG9yOiBhY3RvcixcclxuICAgICAgICAgICAgcGxheWVySW5pdGlhdGVkOiBmYWxzZSxcclxuICAgICAgICAgICAgZW5kc1R1cm46IHRydWVcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICB9IGVsc2UgaWYgKGFjdG9yLm1vbnN0ZXJfc3RhdHVzID09IEJyZXcuRW51bXMuTW9uc3RlclN0YXR1cy5XYW5kZXIpIHtcclxuICAgICAgICBcclxuICAgICAgICBhaUFjdGlvbkV2ZW50ID0gYWlXYW5kZXIoZ20sIGFjdG9yKVxyXG4gICAgICAgIFxyXG4gICAgfSBlbHNlIGlmIChhY3Rvci5tb25zdGVyX3N0YXR1cyA9PSBCcmV3LkVudW1zLk1vbnN0ZXJTdGF0dXMuSHVudCkge1xyXG5cclxuICAgICAgICBhaUFjdGlvbkV2ZW50ID0gYWlIdW50KGdtLCBhY3RvcilcclxuXHJcbiAgICB9IGVsc2UgaWYgKGFjdG9yLm1vbnN0ZXJfc3RhdHVzID09IEJyZXcuRW51bXMuTW9uc3RlclN0YXR1cy5Fc2NhcGUpIHtcclxuICAgICAgICAvLyB0b2RvOiBlc2NhcGVcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGB1bmtub3duIG1vbnN0ZXIgc3RhdHVzICR7YWN0b3IubW9uc3Rlcl9zdGF0dXN9IGZvciAke2FjdG9yLmdldElEKCl9YClcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gYWRqdXN0IGZvciB0YXJnZXRpbmcgbG9ja3NcclxuICAgIGlmIChhaUFjdGlvbkV2ZW50LmV2ZW50VHlwZSA9PSBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuQXR0YWNrKSB7XHJcbiAgICAgICAgbGV0IG5lZWRzX2xvY2sgPSBhY3Rvci5oYXNGbGFnKEJyZXcuRW51bXMuRmxhZy5OZWVkc1RhcmdldExvY2spXHJcbiAgICAgICAgbGV0IGhhc19sb2NrID0gQnJldy5UYXJnZXRpbmcuaGFzVGFyZ2V0TG9jayhhY3RvciwgYWlBY3Rpb25FdmVudC5hdHRhY2tEYXRhLnRhcmdldClcclxuXHJcbiAgICAgICAgaWYgKG5lZWRzX2xvY2sgJiYgKCEoaGFzX2xvY2spKSkge1xyXG4gICAgICAgICAgICBhaUFjdGlvbkV2ZW50LmV2ZW50VHlwZSA9IEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5BY3F1aXJlVGFyZ2V0XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGFpQWN0aW9uRXZlbnRcclxufVxyXG5cclxuZnVuY3Rpb24gdXBkYXRlTW9uc3RlclN0YXR1cyhnbTogQnJldy5HYW1lTWFzdGVyLCBhY3RvcjogQnJldy5HcmlkVGhpbmdzLk1vbnN0ZXIpIDogYm9vbGVhbiB7XHJcbiAgICBsZXQgaW5pdF9zdGF0dXMgPSBhY3Rvci5tb25zdGVyX3N0YXR1c1xyXG4gICAgbGV0IG5ld19zdGF0dXMgOiBCcmV3LkVudW1zLk1vbnN0ZXJTdGF0dXNcclxuICAgIGxldCBwbGF5ZXJfaW5fZm92ID0gYWN0b3IuaW5GT1YoZ20uZ2V0UGxheWVyKCkpICYmICghKGdtLmdldFBsYXllcigpLmhhc0ZsYWcoQnJldy5FbnVtcy5GbGFnLkludmlzaWJsZSkpKVxyXG4gICAgbGV0IGVuZW15X2luX3ZpZXcgOiBib29sZWFuID0gZmFsc2VcclxuICAgIEJyZXcuVGFyZ2V0aW5nLmdldENsb3Nlc3RUYXJnZXRzKGdtLCBhY3RvcikuZm9yRWFjaCgobSwgaW5kZXgsIGFycmF5KSA9PiB7XHJcbiAgICAgICAgaWYgKFtCcmV3LkVudW1zLlRlYW0uUGxheWVyLCBCcmV3LkVudW1zLlRlYW0uUGxheWVyQWxsaWVkXS5pbmRleE9mKG0udGVhbSkgPiAtMSkge1xyXG4gICAgICAgICAgICBlbmVteV9pbl92aWV3ID0gdHJ1ZVxyXG4gICAgICAgIH1cclxuICAgIH0pXHJcblxyXG4gICAgaWYgKGFjdG9yLm1vbnN0ZXJfc3RhdHVzID09IEJyZXcuRW51bXMuTW9uc3RlclN0YXR1cy5TbGVlcCkge1xyXG4gICAgICAgIG5ld19zdGF0dXMgPSBCcmV3LkVudW1zLk1vbnN0ZXJTdGF0dXMuU2xlZXBcclxuICAgICAgICBcclxuICAgIH0gZWxzZSBpZiAoYWN0b3IubW9uc3Rlcl9zdGF0dXMgPT0gQnJldy5FbnVtcy5Nb25zdGVyU3RhdHVzLldhbmRlcikge1xyXG4gICAgICAgIGlmIChwbGF5ZXJfaW5fZm92IHx8IGVuZW15X2luX3ZpZXcpIHtcclxuICAgICAgICAgICAgLy8gc2VlIHRoZSBwbGF5ZXIgZm9yIHRoZSAnZmlyc3QnIHRpbWVcclxuICAgICAgICAgICAgbmV3X3N0YXR1cyA9IEJyZXcuRW51bXMuTW9uc3RlclN0YXR1cy5IdW50ICBcclxuICAgICAgICAgICAgYWN0b3IuZGVzdGluYXRpb25feHkgPSBnbS5nZXRQbGF5ZXIoKS5sb2NhdGlvblxyXG4gICAgICAgICAgICBcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBrZWVwIHdhbmRlcmluZ1xyXG4gICAgICAgICAgICBuZXdfc3RhdHVzID0gQnJldy5FbnVtcy5Nb25zdGVyU3RhdHVzLldhbmRlclxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgIH0gZWxzZSBpZiAoYWN0b3IubW9uc3Rlcl9zdGF0dXMgPT0gQnJldy5FbnVtcy5Nb25zdGVyU3RhdHVzLkh1bnQpIHtcclxuICAgICAgICBpZiAocGxheWVyX2luX2ZvdiB8fCBlbmVteV9pbl92aWV3KSB7XHJcbiAgICAgICAgICAgIC8vIHN0aWxsIGh1bnRpbmdcclxuICAgICAgICAgICAgbmV3X3N0YXR1cyA9IEJyZXcuRW51bXMuTW9uc3RlclN0YXR1cy5IdW50XHJcbiAgICAgICAgICAgIGFjdG9yLmRlc3RpbmF0aW9uX3h5ID0gZ20uZ2V0UGxheWVyKCkubG9jYXRpb24gLy8ga2VlcCB0cmFjayBvZiB3aGVyZSB3ZSBsYXN0IHNhdyB0aGUgcGxheWVyXHJcblxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIHN0b3AgaHVudGluZ1xyXG4gICAgICAgICAgICBuZXdfc3RhdHVzID0gQnJldy5FbnVtcy5Nb25zdGVyU3RhdHVzLldhbmRlclxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgIH0gZWxzZSBpZiAoYWN0b3IubW9uc3Rlcl9zdGF0dXMgPT0gQnJldy5FbnVtcy5Nb25zdGVyU3RhdHVzLkVzY2FwZSkge1xyXG4gICAgICAgIC8vIHRvZG86IGVzY2FwZVxyXG4gICAgICAgIG5ld19zdGF0dXMgPSBCcmV3LkVudW1zLk1vbnN0ZXJTdGF0dXMuRXNjYXBlXHJcbiAgICAgICAgXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgdW5rbm93biBtb25zdGVyIHN0YXR1cyAke2FjdG9yLm1vbnN0ZXJfc3RhdHVzfSBmb3IgJHthY3Rvci5nZXRJRCgpfWApXHJcbiAgICB9XHJcbiAgICBcclxuICAgIGFjdG9yLm1vbnN0ZXJfc3RhdHVzID0gbmV3X3N0YXR1c1xyXG4gICAgcmV0dXJuIGluaXRfc3RhdHVzID09IG5ld19zdGF0dXNcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0QXBwcm9wcmlhdGVQYXRobWFwKGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGdvYWxfdHlwZTogQnJldy5QYXRoLlBhdGhtYXBHb2FsVHlwZSwgYWN0b3I6IEJyZXcuR3JpZFRoaW5ncy5Nb25zdGVyLCByYW5nZWRBdHRhY2tPdmVycmlkZTogYm9vbGVhbikgOiBCcmV3LlBhdGguUGF0aG1hcCB7XHJcbiAgICBsZXQgaXNfZmx5aW5nID0gYWN0b3IuaGFzRmxhZyhCcmV3LkVudW1zLkZsYWcuRmx5aW5nKSB8fCByYW5nZWRBdHRhY2tPdmVycmlkZVxyXG4gICAgbGV0IHVzZV9lc2NhcGUgPSBnb2FsX3R5cGUgPT0gQnJldy5QYXRoLlBhdGhtYXBHb2FsVHlwZS5Fc2NhcGVUYXJnZXRcclxuICAgIGxldCBwYXRobWFwIDogQnJldy5QYXRoLlBhdGhtYXBcclxuXHJcbiAgICBpZiAoaXNfZmx5aW5nICYmIHVzZV9lc2NhcGUpIHtcclxuICAgICAgICBwYXRobWFwID0gZ20ucGF0aG1hcHMuZ2V0UGF0aG1hcChCcmV3LkVudW1zLlBhdGhtYXBDYWNoZVR5cGUuRnJvbVBsYXllcl9GbHkpXHJcbiAgICB9IGVsc2UgaWYgKGlzX2ZseWluZyAmJiAoISh1c2VfZXNjYXBlKSkpIHtcclxuICAgICAgICBwYXRobWFwID0gZ20ucGF0aG1hcHMuZ2V0UGF0aG1hcChCcmV3LkVudW1zLlBhdGhtYXBDYWNoZVR5cGUuVG9QbGF5ZXJfRmx5KVxyXG4gICAgfSBlbHNlIGlmICgoIShpc19mbHlpbmcpKSAmJiB1c2VfZXNjYXBlKSB7XHJcbiAgICAgICAgcGF0aG1hcCA9IGdtLnBhdGhtYXBzLmdldFBhdGhtYXAoQnJldy5FbnVtcy5QYXRobWFwQ2FjaGVUeXBlLkZyb21QbGF5ZXJfV2FsaylcclxuICAgIH0gZWxzZSBpZiAoKCEoaXNfZmx5aW5nKSkgJiYgKCEodXNlX2VzY2FwZSkpKSB7XHJcbiAgICAgICAgcGF0aG1hcCA9IGdtLnBhdGhtYXBzLmdldFBhdGhtYXAoQnJldy5FbnVtcy5QYXRobWFwQ2FjaGVUeXBlLlRvUGxheWVyX1dhbGspXHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHBhdGhtYXBcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0TmF2aWdhdGlvblR5cGUoZ20gOiBCcmV3LkdhbWVNYXN0ZXIsIGFjdG9yOiBCcmV3LkdyaWRUaGluZ3MuTW9uc3Rlcik6IEJyZXcuRW51bXMuTGV2ZWxOYXZpZ2F0aW9uVHlwZSB7XHJcbiAgICBpZiAoYWN0b3IuaGFzRmxhZyhCcmV3LkVudW1zLkZsYWcuRmx5aW5nKSkge1xyXG4gICAgICAgIHJldHVybiBCcmV3LkVudW1zLkxldmVsTmF2aWdhdGlvblR5cGUuRmx5XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBCcmV3LkVudW1zLkxldmVsTmF2aWdhdGlvblR5cGUuV2Fsa1xyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBnZXROZXh0U3RlcEZyb21BU3RhcihnbTogQnJldy5HYW1lTWFzdGVyLCBhY3RvcjogQnJldy5HcmlkVGhpbmdzLk1vbnN0ZXIsIGRlc3RpbmF0aW9uX3h5OiBCcmV3LkNvb3JkaW5hdGUpIDogQnJldy5Db29yZGluYXRlIHtcclxuICAgIGxldCBwYXRoID0gZ2V0UGF0aEZyb21BU3RhcihnbSwgYWN0b3IsIGRlc3RpbmF0aW9uX3h5KVxyXG4gICAgaWYgKHBhdGgubGVuZ3RoIDw9IDEpIHtcclxuICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gcGF0aFsxXVxyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0UGF0aEZyb21BU3RhcihnbTogQnJldy5HYW1lTWFzdGVyLCBhY3RvcjogQnJldy5HcmlkVGhpbmdzLk1vbnN0ZXIsIGRlc3RpbmF0aW9uX3h5OiBCcmV3LkNvb3JkaW5hdGUsIGlnbm9yZU90aGVyTW9uc3RlcnM6IGJvb2xlYW4gPSBmYWxzZSApIDogQXJyYXk8QnJldy5Db29yZGluYXRlPiB7XHJcbiAgICBsZXQgbGV2ZWwgPSBnbS5nZXRDdXJyZW50TGV2ZWwoKVxyXG4gICAgbGV0IGZuX3Bhc3NhYmxlID0gKHg6IG51bWJlciwgeTogbnVtYmVyKSA6IGJvb2xlYW4gPT4ge1xyXG4gICAgICAgIGxldCB4eSA9IG5ldyBCcmV3LkNvb3JkaW5hdGUoeCwgeSlcclxuICAgICAgICBcclxuICAgICAgICBpZiAoIShsZXZlbC5pc1ZhbGlkKHh5KSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIGlmIChsZXZlbC5tb25zdGVycy5oYXNBdCh4eSkpIHtcclxuICAgICAgICAgICAgbGV0IG1vbnN0ZXJfYXQgPSBsZXZlbC5tb25zdGVycy5nZXRBdCh4eSlcclxuICAgICAgICAgICAgaWYgKG1vbnN0ZXJfYXQuaXNTYW1lVGhpbmcoYWN0b3IpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHh5LmNvbXBhcmUoZGVzdGluYXRpb25feHkpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGlnbm9yZU90aGVyTW9uc3RlcnMpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gaWYgKGxldmVsLm1vbnN0ZXJzLmhhc0F0KHh5KSAmJiAoIShhY3Rvci5sb2NhdGlvbi5jb21wYXJlKHh5KSkpKSAge1xyXG4gICAgICAgIC8vICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAvLyB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgbGV0IHQgPSBsZXZlbC50ZXJyYWluLmdldEF0KHh5KVxyXG4gICAgICAgIGxldCBjYW5fbW92ZSA9IEJyZXcuTW92ZW1lbnQuY2FuTW92ZVRvTG9jYXRpb24oZ20sIGFjdG9yLCB4eSlcclxuICAgICAgICByZXR1cm4gY2FuX21vdmVcclxuICAgIH1cclxuICAgIFxyXG4gICAgbGV0IHBhdGggOiBBcnJheTxCcmV3LkNvb3JkaW5hdGU+ID0gW11cclxuICAgIGxldCBmbl91cGRhdGVfcGF0aCA9ICh4OiBudW1iZXIsIHk6IG51bWJlcikgOiB2b2lkID0+IHtcclxuICAgICAgICAvLyBsZXQgeHkgPSBuZXcgQnJldy5Db29yZGluYXRlKHgsIHkpXHJcbiAgICAgICAgcGF0aC5wdXNoKG5ldyBCcmV3LkNvb3JkaW5hdGUoeCwgeSkpXHJcbiAgICB9XHJcbiAgICBcclxuICAgIFxyXG4gICAgbGV0IGFzdGFyID0gbmV3IFJPVC5QYXRoLkFTdGFyKGRlc3RpbmF0aW9uX3h5LngsIGRlc3RpbmF0aW9uX3h5LnksIGZuX3Bhc3NhYmxlLCB7dG9wb2xvZ3k6IEJyZXcuQ29uZmlnLnJvdGpzX3RvcG9sb2d5fSlcclxuICAgIC8vIGxldCBhc3RhciA9IG5ldyBST1QuUGF0aC5EaWprc3RyYShkZXN0aW5hdGlvbl94eS54LCBkZXN0aW5hdGlvbl94eS55LCBmbl9wYXNzYWJsZSwge3RvcG9sb2d5OiBCcmV3LkNvbmZpZy5yb3Rqc190b3BvbG9neX0pXHJcbiAgICBhc3Rhci5jb21wdXRlKGFjdG9yLmxvY2F0aW9uLngsIGFjdG9yLmxvY2F0aW9uLnksIGZuX3VwZGF0ZV9wYXRoKVxyXG4gICAgXHJcbiAgICByZXR1cm4gcGF0aCBcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0U2FmZUxvY2F0aW9uKGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGFjdG9yOiBCcmV3LkdyaWRUaGluZ3MuTW9uc3RlcikgOiBCcmV3LkNvb3JkaW5hdGUge1xyXG4gICAgLy8gcmV0dXJucyBhIHdhbGthYmxlLCBtb25zdGVyLWZyZWUgbG9jYXRpb25cclxuICAgIFxyXG4gICAgbGV0IHh5IDogQnJldy5Db29yZGluYXRlXHJcbiAgICBsZXQgdHJpZXMgPSAwXHJcbiAgICB3aGlsZSAodHJpZXMgPCA1MCkge1xyXG4gICAgICAgIHh5ID0gQnJldy5VdGlscy5yYW5kb21PZihnbS5nZXRDdXJyZW50TGV2ZWwoKS5nZXRXYWxrYWJsZVRpbGVzKCkpXHJcbiAgICAgICAgaWYgKCEoZ20uZ2V0Q3VycmVudExldmVsKCkubW9uc3RlcnMuaGFzQXQoeHkpKSkge1xyXG4gICAgICAgICAgICByZXR1cm4geHlcclxuICAgICAgICB9XHJcbiAgICAgICAgdHJpZXMgKz0gMVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBjb25zb2xlLmVycm9yKFwidW5hYmxlIHRvIGZpbmQgc2FmZSBsb2NhdGlvblwiKVxyXG4gICAgcmV0dXJuIG51bGxcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHJ1bkJlZm9yZVBsYXllclR1cm4oZ206IEJyZXcuR2FtZU1hc3RlciwgYWN0b3I6IEJyZXcuR3JpZFRoaW5ncy5Nb25zdGVyKSB7XHJcbiAgICBnbS51cGRhdGVBbGxQYXRobWFwcygpXHJcbiAgICBsZXQgdXBkYXRlcyA9IHVwZGF0ZUZvdihnbSwgYWN0b3IpXHJcbiAgICBnbS5kaXNwbGF5LmRyYXdGb290ZXIoKVxyXG4gICAgZ20uZGlzcGxheUxpc3QodXBkYXRlcykgIFxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcnVuQWZ0ZXJQbGF5ZXJUdXJuKGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGFjdG9yOiBCcmV3LkdyaWRUaGluZ3MuTW9uc3Rlcikge1xyXG4gICAgLy8gZ20ucGF0aG1hcF90b19wbGF5ZXIgPSBCcmV3LlBhdGguY3JlYXRlR2VuZXJpY01hcFRvUGxheWVyKGdtLCBnbS5nZXRDdXJyZW50TGV2ZWwoKSlcclxuICAgIC8vIGdtLnBhdGhtYXBfdG9fcGxheWVyYWxseSA9IEJyZXcuUGF0aC5jcmVhdGVHZW5lcmljTWFwVG9QbGF5ZXJBbGx5KGdtLCBnbS5nZXRDdXJyZW50TGV2ZWwoKSlcclxuICAgIC8vIGdtLnBhdGhtYXBfZnJvbV9wbGF5ZXIgPSBCcmV3LlBhdGguY3JlYXRlTWFwRnJvbVBsYXllcihnbSwgZ20uZ2V0Q3VycmVudExldmVsKCksIGdtLnBhdGhtYXBfdG9fcGxheWVyKVxyXG4gICAgLy8gZ20ucGF0aG1hcF9mcm9tX3BsYXllcmFsbHkgPSBCcmV3LlBhdGguY3JlYXRlTWFwRnJvbVBsYXllcihnbSwgZ20uZ2V0Q3VycmVudExldmVsKCksIGdtLnBhdGhtYXBfdG9fcGxheWVyYWxseSlcclxuICAgIFxyXG4gICAgbGV0IHVwZGF0ZXMgOiBBcnJheTxCcmV3LkNvb3JkaW5hdGU+XHJcbiAgICBsZXQgYWxsX3VwZGF0ZXMgOiBBcnJheTxCcmV3LkNvb3JkaW5hdGU+ID0gW11cclxuXHJcbiAgICAvLyB1cGRhdGUgZm92IGZvciBldmVyeW9uZVxyXG4gICAgZ20uZ2V0Q3VycmVudExldmVsKCkubW9uc3RlcnMuZ2V0QWxsVGhpbmdzKCkuZm9yRWFjaCgobW9iOiBCcmV3LkdyaWRUaGluZ3MuTW9uc3RlcikgPT4ge1xyXG4gICAgICAgIGlmIChpc1BsYXllcihnbSwgbW9iKSkge1xyXG4gICAgICAgICAgICByZXR1cm5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHVwZGF0ZXMgPSB1cGRhdGVGb3YoZ20sIG1vYilcclxuICAgICAgICBhbGxfdXBkYXRlcy5jb25jYXQodXBkYXRlcylcclxuICAgIH0pXHJcbiAgICBnbS5kaXNwbGF5TGlzdChhbGxfdXBkYXRlcylcclxuICAgIGdtLnVwZGF0ZUFsbFBhdGhtYXBzKClcclxuICAgIGdtLnR1cm5fY291bnQgKz0gMVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaXNQbGF5ZXIoZ206IEJyZXcuR2FtZU1hc3RlciwgYWN0b3I6IEJyZXcuR3JpZFRoaW5ncy5Nb25zdGVyKSA6IGJvb2xlYW4ge1xyXG4gICAgLy8gcmV0dXJuIGFjdG9yLmlzVHlwZShCcmV3LkRlZmluaXRpb25zLk1vbnN0ZXJUeXBlLkhlcm8pXHJcbiAgICByZXR1cm4gYWN0b3IuaXNTYW1lVGhpbmcoZ20uZ2V0UGxheWVyKCkpXHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNyZWF0ZUFsbG93VmlzaW9uRm4oZ206IEJyZXcuR2FtZU1hc3RlciwgYWN0b3I6IEJyZXcuR3JpZFRoaW5ncy5Nb25zdGVyLCBhY3RpdmVfcmFuZ2U6IG51bWJlcikgOiAoeCwgeSkgPT4gYm9vbGVhbiB7XHJcbiAgICBsZXQgeHk6IEJyZXcuQ29vcmRpbmF0ZVxyXG4gICAgbGV0IGxldmVsID0gZ20uZ2V0Q3VycmVudExldmVsKClcclxuICAgIGxldCB0IDogQnJldy5HcmlkVGhpbmdzLlRlcnJhaW5cclxuXHJcbiAgICBsZXQgZm5fYWxsb3dfdmlzaW9uID0gKHg6IG51bWJlciwgeTogbnVtYmVyKSA9PiB7IFxyXG5cclxuICAgICAgICB4eSA9IG5ldyBCcmV3LkNvb3JkaW5hdGUoeCwgeSlcclxuICAgICAgICBcclxuICAgICAgICAvLyBjYW4gbmV2ZXIgc2VlIG91dHNpZGUgdGhlIGxldmVsXHJcbiAgICAgICAgaWYgKCEobGV2ZWwuaXNWYWxpZCh4eSkpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgIH0gXHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gIGNhbiBhbHdheXMgc2VlIHdoZXJlIHlvdSBhcmUgc3RhbmRpbmdcclxuICAgICAgICBpZiAoeHkuY29tcGFyZShhY3Rvci5sb2NhdGlvbikpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKEJyZXcuVXRpbHMuZGlzdDJkKGFjdG9yLmxvY2F0aW9uLCB4eSkgPiBhY3RpdmVfcmFuZ2UpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIHQgPSBsZXZlbC50ZXJyYWluLmdldEF0KHh5KVxyXG4gICAgICAgIHJldHVybiAoISh0LmJsb2Nrc192aXNpb24pKVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBmbl9hbGxvd192aXNpb25cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZUZvdihnbTogQnJldy5HYW1lTWFzdGVyLCBhY3RvcjogQnJldy5HcmlkVGhpbmdzLk1vbnN0ZXIpIDogQXJyYXk8QnJldy5Db29yZGluYXRlPiB7XHJcbiAgICBsZXQgb2xkX2ZvdiA6IEFycmF5PEJyZXcuQ29vcmRpbmF0ZT4gPSBhY3Rvci5mb3YuZ2V0QWxsQ29vcmRpbmF0ZXMoKVxyXG4gICAgbGV0IHh5OiBCcmV3LkNvb3JkaW5hdGVcclxuICAgIGxldCBudW1iZXJrZXkgOiBudW1iZXJcclxuICAgIFxyXG4gICAgYWN0b3IuY2xlYXJGb3YoKVxyXG4gICAgYWN0b3IuY2xlYXJLbm93bGVkZ2UoKVxyXG4gICAgbGV0IGxldmVsID0gZ20uZ2V0Q3VycmVudExldmVsKClcclxuICAgIGxldCB0IDogQnJldy5HcmlkVGhpbmdzLlRlcnJhaW5cclxuXHJcbiAgICBsZXQgZm5fYWxsb3dfdmlzaW9uID0gY3JlYXRlQWxsb3dWaXNpb25GbihnbSwgYWN0b3IsIGFjdG9yLnNpZ2h0X3JhbmdlKVxyXG4gICAgbGV0IGZuX2FsbG93X3Zpc2lvbl9saW1pdGVkID0gY3JlYXRlQWxsb3dWaXNpb25GbihnbSwgYWN0b3IsIEJyZXcuQ29uZmlnLmxvY2FsX3NpZ2h0X3JhbmdlKVxyXG5cclxuICAgIC8vIGxldCBmbl91cGRhdGVfZm92ID0gKHgsIHksIHIsIHZpc2liaWxpdHkpID0+IHtcclxuICAgIGxldCBmbl91cGRhdGVfZm92ID0gKHgsIHkpID0+IHtcclxuICAgICAgICAvLyBUT0RPOiBhbHNvIHVwZGF0ZSBsZXZlbCBmb3IgbGlnaHRjYXN0aW5nXHJcbiAgICAgICAgLy8geWVfbGV2ZWwuc2V0TGlnaHRBdChuZXcgQnJldy5Db29yZGluYXRlKHgsIHkpLCAxKVxyXG4gICAgICAgIHh5ID0gbmV3IEJyZXcuQ29vcmRpbmF0ZSh4LCB5KVxyXG4gICAgICAgIGlmIChsZXZlbC5pc1ZhbGlkKHh5KSkge1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgYWN0b3IuZm92LnNldEF0KHh5LCBCcmV3LkVudW1zLkJyZXdWaXNpb25Tb3VyY2UueFNlbGYpXHJcbiAgICAgICAgICAgIHVwZGF0ZU1lbW9yeUF0KGdtLCBhY3RvciwgZ20uZ2V0Q3VycmVudExldmVsKCkuaWQsIHh5KVxyXG5cclxuICAgICAgICAgICAgLy8gY2hlY2sgZm9yIG1vbnN0ZXJzIGFuZCBhZGQgdGhlbSB0byBvdXIga25vd2xlZGdlXHJcbiAgICAgICAgICAgIGxldCBtX2F0IDogQnJldy5HcmlkVGhpbmdzLk1vbnN0ZXIgPSBsZXZlbC5tb25zdGVycy5nZXRBdCh4eSlcclxuICAgICAgICAgICAgaWYgKChtX2F0KSAmJiAoIShtX2F0Lmhhc0ZsYWcoQnJldy5FbnVtcy5GbGFnLkludmlzaWJsZSkpKSkgIHtcclxuICAgICAgICAgICAgICAgIGFjdG9yLmtub3dsZWRnZS5zZXRBdCh4eSwgbV9hdClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIHRydWVcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gZGVidWcgZm92OiBzZWUgYWxsXHJcbiAgICBpZiAoaXNQbGF5ZXIoZ20sIGFjdG9yKSAmJiAoQnJldy5EZWJ1Zy5kZWJ1Z192aXNpb24gPT0gQnJldy5EZWJ1Zy5WaXNpb24uU2hvd0FsbCkpIHtcclxuICAgICAgICBcclxuICAgICAgICBsZXZlbC50ZXJyYWluLmdldEFsbENvb3JkaW5hdGVzKCkuZm9yRWFjaCgoeHksIGluZGV4LCBhcnJheSkgPT4ge1xyXG4gICAgICAgICAgICBhY3Rvci5mb3Yuc2V0QXQoeHksIEJyZXcuRW51bXMuQnJld1Zpc2lvblNvdXJjZS54U2VsZilcclxuICAgICAgICB9KVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICAvLyBvdGhlcndpc2UsIHJ1biBGT1Ygbm9ybWFsbHlcclxuICAgICAgICAvLyBsZXQgcm90X2ZvdiA9IG5ldyBST1QuRk9WLlByZWNpc2VTaGFkb3djYXN0aW5nKGZuX2FsbG93X3Zpc2lvbiwge30pXHJcbiAgICAgICAgLy8gcm90X2Zvdi5jb21wdXRlKGFjdG9yLmxvY2F0aW9uLngsIGFjdG9yLmxvY2F0aW9uLnksIGFjdG9yLnNpZ2h0X3JhbmdlLCBmbl91cGRhdGVfZm92KVxyXG4gICAgICAgIGxldCB2aWV3X2RpcmVjdGlvbiA9IEJyZXcuVGFuay5nZXRQcmltYXJ5RmFjaW5nRGlyZWN0aW9uKGdtLCBhY3RvcilcclxuICAgICAgICBsZXQgdHVycmV0UG93ZXIgPSBhY3Rvci5nZXRQb3dlcnMoKS5nZXRQb3dlck9mVHlwZShCcmV3LkVudW1zLkJyZXdQb3dlclR5cGUuVHVycmV0Q2Fubm9uKVxyXG5cclxuICAgICAgICBCcmV3LkZpZWxkT2ZWaWV3LnN5bW1ldHJpY1JlY3Vyc2l2ZVNoYWRvd2Nhc3RpbmdfRGlyZWN0aW9uYWwoYWN0b3IubG9jYXRpb24ueCwgYWN0b3IubG9jYXRpb24ueSwgZm5fYWxsb3dfdmlzaW9uLCBmbl91cGRhdGVfZm92LCB2aWV3X2RpcmVjdGlvbilcclxuICAgICAgICBCcmV3LkZpZWxkT2ZWaWV3LnN5bW1ldHJpY1JlY3Vyc2l2ZVNoYWRvd2Nhc3RpbmcoYWN0b3IubG9jYXRpb24ueCwgYWN0b3IubG9jYXRpb24ueSwgZm5fYWxsb3dfdmlzaW9uX2xpbWl0ZWQsIGZuX3VwZGF0ZV9mb3YpXHJcblxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBkZWJ1ZyBmb3Y6IGFkZCBvdGhlciBtb25zdGVyIHZpZXdcclxuICAgIC8vIHRvZG86IGFkZCBkaWZmZXJlbnQgdHlwZXMgb2YgdmlldyBmb3Igc2hhZGluZy93aGF0ZXZlciAoZS5nLiBub3QganVzdCBib29sZWFuIHRydWUvZmFsc2UpXHJcbiAgICAgICAgaWYgKGlzUGxheWVyKGdtLCBhY3RvcikgJiYgKEJyZXcuRGVidWcuZGVidWdfdmlzaW9uID09IEJyZXcuRGVidWcuVmlzaW9uLlNob3dNb2JzKSkge1xyXG4gICAgICAgICAgICBhY3Rvci5jbGVhckZvdigpXHJcbiAgICAgICAgfVxyXG4gICAgXHJcbiAgICAvLyBpZiBwbGF5ZXIgaGFzIHJlbW90ZSBzY2FuIG9uLCB0aGVuIHNob3cgb3RoZXIgbW9iIEZPVlxyXG4gICAgaWYgKChpc1BsYXllcihnbSwgYWN0b3IpICYmIChCcmV3LkRlYnVnLmRlYnVnX3Zpc2lvbiA9PSBCcmV3LkRlYnVnLlZpc2lvbi5TaG93TW9icykpIHx8IFxyXG4gICAgICAgIChpc1BsYXllcihnbSwgYWN0b3IpICYmIChhY3Rvci5oYXNGbGFnKEJyZXcuRW51bXMuRmxhZy5SZW1vdGVTY2FuKSkpKSB7XHJcbiAgICAgICAgLy8gYWN0b3IuY2xlYXJGb3YoKVxyXG4gICAgICAgIGxldmVsLm1vbnN0ZXJzLmdldEFsbFRoaW5ncygpLmZvckVhY2goKG1vYjogQnJldy5HcmlkVGhpbmdzLk1vbnN0ZXIsIGluZGV4LCBhcnJheSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAobW9iLmlzU2FtZVRoaW5nKGFjdG9yKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIG1vYi5mb3YuZ2V0QWxsQ29vcmRpbmF0ZXMoKS5mb3JFYWNoKCh4eSwgaW5kZXgsIGFycmF5KSA9PiB7XHJcbiAgICAgICAgICAgICAgICBhY3Rvci5mb3Yuc2V0QXQoeHksIEJyZXcuRW51bXMuQnJld1Zpc2lvblNvdXJjZS54UmVtb3RlKVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIGxldCBkaWZmX3h5X2xpc3QgPSBCcmV3LlV0aWxzLmRpZmZPZkNvb3JkaW5hdGVBcnJheXMob2xkX2ZvdiwgYWN0b3IuZm92LmdldEFsbENvb3JkaW5hdGVzKCkpXHJcbiAgICBsZXQgb2xkX2Zvdl9jb29yZHMgPSBuZXcgQnJldy5Db29yZGluYXRlQXJlYShvbGRfZm92KVxyXG4gICAgbGV0IG5ld19mb3ZfY29vcmRzID0gbmV3IEJyZXcuQ29vcmRpbmF0ZUFyZWEoYWN0b3IuZm92LmdldEFsbENvb3JkaW5hdGVzKCkpXHJcbiAgICBsZXQgZGlmZl94eV9saXN0ID0gb2xkX2Zvdl9jb29yZHMuZ2V0U3ltbWV0cmljRGlmZihuZXdfZm92X2Nvb3JkcykuZ2V0Q29vcmRpbmF0ZXMoKVxyXG4gICAgXHJcbiAgICBcclxuICAgIHJldHVybiBkaWZmX3h5X2xpc3RcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZU1lbW9yeUF0KGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGFjdG9yOiBCcmV3LkdyaWRUaGluZ3MuTW9uc3RlciwgbGV2ZWxfaWQ6IG51bWJlciwgeHk6IEJyZXcuQ29vcmRpbmF0ZSkge1xyXG4gICAgXHJcbiAgICBsZXQgbGV2ZWwgPSBnbS5nZXRDdXJyZW50TGV2ZWwoKVxyXG4gICAgXHJcbiAgICBpZiAoYWN0b3IubWVtb3J5Lmhhc0F0KHh5KSkge1xyXG4gICAgICAgIGFjdG9yLm1lbW9yeS5yZW1vdmVBdCh4eSlcclxuICAgIH1cclxuICAgIGxldCB0ZXJyYWluID0gbGV2ZWwudGVycmFpbi5nZXRBdCh4eSlcclxuICAgIGFjdG9yLm1lbW9yeS5zZXRBdCh4eSwgdGVycmFpbilcclxuXHJcbiAgICBsZXQgZmVhdHVyZSA9IGxldmVsLmZlYXR1cmVzLmdldEF0KHh5KVxyXG4gICAgaWYgKGZlYXR1cmUgJiYgKCEodGVycmFpbi5hbHdheXNPblRvcCkpKSB7XHJcbiAgICAgICAgYWN0b3IubWVtb3J5LnJlbW92ZUF0KHh5KVxyXG4gICAgICAgIGFjdG9yLm1lbW9yeS5zZXRBdCh4eSwgZmVhdHVyZSlcclxuICAgIH1cclxuICAgIFxyXG4gICAgbGV0IGl0ID0gbGV2ZWwuaXRlbXMuZ2V0QXQoeHkpXHJcbiAgICBpZiAoaXQpIHtcclxuICAgICAgICBhY3Rvci5tZW1vcnkucmVtb3ZlQXQoeHkpXHJcbiAgICAgICAgYWN0b3IubWVtb3J5LnNldEF0KHh5LCBpdClcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGlzRW5lbXkoYWN0b3IxOiBCcmV3LkdyaWRUaGluZ3MuTW9uc3RlciwgYWN0b3IyOiBCcmV3LkdyaWRUaGluZ3MuTW9uc3RlcikgOiBib29sZWFuIHtcclxuICAgIC8vIHRvZG86IG1vdmUgdGhpcyBhbmQgY2FuTW92ZSAvIGNhbiAvIGlzIHN0dWZmIHRvIEJyZXcuVXRpbHMgb3Igc29tZSBvdGhlciB1c2VmdWwgYXJlYVxyXG4gICAgbGV0IGlzX2VuZW15IDogYm9vbGVhblxyXG4gICAgaWYgKGFjdG9yMS50ZWFtID09IGFjdG9yMi50ZWFtKSB7XHJcbiAgICAgICAgaXNfZW5lbXkgPSBmYWxzZVxyXG4gICAgfSBlbHNlIGlmIChhY3RvcjEudGVhbSA9PSBCcmV3LkVudW1zLlRlYW0uRW5lbXkpIHtcclxuICAgICAgICAvLyBpc19lbmVteSA9IChbVGVhbS5QbGF5ZXIsIFRlYW0uUGxheWVyQWxsaWVkXS5pbmRleE9mKGFjdG9yMi50ZWFtKSA+IC0xKVxyXG4gICAgICAgIGlzX2VuZW15ID0gKGFjdG9yMi50ZWFtICE9IEJyZXcuRW51bXMuVGVhbS5FbmVteSlcclxuICAgIH0gZWxzZSB7IC8vIGFjdG9yMSBpcyBOT1Qgb24gZW5lbXkgdGVhbSwgdGhlcmVmb3JlIHBsYXllciBvciBwbGF5ZXJhbGx5XHJcbiAgICAgICAgaXNfZW5lbXkgPSAoYWN0b3IyLnRlYW0gPT0gQnJldy5FbnVtcy5UZWFtLkVuZW15KVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGlzX2VuZW15XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRNb25zdGVyc0tub3duQnkoZ206IEJyZXcuR2FtZU1hc3RlciwgYWN0b3I6IEJyZXcuR3JpZFRoaW5ncy5Nb25zdGVyKSA6IEFycmF5PEJyZXcuR3JpZFRoaW5ncy5Nb25zdGVyPiB7XHJcbiAgICAvLyByZXR1cm4gYWxsIG1vbnN0ZXJzIHRoYXQgSSBrbm93IGFib3V0IGV4Y2VwdCBteXNlbGZcclxuICAgIGxldCBsZXZlbCA9IGdtLmdldEN1cnJlbnRMZXZlbCgpXHJcblxyXG4gICAgcmV0dXJuIGxldmVsLm1vbnN0ZXJzLmdldEFsbFRoaW5ncygpLmZpbHRlcigobSwgaW5kZXgsIGFycmF5KSA9PiB7XHJcbiAgICAgICAgLy8gbGV0IGRpc3QyZCA9IE1hdGguZmxvb3IoQnJldy5VdGlscy5kaXN0MmQoYWN0b3IubG9jYXRpb24sIG0ubG9jYXRpb24pKVxyXG4gICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICAgIChhY3Rvci5oYXNLbm93bGVkZ2VPZihtKSkgJiZcclxuICAgICAgICAgICAgKGFjdG9yLmZvdi5oYXNBdChtLmxvY2F0aW9uKSkgJiYgXHJcbiAgICAgICAgICAgICghKG0uaXNTYW1lVGhpbmcoYWN0b3IpKSlcclxuICAgICAgICApXHJcbiAgICB9KVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0SXRlbXNLbm93bkJ5KGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGFjdG9yOiBCcmV3LkdyaWRUaGluZ3MuTW9uc3RlcikgOiBBcnJheTxCcmV3LkdyaWRUaGluZ3MuSXRlbT4ge1xyXG4gICAgLy8gcmV0dXJuIGFsbCBtb25zdGVycyB0aGF0IEkga25vdyBhYm91dCBleGNlcHQgbXlzZWxmXHJcbiAgICBsZXQgbGV2ZWwgPSBnbS5nZXRDdXJyZW50TGV2ZWwoKVxyXG5cclxuICAgIHJldHVybiBsZXZlbC5pdGVtcy5nZXRBbGxUaGluZ3MoKS5maWx0ZXIoKGksIGluZGV4LCBhcnJheSkgPT4ge1xyXG4gICAgICAgIC8vIGxldCBkaXN0MmQgPSBNYXRoLmZsb29yKEJyZXcuVXRpbHMuZGlzdDJkKGFjdG9yLmxvY2F0aW9uLCBtLmxvY2F0aW9uKSlcclxuICAgICAgICByZXR1cm4gKFxyXG4gICAgICAgICAgICAvLyAoYWN0b3IuaGFzS25vd2xlZGdlT2YoaSkpICYmXHJcbiAgICAgICAgICAgIChhY3Rvci5mb3YuaGFzQXQoaS5sb2NhdGlvbikpIFxyXG4gICAgICAgIClcclxuICAgIH0pXHJcbn1cclxuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/brew_engine/intel.ts\n");

/***/ }),

/***/ "./src/brew_engine/keymap.ts":
/*!***********************************!*\
  !*** ./src/brew_engine/keymap.ts ***!
  \***********************************/
/*! exports provided: MoveForward, MoveBackward, RotateBodyCW, RotateBodyCCW, MovementKeys, RotateWeaponCW, RotateWeaponCCW, Action, Examine, HeadsUp, Inventory, Menu, Escape, DebugFOV, DebugMenu, HotKey_1, HotKey_2, HotKey_3, HotKey_4, BossMode, ScreenEnlarge, ScreenShrink, DirectionalMovementKeys, RotationalMovementKeys, RotationalWeaponKeys, CWRotateKeys, CCWRotateKeys, HotKeys, ScreenSizeControl, Help */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"MoveForward\", function() { return MoveForward; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"MoveBackward\", function() { return MoveBackward; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"RotateBodyCW\", function() { return RotateBodyCW; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"RotateBodyCCW\", function() { return RotateBodyCCW; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"MovementKeys\", function() { return MovementKeys; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"RotateWeaponCW\", function() { return RotateWeaponCW; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"RotateWeaponCCW\", function() { return RotateWeaponCCW; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Action\", function() { return Action; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Examine\", function() { return Examine; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"HeadsUp\", function() { return HeadsUp; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Inventory\", function() { return Inventory; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Menu\", function() { return Menu; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Escape\", function() { return Escape; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DebugFOV\", function() { return DebugFOV; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DebugMenu\", function() { return DebugMenu; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"HotKey_1\", function() { return HotKey_1; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"HotKey_2\", function() { return HotKey_2; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"HotKey_3\", function() { return HotKey_3; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"HotKey_4\", function() { return HotKey_4; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BossMode\", function() { return BossMode; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ScreenEnlarge\", function() { return ScreenEnlarge; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ScreenShrink\", function() { return ScreenShrink; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DirectionalMovementKeys\", function() { return DirectionalMovementKeys; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"RotationalMovementKeys\", function() { return RotationalMovementKeys; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"RotationalWeaponKeys\", function() { return RotationalWeaponKeys; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"CWRotateKeys\", function() { return CWRotateKeys; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"CCWRotateKeys\", function() { return CCWRotateKeys; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"HotKeys\", function() { return HotKeys; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ScreenSizeControl\", function() { return ScreenSizeControl; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Help\", function() { return Help; });\n/* harmony import */ var rot_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! rot-js */ \"./node_modules/rot-js/lib/rot.js\");\n/* harmony import */ var rot_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(rot_js__WEBPACK_IMPORTED_MODULE_0__);\n\r\n// export const MoveRight = [ROT.VK_RIGHT, ROT.VK_D]\r\n// export const MoveLeft = [ROT.VK_LEFT, ROT.VK_A]\r\n// export const MoveUp = [ROT.VK_UP, ROT.VK_W]\r\n// export const MoveDown = [ROT.VK_DOWN, ROT.VK_S]\r\nconst MoveForward = [rot_js__WEBPACK_IMPORTED_MODULE_0__[\"VK_UP\"], rot_js__WEBPACK_IMPORTED_MODULE_0__[\"VK_W\"]];\r\nconst MoveBackward = [rot_js__WEBPACK_IMPORTED_MODULE_0__[\"VK_DOWN\"], rot_js__WEBPACK_IMPORTED_MODULE_0__[\"VK_S\"]];\r\nconst RotateBodyCW = [rot_js__WEBPACK_IMPORTED_MODULE_0__[\"VK_RIGHT\"], rot_js__WEBPACK_IMPORTED_MODULE_0__[\"VK_D\"]];\r\nconst RotateBodyCCW = [rot_js__WEBPACK_IMPORTED_MODULE_0__[\"VK_LEFT\"], rot_js__WEBPACK_IMPORTED_MODULE_0__[\"VK_A\"]];\r\nconst MovementKeys = [].concat(MoveForward, MoveBackward, RotateBodyCCW, RotateBodyCW);\r\nconst RotateWeaponCW = [rot_js__WEBPACK_IMPORTED_MODULE_0__[\"VK_E\"]];\r\nconst RotateWeaponCCW = [rot_js__WEBPACK_IMPORTED_MODULE_0__[\"VK_Q\"]];\r\nconst Action = [rot_js__WEBPACK_IMPORTED_MODULE_0__[\"VK_SPACE\"], rot_js__WEBPACK_IMPORTED_MODULE_0__[\"VK_RETURN\"]];\r\nconst Examine = [rot_js__WEBPACK_IMPORTED_MODULE_0__[\"VK_X\"]];\r\nconst HeadsUp = [rot_js__WEBPACK_IMPORTED_MODULE_0__[\"VK_Z\"]];\r\nconst Inventory = [rot_js__WEBPACK_IMPORTED_MODULE_0__[\"VK_I\"]];\r\nconst Menu = [rot_js__WEBPACK_IMPORTED_MODULE_0__[\"VK_M\"]];\r\nconst Escape = [rot_js__WEBPACK_IMPORTED_MODULE_0__[\"VK_ESCAPE\"]];\r\nconst DebugFOV = [rot_js__WEBPACK_IMPORTED_MODULE_0__[\"VK_SLASH\"]];\r\n// export const DebugPaths = [ROT.VK_Q]\r\nconst DebugMenu = [rot_js__WEBPACK_IMPORTED_MODULE_0__[\"VK_BACK_QUOTE\"]];\r\nconst HotKey_1 = [rot_js__WEBPACK_IMPORTED_MODULE_0__[\"VK_1\"]];\r\nconst HotKey_2 = [rot_js__WEBPACK_IMPORTED_MODULE_0__[\"VK_2\"]];\r\nconst HotKey_3 = [rot_js__WEBPACK_IMPORTED_MODULE_0__[\"VK_3\"]];\r\nconst HotKey_4 = [rot_js__WEBPACK_IMPORTED_MODULE_0__[\"VK_4\"]];\r\nconst BossMode = [rot_js__WEBPACK_IMPORTED_MODULE_0__[\"VK_B\"]];\r\nconst ScreenEnlarge = [rot_js__WEBPACK_IMPORTED_MODULE_0__[\"VK_0\"]];\r\nconst ScreenShrink = [rot_js__WEBPACK_IMPORTED_MODULE_0__[\"VK_9\"]];\r\nconst DirectionalMovementKeys = [].concat(MoveForward, MoveBackward);\r\nconst RotationalMovementKeys = [].concat(RotateBodyCCW, RotateBodyCW);\r\nconst RotationalWeaponKeys = [].concat(RotateWeaponCCW, RotateWeaponCW);\r\nconst CWRotateKeys = [].concat(RotateBodyCW, RotateWeaponCW);\r\nconst CCWRotateKeys = [].concat(RotateBodyCCW, RotateWeaponCCW);\r\nconst HotKeys = [].concat(HotKey_1, HotKey_2, HotKey_3, HotKey_4);\r\nconst ScreenSizeControl = [].concat(ScreenEnlarge, ScreenShrink);\r\nconst Help = [rot_js__WEBPACK_IMPORTED_MODULE_0__[\"VK_QUESTION_MARK\"], rot_js__WEBPACK_IMPORTED_MODULE_0__[\"VK_SLASH\"]];\r\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvYnJld19lbmdpbmUva2V5bWFwLnRzPzFjYzMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQTZCO0FBRTdCLG9EQUFvRDtBQUNwRCxrREFBa0Q7QUFDbEQsOENBQThDO0FBQzlDLGtEQUFrRDtBQUUzQyxNQUFNLFdBQVcsR0FBRyxDQUFDLDRDQUFTLEVBQUUsMkNBQVEsQ0FBQztBQUN6QyxNQUFNLFlBQVksR0FBRyxDQUFDLDhDQUFXLEVBQUUsMkNBQVEsQ0FBQztBQUM1QyxNQUFNLFlBQVksR0FBRyxDQUFDLCtDQUFZLEVBQUUsMkNBQVEsQ0FBQztBQUM3QyxNQUFNLGFBQWEsR0FBRyxDQUFDLDhDQUFXLEVBQUUsMkNBQVEsQ0FBQztBQUU3QyxNQUFNLFlBQVksR0FBRyxFQUFFLENBQUMsTUFBTSxDQUFDLFdBQVcsRUFBRSxZQUFZLEVBQUUsYUFBYSxFQUFFLFlBQVksQ0FBQztBQUN0RixNQUFNLGNBQWMsR0FBRyxDQUFDLDJDQUFRLENBQUM7QUFDakMsTUFBTSxlQUFlLEdBQUcsQ0FBQywyQ0FBUSxDQUFDO0FBRWxDLE1BQU0sTUFBTSxHQUFHLENBQUMsK0NBQVksRUFBRSxnREFBYSxDQUFDO0FBQzVDLE1BQU0sT0FBTyxHQUFHLENBQUMsMkNBQVEsQ0FBQztBQUMxQixNQUFNLE9BQU8sR0FBRyxDQUFDLDJDQUFRLENBQUM7QUFDMUIsTUFBTSxTQUFTLEdBQUcsQ0FBQywyQ0FBUSxDQUFDO0FBRTVCLE1BQU0sSUFBSSxHQUFHLENBQUMsMkNBQVEsQ0FBQztBQUN2QixNQUFNLE1BQU0sR0FBRyxDQUFDLGdEQUFhLENBQUM7QUFFOUIsTUFBTSxRQUFRLEdBQUcsQ0FBQywrQ0FBWSxDQUFDO0FBQ3RDLHVDQUF1QztBQUNoQyxNQUFNLFNBQVMsR0FBRyxDQUFDLG9EQUFpQixDQUFDO0FBRXJDLE1BQU0sUUFBUSxHQUFHLENBQUMsMkNBQVEsQ0FBQztBQUMzQixNQUFNLFFBQVEsR0FBRyxDQUFDLDJDQUFRLENBQUM7QUFDM0IsTUFBTSxRQUFRLEdBQUcsQ0FBQywyQ0FBUSxDQUFDO0FBQzNCLE1BQU0sUUFBUSxHQUFHLENBQUMsMkNBQVEsQ0FBQztBQUUzQixNQUFNLFFBQVEsR0FBRyxDQUFDLDJDQUFRLENBQUM7QUFFM0IsTUFBTSxhQUFhLEdBQUcsQ0FBQywyQ0FBUSxDQUFDO0FBQ2hDLE1BQU0sWUFBWSxHQUFHLENBQUMsMkNBQVEsQ0FBQztBQUUvQixNQUFNLHVCQUF1QixHQUFHLEVBQUUsQ0FBQyxNQUFNLENBQUMsV0FBVyxFQUFFLFlBQVksQ0FBQztBQUNwRSxNQUFNLHNCQUFzQixHQUFHLEVBQUUsQ0FBQyxNQUFNLENBQUMsYUFBYSxFQUFFLFlBQVksQ0FBQztBQUNyRSxNQUFNLG9CQUFvQixHQUFHLEVBQUUsQ0FBQyxNQUFNLENBQUMsZUFBZSxFQUFFLGNBQWMsQ0FBQztBQUN2RSxNQUFNLFlBQVksR0FBRyxFQUFFLENBQUMsTUFBTSxDQUFDLFlBQVksRUFBRSxjQUFjLENBQUM7QUFDNUQsTUFBTSxhQUFhLEdBQUcsRUFBRSxDQUFDLE1BQU0sQ0FBQyxhQUFhLEVBQUUsZUFBZSxDQUFDO0FBQy9ELE1BQU0sT0FBTyxHQUFHLEVBQUUsQ0FBQyxNQUFNLENBQUMsUUFBUSxFQUFFLFFBQVEsRUFBRSxRQUFRLEVBQUUsUUFBUSxDQUFDO0FBQ2pFLE1BQU0saUJBQWlCLEdBQUcsRUFBRSxDQUFDLE1BQU0sQ0FBQyxhQUFhLEVBQUUsWUFBWSxDQUFDO0FBRWhFLE1BQU0sSUFBSSxHQUFHLENBQUMsdURBQW9CLEVBQUUsK0NBQVksQ0FBQyIsImZpbGUiOiIuL3NyYy9icmV3X2VuZ2luZS9rZXltYXAudHMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBST1QgZnJvbSAncm90LWpzJ1xyXG5cclxuLy8gZXhwb3J0IGNvbnN0IE1vdmVSaWdodCA9IFtST1QuVktfUklHSFQsIFJPVC5WS19EXVxyXG4vLyBleHBvcnQgY29uc3QgTW92ZUxlZnQgPSBbUk9ULlZLX0xFRlQsIFJPVC5WS19BXVxyXG4vLyBleHBvcnQgY29uc3QgTW92ZVVwID0gW1JPVC5WS19VUCwgUk9ULlZLX1ddXHJcbi8vIGV4cG9ydCBjb25zdCBNb3ZlRG93biA9IFtST1QuVktfRE9XTiwgUk9ULlZLX1NdXHJcblxyXG5leHBvcnQgY29uc3QgTW92ZUZvcndhcmQgPSBbUk9ULlZLX1VQLCBST1QuVktfV11cclxuZXhwb3J0IGNvbnN0IE1vdmVCYWNrd2FyZCA9IFtST1QuVktfRE9XTiwgUk9ULlZLX1NdXHJcbmV4cG9ydCBjb25zdCBSb3RhdGVCb2R5Q1cgPSBbUk9ULlZLX1JJR0hULCBST1QuVktfRF1cclxuZXhwb3J0IGNvbnN0IFJvdGF0ZUJvZHlDQ1cgPSBbUk9ULlZLX0xFRlQsIFJPVC5WS19BXVxyXG5cclxuZXhwb3J0IGNvbnN0IE1vdmVtZW50S2V5cyA9IFtdLmNvbmNhdChNb3ZlRm9yd2FyZCwgTW92ZUJhY2t3YXJkLCBSb3RhdGVCb2R5Q0NXLCBSb3RhdGVCb2R5Q1cpXHJcbmV4cG9ydCBjb25zdCBSb3RhdGVXZWFwb25DVyA9IFtST1QuVktfRV1cclxuZXhwb3J0IGNvbnN0IFJvdGF0ZVdlYXBvbkNDVyA9IFtST1QuVktfUV1cclxuXHJcbmV4cG9ydCBjb25zdCBBY3Rpb24gPSBbUk9ULlZLX1NQQUNFLCBST1QuVktfUkVUVVJOXVxyXG5leHBvcnQgY29uc3QgRXhhbWluZSA9IFtST1QuVktfWF1cclxuZXhwb3J0IGNvbnN0IEhlYWRzVXAgPSBbUk9ULlZLX1pdXHJcbmV4cG9ydCBjb25zdCBJbnZlbnRvcnkgPSBbUk9ULlZLX0ldXHJcblxyXG5leHBvcnQgY29uc3QgTWVudSA9IFtST1QuVktfTV1cclxuZXhwb3J0IGNvbnN0IEVzY2FwZSA9IFtST1QuVktfRVNDQVBFXVxyXG5cclxuZXhwb3J0IGNvbnN0IERlYnVnRk9WID0gW1JPVC5WS19TTEFTSF1cclxuLy8gZXhwb3J0IGNvbnN0IERlYnVnUGF0aHMgPSBbUk9ULlZLX1FdXHJcbmV4cG9ydCBjb25zdCBEZWJ1Z01lbnUgPSBbUk9ULlZLX0JBQ0tfUVVPVEVdXHJcblxyXG5leHBvcnQgY29uc3QgSG90S2V5XzEgPSBbUk9ULlZLXzFdXHJcbmV4cG9ydCBjb25zdCBIb3RLZXlfMiA9IFtST1QuVktfMl1cclxuZXhwb3J0IGNvbnN0IEhvdEtleV8zID0gW1JPVC5WS18zXVxyXG5leHBvcnQgY29uc3QgSG90S2V5XzQgPSBbUk9ULlZLXzRdXHJcblxyXG5leHBvcnQgY29uc3QgQm9zc01vZGUgPSBbUk9ULlZLX0JdXHJcblxyXG5leHBvcnQgY29uc3QgU2NyZWVuRW5sYXJnZSA9IFtST1QuVktfMF1cclxuZXhwb3J0IGNvbnN0IFNjcmVlblNocmluayA9IFtST1QuVktfOV1cclxuXHJcbmV4cG9ydCBjb25zdCBEaXJlY3Rpb25hbE1vdmVtZW50S2V5cyA9IFtdLmNvbmNhdChNb3ZlRm9yd2FyZCwgTW92ZUJhY2t3YXJkKVxyXG5leHBvcnQgY29uc3QgUm90YXRpb25hbE1vdmVtZW50S2V5cyA9IFtdLmNvbmNhdChSb3RhdGVCb2R5Q0NXLCBSb3RhdGVCb2R5Q1cpXHJcbmV4cG9ydCBjb25zdCBSb3RhdGlvbmFsV2VhcG9uS2V5cyA9IFtdLmNvbmNhdChSb3RhdGVXZWFwb25DQ1csIFJvdGF0ZVdlYXBvbkNXKVxyXG5leHBvcnQgY29uc3QgQ1dSb3RhdGVLZXlzID0gW10uY29uY2F0KFJvdGF0ZUJvZHlDVywgUm90YXRlV2VhcG9uQ1cpXHJcbmV4cG9ydCBjb25zdCBDQ1dSb3RhdGVLZXlzID0gW10uY29uY2F0KFJvdGF0ZUJvZHlDQ1csIFJvdGF0ZVdlYXBvbkNDVylcclxuZXhwb3J0IGNvbnN0IEhvdEtleXMgPSBbXS5jb25jYXQoSG90S2V5XzEsIEhvdEtleV8yLCBIb3RLZXlfMywgSG90S2V5XzQpXHJcbmV4cG9ydCBjb25zdCBTY3JlZW5TaXplQ29udHJvbCA9IFtdLmNvbmNhdChTY3JlZW5FbmxhcmdlLCBTY3JlZW5TaHJpbmspXHJcblxyXG5leHBvcnQgY29uc3QgSGVscCA9IFtST1QuVktfUVVFU1RJT05fTUFSSywgUk9ULlZLX1NMQVNIXSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/brew_engine/keymap.ts\n");

/***/ }),

/***/ "./src/brew_engine/pathmap.ts":
/*!************************************!*\
  !*** ./src/brew_engine/pathmap.ts ***!
  \************************************/
/*! exports provided: PathmapGoalType, PathmapCache, Pathmap, createGenericMapToPlayer, createMapFromPlayer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"PathmapGoalType\", function() { return PathmapGoalType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"PathmapCache\", function() { return PathmapCache; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Pathmap\", function() { return Pathmap; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"createGenericMapToPlayer\", function() { return createGenericMapToPlayer; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"createMapFromPlayer\", function() { return createMapFromPlayer; });\n/* harmony import */ var _brew__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../brew */ \"./src/brew.ts\");\n/* harmony import */ var _fastdijkstramap__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./fastdijkstramap */ \"./src/brew_engine/fastdijkstramap.ts\");\n\r\n\r\nvar PathmapGoalType;\r\n(function (PathmapGoalType) {\r\n    PathmapGoalType[PathmapGoalType[\"ToTarget\"] = 0] = \"ToTarget\";\r\n    PathmapGoalType[PathmapGoalType[\"EscapeTarget\"] = 1] = \"EscapeTarget\";\r\n})(PathmapGoalType || (PathmapGoalType = {}));\r\n// todo: find other instances of cacheing stuff like this and generalize the class <T>\r\nclass PathmapCache {\r\n    constructor() {\r\n        this.my_pathmaps = {};\r\n        // getPathmapCacheType(goalType: PathmapGoalType, includeAllies: boolean, navigationMethod: Brew.Enums.LevelNavigationType) : PathmapCacheType {\r\n        //     let cacheType : PathmapCacheType\r\n        //     if ((goalType == PathmapGoalType.EscapeTarget) && (includeAllies == true) && (navigationMethod == Brew.Enums.LevelNavigationType.Fly)) {\r\n        //         cacheType = PathmapCacheType.FromPlayerAllies_Fly\r\n        //     } else if ((goalType == PathmapGoalType.EscapeTarget) && (includeAllies == true) && (navigationMethod == Brew.Enums.LevelNavigationType.Walk)) {\r\n        //         cacheType = PathmapCacheType.FromPlayerAllies_Walk\r\n        //     } else if ((goalType == PathmapGoalType.EscapeTarget) && (includeAllies == false) && (navigationMethod == Brew.Enums.LevelNavigationType.Fly)) {\r\n        //         cacheType = PathmapCacheType.FromPlayerOnly_Fly\r\n        //     } else if ((goalType == PathmapGoalType.EscapeTarget) && (includeAllies == false) && (navigationMethod == Brew.Enums.LevelNavigationType.Walk)) {\r\n        //         cacheType = PathmapCacheType.FromPlayerOnly_Walk\r\n        //     } else if ((goalType == PathmapGoalType.ToTarget) && (includeAllies == true) && (navigationMethod == Brew.Enums.LevelNavigationType.Fly)) {\r\n        //         cacheType = PathmapCacheType.ToPlayerAllies_Fly\r\n        //     } else if ((goalType == PathmapGoalType.ToTarget) && (includeAllies == true) && (navigationMethod == Brew.Enums.LevelNavigationType.Walk)) {\r\n        //         cacheType = PathmapCacheType.ToPlayerAllies_Walk\r\n        //     } else if ((goalType == PathmapGoalType.ToTarget) && (includeAllies == false) && (navigationMethod == Brew.Enums.LevelNavigationType.Fly)) {\r\n        //         cacheType = PathmapCacheType.ToPlayerOnly_Fly\r\n        //     } else if ((goalType == PathmapGoalType.ToTarget) && (includeAllies == false) && (navigationMethod == Brew.Enums.LevelNavigationType.Walk)) {\r\n        //         cacheType = PathmapCacheType.ToPlayerOnly_Walk\r\n        //     }\r\n        //     return cacheType\r\n        // }\r\n        // getPathmap(goalType: PathmapGoalType, includeAllies: boolean, navigationMethod: Brew.Enums.LevelNavigationType) : Pathmap {\r\n        //     let cacheType = this.getPathmapCacheType(goalType, includeAllies, navigationMethod)\r\n        //     return this.getCache(cacheType)\r\n        // }\r\n    }\r\n    updateCache(cacheType, pm) {\r\n        this.my_pathmaps[cacheType] = pm;\r\n    }\r\n    getPathmap(cacheType) {\r\n        if (cacheType in this.my_pathmaps) {\r\n            return this.my_pathmaps[cacheType];\r\n        }\r\n        else {\r\n            return null;\r\n        }\r\n    }\r\n}\r\nclass Pathmap {\r\n    constructor(level, pathtype, navigationType = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].LevelNavigationType.Walk) {\r\n        this.field = new _brew__WEBPACK_IMPORTED_MODULE_0__[\"GridOfThings\"]();\r\n        this.pathtype = pathtype;\r\n        this.width = level.width;\r\n        this.height = level.height;\r\n        // pick a spot to start the flood fill for passable tiles\r\n        let valid_start_xy = level.navigation_tiles[navigationType][0];\r\n        // initiate the map\r\n        let pathable_fn;\r\n        if (navigationType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].LevelNavigationType.Walk) {\r\n            pathable_fn = _fastdijkstramap__WEBPACK_IMPORTED_MODULE_1__[\"PathFunctionWalkable\"];\r\n        }\r\n        else if (navigationType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].LevelNavigationType.Fly) {\r\n            pathable_fn = _fastdijkstramap__WEBPACK_IMPORTED_MODULE_1__[\"PathFunctionFlyable\"];\r\n        }\r\n        else {\r\n            throw new Error(`unknown level navigation type: ${navigationType}`);\r\n        }\r\n        this.djmap = _fastdijkstramap__WEBPACK_IMPORTED_MODULE_1__[\"setupDijkstraMap\"](level, valid_start_xy, pathable_fn);\r\n    }\r\n    setDijkstraMapTargets(target_xy, goal_value) {\r\n        let key = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].xyToKey(target_xy);\r\n        this.djmap[key] = goal_value;\r\n    }\r\n    solve() {\r\n        // run the solver\r\n        _fastdijkstramap__WEBPACK_IMPORTED_MODULE_1__[\"solveDijkstraMap\"](this.djmap);\r\n        // find max/min values\r\n        let maxmin = _fastdijkstramap__WEBPACK_IMPORTED_MODULE_1__[\"getMaxAndMinDijkstraMapValues\"](this.djmap);\r\n        this.max_value = maxmin.max;\r\n        this.min_value = maxmin.min;\r\n        // convert back to grid of things\r\n        let key;\r\n        let xy;\r\n        // let num_key\r\n        for (key in this.djmap) {\r\n            xy = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].keyToXY(Number(key));\r\n            this.field.setAt(xy, this.djmap[key]);\r\n        }\r\n        // console.log(`number of passes: ${num_passes}`)\r\n    }\r\n    getDownhillNeighbor(from_xy) {\r\n        let lowest_xy = from_xy;\r\n        let lowest_val = this.field.getAt(lowest_xy);\r\n        lowest_xy.getAdjacent().forEach((xy, index, array) => {\r\n            let temp_val = this.field.getAt(xy);\r\n            if (temp_val) {\r\n                if (temp_val < lowest_val) {\r\n                    lowest_val = temp_val;\r\n                    lowest_xy = xy;\r\n                }\r\n            }\r\n        });\r\n        return lowest_xy;\r\n    }\r\n    // getUnblockedDownhillNeighbor(from_xy: Brew.Coordinate, level: Brew.Level, except_mob?: Brew.GridThings.Monster) : Brew.Coordinate {\r\n    getUnblockedDownhillNeighbor(from_xy, level, ally_mode = false) {\r\n        // return lowest-value cell not blocked by another something\r\n        let lowest_xy = from_xy;\r\n        let lowest_val;\r\n        if (ally_mode) {\r\n            lowest_val = Number.MAX_VALUE;\r\n        }\r\n        else {\r\n            lowest_val = this.field.getAt(lowest_xy);\r\n        }\r\n        lowest_xy.getAdjacent().forEach((xy, index, array) => {\r\n            let temp_val = this.field.getAt(xy);\r\n            if (ally_mode && (temp_val == 0)) {\r\n                return;\r\n            }\r\n            if (temp_val) {\r\n                let mob_at = level.monsters.getAt(xy);\r\n                if (mob_at) {\r\n                    return;\r\n                }\r\n                if (temp_val < lowest_val) {\r\n                    lowest_val = temp_val;\r\n                    lowest_xy = xy;\r\n                }\r\n            }\r\n        });\r\n        return lowest_xy;\r\n    }\r\n} //end class\r\nfunction createGenericMapToPlayer(gm, level, navigationMethod, includeAllies) {\r\n    let pm = new Pathmap(level, PathmapGoalType.ToTarget, navigationMethod);\r\n    let player = gm.getPlayer();\r\n    // set player as target\r\n    pm.setDijkstraMapTargets(player.location, 0);\r\n    // set allies if necessary\r\n    if (includeAllies) {\r\n        level.monsters.getAllThings().forEach((m, index, array) => {\r\n            if (m.team == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].Team.PlayerAllied) {\r\n                pm.setDijkstraMapTargets(m.location, 0);\r\n            }\r\n        });\r\n    }\r\n    pm.solve();\r\n    return pm;\r\n}\r\nfunction createMapFromPlayer(gm, level, to_map, includeAllies) {\r\n    let from_map = new Pathmap(level, PathmapGoalType.EscapeTarget);\r\n    let escape_factor = -1.2;\r\n    let player = gm.getPlayer();\r\n    // invert the to-map\r\n    let key;\r\n    for (key in to_map.field.things) {\r\n        from_map.djmap[key] = to_map.djmap[key] * escape_factor;\r\n    }\r\n    // reset player to high peak\r\n    from_map.setDijkstraMapTargets(player.location, _fastdijkstramap__WEBPACK_IMPORTED_MODULE_1__[\"MAX_INT\"]);\r\n    // set allies if necessary\r\n    if (includeAllies) {\r\n        level.monsters.getAllThings().forEach((m, index, array) => {\r\n            if (m.team == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].Team.PlayerAllied) {\r\n                from_map.setDijkstraMapTargets(m.location, _fastdijkstramap__WEBPACK_IMPORTED_MODULE_1__[\"MAX_INT\"]);\r\n            }\r\n        });\r\n    }\r\n    from_map.solve();\r\n    return from_map;\r\n}\r\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvYnJld19lbmdpbmUvcGF0aG1hcC50cz9iMmExIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQStCO0FBQ1M7QUFFeEMsSUFBWSxlQUdYO0FBSEQsV0FBWSxlQUFlO0lBQ3ZCLDZEQUFRO0lBQ1IscUVBQVk7QUFDaEIsQ0FBQyxFQUhXLGVBQWUsS0FBZixlQUFlLFFBRzFCO0FBTUQsc0ZBQXNGO0FBQ2hGO0lBQU47UUFDSSxnQkFBVyxHQUFrQixFQUFFO1FBYy9CLGdKQUFnSjtRQUNoSix1Q0FBdUM7UUFFdkMsK0lBQStJO1FBQy9JLDREQUE0RDtRQUM1RCx1SkFBdUo7UUFDdkosNkRBQTZEO1FBQzdELHVKQUF1SjtRQUN2SiwwREFBMEQ7UUFDMUQsd0pBQXdKO1FBQ3hKLDJEQUEyRDtRQUMzRCxrSkFBa0o7UUFDbEosMERBQTBEO1FBQzFELG1KQUFtSjtRQUNuSiwyREFBMkQ7UUFDM0QsbUpBQW1KO1FBQ25KLHdEQUF3RDtRQUN4RCxvSkFBb0o7UUFDcEoseURBQXlEO1FBQ3pELFFBQVE7UUFFUix1QkFBdUI7UUFDdkIsSUFBSTtRQUVKLDhIQUE4SDtRQUM5SCwwRkFBMEY7UUFDMUYsc0NBQXNDO1FBQ3RDLElBQUk7SUFDUixDQUFDO0lBeENHLFdBQVcsQ0FBQyxTQUF1QyxFQUFFLEVBQVc7UUFDNUQsSUFBSSxDQUFDLFdBQVcsQ0FBQyxTQUFTLENBQUMsR0FBRyxFQUFFO0lBQ3BDLENBQUM7SUFFRCxVQUFVLENBQUMsU0FBc0M7UUFDN0MsRUFBRSxDQUFDLENBQUMsU0FBUyxJQUFJLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDO1lBQ2hDLE1BQU0sQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLFNBQVMsQ0FBQztRQUN0QyxDQUFDO1FBQUMsSUFBSSxDQUFDLENBQUM7WUFDSixNQUFNLENBQUMsSUFBSTtRQUNmLENBQUM7SUFDTCxDQUFDO0NBOEJKO0FBRUs7SUFhRixZQUFZLEtBQWlCLEVBQUUsUUFBeUIsRUFBRSxpQkFBa0QsMkNBQVUsQ0FBQyxtQkFBbUIsQ0FBQyxJQUFJO1FBQzNJLElBQUksQ0FBQyxLQUFLLEdBQUcsSUFBSSxrREFBaUIsRUFBVTtRQUM1QyxJQUFJLENBQUMsUUFBUSxHQUFHLFFBQVE7UUFDeEIsSUFBSSxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUMsS0FBSztRQUN4QixJQUFJLENBQUMsTUFBTSxHQUFHLEtBQUssQ0FBQyxNQUFNO1FBRTFCLHlEQUF5RDtRQUN6RCxJQUFJLGNBQWMsR0FBRyxLQUFLLENBQUMsZ0JBQWdCLENBQUMsY0FBYyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBRTlELG1CQUFtQjtRQUNuQixJQUFJLFdBQW1DO1FBQ3ZDLEVBQUUsQ0FBQyxDQUFDLGNBQWMsSUFBSSwyQ0FBVSxDQUFDLG1CQUFtQixDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7WUFDeEQsV0FBVyxHQUFHLHFFQUF3QjtRQUMxQyxDQUFDO1FBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLGNBQWMsSUFBSSwyQ0FBVSxDQUFDLG1CQUFtQixDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7WUFDOUQsV0FBVyxHQUFHLG9FQUF1QjtRQUN6QyxDQUFDO1FBQUMsSUFBSSxDQUFDLENBQUM7WUFDSixNQUFNLElBQUksS0FBSyxDQUFDLGtDQUFrQyxjQUFjLEVBQUUsQ0FBQztRQUN2RSxDQUFDO1FBRUQsSUFBSSxDQUFDLEtBQUssR0FBRyxpRUFBb0IsQ0FBQyxLQUFLLEVBQUUsY0FBYyxFQUFFLFdBQVcsQ0FBQztJQUN6RSxDQUFDO0lBRUQscUJBQXFCLENBQUMsU0FBMEIsRUFBRSxVQUFrQjtRQUNoRSxJQUFJLEdBQUcsR0FBRywyQ0FBVSxDQUFDLE9BQU8sQ0FBQyxTQUFTLENBQUM7UUFDdkMsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsR0FBRyxVQUFVO0lBQ2hDLENBQUM7SUFFRCxLQUFLO1FBQ0QsaUJBQWlCO1FBQ2pCLGlFQUFvQixDQUFDLElBQUksQ0FBQyxLQUFLLENBQUM7UUFFaEMsc0JBQXNCO1FBQ3RCLElBQUksTUFBTSxHQUFHLDhFQUFpQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUM7UUFDMUQsSUFBSSxDQUFDLFNBQVMsR0FBRyxNQUFNLENBQUMsR0FBRztRQUMzQixJQUFJLENBQUMsU0FBUyxHQUFHLE1BQU0sQ0FBQyxHQUFHO1FBRTNCLGlDQUFpQztRQUNqQyxJQUFJLEdBQVc7UUFDZixJQUFJLEVBQW1CO1FBQ3ZCLGNBQWM7UUFDZCxHQUFHLENBQUMsQ0FBQyxHQUFHLElBQUksSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUM7WUFDckIsRUFBRSxHQUFHLDJDQUFVLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQztZQUNwQyxJQUFJLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxFQUFFLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUN6QyxDQUFDO1FBRUQsaURBQWlEO0lBQ3JELENBQUM7SUFHRCxtQkFBbUIsQ0FBQyxPQUF3QjtRQUN4QyxJQUFJLFNBQVMsR0FBRyxPQUFPO1FBQ3ZCLElBQUksVUFBVSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLFNBQVMsQ0FBQztRQUU1QyxTQUFTLENBQUMsV0FBVyxFQUFFLENBQUMsT0FBTyxDQUFDLENBQUMsRUFBa0IsRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLEVBQUU7WUFDakUsSUFBSSxRQUFRLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDO1lBQ25DLEVBQUUsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUM7Z0JBQ1gsRUFBRSxDQUFDLENBQUMsUUFBUSxHQUFHLFVBQVUsQ0FBQyxDQUFDLENBQUM7b0JBQ3hCLFVBQVUsR0FBRyxRQUFRO29CQUNyQixTQUFTLEdBQUcsRUFBRTtnQkFDbEIsQ0FBQztZQUNMLENBQUM7UUFDTCxDQUFDLENBQUM7UUFFRixNQUFNLENBQUMsU0FBUztJQUNwQixDQUFDO0lBRUQsc0lBQXNJO0lBQ3RJLDRCQUE0QixDQUFDLE9BQXdCLEVBQUUsS0FBaUIsRUFBRSxZQUFxQixLQUFLO1FBQ2hHLDREQUE0RDtRQUM1RCxJQUFJLFNBQVMsR0FBRyxPQUFPO1FBQ3ZCLElBQUksVUFBbUI7UUFDdkIsRUFBRSxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQztZQUNaLFVBQVUsR0FBRyxNQUFNLENBQUMsU0FBUztRQUNqQyxDQUFDO1FBQUUsSUFBSSxDQUFDLENBQUM7WUFDTCxVQUFVLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDO1FBQzVDLENBQUM7UUFFRCxTQUFTLENBQUMsV0FBVyxFQUFFLENBQUMsT0FBTyxDQUFDLENBQUMsRUFBa0IsRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLEVBQUU7WUFDakUsSUFBSSxRQUFRLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDO1lBRW5DLEVBQUUsQ0FBQyxDQUFDLFNBQVMsSUFBSSxDQUFDLFFBQVEsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7Z0JBQy9CLE1BQU07WUFDVixDQUFDO1lBRUQsRUFBRSxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQztnQkFDWCxJQUFJLE1BQU0sR0FBRyxLQUFLLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUM7Z0JBQ3JDLEVBQUUsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUM7b0JBQ1QsTUFBTTtnQkFDVixDQUFDO2dCQUVELEVBQUUsQ0FBQyxDQUFDLFFBQVEsR0FBRyxVQUFVLENBQUMsQ0FBQyxDQUFDO29CQUN4QixVQUFVLEdBQUcsUUFBUTtvQkFDckIsU0FBUyxHQUFHLEVBQUU7Z0JBQ2xCLENBQUM7WUFDTCxDQUFDO1FBQ0wsQ0FBQyxDQUFDO1FBRUYsTUFBTSxDQUFDLFNBQVM7SUFDcEIsQ0FBQztDQUVKLFlBQVc7QUFFTixrQ0FBbUMsRUFBbUIsRUFBRSxLQUFpQixFQUFFLGdCQUFpRCxFQUFFLGFBQXVCO0lBQ3ZKLElBQUksRUFBRSxHQUFHLElBQUksT0FBTyxDQUFDLEtBQUssRUFBRSxlQUFlLENBQUMsUUFBUSxFQUFFLGdCQUFnQixDQUFDO0lBQ3ZFLElBQUksTUFBTSxHQUFHLEVBQUUsQ0FBQyxTQUFTLEVBQUU7SUFFM0IsdUJBQXVCO0lBQ3ZCLEVBQUUsQ0FBQyxxQkFBcUIsQ0FBQyxNQUFNLENBQUMsUUFBUSxFQUFFLENBQUMsQ0FBQztJQUU1QywwQkFBMEI7SUFDMUIsRUFBRSxDQUFDLENBQUMsYUFBYSxDQUFDLENBQUMsQ0FBQztRQUNoQixLQUFLLENBQUMsUUFBUSxDQUFDLFlBQVksRUFBRSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLEVBQUU7WUFDdEQsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksSUFBSSwyQ0FBVSxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDO2dCQUN6QyxFQUFFLENBQUMscUJBQXFCLENBQUMsQ0FBQyxDQUFDLFFBQVEsRUFBRSxDQUFDLENBQUM7WUFDM0MsQ0FBQztRQUNMLENBQUMsQ0FBQztJQUNOLENBQUM7SUFFRCxFQUFFLENBQUMsS0FBSyxFQUFFO0lBQ1YsTUFBTSxDQUFDLEVBQUU7QUFDYixDQUFDO0FBRUssNkJBQThCLEVBQW1CLEVBQUUsS0FBaUIsRUFBRSxNQUFlLEVBQUUsYUFBc0I7SUFDL0csSUFBSSxRQUFRLEdBQUcsSUFBSSxPQUFPLENBQUMsS0FBSyxFQUFFLGVBQWUsQ0FBQyxZQUFZLENBQUM7SUFDL0QsSUFBSSxhQUFhLEdBQUcsQ0FBQyxHQUFHO0lBRXhCLElBQUksTUFBTSxHQUFHLEVBQUUsQ0FBQyxTQUFTLEVBQUU7SUFFM0Isb0JBQW9CO0lBQ3BCLElBQUksR0FBVztJQUNmLEdBQUcsQ0FBQyxDQUFDLEdBQUcsSUFBSSxNQUFNLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUM7UUFDOUIsUUFBUSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsR0FBRyxNQUFNLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxHQUFHLGFBQWE7SUFDM0QsQ0FBQztJQUVELDRCQUE0QjtJQUM1QixRQUFRLENBQUMscUJBQXFCLENBQUMsTUFBTSxDQUFDLFFBQVEsRUFBRSx3REFBVyxDQUFDO0lBRTVELDBCQUEwQjtJQUMxQixFQUFFLENBQUMsQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDO1FBQ2hCLEtBQUssQ0FBQyxRQUFRLENBQUMsWUFBWSxFQUFFLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsRUFBRTtZQUN0RCxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxJQUFJLDJDQUFVLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUM7Z0JBQ3pDLFFBQVEsQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDLENBQUMsUUFBUSxFQUFFLHdEQUFXLENBQUM7WUFDM0QsQ0FBQztRQUNMLENBQUMsQ0FBQztJQUNOLENBQUM7SUFFRCxRQUFRLENBQUMsS0FBSyxFQUFFO0lBQ2hCLE1BQU0sQ0FBQyxRQUFRO0FBQ25CLENBQUMiLCJmaWxlIjoiLi9zcmMvYnJld19lbmdpbmUvcGF0aG1hcC50cy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIEJyZXcgZnJvbSBcIi4uL2JyZXdcIlxyXG5pbXBvcnQgKiBhcyBGRE0gZnJvbSAnLi9mYXN0ZGlqa3N0cmFtYXAnXHJcblxyXG5leHBvcnQgZW51bSBQYXRobWFwR29hbFR5cGUge1xyXG4gICAgVG9UYXJnZXQsXHJcbiAgICBFc2NhcGVUYXJnZXRcclxufVxyXG5cclxuaW50ZXJmYWNlIElQYXRobWFwQ2FjaGUge1xyXG4gICAgW2lkOiBzdHJpbmddIDogUGF0aG1hcFxyXG59XHJcblxyXG4vLyB0b2RvOiBmaW5kIG90aGVyIGluc3RhbmNlcyBvZiBjYWNoZWluZyBzdHVmZiBsaWtlIHRoaXMgYW5kIGdlbmVyYWxpemUgdGhlIGNsYXNzIDxUPlxyXG5leHBvcnQgY2xhc3MgUGF0aG1hcENhY2hlIHtcclxuICAgIG15X3BhdGhtYXBzOiBJUGF0aG1hcENhY2hlID0ge31cclxuXHJcbiAgICB1cGRhdGVDYWNoZShjYWNoZVR5cGUgOiBCcmV3LkVudW1zLlBhdGhtYXBDYWNoZVR5cGUsIHBtOiBQYXRobWFwKSB7XHJcbiAgICAgICAgdGhpcy5teV9wYXRobWFwc1tjYWNoZVR5cGVdID0gcG1cclxuICAgIH1cclxuXHJcbiAgICBnZXRQYXRobWFwKGNhY2hlVHlwZTogQnJldy5FbnVtcy5QYXRobWFwQ2FjaGVUeXBlKSB7XHJcbiAgICAgICAgaWYgKGNhY2hlVHlwZSBpbiB0aGlzLm15X3BhdGhtYXBzKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm15X3BhdGhtYXBzW2NhY2hlVHlwZV1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBnZXRQYXRobWFwQ2FjaGVUeXBlKGdvYWxUeXBlOiBQYXRobWFwR29hbFR5cGUsIGluY2x1ZGVBbGxpZXM6IGJvb2xlYW4sIG5hdmlnYXRpb25NZXRob2Q6IEJyZXcuRW51bXMuTGV2ZWxOYXZpZ2F0aW9uVHlwZSkgOiBQYXRobWFwQ2FjaGVUeXBlIHtcclxuICAgIC8vICAgICBsZXQgY2FjaGVUeXBlIDogUGF0aG1hcENhY2hlVHlwZVxyXG5cclxuICAgIC8vICAgICBpZiAoKGdvYWxUeXBlID09IFBhdGhtYXBHb2FsVHlwZS5Fc2NhcGVUYXJnZXQpICYmIChpbmNsdWRlQWxsaWVzID09IHRydWUpICYmIChuYXZpZ2F0aW9uTWV0aG9kID09IEJyZXcuRW51bXMuTGV2ZWxOYXZpZ2F0aW9uVHlwZS5GbHkpKSB7XHJcbiAgICAvLyAgICAgICAgIGNhY2hlVHlwZSA9IFBhdGhtYXBDYWNoZVR5cGUuRnJvbVBsYXllckFsbGllc19GbHlcclxuICAgIC8vICAgICB9IGVsc2UgaWYgKChnb2FsVHlwZSA9PSBQYXRobWFwR29hbFR5cGUuRXNjYXBlVGFyZ2V0KSAmJiAoaW5jbHVkZUFsbGllcyA9PSB0cnVlKSAmJiAobmF2aWdhdGlvbk1ldGhvZCA9PSBCcmV3LkVudW1zLkxldmVsTmF2aWdhdGlvblR5cGUuV2FsaykpIHtcclxuICAgIC8vICAgICAgICAgY2FjaGVUeXBlID0gUGF0aG1hcENhY2hlVHlwZS5Gcm9tUGxheWVyQWxsaWVzX1dhbGtcclxuICAgIC8vICAgICB9IGVsc2UgaWYgKChnb2FsVHlwZSA9PSBQYXRobWFwR29hbFR5cGUuRXNjYXBlVGFyZ2V0KSAmJiAoaW5jbHVkZUFsbGllcyA9PSBmYWxzZSkgJiYgKG5hdmlnYXRpb25NZXRob2QgPT0gQnJldy5FbnVtcy5MZXZlbE5hdmlnYXRpb25UeXBlLkZseSkpIHtcclxuICAgIC8vICAgICAgICAgY2FjaGVUeXBlID0gUGF0aG1hcENhY2hlVHlwZS5Gcm9tUGxheWVyT25seV9GbHlcclxuICAgIC8vICAgICB9IGVsc2UgaWYgKChnb2FsVHlwZSA9PSBQYXRobWFwR29hbFR5cGUuRXNjYXBlVGFyZ2V0KSAmJiAoaW5jbHVkZUFsbGllcyA9PSBmYWxzZSkgJiYgKG5hdmlnYXRpb25NZXRob2QgPT0gQnJldy5FbnVtcy5MZXZlbE5hdmlnYXRpb25UeXBlLldhbGspKSB7XHJcbiAgICAvLyAgICAgICAgIGNhY2hlVHlwZSA9IFBhdGhtYXBDYWNoZVR5cGUuRnJvbVBsYXllck9ubHlfV2Fsa1xyXG4gICAgLy8gICAgIH0gZWxzZSBpZiAoKGdvYWxUeXBlID09IFBhdGhtYXBHb2FsVHlwZS5Ub1RhcmdldCkgJiYgKGluY2x1ZGVBbGxpZXMgPT0gdHJ1ZSkgJiYgKG5hdmlnYXRpb25NZXRob2QgPT0gQnJldy5FbnVtcy5MZXZlbE5hdmlnYXRpb25UeXBlLkZseSkpIHtcclxuICAgIC8vICAgICAgICAgY2FjaGVUeXBlID0gUGF0aG1hcENhY2hlVHlwZS5Ub1BsYXllckFsbGllc19GbHlcclxuICAgIC8vICAgICB9IGVsc2UgaWYgKChnb2FsVHlwZSA9PSBQYXRobWFwR29hbFR5cGUuVG9UYXJnZXQpICYmIChpbmNsdWRlQWxsaWVzID09IHRydWUpICYmIChuYXZpZ2F0aW9uTWV0aG9kID09IEJyZXcuRW51bXMuTGV2ZWxOYXZpZ2F0aW9uVHlwZS5XYWxrKSkge1xyXG4gICAgLy8gICAgICAgICBjYWNoZVR5cGUgPSBQYXRobWFwQ2FjaGVUeXBlLlRvUGxheWVyQWxsaWVzX1dhbGtcclxuICAgIC8vICAgICB9IGVsc2UgaWYgKChnb2FsVHlwZSA9PSBQYXRobWFwR29hbFR5cGUuVG9UYXJnZXQpICYmIChpbmNsdWRlQWxsaWVzID09IGZhbHNlKSAmJiAobmF2aWdhdGlvbk1ldGhvZCA9PSBCcmV3LkVudW1zLkxldmVsTmF2aWdhdGlvblR5cGUuRmx5KSkge1xyXG4gICAgLy8gICAgICAgICBjYWNoZVR5cGUgPSBQYXRobWFwQ2FjaGVUeXBlLlRvUGxheWVyT25seV9GbHlcclxuICAgIC8vICAgICB9IGVsc2UgaWYgKChnb2FsVHlwZSA9PSBQYXRobWFwR29hbFR5cGUuVG9UYXJnZXQpICYmIChpbmNsdWRlQWxsaWVzID09IGZhbHNlKSAmJiAobmF2aWdhdGlvbk1ldGhvZCA9PSBCcmV3LkVudW1zLkxldmVsTmF2aWdhdGlvblR5cGUuV2FsaykpIHtcclxuICAgIC8vICAgICAgICAgY2FjaGVUeXBlID0gUGF0aG1hcENhY2hlVHlwZS5Ub1BsYXllck9ubHlfV2Fsa1xyXG4gICAgLy8gICAgIH1cclxuXHJcbiAgICAvLyAgICAgcmV0dXJuIGNhY2hlVHlwZVxyXG4gICAgLy8gfVxyXG5cclxuICAgIC8vIGdldFBhdGhtYXAoZ29hbFR5cGU6IFBhdGhtYXBHb2FsVHlwZSwgaW5jbHVkZUFsbGllczogYm9vbGVhbiwgbmF2aWdhdGlvbk1ldGhvZDogQnJldy5FbnVtcy5MZXZlbE5hdmlnYXRpb25UeXBlKSA6IFBhdGhtYXAge1xyXG4gICAgLy8gICAgIGxldCBjYWNoZVR5cGUgPSB0aGlzLmdldFBhdGhtYXBDYWNoZVR5cGUoZ29hbFR5cGUsIGluY2x1ZGVBbGxpZXMsIG5hdmlnYXRpb25NZXRob2QpXHJcbiAgICAvLyAgICAgcmV0dXJuIHRoaXMuZ2V0Q2FjaGUoY2FjaGVUeXBlKVxyXG4gICAgLy8gfVxyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgUGF0aG1hcCB7XHJcbiAgICBwYXRodHlwZTogUGF0aG1hcEdvYWxUeXBlXHJcbiAgICBmaWVsZCA6IEJyZXcuR3JpZE9mVGhpbmdzPG51bWJlcj5cclxuICAgIHdpZHRoOiBudW1iZXJcclxuICAgIGhlaWdodDogbnVtYmVyXHJcbiAgICAvLyBwYXNzYWJsZV9rZXlzX2xpc3QgOiBudW1iZXJbXVxyXG4gICAgLy8gYmxvY2tlZF9rZXlzX2xvb2t1cDogRGljdDxib29sZWFuPlxyXG4gICAgZGptYXAgOiBGRE0uSURpamtzdHJhTWFwXHJcblxyXG4gICAgLy8gbW9zdGx5IGZvciBkaXNwbGF5aW5nIGRlYnVnXHJcbiAgICBtYXhfdmFsdWUgOiBudW1iZXJcclxuICAgIG1pbl92YWx1ZSA6IG51bWJlciBcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihsZXZlbDogQnJldy5MZXZlbCwgcGF0aHR5cGU6IFBhdGhtYXBHb2FsVHlwZSwgbmF2aWdhdGlvblR5cGUgOiBCcmV3LkVudW1zLkxldmVsTmF2aWdhdGlvblR5cGUgPSBCcmV3LkVudW1zLkxldmVsTmF2aWdhdGlvblR5cGUuV2Fsaykge1xyXG4gICAgICAgIHRoaXMuZmllbGQgPSBuZXcgQnJldy5HcmlkT2ZUaGluZ3M8bnVtYmVyPigpXHJcbiAgICAgICAgdGhpcy5wYXRodHlwZSA9IHBhdGh0eXBlXHJcbiAgICAgICAgdGhpcy53aWR0aCA9IGxldmVsLndpZHRoXHJcbiAgICAgICAgdGhpcy5oZWlnaHQgPSBsZXZlbC5oZWlnaHRcclxuXHJcbiAgICAgICAgLy8gcGljayBhIHNwb3QgdG8gc3RhcnQgdGhlIGZsb29kIGZpbGwgZm9yIHBhc3NhYmxlIHRpbGVzXHJcbiAgICAgICAgbGV0IHZhbGlkX3N0YXJ0X3h5ID0gbGV2ZWwubmF2aWdhdGlvbl90aWxlc1tuYXZpZ2F0aW9uVHlwZV1bMF1cclxuICAgICAgICBcclxuICAgICAgICAvLyBpbml0aWF0ZSB0aGUgbWFwXHJcbiAgICAgICAgbGV0IHBhdGhhYmxlX2ZuIDogRkRNLklQYXRoYWJsZUZ1bmN0aW9uXHJcbiAgICAgICAgaWYgKG5hdmlnYXRpb25UeXBlID09IEJyZXcuRW51bXMuTGV2ZWxOYXZpZ2F0aW9uVHlwZS5XYWxrKSB7XHJcbiAgICAgICAgICAgIHBhdGhhYmxlX2ZuID0gRkRNLlBhdGhGdW5jdGlvbldhbGthYmxlXHJcbiAgICAgICAgfSBlbHNlIGlmIChuYXZpZ2F0aW9uVHlwZSA9PSBCcmV3LkVudW1zLkxldmVsTmF2aWdhdGlvblR5cGUuRmx5KSB7XHJcbiAgICAgICAgICAgIHBhdGhhYmxlX2ZuID0gRkRNLlBhdGhGdW5jdGlvbkZseWFibGVcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYHVua25vd24gbGV2ZWwgbmF2aWdhdGlvbiB0eXBlOiAke25hdmlnYXRpb25UeXBlfWApXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmRqbWFwID0gRkRNLnNldHVwRGlqa3N0cmFNYXAobGV2ZWwsIHZhbGlkX3N0YXJ0X3h5LCBwYXRoYWJsZV9mbilcclxuICAgIH1cclxuICAgIFxyXG4gICAgc2V0RGlqa3N0cmFNYXBUYXJnZXRzKHRhcmdldF94eTogQnJldy5Db29yZGluYXRlLCBnb2FsX3ZhbHVlOiBudW1iZXIpIHtcclxuICAgICAgICBsZXQga2V5ID0gQnJldy5VdGlscy54eVRvS2V5KHRhcmdldF94eSlcclxuICAgICAgICB0aGlzLmRqbWFwW2tleV0gPSBnb2FsX3ZhbHVlXHJcbiAgICB9XHJcblxyXG4gICAgc29sdmUoKSB7XHJcbiAgICAgICAgLy8gcnVuIHRoZSBzb2x2ZXJcclxuICAgICAgICBGRE0uc29sdmVEaWprc3RyYU1hcCh0aGlzLmRqbWFwKVxyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIGZpbmQgbWF4L21pbiB2YWx1ZXNcclxuICAgICAgICBsZXQgbWF4bWluID0gRkRNLmdldE1heEFuZE1pbkRpamtzdHJhTWFwVmFsdWVzKHRoaXMuZGptYXApXHJcbiAgICAgICAgdGhpcy5tYXhfdmFsdWUgPSBtYXhtaW4ubWF4XHJcbiAgICAgICAgdGhpcy5taW5fdmFsdWUgPSBtYXhtaW4ubWluXHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gY29udmVydCBiYWNrIHRvIGdyaWQgb2YgdGhpbmdzXHJcbiAgICAgICAgbGV0IGtleTogc3RyaW5nXHJcbiAgICAgICAgbGV0IHh5OiBCcmV3LkNvb3JkaW5hdGVcclxuICAgICAgICAvLyBsZXQgbnVtX2tleVxyXG4gICAgICAgIGZvciAoa2V5IGluIHRoaXMuZGptYXApIHtcclxuICAgICAgICAgICAgeHkgPSBCcmV3LlV0aWxzLmtleVRvWFkoTnVtYmVyKGtleSkpXHJcbiAgICAgICAgICAgIHRoaXMuZmllbGQuc2V0QXQoeHksIHRoaXMuZGptYXBba2V5XSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKGBudW1iZXIgb2YgcGFzc2VzOiAke251bV9wYXNzZXN9YClcclxuICAgIH1cclxuXHJcblxyXG4gICAgZ2V0RG93bmhpbGxOZWlnaGJvcihmcm9tX3h5OiBCcmV3LkNvb3JkaW5hdGUpIDogQnJldy5Db29yZGluYXRlIHtcclxuICAgICAgICBsZXQgbG93ZXN0X3h5ID0gZnJvbV94eVxyXG4gICAgICAgIGxldCBsb3dlc3RfdmFsID0gdGhpcy5maWVsZC5nZXRBdChsb3dlc3RfeHkpXHJcbiAgICAgICAgXHJcbiAgICAgICAgbG93ZXN0X3h5LmdldEFkamFjZW50KCkuZm9yRWFjaCgoeHk6QnJldy5Db29yZGluYXRlLCBpbmRleCwgYXJyYXkpID0+IHtcclxuICAgICAgICAgICAgbGV0IHRlbXBfdmFsID0gdGhpcy5maWVsZC5nZXRBdCh4eSlcclxuICAgICAgICAgICAgaWYgKHRlbXBfdmFsKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGVtcF92YWwgPCBsb3dlc3RfdmFsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbG93ZXN0X3ZhbCA9IHRlbXBfdmFsXHJcbiAgICAgICAgICAgICAgICAgICAgbG93ZXN0X3h5ID0geHlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIGxvd2VzdF94eVxyXG4gICAgfVxyXG5cclxuICAgIC8vIGdldFVuYmxvY2tlZERvd25oaWxsTmVpZ2hib3IoZnJvbV94eTogQnJldy5Db29yZGluYXRlLCBsZXZlbDogQnJldy5MZXZlbCwgZXhjZXB0X21vYj86IEJyZXcuR3JpZFRoaW5ncy5Nb25zdGVyKSA6IEJyZXcuQ29vcmRpbmF0ZSB7XHJcbiAgICBnZXRVbmJsb2NrZWREb3duaGlsbE5laWdoYm9yKGZyb21feHk6IEJyZXcuQ29vcmRpbmF0ZSwgbGV2ZWw6IEJyZXcuTGV2ZWwsIGFsbHlfbW9kZTogYm9vbGVhbiA9IGZhbHNlKSA6IEJyZXcuQ29vcmRpbmF0ZSB7XHJcbiAgICAgICAgLy8gcmV0dXJuIGxvd2VzdC12YWx1ZSBjZWxsIG5vdCBibG9ja2VkIGJ5IGFub3RoZXIgc29tZXRoaW5nXHJcbiAgICAgICAgbGV0IGxvd2VzdF94eSA9IGZyb21feHlcclxuICAgICAgICBsZXQgbG93ZXN0X3ZhbCA6IG51bWJlclxyXG4gICAgICAgIGlmIChhbGx5X21vZGUpIHtcclxuICAgICAgICAgICAgbG93ZXN0X3ZhbCA9IE51bWJlci5NQVhfVkFMVUVcclxuICAgICAgICB9ICBlbHNlIHtcclxuICAgICAgICAgICAgbG93ZXN0X3ZhbCA9IHRoaXMuZmllbGQuZ2V0QXQobG93ZXN0X3h5KVxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBsb3dlc3RfeHkuZ2V0QWRqYWNlbnQoKS5mb3JFYWNoKCh4eTpCcmV3LkNvb3JkaW5hdGUsIGluZGV4LCBhcnJheSkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgdGVtcF92YWwgPSB0aGlzLmZpZWxkLmdldEF0KHh5KVxyXG5cclxuICAgICAgICAgICAgaWYgKGFsbHlfbW9kZSAmJiAodGVtcF92YWwgPT0gMCkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBpZiAodGVtcF92YWwpIHtcclxuICAgICAgICAgICAgICAgIGxldCBtb2JfYXQgPSBsZXZlbC5tb25zdGVycy5nZXRBdCh4eSlcclxuICAgICAgICAgICAgICAgIGlmIChtb2JfYXQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgaWYgKHRlbXBfdmFsIDwgbG93ZXN0X3ZhbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxvd2VzdF92YWwgPSB0ZW1wX3ZhbFxyXG4gICAgICAgICAgICAgICAgICAgIGxvd2VzdF94eSA9IHh5XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiBsb3dlc3RfeHlcclxuICAgIH1cclxuICAgIFxyXG59Ly9lbmQgY2xhc3NcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVHZW5lcmljTWFwVG9QbGF5ZXIoZ206IEJyZXcuR2FtZU1hc3RlciwgbGV2ZWw6IEJyZXcuTGV2ZWwsIG5hdmlnYXRpb25NZXRob2QgOiBCcmV3LkVudW1zLkxldmVsTmF2aWdhdGlvblR5cGUsIGluY2x1ZGVBbGxpZXMgOiBib29sZWFuICkgOiBQYXRobWFwIHtcclxuICAgIGxldCBwbSA9IG5ldyBQYXRobWFwKGxldmVsLCBQYXRobWFwR29hbFR5cGUuVG9UYXJnZXQsIG5hdmlnYXRpb25NZXRob2QpXHJcbiAgICBsZXQgcGxheWVyID0gZ20uZ2V0UGxheWVyKClcclxuICAgIFxyXG4gICAgLy8gc2V0IHBsYXllciBhcyB0YXJnZXRcclxuICAgIHBtLnNldERpamtzdHJhTWFwVGFyZ2V0cyhwbGF5ZXIubG9jYXRpb24sIDApXHJcblxyXG4gICAgLy8gc2V0IGFsbGllcyBpZiBuZWNlc3NhcnlcclxuICAgIGlmIChpbmNsdWRlQWxsaWVzKSB7XHJcbiAgICAgICAgbGV2ZWwubW9uc3RlcnMuZ2V0QWxsVGhpbmdzKCkuZm9yRWFjaCgobSwgaW5kZXgsIGFycmF5KSA9PntcclxuICAgICAgICAgICAgaWYgKG0udGVhbSA9PSBCcmV3LkVudW1zLlRlYW0uUGxheWVyQWxsaWVkKSB7XHJcbiAgICAgICAgICAgICAgICBwbS5zZXREaWprc3RyYU1hcFRhcmdldHMobS5sb2NhdGlvbiwgMClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgcG0uc29sdmUoKVxyXG4gICAgcmV0dXJuIHBtXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVNYXBGcm9tUGxheWVyKGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGxldmVsOiBCcmV3LkxldmVsLCB0b19tYXA6IFBhdGhtYXAsIGluY2x1ZGVBbGxpZXM6IGJvb2xlYW4pIDogUGF0aG1hcCB7XHJcbiAgICBsZXQgZnJvbV9tYXAgPSBuZXcgUGF0aG1hcChsZXZlbCwgUGF0aG1hcEdvYWxUeXBlLkVzY2FwZVRhcmdldClcclxuICAgIGxldCBlc2NhcGVfZmFjdG9yID0gLTEuMlxyXG4gICAgXHJcbiAgICBsZXQgcGxheWVyID0gZ20uZ2V0UGxheWVyKClcclxuICAgIFxyXG4gICAgLy8gaW52ZXJ0IHRoZSB0by1tYXBcclxuICAgIGxldCBrZXk6IHN0cmluZ1xyXG4gICAgZm9yIChrZXkgaW4gdG9fbWFwLmZpZWxkLnRoaW5ncykge1xyXG4gICAgICAgIGZyb21fbWFwLmRqbWFwW2tleV0gPSB0b19tYXAuZGptYXBba2V5XSAqIGVzY2FwZV9mYWN0b3JcclxuICAgIH1cclxuXHJcbiAgICAvLyByZXNldCBwbGF5ZXIgdG8gaGlnaCBwZWFrXHJcbiAgICBmcm9tX21hcC5zZXREaWprc3RyYU1hcFRhcmdldHMocGxheWVyLmxvY2F0aW9uLCBGRE0uTUFYX0lOVClcclxuXHJcbiAgICAvLyBzZXQgYWxsaWVzIGlmIG5lY2Vzc2FyeVxyXG4gICAgaWYgKGluY2x1ZGVBbGxpZXMpIHtcclxuICAgICAgICBsZXZlbC5tb25zdGVycy5nZXRBbGxUaGluZ3MoKS5mb3JFYWNoKChtLCBpbmRleCwgYXJyYXkpID0+e1xyXG4gICAgICAgICAgICBpZiAobS50ZWFtID09IEJyZXcuRW51bXMuVGVhbS5QbGF5ZXJBbGxpZWQpIHtcclxuICAgICAgICAgICAgICAgIGZyb21fbWFwLnNldERpamtzdHJhTWFwVGFyZ2V0cyhtLmxvY2F0aW9uLCBGRE0uTUFYX0lOVClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgZnJvbV9tYXAuc29sdmUoKVxyXG4gICAgcmV0dXJuIGZyb21fbWFwXHJcbn1cclxuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/brew_engine/pathmap.ts\n");

/***/ }),

/***/ "./src/brew_engine/timers.ts":
/*!***********************************!*\
  !*** ./src/brew_engine/timers.ts ***!
  \***********************************/
/*! exports provided: TurnTimer, TimerMonitor */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"TurnTimer\", function() { return TurnTimer; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"TimerMonitor\", function() { return TimerMonitor; });\n/* harmony import */ var _brew__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../brew */ \"./src/brew.ts\");\n\r\n// interface ITimerID {\r\n//     monster_id: number,\r\n//     flag : Brew.Enums.Flag\r\n// }\r\nclass TurnTimer {\r\n    constructor(actor, flag, start_turn, duration) {\r\n        this.actor = actor;\r\n        this.flag = flag;\r\n        this.start_turn = start_turn;\r\n        this.duration = duration;\r\n        this.trigger_turn = start_turn + duration;\r\n        this.extensions_count = 0;\r\n    }\r\n    checkTrigger(current_turn) {\r\n        return current_turn >= this.trigger_turn;\r\n    }\r\n    getKey() {\r\n        return makeTurnTimerKey(this.actor, this.flag);\r\n    }\r\n    extendDuration(extra_turns) {\r\n        this.duration += extra_turns;\r\n        this.trigger_turn += extra_turns;\r\n        this.extensions_count += 1;\r\n    }\r\n    getTurnsRemaining(current_turn) {\r\n        return (this.trigger_turn - current_turn);\r\n    }\r\n}\r\nfunction makeTurnTimerKey(actor, flag) {\r\n    return actor.getID().toString() + '_' + _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].Flag[flag];\r\n}\r\nclass TimerMonitor {\r\n    constructor() {\r\n        this.dictionaryOfTimers = {};\r\n    }\r\n    hasTimer(actor, flag) {\r\n        let key = makeTurnTimerKey(actor, flag);\r\n        return (key in this.dictionaryOfTimers);\r\n    }\r\n    getTimer(actor, flag) {\r\n        if (this.hasTimer(actor, flag)) {\r\n            let key = makeTurnTimerKey(actor, flag);\r\n            return this.dictionaryOfTimers[key];\r\n        }\r\n        else {\r\n            return null;\r\n        }\r\n    }\r\n    removeTimer(actor, flag) {\r\n        if (this.hasTimer(actor, flag)) {\r\n            let key = makeTurnTimerKey(actor, flag);\r\n            delete this.dictionaryOfTimers[key];\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    setFlagWithTimer(gm, actor, flag, turn_duration) {\r\n        let new_timer = new TurnTimer(actor, flag, gm.turn_count, turn_duration);\r\n        actor.setFlag(flag);\r\n        this.addTimer(new_timer);\r\n    }\r\n    addTimer(new_timer) {\r\n        // if has an existing timer, extend it instead\r\n        if (this.hasTimer(new_timer.actor, new_timer.flag)) {\r\n            // this.removeTimer(new_timer.actor, new_timer.flag)\r\n            let existing_timer = this.getTimer(new_timer.actor, new_timer.flag);\r\n            existing_timer.extendDuration(new_timer.duration);\r\n        }\r\n        else {\r\n            let key = makeTurnTimerKey(new_timer.actor, new_timer.flag);\r\n            this.dictionaryOfTimers[key] = new_timer;\r\n        }\r\n    }\r\n    getAllTimers() {\r\n        let all_timers = [];\r\n        for (var key in this.dictionaryOfTimers) {\r\n            if (this.dictionaryOfTimers.hasOwnProperty(key)) {\r\n                var element = this.dictionaryOfTimers[key];\r\n                all_timers.push(element);\r\n            }\r\n        }\r\n        return all_timers;\r\n        // return (let tt of this.dictionaryOfTimers)\r\n    }\r\n    getAllTimersTriggeredFor(actor, current_turn) {\r\n        let all_timers = this.getAllTimers();\r\n        let their_timers = all_timers.filter((timer, index, array) => {\r\n            return (timer.actor.isSameThing(actor) && (timer.checkTrigger(current_turn)));\r\n        });\r\n        return their_timers;\r\n    }\r\n    getAllTimersFor(actor) {\r\n        let all_timers = this.getAllTimers();\r\n        let their_timers = all_timers.filter((timer, index, array) => {\r\n            return timer.actor.isSameThing(actor);\r\n        });\r\n        return their_timers;\r\n    }\r\n}\r\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvYnJld19lbmdpbmUvdGltZXJzLnRzP2YxMDkiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUErQjtBQUUvQix1QkFBdUI7QUFDdkIsMEJBQTBCO0FBQzFCLDZCQUE2QjtBQUM3QixJQUFJO0FBRUU7SUFHRixZQUFtQixLQUE0QixFQUFTLElBQXFCLEVBQVMsVUFBa0IsRUFBUyxRQUFnQjtRQUE5RyxVQUFLLEdBQUwsS0FBSyxDQUF1QjtRQUFTLFNBQUksR0FBSixJQUFJLENBQWlCO1FBQVMsZUFBVSxHQUFWLFVBQVUsQ0FBUTtRQUFTLGFBQVEsR0FBUixRQUFRLENBQVE7UUFDN0gsSUFBSSxDQUFDLFlBQVksR0FBRyxVQUFVLEdBQUcsUUFBUTtRQUN6QyxJQUFJLENBQUMsZ0JBQWdCLEdBQUcsQ0FBQztJQUM3QixDQUFDO0lBRUQsWUFBWSxDQUFDLFlBQW9CO1FBQzdCLE1BQU0sQ0FBQyxZQUFZLElBQUksSUFBSSxDQUFDLFlBQVk7SUFDNUMsQ0FBQztJQUVELE1BQU07UUFDRixNQUFNLENBQUMsZ0JBQWdCLENBQUMsSUFBSSxDQUFDLEtBQUssRUFBRSxJQUFJLENBQUMsSUFBSSxDQUFDO0lBQ2xELENBQUM7SUFFRCxjQUFjLENBQUMsV0FBa0I7UUFDN0IsSUFBSSxDQUFDLFFBQVEsSUFBSSxXQUFXO1FBQzVCLElBQUksQ0FBQyxZQUFZLElBQUksV0FBVztRQUNoQyxJQUFJLENBQUMsZ0JBQWdCLElBQUksQ0FBQztJQUM5QixDQUFDO0lBRUQsaUJBQWlCLENBQUMsWUFBb0I7UUFDbEMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLFlBQVksR0FBRyxZQUFZLENBQUM7SUFDN0MsQ0FBQztDQUNKO0FBRUQsMEJBQTBCLEtBQTRCLEVBQUUsSUFBcUI7SUFDekUsTUFBTSxDQUFDLEtBQUssQ0FBQyxLQUFLLEVBQUUsQ0FBQyxRQUFRLEVBQUUsR0FBRyxHQUFHLEdBQUcsMkNBQVUsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFD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SUFFRCx3QkFBd0IsQ0FBQyxLQUE0QixFQUFFLFlBQW9CO1FBQ3ZFLElBQUksVUFBVSxHQUFHLElBQUksQ0FBQyxZQUFZLEVBQUU7UUFDcEMsSUFBSSxZQUFZLEdBQUcsVUFBVSxDQUFDLE1BQU0sQ0FBQyxDQUFDLEtBQWdCLEVBQUUsS0FBYSxFQUFFLEtBQUssRUFBRSxFQUFFO1lBQzVFLE1BQU0sQ0FBQyxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsV0FBVyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLFlBQVksQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDO1FBQ2pGLENBQUMsQ0FBQztRQUNGLE1BQU0sQ0FBQyxZQUFZO0lBQ3ZCLENBQUM7SUFFRCxlQUFlLENBQUMsS0FBNEI7UUFDeEMsSUFBSSxVQUFVLEdBQUcsSUFBSSxDQUFDLFlBQVksRUFBRTtRQUNwQyxJQUFJLFlBQVksR0FBRyxVQUFVLENBQUMsTUFBTSxDQUFDLENBQUMsS0FBZ0IsRUFBRSxLQUFhLEVBQUUsS0FBSyxFQUFFLEVBQUU7WUFDNUUsTUFBTSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsV0FBVyxDQUFDLEtBQUssQ0FBQztRQUN6QyxDQUFDLENBQUM7UUFDRixNQUFNLENBQUMsWUFBWTtJQUN2QixDQUFDO0NBRUoiLCJmaWxlIjoiLi9zcmMvYnJld19lbmdpbmUvdGltZXJzLnRzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgQnJldyBmcm9tIFwiLi4vYnJld1wiXHJcblxyXG4vLyBpbnRlcmZhY2UgSVRpbWVySUQge1xyXG4vLyAgICAgbW9uc3Rlcl9pZDogbnVtYmVyLFxyXG4vLyAgICAgZmxhZyA6IEJyZXcuRW51bXMuRmxhZ1xyXG4vLyB9XHJcblxyXG5leHBvcnQgY2xhc3MgVHVyblRpbWVyIHtcclxuICAgIHByaXZhdGUgdHJpZ2dlcl90dXJuOiBudW1iZXJcclxuICAgIGV4dGVuc2lvbnNfY291bnQgOiBudW1iZXJcclxuICAgIGNvbnN0cnVjdG9yKHB1YmxpYyBhY3RvcjogQnJldy5HcmlkVGhpbmdzLlRoaW5nLCBwdWJsaWMgZmxhZzogQnJldy5FbnVtcy5GbGFnLCBwdWJsaWMgc3RhcnRfdHVybjogbnVtYmVyLCBwdWJsaWMgZHVyYXRpb246IG51bWJlcikge1xyXG4gICAgICAgIHRoaXMudHJpZ2dlcl90dXJuID0gc3RhcnRfdHVybiArIGR1cmF0aW9uXHJcbiAgICAgICAgdGhpcy5leHRlbnNpb25zX2NvdW50ID0gMFxyXG4gICAgfVxyXG5cclxuICAgIGNoZWNrVHJpZ2dlcihjdXJyZW50X3R1cm46IG51bWJlcikge1xyXG4gICAgICAgIHJldHVybiBjdXJyZW50X3R1cm4gPj0gdGhpcy50cmlnZ2VyX3R1cm5cclxuICAgIH1cclxuXHJcbiAgICBnZXRLZXkoKSA6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIG1ha2VUdXJuVGltZXJLZXkodGhpcy5hY3RvciwgdGhpcy5mbGFnKVxyXG4gICAgfVxyXG5cclxuICAgIGV4dGVuZER1cmF0aW9uKGV4dHJhX3R1cm5zOm51bWJlcikge1xyXG4gICAgICAgIHRoaXMuZHVyYXRpb24gKz0gZXh0cmFfdHVybnNcclxuICAgICAgICB0aGlzLnRyaWdnZXJfdHVybiArPSBleHRyYV90dXJuc1xyXG4gICAgICAgIHRoaXMuZXh0ZW5zaW9uc19jb3VudCArPSAxXHJcbiAgICB9XHJcblxyXG4gICAgZ2V0VHVybnNSZW1haW5pbmcoY3VycmVudF90dXJuOiBudW1iZXIpIDogbnVtYmVyIHtcclxuICAgICAgICByZXR1cm4gKHRoaXMudHJpZ2dlcl90dXJuIC0gY3VycmVudF90dXJuKVxyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBtYWtlVHVyblRpbWVyS2V5KGFjdG9yOiBCcmV3LkdyaWRUaGluZ3MuVGhpbmcsIGZsYWc6IEJyZXcuRW51bXMuRmxhZykgOiBzdHJpbmcge1xyXG4gICAgcmV0dXJuIGFjdG9yLmdldElEKCkudG9TdHJpbmcoKSArICdfJyArIEJyZXcuRW51bXMuRmxhZ1tmbGFnXVxyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgVGltZXJNb25pdG9yIHtcclxuICAgIGRpY3Rpb25hcnlPZlRpbWVycyA6IHsgW2tleTogc3RyaW5nXSA6IFR1cm5UaW1lciB9XHJcblxyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgdGhpcy5kaWN0aW9uYXJ5T2ZUaW1lcnMgPSB7fVxyXG4gICAgfVxyXG5cclxuICAgIGhhc1RpbWVyKGFjdG9yOiBCcmV3LkdyaWRUaGluZ3MuVGhpbmcsIGZsYWc6IEJyZXcuRW51bXMuRmxhZykgOiBib29sZWFuIHtcclxuICAgICAgICBsZXQga2V5ID0gbWFrZVR1cm5UaW1lcktleShhY3RvciwgZmxhZylcclxuICAgICAgICByZXR1cm4gKGtleSBpbiB0aGlzLmRpY3Rpb25hcnlPZlRpbWVycylcclxuICAgIH1cclxuXHJcbiAgICBnZXRUaW1lcihhY3RvcjogQnJldy5HcmlkVGhpbmdzLlRoaW5nLCBmbGFnOiBCcmV3LkVudW1zLkZsYWcpIDogVHVyblRpbWVyIHtcclxuICAgICAgICBpZiAodGhpcy5oYXNUaW1lcihhY3RvciwgZmxhZykpIHtcclxuICAgICAgICAgICAgbGV0IGtleSA9IG1ha2VUdXJuVGltZXJLZXkoYWN0b3IsIGZsYWcpXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmRpY3Rpb25hcnlPZlRpbWVyc1trZXldXHJcblxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJlbW92ZVRpbWVyKGFjdG9yOiBCcmV3LkdyaWRUaGluZ3MuVGhpbmcsIGZsYWc6IEJyZXcuRW51bXMuRmxhZykgOiBib29sZWFuIHtcclxuICAgICAgICBpZiAodGhpcy5oYXNUaW1lcihhY3RvciwgZmxhZykpIHtcclxuICAgICAgICAgICAgbGV0IGtleSA9IG1ha2VUdXJuVGltZXJLZXkoYWN0b3IsIGZsYWcpXHJcbiAgICAgICAgICAgIGRlbGV0ZSB0aGlzLmRpY3Rpb25hcnlPZlRpbWVyc1trZXldXHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICBzZXRGbGFnV2l0aFRpbWVyKGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGFjdG9yOiBCcmV3LkdyaWRUaGluZ3MuVGhpbmcsIGZsYWc6IEJyZXcuRW51bXMuRmxhZywgdHVybl9kdXJhdGlvbjogbnVtYmVyKSB7XHJcbiAgICAgICAgbGV0IG5ld190aW1lciA9IG5ldyBUdXJuVGltZXIoYWN0b3IsIGZsYWcsIGdtLnR1cm5fY291bnQsIHR1cm5fZHVyYXRpb24pXHJcbiAgICAgICAgYWN0b3Iuc2V0RmxhZyhmbGFnKVxyXG4gICAgICAgIHRoaXMuYWRkVGltZXIobmV3X3RpbWVyKVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBhZGRUaW1lcihuZXdfdGltZXIgOiBUdXJuVGltZXIpIHtcclxuICAgICAgICAvLyBpZiBoYXMgYW4gZXhpc3RpbmcgdGltZXIsIGV4dGVuZCBpdCBpbnN0ZWFkXHJcbiAgICAgICAgaWYgKHRoaXMuaGFzVGltZXIobmV3X3RpbWVyLmFjdG9yLCBuZXdfdGltZXIuZmxhZykpIHtcclxuICAgICAgICAgICAgLy8gdGhpcy5yZW1vdmVUaW1lcihuZXdfdGltZXIuYWN0b3IsIG5ld190aW1lci5mbGFnKVxyXG4gICAgICAgICAgICBsZXQgZXhpc3RpbmdfdGltZXIgPSB0aGlzLmdldFRpbWVyKG5ld190aW1lci5hY3RvciwgbmV3X3RpbWVyLmZsYWcpXHJcbiAgICAgICAgICAgIGV4aXN0aW5nX3RpbWVyLmV4dGVuZER1cmF0aW9uKG5ld190aW1lci5kdXJhdGlvbilcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBsZXQga2V5ID0gbWFrZVR1cm5UaW1lcktleShuZXdfdGltZXIuYWN0b3IsIG5ld190aW1lci5mbGFnKVxyXG4gICAgICAgICAgICB0aGlzLmRpY3Rpb25hcnlPZlRpbWVyc1trZXldID0gbmV3X3RpbWVyXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGdldEFsbFRpbWVycygpIDogQXJyYXk8VHVyblRpbWVyPiB7XHJcbiAgICAgICAgbGV0IGFsbF90aW1lcnMgOiBBcnJheTxUdXJuVGltZXI+ID0gW11cclxuICAgICAgICBmb3IgKHZhciBrZXkgaW4gdGhpcy5kaWN0aW9uYXJ5T2ZUaW1lcnMpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuZGljdGlvbmFyeU9mVGltZXJzLmhhc093blByb3BlcnR5KGtleSkpIHtcclxuICAgICAgICAgICAgICAgIHZhciBlbGVtZW50ID0gdGhpcy5kaWN0aW9uYXJ5T2ZUaW1lcnNba2V5XTtcclxuICAgICAgICAgICAgICAgIGFsbF90aW1lcnMucHVzaChlbGVtZW50KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gYWxsX3RpbWVyc1xyXG4gICAgICAgIC8vIHJldHVybiAobGV0IHR0IG9mIHRoaXMuZGljdGlvbmFyeU9mVGltZXJzKVxyXG4gICAgfVxyXG5cclxuICAgIGdldEFsbFRpbWVyc1RyaWdnZXJlZEZvcihhY3RvcjogQnJldy5HcmlkVGhpbmdzLlRoaW5nLCBjdXJyZW50X3R1cm46IG51bWJlcikge1xyXG4gICAgICAgIGxldCBhbGxfdGltZXJzID0gdGhpcy5nZXRBbGxUaW1lcnMoKVxyXG4gICAgICAgIGxldCB0aGVpcl90aW1lcnMgPSBhbGxfdGltZXJzLmZpbHRlcigodGltZXI6IFR1cm5UaW1lciwgaW5kZXg6IG51bWJlciwgYXJyYXkpID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuICh0aW1lci5hY3Rvci5pc1NhbWVUaGluZyhhY3RvcikgJiYgKHRpbWVyLmNoZWNrVHJpZ2dlcihjdXJyZW50X3R1cm4pKSlcclxuICAgICAgICB9KVxyXG4gICAgICAgIHJldHVybiB0aGVpcl90aW1lcnNcclxuICAgIH1cclxuXHJcbiAgICBnZXRBbGxUaW1lcnNGb3IoYWN0b3I6IEJyZXcuR3JpZFRoaW5ncy5UaGluZykge1xyXG4gICAgICAgIGxldCBhbGxfdGltZXJzID0gdGhpcy5nZXRBbGxUaW1lcnMoKVxyXG4gICAgICAgIGxldCB0aGVpcl90aW1lcnMgPSBhbGxfdGltZXJzLmZpbHRlcigodGltZXI6IFR1cm5UaW1lciwgaW5kZXg6IG51bWJlciwgYXJyYXkpID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuIHRpbWVyLmFjdG9yLmlzU2FtZVRoaW5nKGFjdG9yKVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgcmV0dXJuIHRoZWlyX3RpbWVyc1xyXG4gICAgfVxyXG5cclxufVxyXG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/brew_engine/timers.ts\n");

/***/ }),

/***/ "./src/brew_game/animations.ts":
/*!*************************************!*\
  !*** ./src/brew_game/animations.ts ***!
  \*************************************/
/*! exports provided: runAnimationEvent, runAnimation_OverPath, runAnimation_Flash, runAnimation_Circle, createCircleAnimationEvent, createReverseCircleAnimationEvent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"runAnimationEvent\", function() { return runAnimationEvent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"runAnimation_OverPath\", function() { return runAnimation_OverPath; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"runAnimation_Flash\", function() { return runAnimation_Flash; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"runAnimation_Circle\", function() { return runAnimation_Circle; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"createCircleAnimationEvent\", function() { return createCircleAnimationEvent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"createReverseCircleAnimationEvent\", function() { return createReverseCircleAnimationEvent; });\n/* harmony import */ var _brew__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../brew */ \"./src/brew.ts\");\n\r\nfunction runAnimationEvent(gm, brEvent) {\r\n    // console.log(\"running animation \", brEvent.animationData.animationType)\r\n    if (brEvent.animationData.animationType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewAnimationType.Flash) {\r\n        runAnimation_Flash(gm, brEvent);\r\n    }\r\n    else if (brEvent.animationData.animationType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewAnimationType.OverPath) {\r\n        runAnimation_OverPath(gm, brEvent);\r\n    }\r\n    else if (brEvent.animationData.animationType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewAnimationType.CircleOut) {\r\n        runAnimation_Circle(gm, false, brEvent);\r\n    }\r\n    else if (brEvent.animationData.animationType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewAnimationType.CircleIn) {\r\n        runAnimation_Circle(gm, true, brEvent);\r\n    }\r\n    else {\r\n        console.error(`unknown animation type ${brEvent.animationData.animationType}`);\r\n    }\r\n}\r\nfunction runAnimation_OverPath(gm, brEvent) {\r\n    let path;\r\n    if (brEvent.animationData.path) {\r\n        path = brEvent.animationData.path;\r\n        // path.splice(path.length-1,1)\r\n    }\r\n    else if ((brEvent.animationData.from_xy) && (brEvent.animationData.to_xy)) {\r\n        let to_xy = brEvent.animationData.to_xy;\r\n        let from_xy = brEvent.animationData.from_xy;\r\n        path = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].getLineBetweenPoints(from_xy, to_xy);\r\n        // path.splice(0, 1)\r\n    }\r\n    else {\r\n        console.log(\"can't run animation over path without path or to/from xy\");\r\n        gm.endEvent(brEvent);\r\n    }\r\n    if (path.length <= 1) {\r\n        console.warn(\"skipping path animation with path <= 1\");\r\n        gm.endEvent(brEvent);\r\n        return;\r\n    }\r\n    // if (path.length == 0) {\r\n    //     console.warn(\"tried running animation OverPath event without a path\")\r\n    //     gm.endEvent(brEvent)\r\n    // }\r\n    let level = gm.getCurrentLevel();\r\n    path.forEach((xy, index, array) => {\r\n        setTimeout(() => {\r\n            if (index == path.length - 1) {\r\n                level.above.removeAt(path[index - 1]);\r\n                gm.displayAt(path[index - 1]);\r\n                gm.endEvent(brEvent);\r\n            }\r\n            else {\r\n                if (index > 0) {\r\n                    // remove old one\r\n                    level.above.removeAt(path[index - 1]);\r\n                    gm.displayAt(path[index - 1]);\r\n                }\r\n                level.above.removeAt(xy);\r\n                level.above.setAt(xy, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].aboveFactory(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].AboveType.Projectile, { code: brEvent.animationData.code, color: brEvent.animationData.color }));\r\n                gm.displayAt(xy);\r\n            }\r\n        }, (index * _brew__WEBPACK_IMPORTED_MODULE_0__[\"Config\"].animation_speed));\r\n    });\r\n}\r\nfunction runAnimation_Flash(gm, data) {\r\n    let to_xy = data.animationData.to_xy;\r\n    let level = gm.getCurrentLevel();\r\n    let hasExisting = level.above.hasAt(to_xy);\r\n    let existing_above;\r\n    let flash_color = data.animationData.color;\r\n    // show flash immediately\r\n    if (hasExisting) {\r\n        existing_above = level.above.getAt(to_xy);\r\n        level.above.removeAt(to_xy);\r\n    }\r\n    level.above.setAt(to_xy, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].aboveFactory(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].AboveType.Flash, { color: flash_color }));\r\n    gm.displayAt(to_xy);\r\n    // wait a bit then replace everything and end the event\r\n    setTimeout(() => {\r\n        level.above.removeAt(to_xy);\r\n        if (hasExisting) {\r\n            level.above.setAt(to_xy, existing_above);\r\n        }\r\n        gm.displayAt(to_xy);\r\n        gm.endEvent(data);\r\n    }, (1 * _brew__WEBPACK_IMPORTED_MODULE_0__[\"Config\"].animation_speed));\r\n}\r\nfunction runAnimation_Circle(gm, reverse, data) {\r\n    let level = gm.getCurrentLevel();\r\n    let xy_lst;\r\n    //center_xy: Brew.Coordinate, radius: number, flash_color : number[], \r\n    let center_xy = data.animationData.to_xy;\r\n    let radius = data.animationData.range;\r\n    let flash_color = data.animationData.color;\r\n    if (reverse) {\r\n        radius += 1;\r\n    }\r\n    let range_lst = [...Array(radius + 1).keys()]; // [0, 1, 2]\r\n    if (reverse) {\r\n        // range_lst = range_lst.sort((a, b) => { return range_lst[a] - range_lst[b] })\r\n        range_lst = range_lst.reverse();\r\n    }\r\n    // console.log(range_lst)\r\n    range_lst.forEach((r, index) => {\r\n        setTimeout(() => {\r\n            // console.log(\"triggered r = \", r)\r\n            if (index > 0) {\r\n                // clear previous circle\r\n                xy_lst = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].getCirclePoints(center_xy, r);\r\n                // xy_lst.forEach((xy, index, array) => {\r\n                xy_lst.forEach((xy, r, array) => {\r\n                    level.above.removeAt(xy);\r\n                });\r\n                gm.displayList(xy_lst);\r\n            }\r\n            if (index < range_lst.length - 1) {\r\n                // draw new circle\r\n                let last_r = reverse ? (r - 1) : (r + 1);\r\n                xy_lst = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].getCirclePoints(center_xy, last_r);\r\n                // xy_lst.forEach((xy, index, array) => {\r\n                xy_lst.forEach((xy) => {\r\n                    if (level.isValid(xy)) {\r\n                        level.above.removeAt(xy);\r\n                        level.above.setAt(xy, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].aboveFactory(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].AboveType.Flash, { color: flash_color }));\r\n                    }\r\n                });\r\n                gm.displayList(xy_lst);\r\n            }\r\n            if (index == range_lst.length - 1) {\r\n                gm.endEvent(data);\r\n            }\r\n        }, (index * _brew__WEBPACK_IMPORTED_MODULE_0__[\"Config\"].animation_speed));\r\n    });\r\n}\r\n// export function animateRocketPunch(gm: Brew.GameMaster, data: Brew.Enums.IBrewEvent) {\r\n//     let from_xy = data.targetingData.from_xy\r\n//     let to_xy = data.targetingData.to_xy\r\n//     let path = Utils.getLineBetweenPoints(from_xy, to_xy)\r\n//     path.splice(0, 1)\r\n//     let level = gm.getCurrentLevel()\r\n//     path.forEach((xy: Brew.Coordinate, index, array) => {\r\n//         setTimeout(() => {\r\n//             if (index == path.length - 1) {\r\n//                 level.above.removeAt(path[index-1])\r\n//                 // todo: need a way to block or knock items already there\r\n//                 // level.items.removeAt(path[index])\r\n//                 // level.items.setAt(path[index], item)\r\n//                 gm.displayAt(path[index-1])\r\n//                 // gm.displayAt(path[index])\r\n//                 gm.endEvent(data)\r\n//             } else {\r\n//                 if (index > 0) {\r\n//                     // remove old one\r\n//                     level.above.removeAt(path[index-1])\r\n//                     gm.displayAt(path[index-1])\r\n//                 } \r\n//                 level.above.removeAt(xy)\r\n//                 level.above.setAt(xy, Brew.Definitions.aboveFactory(Brew.Definitions.AboveType.Flash, {code: '@', color: Brew.Color.red} ))\r\n//                 gm.displayAt(xy)\r\n//             }\r\n//         },\r\n//         (index * Brew.Config.animation_speed)\r\n//         )\r\n//     })\r\n// }\r\nfunction createCircleAnimationEvent(predecessorEvent, circle_color, radius) {\r\n    return createCircleAnimation_Helper(predecessorEvent, false, circle_color, radius);\r\n}\r\nfunction createReverseCircleAnimationEvent(predecessorEvent, circle_color, radius) {\r\n    return createCircleAnimation_Helper(predecessorEvent, true, circle_color, radius);\r\n}\r\nfunction createCircleAnimation_Helper(predecessorEvent, reversed, circle_color, radius) {\r\n    let circleType;\r\n    if (reversed) {\r\n        circleType = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewAnimationType.CircleIn;\r\n    }\r\n    else {\r\n        circleType = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewAnimationType.CircleOut;\r\n    }\r\n    let animationEvent = {\r\n        eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.RunAnimation,\r\n        actor: predecessorEvent.actor,\r\n        playerInitiated: predecessorEvent.playerInitiated,\r\n        endsTurn: false,\r\n        animationData: {\r\n            animationType: circleType,\r\n            range: radius,\r\n            color: circle_color,\r\n            to_xy: predecessorEvent.actor.location.clone(),\r\n            from_xy: predecessorEvent.actor.location.clone()\r\n        }\r\n    };\r\n    return animationEvent;\r\n}\r\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvYnJld19nYW1lL2FuaW1hdGlvbnMudHM/NTlkZiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUErQjtBQUV6QiwyQkFBNEIsRUFBbUIsRUFBRSxPQUE4QjtJQUNqRix5RUFBeUU7SUFDekUsRUFBRSxDQUFDLENBQUMsT0FBTyxDQUFDLGFBQWEsQ0FBQyxhQUFhLElBQUksMkNBQVUsQ0FBQyxpQkFBaUIsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO1FBQzVFLGtCQUFrQixDQUFDLEVBQUUsRUFBRSxPQUFPLENBQUM7SUFDbkMsQ0FBQztJQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxPQUFPLENBQUMsYUFBYSxDQUFDLGFBQWEsSUFBSSwyQ0FBVSxDQUFDLGlCQUFpQixDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUM7UUFDdEYscUJBQXFCLENBQUMsRUFBRSxFQUFFLE9BQU8sQ0FBQztJQUN0QyxDQUFDO0lBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxhQUFhLENBQUMsYUFBYSxJQUFJLDJDQUFVLENBQUMsaUJBQWlCLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQztRQUN2RixtQkFBbUIsQ0FBQyxFQUFFLEVBQUUsS0FBSyxFQUFFLE9BQU8sQ0FBQztJQUMzQyxDQUFDO0lBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxhQUFhLENBQUMsYUFBYSxJQUFJLDJDQUFVLENBQUMsaUJBQWlCLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQztRQUN0RixtQkFBbUIsQ0FBQyxFQUFFLEVBQUUsSUFBSSxFQUFFLE9BQU8sQ0FBQztJQUUxQyxDQUFDO0lBQUMsSUFBSSxDQUFDLENBQUM7UUFDSixPQUFPLENBQUMsS0FBSyxDQUFDLDBCQUEwQixPQUFPLENBQUMsYUFBYSxDQUFDLGFBQWEsRUFBRSxDQUFDO0lBQ2xGLENBQUM7QUFFTCxDQUFDO0FBRUssK0JBQWdDLEVBQW1CLEVB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QUFnQixDQUFDLGVBQWU7UUFDakQsUUFBUSxFQUFFLEtBQUs7UUFDZixhQUFhLEVBQUU7WUFDWCxhQUFhLEVBQUUsVUFBVTtZQUN6QixLQUFLLEVBQUUsTUFBTTtZQUNiLEtBQUssRUFBRSxZQUFZO1lBQ25CLEtBQUssRUFBRSxnQkFBZ0IsQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLEtBQUssRUFBRTtZQUM5QyxPQUFPLEVBQUUsZ0JBQWdCLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxLQUFLLEVBQUU7U0FDbkQ7S0FDSjtJQUNELE1BQU0sQ0FBQyxjQUFjO0FBQ3pCLENBQUMiLCJmaWxlIjoiLi9zcmMvYnJld19nYW1lL2FuaW1hdGlvbnMudHMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBCcmV3IGZyb20gXCIuLi9icmV3XCJcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBydW5BbmltYXRpb25FdmVudChnbTogQnJldy5HYW1lTWFzdGVyLCBickV2ZW50OiBCcmV3LkVudW1zLklCcmV3RXZlbnQpIHsgXHJcbiAgICAvLyBjb25zb2xlLmxvZyhcInJ1bm5pbmcgYW5pbWF0aW9uIFwiLCBickV2ZW50LmFuaW1hdGlvbkRhdGEuYW5pbWF0aW9uVHlwZSlcclxuICAgIGlmIChickV2ZW50LmFuaW1hdGlvbkRhdGEuYW5pbWF0aW9uVHlwZSA9PSBCcmV3LkVudW1zLkJyZXdBbmltYXRpb25UeXBlLkZsYXNoKSB7XHJcbiAgICAgICAgcnVuQW5pbWF0aW9uX0ZsYXNoKGdtLCBickV2ZW50KVxyXG4gICAgfSBlbHNlIGlmIChickV2ZW50LmFuaW1hdGlvbkRhdGEuYW5pbWF0aW9uVHlwZSA9PSBCcmV3LkVudW1zLkJyZXdBbmltYXRpb25UeXBlLk92ZXJQYXRoKSB7XHJcbiAgICAgICAgcnVuQW5pbWF0aW9uX092ZXJQYXRoKGdtLCBickV2ZW50KVxyXG4gICAgfSBlbHNlIGlmIChickV2ZW50LmFuaW1hdGlvbkRhdGEuYW5pbWF0aW9uVHlwZSA9PSBCcmV3LkVudW1zLkJyZXdBbmltYXRpb25UeXBlLkNpcmNsZU91dCkge1xyXG4gICAgICAgIHJ1bkFuaW1hdGlvbl9DaXJjbGUoZ20sIGZhbHNlLCBickV2ZW50KVxyXG4gICAgfSBlbHNlIGlmIChickV2ZW50LmFuaW1hdGlvbkRhdGEuYW5pbWF0aW9uVHlwZSA9PSBCcmV3LkVudW1zLkJyZXdBbmltYXRpb25UeXBlLkNpcmNsZUluKSB7XHJcbiAgICAgICAgcnVuQW5pbWF0aW9uX0NpcmNsZShnbSwgdHJ1ZSwgYnJFdmVudClcclxuXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoYHVua25vd24gYW5pbWF0aW9uIHR5cGUgJHtickV2ZW50LmFuaW1hdGlvbkRhdGEuYW5pbWF0aW9uVHlwZX1gKVxyXG4gICAgfVxyXG5cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHJ1bkFuaW1hdGlvbl9PdmVyUGF0aChnbTogQnJldy5HYW1lTWFzdGVyLCBickV2ZW50OiBCcmV3LkVudW1zLklCcmV3RXZlbnQpIHtcclxuICAgIGxldCBwYXRoIDogQXJyYXk8QnJldy5Db29yZGluYXRlPlxyXG5cclxuICAgIGlmIChickV2ZW50LmFuaW1hdGlvbkRhdGEucGF0aCkge1xyXG4gICAgICAgIHBhdGggPSBickV2ZW50LmFuaW1hdGlvbkRhdGEucGF0aFxyXG4gICAgICAgIC8vIHBhdGguc3BsaWNlKHBhdGgubGVuZ3RoLTEsMSlcclxuICAgIH0gZWxzZSBpZiAoKGJyRXZlbnQuYW5pbWF0aW9uRGF0YS5mcm9tX3h5KSAmJiAoYnJFdmVudC5hbmltYXRpb25EYXRhLnRvX3h5KSkge1xyXG4gICAgICAgIGxldCB0b194eSA6IEJyZXcuQ29vcmRpbmF0ZSA9IGJyRXZlbnQuYW5pbWF0aW9uRGF0YS50b194eVxyXG4gICAgICAgIGxldCBmcm9tX3h5IDogQnJldy5Db29yZGluYXRlID0gYnJFdmVudC5hbmltYXRpb25EYXRhLmZyb21feHlcclxuICAgICAgICBwYXRoID0gQnJldy5VdGlscy5nZXRMaW5lQmV0d2VlblBvaW50cyhmcm9tX3h5LCB0b194eSlcclxuICAgICAgICAvLyBwYXRoLnNwbGljZSgwLCAxKVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcImNhbid0IHJ1biBhbmltYXRpb24gb3ZlciBwYXRoIHdpdGhvdXQgcGF0aCBvciB0by9mcm9tIHh5XCIpXHJcbiAgICAgICAgZ20uZW5kRXZlbnQoYnJFdmVudClcclxuICAgIH1cclxuXHJcbiAgICBpZiAocGF0aC5sZW5ndGggPD0gMSkge1xyXG4gICAgICAgIGNvbnNvbGUud2FybihcInNraXBwaW5nIHBhdGggYW5pbWF0aW9uIHdpdGggcGF0aCA8PSAxXCIpXHJcbiAgICAgICAgZ20uZW5kRXZlbnQoYnJFdmVudClcclxuICAgICAgICByZXR1cm5cclxuICAgIH1cclxuICAgIC8vIGlmIChwYXRoLmxlbmd0aCA9PSAwKSB7XHJcbiAgICAvLyAgICAgY29uc29sZS53YXJuKFwidHJpZWQgcnVubmluZyBhbmltYXRpb24gT3ZlclBhdGggZXZlbnQgd2l0aG91dCBhIHBhdGhcIilcclxuICAgIC8vICAgICBnbS5lbmRFdmVudChickV2ZW50KVxyXG4gICAgLy8gfVxyXG4gICAgbGV0IGxldmVsID0gZ20uZ2V0Q3VycmVudExldmVsKClcclxuICAgIFxyXG4gICAgcGF0aC5mb3JFYWNoKCh4eTogQnJldy5Db29yZGluYXRlLCBpbmRleCwgYXJyYXkpID0+IHtcclxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgaWYgKGluZGV4ID09IHBhdGgubGVuZ3RoIC0gMSkge1xyXG4gICAgICAgICAgICAgICAgbGV2ZWwuYWJvdmUucmVtb3ZlQXQocGF0aFtpbmRleC0xXSlcclxuICAgICAgICAgICAgICAgIGdtLmRpc3BsYXlBdChwYXRoW2luZGV4LTFdKVxyXG4gICAgICAgICAgICAgICAgZ20uZW5kRXZlbnQoYnJFdmVudClcclxuXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaW5kZXggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gcmVtb3ZlIG9sZCBvbmVcclxuICAgICAgICAgICAgICAgICAgICBsZXZlbC5hYm92ZS5yZW1vdmVBdChwYXRoW2luZGV4LTFdKVxyXG4gICAgICAgICAgICAgICAgICAgIGdtLmRpc3BsYXlBdChwYXRoW2luZGV4LTFdKVxyXG4gICAgICAgICAgICAgICAgfSBcclxuICAgICAgICAgICAgICAgIGxldmVsLmFib3ZlLnJlbW92ZUF0KHh5KVxyXG4gICAgICAgICAgICAgICAgbGV2ZWwuYWJvdmUuc2V0QXQoeHksIEJyZXcuRGVmaW5pdGlvbnMuYWJvdmVGYWN0b3J5KEJyZXcuRGVmaW5pdGlvbnMuQWJvdmVUeXBlLlByb2plY3RpbGUsIHtjb2RlOiBickV2ZW50LmFuaW1hdGlvbkRhdGEuY29kZSwgY29sb3I6IGJyRXZlbnQuYW5pbWF0aW9uRGF0YS5jb2xvcn0pKVxyXG4gICAgICAgICAgICAgICAgZ20uZGlzcGxheUF0KHh5KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICAoaW5kZXggKiBCcmV3LkNvbmZpZy5hbmltYXRpb25fc3BlZWQpXHJcbiAgICAgICAgKVxyXG4gICAgfSlcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHJ1bkFuaW1hdGlvbl9GbGFzaChnbTogQnJldy5HYW1lTWFzdGVyLCBkYXRhOiBCcmV3LkVudW1zLklCcmV3RXZlbnQpIHtcclxuICAgIGxldCB0b194eSA6IEJyZXcuQ29vcmRpbmF0ZSA9IGRhdGEuYW5pbWF0aW9uRGF0YS50b194eVxyXG4gICAgXHJcbiAgICBsZXQgbGV2ZWwgPSBnbS5nZXRDdXJyZW50TGV2ZWwoKVxyXG4gICAgbGV0IGhhc0V4aXN0aW5nID0gbGV2ZWwuYWJvdmUuaGFzQXQodG9feHkpXHJcbiAgICBsZXQgZXhpc3RpbmdfYWJvdmUgOiBCcmV3LkdyaWRUaGluZ3MuQWJvdmVcclxuICAgIGxldCBmbGFzaF9jb2xvciA9IGRhdGEuYW5pbWF0aW9uRGF0YS5jb2xvclxyXG5cclxuICAgIC8vIHNob3cgZmxhc2ggaW1tZWRpYXRlbHlcclxuICAgIGlmIChoYXNFeGlzdGluZykge1xyXG4gICAgICAgIGV4aXN0aW5nX2Fib3ZlID0gbGV2ZWwuYWJvdmUuZ2V0QXQodG9feHkpXHJcbiAgICAgICAgbGV2ZWwuYWJvdmUucmVtb3ZlQXQodG9feHkpXHJcbiAgICB9XHJcblxyXG4gICAgbGV2ZWwuYWJvdmUuc2V0QXQodG9feHksIEJyZXcuRGVmaW5pdGlvbnMuYWJvdmVGYWN0b3J5KEJyZXcuRGVmaW5pdGlvbnMuQWJvdmVUeXBlLkZsYXNoLCB7Y29sb3I6IGZsYXNoX2NvbG9yIH0gKSlcclxuICAgIGdtLmRpc3BsYXlBdCh0b194eSlcclxuXHJcbiAgICAvLyB3YWl0IGEgYml0IHRoZW4gcmVwbGFjZSBldmVyeXRoaW5nIGFuZCBlbmQgdGhlIGV2ZW50XHJcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICBsZXZlbC5hYm92ZS5yZW1vdmVBdCh0b194eSlcclxuICAgICAgICBpZiAoaGFzRXhpc3RpbmcpIHtcclxuICAgICAgICAgICAgbGV2ZWwuYWJvdmUuc2V0QXQodG9feHksIGV4aXN0aW5nX2Fib3ZlKVxyXG4gICAgICAgIH1cclxuICAgICAgICBnbS5kaXNwbGF5QXQodG9feHkpXHJcbiAgICAgICAgZ20uZW5kRXZlbnQoZGF0YSlcclxuICAgIH0sXHJcbiAgICAoMSAqIEJyZXcuQ29uZmlnLmFuaW1hdGlvbl9zcGVlZClcclxuICAgIClcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHJ1bkFuaW1hdGlvbl9DaXJjbGUoZ206IEJyZXcuR2FtZU1hc3RlciwgcmV2ZXJzZTogYm9vbGVhbiwgZGF0YTogQnJldy5FbnVtcy5JQnJld0V2ZW50KSB7XHJcbiAgICBsZXQgbGV2ZWwgPSBnbS5nZXRDdXJyZW50TGV2ZWwoKVxyXG4gICAgbGV0IHh5X2xzdCA6IEJyZXcuQ29vcmRpbmF0ZVtdXHJcbiAgICBcclxuICAgIC8vY2VudGVyX3h5OiBCcmV3LkNvb3JkaW5hdGUsIHJhZGl1czogbnVtYmVyLCBmbGFzaF9jb2xvciA6IG51bWJlcltdLCBcclxuICAgIGxldCBjZW50ZXJfeHkgPSBkYXRhLmFuaW1hdGlvbkRhdGEudG9feHlcclxuICAgIGxldCByYWRpdXMgPSBkYXRhLmFuaW1hdGlvbkRhdGEucmFuZ2VcclxuICAgIGxldCBmbGFzaF9jb2xvciA9IGRhdGEuYW5pbWF0aW9uRGF0YS5jb2xvclxyXG4gICAgaWYgKHJldmVyc2UpIHsgXHJcbiAgICAgICAgcmFkaXVzICs9IDFcclxuICAgIH1cclxuICAgIGxldCByYW5nZV9sc3QgPSBbLi4uQXJyYXkocmFkaXVzKzEpLmtleXMoKV0gLy8gWzAsIDEsIDJdXHJcbiAgICBpZiAocmV2ZXJzZSkge1xyXG4gICAgICAgIC8vIHJhbmdlX2xzdCA9IHJhbmdlX2xzdC5zb3J0KChhLCBiKSA9PiB7IHJldHVybiByYW5nZV9sc3RbYV0gLSByYW5nZV9sc3RbYl0gfSlcclxuICAgICAgICByYW5nZV9sc3QgPSByYW5nZV9sc3QucmV2ZXJzZSgpXHJcbiAgICB9XHJcbiAgICAvLyBjb25zb2xlLmxvZyhyYW5nZV9sc3QpXHJcblxyXG4gICAgcmFuZ2VfbHN0LmZvckVhY2goKHIsIGluZGV4KSA9PiB7XHJcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwidHJpZ2dlcmVkIHIgPSBcIiwgcilcclxuICAgICAgICAgICAgaWYgKGluZGV4ID4gMCkge1xyXG4gICAgICAgICAgICAgICAgLy8gY2xlYXIgcHJldmlvdXMgY2lyY2xlXHJcbiAgICAgICAgICAgICAgICB4eV9sc3QgPSBCcmV3LlV0aWxzLmdldENpcmNsZVBvaW50cyhjZW50ZXJfeHksIHIpXHJcbiAgICAgICAgICAgICAgICAvLyB4eV9sc3QuZm9yRWFjaCgoeHksIGluZGV4LCBhcnJheSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHh5X2xzdC5mb3JFYWNoKCh4eSwgciwgYXJyYXkpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBsZXZlbC5hYm92ZS5yZW1vdmVBdCh4eSlcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICBnbS5kaXNwbGF5TGlzdCh4eV9sc3QpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChpbmRleCA8IHJhbmdlX2xzdC5sZW5ndGggLSAxKSB7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIC8vIGRyYXcgbmV3IGNpcmNsZVxyXG4gICAgICAgICAgICAgICAgbGV0IGxhc3RfciA9IHJldmVyc2UgPyAociAtIDEpIDogKHIgKyAxKVxyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICB4eV9sc3QgPSBCcmV3LlV0aWxzLmdldENpcmNsZVBvaW50cyhjZW50ZXJfeHksIGxhc3RfcilcclxuICAgICAgICAgICAgICAgIC8vIHh5X2xzdC5mb3JFYWNoKCh4eSwgaW5kZXgsIGFycmF5KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgeHlfbHN0LmZvckVhY2goKHh5KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGxldmVsLmlzVmFsaWQoeHkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldmVsLmFib3ZlLnJlbW92ZUF0KHh5KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXZlbC5hYm92ZS5zZXRBdCh4eSwgQnJldy5EZWZpbml0aW9ucy5hYm92ZUZhY3RvcnkoQnJldy5EZWZpbml0aW9ucy5BYm92ZVR5cGUuRmxhc2gsIHsgY29sb3I6IGZsYXNoX2NvbG9yIH0pKVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICBnbS5kaXNwbGF5TGlzdCh4eV9sc3QpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChpbmRleCA9PSByYW5nZV9sc3QubGVuZ3RoIC0gMSkge1xyXG4gICAgICAgICAgICAgICAgZ20uZW5kRXZlbnQoZGF0YSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgKGluZGV4ICogQnJldy5Db25maWcuYW5pbWF0aW9uX3NwZWVkKVxyXG4gICAgICAgIClcclxuICAgIH0pXHJcbn1cclxuXHJcbi8vIGV4cG9ydCBmdW5jdGlvbiBhbmltYXRlUm9ja2V0UHVuY2goZ206IEJyZXcuR2FtZU1hc3RlciwgZGF0YTogQnJldy5FbnVtcy5JQnJld0V2ZW50KSB7XHJcbi8vICAgICBsZXQgZnJvbV94eSA9IGRhdGEudGFyZ2V0aW5nRGF0YS5mcm9tX3h5XHJcbi8vICAgICBsZXQgdG9feHkgPSBkYXRhLnRhcmdldGluZ0RhdGEudG9feHlcclxuXHJcbi8vICAgICBsZXQgcGF0aCA9IFV0aWxzLmdldExpbmVCZXR3ZWVuUG9pbnRzKGZyb21feHksIHRvX3h5KVxyXG4vLyAgICAgcGF0aC5zcGxpY2UoMCwgMSlcclxuLy8gICAgIGxldCBsZXZlbCA9IGdtLmdldEN1cnJlbnRMZXZlbCgpXHJcbiAgICBcclxuLy8gICAgIHBhdGguZm9yRWFjaCgoeHk6IEJyZXcuQ29vcmRpbmF0ZSwgaW5kZXgsIGFycmF5KSA9PiB7XHJcbi8vICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbi8vICAgICAgICAgICAgIGlmIChpbmRleCA9PSBwYXRoLmxlbmd0aCAtIDEpIHtcclxuLy8gICAgICAgICAgICAgICAgIGxldmVsLmFib3ZlLnJlbW92ZUF0KHBhdGhbaW5kZXgtMV0pXHJcbi8vICAgICAgICAgICAgICAgICAvLyB0b2RvOiBuZWVkIGEgd2F5IHRvIGJsb2NrIG9yIGtub2NrIGl0ZW1zIGFscmVhZHkgdGhlcmVcclxuLy8gICAgICAgICAgICAgICAgIC8vIGxldmVsLml0ZW1zLnJlbW92ZUF0KHBhdGhbaW5kZXhdKVxyXG4vLyAgICAgICAgICAgICAgICAgLy8gbGV2ZWwuaXRlbXMuc2V0QXQocGF0aFtpbmRleF0sIGl0ZW0pXHJcblxyXG4vLyAgICAgICAgICAgICAgICAgZ20uZGlzcGxheUF0KHBhdGhbaW5kZXgtMV0pXHJcbi8vICAgICAgICAgICAgICAgICAvLyBnbS5kaXNwbGF5QXQocGF0aFtpbmRleF0pXHJcbi8vICAgICAgICAgICAgICAgICBnbS5lbmRFdmVudChkYXRhKVxyXG5cclxuLy8gICAgICAgICAgICAgfSBlbHNlIHtcclxuLy8gICAgICAgICAgICAgICAgIGlmIChpbmRleCA+IDApIHtcclxuLy8gICAgICAgICAgICAgICAgICAgICAvLyByZW1vdmUgb2xkIG9uZVxyXG4vLyAgICAgICAgICAgICAgICAgICAgIGxldmVsLmFib3ZlLnJlbW92ZUF0KHBhdGhbaW5kZXgtMV0pXHJcbi8vICAgICAgICAgICAgICAgICAgICAgZ20uZGlzcGxheUF0KHBhdGhbaW5kZXgtMV0pXHJcbi8vICAgICAgICAgICAgICAgICB9IFxyXG4vLyAgICAgICAgICAgICAgICAgbGV2ZWwuYWJvdmUucmVtb3ZlQXQoeHkpXHJcbi8vICAgICAgICAgICAgICAgICBsZXZlbC5hYm92ZS5zZXRBdCh4eSwgQnJldy5EZWZpbml0aW9ucy5hYm92ZUZhY3RvcnkoQnJldy5EZWZpbml0aW9ucy5BYm92ZVR5cGUuRmxhc2gsIHtjb2RlOiAnQCcsIGNvbG9yOiBCcmV3LkNvbG9yLnJlZH0gKSlcclxuLy8gICAgICAgICAgICAgICAgIGdtLmRpc3BsYXlBdCh4eSlcclxuLy8gICAgICAgICAgICAgfVxyXG4vLyAgICAgICAgIH0sXHJcbi8vICAgICAgICAgKGluZGV4ICogQnJldy5Db25maWcuYW5pbWF0aW9uX3NwZWVkKVxyXG4vLyAgICAgICAgIClcclxuLy8gICAgIH0pXHJcbi8vIH1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVDaXJjbGVBbmltYXRpb25FdmVudChwcmVkZWNlc3NvckV2ZW50OiBCcmV3LkVudW1zLklCcmV3RXZlbnQsIGNpcmNsZV9jb2xvcjogbnVtYmVyW10sIHJhZGl1czogbnVtYmVyKSA6IEJyZXcuRW51bXMuSUJyZXdFdmVudCB7XHJcbiAgICByZXR1cm4gY3JlYXRlQ2lyY2xlQW5pbWF0aW9uX0hlbHBlcihwcmVkZWNlc3NvckV2ZW50LCBmYWxzZSwgY2lyY2xlX2NvbG9yLCByYWRpdXMpXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVSZXZlcnNlQ2lyY2xlQW5pbWF0aW9uRXZlbnQocHJlZGVjZXNzb3JFdmVudDogQnJldy5FbnVtcy5JQnJld0V2ZW50LCBjaXJjbGVfY29sb3I6IG51bWJlcltdLCByYWRpdXM6IG51bWJlcikgOiBCcmV3LkVudW1zLklCcmV3RXZlbnQge1xyXG4gICAgcmV0dXJuIGNyZWF0ZUNpcmNsZUFuaW1hdGlvbl9IZWxwZXIocHJlZGVjZXNzb3JFdmVudCwgdHJ1ZSwgY2lyY2xlX2NvbG9yLCByYWRpdXMpXHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNyZWF0ZUNpcmNsZUFuaW1hdGlvbl9IZWxwZXIocHJlZGVjZXNzb3JFdmVudDogQnJldy5FbnVtcy5JQnJld0V2ZW50LCByZXZlcnNlZDogYm9vbGVhbiwgY2lyY2xlX2NvbG9yOiBudW1iZXJbXSwgcmFkaXVzOiBudW1iZXIpIDogQnJldy5FbnVtcy5JQnJld0V2ZW50IHtcclxuICAgIGxldCBjaXJjbGVUeXBlIDogQnJldy5FbnVtcy5CcmV3QW5pbWF0aW9uVHlwZVxyXG5cclxuICAgIGlmIChyZXZlcnNlZCkge1xyXG4gICAgICAgIGNpcmNsZVR5cGUgPSBCcmV3LkVudW1zLkJyZXdBbmltYXRpb25UeXBlLkNpcmNsZUluXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGNpcmNsZVR5cGUgPSBCcmV3LkVudW1zLkJyZXdBbmltYXRpb25UeXBlLkNpcmNsZU91dFxyXG4gICAgfVxyXG5cclxuICAgIGxldCBhbmltYXRpb25FdmVudCA6IEJyZXcuRW51bXMuSUJyZXdFdmVudCA9IHtcclxuICAgICAgICBldmVudFR5cGU6IEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5SdW5BbmltYXRpb24sXHJcbiAgICAgICAgYWN0b3I6IHByZWRlY2Vzc29yRXZlbnQuYWN0b3IsXHJcbiAgICAgICAgcGxheWVySW5pdGlhdGVkOiBwcmVkZWNlc3NvckV2ZW50LnBsYXllckluaXRpYXRlZCxcclxuICAgICAgICBlbmRzVHVybjogZmFsc2UsXHJcbiAgICAgICAgYW5pbWF0aW9uRGF0YToge1xyXG4gICAgICAgICAgICBhbmltYXRpb25UeXBlOiBjaXJjbGVUeXBlLFxyXG4gICAgICAgICAgICByYW5nZTogcmFkaXVzLFxyXG4gICAgICAgICAgICBjb2xvcjogY2lyY2xlX2NvbG9yLFxyXG4gICAgICAgICAgICB0b194eTogcHJlZGVjZXNzb3JFdmVudC5hY3Rvci5sb2NhdGlvbi5jbG9uZSgpLFxyXG4gICAgICAgICAgICBmcm9tX3h5OiBwcmVkZWNlc3NvckV2ZW50LmFjdG9yLmxvY2F0aW9uLmNsb25lKClcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gYW5pbWF0aW9uRXZlbnRcclxufVxyXG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/brew_game/animations.ts\n");

/***/ }),

/***/ "./src/brew_game/combat.ts":
/*!*********************************!*\
  !*** ./src/brew_game/combat.ts ***!
  \*********************************/
/*! exports provided: killMonster, triggerKnockbackBlast, calcDamage, applyDamage, possiblyConvertAttackToSmashAttack, attack, checkForWallSmash, smash_attack, applyMassDamage, filterDamageEffects */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"killMonster\", function() { return killMonster; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"triggerKnockbackBlast\", function() { return triggerKnockbackBlast; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"calcDamage\", function() { return calcDamage; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"applyDamage\", function() { return applyDamage; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"possiblyConvertAttackToSmashAttack\", function() { return possiblyConvertAttackToSmashAttack; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"attack\", function() { return attack; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"checkForWallSmash\", function() { return checkForWallSmash; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"smash_attack\", function() { return smash_attack; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"applyMassDamage\", function() { return applyMassDamage; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"filterDamageEffects\", function() { return filterDamageEffects; });\n/* harmony import */ var _brew__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../brew */ \"./src/brew.ts\");\n\r\nfunction killMonster(gm, victim) {\r\n    let level = gm.getCurrentLevel();\r\n    let xy = victim.location.clone();\r\n    level.monsters.removeAt(xy);\r\n    gm.displayAt(xy);\r\n    gm.removeActorFromScheduler(victim);\r\n    // todo: animate parts/blood spray\r\n    // let surrounding_xy_list = xy.getAdjacent()\r\n    let nearby_xy;\r\n    let item_at;\r\n    // todo: randomize/configurize # of parts\r\n    // for (let i = 0; i < 4; i++) {\r\n    //     let random_angle = Math.floor(Math.random()*2*Math.PI)\r\n    //     let random_distance = Brew.Utils.getRandomInt(1, 3)\r\n    //     let offset_xy = Brew.Utils.getPolarOffsetCoordinate(random_angle, random_distance)\r\n    //     nearby_xy = xy.add(offset_xy)\r\n    //     // nearby_xy = randomOf(surrounding_xy_list)\r\n    //     if (!(level.isValid(nearby_xy))) {\r\n    //         continue\r\n    //     }\r\n    //     if (level.terrain.getAt(nearby_xy).blocks_flying) {\r\n    //         continue\r\n    //     }\r\n    //     item_at = level.items.getAt(nearby_xy)\r\n    //     if (item_at) {\r\n    //         continue\r\n    //     }\r\n    //     level.features.setAt(nearby_xy, Brew.Definitions.featureFactory(Brew.Definitions.FeatureType.Scrap))\r\n    //     gm.displayAt(nearby_xy)\r\n    // }        \r\n    // level.features.setAt(xy, Brew.Definitions.featureFactory(Definitions.FeatureType.RepairGoo))\r\n    // leave corpses for all HP > 1\r\n    // if (victim.hp.getMaxLevel() > 1) {\r\n    //     let corpse_xy : Brew.Coordinate\r\n    //     item_at = level.items.getAt(xy)\r\n    //     if (item_at) {\r\n    //         let nearby_xy = level.getSafeLocationNear(xy, true)\r\n    //         level.items.removeAt(xy)\r\n    //         level.items.setAt(nearby_xy, item_at)\r\n    //         gm.displayAt(nearby_xy)\r\n    //     }\r\n    //     level.items.setAt(xy, Brew.Definitions.itemFactory(Brew.Definitions.ItemType.Wreckage))\r\n    //     gm.displayAt(xy)\r\n    // }\r\n    let didTrigger = triggerOnDeath(gm, victim);\r\n}\r\nfunction triggerOnDeath(gm, victim) {\r\n    let num_events = 0;\r\n    if (victim.hasFlag(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].Flag.OnDeathKnockback)) {\r\n        num_events += triggerKnockbackBlast(gm, victim.location.clone(), 10, [victim]); // todo: config blast radius\r\n    }\r\n    return (num_events > 0);\r\n}\r\nfunction triggerKnockbackBlast(gm, origin_xy, magnitude, excluded_mobs = []) {\r\n    let num_events = 0;\r\n    let level = gm.getCurrentLevel();\r\n    let dist;\r\n    // figure out which targets are affected by the blast\r\n    // also build a distance map so we dont have to recalc everything again\r\n    let area = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].getBlastArea(level, origin_xy, magnitude);\r\n    area.removeCoordinate(origin_xy);\r\n    let affected_mobs = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].getMonstersWithinCoordinateArea(level, area);\r\n    affected_mobs.sort((mob_a, mob_b) => {\r\n        return _brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].dist2d(origin_xy, mob_b.location) - _brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].dist2d(origin_xy, mob_a.location);\r\n    });\r\n    // console.log(affected_mobs)\r\n    let trigger_actor = level.monsters.getAt(origin_xy);\r\n    if (!(trigger_actor)) {\r\n        trigger_actor = gm.getArchitect();\r\n    }\r\n    let kdist;\r\n    let knockbackEvent;\r\n    affected_mobs.forEach((mob) => {\r\n        kdist = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Movement\"].calculateKnockbackDistance(gm, origin_xy, magnitude, mob);\r\n        knockbackEvent = {\r\n            eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.Knockback,\r\n            actor: trigger_actor,\r\n            playerInitiated: false,\r\n            endsTurn: false,\r\n            knockbackData: {\r\n                magnitude: magnitude,\r\n                origin_xy: origin_xy,\r\n                target: mob\r\n            }\r\n        };\r\n        gm.insertEvent(knockbackEvent);\r\n        num_events += 1;\r\n    });\r\n    gm.insertEvent({\r\n        eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.RunAnimation,\r\n        actor: trigger_actor,\r\n        playerInitiated: false,\r\n        endsTurn: false,\r\n        animationData: {\r\n            animationType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewAnimationType.CircleOut,\r\n            color: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].color_force,\r\n            from_xy: origin_xy,\r\n            to_xy: origin_xy,\r\n            range: magnitude\r\n        }\r\n    });\r\n    return num_events;\r\n}\r\nfunction calcDamage(gm, attacker, victim, damage) {\r\n    // see how much damage victim can absorb\r\n    // let shield_strength = 0\r\n    // let shield : Brew.Power = victim.getPowers().getPowerOfType(BrewPowerType.Shield)\r\n    // if ((shield) && (shield.currentCharge > 0)) {\r\n    //     shield_strength = shield.currentCharge\r\n    // }\r\n    let shield_strength = 0;\r\n    if (victim) {\r\n        shield_strength = victim.shields.getCurrentLevel();\r\n    }\r\n    let hp_damage;\r\n    let shield_damage;\r\n    let is_fatal = false;\r\n    if (shield_strength >= damage) {\r\n        hp_damage = 0;\r\n        shield_damage = damage;\r\n        if ((shield_strength == shield_damage) && (victim.isSameThing(gm.getPlayer()))) {\r\n            // if we just lost our shield, recolor\r\n            victim.color = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].hero_blue;\r\n        }\r\n    }\r\n    else if ((victim) && (victim.hasFlag(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].Flag.Invulnerable))) {\r\n        hp_damage = 0;\r\n    }\r\n    else {\r\n        hp_damage = damage - shield_strength;\r\n        shield_damage = shield_strength;\r\n        if (victim) {\r\n            is_fatal = ((victim.hp.getCurrentLevel() - hp_damage) <= 0);\r\n        }\r\n        else {\r\n            is_fatal = false;\r\n        }\r\n    }\r\n    // if target is already WEAK, every attack with damage over 1 is fatal\r\n    if (victim) {\r\n        let is_weakened = victim.hasFlag(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].Flag.Weak);\r\n        if (is_weakened && (hp_damage > 0)) {\r\n            is_fatal = true;\r\n        }\r\n    }\r\n    return {\r\n        target: victim,\r\n        damageToHP: hp_damage,\r\n        damageToShields: shield_damage,\r\n        shieldUsed: null,\r\n        isFatal: is_fatal\r\n    };\r\n}\r\nfunction applyDamage(gm, data) {\r\n    let victim = data.damageData.target;\r\n    // console.log(\"applying damage\")\r\n    let calc_damage = data.damageData;\r\n    if (victim) {\r\n        // apply damage\r\n        if (calc_damage.damageToShields > 0) {\r\n            victim.shields.decrement(calc_damage.damageToShields);\r\n        }\r\n        if (calc_damage.damageToHP > 0) {\r\n            victim.hp.decrement(calc_damage.damageToHP);\r\n        }\r\n        let flash_color;\r\n        if (data.damageData.damageToShields > data.damageData.damageToHP) {\r\n            flash_color = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].power_shield;\r\n        }\r\n        else {\r\n            flash_color = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].damage_flash;\r\n        }\r\n        let animationEvent = {\r\n            eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.RunAnimation,\r\n            actor: data.actor,\r\n            endsTurn: false,\r\n            playerInitiated: true,\r\n            animationData: {\r\n                animationType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewAnimationType.Flash,\r\n                from_xy: null,\r\n                to_xy: data.damageData.target.location,\r\n                color: flash_color\r\n            }\r\n        };\r\n        gm.insertEvent(animationEvent);\r\n    }\r\n    if ((victim) && (calc_damage.isFatal) && (victim.isSameThing(gm.getPlayer()))) {\r\n        let fatalEvent = {\r\n            eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.PlayerDeath,\r\n            actor: data.actor,\r\n            playerInitiated: false,\r\n            endsTurn: true\r\n        };\r\n        // data.endsTurn = false\r\n        gm.insertEvent(fatalEvent);\r\n        gm.endEvent(data);\r\n    }\r\n    else {\r\n        if ((victim) && (calc_damage.isFatal)) {\r\n            // someone else died\r\n            killMonster(gm, victim);\r\n        }\r\n        if (data.damageData.effects) {\r\n            if (victim) {\r\n                applyCombatEffects(gm, data.actor, victim, data.damageData.effects);\r\n            }\r\n            else {\r\n                applyCombatEffects(gm, data.actor, null, data.damageData.effects, data.attackData.to_xy);\r\n            }\r\n        }\r\n        gm.endEvent(data);\r\n    }\r\n}\r\nfunction applyCombatEffects(gm, attacker, victim, effects, nonvictim_target_xy) {\r\n    if (victim) {\r\n        if (effects.indexOf(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].Flag.CausesStun) > -1) {\r\n            gm.timer_monitor.setFlagWithTimer(gm, victim, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].Flag.Stunned, 5);\r\n            gm.displayAt(victim.location);\r\n        }\r\n        if (effects.indexOf(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].Flag.CausesWeak) > -1) {\r\n            gm.timer_monitor.setFlagWithTimer(gm, victim, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].Flag.Weak, 5);\r\n            gm.displayAt(victim.location);\r\n        }\r\n        if (effects.indexOf(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].Flag.CausesInvulnerable) > -1) {\r\n            gm.timer_monitor.setFlagWithTimer(gm, victim, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].Flag.Invulnerable, 5);\r\n            gm.displayAt(victim.location);\r\n        }\r\n    }\r\n    if (effects.indexOf(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].Flag.CausesExplosion) > -1) {\r\n        // let explosion_damage = 2\r\n        let fake_grenade = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].itemFactory(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].ItemType.Grenade, { damage: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Config\"].explosion_damage });\r\n        fake_grenade.subtype = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].ItemSubtype.G_Explosive;\r\n        let target_xy;\r\n        if (victim) {\r\n            target_xy = victim.location.clone();\r\n        }\r\n        else if (nonvictim_target_xy) {\r\n            target_xy = nonvictim_target_xy;\r\n        }\r\n        else {\r\n            throw new Error(\"missing target coord for non-victim explosion\");\r\n        }\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"ItemInteraction\"].triggerGrenade(gm, fake_grenade, target_xy);\r\n    }\r\n    if (effects.indexOf(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].Flag.CausesKnockback) > -1) {\r\n        let magnitude = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Movement\"].calculateKnockbackDistance(gm, attacker.location, 10, victim);\r\n        let knockbackEvent = {\r\n            eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.Knockback,\r\n            actor: attacker,\r\n            playerInitiated: false,\r\n            endsTurn: false,\r\n            knockbackData: {\r\n                magnitude: magnitude,\r\n                origin_xy: attacker.location.clone(),\r\n                target: victim\r\n            }\r\n        };\r\n        gm.insertEvent(knockbackEvent);\r\n    }\r\n}\r\nfunction possiblyConvertAttackToSmashAttack(gm, attackEvent) {\r\n    if (!(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Intel\"].isPlayer(gm, attackEvent.actor))) {\r\n        // only player can wall smash (for now?)\r\n        return attackEvent;\r\n    }\r\n    let wallsmash_response = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Combat\"].checkForWallSmash(gm, attackEvent.actor, attackEvent.attackData.target);\r\n    if (wallsmash_response.is_wall_smash) {\r\n        attackEvent.eventType = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.SmashAttack;\r\n        attackEvent.attackData.damage *= 2;\r\n        attackEvent.attackData.behind_xy = wallsmash_response.behind_target_xy;\r\n    }\r\n    return attackEvent;\r\n}\r\nfunction attack(gm, data) {\r\n    let animationEvent;\r\n    let victim = data.attackData.target;\r\n    if (data.powerData) {\r\n        data.powerData.power.charge_stat.decrement(1);\r\n    }\r\n    // when you get attacked go into hunting mode no matter what\r\n    if (victim) {\r\n        if (!(victim.isSameThing(gm.getPlayer()))) {\r\n            victim.monster_status = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].MonsterStatus.Hunt;\r\n        }\r\n    }\r\n    let damageEvent = Object.assign({}, data);\r\n    damageEvent.eventType = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.ApplyDamage;\r\n    // if we already have damage calcs passed in, use them, if not, calculate now\r\n    if (!(damageEvent.damageData)) {\r\n        damageEvent.damageData = calcDamage(gm, data.actor, victim, data.attackData.damage);\r\n    }\r\n    // add any effects to the damage event\r\n    if (data.attackData.effects) {\r\n        damageEvent.damageData.effects = data.attackData.effects.concat([]);\r\n    }\r\n    if ((data.attackData.isMelee) || ((victim) && (victim.location.compare(data.actor.location)))) {\r\n        console.log(`${data.actor.name} attacks ${data.attackData.target.name}`);\r\n        gm.insertEvent(damageEvent);\r\n        gm.endEvent(data);\r\n    }\r\n    else {\r\n        // handle ranged attacks\r\n        // console.log(`${data.actor.name} SHOOTS ${data.attackData.target.name}`)\r\n        animationEvent = {\r\n            eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.RunAnimation,\r\n            actor: data.actor,\r\n            endsTurn: false,\r\n            playerInitiated: true,\r\n            animationData: {\r\n                animationType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewAnimationType.OverPath,\r\n                from_xy: data.attackData.from_xy,\r\n                to_xy: data.attackData.to_xy,\r\n                color: data.actor.color,\r\n                code: '*'\r\n            }\r\n        };\r\n        gm.insertEvent_Next(animationEvent);\r\n        gm.insertEvent(damageEvent);\r\n        gm.endEvent(data);\r\n    }\r\n}\r\nfunction checkForWallSmash(gm, attacker, target) {\r\n    // check for wall smashing\r\n    let attack_offset_xy = target.location.subtract(attacker.location).toUnit();\r\n    // let behind_target_xy = attacker.location.add(attack_offset_xy.multiplyScalar(2))\r\n    let behind_target_xy = target.location.add(attack_offset_xy.multiplyScalar(1));\r\n    let level = gm.getCurrentLevel();\r\n    if (level.isValid(behind_target_xy)) {\r\n        let terrain_at = level.terrain.getAt(behind_target_xy);\r\n        // if (terrain_at.blocks_walking) {\r\n        if ((terrain_at.blocks_flying) || terrain_at.is_solid) {\r\n            return {\r\n                is_wall_smash: true,\r\n                behind_target_xy: behind_target_xy\r\n            };\r\n        }\r\n    }\r\n    return {\r\n        is_wall_smash: false,\r\n        behind_target_xy: behind_target_xy\r\n    };\r\n}\r\nfunction smash_attack(gm, data) {\r\n    if (data.powerData) {\r\n        data.powerData.power.charge_stat.decrement(1);\r\n    }\r\n    let victim = data.attackData.target;\r\n    let calc_damage = calcDamage(gm, data.actor, victim, data.attackData.damage);\r\n    // depending on what was behind the attack, maybe break something\r\n    let level = gm.getCurrentLevel();\r\n    if (data.attackData.behind_xy) {\r\n        let terrain_at = level.terrain.getAt(data.attackData.behind_xy);\r\n        if (_brew__WEBPACK_IMPORTED_MODULE_0__[\"Movement\"].isDoor(terrain_at)) {\r\n            level.terrain.removeAt(data.attackData.behind_xy);\r\n            level.terrain.setAt(data.attackData.behind_xy, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].terrainFactory(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].TerrainType.DoorBroken));\r\n            gm.displayAt(data.attackData.behind_xy);\r\n        }\r\n    }\r\n    if (calc_damage.isFatal) {\r\n        // when smash attacks are fatal, move player into dead victims spot\r\n        // move the player into that spot\r\n        let level = gm.getCurrentLevel();\r\n        let old_xy = gm.getPlayer().location;\r\n        let new_xy = victim.location.clone();\r\n        killMonster(gm, victim);\r\n        level.monsters.removeAt(old_xy);\r\n        level.monsters.setAt(new_xy, gm.getPlayer());\r\n        gm.displayList([old_xy, new_xy]);\r\n        let animationEvent = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Animations\"].createCircleAnimationEvent(data, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].damage_flash, 3);\r\n        animationEvent.animationData.to_xy = data.attackData.to_xy;\r\n        gm.insertEvent(animationEvent);\r\n        // Brew.Animations.animateCircle(gm, data.attackData.to_xy, 3, Brew.Color.damage_flash, data)\r\n        gm.endEvent(data);\r\n    }\r\n    else {\r\n        data.damageData = calc_damage;\r\n        attack(gm, data);\r\n    }\r\n}\r\nfunction applyMassDamage(gm, brEvent) {\r\n    let xy_list = brEvent.pathsData.path;\r\n    let attackData = brEvent.attackData;\r\n    let level = gm.getCurrentLevel();\r\n    xy_list.forEach((xy, index, array) => {\r\n        let mob_at = level.monsters.getAt(xy);\r\n        // todo: damage/affect terrain, items, etc.\r\n        if (mob_at) {\r\n            let damageData = calcDamage(gm, brEvent.actor, mob_at, attackData.damage);\r\n            let damageEvent = {\r\n                eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.ApplyDamage,\r\n                actor: brEvent.actor,\r\n                playerInitiated: false,\r\n                endsTurn: false,\r\n                damageData: damageData\r\n            };\r\n            damageEvent.damageData.effects = brEvent.attackData.effects;\r\n            gm.insertEvent(damageEvent);\r\n        }\r\n    });\r\n    gm.endEvent(brEvent);\r\n}\r\nfunction filterDamageEffects(listOfFlags) {\r\n    let combat_effects_list = [\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].Flag.CausesKnockback,\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].Flag.CausesStun,\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].Flag.CausesExplosion,\r\n    ];\r\n    return listOfFlags.filter((my_flag) => {\r\n        return (combat_effects_list.indexOf(my_flag) > -1);\r\n    });\r\n}\r\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvYnJld19nYW1lL2NvbWJhdC50cz9kYjhlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUErQjtBQUV6QixxQkFBc0IsRUFBb0IsRUFBRSxNQUErQjtJQUM3RSxJQUFJLEtBQUssR0FBRyxFQUFFLENBQUMsZUFBZSxFQUFFO0lBQ2hDLElBQUksRUFBRSxHQUFHLE1BQU0sQ0FBQyxRQUFRLENBQUMsS0FBSyxFQUFFO0lBQ2hDLEtBQUssQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBQztJQUMzQixFQUFFLENBQUMsU0FBUyxDQUFDLEVBQUUsQ0FBQztJQUNoQixFQUFFLENBQUMsd0JBQXdCLENBQUMsTUFBTSxDQUFDO0lBRW5DLGtDQUFrQztJQUNsQyw2Q0FBNkM7SUFDN0MsSUFBSSxTQUEyQjtJQUMvQixJQUFJLE9BQThCO0lBQ2xDLHlDQUF5QztJQUN6QyxnQ0FBZ0M7SUFDaEMsNkRBQTZEO0lBQzdELDBEQUEwRDtJQUMxRCx5RkFBeUY7SUFDekYsb0NBQW9DO0lBQ3BDLG1EQUFtRDtJQUNuRCx5Q0FBeUM7SUFDekMsbUJBQW1CO0lBQ25CLFFBQVE7SUFDUiwwREFBMEQ7SUFDMUQsbUJBQW1CO0lBQ25CLFFBQVE7SUFDUiw2Q0FBNkM7SUFDN0MscUJBQXFCO0lBQ3JCLG1CQUFtQjtJQUNuQixRQUFRO0lBRVIsMkdBQTJHO0lBQzNHLDhCQUE4QjtJQUM5QixZQUFZO0lBQ1osK0ZBQStGO0lBRS9GLCtCQUErQjtJQUMvQixxQ0FBcUM7SUFDckMsc0NBQXNDO0lBQ3RDLHNDQUFzQztJQUN0QyxxQkFBcUI7SUFDckIsOERBQThEO0lBQzlELG1DQUFtQztJQUNuQyxnREFBZ0Q7SUFDaEQsa0NBQWtDO0lBQ2xDLFFBQVE7SUFDUiw4RkFBOEY7SUFDOUYsdUJBQXVCO0lBQ3ZCLElBQUk7SUFFSixJQUFJLFVBQVUsR0FBRyxjQUFjLENBQUMsRUFBRSxFQUFFLE1BQU0sQ0FBQztBQUMvQyxDQUFDO0FB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QUFDLElBQUksQ0FBQyxlQUFlO0tBQ2xDO0lBRUQsTUFBTSxDQUFDLFdBQVcsQ0FBQyxNQUFNLENBQUMsQ0FBQyxPQUF3QixFQUFFLEVBQUU7UUFDbkQsTUFBTSxDQUFDLENBQUMsbUJBQW1CLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO0lBQ3RELENBQUMsQ0FBQztBQUNOLENBQUMiLCJmaWxlIjoiLi9zcmMvYnJld19nYW1lL2NvbWJhdC50cy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIEJyZXcgZnJvbSBcIi4uL2JyZXdcIlxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGtpbGxNb25zdGVyKGdtIDogQnJldy5HYW1lTWFzdGVyLCB2aWN0aW06IEJyZXcuR3JpZFRoaW5ncy5Nb25zdGVyKSB7XHJcbiAgICBsZXQgbGV2ZWwgPSBnbS5nZXRDdXJyZW50TGV2ZWwoKVxyXG4gICAgbGV0IHh5ID0gdmljdGltLmxvY2F0aW9uLmNsb25lKClcclxuICAgIGxldmVsLm1vbnN0ZXJzLnJlbW92ZUF0KHh5KVxyXG4gICAgZ20uZGlzcGxheUF0KHh5KVxyXG4gICAgZ20ucmVtb3ZlQWN0b3JGcm9tU2NoZWR1bGVyKHZpY3RpbSlcclxuXHJcbiAgICAvLyB0b2RvOiBhbmltYXRlIHBhcnRzL2Jsb29kIHNwcmF5XHJcbiAgICAvLyBsZXQgc3Vycm91bmRpbmdfeHlfbGlzdCA9IHh5LmdldEFkamFjZW50KClcclxuICAgIGxldCBuZWFyYnlfeHkgOiBCcmV3LkNvb3JkaW5hdGVcclxuICAgIGxldCBpdGVtX2F0IDogQnJldy5HcmlkVGhpbmdzLkl0ZW1cclxuICAgIC8vIHRvZG86IHJhbmRvbWl6ZS9jb25maWd1cml6ZSAjIG9mIHBhcnRzXHJcbiAgICAvLyBmb3IgKGxldCBpID0gMDsgaSA8IDQ7IGkrKykge1xyXG4gICAgLy8gICAgIGxldCByYW5kb21fYW5nbGUgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqMipNYXRoLlBJKVxyXG4gICAgLy8gICAgIGxldCByYW5kb21fZGlzdGFuY2UgPSBCcmV3LlV0aWxzLmdldFJhbmRvbUludCgxLCAzKVxyXG4gICAgLy8gICAgIGxldCBvZmZzZXRfeHkgPSBCcmV3LlV0aWxzLmdldFBvbGFyT2Zmc2V0Q29vcmRpbmF0ZShyYW5kb21fYW5nbGUsIHJhbmRvbV9kaXN0YW5jZSlcclxuICAgIC8vICAgICBuZWFyYnlfeHkgPSB4eS5hZGQob2Zmc2V0X3h5KVxyXG4gICAgLy8gICAgIC8vIG5lYXJieV94eSA9IHJhbmRvbU9mKHN1cnJvdW5kaW5nX3h5X2xpc3QpXHJcbiAgICAvLyAgICAgaWYgKCEobGV2ZWwuaXNWYWxpZChuZWFyYnlfeHkpKSkge1xyXG4gICAgLy8gICAgICAgICBjb250aW51ZVxyXG4gICAgLy8gICAgIH1cclxuICAgIC8vICAgICBpZiAobGV2ZWwudGVycmFpbi5nZXRBdChuZWFyYnlfeHkpLmJsb2Nrc19mbHlpbmcpIHtcclxuICAgIC8vICAgICAgICAgY29udGludWVcclxuICAgIC8vICAgICB9XHJcbiAgICAvLyAgICAgaXRlbV9hdCA9IGxldmVsLml0ZW1zLmdldEF0KG5lYXJieV94eSlcclxuICAgIC8vICAgICBpZiAoaXRlbV9hdCkge1xyXG4gICAgLy8gICAgICAgICBjb250aW51ZVxyXG4gICAgLy8gICAgIH1cclxuXHJcbiAgICAvLyAgICAgbGV2ZWwuZmVhdHVyZXMuc2V0QXQobmVhcmJ5X3h5LCBCcmV3LkRlZmluaXRpb25zLmZlYXR1cmVGYWN0b3J5KEJyZXcuRGVmaW5pdGlvbnMuRmVhdHVyZVR5cGUuU2NyYXApKVxyXG4gICAgLy8gICAgIGdtLmRpc3BsYXlBdChuZWFyYnlfeHkpXHJcbiAgICAvLyB9ICAgICAgICBcclxuICAgIC8vIGxldmVsLmZlYXR1cmVzLnNldEF0KHh5LCBCcmV3LkRlZmluaXRpb25zLmZlYXR1cmVGYWN0b3J5KERlZmluaXRpb25zLkZlYXR1cmVUeXBlLlJlcGFpckdvbykpXHJcbiAgICBcclxuICAgIC8vIGxlYXZlIGNvcnBzZXMgZm9yIGFsbCBIUCA+IDFcclxuICAgIC8vIGlmICh2aWN0aW0uaHAuZ2V0TWF4TGV2ZWwoKSA+IDEpIHtcclxuICAgIC8vICAgICBsZXQgY29ycHNlX3h5IDogQnJldy5Db29yZGluYXRlXHJcbiAgICAvLyAgICAgaXRlbV9hdCA9IGxldmVsLml0ZW1zLmdldEF0KHh5KVxyXG4gICAgLy8gICAgIGlmIChpdGVtX2F0KSB7XHJcbiAgICAvLyAgICAgICAgIGxldCBuZWFyYnlfeHkgPSBsZXZlbC5nZXRTYWZlTG9jYXRpb25OZWFyKHh5LCB0cnVlKVxyXG4gICAgLy8gICAgICAgICBsZXZlbC5pdGVtcy5yZW1vdmVBdCh4eSlcclxuICAgIC8vICAgICAgICAgbGV2ZWwuaXRlbXMuc2V0QXQobmVhcmJ5X3h5LCBpdGVtX2F0KVxyXG4gICAgLy8gICAgICAgICBnbS5kaXNwbGF5QXQobmVhcmJ5X3h5KVxyXG4gICAgLy8gICAgIH1cclxuICAgIC8vICAgICBsZXZlbC5pdGVtcy5zZXRBdCh4eSwgQnJldy5EZWZpbml0aW9ucy5pdGVtRmFjdG9yeShCcmV3LkRlZmluaXRpb25zLkl0ZW1UeXBlLldyZWNrYWdlKSlcclxuICAgIC8vICAgICBnbS5kaXNwbGF5QXQoeHkpXHJcbiAgICAvLyB9XHJcblxyXG4gICAgbGV0IGRpZFRyaWdnZXIgPSB0cmlnZ2VyT25EZWF0aChnbSwgdmljdGltKVxyXG59XHJcblxyXG5mdW5jdGlvbiB0cmlnZ2VyT25EZWF0aChnbTogQnJldy5HYW1lTWFzdGVyLCB2aWN0aW06IEJyZXcuR3JpZFRoaW5ncy5Nb25zdGVyKSA6IGJvb2xlYW4ge1xyXG5cclxuICAgIGxldCBudW1fZXZlbnRzID0gMFxyXG5cclxuICAgIGlmICh2aWN0aW0uaGFzRmxhZyhCcmV3LkVudW1zLkZsYWcuT25EZWF0aEtub2NrYmFjaykpIHtcclxuICAgICAgICBcclxuICAgICAgICBudW1fZXZlbnRzICs9IHRyaWdnZXJLbm9ja2JhY2tCbGFzdChnbSwgdmljdGltLmxvY2F0aW9uLmNsb25lKCksIDEwLCBbdmljdGltXSkgLy8gdG9kbzogY29uZmlnIGJsYXN0IHJhZGl1c1xyXG5cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gKG51bV9ldmVudHMgPiAwKVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gdHJpZ2dlcktub2NrYmFja0JsYXN0KGdtOiBCcmV3LkdhbWVNYXN0ZXIsIG9yaWdpbl94eTogQnJldy5Db29yZGluYXRlLCBtYWduaXR1ZGU6IG51bWJlciwgZXhjbHVkZWRfbW9iczogQXJyYXk8QnJldy5HcmlkVGhpbmdzLk1vbnN0ZXI+ID0gW10pIDogbnVtYmVyIHtcclxuICAgIGxldCBudW1fZXZlbnRzID0gMFxyXG5cclxuICAgIGxldCBsZXZlbCA9IGdtLmdldEN1cnJlbnRMZXZlbCgpXHJcbiAgICBsZXQgZGlzdCA6IG51bWJlclxyXG5cclxuICAgIC8vIGZpZ3VyZSBvdXQgd2hpY2ggdGFyZ2V0cyBhcmUgYWZmZWN0ZWQgYnkgdGhlIGJsYXN0XHJcbiAgICAvLyBhbHNvIGJ1aWxkIGEgZGlzdGFuY2UgbWFwIHNvIHdlIGRvbnQgaGF2ZSB0byByZWNhbGMgZXZlcnl0aGluZyBhZ2FpblxyXG4gICAgbGV0IGFyZWEgPSBCcmV3LlV0aWxzLmdldEJsYXN0QXJlYShsZXZlbCwgb3JpZ2luX3h5LCBtYWduaXR1ZGUpXHJcbiAgICBhcmVhLnJlbW92ZUNvb3JkaW5hdGUob3JpZ2luX3h5KVxyXG4gICAgbGV0IGFmZmVjdGVkX21vYnMgPSBCcmV3LlV0aWxzLmdldE1vbnN0ZXJzV2l0aGluQ29vcmRpbmF0ZUFyZWEobGV2ZWwsIGFyZWEpXHJcblxyXG4gICAgYWZmZWN0ZWRfbW9icy5zb3J0KChtb2JfYSwgbW9iX2IpIDogbnVtYmVyID0+IHtcclxuICAgICAgICByZXR1cm4gQnJldy5VdGlscy5kaXN0MmQob3JpZ2luX3h5LCBtb2JfYi5sb2NhdGlvbikgLSBCcmV3LlV0aWxzLmRpc3QyZChvcmlnaW5feHksIG1vYl9hLmxvY2F0aW9uKVxyXG4gICAgfSlcclxuXHJcbiAgICAvLyBjb25zb2xlLmxvZyhhZmZlY3RlZF9tb2JzKVxyXG4gICAgbGV0IHRyaWdnZXJfYWN0b3IgID0gbGV2ZWwubW9uc3RlcnMuZ2V0QXQob3JpZ2luX3h5KVxyXG4gICAgaWYgKCEodHJpZ2dlcl9hY3RvcikpIHtcclxuICAgICAgICB0cmlnZ2VyX2FjdG9yID0gZ20uZ2V0QXJjaGl0ZWN0KClcclxuICAgIH1cclxuXHJcbiAgICBsZXQga2Rpc3QgOiBudW1iZXJcclxuICAgIGxldCBrbm9ja2JhY2tFdmVudCA6IEJyZXcuRW51bXMuSUJyZXdFdmVudFxyXG4gICAgYWZmZWN0ZWRfbW9icy5mb3JFYWNoKChtb2I6IEJyZXcuR3JpZFRoaW5ncy5Nb25zdGVyKSA9PiB7XHJcbiAgICAgICAga2Rpc3QgPSBCcmV3Lk1vdmVtZW50LmNhbGN1bGF0ZUtub2NrYmFja0Rpc3RhbmNlKGdtLCBvcmlnaW5feHksIG1hZ25pdHVkZSwgbW9iKVxyXG4gICAgICAgIFxyXG4gICAgICAgIGtub2NrYmFja0V2ZW50ID0ge1xyXG4gICAgICAgICAgICBldmVudFR5cGU6IEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5Lbm9ja2JhY2ssXHJcbiAgICAgICAgICAgIGFjdG9yOiB0cmlnZ2VyX2FjdG9yLFxyXG4gICAgICAgICAgICBwbGF5ZXJJbml0aWF0ZWQ6IGZhbHNlLFxyXG4gICAgICAgICAgICBlbmRzVHVybjogZmFsc2UsXHJcbiAgICAgICAgICAgIGtub2NrYmFja0RhdGE6IHtcclxuICAgICAgICAgICAgICAgIG1hZ25pdHVkZTogbWFnbml0dWRlLFxyXG4gICAgICAgICAgICAgICAgb3JpZ2luX3h5OiBvcmlnaW5feHksXHJcbiAgICAgICAgICAgICAgICB0YXJnZXQ6IG1vYlxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGdtLmluc2VydEV2ZW50KGtub2NrYmFja0V2ZW50KVxyXG4gICAgICAgIG51bV9ldmVudHMgKz0gMVxyXG4gICAgfSlcclxuXHJcbiAgICBnbS5pbnNlcnRFdmVudCh7XHJcbiAgICAgICAgZXZlbnRUeXBlOiBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuUnVuQW5pbWF0aW9uLFxyXG4gICAgICAgIGFjdG9yOiB0cmlnZ2VyX2FjdG9yLFxyXG4gICAgICAgIHBsYXllckluaXRpYXRlZDogZmFsc2UsXHJcbiAgICAgICAgZW5kc1R1cm46IGZhbHNlLFxyXG4gICAgICAgIGFuaW1hdGlvbkRhdGE6IHtcclxuICAgICAgICAgICAgYW5pbWF0aW9uVHlwZTogQnJldy5FbnVtcy5CcmV3QW5pbWF0aW9uVHlwZS5DaXJjbGVPdXQsXHJcbiAgICAgICAgICAgIGNvbG9yOiBCcmV3LkNvbG9yLmNvbG9yX2ZvcmNlLFxyXG4gICAgICAgICAgICBmcm9tX3h5OiBvcmlnaW5feHksXHJcbiAgICAgICAgICAgIHRvX3h5OiBvcmlnaW5feHksXHJcbiAgICAgICAgICAgIHJhbmdlOiBtYWduaXR1ZGVcclxuICAgICAgICB9XHJcbiAgICB9KVxyXG4gICAgcmV0dXJuIG51bV9ldmVudHNcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNhbGNEYW1hZ2UoZ206IEJyZXcuR2FtZU1hc3RlciwgYXR0YWNrZXIgOiBCcmV3LkdyaWRUaGluZ3MuTW9uc3RlciwgdmljdGltOiBCcmV3LkdyaWRUaGluZ3MuTW9uc3RlciwgZGFtYWdlIDogbnVtYmVyKSA6IEJyZXcuRW51bXMuSUJyZXdEYW1hZ2VFdmVudERhdGEge1xyXG4gICAgLy8gc2VlIGhvdyBtdWNoIGRhbWFnZSB2aWN0aW0gY2FuIGFic29yYlxyXG4gICAgLy8gbGV0IHNoaWVsZF9zdHJlbmd0aCA9IDBcclxuICAgIC8vIGxldCBzaGllbGQgOiBCcmV3LlBvd2VyID0gdmljdGltLmdldFBvd2VycygpLmdldFBvd2VyT2ZUeXBlKEJyZXdQb3dlclR5cGUuU2hpZWxkKVxyXG4gICAgXHJcbiAgICAvLyBpZiAoKHNoaWVsZCkgJiYgKHNoaWVsZC5jdXJyZW50Q2hhcmdlID4gMCkpIHtcclxuICAgIC8vICAgICBzaGllbGRfc3RyZW5ndGggPSBzaGllbGQuY3VycmVudENoYXJnZVxyXG4gICAgLy8gfVxyXG4gICAgbGV0IHNoaWVsZF9zdHJlbmd0aDogbnVtYmVyID0gMFxyXG5cclxuICAgIGlmICh2aWN0aW0pIHtcclxuICAgICAgICBzaGllbGRfc3RyZW5ndGggPSB2aWN0aW0uc2hpZWxkcy5nZXRDdXJyZW50TGV2ZWwoKVxyXG4gICAgfVxyXG5cclxuICAgIGxldCBocF9kYW1hZ2UgOiBudW1iZXJcclxuICAgIGxldCBzaGllbGRfZGFtYWdlIDogbnVtYmVyXHJcbiAgICBsZXQgaXNfZmF0YWwgOiBib29sZWFuID0gZmFsc2VcclxuXHJcbiAgICBpZiAoc2hpZWxkX3N0cmVuZ3RoID49IGRhbWFnZSkge1xyXG4gICAgICAgIGhwX2RhbWFnZSA9IDBcclxuICAgICAgICBzaGllbGRfZGFtYWdlID0gZGFtYWdlXHJcblxyXG4gICAgICAgIGlmICgoc2hpZWxkX3N0cmVuZ3RoID09IHNoaWVsZF9kYW1hZ2UpICYmICh2aWN0aW0uaXNTYW1lVGhpbmcoZ20uZ2V0UGxheWVyKCkpKSkge1xyXG4gICAgICAgICAgICAvLyBpZiB3ZSBqdXN0IGxvc3Qgb3VyIHNoaWVsZCwgcmVjb2xvclxyXG4gICAgICAgICAgICB2aWN0aW0uY29sb3IgPSBCcmV3LkNvbG9yLmhlcm9fYmx1ZVxyXG4gICAgICAgIH1cclxuICAgIH0gZWxzZSBpZiAoKHZpY3RpbSkgJiYgKHZpY3RpbS5oYXNGbGFnKEJyZXcuRW51bXMuRmxhZy5JbnZ1bG5lcmFibGUpKSkge1xyXG4gICAgICAgIGhwX2RhbWFnZSA9IDBcclxuICAgICAgICBcclxuICAgIH0gZWxzZSB7XHJcblxyXG4gICAgICAgIGhwX2RhbWFnZSA9IGRhbWFnZSAtIHNoaWVsZF9zdHJlbmd0aFxyXG4gICAgICAgIHNoaWVsZF9kYW1hZ2UgPSBzaGllbGRfc3RyZW5ndGhcclxuICAgICAgICBpZiAodmljdGltKSB7XHJcbiAgICAgICAgICAgIGlzX2ZhdGFsID0gKCh2aWN0aW0uaHAuZ2V0Q3VycmVudExldmVsKCkgLSBocF9kYW1hZ2UpIDw9IDApXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgaXNfZmF0YWwgPSBmYWxzZVxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgIH1cclxuXHJcbiAgICAvLyBpZiB0YXJnZXQgaXMgYWxyZWFkeSBXRUFLLCBldmVyeSBhdHRhY2sgd2l0aCBkYW1hZ2Ugb3ZlciAxIGlzIGZhdGFsXHJcbiAgICBpZiAodmljdGltKSB7XHJcbiAgICAgICAgbGV0IGlzX3dlYWtlbmVkID0gdmljdGltLmhhc0ZsYWcoQnJldy5FbnVtcy5GbGFnLldlYWspXHJcblxyXG4gICAgICAgIGlmIChpc193ZWFrZW5lZCAmJiAoaHBfZGFtYWdlID4gMCkpIHtcclxuICAgICAgICAgICAgaXNfZmF0YWwgPSB0cnVlXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHRhcmdldDogdmljdGltLFxyXG4gICAgICAgIGRhbWFnZVRvSFA6IGhwX2RhbWFnZSxcclxuICAgICAgICBkYW1hZ2VUb1NoaWVsZHM6IHNoaWVsZF9kYW1hZ2UsXHJcbiAgICAgICAgc2hpZWxkVXNlZDogbnVsbCxcclxuICAgICAgICBpc0ZhdGFsOiBpc19mYXRhbFxyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gYXBwbHlEYW1hZ2UoZ206IEJyZXcuR2FtZU1hc3RlciwgZGF0YTogQnJldy5FbnVtcy5JQnJld0V2ZW50KSB7XHJcbiAgICBsZXQgdmljdGltIDogQnJldy5HcmlkVGhpbmdzLk1vbnN0ZXIgPSBkYXRhLmRhbWFnZURhdGEudGFyZ2V0XHJcbiAgICAvLyBjb25zb2xlLmxvZyhcImFwcGx5aW5nIGRhbWFnZVwiKVxyXG5cclxuICAgIGxldCBjYWxjX2RhbWFnZSA9IGRhdGEuZGFtYWdlRGF0YVxyXG5cclxuICAgIGlmICh2aWN0aW0pIHtcclxuXHJcbiAgICAgICAgLy8gYXBwbHkgZGFtYWdlXHJcbiAgICAgICAgaWYgKGNhbGNfZGFtYWdlLmRhbWFnZVRvU2hpZWxkcyA+IDApIHtcclxuICAgICAgICAgICAgdmljdGltLnNoaWVsZHMuZGVjcmVtZW50KGNhbGNfZGFtYWdlLmRhbWFnZVRvU2hpZWxkcylcclxuICAgICAgICB9IFxyXG5cclxuICAgICAgICBpZiAoY2FsY19kYW1hZ2UuZGFtYWdlVG9IUCA+IDApIHtcclxuICAgICAgICAgICAgdmljdGltLmhwLmRlY3JlbWVudChjYWxjX2RhbWFnZS5kYW1hZ2VUb0hQKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IGZsYXNoX2NvbG9yIDogbnVtYmVyW11cclxuICAgICAgICBpZiAoZGF0YS5kYW1hZ2VEYXRhLmRhbWFnZVRvU2hpZWxkcyA+IGRhdGEuZGFtYWdlRGF0YS5kYW1hZ2VUb0hQKSB7XHJcbiAgICAgICAgICAgIGZsYXNoX2NvbG9yID0gQnJldy5Db2xvci5wb3dlcl9zaGllbGRcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBmbGFzaF9jb2xvciA9IEJyZXcuQ29sb3IuZGFtYWdlX2ZsYXNoXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgYW5pbWF0aW9uRXZlbnQgOiBCcmV3LkVudW1zLklCcmV3RXZlbnQgPSB7XHJcbiAgICAgICAgICAgIGV2ZW50VHlwZTogQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLlJ1bkFuaW1hdGlvbixcclxuICAgICAgICAgICAgYWN0b3I6IGRhdGEuYWN0b3IsXHJcbiAgICAgICAgICAgIGVuZHNUdXJuOiBmYWxzZSxcclxuICAgICAgICAgICAgcGxheWVySW5pdGlhdGVkOiB0cnVlLCAvLyB0b2RvOiBjaGVjayBpZiBpcy1wbGF5ZXJcclxuICAgICAgICAgICAgYW5pbWF0aW9uRGF0YToge1xyXG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uVHlwZTogQnJldy5FbnVtcy5CcmV3QW5pbWF0aW9uVHlwZS5GbGFzaCxcclxuICAgICAgICAgICAgICAgIGZyb21feHk6IG51bGwsXHJcbiAgICAgICAgICAgICAgICB0b194eTogZGF0YS5kYW1hZ2VEYXRhLnRhcmdldC5sb2NhdGlvbixcclxuICAgICAgICAgICAgICAgIGNvbG9yOiBmbGFzaF9jb2xvclxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGdtLmluc2VydEV2ZW50KGFuaW1hdGlvbkV2ZW50KVxyXG4gICAgfVxyXG5cclxuICAgIGlmICgodmljdGltKSAmJiAoY2FsY19kYW1hZ2UuaXNGYXRhbCkgJiYgKHZpY3RpbS5pc1NhbWVUaGluZyhnbS5nZXRQbGF5ZXIoKSkpKSB7XHJcbiAgICAgICAgXHJcbiAgICAgICAgbGV0IGZhdGFsRXZlbnQgOiBCcmV3LkVudW1zLklCcmV3RXZlbnQgPSB7XHJcbiAgICAgICAgICAgIGV2ZW50VHlwZTogQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLlBsYXllckRlYXRoLFxyXG4gICAgICAgICAgICBhY3RvcjogZGF0YS5hY3RvcixcclxuICAgICAgICAgICAgcGxheWVySW5pdGlhdGVkOiBmYWxzZSxcclxuICAgICAgICAgICAgZW5kc1R1cm46IHRydWVcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gZGF0YS5lbmRzVHVybiA9IGZhbHNlXHJcbiAgICAgICAgZ20uaW5zZXJ0RXZlbnQoZmF0YWxFdmVudClcclxuICAgICAgICBnbS5lbmRFdmVudChkYXRhKVxyXG4gICAgICAgIFxyXG5cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgaWYgKCh2aWN0aW0pICYmIChjYWxjX2RhbWFnZS5pc0ZhdGFsKSkge1xyXG4gICAgICAgICAgICAvLyBzb21lb25lIGVsc2UgZGllZFxyXG4gICAgICAgICAgICBraWxsTW9uc3RlcihnbSwgdmljdGltKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGRhdGEuZGFtYWdlRGF0YS5lZmZlY3RzKSB7XHJcbiAgICAgICAgICAgIGlmICh2aWN0aW0pIHtcclxuICAgICAgICAgICAgICAgIGFwcGx5Q29tYmF0RWZmZWN0cyhnbSwgZGF0YS5hY3RvciwgdmljdGltLCBkYXRhLmRhbWFnZURhdGEuZWZmZWN0cylcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGFwcGx5Q29tYmF0RWZmZWN0cyhnbSwgZGF0YS5hY3RvciwgbnVsbCwgZGF0YS5kYW1hZ2VEYXRhLmVmZmVjdHMsIGRhdGEuYXR0YWNrRGF0YS50b194eSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZ20uZW5kRXZlbnQoZGF0YSlcclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gYXBwbHlDb21iYXRFZmZlY3RzKGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGF0dGFja2VyOiBCcmV3LkdyaWRUaGluZ3MuTW9uc3RlciwgdmljdGltOiBCcmV3LkdyaWRUaGluZ3MuTW9uc3RlciwgZWZmZWN0czogQXJyYXk8QnJldy5FbnVtcy5GbGFnPiwgbm9udmljdGltX3RhcmdldF94eT86IEJyZXcuQ29vcmRpbmF0ZSkge1xyXG5cclxuICAgIGlmICh2aWN0aW0pIHtcclxuICAgICAgICBpZiAoZWZmZWN0cy5pbmRleE9mKEJyZXcuRW51bXMuRmxhZy5DYXVzZXNTdHVuKSA+IC0xKSB7XHJcbiAgICAgICAgICAgIGdtLnRpbWVyX21vbml0b3Iuc2V0RmxhZ1dpdGhUaW1lcihnbSwgdmljdGltLCBCcmV3LkVudW1zLkZsYWcuU3R1bm5lZCwgNSlcclxuICAgICAgICAgICAgZ20uZGlzcGxheUF0KHZpY3RpbS5sb2NhdGlvbilcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChlZmZlY3RzLmluZGV4T2YoQnJldy5FbnVtcy5GbGFnLkNhdXNlc1dlYWspID4gLTEpIHtcclxuICAgICAgICAgICAgZ20udGltZXJfbW9uaXRvci5zZXRGbGFnV2l0aFRpbWVyKGdtLCB2aWN0aW0sIEJyZXcuRW51bXMuRmxhZy5XZWFrLCA1KVxyXG4gICAgICAgICAgICBnbS5kaXNwbGF5QXQodmljdGltLmxvY2F0aW9uKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGVmZmVjdHMuaW5kZXhPZihCcmV3LkVudW1zLkZsYWcuQ2F1c2VzSW52dWxuZXJhYmxlKSA+IC0xKSB7XHJcbiAgICAgICAgICAgIGdtLnRpbWVyX21vbml0b3Iuc2V0RmxhZ1dpdGhUaW1lcihnbSwgdmljdGltLCBCcmV3LkVudW1zLkZsYWcuSW52dWxuZXJhYmxlLCA1KVxyXG4gICAgICAgICAgICBnbS5kaXNwbGF5QXQodmljdGltLmxvY2F0aW9uKVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBpZiAoZWZmZWN0cy5pbmRleE9mKEJyZXcuRW51bXMuRmxhZy5DYXVzZXNFeHBsb3Npb24pID4gLTEpIHtcclxuICAgICAgICAvLyBsZXQgZXhwbG9zaW9uX2RhbWFnZSA9IDJcclxuICAgICAgICBsZXQgZmFrZV9ncmVuYWRlIDogQnJldy5HcmlkVGhpbmdzLkl0ZW0gPSBCcmV3LkRlZmluaXRpb25zLml0ZW1GYWN0b3J5KEJyZXcuRGVmaW5pdGlvbnMuSXRlbVR5cGUuR3JlbmFkZSwgeyBkYW1hZ2U6IEJyZXcuQ29uZmlnLmV4cGxvc2lvbl9kYW1hZ2UgfSlcclxuICAgICAgICBmYWtlX2dyZW5hZGUuc3VidHlwZSA9IEJyZXcuRGVmaW5pdGlvbnMuSXRlbVN1YnR5cGUuR19FeHBsb3NpdmVcclxuICAgICAgICBsZXQgdGFyZ2V0X3h5IDogQnJldy5Db29yZGluYXRlXHJcbiAgICAgICAgaWYgKHZpY3RpbSkge1xyXG4gICAgICAgICAgICB0YXJnZXRfeHkgPSB2aWN0aW0ubG9jYXRpb24uY2xvbmUoKVxyXG4gICAgICAgIH0gZWxzZSBpZiAobm9udmljdGltX3RhcmdldF94eSkge1xyXG4gICAgICAgICAgICB0YXJnZXRfeHkgPSBub252aWN0aW1fdGFyZ2V0X3h5XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwibWlzc2luZyB0YXJnZXQgY29vcmQgZm9yIG5vbi12aWN0aW0gZXhwbG9zaW9uXCIpXHJcbiAgICAgICAgfVxyXG4gICAgICAgIEJyZXcuSXRlbUludGVyYWN0aW9uLnRyaWdnZXJHcmVuYWRlKGdtLCBmYWtlX2dyZW5hZGUsIHRhcmdldF94eSlcclxuXHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGVmZmVjdHMuaW5kZXhPZihCcmV3LkVudW1zLkZsYWcuQ2F1c2VzS25vY2tiYWNrKSA+IC0xKSB7XHJcbiAgICAgICAgbGV0IG1hZ25pdHVkZSA9IEJyZXcuTW92ZW1lbnQuY2FsY3VsYXRlS25vY2tiYWNrRGlzdGFuY2UoZ20sIGF0dGFja2VyLmxvY2F0aW9uLCAxMCwgdmljdGltKVxyXG4gICAgICAgIFxyXG4gICAgICAgIGxldCBrbm9ja2JhY2tFdmVudCA6IEJyZXcuRW51bXMuSUJyZXdFdmVudCA9IHtcclxuICAgICAgICAgICAgZXZlbnRUeXBlOiBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuS25vY2tiYWNrLFxyXG4gICAgICAgICAgICBhY3RvcjogYXR0YWNrZXIsXHJcbiAgICAgICAgICAgIHBsYXllckluaXRpYXRlZDogZmFsc2UsXHJcbiAgICAgICAgICAgIGVuZHNUdXJuOiBmYWxzZSxcclxuICAgICAgICAgICAga25vY2tiYWNrRGF0YToge1xyXG4gICAgICAgICAgICAgICAgbWFnbml0dWRlOiBtYWduaXR1ZGUsXHJcbiAgICAgICAgICAgICAgICBvcmlnaW5feHk6IGF0dGFja2VyLmxvY2F0aW9uLmNsb25lKCksXHJcbiAgICAgICAgICAgICAgICB0YXJnZXQ6IHZpY3RpbVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGdtLmluc2VydEV2ZW50KGtub2NrYmFja0V2ZW50KVxyXG4gICAgfVxyXG5cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHBvc3NpYmx5Q29udmVydEF0dGFja1RvU21hc2hBdHRhY2soZ206IEJyZXcuR2FtZU1hc3RlciwgYXR0YWNrRXZlbnQ6IEJyZXcuRW51bXMuSUJyZXdFdmVudCkgOiBCcmV3LkVudW1zLklCcmV3RXZlbnQge1xyXG4gICAgaWYgKCEoQnJldy5JbnRlbC5pc1BsYXllcihnbSwgYXR0YWNrRXZlbnQuYWN0b3IpKSkge1xyXG4gICAgICAgIC8vIG9ubHkgcGxheWVyIGNhbiB3YWxsIHNtYXNoIChmb3Igbm93PylcclxuICAgICAgICByZXR1cm4gYXR0YWNrRXZlbnRcclxuICAgIH1cclxuXHJcbiAgICBsZXQgd2FsbHNtYXNoX3Jlc3BvbnNlID0gQnJldy5Db21iYXQuY2hlY2tGb3JXYWxsU21hc2goZ20sIGF0dGFja0V2ZW50LmFjdG9yLCBhdHRhY2tFdmVudC5hdHRhY2tEYXRhLnRhcmdldClcclxuICAgIGlmICh3YWxsc21hc2hfcmVzcG9uc2UuaXNfd2FsbF9zbWFzaCkge1xyXG4gICAgICAgIGF0dGFja0V2ZW50LmV2ZW50VHlwZSA9IEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5TbWFzaEF0dGFja1xyXG4gICAgICAgIGF0dGFja0V2ZW50LmF0dGFja0RhdGEuZGFtYWdlICo9IDJcclxuICAgICAgICBhdHRhY2tFdmVudC5hdHRhY2tEYXRhLmJlaGluZF94eSA9IHdhbGxzbWFzaF9yZXNwb25zZS5iZWhpbmRfdGFyZ2V0X3h5XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGF0dGFja0V2ZW50XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBhdHRhY2soZ206IEJyZXcuR2FtZU1hc3RlciwgZGF0YTogQnJldy5FbnVtcy5JQnJld0V2ZW50KSB7XHJcbiAgICBsZXQgYW5pbWF0aW9uRXZlbnQgOiBCcmV3LkVudW1zLklCcmV3RXZlbnRcclxuICAgIGxldCB2aWN0aW0gOiBCcmV3LkdyaWRUaGluZ3MuTW9uc3RlciA9IGRhdGEuYXR0YWNrRGF0YS50YXJnZXRcclxuICAgIFxyXG4gICAgaWYgKGRhdGEucG93ZXJEYXRhKSB7XHJcbiAgICAgICAgZGF0YS5wb3dlckRhdGEucG93ZXIuY2hhcmdlX3N0YXQuZGVjcmVtZW50KDEpXHJcbiAgICB9XHJcblxyXG4gICAgLy8gd2hlbiB5b3UgZ2V0IGF0dGFja2VkIGdvIGludG8gaHVudGluZyBtb2RlIG5vIG1hdHRlciB3aGF0XHJcbiAgICBpZiAodmljdGltKSB7XHJcbiAgICAgICAgaWYgKCEodmljdGltLmlzU2FtZVRoaW5nKGdtLmdldFBsYXllcigpKSkpIHtcclxuICAgICAgICAgICAgdmljdGltLm1vbnN0ZXJfc3RhdHVzID0gQnJldy5FbnVtcy5Nb25zdGVyU3RhdHVzLkh1bnRcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgbGV0IGRhbWFnZUV2ZW50IDogQnJldy5FbnVtcy5JQnJld0V2ZW50ID0gey4uLmRhdGF9XHJcbiAgICBkYW1hZ2VFdmVudC5ldmVudFR5cGUgPSBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuQXBwbHlEYW1hZ2VcclxuICAgIFxyXG4gICAgLy8gaWYgd2UgYWxyZWFkeSBoYXZlIGRhbWFnZSBjYWxjcyBwYXNzZWQgaW4sIHVzZSB0aGVtLCBpZiBub3QsIGNhbGN1bGF0ZSBub3dcclxuICAgIGlmICghKGRhbWFnZUV2ZW50LmRhbWFnZURhdGEpKSB7XHJcbiAgICAgICAgZGFtYWdlRXZlbnQuZGFtYWdlRGF0YSA9IGNhbGNEYW1hZ2UoZ20sIGRhdGEuYWN0b3IsIHZpY3RpbSwgZGF0YS5hdHRhY2tEYXRhLmRhbWFnZSlcclxuICAgIH1cclxuXHJcbiAgICAvLyBhZGQgYW55IGVmZmVjdHMgdG8gdGhlIGRhbWFnZSBldmVudFxyXG4gICAgaWYgKGRhdGEuYXR0YWNrRGF0YS5lZmZlY3RzKSB7XHJcbiAgICAgICAgZGFtYWdlRXZlbnQuZGFtYWdlRGF0YS5lZmZlY3RzID0gZGF0YS5hdHRhY2tEYXRhLmVmZmVjdHMuY29uY2F0KFtdKVxyXG4gICAgfVxyXG5cclxuICAgIGlmICgoZGF0YS5hdHRhY2tEYXRhLmlzTWVsZWUpIHx8ICgodmljdGltKSAmJiAodmljdGltLmxvY2F0aW9uLmNvbXBhcmUoZGF0YS5hY3Rvci5sb2NhdGlvbikpKSkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGAke2RhdGEuYWN0b3IubmFtZX0gYXR0YWNrcyAke2RhdGEuYXR0YWNrRGF0YS50YXJnZXQubmFtZX1gKVxyXG5cclxuICAgICAgICBnbS5pbnNlcnRFdmVudChkYW1hZ2VFdmVudClcclxuXHJcbiAgICAgICAgZ20uZW5kRXZlbnQoZGF0YSlcclxuXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vIGhhbmRsZSByYW5nZWQgYXR0YWNrc1xyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKGAke2RhdGEuYWN0b3IubmFtZX0gU0hPT1RTICR7ZGF0YS5hdHRhY2tEYXRhLnRhcmdldC5uYW1lfWApXHJcblxyXG4gICAgICAgIGFuaW1hdGlvbkV2ZW50ID0ge1xyXG4gICAgICAgICAgICBldmVudFR5cGU6IEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5SdW5BbmltYXRpb24sXHJcbiAgICAgICAgICAgIGFjdG9yOiBkYXRhLmFjdG9yLFxyXG4gICAgICAgICAgICBlbmRzVHVybjogZmFsc2UsXHJcbiAgICAgICAgICAgIHBsYXllckluaXRpYXRlZDogdHJ1ZSwgLy8gdG9kbzogY2hlY2sgaWYgaXMtcGxheWVyXHJcbiAgICAgICAgICAgIGFuaW1hdGlvbkRhdGE6IHtcclxuICAgICAgICAgICAgICAgIGFuaW1hdGlvblR5cGU6IEJyZXcuRW51bXMuQnJld0FuaW1hdGlvblR5cGUuT3ZlclBhdGgsXHJcbiAgICAgICAgICAgICAgICBmcm9tX3h5OiBkYXRhLmF0dGFja0RhdGEuZnJvbV94eSxcclxuICAgICAgICAgICAgICAgIHRvX3h5OiBkYXRhLmF0dGFja0RhdGEudG9feHksXHJcbiAgICAgICAgICAgICAgICBjb2xvcjogZGF0YS5hY3Rvci5jb2xvciwgLy8gdG9kbzogaG93IHRvIGNvbG9yIHJhbmdlZCBhdHRhY2tzXHJcbiAgICAgICAgICAgICAgICBjb2RlOiAnKidcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBnbS5pbnNlcnRFdmVudF9OZXh0KGFuaW1hdGlvbkV2ZW50KVxyXG4gICAgICAgIGdtLmluc2VydEV2ZW50KGRhbWFnZUV2ZW50KVxyXG5cclxuICAgICAgICBnbS5lbmRFdmVudChkYXRhKVxyXG4gICAgfVxyXG59XHJcbmV4cG9ydCBpbnRlcmZhY2UgSVdhbGxTbWFzaFJlc3BvbnNlIHtcclxuICAgIGlzX3dhbGxfc21hc2g6IGJvb2xlYW5cclxuICAgIGJlaGluZF90YXJnZXRfeHk6IEJyZXcuQ29vcmRpbmF0ZVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY2hlY2tGb3JXYWxsU21hc2goZ206IEJyZXcuR2FtZU1hc3RlciwgYXR0YWNrZXI6IEJyZXcuR3JpZFRoaW5ncy5Nb25zdGVyLCB0YXJnZXQ6IEJyZXcuR3JpZFRoaW5ncy5Nb25zdGVyKSA6IElXYWxsU21hc2hSZXNwb25zZSB7XHJcbiAgICAvLyBjaGVjayBmb3Igd2FsbCBzbWFzaGluZ1xyXG4gICAgbGV0IGF0dGFja19vZmZzZXRfeHkgPSB0YXJnZXQubG9jYXRpb24uc3VidHJhY3QoYXR0YWNrZXIubG9jYXRpb24pLnRvVW5pdCgpXHJcbiAgICAvLyBsZXQgYmVoaW5kX3RhcmdldF94eSA9IGF0dGFja2VyLmxvY2F0aW9uLmFkZChhdHRhY2tfb2Zmc2V0X3h5Lm11bHRpcGx5U2NhbGFyKDIpKVxyXG4gICAgbGV0IGJlaGluZF90YXJnZXRfeHkgPSB0YXJnZXQubG9jYXRpb24uYWRkKGF0dGFja19vZmZzZXRfeHkubXVsdGlwbHlTY2FsYXIoMSkpXHJcbiAgICBsZXQgbGV2ZWwgPSBnbS5nZXRDdXJyZW50TGV2ZWwoKVxyXG5cclxuICAgIGlmIChsZXZlbC5pc1ZhbGlkKGJlaGluZF90YXJnZXRfeHkpKSB7XHJcbiAgICAgICAgbGV0IHRlcnJhaW5fYXQgPSBsZXZlbC50ZXJyYWluLmdldEF0KGJlaGluZF90YXJnZXRfeHkpXHJcbiAgICAgICAgLy8gaWYgKHRlcnJhaW5fYXQuYmxvY2tzX3dhbGtpbmcpIHtcclxuICAgICAgICBpZiAoKHRlcnJhaW5fYXQuYmxvY2tzX2ZseWluZykgfHwgdGVycmFpbl9hdC5pc19zb2xpZCl7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICBpc193YWxsX3NtYXNoOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgYmVoaW5kX3RhcmdldF94eTogYmVoaW5kX3RhcmdldF94eVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBpc193YWxsX3NtYXNoOiBmYWxzZSxcclxuICAgICAgICBiZWhpbmRfdGFyZ2V0X3h5OiBiZWhpbmRfdGFyZ2V0X3h5XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBzbWFzaF9hdHRhY2soZ206IEJyZXcuR2FtZU1hc3RlciwgZGF0YTogQnJldy5FbnVtcy5JQnJld0V2ZW50KSB7XHJcbiAgICBcclxuICAgIGlmIChkYXRhLnBvd2VyRGF0YSkge1xyXG4gICAgICAgIGRhdGEucG93ZXJEYXRhLnBvd2VyLmNoYXJnZV9zdGF0LmRlY3JlbWVudCgxKVxyXG4gICAgfVxyXG5cclxuICAgIGxldCB2aWN0aW0gOiBCcmV3LkdyaWRUaGluZ3MuTW9uc3RlciA9IGRhdGEuYXR0YWNrRGF0YS50YXJnZXRcclxuICAgIGxldCBjYWxjX2RhbWFnZSA9IGNhbGNEYW1hZ2UoZ20sIGRhdGEuYWN0b3IsIHZpY3RpbSwgZGF0YS5hdHRhY2tEYXRhLmRhbWFnZSlcclxuXHJcbiAgICAvLyBkZXBlbmRpbmcgb24gd2hhdCB3YXMgYmVoaW5kIHRoZSBhdHRhY2ssIG1heWJlIGJyZWFrIHNvbWV0aGluZ1xyXG4gICAgbGV0IGxldmVsID0gZ20uZ2V0Q3VycmVudExldmVsKClcclxuICAgIGlmIChkYXRhLmF0dGFja0RhdGEuYmVoaW5kX3h5KSB7XHJcbiAgICAgICAgXHJcbiAgICAgICAgbGV0IHRlcnJhaW5fYXQgPSBsZXZlbC50ZXJyYWluLmdldEF0KGRhdGEuYXR0YWNrRGF0YS5iZWhpbmRfeHkpXHJcbiAgICAgICAgaWYgKEJyZXcuTW92ZW1lbnQuaXNEb29yKHRlcnJhaW5fYXQpKSB7XHJcbiAgICAgICAgICAgIGxldmVsLnRlcnJhaW4ucmVtb3ZlQXQoZGF0YS5hdHRhY2tEYXRhLmJlaGluZF94eSlcclxuICAgICAgICAgICAgbGV2ZWwudGVycmFpbi5zZXRBdChkYXRhLmF0dGFja0RhdGEuYmVoaW5kX3h5LCBCcmV3LkRlZmluaXRpb25zLnRlcnJhaW5GYWN0b3J5KEJyZXcuRGVmaW5pdGlvbnMuVGVycmFpblR5cGUuRG9vckJyb2tlbikpXHJcbiAgICAgICAgICAgIGdtLmRpc3BsYXlBdChkYXRhLmF0dGFja0RhdGEuYmVoaW5kX3h5KVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBpZiAoY2FsY19kYW1hZ2UuaXNGYXRhbCkge1xyXG4gICAgICAgIC8vIHdoZW4gc21hc2ggYXR0YWNrcyBhcmUgZmF0YWwsIG1vdmUgcGxheWVyIGludG8gZGVhZCB2aWN0aW1zIHNwb3RcclxuXHJcbiAgICAgICAgLy8gbW92ZSB0aGUgcGxheWVyIGludG8gdGhhdCBzcG90XHJcbiAgICAgICAgbGV0IGxldmVsID0gZ20uZ2V0Q3VycmVudExldmVsKClcclxuICAgICAgICBsZXQgb2xkX3h5ID0gZ20uZ2V0UGxheWVyKCkubG9jYXRpb25cclxuICAgICAgICBsZXQgbmV3X3h5ID0gdmljdGltLmxvY2F0aW9uLmNsb25lKClcclxuXHJcbiAgICAgICAga2lsbE1vbnN0ZXIoZ20sIHZpY3RpbSlcclxuICAgICAgICBcclxuICAgICAgICBsZXZlbC5tb25zdGVycy5yZW1vdmVBdChvbGRfeHkpXHJcbiAgICAgICAgbGV2ZWwubW9uc3RlcnMuc2V0QXQobmV3X3h5LCBnbS5nZXRQbGF5ZXIoKSlcclxuICAgICAgICBnbS5kaXNwbGF5TGlzdChbb2xkX3h5LCBuZXdfeHldKVxyXG4gICAgICAgIFxyXG4gICAgICAgIGxldCBhbmltYXRpb25FdmVudCA9IEJyZXcuQW5pbWF0aW9ucy5jcmVhdGVDaXJjbGVBbmltYXRpb25FdmVudChkYXRhLCBCcmV3LkNvbG9yLmRhbWFnZV9mbGFzaCwgMylcclxuICAgICAgICBhbmltYXRpb25FdmVudC5hbmltYXRpb25EYXRhLnRvX3h5ID0gZGF0YS5hdHRhY2tEYXRhLnRvX3h5XHJcbiAgICAgICAgZ20uaW5zZXJ0RXZlbnQoYW5pbWF0aW9uRXZlbnQpXHJcbiAgICAgICAgLy8gQnJldy5BbmltYXRpb25zLmFuaW1hdGVDaXJjbGUoZ20sIGRhdGEuYXR0YWNrRGF0YS50b194eSwgMywgQnJldy5Db2xvci5kYW1hZ2VfZmxhc2gsIGRhdGEpXHJcbiAgICAgICAgXHJcbiAgICAgICAgZ20uZW5kRXZlbnQoZGF0YSlcclxuXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGRhdGEuZGFtYWdlRGF0YSA9IGNhbGNfZGFtYWdlXHJcbiAgICAgICAgYXR0YWNrKGdtLCBkYXRhKVxyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gYXBwbHlNYXNzRGFtYWdlKGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGJyRXZlbnQ6IEJyZXcuRW51bXMuSUJyZXdFdmVudCkge1xyXG4gICAgbGV0IHh5X2xpc3QgPSBickV2ZW50LnBhdGhzRGF0YS5wYXRoXHJcbiAgICBsZXQgYXR0YWNrRGF0YSA6IEJyZXcuRW51bXMuSUJyZXdBdHRhY2tFdmVudERhdGEgPSBickV2ZW50LmF0dGFja0RhdGFcclxuICAgIGxldCBsZXZlbCA9IGdtLmdldEN1cnJlbnRMZXZlbCgpXHJcblxyXG4gICAgeHlfbGlzdC5mb3JFYWNoKCh4eTogQnJldy5Db29yZGluYXRlLCBpbmRleDogbnVtYmVyLCBhcnJheSkgPT4ge1xyXG4gICAgICAgIGxldCBtb2JfYXQgPSBsZXZlbC5tb25zdGVycy5nZXRBdCh4eSlcclxuICAgICAgICAvLyB0b2RvOiBkYW1hZ2UvYWZmZWN0IHRlcnJhaW4sIGl0ZW1zLCBldGMuXHJcbiAgICAgICAgaWYgKG1vYl9hdCkge1xyXG4gICAgICAgICAgICBsZXQgZGFtYWdlRGF0YSA9IGNhbGNEYW1hZ2UoZ20sIGJyRXZlbnQuYWN0b3IsIG1vYl9hdCwgYXR0YWNrRGF0YS5kYW1hZ2UpXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBsZXQgZGFtYWdlRXZlbnQgOiBCcmV3LkVudW1zLklCcmV3RXZlbnQgPSB7XHJcbiAgICAgICAgICAgICAgICBldmVudFR5cGU6IEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5BcHBseURhbWFnZSxcclxuICAgICAgICAgICAgICAgIGFjdG9yOiBickV2ZW50LmFjdG9yLFxyXG4gICAgICAgICAgICAgICAgcGxheWVySW5pdGlhdGVkOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgIGVuZHNUdXJuOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgIGRhbWFnZURhdGE6IGRhbWFnZURhdGFcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBkYW1hZ2VFdmVudC5kYW1hZ2VEYXRhLmVmZmVjdHMgPSBickV2ZW50LmF0dGFja0RhdGEuZWZmZWN0c1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZ20uaW5zZXJ0RXZlbnQoZGFtYWdlRXZlbnQpXHJcbiAgICAgICAgfVxyXG4gICAgfSlcclxuXHJcbiAgICBnbS5lbmRFdmVudChickV2ZW50KVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZmlsdGVyRGFtYWdlRWZmZWN0cyhsaXN0T2ZGbGFnczogQXJyYXk8QnJldy5FbnVtcy5GbGFnPikgOiBBcnJheTxCcmV3LkVudW1zLkZsYWc+IHtcclxuICAgIGxldCBjb21iYXRfZWZmZWN0c19saXN0ID0gW1xyXG4gICAgICAgIEJyZXcuRW51bXMuRmxhZy5DYXVzZXNLbm9ja2JhY2ssXHJcbiAgICAgICAgQnJldy5FbnVtcy5GbGFnLkNhdXNlc1N0dW4sXHJcbiAgICAgICAgQnJldy5FbnVtcy5GbGFnLkNhdXNlc0V4cGxvc2lvbixcclxuICAgIF1cclxuXHJcbiAgICByZXR1cm4gbGlzdE9mRmxhZ3MuZmlsdGVyKChteV9mbGFnOiBCcmV3LkVudW1zLkZsYWcpID0+IHtcclxuICAgICAgICByZXR1cm4gKGNvbWJhdF9lZmZlY3RzX2xpc3QuaW5kZXhPZihteV9mbGFnKSA+IC0xKVxyXG4gICAgfSlcclxufVxyXG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/brew_game/combat.ts\n");

/***/ }),

/***/ "./src/brew_game/display.ts":
/*!**********************************!*\
  !*** ./src/brew_game/display.ts ***!
  \**********************************/
/*! exports provided: Display */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Display\", function() { return Display; });\n/* harmony import */ var rot_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! rot-js */ \"./node_modules/rot-js/lib/rot.js\");\n/* harmony import */ var rot_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(rot_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _brew__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../brew */ \"./src/brew.ts\");\n\r\n\r\nclass ROTDisplay2 extends rot_js__WEBPACK_IMPORTED_MODULE_0__[\"Display\"] {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.my_context = null;\r\n    }\r\n    getWidth() {\r\n        return Number(this.getContainer().attributes.getNamedItem(\"width\").value);\r\n    }\r\n    getHeight() {\r\n        return Number(this.getContainer().attributes.getNamedItem(\"height\").value);\r\n    }\r\n    getTileWidth() {\r\n        return this.getWidth() / _brew__WEBPACK_IMPORTED_MODULE_1__[\"Config\"].screen_width_tiles;\r\n    }\r\n    getTileHeight() {\r\n        return this.getHeight() / _brew__WEBPACK_IMPORTED_MODULE_1__[\"Config\"].screen_height_tiles;\r\n    }\r\n    clearRect(x, y, width, height) {\r\n        // this._context = <HTMLElement>(this.getContainer())\r\n        // this._context = this.getContainer().firstChild(\r\n        if (!(this.my_context)) {\r\n            // let canvas = <HTMLCanvasElement>this.getContainer()\r\n            // this.my_context = canvas.getContext(\"2d\")\r\n            this.my_context = this.getContainer().getContext(\"2d\");\r\n        }\r\n        this.my_context.clearRect(x * width, y * height, width, height);\r\n    }\r\n    clearRect_Tiles(x, y, width_in_tiles, height_in_tiles) {\r\n        if (!(this.my_context)) {\r\n            this.my_context = this.getContainer().getContext(\"2d\");\r\n        }\r\n        let tile_width = this.getTileWidth();\r\n        let tile_height = this.getTileHeight();\r\n        this.my_context.clearRect(x * tile_width, y * tile_height, width_in_tiles * tile_width, height_in_tiles * tile_height);\r\n    }\r\n}\r\nclass Display {\r\n    constructor(gm, div_container) {\r\n        this.rot_displays = {};\r\n        this.gm = gm;\r\n        this.highlights = new _brew__WEBPACK_IMPORTED_MODULE_1__[\"GridOfThings\"]();\r\n        // setup ROTjs canvas(es)\r\n        this.initCanvas(div_container, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Config\"].screen_width_tiles, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Config\"].screen_height_tiles);\r\n        // this.my_tile_width = this.getDisplay(Brew.Enums.DisplayNames.Game).getContainer().width / Brew.Config.screen_width_tiles\r\n        // this.my_tile_height = this.getDisplay(Brew.Enums.DisplayNames.Game).getContainer().height / Brew.Config.screen_height_tiles\r\n        this.my_tile_width = Number(this.getDisplay(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].DisplayNames.Game).getContainer().attributes.getNamedItem(\"width\").value) / _brew__WEBPACK_IMPORTED_MODULE_1__[\"Config\"].screen_width_tiles;\r\n        this.my_tile_height = Number(this.getDisplay(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].DisplayNames.Game).getContainer().attributes.getNamedItem(\"height\").value) / _brew__WEBPACK_IMPORTED_MODULE_1__[\"Config\"].screen_height_tiles;\r\n    }\r\n    initCanvas(div_container, width, height) {\r\n        // if we already have containers, destroy/recreate them when game restarts\r\n        if (div_container.children.length > 0) {\r\n            while (div_container.firstChild) {\r\n                div_container.removeChild(div_container.firstChild);\r\n            }\r\n        }\r\n        let bg_color;\r\n        if (_brew__WEBPACK_IMPORTED_MODULE_1__[\"Debug\"].BOSS_MODE) {\r\n            bg_color = \"transparent\";\r\n        }\r\n        else {\r\n            bg_color = rot_js__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].toHex(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].charcoal);\r\n        }\r\n        // game - main screen\r\n        let canvas_bg_color;\r\n        canvas_bg_color = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].bg_unexplored;\r\n        let font_size = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Config\"].font_size;\r\n        let gameDisplay = new ROTDisplay2({\r\n            width: width,\r\n            height: height,\r\n            border: 0,\r\n            spacing: 1.15,\r\n            fontSize: font_size,\r\n            bg: bg_color,\r\n            // bg: \"transparent\",\r\n            forceSquareRatio: false,\r\n        });\r\n        let game_canvas = (gameDisplay.getContainer());\r\n        div_container.appendChild(game_canvas);\r\n        this.addDisplay(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].DisplayNames.Game, gameDisplay);\r\n        // hud - targeting, highlighting, etc\r\n        let hudDisplay = new ROTDisplay2({\r\n            width: width,\r\n            height: height,\r\n            border: 0,\r\n            spacing: 1.15,\r\n            fontSize: font_size,\r\n            // bg:  ROT.Color.toHex(Brew.Color.blue), \r\n            bg: \"transparent\",\r\n            forceSquareRatio: false,\r\n        });\r\n        let hud_canvas = (hudDisplay.getContainer());\r\n        div_container.appendChild(hud_canvas);\r\n        let top_height = hudDisplay.getTileHeight();\r\n        hud_canvas.setAttribute(\"style\", `position: absolute; top: ${top_height}; left: 0`);\r\n        this.addDisplay(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].DisplayNames.HUD, hudDisplay);\r\n        // BOSS MODE\r\n        if (_brew__WEBPACK_IMPORTED_MODULE_1__[\"Debug\"].BOSS_MODE) {\r\n            bg_color = rot_js__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].toHex(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].white); // \"transparent\"\r\n        }\r\n        else {\r\n            bg_color = rot_js__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].toHex(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].charcoal);\r\n        }\r\n        // footer\r\n        let footerDisplay = new ROTDisplay2({\r\n            width: width,\r\n            height: 3,\r\n            border: 0,\r\n            spacing: 1.15,\r\n            fontSize: font_size,\r\n            bg: bg_color,\r\n            forceSquareRatio: false,\r\n        });\r\n        let footer_div = document.createElement(\"div\");\r\n        footer_div.setAttribute(\"id\", \"id_div_footer\");\r\n        footer_div.appendChild(footerDisplay.getContainer());\r\n        div_container.appendChild(footer_div);\r\n        this.addDisplay(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].DisplayNames.Footer, footerDisplay);\r\n        // header\r\n        let headerDisplay = new ROTDisplay2({\r\n            width: width,\r\n            height: 1,\r\n            border: 0,\r\n            spacing: 1.15,\r\n            fontSize: font_size,\r\n            bg: bg_color,\r\n            forceSquareRatio: false,\r\n        });\r\n        let header_div = document.createElement(\"div\");\r\n        header_div.setAttribute(\"id\", \"id_div_header\");\r\n        header_div.appendChild(headerDisplay.getContainer());\r\n        div_container.insertBefore(header_div, game_canvas);\r\n        // div_container.appendChild(header_div)\r\n        this.addDisplay(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].DisplayNames.Header, headerDisplay);\r\n    }\r\n    // Display management\r\n    addDisplay(name, disp) {\r\n        this.rot_displays[name] = disp;\r\n    }\r\n    getDisplay(name) {\r\n        // make sure display exists\r\n        if (!(name in this.rot_displays)) {\r\n            throw new RangeError(`cannot find ROT display named ${name}`);\r\n        }\r\n        return this.rot_displays[name];\r\n    }\r\n    clearAll() {\r\n        for (let name in this.rot_displays) {\r\n            let displayName = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].DisplayNames[name];\r\n            this.clearDisplay(displayName);\r\n        }\r\n    }\r\n    clearDisplay(name) {\r\n        let display = this.getDisplay(name);\r\n        display.clearRect(0, 0, display.getWidth(), display.getHeight());\r\n        // display.clear()\r\n    }\r\n    clearDisplayAt(name, x, y) {\r\n        let display = this.getDisplay(name);\r\n        //twp\r\n        display.clearRect(x, y, this.my_tile_width, this.my_tile_height);\r\n    }\r\n    // Drawing on the grid\r\n    drawAll(display_options) {\r\n        for (let x = 0; x < _brew__WEBPACK_IMPORTED_MODULE_1__[\"Config\"].screen_width_tiles; x++) {\r\n            for (let y = 0; y < _brew__WEBPACK_IMPORTED_MODULE_1__[\"Config\"].screen_height_tiles; y++) {\r\n                this.drawAt(new _brew__WEBPACK_IMPORTED_MODULE_1__[\"Coordinate\"](x, y), display_options);\r\n            }\r\n        }\r\n    }\r\n    drawAt(xy, display_options) {\r\n        let draw;\r\n        let level = this.gm.getCurrentLevel();\r\n        if (_brew__WEBPACK_IMPORTED_MODULE_1__[\"Debug\"].debug_pathmap) {\r\n            let pc_of_max;\r\n            let color_value;\r\n            let path_value = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Debug\"].debug_pathmap.field.getAt(xy);\r\n            if (path_value) {\r\n                // if (path_value < Brew.Debug.debug_pathmap.max_value) {\r\n                // if (path_value == FastDijkstraMap.MAX_INT) {\r\n                //     color_value = Brew.Color.white\r\n                // } else if (path_value == null) {\r\n                //     color_value = Brew.Color.white\r\n                // if (path_value == 0) {\r\n                //     color_value = Brew.Color.violet\r\n                // } else if (path_value == Number.MAX_VALUE) {\r\n                //     color_value = Brew.Color.green\r\n                if (path_value < 0) {\r\n                    pc_of_max = (path_value / _brew__WEBPACK_IMPORTED_MODULE_1__[\"Debug\"].debug_pathmap.min_value);\r\n                    color_value = rot_js__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].interpolate(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].blue, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].white, 1 - pc_of_max);\r\n                }\r\n                else {\r\n                    pc_of_max = (path_value / _brew__WEBPACK_IMPORTED_MODULE_1__[\"Debug\"].debug_pathmap.max_value);\r\n                    color_value = rot_js__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].interpolate(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].blue, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].white, pc_of_max);\r\n                }\r\n            }\r\n            else {\r\n                color_value = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].violet;\r\n            }\r\n            this.getDisplay(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].DisplayNames.Game).draw(xy.x, xy.y, \" \", rot_js__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].toHex(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].white), rot_js__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].toHex(color_value));\r\n            return true;\r\n        }\r\n        // 0. PLAYER FOV\r\n        let in_fov;\r\n        in_fov = this.gm.getPlayer().fov.hasAt(xy);\r\n        if (!(in_fov)) {\r\n            // not in view, check memory\r\n            let mem = this.gm.getPlayer().memory.getAt(xy);\r\n            // draw = [' ', Brew.Color.black, Brew.Color.bg_unexplored]\r\n            if (mem) {\r\n                // saw it before\r\n                draw = [mem.code, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].memory, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].bg_memory];\r\n            }\r\n            else {\r\n                // never seen it\r\n                draw = [' ', _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].black, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].bg_unexplored];\r\n            }\r\n        }\r\n        else {\r\n            // IN VIEW\r\n            // 1. TERRAIN\r\n            let terrain = level.terrain.getAt(xy);\r\n            if (terrain == null) {\r\n                // debugger\r\n            }\r\n            draw = [terrain.code, terrain.color, terrain.bg_color];\r\n            // 2. FEATURES\r\n            let feature = level.features.getAt(xy);\r\n            let portal_at = level.portals.getAt(xy); // don't draw features on top of stairs\r\n            if (feature && (!(portal_at)) && (!(terrain.alwaysOnTop))) {\r\n                draw[0] = feature.code;\r\n                if (feature.color) {\r\n                    draw[1] = feature.color;\r\n                }\r\n                if (feature.bg_color) {\r\n                    draw[2] = feature.bg_color;\r\n                }\r\n            }\r\n            // 3. ITEMS\r\n            let item = level.items.getAt(xy);\r\n            if (item) {\r\n                draw[0] = item.code;\r\n                draw[1] = item.color;\r\n            }\r\n            // 4. MONSTERS\r\n            let mob = level.monsters.getAt(xy);\r\n            if (mob) {\r\n                draw[0] = mob.code;\r\n                draw[1] = mob.color;\r\n                if (mob.hasFlag(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].Flag.Stunned)) {\r\n                    draw[2] = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].green;\r\n                }\r\n                let range_threat = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Targeting\"].isRangedAttackThreat(this.gm, mob, this.gm.getPlayer());\r\n                if (range_threat) {\r\n                    draw[2] = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].red;\r\n                }\r\n            }\r\n            // 4.5 : PARTS\r\n            let part = level.parts.getAt(xy);\r\n            if (part) {\r\n                draw[0] = part.code;\r\n                draw[1] = part.color;\r\n            }\r\n            // 5. ABOVE / OVERHEAD\r\n            let ab = level.above.getAt(xy);\r\n            if (ab) {\r\n                draw[0] = ab.code;\r\n                draw[1] = ab.color;\r\n            }\r\n            // REMOTE VISION\r\n            let fov_type = this.gm.getPlayer().fov.getAt(xy);\r\n            if (fov_type == _brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].BrewVisionSource.xRemote) {\r\n                draw[1] = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].bg_remote_vision;\r\n            }\r\n        }\r\n        // boss mode\r\n        if (_brew__WEBPACK_IMPORTED_MODULE_1__[\"Debug\"].BOSS_MODE) {\r\n            draw[2] = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].white;\r\n            // let faded_color = ROT.Color.interpolate(draw[1], Brew.Color.white, 0.6667)\r\n            draw[1] = rot_js__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].interpolate(draw[1], _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].white, 0.6667);\r\n        }\r\n        // highlights\r\n        let highlight = this.highlights.getAt(xy);\r\n        if (highlight) {\r\n            // this.getDisplay(Brew.Enums.DisplayNames.HUD).draw(xy.x, xy.y, \" \", ROT.Color.toHex(Color.black), ROT.Color.toHex(highlight.color))\r\n            draw[2] = highlight.color;\r\n        }\r\n        else {\r\n            // this.getDisplay(Brew.Enums.DisplayNames.HUD)._context.clearRect(xy.x * this.my_tile_width, xy.y * this.my_tile_height, this.my_tile_width, this.my_tile_height)\r\n        }\r\n        if ((display_options) && (display_options.blackAndWhiteMode)) {\r\n            draw[1] = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].gray;\r\n            draw[2] = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].dark_gray;\r\n        }\r\n        if (_brew__WEBPACK_IMPORTED_MODULE_1__[\"Debug\"].BOSS_MODE) {\r\n            this.clearDisplayAt(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].DisplayNames.Game, xy.x, xy.y);\r\n            if (highlight) {\r\n                this.getDisplay(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].DisplayNames.Game).draw(xy.x, xy.y, draw[0], rot_js__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].toHex(draw[1]), rot_js__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].toHex(draw[2]));\r\n            }\r\n            else {\r\n                this.getDisplay(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].DisplayNames.Game).draw(xy.x, xy.y, draw[0], rot_js__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].toHex(draw[1]));\r\n            }\r\n        }\r\n        else {\r\n            this.getDisplay(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].DisplayNames.Game).draw(xy.x, xy.y, draw[0], rot_js__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].toHex(draw[1]), rot_js__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].toHex(draw[2]));\r\n        }\r\n        return true; // TODO: make this return false if nothing new to draw (cache?)\r\n    }\r\n    convertScreenToMap(screen_xy) {\r\n        // TODO: screen offset goes here\r\n        let offset_xy = new _brew__WEBPACK_IMPORTED_MODULE_1__[\"Coordinate\"](0, 0);\r\n        return screen_xy.add(offset_xy);\r\n    }\r\n    // inventory\r\n    // inventoryDraw(inv: Brew.Inventory, selected_item_index: number) : void {\r\n    //     this.clearDisplay(Brew.Enums.DisplayNames.HUD)\r\n    //     this.drawAll({blackAndWhiteMode: true})\r\n    //     let item_text : string\r\n    //     let keys = inv.getKeys()\r\n    //     let toggleText: string\r\n    //     for (let i = 0; i < keys.length; i++) {\r\n    //         let invkey = keys[i]\r\n    //         let invitem = inv.getInventoryItemByKey(invkey)\r\n    //         if (selected_item_index == i) {\r\n    //             toggleText = \"+ \"\r\n    //         } else {\r\n    //             toggleText = \"- \"\r\n    //         }\r\n    //         this.getDisplay(Brew.Enums.DisplayNames.HUD).draw(0, i, invkey, ROT.Color.toHex(Brew.Color.white))\r\n    //         item_text = toggleText + invitem.item.getDefinition() + invitem.item.getID().toString() + invitem.item.name\r\n    //         item_text = item_text.slice(0, Brew.Config.screen_width_tiles - 2)\r\n    //         this.getDisplay(Brew.Enums.DisplayNames.HUD).drawText(2, i, item_text)\r\n    //         // .draw(0, i, invkey, ROT.Color.toHex(Color.white))\r\n    //     }\r\n    // }\r\n    // context menu\r\n    contextMenuDraw(context_list, selected_item_index) {\r\n        this.clearDisplay(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].DisplayNames.HUD);\r\n        this.drawAll({ blackAndWhiteMode: true });\r\n        let item_text;\r\n        let toggleText;\r\n        for (let i = 0; i < context_list.length; i++) {\r\n            if (selected_item_index == i) {\r\n                toggleText = \"+ \";\r\n            }\r\n            else {\r\n                toggleText = \"- \";\r\n            }\r\n            item_text = toggleText + _brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].ContextMenuItem[context_list[i]];\r\n            item_text = item_text.slice(0, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Config\"].screen_width_tiles - 2);\r\n            this.getDisplay(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].DisplayNames.HUD).drawText(2, i, item_text);\r\n        }\r\n    }\r\n    drawFrame(disp_name, topleft_xy, bottomright_xy, frame_color, bg_frame_color, title) {\r\n        let frDisplay = this.getDisplay(disp_name);\r\n        let frame_hex = rot_js__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].toHex(frame_color);\r\n        let bg_hex = rot_js__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].toHex(bg_frame_color);\r\n        // draw corners\r\n        frDisplay.draw(topleft_xy.x, topleft_xy.y, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Symbols\"].box_topleft, frame_hex, bg_hex);\r\n        frDisplay.draw(bottomright_xy.x, topleft_xy.y, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Symbols\"].box_topright, frame_hex, bg_hex);\r\n        frDisplay.draw(topleft_xy.x, bottomright_xy.y, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Symbols\"].box_bottomleft, frame_hex, bg_hex);\r\n        frDisplay.draw(bottomright_xy.x, bottomright_xy.y, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Symbols\"].box_bottomright, frame_hex, bg_hex);\r\n        // draw left & right sides\r\n        for (let y = topleft_xy.y + 1; y <= bottomright_xy.y - 1; y++) {\r\n            frDisplay.draw(topleft_xy.x, y, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Symbols\"].box_vline, frame_hex, bg_hex);\r\n            frDisplay.draw(bottomright_xy.x, y, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Symbols\"].box_vline, frame_hex, bg_hex);\r\n        }\r\n        // draw top & bottom side\r\n        for (let x = topleft_xy.x + 1; x <= bottomright_xy.x - 1; x++) {\r\n            frDisplay.draw(x, bottomright_xy.y, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Symbols\"].box_hline, frame_hex, bg_hex);\r\n            if (!(title)) {\r\n                frDisplay.draw(x, topleft_xy.y, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Symbols\"].box_hline, frame_hex, bg_hex);\r\n            }\r\n        }\r\n        if (title) {\r\n            // center title\r\n            let frame_width = bottomright_xy.x - topleft_xy.x;\r\n            let half_width = Math.floor(frame_width / 2);\r\n            title = \"[ \" + title + \" ]\";\r\n            let title_x = Math.max(0, Math.floor((frame_width - title.length) / 2));\r\n            for (let x = 1; x < title_x; x++) {\r\n                frDisplay.draw(topleft_xy.x + x, topleft_xy.y, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Symbols\"].box_hline, frame_hex, bg_hex);\r\n            }\r\n            for (let x = 0; x < title.length; x++) {\r\n                frDisplay.draw(topleft_xy.x + title_x + x, topleft_xy.y, title[x], frame_hex, bg_hex);\r\n            }\r\n            for (let x = title_x + title.length + 1; x <= bottomright_xy.x - 1; x++) {\r\n                frDisplay.draw(x, topleft_xy.y, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Symbols\"].box_hline, frame_hex, bg_hex);\r\n            }\r\n        }\r\n    }\r\n    drawVerticalLine(disp_name, x, y_top, y_bottom, line_color, bg_line_color) {\r\n        let frDisplay = this.getDisplay(disp_name);\r\n        let line_hex = rot_js__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].toHex(line_color);\r\n        let bg_hex = rot_js__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].toHex(bg_line_color);\r\n        for (let y = y_top; y <= y_bottom; y++) {\r\n            frDisplay.draw(x, y, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Symbols\"].box_vline, line_hex, bg_hex);\r\n        }\r\n    }\r\n    // generic menu\r\n    genericMenuDraw(title, given_desc, entries, selected_index) {\r\n        // this.clearDisplay(Brew.Enums.DisplayNames.HUD)\r\n        this.drawAll({ blackAndWhiteMode: true });\r\n        // define our work around\r\n        let topleft_xy = new _brew__WEBPACK_IMPORTED_MODULE_1__[\"Coordinate\"](1, 1);\r\n        let bottomright_xy = new _brew__WEBPACK_IMPORTED_MODULE_1__[\"Coordinate\"](_brew__WEBPACK_IMPORTED_MODULE_1__[\"Config\"].screen_width_tiles - 2, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Config\"].screen_height_tiles - 2);\r\n        let full_width = (bottomright_xy.x - topleft_xy.x);\r\n        let half_width = Math.floor(full_width / 2);\r\n        // todo: add menu colors to genericMenu options\r\n        let menu_frame_color = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].goldenrod;\r\n        let desc_height = 3;\r\n        // this.drawFrame(Brew.Enums.DisplayNames.HUD, topleft_xy, bottomright_xy, menu_frame_color, title)\r\n        // this.drawVerticalLine(Brew.Enums.DisplayNames.HUD, half_width, topleft_xy.y + desc_height, bottomright_xy.y - 1, menu_frame_color)\r\n        // draw[1] = Brew.Color.gray\r\n        let bg_frame_color = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].dark_gray;\r\n        this.drawFrame(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].DisplayNames.Game, topleft_xy, bottomright_xy, menu_frame_color, bg_frame_color, title);\r\n        this.drawVerticalLine(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].DisplayNames.Game, half_width, topleft_xy.y + desc_height, bottomright_xy.y - 1, menu_frame_color, bg_frame_color);\r\n        let entry_text;\r\n        let toggleText;\r\n        let description;\r\n        if (given_desc) {\r\n            description = given_desc;\r\n        }\r\n        else {\r\n            description = \"\";\r\n        }\r\n        description = \"%b{\" + rot_js__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].toHex(bg_frame_color) + \"}\" + description;\r\n        // let frDisplay = this.getDisplay(Brew.Enums.DisplayNames.HUD)\r\n        let frDisplay = this.getDisplay(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].DisplayNames.Game);\r\n        frDisplay.drawText(topleft_xy.x + 1, topleft_xy.y + 1, description, full_width - 1);\r\n        let items_start_y = topleft_xy.y + desc_height + 1;\r\n        let selected_entry;\r\n        for (let i = 0; i < entries.length; i++) {\r\n            if (selected_index == i) {\r\n                // toggleText = (i+1).toString() + \">\"\r\n                toggleText = \"> \";\r\n                selected_entry = entries[i];\r\n            }\r\n            else {\r\n                // toggleText = (i+1).toString() + \" \"\r\n                toggleText = \"- \";\r\n            }\r\n            entry_text = toggleText + _brew__WEBPACK_IMPORTED_MODULE_1__[\"Menus\"].getEntryName(entries[i]);\r\n            entry_text = entry_text.slice(0, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Config\"].screen_width_tiles - 2);\r\n            entry_text = \"%b{\" + rot_js__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].toHex(bg_frame_color) + \"}\" + entry_text;\r\n            frDisplay.drawText(topleft_xy.x + 1, items_start_y + i, entry_text);\r\n        }\r\n        if (selected_entry) {\r\n            let entry_desc = \"%b{\" + rot_js__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].toHex(bg_frame_color) + \"}\";\r\n            if (selected_entry.entryDescription) {\r\n                entry_desc += selected_entry.entryDescription;\r\n            }\r\n            frDisplay.drawText(half_width + 1, items_start_y, entry_desc, half_width - 1);\r\n        }\r\n    }\r\n    gameOverDraw() {\r\n        this.clearDisplay(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].DisplayNames.HUD);\r\n        this.drawAll({ blackAndWhiteMode: true });\r\n        this.getDisplay(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].DisplayNames.HUD).drawText(2, 2, \"Congratulations!\");\r\n        this.getDisplay(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].DisplayNames.HUD).drawText(2, 4, \"You have died.\");\r\n    }\r\n    updateDescriptionFooterForPoint(map_xy) {\r\n        let player = this.gm.getPlayer();\r\n        let level = this.gm.getCurrentLevel();\r\n        let desc;\r\n        let footer_disp = this.getDisplay(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].DisplayNames.Footer);\r\n        let in_fov = player.fov.hasAt(map_xy);\r\n        let has_memory = player.memory.hasAt(map_xy);\r\n        if (in_fov || has_memory) {\r\n            if (in_fov) {\r\n                desc = \"You see \";\r\n            }\r\n            else {\r\n                desc = \"You remember seeing \";\r\n            }\r\n            let mob_at = level.monsters.getAt(map_xy);\r\n            let terrain_at = level.terrain.getAt(map_xy);\r\n            let feature_at = level.features.getAt(map_xy);\r\n            let item_at = level.items.getAt(map_xy);\r\n            let portal_at = level.portals.getAt(map_xy);\r\n            // todo: get description() for Things\r\n            footer_disp.clear();\r\n            if (mob_at && in_fov) {\r\n                footer_disp.drawText(0, 0, mob_at.getName());\r\n                let mob_notes = _brew__WEBPACK_IMPORTED_MODULE_1__[\"HUD\"].getCurrentNotes(this.gm).filter((note) => {\r\n                    return note.subject.isSameThing(mob_at);\r\n                });\r\n                this.drawNotesOntoFooter(mob_notes, 1, 2);\r\n            }\r\n            else if (item_at) {\r\n                footer_disp.drawText(0, 0, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Glossary\"].getItemName(item_at));\r\n                let item_desc = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Glossary\"].getItemDescription(item_at);\r\n                footer_disp.drawText(0, 1, item_desc.typeDesc);\r\n                if (item_desc.subTypeDesc) {\r\n                    footer_disp.drawText(0, 2, item_desc.subTypeDesc);\r\n                }\r\n                // } else if (overhead_at) {\r\n                //     desc += Brew.Definitions.AboveType[overhead_at.getDefinition()] + \" overhead\"\r\n            }\r\n            else if (feature_at) {\r\n                footer_disp.drawText(0, 0, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Glossary\"].getFeatureName(feature_at));\r\n                footer_disp.drawText(0, 1, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Glossary\"].getFeatureDescription(feature_at));\r\n            }\r\n            else {\r\n                footer_disp.drawText(0, 0, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Definitions\"].TerrainType[terrain_at.getDefinition()]);\r\n            }\r\n        }\r\n        // todo: eventually make this into a canvas / ROT display element (?)\r\n        // let divDebug = <HTMLDivElement> (document.getElementById(\"id_div_debug\"))\r\n        // divDebug.innerHTML = `<p>${desc}</p>`\r\n        // this.getDisplay(Brew.Enums.DisplayNames.Footer).drawText(0, 0, desc)\r\n        // log some debug stuff\r\n        // console.log(`-- debug info for ${map_xy.x}, ${map_xy.y} --`)\r\n        // console.log(\"path to player\", this.gm.pathmaps.getPathmap(Brew.Enums.PathmapCacheType.ToPlayer_Walk).field.getAt(map_xy))\r\n        // console.log(\"path from player\", this.gm.pathmaps.getPathmap(Brew.Enums.PathmapCacheType.FromPlayer_Walk).field.getAt(map_xy))\r\n        // console.log(\"flypath to player\", this.gm.pathmaps.getPathmap(Brew.Enums.PathmapCacheType.ToPlayer_Fly).field.getAt(map_xy))\r\n        // console.log(\"flypath from player\", this.gm.pathmaps.getPathmap(Brew.Enums.PathmapCacheType.FromPlayer_Fly).field.getAt(map_xy))\r\n    }\r\n    drawPowerInfo() {\r\n        // draw a strip across the bottom of the footer with the power info\r\n        let powers = this.gm.getPlayer().getPowers();\r\n        let current_row = 2;\r\n        let col = 0;\r\n        for (let pow of powers.listOfPowers) {\r\n            let line_desc = \"[ \" + _brew__WEBPACK_IMPORTED_MODULE_1__[\"Glossary\"].getPowerShortName(pow) + \" \" + pow.charge_stat.getCurrentLevel() + \" ]\";\r\n            this.getDisplay(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].DisplayNames.Footer).drawText(col, current_row, line_desc);\r\n            col += line_desc.length;\r\n        }\r\n    }\r\n    drawFooter() {\r\n        // this.clearDisplay(Brew.Enums.DisplayNames.Footer)\r\n        this.getDisplay(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].DisplayNames.Footer).clear();\r\n        this.drawPowerInfo();\r\n        // draw all notes a the bottom except behavioral ones\r\n        let hud_notes = _brew__WEBPACK_IMPORTED_MODULE_1__[\"HUD\"].getCurrentNotes(this.gm);\r\n        this.drawNotesOntoFooter(hud_notes, 0, 2);\r\n    }\r\n    drawHeader() {\r\n        // this.clearDisplay(Brew.Enums.DisplayNames.Footer)\r\n        let header_disp = this.getDisplay(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].DisplayNames.Header);\r\n        header_disp.clear();\r\n        let score_text = \"SCORE: \" + this.gm.getPlayer().score.getCurrentLevel();\r\n        header_disp.drawText(0, 0, score_text);\r\n        let level_text = \"AREA: \" + this.gm.getCurrentLevel().depth;\r\n        let x = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Config\"].map_width_tiles - level_text.length;\r\n        header_disp.drawText(x - 1, 0, level_text);\r\n        let middle_text = \"Tank Control! (? for HELP)\";\r\n        x = (_brew__WEBPACK_IMPORTED_MODULE_1__[\"Config\"].map_width_tiles / 2) - (middle_text.length / 2);\r\n        header_disp.drawText(x, 0, middle_text);\r\n        // this.drawPowerInfo()\r\n        // draw all notes a the bottom except behavioral ones\r\n        // let hud_notes = Brew.HUD.getCurrentNotes(this.gm)\r\n        // this.drawNotesOntoFooter(hud_notes, 0, 2)\r\n    }\r\n    // headsUpDisplayDraw(hudDisplayType : Brew.Enums.BrewHeadsUpDisplayType) {\r\n    headsUpDisplayDraw(pageOfNotes) {\r\n        let level = this.gm.getCurrentLevel();\r\n        let letter;\r\n        // this.clearDisplay(Brew.Enums.DisplayNames.HUD)\r\n        this.drawAll({ blackAndWhiteMode: true });\r\n        // treat letters as a grid\r\n        let hud_lettergrid = pageOfNotes.grid; // Brew.HUD.getHUDLetterGrid(this.gm, listOfNotes)\r\n        // draw the letter grid\r\n        hud_lettergrid.getAllCoordinates().forEach((xy, index) => {\r\n            letter = hud_lettergrid.getAt(xy).char;\r\n            // this.getDisplay(Brew.Enums.DisplayNames.HUD).draw(xy.x, xy.y, letter)\r\n            this.getDisplay(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].DisplayNames.Game).draw(xy.x, xy.y, letter, rot_js__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].toHex(hud_lettergrid.getAt(xy).color));\r\n        });\r\n    }\r\n    drawNotesOntoFooter(notes_list, start_row, max_rows) {\r\n        let new_text;\r\n        let running_width = 0;\r\n        let current_row = start_row;\r\n        let max_width = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Config\"].screen_width_tiles;\r\n        let text_color;\r\n        if (_brew__WEBPACK_IMPORTED_MODULE_1__[\"Debug\"].BOSS_MODE) {\r\n            text_color = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].black;\r\n        }\r\n        else {\r\n            text_color = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].normal;\r\n        }\r\n        for (let i = 0; i < notes_list.length; i++) {\r\n            new_text = notes_list[i].getNoteText() + \" \";\r\n            if ((running_width + new_text.length) > max_width) {\r\n                current_row += 1;\r\n                running_width = 0;\r\n            }\r\n            if (current_row >= (start_row + max_rows)) {\r\n                return;\r\n            }\r\n            for (let w = 0; w < new_text.length; w++) {\r\n                let write_color;\r\n                if ((w == 0) && (notes_list[i].subject.color)) {\r\n                    write_color = (notes_list[i].subject.color);\r\n                }\r\n                else {\r\n                    write_color = text_color;\r\n                }\r\n                this.getDisplay(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].DisplayNames.Footer).draw(running_width + w, current_row, new_text[w], rot_js__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].toHex(write_color));\r\n            }\r\n            running_width += new_text.length;\r\n        }\r\n    }\r\n    drawPopupMessage(msg_text, location_xy, color, delay) {\r\n        if (!(delay)) {\r\n            delay = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Config\"].popup_msg_speed;\r\n        }\r\n        let hud_display = this.getDisplay(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].DisplayNames.HUD);\r\n        let max_width = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Config\"].screen_width_tiles;\r\n        let msg_width = Math.min(max_width, msg_text.length);\r\n        let msg_text_trimmed = msg_text; //.substring(0, msg_width)\r\n        let blank_letter_grid = new _brew__WEBPACK_IMPORTED_MODULE_1__[\"GridOfThings\"]();\r\n        let success = _brew__WEBPACK_IMPORTED_MODULE_1__[\"HUD\"].placeWordsOnLetterGrid(blank_letter_grid, msg_text_trimmed, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].white, location_xy);\r\n        blank_letter_grid.getAllCoordinates().forEach((xy, index) => {\r\n            let letter = blank_letter_grid.getAt(xy).char;\r\n            // this.getDisplay(Brew.Enums.DisplayNames.HUD).draw(xy.x, xy.y, letter)\r\n            this.getDisplay(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].DisplayNames.HUD).draw(xy.x, xy.y, letter, rot_js__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].toHex(blank_letter_grid.getAt(xy).color));\r\n        });\r\n        // hud_display.drawText(location_xy.x, location_xy.y, msg_text, max_width)\r\n        setTimeout(() => {\r\n            // hud_display.clearRect_Tiles(location_xy.x, location_xy.y, msg_width, 1)\r\n            blank_letter_grid.getAllCoordinates().forEach((xy, index) => {\r\n                hud_display.clearRect_Tiles(xy.x, xy.y, 1, 1);\r\n            });\r\n        }, delay);\r\n    }\r\n    drawHelpMenu(helpMsgIndex) {\r\n        this.drawAll({ blackAndWhiteMode: true });\r\n        // define our work around\r\n        let topleft_xy = new _brew__WEBPACK_IMPORTED_MODULE_1__[\"Coordinate\"](1, 1);\r\n        let bottomright_xy = new _brew__WEBPACK_IMPORTED_MODULE_1__[\"Coordinate\"](_brew__WEBPACK_IMPORTED_MODULE_1__[\"Config\"].screen_width_tiles - 2, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Config\"].screen_height_tiles - 2);\r\n        let full_width = (bottomright_xy.x - topleft_xy.x);\r\n        let half_width = Math.floor(full_width / 2);\r\n        let menu_frame_color = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].goldenrod;\r\n        let bg_frame_color = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].dark_gray;\r\n        this.drawFrame(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].DisplayNames.Game, topleft_xy, bottomright_xy, menu_frame_color, bg_frame_color, \"HELP\");\r\n        let bgcolor_text = \"%b{\" + rot_js__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].toHex(bg_frame_color) + \"}\";\r\n        let frDisplay = this.getDisplay(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].DisplayNames.Game);\r\n        let current_y = topleft_xy.y + 1;\r\n        let max_y = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Config\"].map_height_tiles - 2;\r\n        while (helpMsgIndex < _brew__WEBPACK_IMPORTED_MODULE_1__[\"Tank\"].helpMessages.length) {\r\n            let line_count = frDisplay.drawText(topleft_xy.x + 1, current_y, bgcolor_text + _brew__WEBPACK_IMPORTED_MODULE_1__[\"Tank\"].helpMessages[helpMsgIndex], full_width - 1);\r\n            if ((current_y + line_count + 1) > max_y) {\r\n                break;\r\n            }\r\n            current_y += line_count + 1;\r\n            helpMsgIndex += 1;\r\n        }\r\n    }\r\n}\r\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvYnJld19nYW1lL2Rpc3BsYXkudHM/NDUwYyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUE2QjtBQUNFO0FBSy9CLGlCQUFrQixTQUFRLDhDQUFXO0lBQXJDOztRQUNZLGVBQVUsR0FBK0IsSUFBSTtJQXdDekQsQ0FBQztJQXRDRyxRQUFRO1FBQ0osTUFBTSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsWUFBWSxFQUFFLENBQUMsVUFBVSxDQUFDLFlBQVksQ0FBQyxPQUFPLENBQUMsQ0FBQyxLQUFLLENBQUM7SUFDN0UsQ0FBQztJQUVELFNBQVM7UUFDTCxNQUFNLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxZQUFZLEVBQUUsQ0FBQyxVQUFVLENBQUMsWUFBWSxDQUFDLFFBQVEsQ0FBQyxDQUFDLEtBQUssQ0FBQztJQUM5RSxDQUFDO0lBRUQsWUFBWTtRQUNSLE1BQU0sQ0FBQyxJQUFJLENBQUMsUUFBUSxFQUFFLEdBQUcsNENBQVcsQ0FBQyxrQkFBa0I7SUFDM0QsQ0FBQztJQUVELGFBQWE7UUFDVCxNQUFNLENBQUMsSUFBSSxDQUFDLFNBQVMsRUFBRSxHQUFHLDRDQUFXLENBQUMsbUJBQW1CO0lBQzdELENBQUM7SUFFRCxTQUFTLENBQUMsQ0FBUyxFQUFFLENBQVMsRUFBRSxLQUFhLEVBQUUsTUFBYztRQUN6RCxxREFBcUQ7UUFDckQsa0RBQWtEO1FBQ2xELEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ3JCLHNEQUFzRDtZQUN0RCw0Q0FBNEM7WUFDNUMsSUFBSSxDQUFDLFVBQVUsR0FBdUIsSUFBSSxDQUFDLFlBQVksRUFBRyxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUM7UUFDL0UsQ0FBQztRQUdELElBQUksQ0FBQyxVQUFVLENBQUMsU0FBUyxDQUFDLENBQUMsR0FBRyxLQUFLLEVBQUUsQ0FBQyxHQUFHLE1BQU0sRUFBRSxLQUFLLEVBQUUsTUFBTSxDQUFDO0lBQ25FLENBQUM7SUFFRCxlQUFlLENBQUMsQ0FBUyxFQUFFLENBQVMsRUFBRSxjQUFzQixFQUFFLGVBQXVCO1FBQ2pGLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ3JCLElBQUksQ0FBQyxVQUFVLEdBQXVCLElBQUksQ0FBQyxZQUFZLEVBQUcsQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDO1FBQy9FLENBQUM7UUFDRCxJQUFJLFVBQVUsR0FBRyxJQUFJLENBQUMsWUFBWSxFQUFFO1FBQ3BDLElBQUksV0FBVyxHQUFHLElBQUksQ0FBQyxhQUFhLEVBQUU7UUFFdEMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxTQUFTLENBQUMsQ0FBQyxHQUFHLFVBQVUsRUFBRSxDQUFDLEdBQUcsV0FBVyxFQUFFLGNBQWMsR0FBRyxVQUFVLEVBQUUsZUFBZSxHQUFHLFdBQVcsQ0FBQztJQUMxSCxDQUFDO0NBQ0o7QUFFSztJQVVGLFlBQVksRUFBbUIsRUFBRSxhQUE4QjtRQUMzRCxJQUFJLENBQUMsWUFBWSxHQUFHLEVBQUU7UUFDdEIsSUFBSSxDQUFDLEVBQUUsR0FBRyxFQUFFO1FBQ1osSUFBSSxDQUFDLFVBQVUsR0FBRyxJQUFJLGtEQUFpQixFQUEyQjtRQUVsRSx5QkFBeUI7UUFDekIsSUFBSSxDQUFDLFVBQVUsQ0FBQyxhQUFhLEVBQUUsNENBQVcsQ0FBQyxrQkFBa0IsRUFBRSw0Q0FBVyxDQUFDLG1CQUFtQixDQUFDO1FBRS9GLDJIQUEySDtRQUMzSCw4SEFBOEg7UUFDOUgsSUFBSSxDQUFDLGFBQWEsR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQywyQ0FBVSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsQ0FBQyxZQUFZLEVBQUUsQ0FBQyxVQUFVLENBQUMsWUFBWSxDQUFDLE9BQU8sQ0FBQyxDQUFDLEtBQUssQ0FBQyxHQUFHLDRDQUFXLENBQUMsa0JBQWtCO1FBQ2pLLElBQUksQ0FBQyxjQUFjLEdBQUcsTUFBTSxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsMkNBQVUsQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLENBQUMsWUFBWSxFQUFFLENBQUMsVUFBVSxDQUFDLFlBQVksQ0FBQyxRQUFRLENBQUMsQ0FBQyxLQUFLLENBQUMsR0FBRyw0Q0FBVyxDQUFDLG1CQUFtQjtJQUV4SyxDQUFDO0lBRUQsVUFBVSxDQUFDLGFBQTZCLEVBQUUsS0FBYSxFQUFFLE1BQWM7UUFFbkUsMEVBQTBFO1FBQzFFLEVBQUUsQ0FBQyxDQUFDLGFBQWEsQ0FBQyxRQUFRLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDcEMsT0FBTyxhQUFhLENBQUMsVUFBVSxFQUFFLENBQUM7Z0JBQzlCLGFBQWEsQ0FBQyxXQUFXLENBQUMsYUFBYSxDQUFDLFVBQVUsQ0FBQztZQUN2RCxDQUFDO1FBQ0wsQ0FBQztRQUVELElBQUksUUFBaUI7UUFDckIsRUFBRSxDQUFDLENBQUMsMkNBQVUsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDO1lBQ3ZCLFFBQVEsR0FBRyxhQUFhO1FBQzVCLENBQUM7UUFBQyxJQUFJLENBQUMsQ0FBQztZQUNKLFFBQVEsR0FBRyw0Q0FBUyxDQUFDLEtBQUssQ0FBQywyQ0FBVSxDQUFDLFFBQVEsQ0FBQztRQUNuRCxDQUFDO1FBQ0QscUJBQXFCO1FBQ3JCLElBQUksZUFBMEI7UUFDOUIsZUFBZSxHQUFHLDJDQUFVLENBQUMsYUFBYTtRQUMxQyxJQUFJLFNBQVMsR0FBRyw0Q0FBVyxDQUFDLFNBQVM7UUFFckMsSUFBSSxXQUFXLEdBQUcsSUFBSSxXQUFXLENBQUM7WUFDOUIsS0FBSyxFQUFFLEtBQUs7WUFDWixNQUFNLEVBQUUsTUFBTTtZQUNkLE1BQU0sRUFBRSxDQUFDO1lBQ1QsT0FBTyxFQUFFLElBQUk7WUFDYixRQUFRLEVBQUUsU0FBUztZQUNuQixFQUFFLEVBQUUsUUFBUTtZQUNaLHFCQUFxQjtZQUNyQixnQkFBZ0IsRUFBRSxLQUFLO1NBQzFCLENBQUM7UUFFRixJQUFJLFdBQVcsR0FBc0IsQ0FBQyxXQUFXLENBQUMsWUFBWSxFQUFFLENBQUM7UUFDakUsYUFBYSxDQUFDLFdBQVcsQ0FBQyxXQUFXLENBQUM7UUFDdEMsSUFBSSxDQUFDLFVBQVUsQ0FBQywyQ0FBVSxDQUFDLFlBQVksQ0FBQyxJQUFJLEVBQUUsV0FBVyxDQUFDO1FBRTFELHFDQUFxQztRQUNyQyxJQUFJLFVBQVUsR0FBRyxJQUFJLFdBQVcsQ0FBQztZQUM3QixLQUFLLEVBQUUsS0FBSztZQUNaLE1BQU0sRUFBRSxNQUFNO1lBQ2QsTUFBTSxFQUFFLENBQUM7WUFDVCxPQUFPLEVBQUUsSUFBSTtZQUNiLFFBQVEsRUFBRSxTQUFTO1lBQ25CLDBDQUEwQztZQUMxQyxFQUFFLEVBQUUsYUFBYTtZQUNqQixnQkFBZ0IsRUFBRSxLQUFLO1NBQzFCLENBQUM7UUFFRixJQUFJLFVBQVUsR0FBc0IsQ0FBQyxVQUFVLENBQUMsWUFBWSxFQUFFLENBQUM7UUFDL0QsYUFBYSxDQUFDLFdBQVcsQ0FBQyxVQUFVLENBQUM7UUFDckMsSUFBSSxVQUFVLEdBQUcsVUFBVSxDQUFDLGFBQWEsRUFBRTtRQUUzQyxVQUFVLENBQUMsWUFBWSxDQUFDLE9BQU8sRUFBRSw0QkFBNEIsVUFBVSxXQUFXLENBQUM7UUFDbkYsSUFBSSxDQUFDLFVBQVUsQ0FBQywyQ0FBVSxDQUFDLFlBQVksQ0FBQyxHQUFHLEVBQUUsVUFBVSxDQUFDO1FBRXhELFlBQVk7UUFDWixFQUFFLENBQUMsQ0FBQywyQ0FBVSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUM7WUFDdkIsUUFBUSxHQUFHLDRDQUFTLENBQUMsS0FBSyxDQUFDLDJDQUFVLENBQUMsS0FBSyxDQUFDLGtCQUFnQjtRQUNoRSxDQUFDO1FBQUMsSUFBSSxDQUFDLENBQUM7WUFDSixRQUFRLEdBQUcsNENBQVMsQ0FBQyxLQUFLLENBQUMsMkNBQVUsQ0FBQyxRQUFRLENBQUM7UUFDbkQsQ0FBQztRQUVELFNBQVM7UUFDVCxJQUFJLGFBQWEsR0FBRyxJQUFJLFdBQVcsQ0FBQztZQUNoQyxLQUFLLEVBQUUsS0FBSztZQUNaLE1BQU0sRUFBRSxDQUFDO1lBQ1QsTUFBTSxFQUFFLENBQUM7WUFDVCxPQUFPLEVBQUUsSUFBSTtZQUNiLFFBQVEsRUFBRSxTQUFTO1lBQ25CLEVBQUUsRUFBRSxRQUFRO1lBQ1osZ0JBQWdCLEVBQUUsS0FBSztTQUMxQixDQUFDO1FBRUYsSUFBSSxVQUFVLEdBQUcsUUFBUSxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUM7UUFDOUMsVUFBVSxDQUFDLFlBQVksQ0FBQyxJQUFJLEVBQUUsZUFBZSxDQUFDO1FBQzlDLFVBQVUsQ0FBQyxXQUFXLENBQUMsYUFBYSxDQUFDLFlBQVksRUFBRSxDQUFDO1FBQ3BELGFBQWEsQ0FBQyxXQUFXLENBQUMsVUFBVSxDQUFDO1FBQ3JDLElBQUksQ0FBQyxVQUFVLENBQUMsMkNBQVUsQ0FBQyxZQUFZLENBQUMsTUFBTSxFQUFFLGFBQWEsQ0FBQztRQUU5RCxTQUFTO1FBQ1QsSUFBSSxhQUFhLEdBQUcsSUFBSSxXQUFXLENBQUM7WUFDaEMsS0FBSyxFQUFFLEtBQUs7WUFDWixNQUFNLEVBQUUsQ0FBQztZQUNULE1BQU0sRUFBRSxDQUFDO1lBQ1QsT0FBTyxFQUFFLElBQUk7WUFDYixRQUFRLEVBQUUsU0FBUztZQUNuQixFQUFFLEVBQUUsUUFBUTtZQUNaLGdCQUFnQixFQUFFLEtBQUs7U0FDMUIsQ0FBQztRQUVGLElBQUksVUFBVSxHQUFHLFFBQVEsQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDO1FBQzlDLFVBQVUsQ0FBQyxZQUFZLENBQUMsSUFBSSxFQUFFLGVBQWUsQ0FBQztRQUM5QyxVQUFVLENBQUMsV0FBVyxDQUFDLGFBQWEsQ0FBQyxZQUFZLEVBQUUsQ0FBQztRQUNwRCxhQUFhLENBQUMsWUFBWSxDQUFDLFVBQVUsRUFBRSxXQUFXLENBQUM7UUFDbkQsd0NBQXdDO1FBQ3hDLElBQUksQ0FBQyxVQUFVLENBQUMsMkNBQVUsQ0FBQyxZQUFZLENBQUMsTUFBTSxFQUFFLGFBQWEsQ0FBQztJQUVsRSxDQUFDO0lBR0QscUJBQXFCO0lBQ3JCLFVBQVUsQ0FBQyxJQUE2QixFQUFFLElBQWlCO1FBQ3ZELElBQUksQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLEdBQUcsSUFBSTtJQUNsQyxDQUFDO0lBRUQsVUFBVSxDQUFDLElBQTZCO1FBQ3BDLDJCQUEyQjtRQUMzQixFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxJQUFJLElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDL0IsTUFBTSxJQUFJLFVBQVUsQ0FBQyxpQ0FBaUMsSUFBSSxFQUFFLENBQUM7UUFDakUsQ0FBQztRQUVELE1BQU0sQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ25DLENBQUM7SUFFRCxRQUFRO1FBQ0osR0FBRyxDQUFDLENBQUMsSUFBSSxJQUFJLElBQUksSUFBSSxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUM7WUFDakMsSUFBSSxXQUFXLEdBQUcsMkNBQVUsQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDO1lBQy9DLElBQUksQ0FBQyxZQUFZLENBQUMsV0FBVyxDQUFDO1FBQ2xDLENBQUM7SUFDTCxDQUFDO0lBRUQsWUFBWSxDQUFDLElBQTZCO1FBQ3RDLElBQUksT0FBTyxHQUFHLElBQUksQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDO1FBQ25DLE9BQU8sQ0FBQyxTQUFTLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxPQUFPLENBQUMsUUFBUSxFQUFFLEVBQUUsT0FBTyxDQUFDLFNBQVMsRUFBRSxDQUFDO1FBQ2hFLGtCQUFrQjtJQUV0QixDQUFDO0lBRUQsY0FBYyxDQUFDLElBQTZCLEVBQUUsQ0FBUyxFQUFFLENBQVM7UUFDOUQsSUFBSSxPQUFPLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUM7UUFDbkMsS0FBSztRQUNMLE9BQU8sQ0FBQyxTQUFTLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxJQUFJLENBQUMsYUFBYSxFQUFFLElBQUksQ0FBQyxjQUFjLENBQUM7SUFDcEUsQ0FBQztJQUVELHNCQUFzQjtJQUN0QixPQUFPLENBQUMsZUFBMkM7UUFDL0MsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyw0Q0FBVyxDQUFDLGtCQUFrQixFQUFFLENBQUMsRUFBRSxFQUFFLENBQUM7WUFDdEQsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyw0Q0FBVyxDQUFDLG1CQUFtQixFQUFFLENBQUMsRUFBRSxFQUFFLENBQUM7Z0JBQ3ZELElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxnREFBZSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxlQUFlLENBQUM7WUFDM0QsQ0FBQztRQUNMLENBQUM7SUFDTCxDQUFDO0lBRUQsTUFBTSxDQUFDLEVBQW1CLEVBQUUsZUFBNkM7UUFFckUsSUFBSSxJQUFZO1FBQ2hCLElBQUksS0FBSyxHQUFHLElBQUksQ0FBQyxFQUFFLENBQUMsZUFBZSxFQUFFO1FBRXJDLEVBQUUsQ0FBQyxDQUFDLDJDQUFVLENBQUMsYUFBYSxDQUFDLENBQUMsQ0FBQztZQUMzQixJQUFJLFNBQWtCO1lBQ3RCLElBQUksV0FBb0I7WUFFeEIsSUFBSSxVQUFVLEdBQUcsMkNBQVUsQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUM7WUFDekQsRUFBRSxDQUFDLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQztnQkFDakIseURBQXlEO2dCQUNyRCwrQ0FBK0M7Z0JBQy9DLHFDQUFxQztnQkFDckMsbUNBQW1DO2dCQUNuQyxxQ0FBcUM7Z0JBQ3JDLHlCQUF5QjtnQkFDekIsc0NBQXNDO2dCQUN0QywrQ0FBK0M7Z0JBQy9DLHFDQUFxQztnQkFFckMsRUFBRSxDQUFDLENBQUMsVUFBVSxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7b0JBQ2pCLFNBQVMsR0FBRyxDQUFDLFVBQVUsR0FBRywyQ0FBVSxDQUFDLGFBQWEsQ0FBQyxTQUFTLENBQUM7b0JBQzdELFdBQVcsR0FBRyw0Q0FBUyxDQUFDLFdBQVcsQ0FBQywyQ0FBVSxDQUFDLElBQUksRUFBRSwyQ0FBVSxDQUFDLEtBQUssRUFBRSxDQUFDLEdBQUcsU0FBUyxDQUFDO2dCQUV6RixDQUFDO2dCQUFDLElBQUksQ0FBQyxDQUFDO29CQUNKLFNBQVMsR0FBRyxDQUFDLFVBQVUsR0FBRywyQ0FBVSxDQUFDLGFBQWEsQ0FBQyxTQUFTLENBQUM7b0JBQzdELFdBQVcsR0FBRyw0Q0FBUyxDQUFDLFdBQVcsQ0FBQywyQ0FBVSxDQUFDLElBQUksRUFBRSwyQ0FBVSxDQUFDLEtBQUssRUFBRSxTQUFTLENBQUM7Z0JBQ3JGLENBQUM7WUFFTCxDQUFDO1lBQUMsSUFBSSxDQUFDLENBQUM7Z0JBQ0osV0FBVyxHQUFHLDJDQUFVLENBQUMsTUFBTTtZQUNuQyxDQUFDO1lBRUQsSUFBSSxDQUFDLFVBQVUsQ0FBQywyQ0FBVSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxFQUFFLEdBQUcsRUFBRSw0Q0FBUyxDQUFDLEtBQUssQ0FBQywyQ0FBVSxDQUFDLEtBQUssQ0FBQyxFQUFFLDRDQUFTLENBQUMsS0FBSyxDQUFDLFdBQVcsQ0FBQyxDQUFDO1lBRXBJLE1BQU0sQ0FBQyxJQUFJO1FBRWYsQ0FBQztRQUVELGdCQUFnQjtRQUNoQixJQUFJLE1BQWdCO1FBQ3BCLE1BQU0sR0FBRyxJQUFJLENBQUMsRUFBRSxDQUFDLFNBQVMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDO1FBRTFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDWiw0QkFBNEI7WUFDNUIsSUFBSSxHQUFHLEdBQUcsSUFBSSxDQUFDLEVBQUUsQ0FBQyxTQUFTLEVBQUUsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQztZQUM5QywyREFBMkQ7WUFDM0QsRUFBRSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztnQkFDTixnQkFBZ0I7Z0JBQ2hCLElBQUksR0FBRyxDQUFDLEdBQUcsQ0FBQyxJQUFJLEVBQUUsMkNBQVUsQ0FBQyxNQUFNLEVBQUUsMkNBQVUsQ0FBQyxTQUFTLENBQUM7WUFFOUQsQ0FBQztZQUFDLElBQUksQ0FBQyxDQUFDO2dCQUNKLGdCQUFnQjtnQkFDaEIsSUFBSSxHQUFHLENBQUMsR0FBRyxFQUFFLDJDQUFVLENBQUMsS0FBSyxFQUFFLDJDQUFVLENBQUMsYUFBYSxDQUFDO1lBQzVELENBQUM7UUFFTCxDQUFDO1FBQUMsSUFBSSxDQUFDLENBQUM7WUFDSixVQUFVO1lBRVYsYUFBYTtZQUNiLElBQUksT0FBTyxHQUFHLEtBQUssQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQztZQUVyQyxFQUFFLENBQUMsQ0FBQyxPQUFPLElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQztnQkFDbEIsV0FBVztZQUNmLENBQUM7WUFFRCxJQUFJLEdBQUcsQ0FBQyxPQUFPLENBQUMsSUFBSSxFQUFFLE9BQU8sQ0FBQyxLQUFLLEVBQUUsT0FBTyxDQUFDLFFBQVEsQ0FBQztZQUV0RCxjQUFjO1lBQ2QsSUFBSSxPQUFPLEdBQUcsS0FBSyxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDO1lBQ3RDLElBQUksU0FBUyxHQUFHLEtBQUssQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQyxFQUFDLHVDQUF1QztZQUMvRSxFQUFFLENBQUMsQ0FBQyxPQUFPLElBQUksQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7Z0JBQ3hELElBQUksQ0FBQyxDQUFDLENBQUMsR0FBRyxPQUFPLENBQUMsSUFBSTtnQkFDdEIsRUFBRSxDQUFDLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUM7b0JBQ2hCLElBQUksQ0FBQyxDQUFDLENBQUMsR0FBRyxPQUFPLENBQUMsS0FBSztnQkFDM0IsQ0FBQztnQkFFRCxFQUFFLENBQUMsQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQztvQkFDbkIsSUFBSSxDQUFDLENBQUMsQ0FBQyxHQUFHLE9BQU8sQ0FBQyxRQUFRO2dCQUM5QixDQUFDO1lBQ0wsQ0FBQztZQUVELFdBQVc7WUFDWCxJQUFJLElBQUksR0FBRyxLQUFLLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUM7WUFDaEMsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztnQkFDUCxJQUFJLENBQUMsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLElBQUk7Z0JBQ25CLElBQUksQ0FBQyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsS0FBSztZQUN4QixDQUFDO1lBR0QsY0FBYztZQUNkLElBQUksR0FBRyxHQUFHLEtBQUssQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQztZQUNsQyxFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO2dCQUNOLElBQUksQ0FBQyxDQUFDLENBQUMsR0FBRyxHQUFHLENBQUMsSUFBSTtnQkFDbEIsSUFBSSxDQUFDLENBQUMsQ0FBQyxHQUFHLEdBQUcsQ0FBQyxLQUFLO2dCQUVuQixFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLDJDQUFVLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQztvQkFDdkMsSUFBSSxDQUFDLENBQUMsQ0FBQyxHQUFHLDJDQUFVLENBQUMsS0FBSztnQkFDOUIsQ0FBQztnQkFFRCxJQUFJLFlBQVksR0FBRywrQ0FBYyxDQUFDLG9CQUFvQixDQUFDLElBQUksQ0FBQyxFQUFFLEVBQUUsR0FBRyxFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsU0FBUyxFQUFFLENBQUM7Z0JBQ3pGLEVBQUUsQ0FBQyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUM7b0JBQ2YsSUFBSSxDQUFDLENBQUMsQ0FBQyxHQUFHLDJDQUFVLENBQUMsR0FBRztnQkFDNUIsQ0FBQztZQUVMLENBQUM7WUFFRCxjQUFjO1lBQ2QsSUFBSSxJQUFJLEdBQUcsS0FBSyxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDO1lBQ2hDLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7Z0JBQ1AsSUFBSSxDQUFDLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxJQUFJO2dCQUNuQixJQUFJLENBQUMsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLEtBQUs7WUFDeEIsQ0FBQztZQUVELHNCQUFzQjtZQUN0QixJQUFJLEVBQUUsR0FBRyxLQUFLLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUM7WUFDOUIsRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztnQkFDTCxJQUFJLENBQUMsQ0FBQyxDQUFDLEdBQUcsRUFBRSxDQUFDLElBQUk7Z0JBQ2pCLElBQUksQ0FBQyxDQUFDLENBQUMsR0FBRyxFQUFFLENBQUMsS0FBSztZQUN0QixDQUFDO1lBRUQsZ0JBQWdCO1lBQ2hCLElBQUksUUFBUSxHQUFpQyxJQUFJLENBQUMsRUFBRSxDQUFDLFNBQVMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDO1lBQzlFLEVBQUUsQ0FBQyxDQUFDLFFBQVEsSUFBSSwyQ0FBVSxDQUFDLGdCQUFnQixDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUM7Z0JBQ2xELElBQUksQ0FBQyxDQUFDLENBQUMsR0FBRywyQ0FBVSxDQUFDLGdCQUFnQjtZQUN6QyxDQUFDO1FBRUwsQ0FBQztRQUVELFlBQVk7UUFDWixFQUFFLENBQUMsQ0FBQywyQ0FBVSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUM7WUFDdkIsSUFBSSxDQUFDLENBQUMsQ0FBQyxHQUFHLDJDQUFVLENBQUMsS0FBSztZQUUxQiw2RUFBNkU7WUFDN0UsSUFBSSxDQUFDLENBQUMsQ0FBQyxHQUFHLDRDQUFTLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsRUFBRSwyQ0FBVSxDQUFDLEtBQUssRUFBRSxNQUFNLENBQUM7UUFDdEUsQ0FBQztRQUVELGFBQWE7UUFDYixJQUFJLFNBQVMsR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUM7UUFDekMsRUFBRSxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQztZQUNaLHFJQUFxSTtZQUNySSxJQUFJLENBQUMsQ0FBQyxDQUFDLEdBQUcsU0FBUyxDQUFDLEtBQUs7UUFDN0IsQ0FBQztRQUFDLElBQUksQ0FBQyxDQUFDO1lBQ0osa0tBQWtLO1FBQ3RLLENBQUM7UUFFRCxFQUFFLENBQUMsQ0FBQyxDQUFDLGVBQWUsQ0FBQyxJQUFJLENBQUMsZUFBZSxDQUFDLGlCQUFpQixDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQzNELElBQUksQ0FBQyxDQUFDLENBQUMsR0FBRywyQ0FBVSxDQUFDLElBQUk7WUFDekIsSUFBSSxDQUFDLENBQUMsQ0FBQyxHQUFHLDJDQUFVLENBQUMsU0FBUztRQUNsQyxDQUFDO1FBRUQsRUFBRSxDQUFDLENBQUMsMkNBQVUsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDO1lBRXZCLElBQUksQ0FBQyxjQUFjLENBQUMsMkNBQVUsQ0FBQyxZQUFZLENBQUMsSUFBSSxFQUFFLEVBQUUsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQztZQUM3RCxFQUFFLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDO2dCQUNaLElBQUksQ0FBQyxVQUFVLENBQUMsMkNBQVUsQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUMsRUFBRSxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsNENBQVMsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsNENBQVMsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDL0gsQ0FBQztZQUFDLElBQUksQ0FBQyxDQUFDO2dCQUNKLElBQUksQ0FBQyxVQUFVLENBQUMsMkNBQVUsQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUMsRUFBRSxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsNENBQVMsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDckcsQ0FBQztRQUdMLENBQUM7UUFBQyxJQUFJLENBQUMsQ0FBQztZQUNKLElBQUksQ0FBQyxVQUFVLENBQUMsMkNBQVUsQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUMsRUFBRSxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsNENBQVMsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsNENBQVMsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDL0gsQ0FBQztRQUdELE1BQU0sQ0FBQyxJQUFJLEVBQUMsK0RBQStEO0lBQy9FLENBQUM7SUFFRCxrQkFBa0IsQ0FBRSxTQUEwQjtRQUMxQyxnQ0FBZ0M7UUFDaEMsSUFBSSxTQUFTLEdBQUcsSUFBSSxnREFBZSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUM7UUFFekMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsU0FBUyxDQUFDO0lBQ25DLENBQUM7SUFFRCxZQUFZO0lBQ1osMkVBQTJFO0lBQzNFLHFEQUFxRDtJQUNyRCw4Q0FBOEM7SUFFOUMsNkJBQTZCO0lBQzdCLCtCQUErQjtJQUMvQiw2QkFBNkI7SUFFN0IsOENBQThDO0lBQzlDLCtCQUErQjtJQUMvQiwwREFBMEQ7SUFFMUQsMENBQTBDO0lBQzFDLGdDQUFnQztJQUNoQyxtQkFBbUI7SUFDbkIsZ0NBQWdDO0lBQ2hDLFlBQVk7SUFFWiw2R0FBNkc7SUFDN0csc0hBQXNIO0lBQ3RILDZFQUE2RTtJQUM3RSxpRkFBaUY7SUFDakYsK0RBQStEO0lBQy9ELFFBQVE7SUFDUixJQUFJO0lBRUosZUFBZTtJQUNmLGVBQWUsQ0FBQyxZQUFnRCxFQUFFLG1CQUEyQjtRQUN6RixJQUFJLENBQUMsWUFBWSxDQUFDLDJDQUFVLENBQUMsWUFBWSxDQUFDLEdBQUcsQ0FBQztRQUM5QyxJQUFJLENBQUMsT0FBTyxDQUFDLEVBQUMsaUJBQWlCLEVBQUUsSUFBSSxFQUFDLENBQUM7UUFFdkMsSUFBSSxTQUFrQjtRQUN0QixJQUFJLFVBQWtCO1FBRXRCLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsWUFBWSxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDO1lBRTNDLEVBQUUsQ0FBQyxDQUFDLG1CQUFtQixJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7Z0JBQzNCLFVBQVUsR0FBRyxJQUFJO1lBQ3JCLENBQUM7WUFBQyxJQUFJLENBQUMsQ0FBQztnQkFDSixVQUFVLEdBQUcsSUFBSTtZQUNyQixDQUFDO1lBRUQsU0FBUyxHQUFHLFVBQVUsR0FBRywyQ0FBVSxDQUFDLGVBQWUsQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDcEUsU0FBUyxHQUFHLFNBQVMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUFFLDRDQUFXLENBQUMsa0JBQWtCLEdBQUcsQ0FBQyxDQUFDO1lBQ2xFLElBQUksQ0FBQyxVQUFVLENBQUMsMkNBQVUsQ0FBQyxZQUFZLENBQUMsR0FBRyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsU0FBUyxDQUFDO1FBQzFFLENBQUM7SUFDTCxDQUFDO0lBRUQsU0FBUyxDQUFDLFNBQWtDLEVBQUUsVUFBNEIsRUFBRSxjQUErQixFQUFFLFdBQW1CLEVBQUUsY0FBc0IsRUFBRSxLQUFhO1FBRW5LLElBQUksU0FBUyxHQUFHLElBQUksQ0FBQyxVQUFVLENBQUMsU0FBUyxDQUFDO1FBQzFDLElBQUksU0FBUyxHQUFHLDRDQUFTLENBQUMsS0FBSyxDQUFDLFdBQVcsQ0FBQztRQUM1QyxJQUFJLE1BQU0sR0FBRyw0Q0FBUyxDQUFDLEtBQUssQ0FBQyxjQUFjLENBQUM7UUFFNUMsZUFBZTtRQUNmLFNBQVMsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUMsRUFBRSxVQUFVLENBQUMsQ0FBQyxFQUFFLDZDQUFZLENBQUMsV0FBVyxFQUFFLFNBQVMsRUFBRSxNQUFNLENBQUM7UUFDdkYsU0FBUyxDQUFDLElBQUksQ0FBQyxjQUFjLENBQUMsQ0FBQyxFQUFFLFVBQVUsQ0FBQyxDQUFDLEVBQUUsNkNBQVksQ0FBQyxZQUFZLEVBQUUsU0FBUyxFQUFFLE1BQU0sQ0FBQztRQUM1RixTQUFTLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDLEVBQUUsY0FBYyxDQUFDLENBQUMsRUFBRSw2Q0FBWSxDQUFDLGNBQWMsRUFBRSxTQUFTLEVBQUUsTUFBTSxDQUFDO1FBQzlGLFNBQVMsQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLENBQUMsRUFBRSxjQUFjLENBQUMsQ0FBQyxFQUFFLDZDQUFZLENBQUMsZUFBZSxFQUFFLFNBQVMsRUFBRSxNQUFNLENBQUM7UUFFbkcsMEJBQTBCO1FBQzFCLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLFVBQVUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsSUFBSSxjQUFjLENBQUMsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDO1lBQzVELFNBQVMsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsNkNBQVksQ0FBQyxTQUFTLEVBQUUsU0FBUyxFQUFFLE1BQU0sQ0FBQztZQUMxRSxTQUFTLENBQUMsSUFBSSxDQUFDLGNBQWMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLDZDQUFZLENBQUMsU0FBUyxFQUFFLFNBQVMsRUFBRSxNQUFNLENBQUM7UUFDbEYsQ0FBQztRQUVELHlCQUF5QjtRQUN6QixHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxVQUFVLENBQUMsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLElBQUksY0FBYyxDQUFDLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQztZQUM1RCxTQUFTLENBQUMsSUFBSSxDQUFDLENBQUMsRUFBRSxjQUFjLENBQUMsQ0FBQyxFQUFFLDZDQUFZLENBQUMsU0FBUyxFQUFFLFNBQVMsRUFBRSxNQUFNLENBQUM7WUFDOUUsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQztnQkFDWCxTQUFTLENBQUMsSUFBSSxDQUFDLENBQUMsRUFBRSxVQUFVLENBQUMsQ0FBQyxFQUFFLDZDQUFZLENBQUMsU0FBUyxFQUFFLFNBQVMsRUFBRSxNQUFNLENBQUM7WUFDOUUsQ0FBQztRQUNMLENBQUM7UUFFRCxFQUFFLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO1lBQ1IsZUFBZTtZQUNmLElBQUksV0FBVyxHQUFHLGNBQWMsQ0FBQyxDQUFDLEdBQUcsVUFBVSxDQUFDLENBQUM7WUFDakQsSUFBSSxVQUFVLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxXQUFXLEdBQUcsQ0FBQyxDQUFDO1lBRTVDLEtBQUssR0FBRyxJQUFJLEdBQUcsS0FBSyxHQUFHLElBQUk7WUFFM0IsSUFBSSxPQUFPLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBRSxDQUFDLFdBQVcsR0FBRyxLQUFLLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7WUFFeEUsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxPQUFPLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQztnQkFDL0IsU0FBUyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQyxHQUFHLENBQUMsRUFBRSxVQUFVLENBQUMsQ0FBQyxFQUFFLDZDQUFZLENBQUMsU0FBUyxFQUFFLFNBQVMsRUFBRSxNQUFNLENBQUM7WUFDN0YsQ0FBQztZQUVELEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsS0FBSyxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDO2dCQUNwQyxTQUFTLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDLEdBQUcsT0FBTyxHQUFHLENBQUMsRUFBRSxVQUFVLENBQUMsQ0FBQyxFQUFFLEtBQUssQ0FBQyxDQUFDLENBQUMsRUFBRSxTQUFTLEVBQUUsTUFBTSxDQUFDO1lBQ3pGLENBQUM7WUFFRCxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxPQUFPLEdBQUcsS0FBSyxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUUsQ0FBQyxJQUFJLGNBQWMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUM7Z0JBQ3RFLFNBQVMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxFQUFFLFVBQVUsQ0FBQyxDQUFDLEVBQUUsNkNBQVksQ0FBQyxTQUFTLEVBQUUsU0FBUyxFQUFFLE1BQU0sQ0FBQztZQUM5RSxDQUFDO1FBR0wsQ0FBQztJQUVMLENBQUM7SUFFRCxnQkFBZ0IsQ0FBQyxTQUFrQyxFQUFFLENBQVMsRUFBRSxLQUFhLEVBQUUsUUFBZ0IsRUFBRSxVQUFrQixFQUFFLGFBQXFCO1FBRXRJLElBQUksU0FBUyxHQUFHLElBQUksQ0FBQyxVQUFVLENBQUMsU0FBUyxDQUFDO1FBQzFDLElBQUksUUFBUSxHQUFHLDRDQUFTLENBQUMsS0FBSyxDQUFDLFVBQVUsQ0FBQztRQUMxQyxJQUFJLE1BQU0sR0FBRyw0Q0FBUyxDQUFDLEtBQUssQ0FBQyxhQUFhLENBQUM7UUFFM0MsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsS0FBSyxFQUFFLENBQUMsSUFBSSxRQUFRLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQztZQUNyQyxTQUFTLENBQUMsSUFBSSxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsNkNBQVksQ0FBQyxTQUFTLEVBQUUsUUFBUSxFQUFFLE1BQU0sQ0FBQztRQUNsRSxDQUFDO0lBRUwsQ0FBQztJQUdELGVBQWU7SUFDZixlQUFlLENBQUMsS0FBYSxFQUFFLFVBQWtCLEVBQUUsT0FBaUQsRUFBRSxjQUFzQjtRQUN4SCxpREFBaUQ7UUFDakQsSUFBSSxDQUFDLE9BQU8sQ0FBQyxFQUFDLGlCQUFpQixFQUFFLElBQUksRUFBQyxDQUFDO1FBRXZDLHlCQUF5QjtRQUN6QixJQUFJLFVBQVUsR0FBRyxJQUFJLGdEQUFlLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUMxQyxJQUFJLGNBQWMsR0FBRyxJQUFJLGdEQUFlLENBQUMsNENBQVcsQ0FBQyxrQkFBa0IsR0FBRyxDQUFDLEVBQUUsNENBQVcsQ0FBQyxtQkFBbUIsR0FBRyxDQUFDLENBQUM7UUFFakgsSUFBSSxVQUFVLEdBQUcsQ0FBQyxjQUFjLENBQUMsQ0FBQyxHQUFHLFVBQVUsQ0FBQyxDQUFDLENBQUM7UUFDbEQsSUFBSSxVQUFVLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxVQUFVLEdBQUcsQ0FBQyxDQUFDO1FBRTNDLCtDQUErQztRQUMvQyxJQUFJLGdCQUFnQixHQUFHLDJDQUFVLENBQUMsU0FBUztRQUMzQyxJQUFJLFdBQVcsR0FBRyxDQUFDO1FBQ25CLG1HQUFtRztRQUNuRyxxSUFBcUk7UUFDckksNEJBQTRCO1FBRTVCLElBQUksY0FBYyxHQUFZLDJDQUFVLENBQUMsU0FBUztRQUNsRCxJQUFJLENBQUMsU0FBUyxDQUFDLDJDQUFVLENBQUMsWUFBWSxDQUFDLElBQUksRUFBRSxVQUFVLEVBQUUsY0FBYyxFQUFFLGdCQUFnQixFQUFFLGNBQWMsRUFBRSxLQUFLLENBQUM7UUFDakgsSUFBSSxDQUFDLGdCQUFnQixDQUFDLDJDQUFVLENBQUMsWUFBWSxDQUFDLElBQUksRUFBRSxVQUFVLEVBQUUsVUFBVSxDQUFDLENBQUMsR0FBRyxXQUFXLEVBQUUsY0FBYyxDQUFDLENBQUMsR0FBRyxDQUFDLEVBQUUsZ0JBQWdCLEVBQUUsY0FBYyxDQUFDO1FBRW5KLElBQUksVUFBbUI7UUFDdkIsSUFBSSxVQUFrQjtRQUN0QixJQUFJLFdBQW9CO1FBRXhCLEVBQUUsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUM7WUFDYixXQUFXLEdBQUcsVUFBVTtRQUM1QixDQUFDO1FBQUMsSUFBSSxDQUFDLENBQUM7WUFDSixXQUFXLEdBQUcsRUFBRTtRQUNwQixDQUFDO1FBQ0QsV0FBVyxHQUFHLEtBQUssR0FBRSw0Q0FBUyxDQUFDLEtBQUssQ0FBQyxjQUFjLENBQUMsR0FBRyxHQUFHLEdBQUcsV0FBVztRQUV4RSwrREFBK0Q7UUFDL0QsSUFBSSxTQUFTLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQywyQ0FBVSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUM7UUFDN0QsU0FBUyxDQUFDLFFBQVEsQ0FBQyxVQUFVLENBQUMsQ0FBQyxHQUFHLENBQUMsRUFBRSxVQUFVLENBQUMsQ0FBQyxHQUFHLENBQUMsRUFBRSxXQUFXLEVBQUUsVUFBVSxHQUFHLENBQUMsQ0FBQztRQUVuRixJQUFJLGFBQWEsR0FBSSxVQUFVLENBQUMsQ0FBQyxHQUFHLFdBQVcsR0FBRyxDQUFDO1FBQ25ELElBQUksY0FBaUQ7UUFFckQsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxPQUFPLENBQUMsTUFBTSxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUM7WUFFdEMsRUFBRSxDQUFDLENBQUMsY0FBYyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7Z0JBQ3RCLHNDQUFzQztnQkFDdEMsVUFBVSxHQUFHLElBQUk7Z0JBQ2pCLGNBQWMsR0FBRyxPQUFPLENBQUMsQ0FBQyxDQUFDO1lBQy9CLENBQUM7WUFBQyxJQUFJLENBQUMsQ0FBQztnQkFDSixzQ0FBc0M7Z0JBQ3RDLFVBQVUsR0FBRyxJQUFJO1lBQ3JCLENBQUM7WUFFRCxVQUFVLEdBQUcsVUFBVSxHQUFHLDJDQUFVLENBQUMsWUFBWSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUM3RCxVQUFVLEdBQUcsVUFBVSxDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUUsNENBQVcsQ0FBQyxrQkFBa0IsR0FBRyxDQUFDLENBQUM7WUFFcEUsVUFBVSxHQUFHLEtBQUssR0FBRSw0Q0FBUyxDQUFDLEtBQUssQ0FBQyxjQUFjLENBQUMsR0FBRyxHQUFHLEdBQUcsVUFBVTtZQUN0RSxTQUFTLENBQUMsUUFBUSxDQUFDLFVBQVUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxFQUFFLGFBQWEsR0FBRyxDQUFDLEVBQUUsVUFBVSxDQUFDO1FBQ3ZFLENBQUM7UUFFRCxFQUFFLENBQUMsQ0FBQyxjQUFjLENBQUMsQ0FBQyxDQUFDO1lBQ2pCLElBQUksVUFBVSxHQUFHLEtBQUssR0FBRSw0Q0FBUyxDQUFDLEtBQUssQ0FBQyxjQUFjLENBQUMsR0FBRyxHQUFHO1lBQzdELEVBQUUsQ0FBQyxDQUFDLGNBQWMsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLENBQUM7Z0JBQ2xDLFVBQVUsSUFBSSxjQUFjLENBQUMsZ0JBQWdCO1lBQ2pELENBQUM7WUFDRCxTQUFTLENBQUMsUUFBUSxDQUFDLFVBQVUsR0FBRyxDQUFDLEVBQUUsYUFBYSxFQUFFLFVBQVUsRUFBRSxVQUFVLEdBQUcsQ0FBQyxDQUFDO1FBQ2pGLENBQUM7SUFDTCxDQUFDO0lBRUQsWUFBWTtRQUNSLElBQUksQ0FBQyxZQUFZLENBQUMsMkNBQVUsQ0FBQyxZQUFZLENBQUMsR0FBRyxDQUFDO1FBQzlDLElBQUksQ0FBQyxPQUFPLENBQUMsRUFBQyxpQkFBaUIsRUFBRSxJQUFJLEVBQUMsQ0FBQztRQUV2QyxJQUFJLENBQUMsVUFBVSxDQUFDLDJDQUFVLENBQUMsWUFBWSxDQUFDLEdBQUcsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLGtCQUFrQixDQUFDO1FBQy9FLElBQUksQ0FBQyxVQUFVLENBQUMsMkNBQVUsQ0FBQyxZQUFZLENBQUMsR0FBRyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsZ0JBQWdCLENBQUM7SUFDakYsQ0FBQztJQUVELCtCQUErQixDQUFDLE1BQXVCO1FBQ25ELElBQUksTUFBTSxHQUFHLElBQUksQ0FBQyxFQUFFLENBQUMsU0FBUyxFQUFFO1FBQ2hDLElBQUksS0FBSyxHQUFHLElBQUksQ0FBQyxFQUFFLENBQUMsZUFBZSxFQUFFO1FBQ3JDLElBQUksSUFBYTtRQUNqQixJQUFJLFdBQVcsR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDLDJDQUFVLENBQUMsWUFBWSxDQUFDLE1BQU0sQ0FBQztRQUVqRSxJQUFJLE1BQU0sR0FBRyxNQUFNLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUM7UUFDckMsSUFBSSxVQUFVLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDO1FBRTVDLEVBQUUsQ0FBQyxDQUFDLE1BQU0sSUFBSSxVQUFVLENBQUMsQ0FBQyxDQUFDO1lBQ3ZCLEVBQUUsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUM7Z0JBQ1QsSUFBSSxHQUFHLFVBQVU7WUFDckIsQ0FBQztZQUFDLElBQUksQ0FBRSxDQUFDO2dCQUNMLElBQUksR0FBRyxzQkFBc0I7WUFDakMsQ0FBQztZQUVELElBQUksTUFBTSxHQUFHLEtBQUssQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQztZQUN6QyxJQUFJLFVBQVUsR0FBRyxLQUFLLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUM7WUFDNUMsSUFBSSxVQUFVLEdBQUcsS0FBSyxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDO1lBQzdDLElBQUksT0FBTyxHQUFHLEtBQUssQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQztZQUN2QyxJQUFJLFNBQVMsR0FBRyxLQUFLLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUM7WUFDM0MscUNBQXFDO1lBRXJDLFdBQVcsQ0FBQyxLQUFLLEVBQUU7WUFFbkIsRUFBRSxDQUFDLENBQUMsTUFBTSxJQUFJLE1BQU0sQ0FBQyxDQUFDLENBQUM7Z0JBQ25CLFdBQVcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxNQUFNLENBQUMsT0FBTyxFQUFFLENBQUM7Z0JBQzVDLElBQUksU0FBUyxHQUFHLHlDQUFRLENBQUMsZUFBZSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLEVBQUUsRUFBRTtvQkFDOUQsTUFBTSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FBQztnQkFDM0MsQ0FBQyxDQUFDO2dCQUVGLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxTQUFTLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQztZQUU3QyxDQUFDO1lBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUM7Z0JBQ2pCLFdBQVcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSw4Q0FBYSxDQUFDLFdBQVcsQ0FBQyxPQUFPLENBQUMsQ0FBQztnQkFDOUQsSUFBSSxTQUFTLEdBQUcsOENBQWEsQ0FBQyxrQkFBa0IsQ0FBQyxPQUFPLENBQUM7Z0JBQ3pELFdBQVcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxTQUFTLENBQUMsUUFBUSxDQUFDO2dCQUM5QyxFQUFFLENBQUMsQ0FBQyxTQUFTLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQztvQkFDeEIsV0FBVyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLFNBQVMsQ0FBQyxXQUFXLENBQUM7Z0JBQ3JELENBQUM7Z0JBRUwsNEJBQTRCO2dCQUM1QixvRkFBb0Y7WUFDcEYsQ0FBQztZQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDO2dCQUNwQixXQUFXLENBQUMsUUFBUSxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsOENBQWEsQ0FBQyxjQUFjLENBQUMsVUFBVSxDQUFDLENBQUM7Z0JBQ3BFLFdBQVcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSw4Q0FBYSxDQUFDLHFCQUFxQixDQUFDLFVBQVUsQ0FBQyxDQUFDO1lBRS9FLENBQUM7WUFBQyxJQUFJLENBQUMsQ0FBQztnQkFDSixXQUFXLENBQUMsUUFBUSxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsaURBQWdCLENBQUMsV0FBVyxDQUFDLFVBQVUsQ0FBQyxhQUFhLEVBQUUsQ0FBQyxDQUFFO1lBQ3pGLENBQUM7UUFDTCxDQUFDO1FBRUQscUVBQXFFO1FBQ3JFLDRFQUE0RTtRQUM1RSx3Q0FBd0M7UUFHeEMsdUVBQXVFO1FBRXZFLHVCQUF1QjtRQUN2QiwrREFBK0Q7UUFDL0QsNEhBQTRIO1FBQzVILGdJQUFnSTtRQUNoSSw4SEFBOEg7UUFDOUgsa0lBQWtJO0lBRXRJLENBQUM7SUFFRCxhQUFhO1FBQ1QsbUVBQW1FO1FBRW5FLElBQUksTUFBTSxHQUFHLElBQUksQ0FBQyxFQUFFLENBQUMsU0FBUyxFQUFFLENBQUMsU0FBUyxFQUFFO1FBRTVDLElBQUksV0FBVyxHQUFHLENBQUM7UUFFbkIsSUFBSSxHQUFHLEdBQUcsQ0FBQztRQUNYLEdBQUcsQ0FBQyxDQUFDLElBQUksR0FBRyxJQUFJLE1BQU0sQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDO1lBQ2xDLElBQUksU0FBUyxHQUFHLElBQUksR0FBRyw4Q0FBYSxDQUFDLGlCQUFpQixDQUFDLEdBQUcsQ0FBQyxHQUFJLEdBQUcsR0FBRyxHQUFHLENBQUMsV0FBVyxDQUFDLGVBQWUsRUFBRSxHQUFHLElBQUk7WUFDN0csSUFBSSxDQUFDLFVBQVUsQ0FBQywyQ0FBVSxDQUFDLFlBQVksQ0FBQyxNQUFNLENBQUMsQ0FBQyxRQUFRLENBQUMsR0FBRyxFQUFFLFdBQVcsRUFBRSxTQUFTLENBQUM7WUFDckYsR0FBRyxJQUFJLFNBQVMsQ0FBQyxNQUFNO1FBQzNCLENBQUM7SUFDTCxDQUFDO0lBRUQsVUFBVTtRQUdOLG9EQUFvRDtRQUNwRCxJQUFJLENBQUMsVUFBVSxDQUFDLDJDQUFVLENBQUMsWUFBWSxDQUFDLE1BQU0sQ0FBQyxDQUFDLEtBQUssRUFBRTtRQUV2RCxJQUFJLENBQUMsYUFBYSxFQUFFO1FBR3BCLHFEQUFxRDtRQUNyRCxJQUFJLFNBQVMsR0FBRyx5Q0FBUSxDQUFDLGVBQWUsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDO1FBQ2pELElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxTQUFTLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQztJQUM3QyxDQUFDO0lBRUQsVUFBVTtRQUNOLG9EQUFvRDtRQUNwRCxJQUFJLFdBQVcsR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDLDJDQUFVLENBQUMsWUFBWSxDQUFDLE1BQU0sQ0FBQztRQUNqRSxXQUFXLENBQUMsS0FBSyxFQUFFO1FBRW5CLElBQUksVUFBVSxHQUFHLFNBQVMsR0FBRyxJQUFJLENBQUMsRUFBRSxDQUFDLFNBQVMsRUFBRSxDQUFDLEtBQUssQ0FBQyxlQUFlLEVBQUU7UUFDeEUsV0FBVyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLFVBQVUsQ0FBQztRQUV0QyxJQUFJLFVBQVUsR0FBRyxRQUFRLEdBQUcsSUFBSSxDQUFDLEVBQUUsQ0FBQyxlQUFlLEVBQUUsQ0FBQyxLQUFLO1FBQzNELElBQUksQ0FBQyxHQUFHLDRDQUFXLENBQUMsZUFBZSxHQUFHLFVBQVUsQ0FBQyxNQUFNO1FBQ3ZELFdBQVcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEVBQUUsVUFBVSxDQUFDO1FBRTFDLElBQUksV0FBVyxHQUFHLDRCQUE0QjtRQUM5QyxDQUFDLEdBQUcsQ0FBQyw0Q0FBVyxDQUFDLGVBQWUsR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLFdBQVcsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDO1FBQ2hFLFdBQVcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxXQUFXLENBQUM7UUFDdkMsdUJBQXVCO1FBR3ZCLHFEQUFxRDtRQUNyRCxvREFBb0Q7UUFDcEQsNENBQTRDO0lBQ2hELENBQUM7SUFFRCwyRUFBMkU7SUFDM0Usa0JBQWtCLENBQUMsV0FBa0M7UUFFakQsSUFBSSxLQUFLLEdBQUcsSUFBSSxDQUFDLEVBQUUsQ0FBQyxlQUFlLEVBQUU7UUFDckMsSUFBSSxNQUFlO1FBRW5CLGlEQUFpRDtRQUNqRCxJQUFJLENBQUMsT0FBTyxDQUFDLEVBQUMsaUJBQWlCLEVBQUUsSUFBSSxFQUFDLENBQUM7UUFFdkMsMEJBQTBCO1FBQzFCLElBQUksY0FBYyxHQUFzQyxXQUFXLENBQUMsSUFBSSxFQUFDLGtEQUFrRDtRQUUzSCx1QkFBdUI7UUFDdkIsY0FBYyxDQUFDLGlCQUFpQixFQUFFLENBQUMsT0FBTyxDQUFDLENBQUMsRUFBbUIsRUFBRSxLQUFhLEVBQUUsRUFBRTtZQUM5RSxNQUFNLEdBQUcsY0FBYyxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUMsQ0FBQyxJQUFJO1lBQ3RDLHdFQUF3RTtZQUN4RSxJQUFJLENBQUMsVUFBVSxDQUFDLDJDQUFVLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDLEVBQUUsTUFBTSxFQUFFLDRDQUFTLENBQUMsS0FBSyxDQUFDLGNBQWMsQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDM0gsQ0FBQyxDQUFDO0lBQ04sQ0FBQztJQUVELG1CQUFtQixDQUFDLFVBQW1DLEVBQUUsU0FBaUIsRUFBRSxRQUFnQjtRQUN4RixJQUFJLFFBQWlCO1FBQ3JCLElBQUksYUFBYSxHQUFHLENBQUM7UUFDckIsSUFBSSxXQUFXLEdBQUcsU0FBUztRQUMzQixJQUFJLFNBQVMsR0FBRyw0Q0FBVyxDQUFDLGtCQUFrQjtRQUU5QyxJQUFJLFVBQW1CO1FBQ3ZCLEVBQUUsQ0FBQyxDQUFDLDJDQUFVLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQztZQUN2QixVQUFVLEdBQUcsMkNBQVUsQ0FBQyxLQUFLO1FBQ2pDLENBQUM7UUFBQyxJQUFJLENBQUMsQ0FBQztZQUNKLFVBQVUsR0FBRywyQ0FBVSxDQUFDLE1BQU07UUFDbEMsQ0FBQztRQUVELEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsVUFBVSxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDO1lBQ3pDLFFBQVEsR0FBRyxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUMsV0FBVyxFQUFFLEdBQUcsR0FBRztZQUM1QyxFQUFFLENBQUMsQ0FBQyxDQUFDLGFBQWEsR0FBRyxRQUFRLENBQUMsTUFBTSxDQUFDLEdBQUcsU0FBUyxDQUFDLENBQUMsQ0FBQztnQkFDaEQsV0FBVyxJQUFJLENBQUM7Z0JBQ2hCLGFBQWEsR0FBRyxDQUFDO1lBQ3JCLENBQUM7WUFFRCxFQUFFLENBQUMsQ0FBQyxXQUFXLElBQUksQ0FBQyxTQUFTLEdBQUcsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDO2dCQUN4QyxNQUFNO1lBQ1YsQ0FBQztZQUVELEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsUUFBUSxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDO2dCQUN2QyxJQUFJLFdBQW9CO2dCQUN4QixFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO29CQUM1QyxXQUFXLEdBQVcsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQztnQkFDdkQsQ0FBQztnQkFBQyxJQUFJLENBQUMsQ0FBQztvQkFDSixXQUFXLEdBQUcsVUFBVTtnQkFDNUIsQ0FBQztnQkFDRCxJQUFJLENBQUMsVUFBVSxDQUFDLDJDQUFVLENBQUMsWUFBWSxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxhQUFhLEdBQUcsQ0FBQyxFQUFFLFdBQVcsRUFBRSxRQUFRLENBQUMsQ0FBQyxDQUFDLEVBQUUsNENBQVMsQ0FBQyxLQUFLLENBQUMsV0FBVyxDQUFDLENBQUM7WUFDbkksQ0FBQztZQUNELGFBQWEsSUFBSSxRQUFRLENBQUMsTUFBTTtRQUNwQyxDQUFDO0lBRUwsQ0FBQztJQUVELGdCQUFnQixDQUFDLFFBQWdCLEVBQUUsV0FBNEIsRUFBRSxLQUFhLEVBQUUsS0FBYztRQUUxRixFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ1gsS0FBSyxHQUFHLDRDQUFXLENBQUMsZUFBZTtRQUN2QyxDQUFDO1FBRUQsSUFBSSxXQUFXLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQywyQ0FBVSxDQUFDLFlBQVksQ0FBQyxHQUFHLENBQUM7UUFDOUQsSUFBSSxTQUFTLEdBQUcsNENBQVcsQ0FBQyxrQkFBa0I7UUFDOUMsSUFBSSxTQUFTLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxTQUFTLEVBQUUsUUFBUSxDQUFDLE1BQU0sQ0FBQztRQUVwRCxJQUFJLGdCQUFnQixHQUFHLFFBQVEsNEJBQTBCO1FBRXpELElBQUksaUJBQWlCLEdBQUcsSUFBSSxrREFBaUIsRUFBaUI7UUFDOUQsSUFBSSxPQUFPLEdBQUcseUNBQVEsQ0FBQyxzQkFBc0IsQ0FBQyxpQkFBaUIsRUFBRSxnQkFBZ0IsRUFBRSwyQ0FBVSxDQUFDLEtBQUssRUFBRSxXQUFXLENBQUM7UUFFakgsaUJBQWlCLENBQUMsaUJBQWlCLEVBQUUsQ0FBQyxPQUFPLENBQUMsQ0FBQyxFQUFtQixFQUFFLEtBQWEsRUFBRSxFQUFFO1lBQ2pGLElBQUksTUFBTSxHQUFHLGlCQUFpQixDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUMsQ0FBQyxJQUFJO1lBQzdDLHdFQUF3RTtZQUN4RSxJQUFJLENBQUMsVUFBVSxDQUFDLDJDQUFVLENBQUMsWUFBWSxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDLEVBQUUsTUFBTSxFQUFFLDRDQUFTLENBQUMsS0FBSyxDQUFDLGlCQUFpQixDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUM3SCxDQUFDLENBQUM7UUFFRiwwRUFBMEU7UUFFMUUsVUFBVSxDQUFDLEdBQUcsRUFBRTtZQUNaLDBFQUEwRTtZQUMxRSxpQkFBaUIsQ0FBQyxpQkFBaUIsRUFBRSxDQUFDLE9BQU8sQ0FBQyxDQUFDLEVBQW1CLEVBQUUsS0FBYSxFQUFFLEVBQUU7Z0JBQ2pGLFdBQVcsQ0FBQyxlQUFlLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUM7WUFDakQsQ0FBQyxDQUFDO1FBRU4sQ0FBQyxFQUFFLEtBQUssQ0FBQztJQUNiLENBQUM7SUFFRCxZQUFZLENBQUMsWUFBb0I7UUFDN0IsSUFBSSxDQUFDLE9BQU8sQ0FBQyxFQUFDLGlCQUFpQixFQUFFLElBQUksRUFBQyxDQUFDO1FBRXZDLHlCQUF5QjtRQUN6QixJQUFJLFVBQVUsR0FBRyxJQUFJLGdEQUFlLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUMxQyxJQUFJLGNBQWMsR0FBRyxJQUFJLGdEQUFlLENBQUMsNENBQVcsQ0FBQyxrQkFBa0IsR0FBRyxDQUFDLEVBQUUsNENBQVcsQ0FBQyxtQkFBbUIsR0FBRyxDQUFDLENBQUM7UUFFakgsSUFBSSxVQUFVLEdBQUcsQ0FBQyxjQUFjLENBQUMsQ0FBQyxHQUFHLFVBQVUsQ0FBQyxDQUFDLENBQUM7UUFDbEQsSUFBSSxVQUFVLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxVQUFVLEdBQUcsQ0FBQyxDQUFDO1FBRTNDLElBQUksZ0JBQWdCLEdBQUcsMkNBQVUsQ0FBQyxTQUFTO1FBRTNDLElBQUksY0FBYyxHQUFZLDJDQUFVLENBQUMsU0FBUztRQUNsRCxJQUFJLENBQUMsU0FBUyxDQUFDLDJDQUFVLENBQUMsWUFBWSxDQUFDLElBQUksRUFBRSxVQUFVLEVBQUUsY0FBYyxFQUFFLGdCQUFnQixFQUFFLGNBQWMsRUFBRSxNQUFNLENBQUM7UUFFbEgsSUFBSSxZQUFZLEdBQUcsS0FBSyxHQUFFLDRDQUFTLENBQUMsS0FBSyxDQUFDLGNBQWMsQ0FBQyxHQUFHLEdBQUc7UUFDL0QsSUFBSSxTQUFTLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQywyQ0FBVSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUM7UUFFN0QsSUFBSSxTQUFTLEdBQUcsVUFBVSxDQUFDLENBQUMsR0FBRyxDQUFDO1FBQ2hDLElBQUksS0FBSyxHQUFHLDRDQUFXLENBQUMsZ0JBQWdCLEdBQUcsQ0FBQztRQUM1QyxPQUFPLFlBQVksR0FBRywwQ0FBUyxDQUFDLFlBQVksQ0FBQyxNQUFNLEVBQUUsQ0FBQztZQUVsRCxJQUFJLFVBQVUsR0FBRyxTQUFTLENBQUMsUUFBUSxDQUFDLFVBQVUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxFQUFFLFNBQVMsRUFBRSxZQUFZLEdBQUcsMENBQVMsQ0FBQyxZQUFZLENBQUMsWUFBWSxDQUFDLEVBQUUsVUFBVSxHQUFHLENBQUMsQ0FBQztZQUVySSxFQUFFLENBQUMsQ0FBQyxDQUFDLFNBQVMsR0FBRyxVQUFVLEdBQUcsQ0FBQyxDQUFDLEdBQUcsS0FBSyxDQUFDLENBQUMsQ0FBQztnQkFDdkMsS0FBSztZQUNULENBQUM7WUFFRCxTQUFTLElBQUksVUFBVSxHQUFHLENBQUM7WUFDM0IsWUFBWSxJQUFJLENBQUM7UUFDckIsQ0FBQztJQUNMLENBQUM7Q0FFSiIsImZpbGUiOiIuL3NyYy9icmV3X2dhbWUvZGlzcGxheS50cy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIFJPVCBmcm9tICdyb3QtanMnXHJcbmltcG9ydCAqIGFzIEJyZXcgZnJvbSAnLi4vYnJldydcclxuaW1wb3J0IHsgSFVEIH0gZnJvbSAnLi4vYnJldyc7XHJcbmltcG9ydCB7IElDb2xvciB9IGZyb20gJy4uL2JyZXdfY29tcG9uZW50cy9jb2xvcidcclxuaW1wb3J0IHsgSUNoYXJBbmRDb2xvciB9IGZyb20gXCIuLi9icmV3X2VuZ2luZS9lbnVtc1wiXHJcblxyXG5jbGFzcyBST1REaXNwbGF5MiBleHRlbmRzIFJPVC5EaXNwbGF5IHtcclxuICAgIHByaXZhdGUgbXlfY29udGV4dCA6IENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRCAgPSBudWxsXHJcblxyXG4gICAgZ2V0V2lkdGgoKSA6IG51bWJlciB7XHJcbiAgICAgICAgcmV0dXJuIE51bWJlcih0aGlzLmdldENvbnRhaW5lcigpLmF0dHJpYnV0ZXMuZ2V0TmFtZWRJdGVtKFwid2lkdGhcIikudmFsdWUpXHJcbiAgICB9XHJcblxyXG4gICAgZ2V0SGVpZ2h0KCkgOiBudW1iZXIge1xyXG4gICAgICAgIHJldHVybiBOdW1iZXIodGhpcy5nZXRDb250YWluZXIoKS5hdHRyaWJ1dGVzLmdldE5hbWVkSXRlbShcImhlaWdodFwiKS52YWx1ZSlcclxuICAgIH1cclxuXHJcbiAgICBnZXRUaWxlV2lkdGgoKSA6IG51bWJlciB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0V2lkdGgoKSAvIEJyZXcuQ29uZmlnLnNjcmVlbl93aWR0aF90aWxlc1xyXG4gICAgfVxyXG5cclxuICAgIGdldFRpbGVIZWlnaHQoKSA6IG51bWJlciB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0SGVpZ2h0KCkgLyBCcmV3LkNvbmZpZy5zY3JlZW5faGVpZ2h0X3RpbGVzXHJcbiAgICB9XHJcblxyXG4gICAgY2xlYXJSZWN0KHg6IG51bWJlciwgeTogbnVtYmVyLCB3aWR0aDogbnVtYmVyLCBoZWlnaHQ6IG51bWJlcikge1xyXG4gICAgICAgIC8vIHRoaXMuX2NvbnRleHQgPSA8SFRNTEVsZW1lbnQ+KHRoaXMuZ2V0Q29udGFpbmVyKCkpXHJcbiAgICAgICAgLy8gdGhpcy5fY29udGV4dCA9IHRoaXMuZ2V0Q29udGFpbmVyKCkuZmlyc3RDaGlsZChcclxuICAgICAgICBpZiAoISh0aGlzLm15X2NvbnRleHQpKSB7XHJcbiAgICAgICAgICAgIC8vIGxldCBjYW52YXMgPSA8SFRNTENhbnZhc0VsZW1lbnQ+dGhpcy5nZXRDb250YWluZXIoKVxyXG4gICAgICAgICAgICAvLyB0aGlzLm15X2NvbnRleHQgPSBjYW52YXMuZ2V0Q29udGV4dChcIjJkXCIpXHJcbiAgICAgICAgICAgIHRoaXMubXlfY29udGV4dCA9ICg8SFRNTENhbnZhc0VsZW1lbnQ+dGhpcy5nZXRDb250YWluZXIoKSkuZ2V0Q29udGV4dChcIjJkXCIpXHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIFxyXG4gICAgICAgIHRoaXMubXlfY29udGV4dC5jbGVhclJlY3QoeCAqIHdpZHRoLCB5ICogaGVpZ2h0LCB3aWR0aCwgaGVpZ2h0KVxyXG4gICAgfVxyXG5cclxuICAgIGNsZWFyUmVjdF9UaWxlcyh4OiBudW1iZXIsIHk6IG51bWJlciwgd2lkdGhfaW5fdGlsZXM6IG51bWJlciwgaGVpZ2h0X2luX3RpbGVzOiBudW1iZXIpIHtcclxuICAgICAgICBpZiAoISh0aGlzLm15X2NvbnRleHQpKSB7XHJcbiAgICAgICAgICAgIHRoaXMubXlfY29udGV4dCA9ICg8SFRNTENhbnZhc0VsZW1lbnQ+dGhpcy5nZXRDb250YWluZXIoKSkuZ2V0Q29udGV4dChcIjJkXCIpXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCB0aWxlX3dpZHRoID0gdGhpcy5nZXRUaWxlV2lkdGgoKVxyXG4gICAgICAgIGxldCB0aWxlX2hlaWdodCA9IHRoaXMuZ2V0VGlsZUhlaWdodCgpICAgICAgICBcclxuICAgICAgICBcclxuICAgICAgICB0aGlzLm15X2NvbnRleHQuY2xlYXJSZWN0KHggKiB0aWxlX3dpZHRoLCB5ICogdGlsZV9oZWlnaHQsIHdpZHRoX2luX3RpbGVzICogdGlsZV93aWR0aCwgaGVpZ2h0X2luX3RpbGVzICogdGlsZV9oZWlnaHQpICAgICAgICBcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIERpc3BsYXkge1xyXG4gICAgLy8gcHJpdmF0ZSByb3RfZGlzcGxheXM6IHsgW25hbWU6IHN0cmluZ106IFJPVERpc3BsYXkyIH1cclxuICAgIHByaXZhdGUgcm90X2Rpc3BsYXlzOiB7IFtuYW1lOiBzdHJpbmddOiBST1REaXNwbGF5MiB9XHJcbiAgICBwcml2YXRlIGdtOiBCcmV3LkdhbWVNYXN0ZXJcclxuICAgIHB1YmxpYyBoaWdobGlnaHRzIDogQnJldy5HcmlkT2ZUaGluZ3M8QnJldy5HcmlkVGhpbmdzLlRlcnJhaW4+XHJcbiAgICBcclxuICAgIHByaXZhdGUgbXlfdGlsZV93aWR0aCA6IG51bWJlciBcclxuICAgIHByaXZhdGUgbXlfdGlsZV9oZWlnaHQgOiBudW1iZXJcclxuICAgIFxyXG4gICAgXHJcbiAgICBjb25zdHJ1Y3RvcihnbTogQnJldy5HYW1lTWFzdGVyLCBkaXZfY29udGFpbmVyIDogSFRNTERpdkVsZW1lbnQpIHtcclxuICAgICAgICB0aGlzLnJvdF9kaXNwbGF5cyA9IHt9XHJcbiAgICAgICAgdGhpcy5nbSA9IGdtXHJcbiAgICAgICAgdGhpcy5oaWdobGlnaHRzID0gbmV3IEJyZXcuR3JpZE9mVGhpbmdzPEJyZXcuR3JpZFRoaW5ncy5UZXJyYWluPigpXHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gc2V0dXAgUk9UanMgY2FudmFzKGVzKVxyXG4gICAgICAgIHRoaXMuaW5pdENhbnZhcyhkaXZfY29udGFpbmVyLCBCcmV3LkNvbmZpZy5zY3JlZW5fd2lkdGhfdGlsZXMsIEJyZXcuQ29uZmlnLnNjcmVlbl9oZWlnaHRfdGlsZXMpXHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gdGhpcy5teV90aWxlX3dpZHRoID0gdGhpcy5nZXREaXNwbGF5KEJyZXcuRW51bXMuRGlzcGxheU5hbWVzLkdhbWUpLmdldENvbnRhaW5lcigpLndpZHRoIC8gQnJldy5Db25maWcuc2NyZWVuX3dpZHRoX3RpbGVzXHJcbiAgICAgICAgLy8gdGhpcy5teV90aWxlX2hlaWdodCA9IHRoaXMuZ2V0RGlzcGxheShCcmV3LkVudW1zLkRpc3BsYXlOYW1lcy5HYW1lKS5nZXRDb250YWluZXIoKS5oZWlnaHQgLyBCcmV3LkNvbmZpZy5zY3JlZW5faGVpZ2h0X3RpbGVzXHJcbiAgICAgICAgdGhpcy5teV90aWxlX3dpZHRoID0gTnVtYmVyKHRoaXMuZ2V0RGlzcGxheShCcmV3LkVudW1zLkRpc3BsYXlOYW1lcy5HYW1lKS5nZXRDb250YWluZXIoKS5hdHRyaWJ1dGVzLmdldE5hbWVkSXRlbShcIndpZHRoXCIpLnZhbHVlKSAvIEJyZXcuQ29uZmlnLnNjcmVlbl93aWR0aF90aWxlc1xyXG4gICAgICAgIHRoaXMubXlfdGlsZV9oZWlnaHQgPSBOdW1iZXIodGhpcy5nZXREaXNwbGF5KEJyZXcuRW51bXMuRGlzcGxheU5hbWVzLkdhbWUpLmdldENvbnRhaW5lcigpLmF0dHJpYnV0ZXMuZ2V0TmFtZWRJdGVtKFwiaGVpZ2h0XCIpLnZhbHVlKSAvIEJyZXcuQ29uZmlnLnNjcmVlbl9oZWlnaHRfdGlsZXNcclxuXHJcbiAgICB9XHJcbiAgICBcclxuICAgIGluaXRDYW52YXMoZGl2X2NvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQsIHdpZHRoOiBudW1iZXIsIGhlaWdodDogbnVtYmVyKSA6IHZvaWQge1xyXG5cclxuICAgICAgICAvLyBpZiB3ZSBhbHJlYWR5IGhhdmUgY29udGFpbmVycywgZGVzdHJveS9yZWNyZWF0ZSB0aGVtIHdoZW4gZ2FtZSByZXN0YXJ0c1xyXG4gICAgICAgIGlmIChkaXZfY29udGFpbmVyLmNoaWxkcmVuLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgd2hpbGUgKGRpdl9jb250YWluZXIuZmlyc3RDaGlsZCkge1xyXG4gICAgICAgICAgICAgICAgZGl2X2NvbnRhaW5lci5yZW1vdmVDaGlsZChkaXZfY29udGFpbmVyLmZpcnN0Q2hpbGQpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgbGV0IGJnX2NvbG9yIDogc3RyaW5nXHJcbiAgICAgICAgaWYgKEJyZXcuRGVidWcuQk9TU19NT0RFKSB7XHJcbiAgICAgICAgICAgIGJnX2NvbG9yID0gXCJ0cmFuc3BhcmVudFwiXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgYmdfY29sb3IgPSBST1QuQ29sb3IudG9IZXgoQnJldy5Db2xvci5jaGFyY29hbClcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gZ2FtZSAtIG1haW4gc2NyZWVuXHJcbiAgICAgICAgbGV0IGNhbnZhc19iZ19jb2xvciA6IG51bWJlcltdXHJcbiAgICAgICAgY2FudmFzX2JnX2NvbG9yID0gQnJldy5Db2xvci5iZ191bmV4cGxvcmVkXHJcbiAgICAgICAgbGV0IGZvbnRfc2l6ZSA9IEJyZXcuQ29uZmlnLmZvbnRfc2l6ZVxyXG5cclxuICAgICAgICBsZXQgZ2FtZURpc3BsYXkgPSBuZXcgUk9URGlzcGxheTIoe1xyXG4gICAgICAgICAgICB3aWR0aDogd2lkdGgsXHJcbiAgICAgICAgICAgIGhlaWdodDogaGVpZ2h0LFxyXG4gICAgICAgICAgICBib3JkZXI6IDAsXHJcbiAgICAgICAgICAgIHNwYWNpbmc6IDEuMTUsXHJcbiAgICAgICAgICAgIGZvbnRTaXplOiBmb250X3NpemUsXHJcbiAgICAgICAgICAgIGJnOiBiZ19jb2xvcixcclxuICAgICAgICAgICAgLy8gYmc6IFwidHJhbnNwYXJlbnRcIixcclxuICAgICAgICAgICAgZm9yY2VTcXVhcmVSYXRpbzogZmFsc2UsXHJcbiAgICAgICAgfSlcclxuICAgICAgICBcclxuICAgICAgICBsZXQgZ2FtZV9jYW52YXMgPSA8SFRNTENhbnZhc0VsZW1lbnQ+KGdhbWVEaXNwbGF5LmdldENvbnRhaW5lcigpKVxyXG4gICAgICAgIGRpdl9jb250YWluZXIuYXBwZW5kQ2hpbGQoZ2FtZV9jYW52YXMpXHJcbiAgICAgICAgdGhpcy5hZGREaXNwbGF5KEJyZXcuRW51bXMuRGlzcGxheU5hbWVzLkdhbWUsIGdhbWVEaXNwbGF5KVxyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIGh1ZCAtIHRhcmdldGluZywgaGlnaGxpZ2h0aW5nLCBldGNcclxuICAgICAgICBsZXQgaHVkRGlzcGxheSA9IG5ldyBST1REaXNwbGF5Mih7XHJcbiAgICAgICAgICAgIHdpZHRoOiB3aWR0aCxcclxuICAgICAgICAgICAgaGVpZ2h0OiBoZWlnaHQsXHJcbiAgICAgICAgICAgIGJvcmRlcjogMCxcclxuICAgICAgICAgICAgc3BhY2luZzogMS4xNSxcclxuICAgICAgICAgICAgZm9udFNpemU6IGZvbnRfc2l6ZSxcclxuICAgICAgICAgICAgLy8gYmc6ICBST1QuQ29sb3IudG9IZXgoQnJldy5Db2xvci5ibHVlKSwgXHJcbiAgICAgICAgICAgIGJnOiBcInRyYW5zcGFyZW50XCIsIFxyXG4gICAgICAgICAgICBmb3JjZVNxdWFyZVJhdGlvOiBmYWxzZSxcclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICBsZXQgaHVkX2NhbnZhcyA9IDxIVE1MQ2FudmFzRWxlbWVudD4oaHVkRGlzcGxheS5nZXRDb250YWluZXIoKSlcclxuICAgICAgICBkaXZfY29udGFpbmVyLmFwcGVuZENoaWxkKGh1ZF9jYW52YXMpICAgICAgICBcclxuICAgICAgICBsZXQgdG9wX2hlaWdodCA9IGh1ZERpc3BsYXkuZ2V0VGlsZUhlaWdodCgpXHJcblxyXG4gICAgICAgIGh1ZF9jYW52YXMuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgYHBvc2l0aW9uOiBhYnNvbHV0ZTsgdG9wOiAke3RvcF9oZWlnaHR9OyBsZWZ0OiAwYClcclxuICAgICAgICB0aGlzLmFkZERpc3BsYXkoQnJldy5FbnVtcy5EaXNwbGF5TmFtZXMuSFVELCBodWREaXNwbGF5KVxyXG5cclxuICAgICAgICAvLyBCT1NTIE1PREVcclxuICAgICAgICBpZiAoQnJldy5EZWJ1Zy5CT1NTX01PREUpIHtcclxuICAgICAgICAgICAgYmdfY29sb3IgPSBST1QuQ29sb3IudG9IZXgoQnJldy5Db2xvci53aGl0ZSkvLyBcInRyYW5zcGFyZW50XCJcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBiZ19jb2xvciA9IFJPVC5Db2xvci50b0hleChCcmV3LkNvbG9yLmNoYXJjb2FsKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gZm9vdGVyXHJcbiAgICAgICAgbGV0IGZvb3RlckRpc3BsYXkgPSBuZXcgUk9URGlzcGxheTIoe1xyXG4gICAgICAgICAgICB3aWR0aDogd2lkdGgsXHJcbiAgICAgICAgICAgIGhlaWdodDogMyxcclxuICAgICAgICAgICAgYm9yZGVyOiAwLFxyXG4gICAgICAgICAgICBzcGFjaW5nOiAxLjE1LFxyXG4gICAgICAgICAgICBmb250U2l6ZTogZm9udF9zaXplLFxyXG4gICAgICAgICAgICBiZzogYmdfY29sb3IsXHJcbiAgICAgICAgICAgIGZvcmNlU3F1YXJlUmF0aW86IGZhbHNlLFxyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIGxldCBmb290ZXJfZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKVxyXG4gICAgICAgIGZvb3Rlcl9kaXYuc2V0QXR0cmlidXRlKFwiaWRcIiwgXCJpZF9kaXZfZm9vdGVyXCIpXHJcbiAgICAgICAgZm9vdGVyX2Rpdi5hcHBlbmRDaGlsZChmb290ZXJEaXNwbGF5LmdldENvbnRhaW5lcigpKVxyXG4gICAgICAgIGRpdl9jb250YWluZXIuYXBwZW5kQ2hpbGQoZm9vdGVyX2RpdilcclxuICAgICAgICB0aGlzLmFkZERpc3BsYXkoQnJldy5FbnVtcy5EaXNwbGF5TmFtZXMuRm9vdGVyLCBmb290ZXJEaXNwbGF5KVxyXG5cclxuICAgICAgICAvLyBoZWFkZXJcclxuICAgICAgICBsZXQgaGVhZGVyRGlzcGxheSA9IG5ldyBST1REaXNwbGF5Mih7XHJcbiAgICAgICAgICAgIHdpZHRoOiB3aWR0aCxcclxuICAgICAgICAgICAgaGVpZ2h0OiAxLFxyXG4gICAgICAgICAgICBib3JkZXI6IDAsXHJcbiAgICAgICAgICAgIHNwYWNpbmc6IDEuMTUsXHJcbiAgICAgICAgICAgIGZvbnRTaXplOiBmb250X3NpemUsXHJcbiAgICAgICAgICAgIGJnOiBiZ19jb2xvcixcclxuICAgICAgICAgICAgZm9yY2VTcXVhcmVSYXRpbzogZmFsc2UsXHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgbGV0IGhlYWRlcl9kaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpXHJcbiAgICAgICAgaGVhZGVyX2Rpdi5zZXRBdHRyaWJ1dGUoXCJpZFwiLCBcImlkX2Rpdl9oZWFkZXJcIilcclxuICAgICAgICBoZWFkZXJfZGl2LmFwcGVuZENoaWxkKGhlYWRlckRpc3BsYXkuZ2V0Q29udGFpbmVyKCkpXHJcbiAgICAgICAgZGl2X2NvbnRhaW5lci5pbnNlcnRCZWZvcmUoaGVhZGVyX2RpdiwgZ2FtZV9jYW52YXMpXHJcbiAgICAgICAgLy8gZGl2X2NvbnRhaW5lci5hcHBlbmRDaGlsZChoZWFkZXJfZGl2KVxyXG4gICAgICAgIHRoaXMuYWRkRGlzcGxheShCcmV3LkVudW1zLkRpc3BsYXlOYW1lcy5IZWFkZXIsIGhlYWRlckRpc3BsYXkpXHJcblxyXG4gICAgfVxyXG4gICAgXHJcblxyXG4gICAgLy8gRGlzcGxheSBtYW5hZ2VtZW50XHJcbiAgICBhZGREaXNwbGF5KG5hbWU6IEJyZXcuRW51bXMuRGlzcGxheU5hbWVzLCBkaXNwOiBST1REaXNwbGF5MikgOiB2b2lkIHtcclxuICAgICAgICB0aGlzLnJvdF9kaXNwbGF5c1tuYW1lXSA9IGRpc3BcclxuICAgIH1cclxuICAgIFxyXG4gICAgZ2V0RGlzcGxheShuYW1lOiBCcmV3LkVudW1zLkRpc3BsYXlOYW1lcykgOiBST1REaXNwbGF5MiB7XHJcbiAgICAgICAgLy8gbWFrZSBzdXJlIGRpc3BsYXkgZXhpc3RzXHJcbiAgICAgICAgaWYgKCEobmFtZSBpbiB0aGlzLnJvdF9kaXNwbGF5cykpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoYGNhbm5vdCBmaW5kIFJPVCBkaXNwbGF5IG5hbWVkICR7bmFtZX1gKVxyXG4gICAgICAgIH0gXHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIHRoaXMucm90X2Rpc3BsYXlzW25hbWVdO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBjbGVhckFsbCgpIDogdm9pZCB7XHJcbiAgICAgICAgZm9yIChsZXQgbmFtZSBpbiB0aGlzLnJvdF9kaXNwbGF5cykge1xyXG4gICAgICAgICAgICBsZXQgZGlzcGxheU5hbWUgPSBCcmV3LkVudW1zLkRpc3BsYXlOYW1lc1tuYW1lXVxyXG4gICAgICAgICAgICB0aGlzLmNsZWFyRGlzcGxheShkaXNwbGF5TmFtZSlcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGNsZWFyRGlzcGxheShuYW1lOiBCcmV3LkVudW1zLkRpc3BsYXlOYW1lcykge1xyXG4gICAgICAgIGxldCBkaXNwbGF5ID0gdGhpcy5nZXREaXNwbGF5KG5hbWUpXHJcbiAgICAgICAgZGlzcGxheS5jbGVhclJlY3QoMCwgMCwgZGlzcGxheS5nZXRXaWR0aCgpLCBkaXNwbGF5LmdldEhlaWdodCgpKVxyXG4gICAgICAgIC8vIGRpc3BsYXkuY2xlYXIoKVxyXG4gICAgICAgIFxyXG4gICAgfVxyXG5cclxuICAgIGNsZWFyRGlzcGxheUF0KG5hbWU6IEJyZXcuRW51bXMuRGlzcGxheU5hbWVzLCB4OiBudW1iZXIsIHk6IG51bWJlcikge1xyXG4gICAgICAgIGxldCBkaXNwbGF5ID0gdGhpcy5nZXREaXNwbGF5KG5hbWUpXHJcbiAgICAgICAgLy90d3BcclxuICAgICAgICBkaXNwbGF5LmNsZWFyUmVjdCh4LCB5LCB0aGlzLm15X3RpbGVfd2lkdGgsIHRoaXMubXlfdGlsZV9oZWlnaHQpXHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIERyYXdpbmcgb24gdGhlIGdyaWRcclxuICAgIGRyYXdBbGwoZGlzcGxheV9vcHRpb25zOiBCcmV3LkVudW1zLklEaXNwbGF5T3B0aW9ucykgOiB2b2lkIHtcclxuICAgICAgICBmb3IgKGxldCB4ID0gMDsgeCA8IEJyZXcuQ29uZmlnLnNjcmVlbl93aWR0aF90aWxlczsgeCsrKSB7XHJcbiAgICAgICAgICAgIGZvciAobGV0IHkgPSAwOyB5IDwgQnJldy5Db25maWcuc2NyZWVuX2hlaWdodF90aWxlczsgeSsrKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRyYXdBdChuZXcgQnJldy5Db29yZGluYXRlKHgsIHkpLCBkaXNwbGF5X29wdGlvbnMpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGRyYXdBdCh4eTogQnJldy5Db29yZGluYXRlLCBkaXNwbGF5X29wdGlvbnM/IDogQnJldy5FbnVtcy5JRGlzcGxheU9wdGlvbnMpIDogYm9vbGVhbiB7XHJcbiAgICAgICAgXHJcbiAgICAgICAgbGV0IGRyYXcgOiBhbnlbXVxyXG4gICAgICAgIGxldCBsZXZlbCA9IHRoaXMuZ20uZ2V0Q3VycmVudExldmVsKClcclxuXHJcbiAgICAgICAgaWYgKEJyZXcuRGVidWcuZGVidWdfcGF0aG1hcCkge1xyXG4gICAgICAgICAgICBsZXQgcGNfb2ZfbWF4IDogbnVtYmVyXHJcbiAgICAgICAgICAgIGxldCBjb2xvcl92YWx1ZSA6IElDb2xvclxyXG4gICAgICAgIFxyXG4gICAgICAgICAgICBsZXQgcGF0aF92YWx1ZSA9IEJyZXcuRGVidWcuZGVidWdfcGF0aG1hcC5maWVsZC5nZXRBdCh4eSlcclxuICAgICAgICAgICAgaWYgKHBhdGhfdmFsdWUpIHtcclxuICAgICAgICAgICAgLy8gaWYgKHBhdGhfdmFsdWUgPCBCcmV3LkRlYnVnLmRlYnVnX3BhdGhtYXAubWF4X3ZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBpZiAocGF0aF92YWx1ZSA9PSBGYXN0RGlqa3N0cmFNYXAuTUFYX0lOVCkge1xyXG4gICAgICAgICAgICAgICAgLy8gICAgIGNvbG9yX3ZhbHVlID0gQnJldy5Db2xvci53aGl0ZVxyXG4gICAgICAgICAgICAgICAgLy8gfSBlbHNlIGlmIChwYXRoX3ZhbHVlID09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIC8vICAgICBjb2xvcl92YWx1ZSA9IEJyZXcuQ29sb3Iud2hpdGVcclxuICAgICAgICAgICAgICAgIC8vIGlmIChwYXRoX3ZhbHVlID09IDApIHtcclxuICAgICAgICAgICAgICAgIC8vICAgICBjb2xvcl92YWx1ZSA9IEJyZXcuQ29sb3IudmlvbGV0XHJcbiAgICAgICAgICAgICAgICAvLyB9IGVsc2UgaWYgKHBhdGhfdmFsdWUgPT0gTnVtYmVyLk1BWF9WQUxVRSkge1xyXG4gICAgICAgICAgICAgICAgLy8gICAgIGNvbG9yX3ZhbHVlID0gQnJldy5Db2xvci5ncmVlblxyXG5cclxuICAgICAgICAgICAgICAgIGlmIChwYXRoX3ZhbHVlIDwgMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHBjX29mX21heCA9IChwYXRoX3ZhbHVlIC8gQnJldy5EZWJ1Zy5kZWJ1Z19wYXRobWFwLm1pbl92YWx1ZSkgIFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbG9yX3ZhbHVlID0gUk9ULkNvbG9yLmludGVycG9sYXRlKEJyZXcuQ29sb3IuYmx1ZSwgQnJldy5Db2xvci53aGl0ZSwgMSAtIHBjX29mX21heClcclxuXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHBjX29mX21heCA9IChwYXRoX3ZhbHVlIC8gQnJldy5EZWJ1Zy5kZWJ1Z19wYXRobWFwLm1heF92YWx1ZSlcclxuICAgICAgICAgICAgICAgICAgICBjb2xvcl92YWx1ZSA9IFJPVC5Db2xvci5pbnRlcnBvbGF0ZShCcmV3LkNvbG9yLmJsdWUsIEJyZXcuQ29sb3Iud2hpdGUsIHBjX29mX21heCkgICAgXHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29sb3JfdmFsdWUgPSBCcmV3LkNvbG9yLnZpb2xldFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0aGlzLmdldERpc3BsYXkoQnJldy5FbnVtcy5EaXNwbGF5TmFtZXMuR2FtZSkuZHJhdyh4eS54LCB4eS55LCBcIiBcIiwgUk9ULkNvbG9yLnRvSGV4KEJyZXcuQ29sb3Iud2hpdGUpLCBST1QuQ29sb3IudG9IZXgoY29sb3JfdmFsdWUpKVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyAwLiBQTEFZRVIgRk9WXHJcbiAgICAgICAgbGV0IGluX2ZvdiA6IGJvb2xlYW5cclxuICAgICAgICBpbl9mb3YgPSB0aGlzLmdtLmdldFBsYXllcigpLmZvdi5oYXNBdCh4eSlcclxuICAgICAgICBcclxuICAgICAgICBpZiAoIShpbl9mb3YpKSB7XHJcbiAgICAgICAgICAgIC8vIG5vdCBpbiB2aWV3LCBjaGVjayBtZW1vcnlcclxuICAgICAgICAgICAgbGV0IG1lbSA9IHRoaXMuZ20uZ2V0UGxheWVyKCkubWVtb3J5LmdldEF0KHh5KVxyXG4gICAgICAgICAgICAvLyBkcmF3ID0gWycgJywgQnJldy5Db2xvci5ibGFjaywgQnJldy5Db2xvci5iZ191bmV4cGxvcmVkXVxyXG4gICAgICAgICAgICBpZiAobWVtKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBzYXcgaXQgYmVmb3JlXHJcbiAgICAgICAgICAgICAgICBkcmF3ID0gW21lbS5jb2RlLCBCcmV3LkNvbG9yLm1lbW9yeSwgQnJldy5Db2xvci5iZ19tZW1vcnldXHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIG5ldmVyIHNlZW4gaXRcclxuICAgICAgICAgICAgICAgIGRyYXcgPSBbJyAnLCBCcmV3LkNvbG9yLmJsYWNrLCBCcmV3LkNvbG9yLmJnX3VuZXhwbG9yZWRdXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gSU4gVklFV1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gMS4gVEVSUkFJTlxyXG4gICAgICAgICAgICBsZXQgdGVycmFpbiA9IGxldmVsLnRlcnJhaW4uZ2V0QXQoeHkpXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBpZiAodGVycmFpbiA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBkZWJ1Z2dlclxyXG4gICAgICAgICAgICB9IFxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZHJhdyA9IFt0ZXJyYWluLmNvZGUsIHRlcnJhaW4uY29sb3IsIHRlcnJhaW4uYmdfY29sb3JdXHJcblxyXG4gICAgICAgICAgICAvLyAyLiBGRUFUVVJFU1xyXG4gICAgICAgICAgICBsZXQgZmVhdHVyZSA9IGxldmVsLmZlYXR1cmVzLmdldEF0KHh5KVxyXG4gICAgICAgICAgICBsZXQgcG9ydGFsX2F0ID0gbGV2ZWwucG9ydGFscy5nZXRBdCh4eSkgLy8gZG9uJ3QgZHJhdyBmZWF0dXJlcyBvbiB0b3Agb2Ygc3RhaXJzXHJcbiAgICAgICAgICAgIGlmIChmZWF0dXJlICYmICghKHBvcnRhbF9hdCkpICYmICghKHRlcnJhaW4uYWx3YXlzT25Ub3ApKSkge1xyXG4gICAgICAgICAgICAgICAgZHJhd1swXSA9IGZlYXR1cmUuY29kZVxyXG4gICAgICAgICAgICAgICAgaWYgKGZlYXR1cmUuY29sb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICBkcmF3WzFdID0gZmVhdHVyZS5jb2xvclxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmIChmZWF0dXJlLmJnX2NvbG9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZHJhd1syXSA9IGZlYXR1cmUuYmdfY29sb3JcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gMy4gSVRFTVNcclxuICAgICAgICAgICAgbGV0IGl0ZW0gPSBsZXZlbC5pdGVtcy5nZXRBdCh4eSlcclxuICAgICAgICAgICAgaWYgKGl0ZW0pIHtcclxuICAgICAgICAgICAgICAgIGRyYXdbMF0gPSBpdGVtLmNvZGVcclxuICAgICAgICAgICAgICAgIGRyYXdbMV0gPSBpdGVtLmNvbG9yXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyA0LiBNT05TVEVSU1xyXG4gICAgICAgICAgICBsZXQgbW9iID0gbGV2ZWwubW9uc3RlcnMuZ2V0QXQoeHkpXHJcbiAgICAgICAgICAgIGlmIChtb2IpIHtcclxuICAgICAgICAgICAgICAgIGRyYXdbMF0gPSBtb2IuY29kZVxyXG4gICAgICAgICAgICAgICAgZHJhd1sxXSA9IG1vYi5jb2xvclxyXG5cclxuICAgICAgICAgICAgICAgIGlmIChtb2IuaGFzRmxhZyhCcmV3LkVudW1zLkZsYWcuU3R1bm5lZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBkcmF3WzJdID0gQnJldy5Db2xvci5ncmVlblxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGxldCByYW5nZV90aHJlYXQgPSBCcmV3LlRhcmdldGluZy5pc1JhbmdlZEF0dGFja1RocmVhdCh0aGlzLmdtLCBtb2IsIHRoaXMuZ20uZ2V0UGxheWVyKCkpXHJcbiAgICAgICAgICAgICAgICBpZiAocmFuZ2VfdGhyZWF0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZHJhd1syXSA9IEJyZXcuQ29sb3IucmVkXHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyA0LjUgOiBQQVJUU1xyXG4gICAgICAgICAgICBsZXQgcGFydCA9IGxldmVsLnBhcnRzLmdldEF0KHh5KVxyXG4gICAgICAgICAgICBpZiAocGFydCkge1xyXG4gICAgICAgICAgICAgICAgZHJhd1swXSA9IHBhcnQuY29kZVxyXG4gICAgICAgICAgICAgICAgZHJhd1sxXSA9IHBhcnQuY29sb3JcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gNS4gQUJPVkUgLyBPVkVSSEVBRFxyXG4gICAgICAgICAgICBsZXQgYWIgPSBsZXZlbC5hYm92ZS5nZXRBdCh4eSlcclxuICAgICAgICAgICAgaWYgKGFiKSB7XHJcbiAgICAgICAgICAgICAgICBkcmF3WzBdID0gYWIuY29kZVxyXG4gICAgICAgICAgICAgICAgZHJhd1sxXSA9IGFiLmNvbG9yXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIFJFTU9URSBWSVNJT05cclxuICAgICAgICAgICAgbGV0IGZvdl90eXBlIDogQnJldy5FbnVtcy5CcmV3VmlzaW9uU291cmNlID0gdGhpcy5nbS5nZXRQbGF5ZXIoKS5mb3YuZ2V0QXQoeHkpXHJcbiAgICAgICAgICAgIGlmIChmb3ZfdHlwZSA9PSBCcmV3LkVudW1zLkJyZXdWaXNpb25Tb3VyY2UueFJlbW90ZSkge1xyXG4gICAgICAgICAgICAgICAgZHJhd1sxXSA9IEJyZXcuQ29sb3IuYmdfcmVtb3RlX3Zpc2lvblxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gYm9zcyBtb2RlXHJcbiAgICAgICAgaWYgKEJyZXcuRGVidWcuQk9TU19NT0RFKSB7XHJcbiAgICAgICAgICAgIGRyYXdbMl0gPSBCcmV3LkNvbG9yLndoaXRlXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBsZXQgZmFkZWRfY29sb3IgPSBST1QuQ29sb3IuaW50ZXJwb2xhdGUoZHJhd1sxXSwgQnJldy5Db2xvci53aGl0ZSwgMC42NjY3KVxyXG4gICAgICAgICAgICBkcmF3WzFdID0gUk9ULkNvbG9yLmludGVycG9sYXRlKGRyYXdbMV0sIEJyZXcuQ29sb3Iud2hpdGUsIDAuNjY2NylcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIGhpZ2hsaWdodHNcclxuICAgICAgICBsZXQgaGlnaGxpZ2h0ID0gdGhpcy5oaWdobGlnaHRzLmdldEF0KHh5KVxyXG4gICAgICAgIGlmIChoaWdobGlnaHQpIHtcclxuICAgICAgICAgICAgLy8gdGhpcy5nZXREaXNwbGF5KEJyZXcuRW51bXMuRGlzcGxheU5hbWVzLkhVRCkuZHJhdyh4eS54LCB4eS55LCBcIiBcIiwgUk9ULkNvbG9yLnRvSGV4KENvbG9yLmJsYWNrKSwgUk9ULkNvbG9yLnRvSGV4KGhpZ2hsaWdodC5jb2xvcikpXHJcbiAgICAgICAgICAgIGRyYXdbMl0gPSBoaWdobGlnaHQuY29sb3JcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyB0aGlzLmdldERpc3BsYXkoQnJldy5FbnVtcy5EaXNwbGF5TmFtZXMuSFVEKS5fY29udGV4dC5jbGVhclJlY3QoeHkueCAqIHRoaXMubXlfdGlsZV93aWR0aCwgeHkueSAqIHRoaXMubXlfdGlsZV9oZWlnaHQsIHRoaXMubXlfdGlsZV93aWR0aCwgdGhpcy5teV90aWxlX2hlaWdodClcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICgoZGlzcGxheV9vcHRpb25zKSAmJiAoZGlzcGxheV9vcHRpb25zLmJsYWNrQW5kV2hpdGVNb2RlKSkge1xyXG4gICAgICAgICAgICBkcmF3WzFdID0gQnJldy5Db2xvci5ncmF5XHJcbiAgICAgICAgICAgIGRyYXdbMl0gPSBCcmV3LkNvbG9yLmRhcmtfZ3JheVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKEJyZXcuRGVidWcuQk9TU19NT0RFKSB7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB0aGlzLmNsZWFyRGlzcGxheUF0KEJyZXcuRW51bXMuRGlzcGxheU5hbWVzLkdhbWUsIHh5LngsIHh5LnkpXHJcbiAgICAgICAgICAgIGlmIChoaWdobGlnaHQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZ2V0RGlzcGxheShCcmV3LkVudW1zLkRpc3BsYXlOYW1lcy5HYW1lKS5kcmF3KHh5LngsIHh5LnksIGRyYXdbMF0sIFJPVC5Db2xvci50b0hleChkcmF3WzFdKSwgUk9ULkNvbG9yLnRvSGV4KGRyYXdbMl0pKVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5nZXREaXNwbGF5KEJyZXcuRW51bXMuRGlzcGxheU5hbWVzLkdhbWUpLmRyYXcoeHkueCwgeHkueSwgZHJhd1swXSwgUk9ULkNvbG9yLnRvSGV4KGRyYXdbMV0pKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmdldERpc3BsYXkoQnJldy5FbnVtcy5EaXNwbGF5TmFtZXMuR2FtZSkuZHJhdyh4eS54LCB4eS55LCBkcmF3WzBdLCBST1QuQ29sb3IudG9IZXgoZHJhd1sxXSksIFJPVC5Db2xvci50b0hleChkcmF3WzJdKSkgICAgICAgICAgICBcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIHRydWUgLy8gVE9ETzogbWFrZSB0aGlzIHJldHVybiBmYWxzZSBpZiBub3RoaW5nIG5ldyB0byBkcmF3IChjYWNoZT8pXHJcbiAgICB9XHJcbiAgICBcclxuICAgIGNvbnZlcnRTY3JlZW5Ub01hcCAoc2NyZWVuX3h5OiBCcmV3LkNvb3JkaW5hdGUpIDogQnJldy5Db29yZGluYXRlIHtcclxuICAgICAgICAvLyBUT0RPOiBzY3JlZW4gb2Zmc2V0IGdvZXMgaGVyZVxyXG4gICAgICAgIGxldCBvZmZzZXRfeHkgPSBuZXcgQnJldy5Db29yZGluYXRlKDAsIDApXHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIHNjcmVlbl94eS5hZGQob2Zmc2V0X3h5KVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBpbnZlbnRvcnlcclxuICAgIC8vIGludmVudG9yeURyYXcoaW52OiBCcmV3LkludmVudG9yeSwgc2VsZWN0ZWRfaXRlbV9pbmRleDogbnVtYmVyKSA6IHZvaWQge1xyXG4gICAgLy8gICAgIHRoaXMuY2xlYXJEaXNwbGF5KEJyZXcuRW51bXMuRGlzcGxheU5hbWVzLkhVRClcclxuICAgIC8vICAgICB0aGlzLmRyYXdBbGwoe2JsYWNrQW5kV2hpdGVNb2RlOiB0cnVlfSlcclxuICAgICAgICBcclxuICAgIC8vICAgICBsZXQgaXRlbV90ZXh0IDogc3RyaW5nXHJcbiAgICAvLyAgICAgbGV0IGtleXMgPSBpbnYuZ2V0S2V5cygpXHJcbiAgICAvLyAgICAgbGV0IHRvZ2dsZVRleHQ6IHN0cmluZ1xyXG4gICAgICAgIFxyXG4gICAgLy8gICAgIGZvciAobGV0IGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7IGkrKykge1xyXG4gICAgLy8gICAgICAgICBsZXQgaW52a2V5ID0ga2V5c1tpXVxyXG4gICAgLy8gICAgICAgICBsZXQgaW52aXRlbSA9IGludi5nZXRJbnZlbnRvcnlJdGVtQnlLZXkoaW52a2V5KVxyXG4gICAgICAgICAgICBcclxuICAgIC8vICAgICAgICAgaWYgKHNlbGVjdGVkX2l0ZW1faW5kZXggPT0gaSkge1xyXG4gICAgLy8gICAgICAgICAgICAgdG9nZ2xlVGV4dCA9IFwiKyBcIlxyXG4gICAgLy8gICAgICAgICB9IGVsc2Uge1xyXG4gICAgLy8gICAgICAgICAgICAgdG9nZ2xlVGV4dCA9IFwiLSBcIlxyXG4gICAgLy8gICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgLy8gICAgICAgICB0aGlzLmdldERpc3BsYXkoQnJldy5FbnVtcy5EaXNwbGF5TmFtZXMuSFVEKS5kcmF3KDAsIGksIGludmtleSwgUk9ULkNvbG9yLnRvSGV4KEJyZXcuQ29sb3Iud2hpdGUpKVxyXG4gICAgLy8gICAgICAgICBpdGVtX3RleHQgPSB0b2dnbGVUZXh0ICsgaW52aXRlbS5pdGVtLmdldERlZmluaXRpb24oKSArIGludml0ZW0uaXRlbS5nZXRJRCgpLnRvU3RyaW5nKCkgKyBpbnZpdGVtLml0ZW0ubmFtZVxyXG4gICAgLy8gICAgICAgICBpdGVtX3RleHQgPSBpdGVtX3RleHQuc2xpY2UoMCwgQnJldy5Db25maWcuc2NyZWVuX3dpZHRoX3RpbGVzIC0gMilcclxuICAgIC8vICAgICAgICAgdGhpcy5nZXREaXNwbGF5KEJyZXcuRW51bXMuRGlzcGxheU5hbWVzLkhVRCkuZHJhd1RleHQoMiwgaSwgaXRlbV90ZXh0KVxyXG4gICAgLy8gICAgICAgICAvLyAuZHJhdygwLCBpLCBpbnZrZXksIFJPVC5Db2xvci50b0hleChDb2xvci53aGl0ZSkpXHJcbiAgICAvLyAgICAgfVxyXG4gICAgLy8gfVxyXG4gICAgXHJcbiAgICAvLyBjb250ZXh0IG1lbnVcclxuICAgIGNvbnRleHRNZW51RHJhdyhjb250ZXh0X2xpc3QgOiBBcnJheTxCcmV3LkVudW1zLkNvbnRleHRNZW51SXRlbT4sIHNlbGVjdGVkX2l0ZW1faW5kZXg6IG51bWJlcikgOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmNsZWFyRGlzcGxheShCcmV3LkVudW1zLkRpc3BsYXlOYW1lcy5IVUQpXHJcbiAgICAgICAgdGhpcy5kcmF3QWxsKHtibGFja0FuZFdoaXRlTW9kZTogdHJ1ZX0pXHJcbiAgICAgICAgXHJcbiAgICAgICAgbGV0IGl0ZW1fdGV4dCA6IHN0cmluZ1xyXG4gICAgICAgIGxldCB0b2dnbGVUZXh0OiBzdHJpbmdcclxuICAgICAgICBcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvbnRleHRfbGlzdC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgaWYgKHNlbGVjdGVkX2l0ZW1faW5kZXggPT0gaSkge1xyXG4gICAgICAgICAgICAgICAgdG9nZ2xlVGV4dCA9IFwiKyBcIlxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdG9nZ2xlVGV4dCA9IFwiLSBcIlxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBpdGVtX3RleHQgPSB0b2dnbGVUZXh0ICsgQnJldy5FbnVtcy5Db250ZXh0TWVudUl0ZW1bY29udGV4dF9saXN0W2ldXVxyXG4gICAgICAgICAgICBpdGVtX3RleHQgPSBpdGVtX3RleHQuc2xpY2UoMCwgQnJldy5Db25maWcuc2NyZWVuX3dpZHRoX3RpbGVzIC0gMilcclxuICAgICAgICAgICAgdGhpcy5nZXREaXNwbGF5KEJyZXcuRW51bXMuRGlzcGxheU5hbWVzLkhVRCkuZHJhd1RleHQoMiwgaSwgaXRlbV90ZXh0KVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgZHJhd0ZyYW1lKGRpc3BfbmFtZTogQnJldy5FbnVtcy5EaXNwbGF5TmFtZXMsIHRvcGxlZnRfeHkgOiBCcmV3LkNvb3JkaW5hdGUsIGJvdHRvbXJpZ2h0X3h5OiBCcmV3LkNvb3JkaW5hdGUsIGZyYW1lX2NvbG9yOiBJQ29sb3IsIGJnX2ZyYW1lX2NvbG9yOiBJQ29sb3IsIHRpdGxlOiBzdHJpbmcpIHtcclxuICAgICAgICBcclxuICAgICAgICBsZXQgZnJEaXNwbGF5ID0gdGhpcy5nZXREaXNwbGF5KGRpc3BfbmFtZSlcclxuICAgICAgICBsZXQgZnJhbWVfaGV4ID0gUk9ULkNvbG9yLnRvSGV4KGZyYW1lX2NvbG9yKVxyXG4gICAgICAgIGxldCBiZ19oZXggPSBST1QuQ29sb3IudG9IZXgoYmdfZnJhbWVfY29sb3IpXHJcblxyXG4gICAgICAgIC8vIGRyYXcgY29ybmVyc1xyXG4gICAgICAgIGZyRGlzcGxheS5kcmF3KHRvcGxlZnRfeHkueCwgdG9wbGVmdF94eS55LCBCcmV3LlN5bWJvbHMuYm94X3RvcGxlZnQsIGZyYW1lX2hleCwgYmdfaGV4KVxyXG4gICAgICAgIGZyRGlzcGxheS5kcmF3KGJvdHRvbXJpZ2h0X3h5LngsIHRvcGxlZnRfeHkueSwgQnJldy5TeW1ib2xzLmJveF90b3ByaWdodCwgZnJhbWVfaGV4LCBiZ19oZXgpXHJcbiAgICAgICAgZnJEaXNwbGF5LmRyYXcodG9wbGVmdF94eS54LCBib3R0b21yaWdodF94eS55LCBCcmV3LlN5bWJvbHMuYm94X2JvdHRvbWxlZnQsIGZyYW1lX2hleCwgYmdfaGV4KVxyXG4gICAgICAgIGZyRGlzcGxheS5kcmF3KGJvdHRvbXJpZ2h0X3h5LngsIGJvdHRvbXJpZ2h0X3h5LnksIEJyZXcuU3ltYm9scy5ib3hfYm90dG9tcmlnaHQsIGZyYW1lX2hleCwgYmdfaGV4KVxyXG5cclxuICAgICAgICAvLyBkcmF3IGxlZnQgJiByaWdodCBzaWRlc1xyXG4gICAgICAgIGZvciAobGV0IHkgPSB0b3BsZWZ0X3h5LnkgKyAxOyB5IDw9IGJvdHRvbXJpZ2h0X3h5LnkgLSAxOyB5KyspIHtcclxuICAgICAgICAgICAgZnJEaXNwbGF5LmRyYXcodG9wbGVmdF94eS54LCB5LCBCcmV3LlN5bWJvbHMuYm94X3ZsaW5lLCBmcmFtZV9oZXgsIGJnX2hleClcclxuICAgICAgICAgICAgZnJEaXNwbGF5LmRyYXcoYm90dG9tcmlnaHRfeHkueCwgeSwgQnJldy5TeW1ib2xzLmJveF92bGluZSwgZnJhbWVfaGV4LCBiZ19oZXgpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBkcmF3IHRvcCAmIGJvdHRvbSBzaWRlXHJcbiAgICAgICAgZm9yIChsZXQgeCA9IHRvcGxlZnRfeHkueCArIDE7IHggPD0gYm90dG9tcmlnaHRfeHkueCAtIDE7IHgrKykge1xyXG4gICAgICAgICAgICBmckRpc3BsYXkuZHJhdyh4LCBib3R0b21yaWdodF94eS55LCBCcmV3LlN5bWJvbHMuYm94X2hsaW5lLCBmcmFtZV9oZXgsIGJnX2hleClcclxuICAgICAgICAgICAgaWYgKCEodGl0bGUpKSB7XHJcbiAgICAgICAgICAgICAgICBmckRpc3BsYXkuZHJhdyh4LCB0b3BsZWZ0X3h5LnksIEJyZXcuU3ltYm9scy5ib3hfaGxpbmUsIGZyYW1lX2hleCwgYmdfaGV4KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGl0bGUpIHtcclxuICAgICAgICAgICAgLy8gY2VudGVyIHRpdGxlXHJcbiAgICAgICAgICAgIGxldCBmcmFtZV93aWR0aCA9IGJvdHRvbXJpZ2h0X3h5LnggLSB0b3BsZWZ0X3h5LnhcclxuICAgICAgICAgICAgbGV0IGhhbGZfd2lkdGggPSBNYXRoLmZsb29yKGZyYW1lX3dpZHRoIC8gMilcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHRpdGxlID0gXCJbIFwiICsgdGl0bGUgKyBcIiBdXCJcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGxldCB0aXRsZV94ID0gTWF0aC5tYXgoMCwgTWF0aC5mbG9vciggKGZyYW1lX3dpZHRoIC0gdGl0bGUubGVuZ3RoKSAvIDIpKVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZm9yIChsZXQgeCA9IDE7IHggPCB0aXRsZV94OyB4KyspIHtcclxuICAgICAgICAgICAgICAgIGZyRGlzcGxheS5kcmF3KHRvcGxlZnRfeHkueCArIHgsIHRvcGxlZnRfeHkueSwgQnJldy5TeW1ib2xzLmJveF9obGluZSwgZnJhbWVfaGV4LCBiZ19oZXgpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZvciAobGV0IHggPSAwOyB4IDwgdGl0bGUubGVuZ3RoOyB4KyspIHtcclxuICAgICAgICAgICAgICAgIGZyRGlzcGxheS5kcmF3KHRvcGxlZnRfeHkueCArIHRpdGxlX3ggKyB4LCB0b3BsZWZ0X3h5LnksIHRpdGxlW3hdLCBmcmFtZV9oZXgsIGJnX2hleClcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZm9yIChsZXQgeCA9IHRpdGxlX3ggKyB0aXRsZS5sZW5ndGggKyAxOyB4IDw9IGJvdHRvbXJpZ2h0X3h5LnggLSAxOyB4KyspIHtcclxuICAgICAgICAgICAgICAgIGZyRGlzcGxheS5kcmF3KHgsIHRvcGxlZnRfeHkueSwgQnJldy5TeW1ib2xzLmJveF9obGluZSwgZnJhbWVfaGV4LCBiZ19oZXgpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcbiAgICBcclxuICAgIGRyYXdWZXJ0aWNhbExpbmUoZGlzcF9uYW1lOiBCcmV3LkVudW1zLkRpc3BsYXlOYW1lcywgeDogbnVtYmVyLCB5X3RvcDogbnVtYmVyLCB5X2JvdHRvbTogbnVtYmVyLCBsaW5lX2NvbG9yOiBJQ29sb3IsIGJnX2xpbmVfY29sb3I6IElDb2xvcikge1xyXG4gICAgICAgIFxyXG4gICAgICAgIGxldCBmckRpc3BsYXkgPSB0aGlzLmdldERpc3BsYXkoZGlzcF9uYW1lKVxyXG4gICAgICAgIGxldCBsaW5lX2hleCA9IFJPVC5Db2xvci50b0hleChsaW5lX2NvbG9yKVxyXG4gICAgICAgIGxldCBiZ19oZXggPSBST1QuQ29sb3IudG9IZXgoYmdfbGluZV9jb2xvcilcclxuXHJcbiAgICAgICAgZm9yIChsZXQgeSA9IHlfdG9wOyB5IDw9IHlfYm90dG9tOyB5KyspIHtcclxuICAgICAgICAgICAgZnJEaXNwbGF5LmRyYXcoeCwgeSwgQnJldy5TeW1ib2xzLmJveF92bGluZSwgbGluZV9oZXgsIGJnX2hleClcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuXHJcbiAgICAvLyBnZW5lcmljIG1lbnVcclxuICAgIGdlbmVyaWNNZW51RHJhdyh0aXRsZTogc3RyaW5nLCBnaXZlbl9kZXNjOiBzdHJpbmcsIGVudHJpZXMgOiBBcnJheTxCcmV3LkVudW1zLklCcmV3R2VuZXJpY01lbnVFbnRyeT4sIHNlbGVjdGVkX2luZGV4OiBudW1iZXIpIDogdm9pZCB7XHJcbiAgICAgICAgLy8gdGhpcy5jbGVhckRpc3BsYXkoQnJldy5FbnVtcy5EaXNwbGF5TmFtZXMuSFVEKVxyXG4gICAgICAgIHRoaXMuZHJhd0FsbCh7YmxhY2tBbmRXaGl0ZU1vZGU6IHRydWV9KVxyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIGRlZmluZSBvdXIgd29yayBhcm91bmRcclxuICAgICAgICBsZXQgdG9wbGVmdF94eSA9IG5ldyBCcmV3LkNvb3JkaW5hdGUoMSwgMSlcclxuICAgICAgICBsZXQgYm90dG9tcmlnaHRfeHkgPSBuZXcgQnJldy5Db29yZGluYXRlKEJyZXcuQ29uZmlnLnNjcmVlbl93aWR0aF90aWxlcyAtIDIsIEJyZXcuQ29uZmlnLnNjcmVlbl9oZWlnaHRfdGlsZXMgLSAyKVxyXG5cclxuICAgICAgICBsZXQgZnVsbF93aWR0aCA9IChib3R0b21yaWdodF94eS54IC0gdG9wbGVmdF94eS54KVxyXG4gICAgICAgIGxldCBoYWxmX3dpZHRoID0gTWF0aC5mbG9vcihmdWxsX3dpZHRoIC8gMilcclxuXHJcbiAgICAgICAgLy8gdG9kbzogYWRkIG1lbnUgY29sb3JzIHRvIGdlbmVyaWNNZW51IG9wdGlvbnNcclxuICAgICAgICBsZXQgbWVudV9mcmFtZV9jb2xvciA9IEJyZXcuQ29sb3IuZ29sZGVucm9kXHJcbiAgICAgICAgbGV0IGRlc2NfaGVpZ2h0ID0gM1xyXG4gICAgICAgIC8vIHRoaXMuZHJhd0ZyYW1lKEJyZXcuRW51bXMuRGlzcGxheU5hbWVzLkhVRCwgdG9wbGVmdF94eSwgYm90dG9tcmlnaHRfeHksIG1lbnVfZnJhbWVfY29sb3IsIHRpdGxlKVxyXG4gICAgICAgIC8vIHRoaXMuZHJhd1ZlcnRpY2FsTGluZShCcmV3LkVudW1zLkRpc3BsYXlOYW1lcy5IVUQsIGhhbGZfd2lkdGgsIHRvcGxlZnRfeHkueSArIGRlc2NfaGVpZ2h0LCBib3R0b21yaWdodF94eS55IC0gMSwgbWVudV9mcmFtZV9jb2xvcilcclxuICAgICAgICAvLyBkcmF3WzFdID0gQnJldy5Db2xvci5ncmF5XHJcbiAgICAgICAgXHJcbiAgICAgICAgbGV0IGJnX2ZyYW1lX2NvbG9yIDogSUNvbG9yID0gQnJldy5Db2xvci5kYXJrX2dyYXlcclxuICAgICAgICB0aGlzLmRyYXdGcmFtZShCcmV3LkVudW1zLkRpc3BsYXlOYW1lcy5HYW1lLCB0b3BsZWZ0X3h5LCBib3R0b21yaWdodF94eSwgbWVudV9mcmFtZV9jb2xvciwgYmdfZnJhbWVfY29sb3IsIHRpdGxlKVxyXG4gICAgICAgIHRoaXMuZHJhd1ZlcnRpY2FsTGluZShCcmV3LkVudW1zLkRpc3BsYXlOYW1lcy5HYW1lLCBoYWxmX3dpZHRoLCB0b3BsZWZ0X3h5LnkgKyBkZXNjX2hlaWdodCwgYm90dG9tcmlnaHRfeHkueSAtIDEsIG1lbnVfZnJhbWVfY29sb3IsIGJnX2ZyYW1lX2NvbG9yKVxyXG5cclxuICAgICAgICBsZXQgZW50cnlfdGV4dCA6IHN0cmluZ1xyXG4gICAgICAgIGxldCB0b2dnbGVUZXh0OiBzdHJpbmdcclxuICAgICAgICBsZXQgZGVzY3JpcHRpb24gOiBzdHJpbmcgXHJcblxyXG4gICAgICAgIGlmIChnaXZlbl9kZXNjKSB7XHJcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uID0gZ2l2ZW5fZGVzY1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uID0gXCJcIlxyXG4gICAgICAgIH1cclxuICAgICAgICBkZXNjcmlwdGlvbiA9IFwiJWJ7XCIrIFJPVC5Db2xvci50b0hleChiZ19mcmFtZV9jb2xvcikgKyBcIn1cIiArIGRlc2NyaXB0aW9uXHJcblxyXG4gICAgICAgIC8vIGxldCBmckRpc3BsYXkgPSB0aGlzLmdldERpc3BsYXkoQnJldy5FbnVtcy5EaXNwbGF5TmFtZXMuSFVEKVxyXG4gICAgICAgIGxldCBmckRpc3BsYXkgPSB0aGlzLmdldERpc3BsYXkoQnJldy5FbnVtcy5EaXNwbGF5TmFtZXMuR2FtZSlcclxuICAgICAgICBmckRpc3BsYXkuZHJhd1RleHQodG9wbGVmdF94eS54ICsgMSwgdG9wbGVmdF94eS55ICsgMSwgZGVzY3JpcHRpb24sIGZ1bGxfd2lkdGggLSAxKVxyXG5cclxuICAgICAgICBsZXQgaXRlbXNfc3RhcnRfeSA9ICB0b3BsZWZ0X3h5LnkgKyBkZXNjX2hlaWdodCArIDFcclxuICAgICAgICBsZXQgc2VsZWN0ZWRfZW50cnkgOiBCcmV3LkVudW1zLklCcmV3R2VuZXJpY01lbnVFbnRyeVxyXG5cclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGVudHJpZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGlmIChzZWxlY3RlZF9pbmRleCA9PSBpKSB7XHJcbiAgICAgICAgICAgICAgICAvLyB0b2dnbGVUZXh0ID0gKGkrMSkudG9TdHJpbmcoKSArIFwiPlwiXHJcbiAgICAgICAgICAgICAgICB0b2dnbGVUZXh0ID0gXCI+IFwiXHJcbiAgICAgICAgICAgICAgICBzZWxlY3RlZF9lbnRyeSA9IGVudHJpZXNbaV1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIHRvZ2dsZVRleHQgPSAoaSsxKS50b1N0cmluZygpICsgXCIgXCJcclxuICAgICAgICAgICAgICAgIHRvZ2dsZVRleHQgPSBcIi0gXCJcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZW50cnlfdGV4dCA9IHRvZ2dsZVRleHQgKyBCcmV3Lk1lbnVzLmdldEVudHJ5TmFtZShlbnRyaWVzW2ldKVxyXG4gICAgICAgICAgICBlbnRyeV90ZXh0ID0gZW50cnlfdGV4dC5zbGljZSgwLCBCcmV3LkNvbmZpZy5zY3JlZW5fd2lkdGhfdGlsZXMgLSAyKVxyXG5cclxuICAgICAgICAgICAgZW50cnlfdGV4dCA9IFwiJWJ7XCIrIFJPVC5Db2xvci50b0hleChiZ19mcmFtZV9jb2xvcikgKyBcIn1cIiArIGVudHJ5X3RleHRcclxuICAgICAgICAgICAgZnJEaXNwbGF5LmRyYXdUZXh0KHRvcGxlZnRfeHkueCArIDEsIGl0ZW1zX3N0YXJ0X3kgKyBpLCBlbnRyeV90ZXh0KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHNlbGVjdGVkX2VudHJ5KSB7XHJcbiAgICAgICAgICAgIGxldCBlbnRyeV9kZXNjID0gXCIlYntcIisgUk9ULkNvbG9yLnRvSGV4KGJnX2ZyYW1lX2NvbG9yKSArIFwifVwiXHJcbiAgICAgICAgICAgIGlmIChzZWxlY3RlZF9lbnRyeS5lbnRyeURlc2NyaXB0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICBlbnRyeV9kZXNjICs9IHNlbGVjdGVkX2VudHJ5LmVudHJ5RGVzY3JpcHRpb25cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmckRpc3BsYXkuZHJhd1RleHQoaGFsZl93aWR0aCArIDEsIGl0ZW1zX3N0YXJ0X3ksIGVudHJ5X2Rlc2MsIGhhbGZfd2lkdGggLSAxKVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgZ2FtZU92ZXJEcmF3KCkgOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmNsZWFyRGlzcGxheShCcmV3LkVudW1zLkRpc3BsYXlOYW1lcy5IVUQpXHJcbiAgICAgICAgdGhpcy5kcmF3QWxsKHtibGFja0FuZFdoaXRlTW9kZTogdHJ1ZX0pXHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5nZXREaXNwbGF5KEJyZXcuRW51bXMuRGlzcGxheU5hbWVzLkhVRCkuZHJhd1RleHQoMiwgMiwgXCJDb25ncmF0dWxhdGlvbnMhXCIpXHJcbiAgICAgICAgdGhpcy5nZXREaXNwbGF5KEJyZXcuRW51bXMuRGlzcGxheU5hbWVzLkhVRCkuZHJhd1RleHQoMiwgNCwgXCJZb3UgaGF2ZSBkaWVkLlwiKVxyXG4gICAgfVxyXG5cclxuICAgIHVwZGF0ZURlc2NyaXB0aW9uRm9vdGVyRm9yUG9pbnQobWFwX3h5OiBCcmV3LkNvb3JkaW5hdGUpIHtcclxuICAgICAgICBsZXQgcGxheWVyID0gdGhpcy5nbS5nZXRQbGF5ZXIoKVxyXG4gICAgICAgIGxldCBsZXZlbCA9IHRoaXMuZ20uZ2V0Q3VycmVudExldmVsKClcclxuICAgICAgICBsZXQgZGVzYyA6IHN0cmluZ1xyXG4gICAgICAgIGxldCBmb290ZXJfZGlzcCA9IHRoaXMuZ2V0RGlzcGxheShCcmV3LkVudW1zLkRpc3BsYXlOYW1lcy5Gb290ZXIpXHJcbiAgICAgICAgXHJcbiAgICAgICAgbGV0IGluX2ZvdiA9IHBsYXllci5mb3YuaGFzQXQobWFwX3h5KVxyXG4gICAgICAgIGxldCBoYXNfbWVtb3J5ID0gcGxheWVyLm1lbW9yeS5oYXNBdChtYXBfeHkpXHJcblxyXG4gICAgICAgIGlmIChpbl9mb3YgfHwgaGFzX21lbW9yeSkge1xyXG4gICAgICAgICAgICBpZiAoaW5fZm92KSB7XHJcbiAgICAgICAgICAgICAgICBkZXNjID0gXCJZb3Ugc2VlIFwiXHJcbiAgICAgICAgICAgIH0gZWxzZSAge1xyXG4gICAgICAgICAgICAgICAgZGVzYyA9IFwiWW91IHJlbWVtYmVyIHNlZWluZyBcIlxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBsZXQgbW9iX2F0ID0gbGV2ZWwubW9uc3RlcnMuZ2V0QXQobWFwX3h5KVxyXG4gICAgICAgICAgICBsZXQgdGVycmFpbl9hdCA9IGxldmVsLnRlcnJhaW4uZ2V0QXQobWFwX3h5KVxyXG4gICAgICAgICAgICBsZXQgZmVhdHVyZV9hdCA9IGxldmVsLmZlYXR1cmVzLmdldEF0KG1hcF94eSlcclxuICAgICAgICAgICAgbGV0IGl0ZW1fYXQgPSBsZXZlbC5pdGVtcy5nZXRBdChtYXBfeHkpXHJcbiAgICAgICAgICAgIGxldCBwb3J0YWxfYXQgPSBsZXZlbC5wb3J0YWxzLmdldEF0KG1hcF94eSlcclxuICAgICAgICAgICAgLy8gdG9kbzogZ2V0IGRlc2NyaXB0aW9uKCkgZm9yIFRoaW5nc1xyXG5cclxuICAgICAgICAgICAgZm9vdGVyX2Rpc3AuY2xlYXIoKVxyXG5cclxuICAgICAgICAgICAgaWYgKG1vYl9hdCAmJiBpbl9mb3YpIHtcclxuICAgICAgICAgICAgICAgIGZvb3Rlcl9kaXNwLmRyYXdUZXh0KDAsIDAsIG1vYl9hdC5nZXROYW1lKCkpXHJcbiAgICAgICAgICAgICAgICBsZXQgbW9iX25vdGVzID0gQnJldy5IVUQuZ2V0Q3VycmVudE5vdGVzKHRoaXMuZ20pLmZpbHRlcigobm90ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBub3RlLnN1YmplY3QuaXNTYW1lVGhpbmcobW9iX2F0KVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICB0aGlzLmRyYXdOb3Rlc09udG9Gb290ZXIobW9iX25vdGVzLCAxLCAyKVxyXG5cclxuICAgICAgICAgICAgfSBlbHNlIGlmIChpdGVtX2F0KSB7XHJcbiAgICAgICAgICAgICAgICBmb290ZXJfZGlzcC5kcmF3VGV4dCgwLCAwLCBCcmV3Lkdsb3NzYXJ5LmdldEl0ZW1OYW1lKGl0ZW1fYXQpKVxyXG4gICAgICAgICAgICAgICAgbGV0IGl0ZW1fZGVzYyA9IEJyZXcuR2xvc3NhcnkuZ2V0SXRlbURlc2NyaXB0aW9uKGl0ZW1fYXQpXHJcbiAgICAgICAgICAgICAgICBmb290ZXJfZGlzcC5kcmF3VGV4dCgwLCAxLCBpdGVtX2Rlc2MudHlwZURlc2MpXHJcbiAgICAgICAgICAgICAgICBpZiAoaXRlbV9kZXNjLnN1YlR5cGVEZXNjKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9vdGVyX2Rpc3AuZHJhd1RleHQoMCwgMiwgaXRlbV9kZXNjLnN1YlR5cGVEZXNjKVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gfSBlbHNlIGlmIChvdmVyaGVhZF9hdCkge1xyXG4gICAgICAgICAgICAvLyAgICAgZGVzYyArPSBCcmV3LkRlZmluaXRpb25zLkFib3ZlVHlwZVtvdmVyaGVhZF9hdC5nZXREZWZpbml0aW9uKCldICsgXCIgb3ZlcmhlYWRcIlxyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGZlYXR1cmVfYXQpIHtcclxuICAgICAgICAgICAgICAgIGZvb3Rlcl9kaXNwLmRyYXdUZXh0KDAsIDAsIEJyZXcuR2xvc3NhcnkuZ2V0RmVhdHVyZU5hbWUoZmVhdHVyZV9hdCkpXHJcbiAgICAgICAgICAgICAgICBmb290ZXJfZGlzcC5kcmF3VGV4dCgwLCAxLCBCcmV3Lkdsb3NzYXJ5LmdldEZlYXR1cmVEZXNjcmlwdGlvbihmZWF0dXJlX2F0KSlcclxuXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBmb290ZXJfZGlzcC5kcmF3VGV4dCgwLCAwLCBCcmV3LkRlZmluaXRpb25zLlRlcnJhaW5UeXBlW3RlcnJhaW5fYXQuZ2V0RGVmaW5pdGlvbigpXSApXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IFxyXG5cclxuICAgICAgICAvLyB0b2RvOiBldmVudHVhbGx5IG1ha2UgdGhpcyBpbnRvIGEgY2FudmFzIC8gUk9UIGRpc3BsYXkgZWxlbWVudCAoPylcclxuICAgICAgICAvLyBsZXQgZGl2RGVidWcgPSA8SFRNTERpdkVsZW1lbnQ+IChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImlkX2Rpdl9kZWJ1Z1wiKSlcclxuICAgICAgICAvLyBkaXZEZWJ1Zy5pbm5lckhUTUwgPSBgPHA+JHtkZXNjfTwvcD5gXHJcblxyXG5cclxuICAgICAgICAvLyB0aGlzLmdldERpc3BsYXkoQnJldy5FbnVtcy5EaXNwbGF5TmFtZXMuRm9vdGVyKS5kcmF3VGV4dCgwLCAwLCBkZXNjKVxyXG5cclxuICAgICAgICAvLyBsb2cgc29tZSBkZWJ1ZyBzdHVmZlxyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKGAtLSBkZWJ1ZyBpbmZvIGZvciAke21hcF94eS54fSwgJHttYXBfeHkueX0gLS1gKVxyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKFwicGF0aCB0byBwbGF5ZXJcIiwgdGhpcy5nbS5wYXRobWFwcy5nZXRQYXRobWFwKEJyZXcuRW51bXMuUGF0aG1hcENhY2hlVHlwZS5Ub1BsYXllcl9XYWxrKS5maWVsZC5nZXRBdChtYXBfeHkpKVxyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKFwicGF0aCBmcm9tIHBsYXllclwiLCB0aGlzLmdtLnBhdGhtYXBzLmdldFBhdGhtYXAoQnJldy5FbnVtcy5QYXRobWFwQ2FjaGVUeXBlLkZyb21QbGF5ZXJfV2FsaykuZmllbGQuZ2V0QXQobWFwX3h5KSlcclxuICAgICAgICAvLyBjb25zb2xlLmxvZyhcImZseXBhdGggdG8gcGxheWVyXCIsIHRoaXMuZ20ucGF0aG1hcHMuZ2V0UGF0aG1hcChCcmV3LkVudW1zLlBhdGhtYXBDYWNoZVR5cGUuVG9QbGF5ZXJfRmx5KS5maWVsZC5nZXRBdChtYXBfeHkpKVxyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKFwiZmx5cGF0aCBmcm9tIHBsYXllclwiLCB0aGlzLmdtLnBhdGhtYXBzLmdldFBhdGhtYXAoQnJldy5FbnVtcy5QYXRobWFwQ2FjaGVUeXBlLkZyb21QbGF5ZXJfRmx5KS5maWVsZC5nZXRBdChtYXBfeHkpKVxyXG4gICAgICAgIFxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBkcmF3UG93ZXJJbmZvKCkge1xyXG4gICAgICAgIC8vIGRyYXcgYSBzdHJpcCBhY3Jvc3MgdGhlIGJvdHRvbSBvZiB0aGUgZm9vdGVyIHdpdGggdGhlIHBvd2VyIGluZm9cclxuICAgICAgICBcclxuICAgICAgICBsZXQgcG93ZXJzID0gdGhpcy5nbS5nZXRQbGF5ZXIoKS5nZXRQb3dlcnMoKVxyXG4gICAgICAgIFxyXG4gICAgICAgIGxldCBjdXJyZW50X3JvdyA9IDJcclxuICAgICAgICBcclxuICAgICAgICBsZXQgY29sID0gMFxyXG4gICAgICAgIGZvciAobGV0IHBvdyBvZiBwb3dlcnMubGlzdE9mUG93ZXJzKSB7XHJcbiAgICAgICAgICAgIGxldCBsaW5lX2Rlc2MgPSBcIlsgXCIgKyBCcmV3Lkdsb3NzYXJ5LmdldFBvd2VyU2hvcnROYW1lKHBvdykgICsgXCIgXCIgKyBwb3cuY2hhcmdlX3N0YXQuZ2V0Q3VycmVudExldmVsKCkgKyBcIiBdXCJcclxuICAgICAgICAgICAgdGhpcy5nZXREaXNwbGF5KEJyZXcuRW51bXMuRGlzcGxheU5hbWVzLkZvb3RlcikuZHJhd1RleHQoY29sLCBjdXJyZW50X3JvdywgbGluZV9kZXNjKVxyXG4gICAgICAgICAgICBjb2wgKz0gbGluZV9kZXNjLmxlbmd0aFxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBkcmF3Rm9vdGVyKCkge1xyXG5cclxuXHJcbiAgICAgICAgLy8gdGhpcy5jbGVhckRpc3BsYXkoQnJldy5FbnVtcy5EaXNwbGF5TmFtZXMuRm9vdGVyKVxyXG4gICAgICAgIHRoaXMuZ2V0RGlzcGxheShCcmV3LkVudW1zLkRpc3BsYXlOYW1lcy5Gb290ZXIpLmNsZWFyKClcclxuXHJcbiAgICAgICAgdGhpcy5kcmF3UG93ZXJJbmZvKClcclxuXHJcblxyXG4gICAgICAgIC8vIGRyYXcgYWxsIG5vdGVzIGEgdGhlIGJvdHRvbSBleGNlcHQgYmVoYXZpb3JhbCBvbmVzXHJcbiAgICAgICAgbGV0IGh1ZF9ub3RlcyA9IEJyZXcuSFVELmdldEN1cnJlbnROb3Rlcyh0aGlzLmdtKVxyXG4gICAgICAgIHRoaXMuZHJhd05vdGVzT250b0Zvb3RlcihodWRfbm90ZXMsIDAsIDIpXHJcbiAgICB9XHJcblxyXG4gICAgZHJhd0hlYWRlcigpIHtcclxuICAgICAgICAvLyB0aGlzLmNsZWFyRGlzcGxheShCcmV3LkVudW1zLkRpc3BsYXlOYW1lcy5Gb290ZXIpXHJcbiAgICAgICAgbGV0IGhlYWRlcl9kaXNwID0gdGhpcy5nZXREaXNwbGF5KEJyZXcuRW51bXMuRGlzcGxheU5hbWVzLkhlYWRlcilcclxuICAgICAgICBoZWFkZXJfZGlzcC5jbGVhcigpXHJcblxyXG4gICAgICAgIGxldCBzY29yZV90ZXh0ID0gXCJTQ09SRTogXCIgKyB0aGlzLmdtLmdldFBsYXllcigpLnNjb3JlLmdldEN1cnJlbnRMZXZlbCgpXHJcbiAgICAgICAgaGVhZGVyX2Rpc3AuZHJhd1RleHQoMCwgMCwgc2NvcmVfdGV4dClcclxuXHJcbiAgICAgICAgbGV0IGxldmVsX3RleHQgPSBcIkFSRUE6IFwiICsgdGhpcy5nbS5nZXRDdXJyZW50TGV2ZWwoKS5kZXB0aFxyXG4gICAgICAgIGxldCB4ID0gQnJldy5Db25maWcubWFwX3dpZHRoX3RpbGVzIC0gbGV2ZWxfdGV4dC5sZW5ndGhcclxuICAgICAgICBoZWFkZXJfZGlzcC5kcmF3VGV4dCh4IC0gMSwgMCwgbGV2ZWxfdGV4dClcclxuXHJcbiAgICAgICAgbGV0IG1pZGRsZV90ZXh0ID0gXCJUYW5rIENvbnRyb2whICg/IGZvciBIRUxQKVwiXHJcbiAgICAgICAgeCA9IChCcmV3LkNvbmZpZy5tYXBfd2lkdGhfdGlsZXMgLyAyKSAtIChtaWRkbGVfdGV4dC5sZW5ndGggLyAyKSBcclxuICAgICAgICBoZWFkZXJfZGlzcC5kcmF3VGV4dCh4LCAwLCBtaWRkbGVfdGV4dClcclxuICAgICAgICAvLyB0aGlzLmRyYXdQb3dlckluZm8oKVxyXG5cclxuXHJcbiAgICAgICAgLy8gZHJhdyBhbGwgbm90ZXMgYSB0aGUgYm90dG9tIGV4Y2VwdCBiZWhhdmlvcmFsIG9uZXNcclxuICAgICAgICAvLyBsZXQgaHVkX25vdGVzID0gQnJldy5IVUQuZ2V0Q3VycmVudE5vdGVzKHRoaXMuZ20pXHJcbiAgICAgICAgLy8gdGhpcy5kcmF3Tm90ZXNPbnRvRm9vdGVyKGh1ZF9ub3RlcywgMCwgMilcclxuICAgIH1cclxuXHJcbiAgICAvLyBoZWFkc1VwRGlzcGxheURyYXcoaHVkRGlzcGxheVR5cGUgOiBCcmV3LkVudW1zLkJyZXdIZWFkc1VwRGlzcGxheVR5cGUpIHtcclxuICAgIGhlYWRzVXBEaXNwbGF5RHJhdyhwYWdlT2ZOb3RlczogQnJldy5IVUQuSUhlYWRzVXBQYWdlKSB7XHJcblxyXG4gICAgICAgIGxldCBsZXZlbCA9IHRoaXMuZ20uZ2V0Q3VycmVudExldmVsKClcclxuICAgICAgICBsZXQgbGV0dGVyIDogc3RyaW5nXHJcblxyXG4gICAgICAgIC8vIHRoaXMuY2xlYXJEaXNwbGF5KEJyZXcuRW51bXMuRGlzcGxheU5hbWVzLkhVRClcclxuICAgICAgICB0aGlzLmRyYXdBbGwoe2JsYWNrQW5kV2hpdGVNb2RlOiB0cnVlfSlcclxuICAgICAgICBcclxuICAgICAgICAvLyB0cmVhdCBsZXR0ZXJzIGFzIGEgZ3JpZFxyXG4gICAgICAgIGxldCBodWRfbGV0dGVyZ3JpZCA6IEJyZXcuR3JpZE9mVGhpbmdzPElDaGFyQW5kQ29sb3I+ID0gcGFnZU9mTm90ZXMuZ3JpZCAvLyBCcmV3LkhVRC5nZXRIVURMZXR0ZXJHcmlkKHRoaXMuZ20sIGxpc3RPZk5vdGVzKVxyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIGRyYXcgdGhlIGxldHRlciBncmlkXHJcbiAgICAgICAgaHVkX2xldHRlcmdyaWQuZ2V0QWxsQ29vcmRpbmF0ZXMoKS5mb3JFYWNoKCh4eTogQnJldy5Db29yZGluYXRlLCBpbmRleDogbnVtYmVyKSA9PiB7XHJcbiAgICAgICAgICAgIGxldHRlciA9IGh1ZF9sZXR0ZXJncmlkLmdldEF0KHh5KS5jaGFyXHJcbiAgICAgICAgICAgIC8vIHRoaXMuZ2V0RGlzcGxheShCcmV3LkVudW1zLkRpc3BsYXlOYW1lcy5IVUQpLmRyYXcoeHkueCwgeHkueSwgbGV0dGVyKVxyXG4gICAgICAgICAgICB0aGlzLmdldERpc3BsYXkoQnJldy5FbnVtcy5EaXNwbGF5TmFtZXMuR2FtZSkuZHJhdyh4eS54LCB4eS55LCBsZXR0ZXIsIFJPVC5Db2xvci50b0hleChodWRfbGV0dGVyZ3JpZC5nZXRBdCh4eSkuY29sb3IpKVxyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgZHJhd05vdGVzT250b0Zvb3Rlcihub3Rlc19saXN0OiBBcnJheTxCcmV3LkhVRC5IVUROb3RlPiwgc3RhcnRfcm93OiBudW1iZXIsIG1heF9yb3dzOiBudW1iZXIpIHtcclxuICAgICAgICBsZXQgbmV3X3RleHQgOiBzdHJpbmdcclxuICAgICAgICBsZXQgcnVubmluZ193aWR0aCA9IDBcclxuICAgICAgICBsZXQgY3VycmVudF9yb3cgPSBzdGFydF9yb3dcclxuICAgICAgICBsZXQgbWF4X3dpZHRoID0gQnJldy5Db25maWcuc2NyZWVuX3dpZHRoX3RpbGVzXHJcblxyXG4gICAgICAgIGxldCB0ZXh0X2NvbG9yIDogSUNvbG9yXHJcbiAgICAgICAgaWYgKEJyZXcuRGVidWcuQk9TU19NT0RFKSB7XHJcbiAgICAgICAgICAgIHRleHRfY29sb3IgPSBCcmV3LkNvbG9yLmJsYWNrXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGV4dF9jb2xvciA9IEJyZXcuQ29sb3Iubm9ybWFsXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5vdGVzX2xpc3QubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgbmV3X3RleHQgPSBub3Rlc19saXN0W2ldLmdldE5vdGVUZXh0KCkgKyBcIiBcIlxyXG4gICAgICAgICAgICBpZiAoKHJ1bm5pbmdfd2lkdGggKyBuZXdfdGV4dC5sZW5ndGgpID4gbWF4X3dpZHRoKSB7XHJcbiAgICAgICAgICAgICAgICBjdXJyZW50X3JvdyArPSAxXHJcbiAgICAgICAgICAgICAgICBydW5uaW5nX3dpZHRoID0gMFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoY3VycmVudF9yb3cgPj0gKHN0YXJ0X3JvdyArIG1heF9yb3dzKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZvciAobGV0IHcgPSAwOyB3IDwgbmV3X3RleHQubGVuZ3RoOyB3KyspIHtcclxuICAgICAgICAgICAgICAgIGxldCB3cml0ZV9jb2xvciA6IElDb2xvclxyXG4gICAgICAgICAgICAgICAgaWYgKCh3ID09IDApICYmIChub3Rlc19saXN0W2ldLnN1YmplY3QuY29sb3IpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgd3JpdGVfY29sb3IgPSA8SUNvbG9yPihub3Rlc19saXN0W2ldLnN1YmplY3QuY29sb3IpXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHdyaXRlX2NvbG9yID0gdGV4dF9jb2xvclxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdGhpcy5nZXREaXNwbGF5KEJyZXcuRW51bXMuRGlzcGxheU5hbWVzLkZvb3RlcikuZHJhdyhydW5uaW5nX3dpZHRoICsgdywgY3VycmVudF9yb3csIG5ld190ZXh0W3ddLCBST1QuQ29sb3IudG9IZXgod3JpdGVfY29sb3IpKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJ1bm5pbmdfd2lkdGggKz0gbmV3X3RleHQubGVuZ3RoXHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICBkcmF3UG9wdXBNZXNzYWdlKG1zZ190ZXh0OiBzdHJpbmcsIGxvY2F0aW9uX3h5OiBCcmV3LkNvb3JkaW5hdGUsIGNvbG9yOiBJQ29sb3IsIGRlbGF5PzogbnVtYmVyKSB7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKCEoZGVsYXkpKSB7XHJcbiAgICAgICAgICAgIGRlbGF5ID0gQnJldy5Db25maWcucG9wdXBfbXNnX3NwZWVkXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgaHVkX2Rpc3BsYXkgPSB0aGlzLmdldERpc3BsYXkoQnJldy5FbnVtcy5EaXNwbGF5TmFtZXMuSFVEKVxyXG4gICAgICAgIGxldCBtYXhfd2lkdGggPSBCcmV3LkNvbmZpZy5zY3JlZW5fd2lkdGhfdGlsZXNcclxuICAgICAgICBsZXQgbXNnX3dpZHRoID0gTWF0aC5taW4obWF4X3dpZHRoLCBtc2dfdGV4dC5sZW5ndGgpXHJcblxyXG4gICAgICAgIGxldCBtc2dfdGV4dF90cmltbWVkID0gbXNnX3RleHQvLy5zdWJzdHJpbmcoMCwgbXNnX3dpZHRoKVxyXG5cclxuICAgICAgICBsZXQgYmxhbmtfbGV0dGVyX2dyaWQgPSBuZXcgQnJldy5HcmlkT2ZUaGluZ3M8SUNoYXJBbmRDb2xvcj4oKVxyXG4gICAgICAgIGxldCBzdWNjZXNzID0gQnJldy5IVUQucGxhY2VXb3Jkc09uTGV0dGVyR3JpZChibGFua19sZXR0ZXJfZ3JpZCwgbXNnX3RleHRfdHJpbW1lZCwgQnJldy5Db2xvci53aGl0ZSwgbG9jYXRpb25feHkpXHJcblxyXG4gICAgICAgIGJsYW5rX2xldHRlcl9ncmlkLmdldEFsbENvb3JkaW5hdGVzKCkuZm9yRWFjaCgoeHk6IEJyZXcuQ29vcmRpbmF0ZSwgaW5kZXg6IG51bWJlcikgPT4ge1xyXG4gICAgICAgICAgICBsZXQgbGV0dGVyID0gYmxhbmtfbGV0dGVyX2dyaWQuZ2V0QXQoeHkpLmNoYXJcclxuICAgICAgICAgICAgLy8gdGhpcy5nZXREaXNwbGF5KEJyZXcuRW51bXMuRGlzcGxheU5hbWVzLkhVRCkuZHJhdyh4eS54LCB4eS55LCBsZXR0ZXIpXHJcbiAgICAgICAgICAgIHRoaXMuZ2V0RGlzcGxheShCcmV3LkVudW1zLkRpc3BsYXlOYW1lcy5IVUQpLmRyYXcoeHkueCwgeHkueSwgbGV0dGVyLCBST1QuQ29sb3IudG9IZXgoYmxhbmtfbGV0dGVyX2dyaWQuZ2V0QXQoeHkpLmNvbG9yKSlcclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICAvLyBodWRfZGlzcGxheS5kcmF3VGV4dChsb2NhdGlvbl94eS54LCBsb2NhdGlvbl94eS55LCBtc2dfdGV4dCwgbWF4X3dpZHRoKVxyXG5cclxuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgLy8gaHVkX2Rpc3BsYXkuY2xlYXJSZWN0X1RpbGVzKGxvY2F0aW9uX3h5LngsIGxvY2F0aW9uX3h5LnksIG1zZ193aWR0aCwgMSlcclxuICAgICAgICAgICAgYmxhbmtfbGV0dGVyX2dyaWQuZ2V0QWxsQ29vcmRpbmF0ZXMoKS5mb3JFYWNoKCh4eTogQnJldy5Db29yZGluYXRlLCBpbmRleDogbnVtYmVyKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBodWRfZGlzcGxheS5jbGVhclJlY3RfVGlsZXMoeHkueCwgeHkueSwgMSwgMSlcclxuICAgICAgICAgICAgfSlcclxuICAgIFxyXG4gICAgICAgIH0sIGRlbGF5KVxyXG4gICAgfVxyXG5cclxuICAgIGRyYXdIZWxwTWVudShoZWxwTXNnSW5kZXg6IG51bWJlcikge1xyXG4gICAgICAgIHRoaXMuZHJhd0FsbCh7YmxhY2tBbmRXaGl0ZU1vZGU6IHRydWV9KVxyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgLy8gZGVmaW5lIG91ciB3b3JrIGFyb3VuZFxyXG4gICAgICAgIGxldCB0b3BsZWZ0X3h5ID0gbmV3IEJyZXcuQ29vcmRpbmF0ZSgxLCAxKVxyXG4gICAgICAgIGxldCBib3R0b21yaWdodF94eSA9IG5ldyBCcmV3LkNvb3JkaW5hdGUoQnJldy5Db25maWcuc2NyZWVuX3dpZHRoX3RpbGVzIC0gMiwgQnJldy5Db25maWcuc2NyZWVuX2hlaWdodF90aWxlcyAtIDIpXHJcblxyXG4gICAgICAgIGxldCBmdWxsX3dpZHRoID0gKGJvdHRvbXJpZ2h0X3h5LnggLSB0b3BsZWZ0X3h5LngpXHJcbiAgICAgICAgbGV0IGhhbGZfd2lkdGggPSBNYXRoLmZsb29yKGZ1bGxfd2lkdGggLyAyKVxyXG4gICAgICAgIFxyXG4gICAgICAgIGxldCBtZW51X2ZyYW1lX2NvbG9yID0gQnJldy5Db2xvci5nb2xkZW5yb2RcclxuICAgICAgICBcclxuICAgICAgICBsZXQgYmdfZnJhbWVfY29sb3IgOiBJQ29sb3IgPSBCcmV3LkNvbG9yLmRhcmtfZ3JheVxyXG4gICAgICAgIHRoaXMuZHJhd0ZyYW1lKEJyZXcuRW51bXMuRGlzcGxheU5hbWVzLkdhbWUsIHRvcGxlZnRfeHksIGJvdHRvbXJpZ2h0X3h5LCBtZW51X2ZyYW1lX2NvbG9yLCBiZ19mcmFtZV9jb2xvciwgXCJIRUxQXCIpXHJcbiAgICAgICAgXHJcbiAgICAgICAgbGV0IGJnY29sb3JfdGV4dCA9IFwiJWJ7XCIrIFJPVC5Db2xvci50b0hleChiZ19mcmFtZV9jb2xvcikgKyBcIn1cIlxyXG4gICAgICAgIGxldCBmckRpc3BsYXkgPSB0aGlzLmdldERpc3BsYXkoQnJldy5FbnVtcy5EaXNwbGF5TmFtZXMuR2FtZSlcclxuXHJcbiAgICAgICAgbGV0IGN1cnJlbnRfeSA9IHRvcGxlZnRfeHkueSArIDFcclxuICAgICAgICBsZXQgbWF4X3kgPSBCcmV3LkNvbmZpZy5tYXBfaGVpZ2h0X3RpbGVzIC0gMlxyXG4gICAgICAgIHdoaWxlIChoZWxwTXNnSW5kZXggPCBCcmV3LlRhbmsuaGVscE1lc3NhZ2VzLmxlbmd0aCkge1xyXG5cclxuICAgICAgICAgICAgbGV0IGxpbmVfY291bnQgPSBmckRpc3BsYXkuZHJhd1RleHQodG9wbGVmdF94eS54ICsgMSwgY3VycmVudF95LCBiZ2NvbG9yX3RleHQgKyBCcmV3LlRhbmsuaGVscE1lc3NhZ2VzW2hlbHBNc2dJbmRleF0sIGZ1bGxfd2lkdGggLSAxKVxyXG5cclxuICAgICAgICAgICAgaWYgKChjdXJyZW50X3kgKyBsaW5lX2NvdW50ICsgMSkgPiBtYXhfeSkge1xyXG4gICAgICAgICAgICAgICAgYnJlYWtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY3VycmVudF95ICs9IGxpbmVfY291bnQgKyAxXHJcbiAgICAgICAgICAgIGhlbHBNc2dJbmRleCArPSAxXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbn1cclxuXHJcbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/brew_game/display.ts\n");

/***/ }),

/***/ "./src/brew_game/glossary.ts":
/*!***********************************!*\
  !*** ./src/brew_game/glossary.ts ***!
  \***********************************/
/*! exports provided: getPowerName, getPowerShortName, getPowerDesc, getItemDescription, getItemName, getFeatureName, getFeatureDescription */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getPowerName\", function() { return getPowerName; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getPowerShortName\", function() { return getPowerShortName; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getPowerDesc\", function() { return getPowerDesc; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getItemDescription\", function() { return getItemDescription; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getItemName\", function() { return getItemName; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getFeatureName\", function() { return getFeatureName; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getFeatureDescription\", function() { return getFeatureDescription; });\n/* harmony import */ var _brew__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../brew */ \"./src/brew.ts\");\n// store all (or most) text-based descriptions and names of things that get displayed\r\n\r\nfunction getPowerName(power) {\r\n    return GlossaryPower[power.powerType].longName;\r\n}\r\nfunction getPowerShortName(power) {\r\n    return GlossaryPower[power.powerType].shortName;\r\n}\r\nfunction getPowerDesc(pow) {\r\n    // return GlossaryPower[power.powerType].description\r\n    let desc;\r\n    if (pow.powerType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewPowerType.EmptyNone) {\r\n        desc = \"Nothing installed\";\r\n    }\r\n    else {\r\n        desc = GlossaryPower[pow.powerType].description;\r\n    }\r\n    desc += \"\\n\\nAmmo: \" + pow.charge_stat.getCurrentLevel() + \" / \" + pow.charge_stat.getMaxLevel();\r\n    // desc += \"\\nLevel: \" + pow.strength.getCurrentLevel()\r\n    return desc;\r\n}\r\nlet GlossaryPower = {};\r\nGlossaryPower[_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewPowerType.TurretCannon] = {\r\n    longName: \"Turret Gun\",\r\n    shortName: \"TURRET\",\r\n    description: \"Giant turret cannon\",\r\n};\r\nGlossaryPower[_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewPowerType.MachineGun] = {\r\n    longName: \"Machine Gun\",\r\n    shortName: \"M85\",\r\n    description: \"Smaller more manueverable machine gun\",\r\n};\r\nGlossaryPower[_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewPowerType.Scanner] = {\r\n    longName: \"Scanner\",\r\n    shortName: \"SCAN\",\r\n    description: \"Long range scanner\",\r\n};\r\n// GlossaryPower[Enums.BrewPowerType.] = {\r\n//     longName: \"\",\r\n//     shortName: \"\",\r\n//     description: \"\",\r\n// }\r\nlet GlossaryItemType = {};\r\nGlossaryItemType[_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].ItemType.Grenade] = \"A small grenade, light enough to throw.\";\r\n// GlossaryItemType[Brew.Definitions.ItemType.KeyCard] = \"Used for accessing secure areas\"\r\n// GlossaryItemType[Brew.Definitions.ItemType.Nanotech] = \"Small phial of inert nanites.\"// When shattered, nanites will interact with the immediate surroundings in strange ways.\"\r\nGlossaryItemType[_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].ItemType.PowerRelatedItem] = \"Special Item\";\r\nGlossaryItemType[_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].ItemType.PowerSystem] = \"Power modules give special abilities\";\r\n// GlossaryItemType[Brew.Definitions.ItemType.Wreckage] = \"Smoldering shell of a destroyed robot\"\r\n// GlossaryItemType[Brew.Definitions.ItemType.MacGuffin] = \"This is how you win the game for now!\"\r\n// GlossaryItemType[Brew.Definitions.ItemType.WarpCrystal] = \"Functions as a unique fuel for telewarp technology\"// - essential for communicating with home base\" // transponder\r\nGlossaryItemType[_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].ItemType.Bullets] = \"Reloads machine gun after each area checkpoint\";\r\nGlossaryItemType[_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].ItemType.Civilian] = \"Successful rescues add to your score\";\r\nGlossaryItemType[_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].ItemType.Shells] = \"Reloads turret gun after each area checkpoint\";\r\nGlossaryItemType[_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].ItemType.Supplies] = \"Restores armor after each area checkpoint\";\r\nlet GlossaryItemSubType = {};\r\nGlossaryItemSubType[_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].ItemSubtype.G_Concusive] = {\r\n    longName: \"Blast Grenade\",\r\n    description: \"Unleases a blast of force, knocking back any targets\",\r\n};\r\nGlossaryItemSubType[_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].ItemSubtype.G_Explosive] = {\r\n    longName: \"Grenade\",\r\n    description: \"Explodes and does direct damage to any targets caught in the blast\"\r\n};\r\nGlossaryItemSubType[_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].ItemSubtype.G_Stun] = {\r\n    longName: \"Stun Grenade\",\r\n    description: \"Temporarily stuns any targets in range, but otherwise does no damage.\"\r\n};\r\nGlossaryItemSubType[_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].ItemSubtype.N_Acid] = {\r\n    longName: \"Nanotech (Corrosive)\",\r\n    description: \"Causes corrision - infected target can be destroyed in one hit\" //& brittle armor\r\n};\r\nGlossaryItemSubType[_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].ItemSubtype.N_Armor] = {\r\n    longName: \"Nanotech (Armor)\",\r\n    description: \"Hardens armor, making infected targets temporarily invincible\"\r\n};\r\nGlossaryItemSubType[_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].ItemSubtype.N_Health] = {\r\n    longName: \"Nanotech (Repair)\",\r\n    description: \"Has a regenerative affect - heals any target exposed\"\r\n};\r\n// GlossaryItemSubType[Brew.Definitions.ItemSubtype.NonSpecific]\r\nGlossaryItemSubType[_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].ItemSubtype.PowerItem_Axe] = {\r\n    longName: \"Heavy Axe\",\r\n    description: \"The heavy axe, quantum-bound to whomever threw it here\"\r\n};\r\nGlossaryItemSubType[_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].ItemSubtype.PowerItem_Gun] = {\r\n    longName: \"???\",\r\n    description: \"NOT SEEN?\"\r\n};\r\nfunction getItemDescription(item) {\r\n    let item_desc;\r\n    if (item.subtype != _brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].ItemSubtype.NonSpecific) {\r\n        item_desc = {\r\n            typeDesc: GlossaryItemType[item.getDefinition()],\r\n            subTypeDesc: GlossaryItemSubType[item.subtype].description\r\n        };\r\n    }\r\n    else {\r\n        item_desc = {\r\n            typeDesc: GlossaryItemType[item.getDefinition()]\r\n        };\r\n    }\r\n    return item_desc;\r\n}\r\nfunction getItemName(item) {\r\n    let name = \"unnamed item\";\r\n    if (item.isType(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].ItemType.PowerSystem)) {\r\n        name = \"Power: \" + getPowerShortName(item.power);\r\n    }\r\n    else if (item.subtype == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].ItemSubtype.NonSpecific) {\r\n        name = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].ItemType[item.getDefinition()];\r\n    }\r\n    else {\r\n        // if (item.getDefinition() == Brew.Definitions.ItemType.Grenade) {\r\n        //     name = Brew.Definitions.ItemSubtype[item.subtype]\r\n        // } \r\n        name = GlossaryItemSubType[item.subtype].longName;\r\n    }\r\n    return name;\r\n}\r\nlet GlossaryFeature = {};\r\nGlossaryFeature[_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].FeatureType.CorrosiveAcid] = {\r\n    longName: \"Corrosive Nanobots\",\r\n    description: GlossaryItemSubType[_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].ItemSubtype.N_Acid].description\r\n};\r\nGlossaryFeature[_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].FeatureType.Fire] = {\r\n    longName: \"Fire\",\r\n    description: \"The flames flicker dangerously\"\r\n};\r\nGlossaryFeature[_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].FeatureType.ProtectiveGoo] = {\r\n    longName: \"Armor Nanobots\",\r\n    description: GlossaryItemSubType[_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].ItemSubtype.N_Armor].description\r\n};\r\nGlossaryFeature[_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].FeatureType.RepairGoo] = {\r\n    longName: \"Repair Nanobots\",\r\n    description: GlossaryItemSubType[_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].ItemSubtype.N_Health].description\r\n};\r\nGlossaryFeature[_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].FeatureType.Scrap] = {\r\n    longName: \"Scrap\",\r\n    description: \"Debris from a previous battle\"\r\n};\r\n// GlossaryFeature[Brew.Definitions.FeatureType.] = {\r\n//     longName: \"\",\r\n//     description: \"\"\r\n// }\r\nfunction getFeatureName(feature) {\r\n    return GlossaryFeature[feature.getDefinition()].longName;\r\n}\r\nfunction getFeatureDescription(feature) {\r\n    return GlossaryFeature[feature.getDefinition()].description;\r\n}\r\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvYnJld19nYW1lL2dsb3NzYXJ5LnRzP2Y4MTciXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBQTtBQUFBLHFGQUFxRjtBQUV0RDtBQVF6QixzQkFBdUIsS0FBd0I7SUFDakQsTUFBTSxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLENBQUMsUUFBUTtBQUNsRCxDQUFDO0FBRUssMkJBQTRCLEtBQXdCO0lBQ3RELE1BQU0sQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLFNBQVMsQ0FBQyxDQUFDLFNBQVM7QUFDbkQsQ0FBQztBQUVLLHNCQUF1QixHQUFzQjtJQUMvQyxvREFBb0Q7SUFDcEQsSUFBSSxJQUFhO0lBQ2pCLEVBQUUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxTQUFTLElBQUksMkNBQVUsQ0FBQyxhQUFhLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQztRQUN0RCxJQUFJLEdBQUcsbUJBQW1CO0lBQzlCLENBQUM7SUFBQyxJQUFJLENBQUMsQ0FBQztRQUNKLElBQUksR0FBRyxhQUFhLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxDQUFDLFdBQVc7SUFDbkQsQ0FBQztJQUVELElBQUksSUFBSSxZQUFZLEdBQUcsR0FBRyxDQUFDLFdBQVcsQ0FBQyxlQUFlLEVBQUUsR0FBRyxLQUFLLEdBQUcsR0FBRyxDQUFDLFdBQVcsQ0FBQyxXQUFXLEVBQUU7SUFDaEcsdURBQXVEO0lBRXZELE1BQU0sQ0FBQyxJQUFJO0FBRWYsQ0FBQztBQUVELElBQUksYUFBYSxHQUE4QyxFQUFFO0FBRWpFLGFBQWEsQ0FBQywyQ0FBVSxDQUFDLGFBQWEsQ0FBQyxZQUFZLENBQUMsR0FBRztJQUNuRCxRQUFRLEVBQUUsWUFBWTtJQUN0QixTQUFTLEVBQUUsUUFBUTtJQUNuQixXQUFXLEVBQUUscUJBQXFCO0NBQ3JDO0FBQ0QsYUFBYSxDQUFDLDJDQUFVLENBQUMsYUFBYSxDQUFDLFVBQVUsQ0FBQyxHQUFHO0lBQ2pELFFBQVEs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LGlEQUFnQixDQUFDLFdBQVcsQ0FBQyxNQUFNLENBQUMsQ0FBQyxXQUFXO0NBQ3BGO0FBQ0QsZUFBZSxDQUFDLGlEQUFnQixDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsR0FBRztJQUNqRCxRQUFRLEVBQUUsTUFBTTtJQUNoQixXQUFXLEVBQUUsZ0NBQWdDO0NBQ2hEO0FBQ0QsZUFBZSxDQUFDLGlEQUFnQixDQUFDLFdBQVcsQ0FBQyxhQUFhLENBQUMsR0FBRztJQUMxRCxRQUFRLEVBQUUsZ0JBQWdCO0lBQzFCLFdBQVcsRUFBRSxtQkFBbUIsQ0FBQyxpREFBZ0IsQ0FBQyxXQUFXLENBQUMsT0FBTyxDQUFDLENBQUMsV0FBVztDQUNyRjtBQUNELGVBQWUsQ0FBQyxpREFBZ0IsQ0FBQyxXQUFXLENBQUMsU0FBUyxDQUFDLEdBQUc7SUFDdEQsUUFBUSxFQUFFLGlCQUFpQjtJQUMzQixXQUFXLEVBQUUsbUJBQW1CLENBQUMsaURBQWdCLENBQUMsV0FBVyxDQUFDLFFBQVEsQ0FBQyxDQUFDLFdBQVc7Q0FDdEY7QUFDRCxlQUFlLENBQUMsaURBQWdCLENBQUMsV0FBVyxDQUFDLEtBQUssQ0FBQyxHQUFHO0lBQ2xELFFBQVEsRUFBRSxPQUFPO0lBQ2pCLFdBQVcsRUFBRSwrQkFBK0I7Q0FDL0M7QUFDRCxxREFBcUQ7QUFDckQsb0JBQW9CO0FBQ3BCLHNCQUFzQjtBQUN0QixJQUFJO0FBQ0Usd0JBQXlCLE9BQWdDO0lBQzNELE1BQU0sQ0FBQyxlQUFlLENBQUMsT0FBTyxDQUFDLGFBQWEsRUFBRSxDQUFDLENBQUMsUUFBUTtBQUM1RCxDQUFDO0FBQ0ssK0JBQWdDLE9BQWdDO0lBQ2xFLE1BQU0sQ0FBQyxlQUFlLENBQUMsT0FBTyxDQUFDLGFBQWEsRUFBRSxDQUFDLENBQUMsV0FBVztBQUMvRCxDQUFDIiwiZmlsZSI6Ii4vc3JjL2JyZXdfZ2FtZS9nbG9zc2FyeS50cy5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vIHN0b3JlIGFsbCAob3IgbW9zdCkgdGV4dC1iYXNlZCBkZXNjcmlwdGlvbnMgYW5kIG5hbWVzIG9mIHRoaW5ncyB0aGF0IGdldCBkaXNwbGF5ZWRcclxuXHJcbmltcG9ydCAqIGFzIEJyZXcgZnJvbSAnLi4vYnJldydcclxuXHJcbmludGVyZmFjZSBJR2xvc3NhcnlQb3dlciB7XHJcbiAgICBzaG9ydE5hbWU6IHN0cmluZ1xyXG4gICAgbG9uZ05hbWU6IHN0cmluZ1xyXG4gICAgZGVzY3JpcHRpb246IHN0cmluZ1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0UG93ZXJOYW1lKHBvd2VyOiBCcmV3LlBvd2Vycy5Qb3dlcikgOiBzdHJpbmcge1xyXG4gICAgcmV0dXJuIEdsb3NzYXJ5UG93ZXJbcG93ZXIucG93ZXJUeXBlXS5sb25nTmFtZVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0UG93ZXJTaG9ydE5hbWUocG93ZXI6IEJyZXcuUG93ZXJzLlBvd2VyKSA6IHN0cmluZyB7XHJcbiAgICByZXR1cm4gR2xvc3NhcnlQb3dlcltwb3dlci5wb3dlclR5cGVdLnNob3J0TmFtZVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0UG93ZXJEZXNjKHBvdzogQnJldy5Qb3dlcnMuUG93ZXIpIDogc3RyaW5nIHtcclxuICAgIC8vIHJldHVybiBHbG9zc2FyeVBvd2VyW3Bvd2VyLnBvd2VyVHlwZV0uZGVzY3JpcHRpb25cclxuICAgIGxldCBkZXNjIDogc3RyaW5nXHJcbiAgICBpZiAocG93LnBvd2VyVHlwZSA9PSBCcmV3LkVudW1zLkJyZXdQb3dlclR5cGUuRW1wdHlOb25lKSB7XHJcbiAgICAgICAgZGVzYyA9IFwiTm90aGluZyBpbnN0YWxsZWRcIlxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBkZXNjID0gR2xvc3NhcnlQb3dlcltwb3cucG93ZXJUeXBlXS5kZXNjcmlwdGlvblxyXG4gICAgfVxyXG5cclxuICAgIGRlc2MgKz0gXCJcXG5cXG5BbW1vOiBcIiArIHBvdy5jaGFyZ2Vfc3RhdC5nZXRDdXJyZW50TGV2ZWwoKSArIFwiIC8gXCIgKyBwb3cuY2hhcmdlX3N0YXQuZ2V0TWF4TGV2ZWwoKVxyXG4gICAgLy8gZGVzYyArPSBcIlxcbkxldmVsOiBcIiArIHBvdy5zdHJlbmd0aC5nZXRDdXJyZW50TGV2ZWwoKVxyXG5cclxuICAgIHJldHVybiBkZXNjXHJcbiAgICBcclxufVxyXG5cclxubGV0IEdsb3NzYXJ5UG93ZXIgOiB7IFtwb3dlclR5cGU6IHN0cmluZ10gOiBJR2xvc3NhcnlQb3dlciB9ID0ge31cclxuXHJcbkdsb3NzYXJ5UG93ZXJbQnJldy5FbnVtcy5CcmV3UG93ZXJUeXBlLlR1cnJldENhbm5vbl0gPSB7XHJcbiAgICBsb25nTmFtZTogXCJUdXJyZXQgR3VuXCIsXHJcbiAgICBzaG9ydE5hbWU6IFwiVFVSUkVUXCIsXHJcbiAgICBkZXNjcmlwdGlvbjogXCJHaWFudCB0dXJyZXQgY2Fubm9uXCIsXHJcbn1cclxuR2xvc3NhcnlQb3dlcltCcmV3LkVudW1zLkJyZXdQb3dlclR5cGUuTWFjaGluZUd1bl0gPSB7XHJcbiAgICBsb25nTmFtZTogXCJNYWNoaW5lIEd1blwiLFxyXG4gICAgc2hvcnROYW1lOiBcIk04NVwiLFxyXG4gICAgZGVzY3JpcHRpb246IFwiU21hbGxlciBtb3JlIG1hbnVldmVyYWJsZSBtYWNoaW5lIGd1blwiLFxyXG59XHJcbkdsb3NzYXJ5UG93ZXJbQnJldy5FbnVtcy5CcmV3UG93ZXJUeXBlLlNjYW5uZXJdID0ge1xyXG4gICAgbG9uZ05hbWU6IFwiU2Nhbm5lclwiLFxyXG4gICAgc2hvcnROYW1lOiBcIlNDQU5cIixcclxuICAgIGRlc2NyaXB0aW9uOiBcIkxvbmcgcmFuZ2Ugc2Nhbm5lclwiLFxyXG59XHJcblxyXG4vLyBHbG9zc2FyeVBvd2VyW0VudW1zLkJyZXdQb3dlclR5cGUuXSA9IHtcclxuLy8gICAgIGxvbmdOYW1lOiBcIlwiLFxyXG4vLyAgICAgc2hvcnROYW1lOiBcIlwiLFxyXG4vLyAgICAgZGVzY3JpcHRpb246IFwiXCIsXHJcbi8vIH1cclxuXHJcbmxldCBHbG9zc2FyeUl0ZW1UeXBlIDogeyBbaXRlbVR5cGU6IHN0cmluZ10gOiBzdHJpbmcgfSA9IHt9XHJcbkdsb3NzYXJ5SXRlbVR5cGVbQnJldy5EZWZpbml0aW9ucy5JdGVtVHlwZS5HcmVuYWRlXSA9IFwiQSBzbWFsbCBncmVuYWRlLCBsaWdodCBlbm91Z2ggdG8gdGhyb3cuXCJcclxuLy8gR2xvc3NhcnlJdGVtVHlwZVtCcmV3LkRlZmluaXRpb25zLkl0ZW1UeXBlLktleUNhcmRdID0gXCJVc2VkIGZvciBhY2Nlc3Npbmcgc2VjdXJlIGFyZWFzXCJcclxuLy8gR2xvc3NhcnlJdGVtVHlwZVtCcmV3LkRlZmluaXRpb25zLkl0ZW1UeXBlLk5hbm90ZWNoXSA9IFwiU21hbGwgcGhpYWwgb2YgaW5lcnQgbmFuaXRlcy5cIi8vIFdoZW4gc2hhdHRlcmVkLCBuYW5pdGVzIHdpbGwgaW50ZXJhY3Qgd2l0aCB0aGUgaW1tZWRpYXRlIHN1cnJvdW5kaW5ncyBpbiBzdHJhbmdlIHdheXMuXCJcclxuR2xvc3NhcnlJdGVtVHlwZVtCcmV3LkRlZmluaXRpb25zLkl0ZW1UeXBlLlBvd2VyUmVsYXRlZEl0ZW1dID0gXCJTcGVjaWFsIEl0ZW1cIlxyXG5HbG9zc2FyeUl0ZW1UeXBlW0JyZXcuRGVmaW5pdGlvbnMuSXRlbVR5cGUuUG93ZXJTeXN0ZW1dID0gXCJQb3dlciBtb2R1bGVzIGdpdmUgc3BlY2lhbCBhYmlsaXRpZXNcIlxyXG4vLyBHbG9zc2FyeUl0ZW1UeXBlW0JyZXcuRGVmaW5pdGlvbnMuSXRlbVR5cGUuV3JlY2thZ2VdID0gXCJTbW9sZGVyaW5nIHNoZWxsIG9mIGEgZGVzdHJveWVkIHJvYm90XCJcclxuLy8gR2xvc3NhcnlJdGVtVHlwZVtCcmV3LkRlZmluaXRpb25zLkl0ZW1UeXBlLk1hY0d1ZmZpbl0gPSBcIlRoaXMgaXMgaG93IHlvdSB3aW4gdGhlIGdhbWUgZm9yIG5vdyFcIlxyXG4vLyBHbG9zc2FyeUl0ZW1UeXBlW0JyZXcuRGVmaW5pdGlvbnMuSXRlbVR5cGUuV2FycENyeXN0YWxdID0gXCJGdW5jdGlvbnMgYXMgYSB1bmlxdWUgZnVlbCBmb3IgdGVsZXdhcnAgdGVjaG5vbG9neVwiLy8gLSBlc3NlbnRpYWwgZm9yIGNvbW11bmljYXRpbmcgd2l0aCBob21lIGJhc2VcIiAvLyB0cmFuc3BvbmRlclxyXG5HbG9zc2FyeUl0ZW1UeXBlW0JyZXcuRGVmaW5pdGlvbnMuSXRlbVR5cGUuQnVsbGV0c10gPSBcIlJlbG9hZHMgbWFjaGluZSBndW4gYWZ0ZXIgZWFjaCBhcmVhIGNoZWNrcG9pbnRcIlxyXG5HbG9zc2FyeUl0ZW1UeXBlW0JyZXcuRGVmaW5pdGlvbnMuSXRlbVR5cGUuQ2l2aWxpYW5dID0gXCJTdWNjZXNzZnVsIHJlc2N1ZXMgYWRkIHRvIHlvdXIgc2NvcmVcIlxyXG5HbG9zc2FyeUl0ZW1UeXBlW0JyZXcuRGVmaW5pdGlvbnMuSXRlbVR5cGUuU2hlbGxzXSA9IFwiUmVsb2FkcyB0dXJyZXQgZ3VuIGFmdGVyIGVhY2ggYXJlYSBjaGVja3BvaW50XCJcclxuR2xvc3NhcnlJdGVtVHlwZVtCcmV3LkRlZmluaXRpb25zLkl0ZW1UeXBlLlN1cHBsaWVzXSA9IFwiUmVzdG9yZXMgYXJtb3IgYWZ0ZXIgZWFjaCBhcmVhIGNoZWNrcG9pbnRcIlxyXG5cclxuXHJcblxyXG5pbnRlcmZhY2UgSUdsb3NzYXJ5SXRlbVN1YlR5cGUge1xyXG4gICAgbG9uZ05hbWU6IHN0cmluZyxcclxuICAgIGRlc2NyaXB0aW9uOiBzdHJpbmcsXHJcbn1cclxuXHJcbmxldCBHbG9zc2FyeUl0ZW1TdWJUeXBlIDogeyBbaXRlbVN1YlR5cGU6IHN0cmluZ10gOiBJR2xvc3NhcnlJdGVtU3ViVHlwZSB9ID0ge31cclxuR2xvc3NhcnlJdGVtU3ViVHlwZVtCcmV3LkRlZmluaXRpb25zLkl0ZW1TdWJ0eXBlLkdfQ29uY3VzaXZlXSA9IHtcclxuICAgIGxvbmdOYW1lOiBcIkJsYXN0IEdyZW5hZGVcIixcclxuICAgIGRlc2NyaXB0aW9uOiBcIlVubGVhc2VzIGEgYmxhc3Qgb2YgZm9yY2UsIGtub2NraW5nIGJhY2sgYW55IHRhcmdldHNcIixcclxufVxyXG5HbG9zc2FyeUl0ZW1TdWJUeXBlW0JyZXcuRGVmaW5pdGlvbnMuSXRlbVN1YnR5cGUuR19FeHBsb3NpdmVdID0ge1xyXG4gICAgbG9uZ05hbWU6IFwiR3JlbmFkZVwiLFxyXG4gICAgZGVzY3JpcHRpb246IFwiRXhwbG9kZXMgYW5kIGRvZXMgZGlyZWN0IGRhbWFnZSB0byBhbnkgdGFyZ2V0cyBjYXVnaHQgaW4gdGhlIGJsYXN0XCJcclxufVxyXG5HbG9zc2FyeUl0ZW1TdWJUeXBlW0JyZXcuRGVmaW5pdGlvbnMuSXRlbVN1YnR5cGUuR19TdHVuXSA9IHtcclxuICAgIGxvbmdOYW1lOiBcIlN0dW4gR3JlbmFkZVwiLFxyXG4gICAgZGVzY3JpcHRpb246IFwiVGVtcG9yYXJpbHkgc3R1bnMgYW55IHRhcmdldHMgaW4gcmFuZ2UsIGJ1dCBvdGhlcndpc2UgZG9lcyBubyBkYW1hZ2UuXCJcclxufVxyXG5HbG9zc2FyeUl0ZW1TdWJUeXBlW0JyZXcuRGVmaW5pdGlvbnMuSXRlbVN1YnR5cGUuTl9BY2lkXSA9IHtcclxuICAgIGxvbmdOYW1lOiBcIk5hbm90ZWNoIChDb3Jyb3NpdmUpXCIsXHJcbiAgICBkZXNjcmlwdGlvbjogXCJDYXVzZXMgY29ycmlzaW9uIC0gaW5mZWN0ZWQgdGFyZ2V0IGNhbiBiZSBkZXN0cm95ZWQgaW4gb25lIGhpdFwiLy8mIGJyaXR0bGUgYXJtb3JcclxufVxyXG5HbG9zc2FyeUl0ZW1TdWJUeXBlW0JyZXcuRGVmaW5pdGlvbnMuSXRlbVN1YnR5cGUuTl9Bcm1vcl0gPSB7XHJcbiAgICBsb25nTmFtZTogXCJOYW5vdGVjaCAoQXJtb3IpXCIsXHJcbiAgICBkZXNjcmlwdGlvbjogXCJIYXJkZW5zIGFybW9yLCBtYWtpbmcgaW5mZWN0ZWQgdGFyZ2V0cyB0ZW1wb3JhcmlseSBpbnZpbmNpYmxlXCJcclxufVxyXG5HbG9zc2FyeUl0ZW1TdWJUeXBlW0JyZXcuRGVmaW5pdGlvbnMuSXRlbVN1YnR5cGUuTl9IZWFsdGhdID0ge1xyXG4gICAgbG9uZ05hbWU6IFwiTmFub3RlY2ggKFJlcGFpcilcIixcclxuICAgIGRlc2NyaXB0aW9uOiBcIkhhcyBhIHJlZ2VuZXJhdGl2ZSBhZmZlY3QgLSBoZWFscyBhbnkgdGFyZ2V0IGV4cG9zZWRcIlxyXG59XHJcbi8vIEdsb3NzYXJ5SXRlbVN1YlR5cGVbQnJldy5EZWZpbml0aW9ucy5JdGVtU3VidHlwZS5Ob25TcGVjaWZpY11cclxuR2xvc3NhcnlJdGVtU3ViVHlwZVtCcmV3LkRlZmluaXRpb25zLkl0ZW1TdWJ0eXBlLlBvd2VySXRlbV9BeGVdID0ge1xyXG4gICAgbG9uZ05hbWU6IFwiSGVhdnkgQXhlXCIsXHJcbiAgICBkZXNjcmlwdGlvbjogXCJUaGUgaGVhdnkgYXhlLCBxdWFudHVtLWJvdW5kIHRvIHdob21ldmVyIHRocmV3IGl0IGhlcmVcIlxyXG59XHJcbkdsb3NzYXJ5SXRlbVN1YlR5cGVbQnJldy5EZWZpbml0aW9ucy5JdGVtU3VidHlwZS5Qb3dlckl0ZW1fR3VuXSA9IHtcclxuICAgIGxvbmdOYW1lOiBcIj8/P1wiLFxyXG4gICAgZGVzY3JpcHRpb246IFwiTk9UIFNFRU4/XCJcclxufVxyXG5cclxuLy8gR2xvc3NhcnlJdGVtU3ViVHlwZVtCcmV3LkRlZmluaXRpb25zLkl0ZW1TdWJ0eXBlLl1cclxuXHJcbmludGVyZmFjZSBJSXRlbURlc2NyaXB0aW9uIHtcclxuICAgIHR5cGVEZXNjOiBzdHJpbmdcclxuICAgIHN1YlR5cGVEZXNjPzogc3RyaW5nXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRJdGVtRGVzY3JpcHRpb24oaXRlbTogQnJldy5HcmlkVGhpbmdzLkl0ZW0pIDogSUl0ZW1EZXNjcmlwdGlvbiB7XHJcbiAgICBsZXQgaXRlbV9kZXNjIDogSUl0ZW1EZXNjcmlwdGlvblxyXG5cclxuICAgIGlmIChpdGVtLnN1YnR5cGUgIT0gQnJldy5EZWZpbml0aW9ucy5JdGVtU3VidHlwZS5Ob25TcGVjaWZpYykge1xyXG4gICAgICAgIGl0ZW1fZGVzYyA9IHtcclxuICAgICAgICAgICAgdHlwZURlc2M6IEdsb3NzYXJ5SXRlbVR5cGVbaXRlbS5nZXREZWZpbml0aW9uKCldLFxyXG4gICAgICAgICAgICBzdWJUeXBlRGVzYzogR2xvc3NhcnlJdGVtU3ViVHlwZVtpdGVtLnN1YnR5cGVdLmRlc2NyaXB0aW9uXHJcbiAgICAgICAgfVxyXG5cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgaXRlbV9kZXNjID0ge1xyXG4gICAgICAgICAgICB0eXBlRGVzYzogR2xvc3NhcnlJdGVtVHlwZVtpdGVtLmdldERlZmluaXRpb24oKV1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGl0ZW1fZGVzY1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0SXRlbU5hbWUoaXRlbTogQnJldy5HcmlkVGhpbmdzLkl0ZW0pIDogc3RyaW5nIHtcclxuICAgIGxldCBuYW1lIDogc3RyaW5nID0gXCJ1bm5hbWVkIGl0ZW1cIlxyXG4gICAgaWYgKGl0ZW0uaXNUeXBlKEJyZXcuRGVmaW5pdGlvbnMuSXRlbVR5cGUuUG93ZXJTeXN0ZW0pKSB7XHJcbiAgICAgICAgbmFtZSA9IFwiUG93ZXI6IFwiICsgZ2V0UG93ZXJTaG9ydE5hbWUoaXRlbS5wb3dlcilcclxuICAgIH0gZWxzZSBpZiAoaXRlbS5zdWJ0eXBlID09IEJyZXcuRGVmaW5pdGlvbnMuSXRlbVN1YnR5cGUuTm9uU3BlY2lmaWMpIHtcclxuICAgICAgICBuYW1lID0gQnJldy5EZWZpbml0aW9ucy5JdGVtVHlwZVtpdGVtLmdldERlZmluaXRpb24oKV1cclxuXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vIGlmIChpdGVtLmdldERlZmluaXRpb24oKSA9PSBCcmV3LkRlZmluaXRpb25zLkl0ZW1UeXBlLkdyZW5hZGUpIHtcclxuICAgICAgICAvLyAgICAgbmFtZSA9IEJyZXcuRGVmaW5pdGlvbnMuSXRlbVN1YnR5cGVbaXRlbS5zdWJ0eXBlXVxyXG4gICAgICAgIC8vIH0gXHJcbiAgICAgICAgbmFtZSA9IEdsb3NzYXJ5SXRlbVN1YlR5cGVbaXRlbS5zdWJ0eXBlXS5sb25nTmFtZVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBuYW1lXHJcbn1cclxuXHJcbmludGVyZmFjZSBJR2xvc3NhcnlGZWF0dXJlVHlwZSB7XHJcbiAgICBsb25nTmFtZTogc3RyaW5nLFxyXG4gICAgZGVzY3JpcHRpb246IHN0cmluZyxcclxufVxyXG5cclxubGV0IEdsb3NzYXJ5RmVhdHVyZSA6IHsgW2ZlYXR1cmVUeXBlOiBzdHJpbmddIDogSUdsb3NzYXJ5RmVhdHVyZVR5cGUgfSA9IHt9XHJcbkdsb3NzYXJ5RmVhdHVyZVtCcmV3LkRlZmluaXRpb25zLkZlYXR1cmVUeXBlLkNvcnJvc2l2ZUFjaWRdID0ge1xyXG4gICAgbG9uZ05hbWU6IFwiQ29ycm9zaXZlIE5hbm9ib3RzXCIsXHJcbiAgICBkZXNjcmlwdGlvbjogR2xvc3NhcnlJdGVtU3ViVHlwZVtCcmV3LkRlZmluaXRpb25zLkl0ZW1TdWJ0eXBlLk5fQWNpZF0uZGVzY3JpcHRpb25cclxufVxyXG5HbG9zc2FyeUZlYXR1cmVbQnJldy5EZWZpbml0aW9ucy5GZWF0dXJlVHlwZS5GaXJlXSA9IHtcclxuICAgIGxvbmdOYW1lOiBcIkZpcmVcIixcclxuICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBmbGFtZXMgZmxpY2tlciBkYW5nZXJvdXNseVwiXHJcbn1cclxuR2xvc3NhcnlGZWF0dXJlW0JyZXcuRGVmaW5pdGlvbnMuRmVhdHVyZVR5cGUuUHJvdGVjdGl2ZUdvb10gPSB7XHJcbiAgICBsb25nTmFtZTogXCJBcm1vciBOYW5vYm90c1wiLFxyXG4gICAgZGVzY3JpcHRpb246IEdsb3NzYXJ5SXRlbVN1YlR5cGVbQnJldy5EZWZpbml0aW9ucy5JdGVtU3VidHlwZS5OX0FybW9yXS5kZXNjcmlwdGlvblxyXG59XHJcbkdsb3NzYXJ5RmVhdHVyZVtCcmV3LkRlZmluaXRpb25zLkZlYXR1cmVUeXBlLlJlcGFpckdvb10gPSB7XHJcbiAgICBsb25nTmFtZTogXCJSZXBhaXIgTmFub2JvdHNcIixcclxuICAgIGRlc2NyaXB0aW9uOiBHbG9zc2FyeUl0ZW1TdWJUeXBlW0JyZXcuRGVmaW5pdGlvbnMuSXRlbVN1YnR5cGUuTl9IZWFsdGhdLmRlc2NyaXB0aW9uXHJcbn1cclxuR2xvc3NhcnlGZWF0dXJlW0JyZXcuRGVmaW5pdGlvbnMuRmVhdHVyZVR5cGUuU2NyYXBdID0ge1xyXG4gICAgbG9uZ05hbWU6IFwiU2NyYXBcIixcclxuICAgIGRlc2NyaXB0aW9uOiBcIkRlYnJpcyBmcm9tIGEgcHJldmlvdXMgYmF0dGxlXCJcclxufVxyXG4vLyBHbG9zc2FyeUZlYXR1cmVbQnJldy5EZWZpbml0aW9ucy5GZWF0dXJlVHlwZS5dID0ge1xyXG4vLyAgICAgbG9uZ05hbWU6IFwiXCIsXHJcbi8vICAgICBkZXNjcmlwdGlvbjogXCJcIlxyXG4vLyB9XHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRGZWF0dXJlTmFtZShmZWF0dXJlOiBCcmV3LkdyaWRUaGluZ3MuRmVhdHVyZSkgOiBzdHJpbmcge1xyXG4gICAgcmV0dXJuIEdsb3NzYXJ5RmVhdHVyZVtmZWF0dXJlLmdldERlZmluaXRpb24oKV0ubG9uZ05hbWVcclxufVxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0RmVhdHVyZURlc2NyaXB0aW9uKGZlYXR1cmU6IEJyZXcuR3JpZFRoaW5ncy5GZWF0dXJlKSA6IHN0cmluZyB7XHJcbiAgICByZXR1cm4gR2xvc3NhcnlGZWF0dXJlW2ZlYXR1cmUuZ2V0RGVmaW5pdGlvbigpXS5kZXNjcmlwdGlvblxyXG59XHJcbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/brew_game/glossary.ts\n");

/***/ }),

/***/ "./src/brew_game/hud_info.ts":
/*!***********************************!*\
  !*** ./src/brew_game/hud_info.ts ***!
  \***********************************/
/*! exports provided: HUDNote, getCurrentNotes, getLabelOffsetsForPoint, usefulLabelArrowLookup, getLabelArrowForOffset, getHUDPages, placeWordsOnLetterGrid */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"HUDNote\", function() { return HUDNote; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getCurrentNotes\", function() { return getCurrentNotes; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getLabelOffsetsForPoint\", function() { return getLabelOffsetsForPoint; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"usefulLabelArrowLookup\", function() { return usefulLabelArrowLookup; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getLabelArrowForOffset\", function() { return getLabelArrowForOffset; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getHUDPages\", function() { return getHUDPages; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"placeWordsOnLetterGrid\", function() { return placeWordsOnLetterGrid; });\n/* harmony import */ var rot_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! rot-js */ \"./node_modules/rot-js/lib/rot.js\");\n/* harmony import */ var rot_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(rot_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _brew__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../brew */ \"./src/brew.ts\");\n/* harmony import */ var _brew_components_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../brew_components/utils */ \"./src/brew_components/utils.ts\");\n\r\n\r\n\r\nlet PRIORITY_PLAYER_HEALTH = 10000;\r\nlet PRIORITY_PLAYER_EFFECTS = 9000;\r\nlet PRIORITY_TARGETLOCK = 8000;\r\nlet PRIORITY_MOB_HEALTH = 7000;\r\nlet PRIORITY_MOB_EFFECTS = 6000;\r\n//// \r\nlet PRIORITY_ITEMS = 5000;\r\nlet PRIORITY_MOB_FLAGS = 4000;\r\nlet PRIORITY_PLAYER_FLAGS = 4000;\r\nlet PRIORITY_FEATURE = 3000;\r\nlet PRIORITY_TERRAIN = 2000;\r\nclass HUDNote {\r\n    constructor(noteType, subject, priority, note_color) {\r\n        this.noteType = noteType;\r\n        this.subject = subject;\r\n        this.priority = priority;\r\n        this.note_color = note_color;\r\n        this.noteID = Object(_brew_components_utils__WEBPACK_IMPORTED_MODULE_2__[\"generateID\"])();\r\n    }\r\n    getNoteText() {\r\n        return \"\";\r\n    }\r\n    getOverlayText() {\r\n        return \"\";\r\n    }\r\n    setColor(new_color) {\r\n        this.note_color = new_color;\r\n    }\r\n    getColor() {\r\n        return this.note_color;\r\n    }\r\n}\r\nclass NoteTerrain extends HUDNote {\r\n    constructor(subject, priority, note_color) {\r\n        super(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].BrewNoteType.Terrain, subject, priority, note_color);\r\n        this.subject = subject;\r\n        this.priority = priority;\r\n        this.note_color = note_color;\r\n    }\r\n    getNoteText() {\r\n        return this.subject.code + \" \" + this.getOverlayText();\r\n    }\r\n    getOverlayText() {\r\n        return _brew__WEBPACK_IMPORTED_MODULE_1__[\"Definitions\"].TerrainType[this.subject.getDefinition()];\r\n    }\r\n}\r\nclass NoteFeature extends HUDNote {\r\n    constructor(subject, priority, note_color) {\r\n        super(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].BrewNoteType.Feature, subject, priority, note_color);\r\n        this.subject = subject;\r\n        this.priority = priority;\r\n        this.note_color = note_color;\r\n    }\r\n    getNoteText() {\r\n        return this.subject.code + \" \" + this.getOverlayText();\r\n    }\r\n    getOverlayText() {\r\n        return _brew__WEBPACK_IMPORTED_MODULE_1__[\"Glossary\"].getFeatureName(this.subject);\r\n    }\r\n}\r\nclass NoteTimedEffect extends HUDNote {\r\n    constructor(turn_timer, current_turn, priority, note_color) {\r\n        super(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].BrewNoteType.TimedEffect, turn_timer.actor, priority, note_color);\r\n        this.turn_timer = turn_timer;\r\n        this.current_turn = current_turn;\r\n        this.note_color = note_color;\r\n    }\r\n    getNoteText() {\r\n        return this.turn_timer.actor.code + \" \" + this.getOverlayText();\r\n    }\r\n    getOverlayText() {\r\n        // return `${this.subject.code} ${Brew.Enums.Flag[this.flag]}`\r\n        let turns_remaining = this.turn_timer.getTurnsRemaining(this.current_turn);\r\n        return `${_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].Flag[this.turn_timer.flag]} ${turns_remaining}`;\r\n    }\r\n}\r\nclass NoteMonsterHealth extends HUDNote {\r\n    constructor(subject, priority, note_color) {\r\n        super(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].BrewNoteType.Health, subject, priority, note_color);\r\n        this.subject = subject;\r\n        this.note_color = note_color;\r\n    }\r\n    getNoteText() {\r\n        return this.subject.code + \" \" + this.getOverlayText();\r\n    }\r\n    getOverlayText() {\r\n        let text = \"\";\r\n        // for (let i = 0; i < this.subject.hp.getCurrentLevel(); i++) {\r\n        for (let i = 1; i <= this.subject.hp.getMaxLevel(); i++) {\r\n            if (i <= this.subject.hp.getCurrentLevel()) {\r\n                text += _brew__WEBPACK_IMPORTED_MODULE_1__[\"Symbols\"].heart_full;\r\n            }\r\n            else {\r\n                text += _brew__WEBPACK_IMPORTED_MODULE_1__[\"Symbols\"].heart_empty;\r\n            }\r\n        }\r\n        if (this.subject.shields.getMaxLevel() > 0) {\r\n            // text += \" \"\r\n            for (let i = 0; i < this.subject.shields.getMaxLevel(); i++) {\r\n                if (i < this.subject.shields.getCurrentLevel()) {\r\n                    text += _brew__WEBPACK_IMPORTED_MODULE_1__[\"Symbols\"].diamond_full;\r\n                }\r\n                else {\r\n                    text += _brew__WEBPACK_IMPORTED_MODULE_1__[\"Symbols\"].diamond_empty;\r\n                }\r\n            }\r\n        }\r\n        return text;\r\n    }\r\n}\r\nclass NoteMonsterFlag extends HUDNote {\r\n    constructor(subject, flag, priority, note_color) {\r\n        super(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].BrewNoteType.BehavioralFlag, subject, priority, note_color);\r\n        this.subject = subject;\r\n        this.flag = flag;\r\n        this.note_color = note_color;\r\n    }\r\n    getNoteText() {\r\n        return this.subject.code + \" \" + this.getOverlayText();\r\n    }\r\n    getOverlayText() {\r\n        return _brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].Flag[this.flag];\r\n    }\r\n}\r\nclass NoteMonsterSpeed extends HUDNote {\r\n    constructor(subject, speed, priority, note_color) {\r\n        super(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].BrewNoteType.Speed, subject, priority, note_color);\r\n        this.subject = subject;\r\n        this.speed = speed;\r\n        this.note_color = note_color;\r\n    }\r\n    getNoteText() {\r\n        return this.subject.code + \" \" + this.getOverlayText();\r\n    }\r\n    getOverlayText() {\r\n        if (this.speed < 12) {\r\n            return \"Moves Slowly\";\r\n        }\r\n        else {\r\n            return \"Moves Fast!\";\r\n        }\r\n    }\r\n}\r\nclass NoteTargetingLock extends HUDNote {\r\n    constructor(subject, lock_on, priority, note_color) {\r\n        super(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].BrewNoteType.TargetingLock, subject, priority, note_color);\r\n        this.subject = subject;\r\n        this.lock_on = lock_on;\r\n        this.note_color = note_color;\r\n    }\r\n    getNoteText() {\r\n        return this.subject.code + \" \" + this.getOverlayText();\r\n    }\r\n    getOverlayText() {\r\n        return `TLock [${this.lock_on.code}]`;\r\n    }\r\n}\r\nclass NoteItemOnFloor extends HUDNote {\r\n    constructor(subject, priority, note_color) {\r\n        super(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].BrewNoteType.NotableItem, subject, priority, note_color);\r\n        this.subject = subject;\r\n        this.note_color = note_color;\r\n    }\r\n    getNoteText() {\r\n        return this.subject.code + \" \" + this.getOverlayText();\r\n    }\r\n    getOverlayText() {\r\n        return _brew__WEBPACK_IMPORTED_MODULE_1__[\"Glossary\"].getItemName(this.subject);\r\n    }\r\n}\r\nfunction getCurrentNotes(gm) {\r\n    let hud_notes = [];\r\n    let current_turn = gm.turn_count;\r\n    let player = gm.getPlayer();\r\n    let level = gm.getCurrentLevel();\r\n    // always show player health/shield\r\n    hud_notes.push(new NoteMonsterHealth(player, PRIORITY_PLAYER_HEALTH, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].color_notes_player));\r\n    // show player timed effects / flags\r\n    let timed_effects = gm.timer_monitor.getAllTimersFor(player);\r\n    let covered_flags = [];\r\n    timed_effects.forEach((turn_timer) => {\r\n        hud_notes.push(new NoteTimedEffect(turn_timer, current_turn, PRIORITY_PLAYER_EFFECTS, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].color_notes_player));\r\n        covered_flags.push(turn_timer.flag);\r\n    });\r\n    // any other flags that player has? (flight)\r\n    for (let player_flag of player.getFlags()) {\r\n        if (covered_flags.indexOf(player_flag) == -1) {\r\n            hud_notes.push(new NoteMonsterFlag(player, player_flag, PRIORITY_PLAYER_FLAGS, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].color_notes_player));\r\n        }\r\n    }\r\n    // monsters nearby\r\n    let dist;\r\n    let priority;\r\n    let mob_list = [];\r\n    let distMap = {};\r\n    let max_dist;\r\n    let mob_note_color;\r\n    // create simple distance map from player, to gauge relative threat\r\n    _brew__WEBPACK_IMPORTED_MODULE_1__[\"Intel\"].getMonstersKnownBy(gm, player).forEach((mob) => {\r\n        mob_list.push(mob);\r\n        dist = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Utils\"].dist2d(player.location, mob.location);\r\n        distMap[mob.getID()] = dist;\r\n        max_dist = Math.max(dist, max_dist);\r\n    });\r\n    mob_list.forEach((mob, index) => {\r\n        mob_note_color = getDifferentiatedColor(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].dark_red, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].goldenrod, mob_list.length, index);\r\n        covered_flags = []; // reset for each new mob\r\n        dist = distMap[mob.getID()];\r\n        // at least one note for health/shield\r\n        hud_notes.push(new NoteMonsterHealth(mob, PRIORITY_MOB_HEALTH, mob_note_color));\r\n        timed_effects = gm.timer_monitor.getAllTimersFor(mob);\r\n        // potentially multiple notes for timed status effects (burning, weakened, etc)\r\n        for (let i = 0; i < timed_effects.length; i++) {\r\n            // hud_notes.push(new NoteTimedEffect(timed_effects[i], current_turn, PRIORITY_MOB_EFFECTS - (max_dist - dist), mob_note_color))\r\n            hud_notes.push(new NoteTimedEffect(timed_effects[i], current_turn, PRIORITY_MOB_EFFECTS, mob_note_color));\r\n            if (covered_flags.indexOf(timed_effects[i].flag) == -1) {\r\n                covered_flags.push(timed_effects[i].flag);\r\n            }\r\n        }\r\n        // list all behavioral (non-timed) effects/flags\r\n        for (let i = 0; i < mob.flags.length; i++) {\r\n            let mob_flag = mob.flags[i];\r\n            if (covered_flags.indexOf(mob_flag) == -1) {\r\n                // not previously covered\r\n                hud_notes.push(new NoteMonsterFlag(mob, mob_flag, PRIORITY_MOB_FLAGS, mob_note_color));\r\n            }\r\n        }\r\n        if (mob.speed != 12) {\r\n            hud_notes.push(new NoteMonsterSpeed(mob, mob.speed, PRIORITY_MOB_FLAGS, mob_note_color));\r\n        }\r\n    });\r\n    // items\r\n    let item_list = [];\r\n    _brew__WEBPACK_IMPORTED_MODULE_1__[\"Intel\"].getItemsKnownBy(gm, gm.getPlayer()).forEach((item) => {\r\n        item_list.push(item);\r\n        dist = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Utils\"].dist2d(player.location, item.location);\r\n        // priority = inverse of distance\r\n        distMap[item.getID()] = dist;\r\n        max_dist = Math.max(dist, max_dist);\r\n    });\r\n    item_list.forEach((item) => {\r\n        dist = distMap[item.getID()];\r\n        priority = PRIORITY_ITEMS; // - (max_dist - dist)\r\n        hud_notes.push(new NoteItemOnFloor(item, priority, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].blue));\r\n    });\r\n    // terrain and features -- only need 1 of each\r\n    let generic_content_notes = getGenericContentNotes(gm);\r\n    let shown_terrain = {};\r\n    let shown_features = {};\r\n    let already_shown;\r\n    let combined_generic_notes = [];\r\n    combined_generic_notes = combined_generic_notes.concat(generic_content_notes.featureNotes);\r\n    combined_generic_notes = combined_generic_notes.concat(generic_content_notes.terrainNotes);\r\n    for (let note of combined_generic_notes) {\r\n        already_shown = false;\r\n        if (note.subject instanceof _brew__WEBPACK_IMPORTED_MODULE_1__[\"GridThings\"].Terrain) {\r\n            if (note.subject.getDefinition() in shown_terrain) {\r\n                already_shown = true;\r\n            }\r\n        }\r\n        else if (note.subject instanceof _brew__WEBPACK_IMPORTED_MODULE_1__[\"GridThings\"].Feature) {\r\n            if (note.subject.getDefinition() in shown_features) {\r\n                already_shown = true;\r\n            }\r\n        }\r\n        if (!(already_shown)) {\r\n            if (note.subject instanceof _brew__WEBPACK_IMPORTED_MODULE_1__[\"GridThings\"].Terrain) {\r\n                shown_terrain[note.subject.getDefinition()] = true;\r\n            }\r\n            else if (note.subject instanceof _brew__WEBPACK_IMPORTED_MODULE_1__[\"GridThings\"].Feature) {\r\n                shown_features[note.subject.getDefinition()] = true;\r\n            }\r\n            hud_notes.push(note);\r\n        }\r\n    }\r\n    hud_notes = hud_notes.concat(getTargetLockNotes(gm));\r\n    hud_notes.sort((note_a, note_b) => {\r\n        return note_b.priority - note_a.priority;\r\n    });\r\n    return hud_notes;\r\n}\r\nfunction getLabelOffsetsForPoint() {\r\n    let list_all = [_brew__WEBPACK_IMPORTED_MODULE_1__[\"Directions\"].LEFT, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Directions\"].RIGHT, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Directions\"].UP_RIGHT, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Directions\"].DOWN_RIGHT, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Directions\"].UP_LEFT, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Directions\"].DOWN_LEFT];\r\n    // return list_all\r\n    return _brew__WEBPACK_IMPORTED_MODULE_1__[\"Utils\"].randomize(list_all, false);\r\n}\r\nconst usefulLabelArrowLookup = {};\r\nusefulLabelArrowLookup[_brew__WEBPACK_IMPORTED_MODULE_1__[\"Utils\"].xyToKey(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Directions\"].RIGHT)] = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Symbols\"].pointer_left;\r\nusefulLabelArrowLookup[_brew__WEBPACK_IMPORTED_MODULE_1__[\"Utils\"].xyToKey(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Directions\"].LEFT)] = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Symbols\"].pointer_right;\r\nusefulLabelArrowLookup[_brew__WEBPACK_IMPORTED_MODULE_1__[\"Utils\"].xyToKey(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Directions\"].UP)] = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Symbols\"].pointer_down;\r\nusefulLabelArrowLookup[_brew__WEBPACK_IMPORTED_MODULE_1__[\"Utils\"].xyToKey(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Directions\"].DOWN)] = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Symbols\"].pointer_up;\r\nusefulLabelArrowLookup[_brew__WEBPACK_IMPORTED_MODULE_1__[\"Utils\"].xyToKey(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Directions\"].DOWN_LEFT)] = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Symbols\"].pointer_upright;\r\nusefulLabelArrowLookup[_brew__WEBPACK_IMPORTED_MODULE_1__[\"Utils\"].xyToKey(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Directions\"].DOWN_RIGHT)] = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Symbols\"].pointer_upleft;\r\nusefulLabelArrowLookup[_brew__WEBPACK_IMPORTED_MODULE_1__[\"Utils\"].xyToKey(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Directions\"].UP_RIGHT)] = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Symbols\"].pointer_downleft;\r\nusefulLabelArrowLookup[_brew__WEBPACK_IMPORTED_MODULE_1__[\"Utils\"].xyToKey(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Directions\"].UP_LEFT)] = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Symbols\"].pointer_downright;\r\nfunction getLabelArrowForOffset(offset_xy) {\r\n    return usefulLabelArrowLookup[_brew__WEBPACK_IMPORTED_MODULE_1__[\"Utils\"].xyToKey(offset_xy)];\r\n}\r\nfunction getHUDPages(gm, given_notes) {\r\n    // sort by priority\r\n    given_notes.sort((note_a, note_b) => {\r\n        return note_b.priority - note_a.priority;\r\n    });\r\n    let max_notes_per_page = 6;\r\n    let makeNewPage = true;\r\n    let all_pages = [];\r\n    let currentPage;\r\n    let skipped_notes = [];\r\n    let note_idx = 0;\r\n    while (note_idx < given_notes.length) {\r\n        if (makeNewPage) {\r\n            currentPage = {\r\n                grid: new _brew__WEBPACK_IMPORTED_MODULE_1__[\"GridOfThings\"](),\r\n                note: []\r\n            };\r\n            makeNewPage = false;\r\n        }\r\n        let success = false;\r\n        let text;\r\n        let note = given_notes[note_idx];\r\n        let existing_char = currentPage.grid.getAt(note.subject.location);\r\n        if (existing_char) {\r\n            success = false;\r\n        }\r\n        else {\r\n            text = note.getOverlayText();\r\n            success = placeWordsOnLetterGrid(currentPage.grid, text, note.getColor(), note.subject.location);\r\n        }\r\n        if (success) {\r\n            currentPage.grid.setAt(note.subject.location, { char: note.subject.code, color: note.getColor() });\r\n            currentPage.note.push(note);\r\n            note_idx += 1;\r\n        }\r\n        makeNewPage = (!(success)) || (currentPage.note.length == max_notes_per_page);\r\n        if (makeNewPage) {\r\n            all_pages.push(currentPage);\r\n        }\r\n    }\r\n    all_pages.push(currentPage);\r\n    return all_pages;\r\n}\r\nfunction calcWordsStartCoordinate(spot_xy, offset_xy, words) {\r\n    let pointer_xy = spot_xy.add(offset_xy);\r\n    let words_start_xy = null;\r\n    if (offset_xy.x > 0) {\r\n        // text flows to the right\r\n        words_start_xy = spot_xy.add(offset_xy);\r\n    }\r\n    else if (offset_xy.x < 0) {\r\n        // text flows from the left\r\n        words_start_xy = spot_xy.add(offset_xy).add(new _brew__WEBPACK_IMPORTED_MODULE_1__[\"Coordinate\"](-1 * (words.length - 1), 0));\r\n    }\r\n    else {\r\n        throw new Error(\"function not designed for xy.x = 0\");\r\n    }\r\n    return words_start_xy;\r\n}\r\nfunction placeWordsOnLetterGrid(grid, words, color, spot_xy) {\r\n    let is_open;\r\n    let pointer_char;\r\n    let full_text;\r\n    let i;\r\n    let xy;\r\n    let offset_xy_list = getLabelOffsetsForPoint();\r\n    let offset_xy;\r\n    let words_start_xy;\r\n    // for (let words_start_xy of offset_list) {\r\n    for (let j = 0; j < offset_xy_list.length; j++) {\r\n        offset_xy = offset_xy_list[j];\r\n        pointer_char = getLabelArrowForOffset(offset_xy);\r\n        if (offset_xy.x > 0) {\r\n            full_text = pointer_char + words;\r\n        }\r\n        else if (offset_xy.x < 0) {\r\n            full_text = words + pointer_char;\r\n        }\r\n        else {\r\n            throw new Error(\"function not designed for xy.x = 0\");\r\n        }\r\n        words_start_xy = calcWordsStartCoordinate(spot_xy, offset_xy, full_text);\r\n        is_open = checkIfBlankSpaceExistsOnLetterGrid(grid, full_text, words_start_xy);\r\n        if (is_open) {\r\n            for (i = 0; i < full_text.length; i++) {\r\n                xy = words_start_xy.add(new _brew__WEBPACK_IMPORTED_MODULE_1__[\"Coordinate\"](i, 0));\r\n                grid.setAt(xy, { char: full_text[i], color: color });\r\n            }\r\n            return true;\r\n        }\r\n    }\r\n    console.log(\"unable to find a spot for \", words);\r\n    return false;\r\n}\r\nfunction checkIfBlankSpaceExistsOnLetterGrid(grid, words, words_start_xy) {\r\n    // return true if we were able to place the words on the grid\r\n    let xy;\r\n    // make sure it is in bounds\r\n    if ((words_start_xy.x < 0) || (words_start_xy.y < 0)) {\r\n        return false;\r\n    }\r\n    if ((words_start_xy.x >= _brew__WEBPACK_IMPORTED_MODULE_1__[\"Config\"].screen_width_tiles) || (words_start_xy.y >= _brew__WEBPACK_IMPORTED_MODULE_1__[\"Config\"].screen_height_tiles)) {\r\n        return false;\r\n    }\r\n    if ((words_start_xy.x + words.length - 1) >= _brew__WEBPACK_IMPORTED_MODULE_1__[\"Config\"].screen_width_tiles) {\r\n        return false;\r\n    }\r\n    for (let i = 0; i < words.length; i++) {\r\n        xy = words_start_xy.add(new _brew__WEBPACK_IMPORTED_MODULE_1__[\"Coordinate\"](i, 0));\r\n        if (grid.hasAt(xy)) {\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n}\r\nfunction getGenericContentNotes(gm) {\r\n    let player = gm.getPlayer();\r\n    let level = gm.getCurrentLevel();\r\n    let terrain_at;\r\n    let feature_at;\r\n    let terrain_notes = [];\r\n    let feature_notes = [];\r\n    // let locations : Array<Brew.Coordinate> = Brew.Utils.randomize(player.fov.getAllCoordinates(), false)\r\n    let locations = player.fov.getAllCoordinates();\r\n    for (let xy of locations) {\r\n        terrain_at = level.terrain.getAt(xy);\r\n        if (terrain_at) {\r\n            terrain_notes.push(new NoteTerrain(terrain_at, PRIORITY_TERRAIN, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].normal));\r\n        }\r\n        feature_at = level.features.getAt(xy);\r\n        if (feature_at) {\r\n            feature_notes.push(new NoteFeature(feature_at, PRIORITY_FEATURE, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].normal));\r\n        }\r\n    }\r\n    return {\r\n        terrainNotes: terrain_notes,\r\n        featureNotes: feature_notes\r\n    };\r\n}\r\nfunction getTargetLockNotes(gm) {\r\n    let lock_notes = [];\r\n    let player = gm.getPlayer();\r\n    let level = gm.getCurrentLevel();\r\n    for (let mob of level.monsters.getAllThings()) {\r\n        if (_brew__WEBPACK_IMPORTED_MODULE_1__[\"Targeting\"].hasTargetLock(mob, player)) {\r\n            lock_notes.push(new NoteTargetingLock(mob, player, PRIORITY_TARGETLOCK, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].orange));\r\n        }\r\n    }\r\n    return lock_notes;\r\n}\r\nfunction getDifferentiatedColor(high_color, low_color, num_items, this_item_num) {\r\n    let factor = this_item_num / num_items;\r\n    return rot_js__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].interpolate(low_color, high_color, factor);\r\n}\r\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvYnJld19nYW1lL2h1ZF9pbmZvLnRzPzM5ZGQiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7O0FBQTZCO0FBQ0U7QUFDdUI7QUFJdEQsSUFBSSxzQkFBc0IsR0FBRyxLQUFLO0FBQ2xDLElBQUksdUJBQXVCLEdBQUcsSUFBSTtBQUNsQyxJQUFJLG1CQUFtQixHQUFHLElBQUk7QUFDOUIsSUFBSSxtQkFBbUIsR0FBRyxJQUFJO0FBQzlCLElBQUksb0JBQW9CLEdBQUcsSUFBSTtBQUMvQixLQUFLO0FBQ0wsSUFBSSxjQUFjLEdBQUcsSUFBSTtBQUN6QixJQUFJLGtCQUFrQixHQUFHLElBQUk7QUFDN0IsSUFBSSxxQkFBcUIsR0FBRyxJQUFJO0FBQ2hDLElBQUksZ0JBQWdCLEdBQUcsSUFBSTtBQUMzQixJQUFJLGdCQUFnQixHQUFHLElBQUk7QUFHckI7SUFHRixZQUFtQixRQUFpQyxFQUFTLE9BQThCLEVBQVMsUUFBaUIsRUFBUyxVQUFtQjtRQUE5SCxhQUFRLEdBQVIsUUFBUSxDQUF5QjtRQUFTLFlBQU8sR0FBUCxPQUFPLENBQXVCO1FBQVMsYUFBUSxHQUFSLFFBQVEsQ0FBUztRQUFTLGVBQVUsR0FBVixVQUFVLENBQVM7UUFDN0ksSUFBSSxDQUFDLE1BQU0sR0FBRyx5RUFBVSxFQUFFO0lBQzlCLENBQUM7SUFFRCxXQUFXO1FBQ1AsTUFBTSxDQUFDLEVBQUU7SUFDYixDQUFDO0lBRUQsY0FBYztRQUNWLE1BQU0sQ0FBQyxFQUFFO0lBQ2IsQ0FBQztJQUVELFFBQVEsQ0FBQyxTQUFnQjtRQUNyQixJQUFJLENBQUMsVUFBVSxHQUFHLFNBQVM7SUFDL0IsQ0FBQztJQUVELFFBQVE7UUFDSixNQUFNLENBQUMsSUFBSSxDQUFDLFVBQVU7SUFDMUIsQ0FBQztDQUNKO0FBRUQsaUJBQWtCLFNBQVEsT0FBTztJQUM3QixZQUFtQixPQUFnQyxFQUFTLFFBQWdCLEVBQVMsVUFBa0I7UUFDbkcsS0FBSyxDQUFDLDJDQUFV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TUFBTSxDQUFDLDRDQUFTLENBQUMsV0FBVyxDQUFDLFNBQVMsRUFBRSxVQUFVLEVBQUUsTUFBTSxDQUFDO0FBQy9ELENBQUMiLCJmaWxlIjoiLi9zcmMvYnJld19nYW1lL2h1ZF9pbmZvLnRzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgUk9UIGZyb20gJ3JvdC1qcydcclxuaW1wb3J0ICogYXMgQnJldyBmcm9tIFwiLi4vYnJld1wiXHJcbmltcG9ydCB7IGdlbmVyYXRlSUQgfSBmcm9tIFwiLi4vYnJld19jb21wb25lbnRzL3V0aWxzXCI7XHJcbmltcG9ydCB7IElDaGFyQW5kQ29sb3J9IGZyb20gXCIuLi9icmV3X2VuZ2luZS9lbnVtc1wiXHJcbmltcG9ydCB7IElDb2xvciB9IGZyb20gXCIuLi9icmV3X2NvbXBvbmVudHMvY29sb3JcIjtcclxuXHJcbmxldCBQUklPUklUWV9QTEFZRVJfSEVBTFRIID0gMTAwMDBcclxubGV0IFBSSU9SSVRZX1BMQVlFUl9FRkZFQ1RTID0gOTAwMFxyXG5sZXQgUFJJT1JJVFlfVEFSR0VUTE9DSyA9IDgwMDBcclxubGV0IFBSSU9SSVRZX01PQl9IRUFMVEggPSA3MDAwXHJcbmxldCBQUklPUklUWV9NT0JfRUZGRUNUUyA9IDYwMDBcclxuLy8vLyBcclxubGV0IFBSSU9SSVRZX0lURU1TID0gNTAwMFxyXG5sZXQgUFJJT1JJVFlfTU9CX0ZMQUdTID0gNDAwMFxyXG5sZXQgUFJJT1JJVFlfUExBWUVSX0ZMQUdTID0gNDAwMFxyXG5sZXQgUFJJT1JJVFlfRkVBVFVSRSA9IDMwMDBcclxubGV0IFBSSU9SSVRZX1RFUlJBSU4gPSAyMDAwXHJcblxyXG5cclxuZXhwb3J0IGNsYXNzIEhVRE5vdGUge1xyXG4gICAgcHJpdmF0ZSBub3RlSUQgOiBudW1iZXJcclxuICAgIFxyXG4gICAgY29uc3RydWN0b3IocHVibGljIG5vdGVUeXBlOiBCcmV3LkVudW1zLkJyZXdOb3RlVHlwZSwgcHVibGljIHN1YmplY3Q6IEJyZXcuR3JpZFRoaW5ncy5UaGluZywgcHVibGljIHByaW9yaXR5IDogbnVtYmVyLCBwdWJsaWMgbm90ZV9jb2xvciA6IElDb2xvcikge1xyXG4gICAgICAgIHRoaXMubm90ZUlEID0gZ2VuZXJhdGVJRCgpXHJcbiAgICB9XHJcblxyXG4gICAgZ2V0Tm90ZVRleHQoKSA6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIFwiXCJcclxuICAgIH1cclxuXHJcbiAgICBnZXRPdmVybGF5VGV4dCgpIDogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gXCJcIlxyXG4gICAgfVxyXG5cclxuICAgIHNldENvbG9yKG5ld19jb2xvcjpJQ29sb3IpIHtcclxuICAgICAgICB0aGlzLm5vdGVfY29sb3IgPSBuZXdfY29sb3JcclxuICAgIH1cclxuXHJcbiAgICBnZXRDb2xvcigpIDogSUNvbG9yIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5ub3RlX2NvbG9yXHJcbiAgICB9XHJcbn1cclxuXHJcbmNsYXNzIE5vdGVUZXJyYWluIGV4dGVuZHMgSFVETm90ZSB7XHJcbiAgICBjb25zdHJ1Y3RvcihwdWJsaWMgc3ViamVjdDogQnJldy5HcmlkVGhpbmdzLlRlcnJhaW4sIHB1YmxpYyBwcmlvcml0eTogbnVtYmVyLCBwdWJsaWMgbm90ZV9jb2xvcjogSUNvbG9yKSB7XHJcbiAgICAgICAgc3VwZXIoQnJldy5FbnVtcy5CcmV3Tm90ZVR5cGUuVGVycmFpbiwgc3ViamVjdCwgcHJpb3JpdHksIG5vdGVfY29sb3IpXHJcbiAgICB9XHJcblxyXG4gICAgZ2V0Tm90ZVRleHQoKSA6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuICB0aGlzLnN1YmplY3QuY29kZSArIFwiIFwiICsgdGhpcy5nZXRPdmVybGF5VGV4dCgpXHJcbiAgICB9XHJcblxyXG4gICAgZ2V0T3ZlcmxheVRleHQoKSA6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIEJyZXcuRGVmaW5pdGlvbnMuVGVycmFpblR5cGVbdGhpcy5zdWJqZWN0LmdldERlZmluaXRpb24oKV1cclxuICAgIH1cclxufVxyXG5cclxuY2xhc3MgTm90ZUZlYXR1cmUgZXh0ZW5kcyBIVUROb3RlIHtcclxuICAgIGNvbnN0cnVjdG9yKHB1YmxpYyBzdWJqZWN0OiBCcmV3LkdyaWRUaGluZ3MuRmVhdHVyZSwgcHVibGljIHByaW9yaXR5OiBudW1iZXIsIHB1YmxpYyBub3RlX2NvbG9yOiBJQ29sb3IpIHtcclxuICAgICAgICBzdXBlcihCcmV3LkVudW1zLkJyZXdOb3RlVHlwZS5GZWF0dXJlLCBzdWJqZWN0LCBwcmlvcml0eSwgbm90ZV9jb2xvcilcclxuICAgIH1cclxuXHJcbiAgICBnZXROb3RlVGV4dCgpIDogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gIHRoaXMuc3ViamVjdC5jb2RlICsgXCIgXCIgKyB0aGlzLmdldE92ZXJsYXlUZXh0KClcclxuICAgIH1cclxuXHJcbiAgICBnZXRPdmVybGF5VGV4dCgpIDogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gQnJldy5HbG9zc2FyeS5nZXRGZWF0dXJlTmFtZSh0aGlzLnN1YmplY3QpXHJcbiAgICB9XHJcbn1cclxuXHJcbmNsYXNzIE5vdGVUaW1lZEVmZmVjdCBleHRlbmRzIEhVRE5vdGUge1xyXG4gICAgY29uc3RydWN0b3IocHVibGljIHR1cm5fdGltZXI6IEJyZXcuVGltZXJzLlR1cm5UaW1lciwgcHVibGljIGN1cnJlbnRfdHVybjogbnVtYmVyLCBwcmlvcml0eSA6IG51bWJlciwgcHVibGljIG5vdGVfY29sb3I6IElDb2xvcikge1xyXG4gICAgICAgIHN1cGVyKEJyZXcuRW51bXMuQnJld05vdGVUeXBlLlRpbWVkRWZmZWN0LCB0dXJuX3RpbWVyLmFjdG9yLCBwcmlvcml0eSwgbm90ZV9jb2xvcilcclxuICAgIH1cclxuXHJcbiAgICBnZXROb3RlVGV4dCgpIDogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gdGhpcy50dXJuX3RpbWVyLmFjdG9yLmNvZGUgKyBcIiBcIiArIHRoaXMuZ2V0T3ZlcmxheVRleHQoKVxyXG4gICAgfVxyXG5cclxuICAgIGdldE92ZXJsYXlUZXh0KCkgOiBzdHJpbmcge1xyXG4gICAgICAgIC8vIHJldHVybiBgJHt0aGlzLnN1YmplY3QuY29kZX0gJHtCcmV3LkVudW1zLkZsYWdbdGhpcy5mbGFnXX1gXHJcbiAgICAgICAgbGV0IHR1cm5zX3JlbWFpbmluZyA9IHRoaXMudHVybl90aW1lci5nZXRUdXJuc1JlbWFpbmluZyh0aGlzLmN1cnJlbnRfdHVybilcclxuICAgICAgICByZXR1cm4gYCR7QnJldy5FbnVtcy5GbGFnW3RoaXMudHVybl90aW1lci5mbGFnXX0gJHt0dXJuc19yZW1haW5pbmd9YFxyXG4gICAgfVxyXG5cclxufVxyXG5cclxuY2xhc3MgTm90ZU1vbnN0ZXJIZWFsdGggZXh0ZW5kcyBIVUROb3RlIHtcclxuICAgIGNvbnN0cnVjdG9yKHB1YmxpYyBzdWJqZWN0OiBCcmV3LkdyaWRUaGluZ3MuTW9uc3RlciwgcHJpb3JpdHk6IG51bWJlciwgcHVibGljIG5vdGVfY29sb3I6IElDb2xvcikge1xyXG4gICAgICAgIHN1cGVyKEJyZXcuRW51bXMuQnJld05vdGVUeXBlLkhlYWx0aCwgc3ViamVjdCwgcHJpb3JpdHksIG5vdGVfY29sb3IpXHJcbiAgICB9XHJcblxyXG4gICAgZ2V0Tm90ZVRleHQoKSA6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuICB0aGlzLnN1YmplY3QuY29kZSArIFwiIFwiICsgdGhpcy5nZXRPdmVybGF5VGV4dCgpXHJcbiAgICB9XHJcblxyXG4gICAgZ2V0T3ZlcmxheVRleHQoKSA6IHN0cmluZyB7XHJcbiAgICAgICAgbGV0IHRleHQgPSBcIlwiXHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnN1YmplY3QuaHAuZ2V0Q3VycmVudExldmVsKCk7IGkrKykge1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDw9IHRoaXMuc3ViamVjdC5ocC5nZXRNYXhMZXZlbCgpOyBpKyspIHtcclxuICAgICAgICAgICAgaWYgKGkgPD0gdGhpcy5zdWJqZWN0LmhwLmdldEN1cnJlbnRMZXZlbCgpICkge1xyXG4gICAgICAgICAgICAgICAgdGV4dCArPSBCcmV3LlN5bWJvbHMuaGVhcnRfZnVsbFxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGV4dCArPSBCcmV3LlN5bWJvbHMuaGVhcnRfZW1wdHlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuc3ViamVjdC5zaGllbGRzLmdldE1heExldmVsKCkgPiAwKSB7XHJcbiAgICAgICAgICAgIC8vIHRleHQgKz0gXCIgXCJcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnN1YmplY3Quc2hpZWxkcy5nZXRNYXhMZXZlbCgpOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlmIChpIDwgdGhpcy5zdWJqZWN0LnNoaWVsZHMuZ2V0Q3VycmVudExldmVsKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0ZXh0ICs9IEJyZXcuU3ltYm9scy5kaWFtb25kX2Z1bGxcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dCArPSBCcmV3LlN5bWJvbHMuZGlhbW9uZF9lbXB0eVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIHRleHRcclxuICAgIH1cclxufVxyXG5cclxuY2xhc3MgTm90ZU1vbnN0ZXJGbGFnIGV4dGVuZHMgSFVETm90ZSB7XHJcbiAgICBjb25zdHJ1Y3RvcihwdWJsaWMgc3ViamVjdDogQnJldy5HcmlkVGhpbmdzLk1vbnN0ZXIsIHB1YmxpYyBmbGFnIDogQnJldy5FbnVtcy5GbGFnLCBwcmlvcml0eTogbnVtYmVyLCBwdWJsaWMgbm90ZV9jb2xvcjogSUNvbG9yKSB7XHJcbiAgICAgICAgc3VwZXIoQnJldy5FbnVtcy5CcmV3Tm90ZVR5cGUuQmVoYXZpb3JhbEZsYWcsIHN1YmplY3QsIHByaW9yaXR5LCBub3RlX2NvbG9yKVxyXG4gICAgfVxyXG5cclxuICAgIGdldE5vdGVUZXh0KCkgOiBzdHJpbmcge1xyXG4gICAgICAgIHJldHVybiAgdGhpcy5zdWJqZWN0LmNvZGUgKyBcIiBcIiArIHRoaXMuZ2V0T3ZlcmxheVRleHQoKVxyXG4gICAgfVxyXG5cclxuICAgIGdldE92ZXJsYXlUZXh0KCkgOiBzdHJpbmcge1xyXG4gICAgICAgIHJldHVybiBCcmV3LkVudW1zLkZsYWdbdGhpcy5mbGFnXVxyXG4gICAgfVxyXG59XHJcblxyXG5jbGFzcyBOb3RlTW9uc3RlclNwZWVkIGV4dGVuZHMgSFVETm90ZSB7XHJcbiAgICBjb25zdHJ1Y3RvcihwdWJsaWMgc3ViamVjdDogQnJldy5HcmlkVGhpbmdzLk1vbnN0ZXIsIHByaXZhdGUgc3BlZWQ6IG51bWJlciwgcHJpb3JpdHk6IG51bWJlciwgcHVibGljIG5vdGVfY29sb3I6IElDb2xvcikge1xyXG4gICAgICAgIHN1cGVyKEJyZXcuRW51bXMuQnJld05vdGVUeXBlLlNwZWVkLCBzdWJqZWN0LCBwcmlvcml0eSwgbm90ZV9jb2xvcilcclxuICAgIH1cclxuXHJcbiAgICBnZXROb3RlVGV4dCgpIDogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zdWJqZWN0LmNvZGUgKyBcIiBcIiArIHRoaXMuZ2V0T3ZlcmxheVRleHQoKVxyXG4gICAgfVxyXG5cclxuICAgIGdldE92ZXJsYXlUZXh0KCkgOiBzdHJpbmcge1xyXG4gICAgICAgIGlmICh0aGlzLnNwZWVkIDwgMTIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFwiTW92ZXMgU2xvd2x5XCJcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gXCJNb3ZlcyBGYXN0IVwiXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG5jbGFzcyBOb3RlVGFyZ2V0aW5nTG9jayBleHRlbmRzIEhVRE5vdGUge1xyXG4gICAgY29uc3RydWN0b3IocHVibGljIHN1YmplY3Q6IEJyZXcuR3JpZFRoaW5ncy5Nb25zdGVyLCBwdWJsaWMgbG9ja19vbiA6IEJyZXcuR3JpZFRoaW5ncy5Nb25zdGVyLCBwcmlvcml0eTogbnVtYmVyLCBwdWJsaWMgbm90ZV9jb2xvcjogSUNvbG9yKSB7XHJcbiAgICAgICAgc3VwZXIoQnJldy5FbnVtcy5CcmV3Tm90ZVR5cGUuVGFyZ2V0aW5nTG9jaywgc3ViamVjdCwgcHJpb3JpdHksIG5vdGVfY29sb3IpXHJcbiAgICB9XHJcblxyXG4gICAgZ2V0Tm90ZVRleHQoKSA6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuICB0aGlzLnN1YmplY3QuY29kZSArIFwiIFwiICsgdGhpcy5nZXRPdmVybGF5VGV4dCgpXHJcbiAgICB9XHJcblxyXG4gICAgZ2V0T3ZlcmxheVRleHQoKSA6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIGBUTG9jayBbJHt0aGlzLmxvY2tfb24uY29kZX1dYFxyXG4gICAgfVxyXG59XHJcblxyXG5jbGFzcyBOb3RlSXRlbU9uRmxvb3IgZXh0ZW5kcyBIVUROb3RlIHtcclxuICAgIGNvbnN0cnVjdG9yKHB1YmxpYyBzdWJqZWN0OiBCcmV3LkdyaWRUaGluZ3MuSXRlbSwgcHJpb3JpdHk6IG51bWJlciwgcHVibGljIG5vdGVfY29sb3I6IElDb2xvcikge1xyXG4gICAgICAgIHN1cGVyKEJyZXcuRW51bXMuQnJld05vdGVUeXBlLk5vdGFibGVJdGVtLCBzdWJqZWN0LCBwcmlvcml0eSwgbm90ZV9jb2xvcilcclxuICAgIH1cclxuXHJcbiAgICBnZXROb3RlVGV4dCgpIDogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gIHRoaXMuc3ViamVjdC5jb2RlICsgXCIgXCIgKyB0aGlzLmdldE92ZXJsYXlUZXh0KClcclxuICAgIH1cclxuXHJcbiAgICBnZXRPdmVybGF5VGV4dCgpIDogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gQnJldy5HbG9zc2FyeS5nZXRJdGVtTmFtZSh0aGlzLnN1YmplY3QpXHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRDdXJyZW50Tm90ZXMoZ206IEJyZXcuR2FtZU1hc3RlcikgOiBBcnJheTxIVUROb3RlPiB7XHJcbiAgICBsZXQgaHVkX25vdGVzIDogQXJyYXk8SFVETm90ZT4gPSBbXVxyXG4gICAgbGV0IGN1cnJlbnRfdHVybiA9IGdtLnR1cm5fY291bnRcclxuICAgIGxldCBwbGF5ZXIgPSBnbS5nZXRQbGF5ZXIoKVxyXG4gICAgbGV0IGxldmVsID0gZ20uZ2V0Q3VycmVudExldmVsKClcclxuICAgIFxyXG4gICAgLy8gYWx3YXlzIHNob3cgcGxheWVyIGhlYWx0aC9zaGllbGRcclxuICAgIGh1ZF9ub3Rlcy5wdXNoKG5ldyBOb3RlTW9uc3RlckhlYWx0aChwbGF5ZXIsIFBSSU9SSVRZX1BMQVlFUl9IRUFMVEgsIEJyZXcuQ29sb3IuY29sb3Jfbm90ZXNfcGxheWVyKSlcclxuXHJcbiAgICAvLyBzaG93IHBsYXllciB0aW1lZCBlZmZlY3RzIC8gZmxhZ3NcclxuICAgIGxldCB0aW1lZF9lZmZlY3RzIDogQXJyYXk8QnJldy5UaW1lcnMuVHVyblRpbWVyPiA9IGdtLnRpbWVyX21vbml0b3IuZ2V0QWxsVGltZXJzRm9yKHBsYXllcilcclxuICAgIGxldCBjb3ZlcmVkX2ZsYWdzIDogQXJyYXk8QnJldy5FbnVtcy5GbGFnPiA9IFtdXHJcbiAgICB0aW1lZF9lZmZlY3RzLmZvckVhY2goKHR1cm5fdGltZXIpID0+IHtcclxuICAgICAgICBodWRfbm90ZXMucHVzaChuZXcgTm90ZVRpbWVkRWZmZWN0KHR1cm5fdGltZXIsIGN1cnJlbnRfdHVybiwgUFJJT1JJVFlfUExBWUVSX0VGRkVDVFMsIEJyZXcuQ29sb3IuY29sb3Jfbm90ZXNfcGxheWVyKSlcclxuICAgICAgICBjb3ZlcmVkX2ZsYWdzLnB1c2godHVybl90aW1lci5mbGFnKVxyXG4gICAgfSlcclxuXHJcbiAgICAvLyBhbnkgb3RoZXIgZmxhZ3MgdGhhdCBwbGF5ZXIgaGFzPyAoZmxpZ2h0KVxyXG4gICAgZm9yIChsZXQgcGxheWVyX2ZsYWcgb2YgcGxheWVyLmdldEZsYWdzKCkpIHtcclxuICAgICAgICBpZiAoY292ZXJlZF9mbGFncy5pbmRleE9mKHBsYXllcl9mbGFnKSA9PSAtMSkge1xyXG4gICAgICAgICAgICBodWRfbm90ZXMucHVzaChuZXcgTm90ZU1vbnN0ZXJGbGFnKHBsYXllciwgcGxheWVyX2ZsYWcsIFBSSU9SSVRZX1BMQVlFUl9GTEFHUywgQnJldy5Db2xvci5jb2xvcl9ub3Rlc19wbGF5ZXIpKVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBtb25zdGVycyBuZWFyYnlcclxuICAgIGxldCBkaXN0IDogbnVtYmVyXHJcbiAgICBsZXQgcHJpb3JpdHkgOiBudW1iZXJcclxuICAgIGxldCBtb2JfbGlzdCA6IEFycmF5PEJyZXcuR3JpZFRoaW5ncy5Nb25zdGVyPiA9IFtdXHJcbiAgICBsZXQgZGlzdE1hcCA6IHtbaWQ6IG51bWJlcl0gOiBudW1iZXIgfSA9IHt9XHJcbiAgICBsZXQgbWF4X2Rpc3QgOiBudW1iZXJcclxuICAgIGxldCBtb2Jfbm90ZV9jb2xvciA6IElDb2xvclxyXG5cclxuICAgIC8vIGNyZWF0ZSBzaW1wbGUgZGlzdGFuY2UgbWFwIGZyb20gcGxheWVyLCB0byBnYXVnZSByZWxhdGl2ZSB0aHJlYXRcclxuICAgIEJyZXcuSW50ZWwuZ2V0TW9uc3RlcnNLbm93bkJ5KGdtLCBwbGF5ZXIpLmZvckVhY2goKG1vYikgPT4ge1xyXG4gICAgICAgIG1vYl9saXN0LnB1c2gobW9iKVxyXG4gICAgICAgIGRpc3QgPSBCcmV3LlV0aWxzLmRpc3QyZChwbGF5ZXIubG9jYXRpb24sIG1vYi5sb2NhdGlvbilcclxuICAgICAgICBkaXN0TWFwW21vYi5nZXRJRCgpXSA9IGRpc3RcclxuICAgICAgICBtYXhfZGlzdCA9IE1hdGgubWF4KGRpc3QsIG1heF9kaXN0KVxyXG4gICAgfSlcclxuXHJcbiAgICBtb2JfbGlzdC5mb3JFYWNoKChtb2IsIGluZGV4KSA9PiB7XHJcbiAgICAgICAgbW9iX25vdGVfY29sb3IgPSBnZXREaWZmZXJlbnRpYXRlZENvbG9yKEJyZXcuQ29sb3IuZGFya19yZWQsIEJyZXcuQ29sb3IuZ29sZGVucm9kLCBtb2JfbGlzdC5sZW5ndGgsIGluZGV4KVxyXG5cclxuICAgICAgICBjb3ZlcmVkX2ZsYWdzID0gW10gLy8gcmVzZXQgZm9yIGVhY2ggbmV3IG1vYlxyXG4gICAgICAgIGRpc3QgPSBkaXN0TWFwW21vYi5nZXRJRCgpXVxyXG4gICAgICAgIC8vIGF0IGxlYXN0IG9uZSBub3RlIGZvciBoZWFsdGgvc2hpZWxkXHJcbiAgICAgICAgaHVkX25vdGVzLnB1c2gobmV3IE5vdGVNb25zdGVySGVhbHRoKG1vYiwgUFJJT1JJVFlfTU9CX0hFQUxUSCwgbW9iX25vdGVfY29sb3IpKVxyXG4gICAgICAgIHRpbWVkX2VmZmVjdHMgPSBnbS50aW1lcl9tb25pdG9yLmdldEFsbFRpbWVyc0Zvcihtb2IpXHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gcG90ZW50aWFsbHkgbXVsdGlwbGUgbm90ZXMgZm9yIHRpbWVkIHN0YXR1cyBlZmZlY3RzIChidXJuaW5nLCB3ZWFrZW5lZCwgZXRjKVxyXG4gICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCB0aW1lZF9lZmZlY3RzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIC8vIGh1ZF9ub3Rlcy5wdXNoKG5ldyBOb3RlVGltZWRFZmZlY3QodGltZWRfZWZmZWN0c1tpXSwgY3VycmVudF90dXJuLCBQUklPUklUWV9NT0JfRUZGRUNUUyAtIChtYXhfZGlzdCAtIGRpc3QpLCBtb2Jfbm90ZV9jb2xvcikpXHJcbiAgICAgICAgICAgIGh1ZF9ub3Rlcy5wdXNoKG5ldyBOb3RlVGltZWRFZmZlY3QodGltZWRfZWZmZWN0c1tpXSwgY3VycmVudF90dXJuLCBQUklPUklUWV9NT0JfRUZGRUNUUywgbW9iX25vdGVfY29sb3IpKVxyXG4gICAgICAgICAgICBpZiAoY292ZXJlZF9mbGFncy5pbmRleE9mKHRpbWVkX2VmZmVjdHNbaV0uZmxhZykgPT0gLTEpIHtcclxuICAgICAgICAgICAgICAgIGNvdmVyZWRfZmxhZ3MucHVzaCh0aW1lZF9lZmZlY3RzW2ldLmZsYWcpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIGxpc3QgYWxsIGJlaGF2aW9yYWwgKG5vbi10aW1lZCkgZWZmZWN0cy9mbGFnc1xyXG4gICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCBtb2IuZmxhZ3MubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgbGV0IG1vYl9mbGFnID0gbW9iLmZsYWdzW2ldXHJcbiAgICAgICAgICAgIGlmIChjb3ZlcmVkX2ZsYWdzLmluZGV4T2YobW9iX2ZsYWcpID09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBub3QgcHJldmlvdXNseSBjb3ZlcmVkXHJcbiAgICAgICAgICAgICAgICBodWRfbm90ZXMucHVzaChuZXcgTm90ZU1vbnN0ZXJGbGFnKG1vYiwgbW9iX2ZsYWcsIFBSSU9SSVRZX01PQl9GTEFHUywgbW9iX25vdGVfY29sb3IpKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAobW9iLnNwZWVkICE9IDEyKSB7XHJcbiAgICAgICAgICAgIGh1ZF9ub3Rlcy5wdXNoKG5ldyBOb3RlTW9uc3RlclNwZWVkKG1vYiwgbW9iLnNwZWVkLCBQUklPUklUWV9NT0JfRkxBR1MsIG1vYl9ub3RlX2NvbG9yKSlcclxuICAgICAgICB9XHJcbiAgICB9KVxyXG5cclxuICAgIC8vIGl0ZW1zXHJcbiAgICBsZXQgaXRlbV9saXN0IDogQXJyYXk8QnJldy5HcmlkVGhpbmdzLkl0ZW0+ID0gW11cclxuICAgIEJyZXcuSW50ZWwuZ2V0SXRlbXNLbm93bkJ5KGdtLCBnbS5nZXRQbGF5ZXIoKSkuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG4gICAgICAgIGl0ZW1fbGlzdC5wdXNoKGl0ZW0pXHJcbiAgICAgICAgZGlzdCA9IEJyZXcuVXRpbHMuZGlzdDJkKHBsYXllci5sb2NhdGlvbiwgaXRlbS5sb2NhdGlvbilcclxuICAgICAgICAvLyBwcmlvcml0eSA9IGludmVyc2Ugb2YgZGlzdGFuY2VcclxuICAgICAgICBkaXN0TWFwW2l0ZW0uZ2V0SUQoKV0gPSBkaXN0XHJcbiAgICAgICAgbWF4X2Rpc3QgPSBNYXRoLm1heChkaXN0LCBtYXhfZGlzdClcclxuICAgIH0pXHJcblxyXG4gICAgaXRlbV9saXN0LmZvckVhY2goKGl0ZW0pID0+IHtcclxuICAgICAgICBkaXN0ID0gZGlzdE1hcFtpdGVtLmdldElEKCldXHJcbiAgICAgICAgcHJpb3JpdHkgPSBQUklPUklUWV9JVEVNUyAvLyAtIChtYXhfZGlzdCAtIGRpc3QpXHJcbiAgICAgICAgaHVkX25vdGVzLnB1c2gobmV3IE5vdGVJdGVtT25GbG9vcihpdGVtLCBwcmlvcml0eSwgQnJldy5Db2xvci5ibHVlKSlcclxuICAgIH0pXHJcblxyXG4gICAgLy8gdGVycmFpbiBhbmQgZmVhdHVyZXMgLS0gb25seSBuZWVkIDEgb2YgZWFjaFxyXG4gICAgbGV0IGdlbmVyaWNfY29udGVudF9ub3RlcyA9IGdldEdlbmVyaWNDb250ZW50Tm90ZXMoZ20pXHJcblxyXG4gICAgbGV0IHNob3duX3RlcnJhaW4gOiB7IFtkZWY6IHN0cmluZ10gOiBib29sZWFuIH0gPSB7fVxyXG4gICAgbGV0IHNob3duX2ZlYXR1cmVzIDogeyBbZGVmOiBzdHJpbmddIDogYm9vbGVhbiB9ID0ge31cclxuICAgIGxldCBhbHJlYWR5X3Nob3duIDogYm9vbGVhblxyXG4gICAgbGV0IGNvbWJpbmVkX2dlbmVyaWNfbm90ZXMgOiBBcnJheTxIVUROb3RlPiA9IFtdXHJcbiAgICBjb21iaW5lZF9nZW5lcmljX25vdGVzID0gY29tYmluZWRfZ2VuZXJpY19ub3Rlcy5jb25jYXQoZ2VuZXJpY19jb250ZW50X25vdGVzLmZlYXR1cmVOb3RlcylcclxuICAgIGNvbWJpbmVkX2dlbmVyaWNfbm90ZXMgPSBjb21iaW5lZF9nZW5lcmljX25vdGVzLmNvbmNhdChnZW5lcmljX2NvbnRlbnRfbm90ZXMudGVycmFpbk5vdGVzKVxyXG5cclxuICAgIGZvciAobGV0IG5vdGUgb2YgY29tYmluZWRfZ2VuZXJpY19ub3Rlcykge1xyXG5cclxuICAgICAgICBhbHJlYWR5X3Nob3duID0gZmFsc2VcclxuICAgICAgICBpZiAobm90ZS5zdWJqZWN0IGluc3RhbmNlb2YgQnJldy5HcmlkVGhpbmdzLlRlcnJhaW4pIHtcclxuICAgICAgICAgICAgaWYgKG5vdGUuc3ViamVjdC5nZXREZWZpbml0aW9uKCkgaW4gc2hvd25fdGVycmFpbikge1xyXG4gICAgICAgICAgICAgICAgYWxyZWFkeV9zaG93biA9IHRydWVcclxuICAgICAgICAgICAgfSBcclxuICAgICAgICB9IGVsc2UgaWYgKG5vdGUuc3ViamVjdCBpbnN0YW5jZW9mIEJyZXcuR3JpZFRoaW5ncy5GZWF0dXJlKSB7XHJcbiAgICAgICAgICAgIGlmIChub3RlLnN1YmplY3QuZ2V0RGVmaW5pdGlvbigpIGluIHNob3duX2ZlYXR1cmVzKSB7XHJcbiAgICAgICAgICAgICAgICBhbHJlYWR5X3Nob3duID0gdHJ1ZVxyXG4gICAgICAgICAgICB9IFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKCEoYWxyZWFkeV9zaG93bikpIHtcclxuICAgICAgICAgICAgaWYgKG5vdGUuc3ViamVjdCBpbnN0YW5jZW9mIEJyZXcuR3JpZFRoaW5ncy5UZXJyYWluKSB7XHJcbiAgICAgICAgICAgICAgICBzaG93bl90ZXJyYWluW25vdGUuc3ViamVjdC5nZXREZWZpbml0aW9uKCldID0gdHJ1ZVxyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKG5vdGUuc3ViamVjdCBpbnN0YW5jZW9mIEJyZXcuR3JpZFRoaW5ncy5GZWF0dXJlKSB7XHJcbiAgICAgICAgICAgICAgICBzaG93bl9mZWF0dXJlc1tub3RlLnN1YmplY3QuZ2V0RGVmaW5pdGlvbigpXSA9IHRydWVcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaHVkX25vdGVzLnB1c2gobm90ZSlcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgaHVkX25vdGVzID0gaHVkX25vdGVzLmNvbmNhdChnZXRUYXJnZXRMb2NrTm90ZXMoZ20pKVxyXG5cclxuICAgIGh1ZF9ub3Rlcy5zb3J0KChub3RlX2EsIG5vdGVfYikgPT4ge1xyXG4gICAgICAgIHJldHVybiBub3RlX2IucHJpb3JpdHkgLSBub3RlX2EucHJpb3JpdHlcclxuICAgIH0pXHJcblxyXG4gICAgcmV0dXJuIGh1ZF9ub3Rlc1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0TGFiZWxPZmZzZXRzRm9yUG9pbnQoKSA6IEFycmF5PEJyZXcuQ29vcmRpbmF0ZT4ge1xyXG4gICAgbGV0IGxpc3RfYWxsID0gW0JyZXcuRGlyZWN0aW9ucy5MRUZULCBCcmV3LkRpcmVjdGlvbnMuUklHSFQsIEJyZXcuRGlyZWN0aW9ucy5VUF9SSUdIVCwgQnJldy5EaXJlY3Rpb25zLkRPV05fUklHSFQsIEJyZXcuRGlyZWN0aW9ucy5VUF9MRUZULCBCcmV3LkRpcmVjdGlvbnMuRE9XTl9MRUZUXVxyXG4gICAgLy8gcmV0dXJuIGxpc3RfYWxsXHJcbiAgICByZXR1cm4gQnJldy5VdGlscy5yYW5kb21pemUobGlzdF9hbGwsIGZhbHNlKVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgdXNlZnVsTGFiZWxBcnJvd0xvb2t1cCA6IHtbb2Zmc2V0X2lkOm51bWJlcl0gOiBzdHJpbmd9ID0ge31cclxudXNlZnVsTGFiZWxBcnJvd0xvb2t1cFtCcmV3LlV0aWxzLnh5VG9LZXkoQnJldy5EaXJlY3Rpb25zLlJJR0hUKV0gPSBCcmV3LlN5bWJvbHMucG9pbnRlcl9sZWZ0XHJcbnVzZWZ1bExhYmVsQXJyb3dMb29rdXBbQnJldy5VdGlscy54eVRvS2V5KEJyZXcuRGlyZWN0aW9ucy5MRUZUKV0gPSBCcmV3LlN5bWJvbHMucG9pbnRlcl9yaWdodFxyXG51c2VmdWxMYWJlbEFycm93TG9va3VwW0JyZXcuVXRpbHMueHlUb0tleShCcmV3LkRpcmVjdGlvbnMuVVApXSA9IEJyZXcuU3ltYm9scy5wb2ludGVyX2Rvd25cclxudXNlZnVsTGFiZWxBcnJvd0xvb2t1cFtCcmV3LlV0aWxzLnh5VG9LZXkoQnJldy5EaXJlY3Rpb25zLkRPV04pXSA9IEJyZXcuU3ltYm9scy5wb2ludGVyX3VwXHJcbnVzZWZ1bExhYmVsQXJyb3dMb29rdXBbQnJldy5VdGlscy54eVRvS2V5KEJyZXcuRGlyZWN0aW9ucy5ET1dOX0xFRlQpXSA9IEJyZXcuU3ltYm9scy5wb2ludGVyX3VwcmlnaHRcclxudXNlZnVsTGFiZWxBcnJvd0xvb2t1cFtCcmV3LlV0aWxzLnh5VG9LZXkoQnJldy5EaXJlY3Rpb25zLkRPV05fUklHSFQpXSA9IEJyZXcuU3ltYm9scy5wb2ludGVyX3VwbGVmdFxyXG51c2VmdWxMYWJlbEFycm93TG9va3VwW0JyZXcuVXRpbHMueHlUb0tleShCcmV3LkRpcmVjdGlvbnMuVVBfUklHSFQpXSA9IEJyZXcuU3ltYm9scy5wb2ludGVyX2Rvd25sZWZ0XHJcbnVzZWZ1bExhYmVsQXJyb3dMb29rdXBbQnJldy5VdGlscy54eVRvS2V5KEJyZXcuRGlyZWN0aW9ucy5VUF9MRUZUKV0gPSBCcmV3LlN5bWJvbHMucG9pbnRlcl9kb3ducmlnaHRcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRMYWJlbEFycm93Rm9yT2Zmc2V0KG9mZnNldF94eTogQnJldy5Db29yZGluYXRlKSA6IHN0cmluZyB7XHJcbiAgICByZXR1cm4gdXNlZnVsTGFiZWxBcnJvd0xvb2t1cFtCcmV3LlV0aWxzLnh5VG9LZXkob2Zmc2V0X3h5KV1cclxufVxyXG5cclxuXHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIElIZWFkc1VwUGFnZSB7XHJcbiAgICBncmlkOiBCcmV3LkdyaWRPZlRoaW5nczxJQ2hhckFuZENvbG9yPlxyXG4gICAgbm90ZTogQXJyYXk8SFVETm90ZT5cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldEhVRFBhZ2VzKGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGdpdmVuX25vdGVzOiBBcnJheTxIVUROb3RlPikgOiBBcnJheTxJSGVhZHNVcFBhZ2U+IHtcclxuICAgIC8vIHNvcnQgYnkgcHJpb3JpdHlcclxuICAgIGdpdmVuX25vdGVzLnNvcnQoKG5vdGVfYSwgbm90ZV9iKSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIG5vdGVfYi5wcmlvcml0eSAtIG5vdGVfYS5wcmlvcml0eVxyXG4gICAgfSlcclxuICAgIGxldCBtYXhfbm90ZXNfcGVyX3BhZ2UgPSA2XHJcblxyXG4gICAgbGV0IG1ha2VOZXdQYWdlID0gdHJ1ZVxyXG4gICAgbGV0IGFsbF9wYWdlcyA6IEFycmF5PElIZWFkc1VwUGFnZT4gPSBbXVxyXG4gICAgbGV0IGN1cnJlbnRQYWdlIDogSUhlYWRzVXBQYWdlXHJcbiAgICBsZXQgc2tpcHBlZF9ub3RlcyA6IEFycmF5PEhVRE5vdGU+ID0gW11cclxuXHJcbiAgICBsZXQgbm90ZV9pZHggPSAwXHJcbiAgICB3aGlsZSAobm90ZV9pZHggPCBnaXZlbl9ub3Rlcy5sZW5ndGgpIHtcclxuICAgICAgICBpZiAobWFrZU5ld1BhZ2UpIHtcclxuICAgICAgICAgICAgY3VycmVudFBhZ2UgPSB7XHJcbiAgICAgICAgICAgICAgICBncmlkOiBuZXcgQnJldy5HcmlkT2ZUaGluZ3M8SUNoYXJBbmRDb2xvcj4oKSxcclxuICAgICAgICAgICAgICAgIG5vdGU6IFtdXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgbWFrZU5ld1BhZ2UgPSBmYWxzZVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IHN1Y2Nlc3MgPSBmYWxzZVxyXG4gICAgICAgIGxldCB0ZXh0IDogc3RyaW5nXHJcbiAgICAgICAgbGV0IG5vdGUgPSBnaXZlbl9ub3Rlc1tub3RlX2lkeF1cclxuICAgICAgICBcclxuICAgICAgICBsZXQgZXhpc3RpbmdfY2hhciA9IGN1cnJlbnRQYWdlLmdyaWQuZ2V0QXQobm90ZS5zdWJqZWN0LmxvY2F0aW9uKVxyXG4gICAgICAgIFxyXG4gICAgICAgIGlmIChleGlzdGluZ19jaGFyKSB7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3MgPSBmYWxzZVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRleHQgPSBub3RlLmdldE92ZXJsYXlUZXh0KClcclxuICAgICAgICAgICAgc3VjY2VzcyA9IHBsYWNlV29yZHNPbkxldHRlckdyaWQoY3VycmVudFBhZ2UuZ3JpZCwgdGV4dCwgbm90ZS5nZXRDb2xvcigpLCBub3RlLnN1YmplY3QubG9jYXRpb24pXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoc3VjY2Vzcykge1xyXG4gICAgICAgICAgICBjdXJyZW50UGFnZS5ncmlkLnNldEF0KG5vdGUuc3ViamVjdC5sb2NhdGlvbiwgeyBjaGFyOiBub3RlLnN1YmplY3QuY29kZSwgY29sb3I6IG5vdGUuZ2V0Q29sb3IoKX0pXHJcbiAgICAgICAgICAgIGN1cnJlbnRQYWdlLm5vdGUucHVzaChub3RlKVxyXG4gICAgICAgICAgICBub3RlX2lkeCArPSAxXHJcbiAgICAgICAgfSBcclxuXHJcbiAgICAgICAgbWFrZU5ld1BhZ2UgPSAoIShzdWNjZXNzKSkgfHwgKGN1cnJlbnRQYWdlLm5vdGUubGVuZ3RoID09IG1heF9ub3Rlc19wZXJfcGFnZSlcclxuXHJcbiAgICAgICAgaWYgKG1ha2VOZXdQYWdlKSB7XHJcbiAgICAgICAgICAgIGFsbF9wYWdlcy5wdXNoKGN1cnJlbnRQYWdlKVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGFsbF9wYWdlcy5wdXNoKGN1cnJlbnRQYWdlKVxyXG5cclxuICAgIHJldHVybiBhbGxfcGFnZXNcclxufVxyXG5cclxuZnVuY3Rpb24gY2FsY1dvcmRzU3RhcnRDb29yZGluYXRlKHNwb3RfeHk6IEJyZXcuQ29vcmRpbmF0ZSwgb2Zmc2V0X3h5IDogQnJldy5Db29yZGluYXRlLCB3b3Jkczogc3RyaW5nKSA6IEJyZXcuQ29vcmRpbmF0ZSB7XHJcbiAgICBsZXQgcG9pbnRlcl94eSA9IHNwb3RfeHkuYWRkKG9mZnNldF94eSlcclxuICAgIGxldCB3b3Jkc19zdGFydF94eSA6IEJyZXcuQ29vcmRpbmF0ZSA9IG51bGxcclxuXHJcbiAgICBpZiAob2Zmc2V0X3h5LnggPiAwKSB7XHJcbiAgICAgICAgLy8gdGV4dCBmbG93cyB0byB0aGUgcmlnaHRcclxuICAgICAgICB3b3Jkc19zdGFydF94eSA9IHNwb3RfeHkuYWRkKG9mZnNldF94eSlcclxuICAgIH0gZWxzZSBpZiAob2Zmc2V0X3h5LiB4IDwgMCkge1xyXG4gICAgICAgIC8vIHRleHQgZmxvd3MgZnJvbSB0aGUgbGVmdFxyXG4gICAgICAgIHdvcmRzX3N0YXJ0X3h5ID0gc3BvdF94eS5hZGQob2Zmc2V0X3h5KS5hZGQobmV3IEJyZXcuQ29vcmRpbmF0ZSgtMSAqICh3b3Jkcy5sZW5ndGggLSAxKSwgMCkpXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcImZ1bmN0aW9uIG5vdCBkZXNpZ25lZCBmb3IgeHkueCA9IDBcIilcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gd29yZHNfc3RhcnRfeHlcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHBsYWNlV29yZHNPbkxldHRlckdyaWQoZ3JpZDogQnJldy5HcmlkT2ZUaGluZ3M8SUNoYXJBbmRDb2xvcj4sIHdvcmRzOiBzdHJpbmcsIGNvbG9yOiBCcmV3LkNvbG9yLklDb2xvciwgc3BvdF94eTogQnJldy5Db29yZGluYXRlKSA6IGJvb2xlYW4ge1xyXG4gICAgbGV0IGlzX29wZW4gOiBib29sZWFuXHJcbiAgICBsZXQgcG9pbnRlcl9jaGFyIDogc3RyaW5nXHJcbiAgICBsZXQgZnVsbF90ZXh0IDogc3RyaW5nXHJcbiAgICBsZXQgaSA6IG51bWJlclxyXG4gICAgbGV0IHh5IDogQnJldy5Db29yZGluYXRlXHJcbiAgICBsZXQgb2Zmc2V0X3h5X2xpc3QgPSBnZXRMYWJlbE9mZnNldHNGb3JQb2ludCgpXHJcbiAgICBsZXQgb2Zmc2V0X3h5IDogQnJldy5Db29yZGluYXRlXHJcbiAgICBsZXQgd29yZHNfc3RhcnRfeHkgOiBCcmV3LkNvb3JkaW5hdGVcclxuXHJcbiAgICAvLyBmb3IgKGxldCB3b3Jkc19zdGFydF94eSBvZiBvZmZzZXRfbGlzdCkge1xyXG4gICAgZm9yIChsZXQgaiA9IDA7IGogPCBvZmZzZXRfeHlfbGlzdC5sZW5ndGg7IGorKykge1xyXG4gICAgICAgIG9mZnNldF94eSA9IG9mZnNldF94eV9saXN0W2pdXHJcbiAgICAgICAgcG9pbnRlcl9jaGFyID0gZ2V0TGFiZWxBcnJvd0Zvck9mZnNldChvZmZzZXRfeHkpXHJcbiAgICAgICAgaWYgKG9mZnNldF94eS54ID4gMCkge1xyXG4gICAgICAgICAgICBmdWxsX3RleHQgPSBwb2ludGVyX2NoYXIgKyB3b3Jkc1xyXG4gICAgICAgIH0gZWxzZSBpZiAob2Zmc2V0X3h5LnggPCAwKSB7XHJcbiAgICAgICAgICAgIGZ1bGxfdGV4dCA9IHdvcmRzICsgcG9pbnRlcl9jaGFyXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiZnVuY3Rpb24gbm90IGRlc2lnbmVkIGZvciB4eS54ID0gMFwiKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgd29yZHNfc3RhcnRfeHkgPSBjYWxjV29yZHNTdGFydENvb3JkaW5hdGUoc3BvdF94eSwgb2Zmc2V0X3h5LCBmdWxsX3RleHQpXHJcbiAgICAgICAgXHJcbiAgICAgICAgaXNfb3BlbiA9IGNoZWNrSWZCbGFua1NwYWNlRXhpc3RzT25MZXR0ZXJHcmlkKGdyaWQsIGZ1bGxfdGV4dCwgd29yZHNfc3RhcnRfeHkpXHJcbiAgICAgICAgaWYgKGlzX29wZW4pIHtcclxuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IGZ1bGxfdGV4dC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgeHkgPSB3b3Jkc19zdGFydF94eS5hZGQobmV3IEJyZXcuQ29vcmRpbmF0ZShpLCAwKSlcclxuICAgICAgICAgICAgICAgIGdyaWQuc2V0QXQoeHksIHsgY2hhcjogZnVsbF90ZXh0W2ldLCBjb2xvcjogY29sb3J9KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGNvbnNvbGUubG9nKFwidW5hYmxlIHRvIGZpbmQgYSBzcG90IGZvciBcIiwgd29yZHMpXHJcbiAgICByZXR1cm4gZmFsc2VcclxufVxyXG5cclxuZnVuY3Rpb24gY2hlY2tJZkJsYW5rU3BhY2VFeGlzdHNPbkxldHRlckdyaWQoZ3JpZDogQnJldy5HcmlkT2ZUaGluZ3M8SUNoYXJBbmRDb2xvcj4sIHdvcmRzOiBzdHJpbmcsIHdvcmRzX3N0YXJ0X3h5OiBCcmV3LkNvb3JkaW5hdGUpIDogYm9vbGVhbiB7XHJcbiAgICAvLyByZXR1cm4gdHJ1ZSBpZiB3ZSB3ZXJlIGFibGUgdG8gcGxhY2UgdGhlIHdvcmRzIG9uIHRoZSBncmlkXHJcbiAgICBsZXQgeHk6IEJyZXcuQ29vcmRpbmF0ZVxyXG5cclxuICAgIC8vIG1ha2Ugc3VyZSBpdCBpcyBpbiBib3VuZHNcclxuICAgIGlmICgod29yZHNfc3RhcnRfeHkueCA8IDApIHx8ICh3b3Jkc19zdGFydF94eS55IDwgMCkpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgIH1cclxuXHJcbiAgICBpZiAoKHdvcmRzX3N0YXJ0X3h5LnggPj0gQnJldy5Db25maWcuc2NyZWVuX3dpZHRoX3RpbGVzKSB8fCAod29yZHNfc3RhcnRfeHkueSA+PSBCcmV3LkNvbmZpZy5zY3JlZW5faGVpZ2h0X3RpbGVzKSkge1xyXG4gICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgfVxyXG5cclxuICAgIGlmICgod29yZHNfc3RhcnRfeHkueCArIHdvcmRzLmxlbmd0aCAtIDEpID49IEJyZXcuQ29uZmlnLnNjcmVlbl93aWR0aF90aWxlcykge1xyXG4gICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgfVxyXG5cclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgd29yZHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICB4eSA9IHdvcmRzX3N0YXJ0X3h5LmFkZChuZXcgQnJldy5Db29yZGluYXRlKGksIDApKVxyXG4gICAgICAgIGlmIChncmlkLmhhc0F0KHh5KSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHRydWVcclxufVxyXG5cclxuaW50ZXJmYWNlIElVbmlxdWVDb250ZW50Tm90ZXMge1xyXG4gICAgdGVycmFpbk5vdGVzOiBBcnJheTxOb3RlVGVycmFpbj5cclxuICAgIGZlYXR1cmVOb3RlczogQXJyYXk8Tm90ZUZlYXR1cmU+XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdldEdlbmVyaWNDb250ZW50Tm90ZXMoZ206IEJyZXcuR2FtZU1hc3RlcikgOiBJVW5pcXVlQ29udGVudE5vdGVzIHtcclxuICAgIGxldCBwbGF5ZXIgPSBnbS5nZXRQbGF5ZXIoKVxyXG4gICAgbGV0IGxldmVsID0gZ20uZ2V0Q3VycmVudExldmVsKClcclxuICAgIGxldCB0ZXJyYWluX2F0IDogQnJldy5HcmlkVGhpbmdzLlRlcnJhaW5cclxuICAgIGxldCBmZWF0dXJlX2F0IDogQnJldy5HcmlkVGhpbmdzLkZlYXR1cmVcclxuICAgIGxldCB0ZXJyYWluX25vdGVzIDogQXJyYXk8Tm90ZVRlcnJhaW4+ID0gW11cclxuICAgIGxldCBmZWF0dXJlX25vdGVzIDogQXJyYXk8Tm90ZUZlYXR1cmU+ID0gW11cclxuICAgIFxyXG4gICAgLy8gbGV0IGxvY2F0aW9ucyA6IEFycmF5PEJyZXcuQ29vcmRpbmF0ZT4gPSBCcmV3LlV0aWxzLnJhbmRvbWl6ZShwbGF5ZXIuZm92LmdldEFsbENvb3JkaW5hdGVzKCksIGZhbHNlKVxyXG4gICAgbGV0IGxvY2F0aW9ucyA6IEFycmF5PEJyZXcuQ29vcmRpbmF0ZT4gPSBwbGF5ZXIuZm92LmdldEFsbENvb3JkaW5hdGVzKClcclxuXHJcbiAgICBmb3IgKGxldCB4eSBvZiBsb2NhdGlvbnMpIHtcclxuICAgICAgICB0ZXJyYWluX2F0ID0gbGV2ZWwudGVycmFpbi5nZXRBdCh4eSlcclxuICAgICAgICBpZiAodGVycmFpbl9hdCkgeyAvLyBzaG91bGQgYWx3YXlzIGJlIHRydWU/XHJcbiAgICAgICAgICAgIHRlcnJhaW5fbm90ZXMucHVzaChuZXcgTm90ZVRlcnJhaW4odGVycmFpbl9hdCwgUFJJT1JJVFlfVEVSUkFJTiwgQnJldy5Db2xvci5ub3JtYWwpKVxyXG4gICAgICAgIH1cclxuICAgICAgICBmZWF0dXJlX2F0ID0gbGV2ZWwuZmVhdHVyZXMuZ2V0QXQoeHkpXHJcbiAgICAgICAgaWYgKGZlYXR1cmVfYXQpIHtcclxuICAgICAgICAgICAgZmVhdHVyZV9ub3Rlcy5wdXNoKG5ldyBOb3RlRmVhdHVyZShmZWF0dXJlX2F0LCBQUklPUklUWV9GRUFUVVJFLCBCcmV3LkNvbG9yLm5vcm1hbCkpXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgdGVycmFpbk5vdGVzOiB0ZXJyYWluX25vdGVzLFxyXG4gICAgICAgIGZlYXR1cmVOb3RlczogZmVhdHVyZV9ub3Rlc1xyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBnZXRUYXJnZXRMb2NrTm90ZXMoZ206IEJyZXcuR2FtZU1hc3RlcikgOiBBcnJheTxOb3RlVGFyZ2V0aW5nTG9jaz4ge1xyXG4gICAgbGV0IGxvY2tfbm90ZXMgOiBBcnJheTxOb3RlVGFyZ2V0aW5nTG9jaz4gPSBbXVxyXG4gICAgbGV0IHBsYXllciA9IGdtLmdldFBsYXllcigpXHJcbiAgICBsZXQgbGV2ZWwgPSBnbS5nZXRDdXJyZW50TGV2ZWwoKVxyXG5cclxuICAgIGZvciAobGV0IG1vYiBvZiBsZXZlbC5tb25zdGVycy5nZXRBbGxUaGluZ3MoKSkge1xyXG4gICAgICAgIGlmIChCcmV3LlRhcmdldGluZy5oYXNUYXJnZXRMb2NrKG1vYiwgcGxheWVyKSkge1xyXG4gICAgICAgICAgICBsb2NrX25vdGVzLnB1c2gobmV3IE5vdGVUYXJnZXRpbmdMb2NrKG1vYiwgcGxheWVyLCBQUklPUklUWV9UQVJHRVRMT0NLLCBCcmV3LkNvbG9yLm9yYW5nZSkpXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBsb2NrX25vdGVzXHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdldERpZmZlcmVudGlhdGVkQ29sb3IoaGlnaF9jb2xvcjogSUNvbG9yLCBsb3dfY29sb3I6IElDb2xvciwgbnVtX2l0ZW1zOiBudW1iZXIsIHRoaXNfaXRlbV9udW06IG51bWJlcikgOiBJQ29sb3Ige1xyXG4gICAgbGV0IGZhY3RvciA9IHRoaXNfaXRlbV9udW0gLyBudW1faXRlbXNcclxuICAgIHJldHVybiBST1QuQ29sb3IuaW50ZXJwb2xhdGUobG93X2NvbG9yLCBoaWdoX2NvbG9yLCBmYWN0b3IpXHJcbn0iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/brew_game/hud_info.ts\n");

/***/ }),

/***/ "./src/brew_game/item_interaction.ts":
/*!*******************************************!*\
  !*** ./src/brew_game/item_interaction.ts ***!
  \*******************************************/
/*! exports provided: useItem, dropItemAttempt, pickup, doLandingEventAfterThrown, doLandingEventAfterHeave, triggerNanoCore, triggerGrenade */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"useItem\", function() { return useItem; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"dropItemAttempt\", function() { return dropItemAttempt; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"pickup\", function() { return pickup; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"doLandingEventAfterThrown\", function() { return doLandingEventAfterThrown; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"doLandingEventAfterHeave\", function() { return doLandingEventAfterHeave; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"triggerNanoCore\", function() { return triggerNanoCore; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"triggerGrenade\", function() { return triggerGrenade; });\n/* harmony import */ var _brew__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../brew */ \"./src/brew.ts\");\n\r\nfunction useItem(gm, brEvent) {\r\n    // todo: replace this with a proper use event (also what is there to use)\r\n    // for now just consume and give health\r\n    let item = brEvent.itemData.item;\r\n    let invkey = brEvent.itemData.invkey;\r\n    let player = gm.getPlayer();\r\n    player.inventory.removeItemByKey(invkey);\r\n    player.hp.increment(1);\r\n    console.log(\"+1 health\");\r\n    gm.endEvent(brEvent);\r\n}\r\nfunction dropItemAttempt(gm, data) {\r\n    let drop_xy = data.itemData.to_xy;\r\n    let it = gm.getCurrentLevel().items.getAt(drop_xy);\r\n    if (it) {\r\n        // let dropError : Brew.Enums.IBrewEvent = {\r\n        //     eventType: Brew.Enums.BrewEventType.Error,\r\n        //     actor: null, // gm.getPlayer(),\r\n        //     playerInitiated: true,\r\n        //     endsTurn: false,\r\n        //     errorMsg: \"something is already here\"\r\n        // }\r\n        // data.endsTurn = false\r\n        // gm.insertEvent(dropError)\r\n        // console.log(\"something already is here\")\r\n        gm.display.drawPopupMessage(\"Already something here\", gm.getPlayer().location, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].white);\r\n        data.endsTurn = false;\r\n        gm.endEvent(data);\r\n    }\r\n    else {\r\n        let invkey = data.itemData.invkey;\r\n        let item = data.itemData.item;\r\n        gm.getPlayer().inventory.removeItemByKey(invkey); // already happens in landing event\r\n        gm.getCurrentLevel().items.setAt(drop_xy, item);\r\n        gm.displayAt(drop_xy);\r\n        gm.endEvent(data);\r\n    }\r\n}\r\nfunction pickup(gm, data) {\r\n    // remove it from the floor\r\n    let it = data.itemData.item;\r\n    gm.getCurrentLevel().items.removeAt(it.location);\r\n    // console.log(\"removed from level\", it.location)\r\n    // Intel.updateMemoryAt(gm, gm.getPlayer(), it.location)\r\n    // add to inventory\r\n    let ok = gm.getPlayer().inventory.addItem(it);\r\n    gm.display.drawPopupMessage(\"Picked up \" + _brew__WEBPACK_IMPORTED_MODULE_0__[\"Glossary\"].getItemName(it), data.actor.location, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].violet);\r\n    if (!(ok)) {\r\n        gm.display.drawPopupMessage(\"No more room!\", it.location, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].violet);\r\n        throw new Error(\"inventory full - we shouldn't be here\");\r\n    }\r\n    console.log(`Picked up ${it.name}`);\r\n    gm.endEvent(data);\r\n}\r\nfunction doLandingEventAfterThrown(gm, brEvent) {\r\n    let item = brEvent.itemData.item;\r\n    let level = gm.getCurrentLevel();\r\n    // if it explodes...\r\n    if (item.isType(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].ItemType.Grenade) || item.isType(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].ItemType.Nanotech)) {\r\n        // remove the item from inventory\r\n        gm.getPlayer().inventory.removeItemByKey(brEvent.itemData.invkey);\r\n        if (item.isType(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].ItemType.Grenade)) {\r\n            triggerGrenade(gm, brEvent.itemData.item, brEvent.itemData.to_xy);\r\n        }\r\n        else if (item.isType(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].ItemType.Nanotech)) {\r\n            triggerNanoCore(gm, brEvent.itemData.item, brEvent.itemData.to_xy);\r\n        }\r\n        gm.endEvent(brEvent);\r\n    }\r\n    else {\r\n        dropItemAttempt(gm, brEvent);\r\n        return;\r\n    }\r\n}\r\nfunction doLandingEventAfterHeave(gm, brEvent) {\r\n    let item = brEvent.itemData.item;\r\n    let level = gm.getCurrentLevel();\r\n    // clear item from the original location\r\n    level.items.removeAt(brEvent.itemData.item.location);\r\n    // check for target\r\n    let mob_at = level.monsters.getAt(brEvent.itemData.to_xy);\r\n    if (mob_at) {\r\n        let hitUpsideYoHeadEvent = {\r\n            eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.Attack,\r\n            actor: brEvent.actor,\r\n            playerInitiated: true,\r\n            endsTurn: false,\r\n            attackData: {\r\n                from_xy: brEvent.itemData.item.location,\r\n                to_xy: brEvent.itemData.to_xy,\r\n                isMelee: true,\r\n                damage: 1,\r\n                target: mob_at,\r\n            }\r\n        };\r\n        gm.insertEvent(hitUpsideYoHeadEvent);\r\n    }\r\n    else {\r\n        // item removed so no need to do anything extra.. dont think we want heaving multiple times\r\n    }\r\n    gm.endEvent(brEvent);\r\n}\r\nfunction triggerNanoCore(gm, nano_item, target_xy) {\r\n    let level = gm.getCurrentLevel();\r\n    let terrain_at;\r\n    let feature_at;\r\n    // feature map\r\n    let feature_type;\r\n    if (nano_item.subtype == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].ItemSubtype.N_Health) {\r\n        feature_type = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].FeatureType.RepairGoo;\r\n    }\r\n    else if (nano_item.subtype == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].ItemSubtype.N_Acid) {\r\n        feature_type = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].FeatureType.CorrosiveAcid;\r\n    }\r\n    else if (nano_item.subtype == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].ItemSubtype.N_Armor) {\r\n        feature_type = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].FeatureType.ProtectiveGoo;\r\n    }\r\n    else {\r\n        console.error(\"unknown nano goo\");\r\n    }\r\n    let max_tiles = 5;\r\n    let num_tiles = 1;\r\n    let affected_area = [target_xy];\r\n    let offset_list = [_brew__WEBPACK_IMPORTED_MODULE_0__[\"Directions\"].UP.clone(), _brew__WEBPACK_IMPORTED_MODULE_0__[\"Directions\"].DOWN.clone(), _brew__WEBPACK_IMPORTED_MODULE_0__[\"Directions\"].LEFT.clone(), _brew__WEBPACK_IMPORTED_MODULE_0__[\"Directions\"].RIGHT.clone()];\r\n    let avoid_indices = [];\r\n    let offset_i;\r\n    let dist = 1;\r\n    let xy;\r\n    while (num_tiles < max_tiles) {\r\n        for (offset_i = 0; offset_i < offset_list.length; offset_i++) {\r\n            if (avoid_indices.indexOf(offset_i) > -1) {\r\n                // don't grow in this direction\r\n                continue;\r\n            }\r\n            xy = target_xy.add(offset_list[offset_i].multiplyScalar(dist));\r\n            if (!(level.isValid(xy))) {\r\n                continue;\r\n            }\r\n            terrain_at = level.terrain.getAt(xy);\r\n            if (terrain_at.blocks_walking) {\r\n                avoid_indices.push(offset_i);\r\n                continue;\r\n            }\r\n            feature_at = level.features.getAt(xy);\r\n            if (feature_at && feature_at.getDefinition() == feature_type) {\r\n                avoid_indices.push(offset_i);\r\n                continue;\r\n            }\r\n            affected_area.push(xy);\r\n            num_tiles += 1;\r\n            if (num_tiles == max_tiles) {\r\n                break;\r\n            }\r\n        }\r\n        dist += 1;\r\n    }\r\n    affected_area.forEach((xy, index) => {\r\n        feature_at = level.features.getAt(xy);\r\n        if (feature_at) {\r\n            level.features.removeAt(xy);\r\n        }\r\n        level.features.setAt(xy, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].featureFactory(feature_type));\r\n    });\r\n    gm.displayList(affected_area);\r\n}\r\nfunction triggerGrenade(gm, grenade_item, target_xy) {\r\n    // for concussion grenades use existing knockback event caller\r\n    if (grenade_item.subtype == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].ItemSubtype.G_Concusive) {\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"Combat\"].triggerKnockbackBlast(gm, target_xy, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Config\"].grenade_radius);\r\n        return;\r\n    }\r\n    // otherwise go through and apply damage / effects\r\n    let level = gm.getCurrentLevel();\r\n    let player = gm.getPlayer();\r\n    let blast_radius = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Config\"].grenade_radius;\r\n    // let affected_mobs = Utils.getMonstersWithinRadius(level, target_xy, Brew.Config.grenade_radius)\r\n    let area = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].getBlastArea(level, target_xy, blast_radius);\r\n    let affected_mobs = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].getMonstersWithinCoordinateArea(level, area);\r\n    let affected_area = affected_mobs.map((mob) => { return mob.location; });\r\n    let damage;\r\n    let effect_flags;\r\n    let blast_color;\r\n    if (grenade_item.subtype == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].ItemSubtype.G_Explosive) {\r\n        damage = grenade_item.damage;\r\n        effect_flags = [];\r\n        blast_color = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].color_explosion;\r\n    }\r\n    else if (grenade_item.subtype == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].ItemSubtype.G_Stun) {\r\n        damage = 0;\r\n        effect_flags = [_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].Flag.CausesStun];\r\n        blast_color = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].color_stun;\r\n    }\r\n    else {\r\n        throw new Error(`unknown grenade type ${grenade_item.subtype}`);\r\n    }\r\n    let massEvent = {\r\n        eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.MassDamage,\r\n        actor: gm.getPlayer(),\r\n        playerInitiated: true,\r\n        endsTurn: false,\r\n        attackData: {\r\n            from_xy: player.location,\r\n            to_xy: target_xy,\r\n            isMelee: false,\r\n            target: null,\r\n            damage: damage,\r\n            effects: effect_flags,\r\n        },\r\n        pathsData: {\r\n            from_xy: null,\r\n            to_xy: null,\r\n            path: affected_area,\r\n        }\r\n    };\r\n    gm.insertEvent({\r\n        eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.RunAnimation,\r\n        actor: gm.getPlayer(),\r\n        playerInitiated: false,\r\n        endsTurn: false,\r\n        animationData: {\r\n            animationType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewAnimationType.CircleOut,\r\n            color: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].color_force,\r\n            from_xy: target_xy,\r\n            to_xy: target_xy,\r\n            range: blast_radius\r\n        }\r\n    });\r\n    gm.insertEvent(massEvent);\r\n}\r\n// export function setItemAtLocation(level: Level, item: Brew.GridThings.Item, target_xy: Brew.Coordinate) {\r\n//     let existing_item = level.items.getAt(target_xy)\r\n//     if (existing_item) {\r\n//         pushExistingItemAwayToSafeSpot(level, existing_item)\r\n//     }\r\n//     level.items.setAt(target_xy, item)\r\n// }\r\n// export function pushExistingItemAwayToSafeSpot(level: Level, item_at: Brew.GridThings.Item) {\r\n//     let item_xy = item_at.location.clone()\r\n//     let near_xy = level.getSafeLocationNear(item_xy, true)\r\n//     level.items.removeAt(item_xy)\r\n//     level.items.setAt(near_xy, item_at)\r\n// }\r\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvYnJld19nYW1lL2l0ZW1faW50ZXJhY3Rpb24udHM/Mjc5NSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBK0I7QUFFekIsaUJBQWtCLEVBQW1CLEVBQUUsT0FBOEI7SUFDdkUseUVBQXlFO0lBQ3pFLHVDQUF1QztJQUV2QyxJQUFJLElBQUksR0FBRyxPQUFPLENBQUMsUUFBUSxDQUFDLElBQUk7SUFDaEMsSUFBSSxNQUFNLEdBQUcsT0FBTyxDQUFDLFFBQVEsQ0FBQyxNQUFNO0lBQ3BDLElBQUksTUFBTSxHQUFHLEVBQUUsQ0FBQyxTQUFTLEVBQUU7SUFFM0IsTUFBTSxDQUFDLFNBQVMsQ0FBQyxlQUFlLENBQUMsTUFBTSxDQUFDO0lBQ3hDLE1BQU0sQ0FBQyxFQUFFLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQztJQUN0QixPQUFPLENBQUMsR0FBRyxDQUFDLFdBQVcsQ0FBQztJQUN4QixFQUFFLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQztBQUV4QixDQUFDO0FBRUsseUJBQTBCLEVBQW1CLEVBQUUsSUFBMkI7SUFDNUUsSUFBSSxPQUFPLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQyxLQUFLO0lBRWpDLElBQUksRUFBRSxHQUFHLEVBQUUsQ0FBQyxlQUFlLEVBQUUsQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQztJQUNsRCxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO1FBQ0wsNENBQTRDO1FBQzVDLGlEQUFpRDtRQUNqRCxzQ0FBc0M7UUFDdEMsNkJBQTZCO1FBQzdCLHVCQUF1QjtRQUN2Qiw0Q0FBNEM7UUFDNUMsSUFBSTtRQUVKLHdCQUF3QjtRQUN4Qiw0QkFBNEI7UUFDNUIsMkNBQTJDO1FBQzNDLEVBQUUsQ0FBQyxPQUFPLENBQUMsZ0JBQWdCLENBQUMsd0JBQXdCLEVBQUUsRUFBRSxDQUFDLFNBQVMsRUFBRSxDQUFDLFFBQVEsRUFBRSwyQ0FBVSxDQUFDLEtBQUssQ0FBQztRQUNoRyxJQUFJLENBQUMsUUFBUSxHQUFHLEtBQUs7UUFDckIsRUFBRSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUM7SUFFckIsQ0FBQztJQUFDLElBQUksQ0FBQyxDQUFDO1FBQ0osSUFBSSxNQUFNLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNO1FBQ2pDLElBQUksSUFBSSxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsSUFBSTtRQUU3QixFQUFFLENBQUMsU0FBUyxFQUFFLENBQUMsU0FBUyxDQUFDLGVBQWUsQ0FBQyxNQUFNLENBQUMsRUFBQyxtQ0FBbUM7UUFDcEYsRUFBRSxDQUFDLGVBQWUsRUFBRSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsT0FBTyxFQUFFLElBQUksQ0FBQztRQUMvQyxFQUFFLENBQUMsU0FBUyxDQUFDLE9BQU8sQ0FBQztRQUNyQixFQUFFLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQztJQUVyQixDQUFDO0FBQ0wsQ0FBQztBQUVLLGdCQUFpQixFQUFtQixFQUFFLElBQTJCO0lBRW5FLDJCQUEyQjtJQUMzQixJQUFJLEVBQUUsR0FBMEIsSUFBSSxDQUFDLFFBQVEsQ0FBQyxJQUFJO0lBQ2xELEVBQUUsQ0FBQyxlQUFlLEVBQUUsQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBQyxRQUFRLENBQUM7SUFDaEQsaURBQWlEO0lBQ2pELHdEQUF3RDtJQUV4RCxtQkFBbUI7SUFDbkIsSUFBSSxFQUFFLEdBQUcsRUFBRSxDQUFDLFNBQVMsRUFBRSxDQUFDLFNBQVMsQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDO0lBQzdDLEVBQUUsQ0FBQyxPQUFPLENBQUMsZ0JBQWdCLENBQUMsWUFBWSxHQUFHLDhDQUFhLENBQUMsV0FBVyxDQUFDLEVBQUUsQ0FBQyxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsUUFBUSxFQUFFLDJDQUFVLENBQUMsTUFBTSxDQUFDO0lBRWpILEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDUixFQUFFLENBQUMsT0FBTyxDQUFDLGdCQUFnQixDQUFDLGVBQWUsRUFBRSxFQUFFLENBQUMsUUFBUSxFQUFFLDJDQUFVLENBQUMsTUFBTSxDQUFDO1FBQzVFLE1BQU0sSUFBSSxLQUFLLENBQUMsdUNBQXVDLENBQUM7SUFDNUQsQ0FBQztJQUVELE9BQU8sQ0FBQyxHQUFHLENBQUMsYUFBYSxFQUFFLENBQUMsSUFBSSxFQUFFLENBQUM7SUFDbkMsRUFBRSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUM7QUFDckIsQ0FBQztBQUVLLG1DQUFvQyxFQUFtQixFQUFFLE9BQThCO0lBQ3pGLElBQUksSUFBSSxHQUFHLE9BQU8sQ0FBQyxRQUFRLENBQUMsSUFBSTtJQUNoQyxJQUFJLEtBQUssR0FBRyxFQUFFLENBQUMsZUFBZSxFQUFFO0lBR2hDLG9CQUFvQjtJQUNwQixFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLGlEQUFnQixDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsSUFBSSxJQUFJLENBQUMsTUFBTSxDQUFDLGlEQUFnQixDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFFcEcsaUNBQWlDO1FBQ2pDLEVBQUUsQ0FBQyxTQUFTLEVBQUUsQ0FBQyxTQUFTLENBQUMsZUFBZSxDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDO1FBRWpFLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsaURBQWdCLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUNqRCxjQUFjLENBQUMsRUFBRSxFQUFFLE9BQU8sQ0FBQyxRQUFRLENBQUMsSUFBSSxFQUFFLE9BQU8sQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDO1FBRXJFLENBQUM7UUFBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxpREFBZ0IsQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ3pELGVBQWUsQ0FBQyxFQUFFLEVBQUUsT0FBTyxDQUFDLFFBQVEsQ0FBQyxJQUFJLEVBQUUsT0FBTyxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUM7UUFDdEUsQ0FBQztRQUVELEVBQUUsQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDO0lBRXhCLENBQUM7SUFBQyxJQUFJLENBQUMsQ0FBQztRQUNKLGVBQWUsQ0FBQyxFQUFFLEVBQUUsT0FBTyxDQUFDO1FBQzVCLE1BQU07SUFDVixDQUFDO0FBQ0wsQ0FBQztBQUVLLGtDQUFtQyxFQUFtQixFQUFFLE9BQThCO0lBQ3hGLElBQUksSUFBSSxHQUFHLE9BQU8sQ0FBQyxRQUFRLENBQUMsSUFBSTtJQUNoQyxJQUFJLEtBQUssR0FBRyxFQUFFLENBQUMsZUFBZSxFQUFFO0lBRWhDLHdDQUF3QztJQUN4QyxLQUFLLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUM7SUFFcEQsbUJBQW1CO0lBQ25CLElBQUksTUFBTSxHQUFHLEtBQUssQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDO0lBQ3pELEVBQUUsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUM7UUFDVCxJQUFJLG9CQUFvQixHQUEyQjtZQUMvQyxTQUFTLEVBQUUsMkNBQVUsQ0FBQyxhQUFhLENBQUMsTUFBTTtZQUMxQyxLQUFLLEVBQUUsT0FBTyxDQUFDLEtBQUs7WUFDcEIsZUFBZSxFQUFFLElBQUk7WUFDckIsUUFBUSxFQUFFLEtBQUs7WUFDZixVQUFVLEVBQUU7Z0JBQ1IsT0FBTyxFQUFFLE9BQU8sQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLFFBQVE7Z0JBQ3ZDLEtBQUssRUFBRSxPQUFPLENBQUMsUUFBUSxDQUFDLEtBQUs7Z0JBQzdCLE9BQU8sRUFBRSxJQUFJO2dCQUNiLE1BQU0sRUFBRSxDQUFDO2dCQUNULE1BQU0sRUFBRSxNQUFNO2FBRWpCO1NBQ0o7UUFDRCxFQUFFLENBQUMsV0FBVyxDQUFDLG9CQUFvQixDQUFDO0lBQ3hDLENBQUM7SUFBQyxJQUFJLENBQUMsQ0FBQztRQUNKLDJGQUEyRjtJQUMvRixDQUFDO0lBQ0QsRUFBRSxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUM7QUFDeEIsQ0FBQztBQUVLLHlCQUEwQixFQUFtQixFQUFFLFNBQStCLEVBQUUsU0FBMEI7SUFDNUcsSUFBSSxLQUFLLEdBQUcsRUFBRSxDQUFDLGVBQWUsRUFBRTtJQUNoQyxJQUFJLFVBQW9DO0lBQ3hDLElBQUksVUFBb0M7SUFFeEMsY0FBYztJQUNkLElBQUksWUFBMkM7SUFFL0MsRUFBRSxDQUFDLENBQUMsU0FBUyxDQUFDLE9BQU8sSUFBSSxpREFBZ0IsQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQztRQUM3RCxZQUFZLEdBQUcsaURBQWdCLENBQUMsV0FBVyxDQUFDLFNBQVM7SUFDekQsQ0FBQztJQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxTQUFTLENBQUMsT0FBTyxJQUFJLGlEQUFnQixDQUFDLFdBQVcsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDO1FBQ2xFLFlBQVksR0FBRyxpREFBZ0IsQ0FBQyxXQUFXLENBQUMsYUFBYTtJQUM3RCxDQUFDO0lBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxPQUFPLElBQUksaURBQWdCLENBQUMsV0FBVyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUM7UUFDbkUsWUFBWSxHQUFHLGlEQUFnQixDQUFDLFdBQVcsQ0FBQyxhQUFhO0lBQzdELENBQUM7SUFBQyxJQUFJLENBQUMsQ0FBQztRQUNKLE9BQU8sQ0FBQyxLQUFLLENBQUMsa0JBQWtCLENBQUM7SUFDckMsQ0FBQztJQUVELElBQUksU0FBUyxHQUFHLENBQUM7SUFDakIsSUFBSSxTQUFTLEdBQUcsQ0FBQztJQUNqQixJQUFJLGFBQWEsR0FBRyxDQUFDLFNBQVMsQ0FBQztJQUMvQixJQUFJLFdBQVcsR0FBRyxDQUFDLGdEQUFlLENBQUMsRUFBRSxDQUFDLEtBQUssRUFBRSxFQUFFLGdEQUFlLENBQUMsSUFBSSxDQUFDLEtBQUssRUFBRSxFQUFFLGdEQUFlLENBQUMsSUFBSSxDQUFDLEtBQUssRUFBRSxFQUFFLGdEQUFlLENBQUMsS0FBSyxDQUFDLEtBQUssRUFBRSxDQUFDO0lBQ3pJLElBQUksYUFBYSxHQUFjLEVBQUU7SUFFakMsSUFBSSxRQUFpQjtJQUNyQixJQUFJLElBQUksR0FBRyxDQUFDO0lBQ1osSUFBSSxFQUFvQjtJQUV4QixPQUFPLFNBQVMsR0FBRyxTQUFTLEVBQUUsQ0FBQztRQUUzQixHQUFHLENBQUMsQ0FBQyxRQUFRLEdBQUcsQ0FBQyxFQUFFLFFBQVEsR0FBRyxXQUFXLENBQUMsTUFBTSxFQUFFLFFBQVEsRUFBRSxFQUFFLENBQUM7WUFDM0QsRUFBRSxDQUFDLENBQUMsYUFBYSxDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7Z0JBQ3ZDLCtCQUErQjtnQkFDL0IsUUFBUTtZQUNaLENBQUM7WUFFRCxFQUFFLEdBQUcsU0FBUyxDQUFDLEdBQUcsQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxDQUFDO1lBRTlELEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO2dCQUN2QixRQUFRO1lBQ1osQ0FBQztZQUVELFVBQVUsR0FBRyxLQUFLLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUM7WUFDcEMsRUFBRSxDQUFDLENBQUMsVUFBVSxDQUFDLGNBQWMsQ0FBQyxDQUFDLENBQUM7Z0JBQzVCLGFBQWEsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDO2dCQUM1QixRQUFRO1lBQ1osQ0FBQztZQUVELFVBQVUsR0FBRyxLQUFLLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUM7WUFDckMsRUFBRSxDQUFDLENBQUMsVUFBVSxJQUFJLFVBQVUsQ0FBQyxhQUFhLEVBQUUsSUFBSSxZQUFZLENBQUMsQ0FBQyxDQUFDO2dCQUMzRCxhQUFhLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQztnQkFDNUIsUUFBUTtZQUNaLENBQUM7WUFFRCxhQUFhLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQztZQUN0QixTQUFTLElBQUksQ0FBQztZQUVkLEVBQUUsQ0FBQyxDQUFDLFNBQVMsSUFBSSxTQUFTLENBQUMsQ0FBQyxDQUFDO2dCQUN6QixLQUFLO1lBQ1QsQ0FBQztRQUNMLENBQUM7UUFFRCxJQUFJLElBQUksQ0FBQztJQUNiLENBQUM7SUFFRCxhQUFhLENBQUMsT0FBTyxDQUFDLENBQUMsRUFBbUIsRUFBRSxLQUFhLEVBQUUsRUFBRTtRQUN6RCxVQUFVLEdBQUcsS0FBSyxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDO1FBQ3JDLEVBQUUsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUM7WUFDYixLQUFLLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUM7UUFDL0IsQ0FBQztRQUVELEtBQUssQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLEVBQUUsRUFBRSxpREFBZ0IsQ0FBQyxjQUFjLENBQUMsWUFBWSxDQUFDLENBQUM7SUFDM0UsQ0FBQyxDQUFDO0lBQ0YsRUFBRSxDQUFDLFdBQVcsQ0FBQyxhQUFhLENBQUM7QUFDakMsQ0FBQztBQUVLLHdCQUF5QixFQUFtQixFQUFFLFlBQWtDLEVBQUUsU0FBMEI7SUFFOUcsOERBQThEO0lBQzlELEVBQUUsQ0FBQyxDQUFDLFlBQVksQ0FBQyxPQUFPLElBQUksaURBQWdCLENBQUMsV0FBVyxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUM7UUFDbkUsNENBQVcsQ0FBQyxxQkFBcUIsQ0FBQyxFQUFFLEVBQUUsU0FBUyxFQUFFLDRDQUFXLENBQUMsY0FBYyxDQUFDO1FBQzVFLE1BQU07SUFDVixDQUFDO0lBRUQsa0RBQWtEO0lBQ2xELElBQUksS0FBSyxHQUFHLEVBQUUsQ0FBQyxlQUFlLEVBQUU7SUFDaEMsSUFBSSxNQUFNLEdBQUcsRUFBRSxDQUFDLFNBQVMsRUFBRTtJQUMzQixJQUFJLFlBQVksR0FBRyw0Q0FBVyxDQUFDLGNBQWM7SUFFN0Msa0dBQWtHO0lBQ2xHLElBQUksSUFBSSxHQUFHLDJDQUFVLENBQUMsWUFBWSxDQUFDLEtBQUssRUFBRSxTQUFTLEVBQUUsWUFBWSxDQUFDO0lBQ2xFLElBQUksYUFBYSxHQUFHLDJDQUFVLENBQUMsK0JBQStCLENBQUMsS0FBSyxFQUFFLElBQUksQ0FBQztJQUMzRSxJQUFJLGFBQWEsR0FBRyxhQUFhLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxFQUFFLEVBQUUsR0FBRyxNQUFNLENBQUMsR0FBRyxDQUFDLFFBQVEsRUFBQyxDQUFDLENBQUM7SUFFdkUsSUFBSSxNQUFjO0lBQ2xCLElBQUksWUFBb0M7SUFDeEMsSUFBSSxXQUErQjtJQUVuQyxFQUFFLENBQUMsQ0FBQyxZQUFZLENBQUMsT0FBTyxJQUFJLGlEQUFnQixDQUFDLFdBQVcsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDO1FBQ25FLE1BQU0sR0FBRyxZQUFZLENBQUMsTUFBTTtRQUM1QixZQUFZLEdBQUcsRUFBRTtRQUNqQixXQUFXLEdBQUcsMkNBQVUsQ0FBQyxlQUFlO0lBRTVDLENBQUM7SUFBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsWUFBWSxDQUFDLE9BQU8sSUFBSSxpREFBZ0IsQ0FBQyxXQUFXLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQztRQUNyRSxNQUFNLEdBQUcsQ0FBQztRQUNWLFlBQVksR0FBRyxDQUFDLDJDQUFVLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQztRQUMzQyxXQUFXLEdBQUcsMkNBQVUsQ0FBQyxVQUFVO0lBQ3ZDLENBQUM7SUFBQyxJQUFJLENBQUMsQ0FBQztRQUNKLE1BQU0sSUFBSSxLQUFLLENBQUMsd0JBQXdCLFlBQVksQ0FBQyxPQUFPLEVBQUUsQ0FBQztJQUNuRSxDQUFDO0lBRUQsSUFBSSxTQUFTLEdBQTJCO1FBQ3BDLFNBQVMsRUFBRSwyQ0FBVSxDQUFDLGFBQWEsQ0FBQyxVQUFVO1FBQzlDLEtBQUssRUFBRSxFQUFFLENBQUMsU0FBUyxFQUFFO1FBQ3JCLGVBQWUsRUFBRSxJQUFJO1FBQ3JCLFFBQVEsRUFBRSxLQUFLO1FBQ2YsVUFBVSxFQUFFO1lBQ1IsT0FBTyxFQUFFLE1BQU0sQ0FBQyxRQUFRO1lBQ3hCLEtBQUssRUFBRSxTQUFTO1lBQ2hCLE9BQU8sRUFBRSxLQUFLO1lBQ2QsTUFBTSxFQUFFLElBQUk7WUFDWixNQUFNLEVBQUUsTUFBTTtZQUNkLE9BQU8sRUFBRSxZQUFZO1NBQ3hCO1FBQ0QsU0FBUyxFQUFFO1lBQ1AsT0FBTyxFQUFFLElBQUk7WUFDYixLQUFLLEVBQUUsSUFBSTtZQUNYLElBQUksRUFBRSxhQUFhO1NBQ3RCO0tBQ0o7SUFDRCxFQUFFLENBQUMsV0FBVyxDQUFDO1FBQ1gsU0FBUyxFQUFFLDJDQUFVLENBQUMsYUFBYSxDQUFDLFlBQVk7UUFDaEQsS0FBSyxFQUFFLEVBQUUsQ0FBQyxTQUFTLEVBQUU7UUFDckIsZUFBZSxFQUFFLEtBQUs7UUFDdEIsUUFBUSxFQUFFLEtBQUs7UUFDZixhQUFhLEVBQUU7WUFDWCxhQUFhLEVBQUUsMkNBQVUsQ0FBQyxpQkFBaUIsQ0FBQyxTQUFTO1lBQ3JELEtBQUssRUFBRSwyQ0FBVSxDQUFDLFdBQVc7WUFDN0IsT0FBTyxFQUFFLFNBQVM7WUFDbEIsS0FBSyxFQUFFLFNBQVM7WUFDaEIsS0FBSyxFQUFFLFlBQVk7U0FDdEI7S0FDSixDQUFDO0lBQ0YsRUFBRSxDQUFDLFdBQVcsQ0FBQyxTQUFTLENBQUM7QUFDN0IsQ0FBQztBQUVELDRHQUE0RztBQUM1Ryx1REFBdUQ7QUFFdkQsMkJBQTJCO0FBQzNCLCtEQUErRDtBQUMvRCxRQUFRO0FBQ1IseUNBQXlDO0FBQ3pDLElBQUk7QUFFSixnR0FBZ0c7QUFDaEcsNkNBQTZDO0FBQzdDLDZEQUE2RDtBQUM3RCxvQ0FBb0M7QUFDcEMsMENBQTBDO0FBQzFDLElBQUkiLCJmaWxlIjoiLi9zcmMvYnJld19nYW1lL2l0ZW1faW50ZXJhY3Rpb24udHMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBCcmV3IGZyb20gXCIuLi9icmV3XCJcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB1c2VJdGVtKGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGJyRXZlbnQ6IEJyZXcuRW51bXMuSUJyZXdFdmVudCkgeyBcclxuICAgIC8vIHRvZG86IHJlcGxhY2UgdGhpcyB3aXRoIGEgcHJvcGVyIHVzZSBldmVudCAoYWxzbyB3aGF0IGlzIHRoZXJlIHRvIHVzZSlcclxuICAgIC8vIGZvciBub3cganVzdCBjb25zdW1lIGFuZCBnaXZlIGhlYWx0aFxyXG5cclxuICAgIGxldCBpdGVtID0gYnJFdmVudC5pdGVtRGF0YS5pdGVtXHJcbiAgICBsZXQgaW52a2V5ID0gYnJFdmVudC5pdGVtRGF0YS5pbnZrZXlcclxuICAgIGxldCBwbGF5ZXIgPSBnbS5nZXRQbGF5ZXIoKVxyXG5cclxuICAgIHBsYXllci5pbnZlbnRvcnkucmVtb3ZlSXRlbUJ5S2V5KGludmtleSlcclxuICAgIHBsYXllci5ocC5pbmNyZW1lbnQoMSlcclxuICAgIGNvbnNvbGUubG9nKFwiKzEgaGVhbHRoXCIpXHJcbiAgICBnbS5lbmRFdmVudChickV2ZW50KVxyXG4gICAgXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBkcm9wSXRlbUF0dGVtcHQoZ206IEJyZXcuR2FtZU1hc3RlciwgZGF0YTogQnJldy5FbnVtcy5JQnJld0V2ZW50KSB7IFxyXG4gICAgbGV0IGRyb3BfeHkgPSBkYXRhLml0ZW1EYXRhLnRvX3h5XHJcblxyXG4gICAgbGV0IGl0ID0gZ20uZ2V0Q3VycmVudExldmVsKCkuaXRlbXMuZ2V0QXQoZHJvcF94eSlcclxuICAgIGlmIChpdCkge1xyXG4gICAgICAgIC8vIGxldCBkcm9wRXJyb3IgOiBCcmV3LkVudW1zLklCcmV3RXZlbnQgPSB7XHJcbiAgICAgICAgLy8gICAgIGV2ZW50VHlwZTogQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLkVycm9yLFxyXG4gICAgICAgIC8vICAgICBhY3RvcjogbnVsbCwgLy8gZ20uZ2V0UGxheWVyKCksXHJcbiAgICAgICAgLy8gICAgIHBsYXllckluaXRpYXRlZDogdHJ1ZSxcclxuICAgICAgICAvLyAgICAgZW5kc1R1cm46IGZhbHNlLFxyXG4gICAgICAgIC8vICAgICBlcnJvck1zZzogXCJzb21ldGhpbmcgaXMgYWxyZWFkeSBoZXJlXCJcclxuICAgICAgICAvLyB9XHJcbiAgICBcclxuICAgICAgICAvLyBkYXRhLmVuZHNUdXJuID0gZmFsc2VcclxuICAgICAgICAvLyBnbS5pbnNlcnRFdmVudChkcm9wRXJyb3IpXHJcbiAgICAgICAgLy8gY29uc29sZS5sb2coXCJzb21ldGhpbmcgYWxyZWFkeSBpcyBoZXJlXCIpXHJcbiAgICAgICAgZ20uZGlzcGxheS5kcmF3UG9wdXBNZXNzYWdlKFwiQWxyZWFkeSBzb21ldGhpbmcgaGVyZVwiLCBnbS5nZXRQbGF5ZXIoKS5sb2NhdGlvbiwgQnJldy5Db2xvci53aGl0ZSlcclxuICAgICAgICBkYXRhLmVuZHNUdXJuID0gZmFsc2VcclxuICAgICAgICBnbS5lbmRFdmVudChkYXRhKVxyXG5cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgbGV0IGludmtleSA9IGRhdGEuaXRlbURhdGEuaW52a2V5XHJcbiAgICAgICAgbGV0IGl0ZW0gPSBkYXRhLml0ZW1EYXRhLml0ZW1cclxuICAgICAgICBcclxuICAgICAgICBnbS5nZXRQbGF5ZXIoKS5pbnZlbnRvcnkucmVtb3ZlSXRlbUJ5S2V5KGludmtleSkgLy8gYWxyZWFkeSBoYXBwZW5zIGluIGxhbmRpbmcgZXZlbnRcclxuICAgICAgICBnbS5nZXRDdXJyZW50TGV2ZWwoKS5pdGVtcy5zZXRBdChkcm9wX3h5LCBpdGVtKVxyXG4gICAgICAgIGdtLmRpc3BsYXlBdChkcm9wX3h5KVxyXG4gICAgICAgIGdtLmVuZEV2ZW50KGRhdGEpXHJcblxyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcGlja3VwKGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGRhdGE6IEJyZXcuRW51bXMuSUJyZXdFdmVudCkge1xyXG4gICAgXHJcbiAgICAvLyByZW1vdmUgaXQgZnJvbSB0aGUgZmxvb3JcclxuICAgIGxldCBpdCA6IEJyZXcuR3JpZFRoaW5ncy5JdGVtID0gZGF0YS5pdGVtRGF0YS5pdGVtXHJcbiAgICBnbS5nZXRDdXJyZW50TGV2ZWwoKS5pdGVtcy5yZW1vdmVBdChpdC5sb2NhdGlvbilcclxuICAgIC8vIGNvbnNvbGUubG9nKFwicmVtb3ZlZCBmcm9tIGxldmVsXCIsIGl0LmxvY2F0aW9uKVxyXG4gICAgLy8gSW50ZWwudXBkYXRlTWVtb3J5QXQoZ20sIGdtLmdldFBsYXllcigpLCBpdC5sb2NhdGlvbilcclxuICAgIFxyXG4gICAgLy8gYWRkIHRvIGludmVudG9yeVxyXG4gICAgbGV0IG9rID0gZ20uZ2V0UGxheWVyKCkuaW52ZW50b3J5LmFkZEl0ZW0oaXQpXHJcbiAgICBnbS5kaXNwbGF5LmRyYXdQb3B1cE1lc3NhZ2UoXCJQaWNrZWQgdXAgXCIgKyBCcmV3Lkdsb3NzYXJ5LmdldEl0ZW1OYW1lKGl0KSwgZGF0YS5hY3Rvci5sb2NhdGlvbiwgQnJldy5Db2xvci52aW9sZXQpXHJcblxyXG4gICAgaWYgKCEob2spKSB7XHJcbiAgICAgICAgZ20uZGlzcGxheS5kcmF3UG9wdXBNZXNzYWdlKFwiTm8gbW9yZSByb29tIVwiLCBpdC5sb2NhdGlvbiwgQnJldy5Db2xvci52aW9sZXQpXHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiaW52ZW50b3J5IGZ1bGwgLSB3ZSBzaG91bGRuJ3QgYmUgaGVyZVwiKVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBjb25zb2xlLmxvZyhgUGlja2VkIHVwICR7aXQubmFtZX1gKVxyXG4gICAgZ20uZW5kRXZlbnQoZGF0YSlcclxufSAgIFxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGRvTGFuZGluZ0V2ZW50QWZ0ZXJUaHJvd24oZ206IEJyZXcuR2FtZU1hc3RlciwgYnJFdmVudDogQnJldy5FbnVtcy5JQnJld0V2ZW50KSB7XHJcbiAgICBsZXQgaXRlbSA9IGJyRXZlbnQuaXRlbURhdGEuaXRlbVxyXG4gICAgbGV0IGxldmVsID0gZ20uZ2V0Q3VycmVudExldmVsKClcclxuICAgIFxyXG5cclxuICAgIC8vIGlmIGl0IGV4cGxvZGVzLi4uXHJcbiAgICBpZiAoaXRlbS5pc1R5cGUoQnJldy5EZWZpbml0aW9ucy5JdGVtVHlwZS5HcmVuYWRlKSB8fCBpdGVtLmlzVHlwZShCcmV3LkRlZmluaXRpb25zLkl0ZW1UeXBlLk5hbm90ZWNoKSkge1xyXG5cclxuICAgICAgICAvLyByZW1vdmUgdGhlIGl0ZW0gZnJvbSBpbnZlbnRvcnlcclxuICAgICAgICBnbS5nZXRQbGF5ZXIoKS5pbnZlbnRvcnkucmVtb3ZlSXRlbUJ5S2V5KGJyRXZlbnQuaXRlbURhdGEuaW52a2V5KVxyXG4gICAgXHJcbiAgICAgICAgaWYgKGl0ZW0uaXNUeXBlKEJyZXcuRGVmaW5pdGlvbnMuSXRlbVR5cGUuR3JlbmFkZSkpIHtcclxuICAgICAgICAgICAgdHJpZ2dlckdyZW5hZGUoZ20sIGJyRXZlbnQuaXRlbURhdGEuaXRlbSwgYnJFdmVudC5pdGVtRGF0YS50b194eSlcclxuXHJcbiAgICAgICAgfSBlbHNlIGlmIChpdGVtLmlzVHlwZShCcmV3LkRlZmluaXRpb25zLkl0ZW1UeXBlLk5hbm90ZWNoKSkge1xyXG4gICAgICAgICAgICB0cmlnZ2VyTmFub0NvcmUoZ20sIGJyRXZlbnQuaXRlbURhdGEuaXRlbSwgYnJFdmVudC5pdGVtRGF0YS50b194eSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGdtLmVuZEV2ZW50KGJyRXZlbnQpXHJcblxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBkcm9wSXRlbUF0dGVtcHQoZ20sIGJyRXZlbnQpXHJcbiAgICAgICAgcmV0dXJuXHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBkb0xhbmRpbmdFdmVudEFmdGVySGVhdmUoZ206IEJyZXcuR2FtZU1hc3RlciwgYnJFdmVudDogQnJldy5FbnVtcy5JQnJld0V2ZW50KSB7XHJcbiAgICBsZXQgaXRlbSA9IGJyRXZlbnQuaXRlbURhdGEuaXRlbVxyXG4gICAgbGV0IGxldmVsID0gZ20uZ2V0Q3VycmVudExldmVsKClcclxuICAgIFxyXG4gICAgLy8gY2xlYXIgaXRlbSBmcm9tIHRoZSBvcmlnaW5hbCBsb2NhdGlvblxyXG4gICAgbGV2ZWwuaXRlbXMucmVtb3ZlQXQoYnJFdmVudC5pdGVtRGF0YS5pdGVtLmxvY2F0aW9uKVxyXG5cclxuICAgIC8vIGNoZWNrIGZvciB0YXJnZXRcclxuICAgIGxldCBtb2JfYXQgPSBsZXZlbC5tb25zdGVycy5nZXRBdChickV2ZW50Lml0ZW1EYXRhLnRvX3h5KVxyXG4gICAgaWYgKG1vYl9hdCkge1xyXG4gICAgICAgIGxldCBoaXRVcHNpZGVZb0hlYWRFdmVudCA6IEJyZXcuRW51bXMuSUJyZXdFdmVudCA9IHtcclxuICAgICAgICAgICAgZXZlbnRUeXBlOiBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuQXR0YWNrLFxyXG4gICAgICAgICAgICBhY3RvcjogYnJFdmVudC5hY3RvcixcclxuICAgICAgICAgICAgcGxheWVySW5pdGlhdGVkOiB0cnVlLFxyXG4gICAgICAgICAgICBlbmRzVHVybjogZmFsc2UsXHJcbiAgICAgICAgICAgIGF0dGFja0RhdGE6IHtcclxuICAgICAgICAgICAgICAgIGZyb21feHk6IGJyRXZlbnQuaXRlbURhdGEuaXRlbS5sb2NhdGlvbixcclxuICAgICAgICAgICAgICAgIHRvX3h5OiBickV2ZW50Lml0ZW1EYXRhLnRvX3h5LFxyXG4gICAgICAgICAgICAgICAgaXNNZWxlZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGRhbWFnZTogMSxcclxuICAgICAgICAgICAgICAgIHRhcmdldDogbW9iX2F0LFxyXG4gICAgICAgICAgICAgICAgLy8gZG9udEFuaW1hdGU6IHRydWUsXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZ20uaW5zZXJ0RXZlbnQoaGl0VXBzaWRlWW9IZWFkRXZlbnQpXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vIGl0ZW0gcmVtb3ZlZCBzbyBubyBuZWVkIHRvIGRvIGFueXRoaW5nIGV4dHJhLi4gZG9udCB0aGluayB3ZSB3YW50IGhlYXZpbmcgbXVsdGlwbGUgdGltZXNcclxuICAgIH1cclxuICAgIGdtLmVuZEV2ZW50KGJyRXZlbnQpXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB0cmlnZ2VyTmFub0NvcmUoZ206IEJyZXcuR2FtZU1hc3RlciwgbmFub19pdGVtOiBCcmV3LkdyaWRUaGluZ3MuSXRlbSwgdGFyZ2V0X3h5OiBCcmV3LkNvb3JkaW5hdGUpIHtcclxuICAgIGxldCBsZXZlbCA9IGdtLmdldEN1cnJlbnRMZXZlbCgpXHJcbiAgICBsZXQgdGVycmFpbl9hdCA6IEJyZXcuR3JpZFRoaW5ncy5UZXJyYWluXHJcbiAgICBsZXQgZmVhdHVyZV9hdCA6IEJyZXcuR3JpZFRoaW5ncy5GZWF0dXJlXHJcblxyXG4gICAgLy8gZmVhdHVyZSBtYXBcclxuICAgIGxldCBmZWF0dXJlX3R5cGUgOiBCcmV3LkRlZmluaXRpb25zLkZlYXR1cmVUeXBlXHJcblxyXG4gICAgaWYgKG5hbm9faXRlbS5zdWJ0eXBlID09IEJyZXcuRGVmaW5pdGlvbnMuSXRlbVN1YnR5cGUuTl9IZWFsdGgpIHtcclxuICAgICAgICBmZWF0dXJlX3R5cGUgPSBCcmV3LkRlZmluaXRpb25zLkZlYXR1cmVUeXBlLlJlcGFpckdvb1xyXG4gICAgfSBlbHNlIGlmIChuYW5vX2l0ZW0uc3VidHlwZSA9PSBCcmV3LkRlZmluaXRpb25zLkl0ZW1TdWJ0eXBlLk5fQWNpZCkge1xyXG4gICAgICAgIGZlYXR1cmVfdHlwZSA9IEJyZXcuRGVmaW5pdGlvbnMuRmVhdHVyZVR5cGUuQ29ycm9zaXZlQWNpZFxyXG4gICAgfSBlbHNlIGlmIChuYW5vX2l0ZW0uc3VidHlwZSA9PSBCcmV3LkRlZmluaXRpb25zLkl0ZW1TdWJ0eXBlLk5fQXJtb3IpIHtcclxuICAgICAgICBmZWF0dXJlX3R5cGUgPSBCcmV3LkRlZmluaXRpb25zLkZlYXR1cmVUeXBlLlByb3RlY3RpdmVHb29cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcInVua25vd24gbmFubyBnb29cIilcclxuICAgIH1cclxuXHJcbiAgICBsZXQgbWF4X3RpbGVzID0gNVxyXG4gICAgbGV0IG51bV90aWxlcyA9IDFcclxuICAgIGxldCBhZmZlY3RlZF9hcmVhID0gW3RhcmdldF94eV1cclxuICAgIGxldCBvZmZzZXRfbGlzdCA9IFtCcmV3LkRpcmVjdGlvbnMuVVAuY2xvbmUoKSwgQnJldy5EaXJlY3Rpb25zLkRPV04uY2xvbmUoKSwgQnJldy5EaXJlY3Rpb25zLkxFRlQuY2xvbmUoKSwgQnJldy5EaXJlY3Rpb25zLlJJR0hULmNsb25lKCldXHJcbiAgICBsZXQgYXZvaWRfaW5kaWNlcyA6IG51bWJlcltdID0gW11cclxuXHJcbiAgICBsZXQgb2Zmc2V0X2kgOiBudW1iZXJcclxuICAgIGxldCBkaXN0ID0gMVxyXG4gICAgbGV0IHh5IDogQnJldy5Db29yZGluYXRlXHJcblxyXG4gICAgd2hpbGUgKG51bV90aWxlcyA8IG1heF90aWxlcykge1xyXG5cclxuICAgICAgICBmb3IgKG9mZnNldF9pID0gMDsgb2Zmc2V0X2kgPCBvZmZzZXRfbGlzdC5sZW5ndGg7IG9mZnNldF9pKyspIHtcclxuICAgICAgICAgICAgaWYgKGF2b2lkX2luZGljZXMuaW5kZXhPZihvZmZzZXRfaSkgPiAtMSkge1xyXG4gICAgICAgICAgICAgICAgLy8gZG9uJ3QgZ3JvdyBpbiB0aGlzIGRpcmVjdGlvblxyXG4gICAgICAgICAgICAgICAgY29udGludWVcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgeHkgPSB0YXJnZXRfeHkuYWRkKG9mZnNldF9saXN0W29mZnNldF9pXS5tdWx0aXBseVNjYWxhcihkaXN0KSlcclxuXHJcbiAgICAgICAgICAgIGlmICghKGxldmVsLmlzVmFsaWQoeHkpKSkge1xyXG4gICAgICAgICAgICAgICAgY29udGludWVcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGVycmFpbl9hdCA9IGxldmVsLnRlcnJhaW4uZ2V0QXQoeHkpXHJcbiAgICAgICAgICAgIGlmICh0ZXJyYWluX2F0LmJsb2Nrc193YWxraW5nKSB7XHJcbiAgICAgICAgICAgICAgICBhdm9pZF9pbmRpY2VzLnB1c2gob2Zmc2V0X2kpXHJcbiAgICAgICAgICAgICAgICBjb250aW51ZVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmZWF0dXJlX2F0ID0gbGV2ZWwuZmVhdHVyZXMuZ2V0QXQoeHkpXHJcbiAgICAgICAgICAgIGlmIChmZWF0dXJlX2F0ICYmIGZlYXR1cmVfYXQuZ2V0RGVmaW5pdGlvbigpID09IGZlYXR1cmVfdHlwZSkge1xyXG4gICAgICAgICAgICAgICAgYXZvaWRfaW5kaWNlcy5wdXNoKG9mZnNldF9pKVxyXG4gICAgICAgICAgICAgICAgY29udGludWVcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgYWZmZWN0ZWRfYXJlYS5wdXNoKHh5KVxyXG4gICAgICAgICAgICBudW1fdGlsZXMgKz0gMVxyXG5cclxuICAgICAgICAgICAgaWYgKG51bV90aWxlcyA9PSBtYXhfdGlsZXMpIHtcclxuICAgICAgICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGRpc3QgKz0gMVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBhZmZlY3RlZF9hcmVhLmZvckVhY2goKHh5OiBCcmV3LkNvb3JkaW5hdGUsIGluZGV4OiBudW1iZXIpID0+IHtcclxuICAgICAgICBmZWF0dXJlX2F0ID0gbGV2ZWwuZmVhdHVyZXMuZ2V0QXQoeHkpXHJcbiAgICAgICAgaWYgKGZlYXR1cmVfYXQpIHtcclxuICAgICAgICAgICAgbGV2ZWwuZmVhdHVyZXMucmVtb3ZlQXQoeHkpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXZlbC5mZWF0dXJlcy5zZXRBdCh4eSwgQnJldy5EZWZpbml0aW9ucy5mZWF0dXJlRmFjdG9yeShmZWF0dXJlX3R5cGUpKVxyXG4gICAgfSlcclxuICAgIGdtLmRpc3BsYXlMaXN0KGFmZmVjdGVkX2FyZWEpXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB0cmlnZ2VyR3JlbmFkZShnbTogQnJldy5HYW1lTWFzdGVyLCBncmVuYWRlX2l0ZW06IEJyZXcuR3JpZFRoaW5ncy5JdGVtLCB0YXJnZXRfeHk6IEJyZXcuQ29vcmRpbmF0ZSkge1xyXG4gICAgXHJcbiAgICAvLyBmb3IgY29uY3Vzc2lvbiBncmVuYWRlcyB1c2UgZXhpc3Rpbmcga25vY2tiYWNrIGV2ZW50IGNhbGxlclxyXG4gICAgaWYgKGdyZW5hZGVfaXRlbS5zdWJ0eXBlID09IEJyZXcuRGVmaW5pdGlvbnMuSXRlbVN1YnR5cGUuR19Db25jdXNpdmUpIHtcclxuICAgICAgICBCcmV3LkNvbWJhdC50cmlnZ2VyS25vY2tiYWNrQmxhc3QoZ20sIHRhcmdldF94eSwgQnJldy5Db25maWcuZ3JlbmFkZV9yYWRpdXMpXHJcbiAgICAgICAgcmV0dXJuIFxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBvdGhlcndpc2UgZ28gdGhyb3VnaCBhbmQgYXBwbHkgZGFtYWdlIC8gZWZmZWN0c1xyXG4gICAgbGV0IGxldmVsID0gZ20uZ2V0Q3VycmVudExldmVsKClcclxuICAgIGxldCBwbGF5ZXIgPSBnbS5nZXRQbGF5ZXIoKVxyXG4gICAgbGV0IGJsYXN0X3JhZGl1cyA9IEJyZXcuQ29uZmlnLmdyZW5hZGVfcmFkaXVzXHJcblxyXG4gICAgLy8gbGV0IGFmZmVjdGVkX21vYnMgPSBVdGlscy5nZXRNb25zdGVyc1dpdGhpblJhZGl1cyhsZXZlbCwgdGFyZ2V0X3h5LCBCcmV3LkNvbmZpZy5ncmVuYWRlX3JhZGl1cylcclxuICAgIGxldCBhcmVhID0gQnJldy5VdGlscy5nZXRCbGFzdEFyZWEobGV2ZWwsIHRhcmdldF94eSwgYmxhc3RfcmFkaXVzKVxyXG4gICAgbGV0IGFmZmVjdGVkX21vYnMgPSBCcmV3LlV0aWxzLmdldE1vbnN0ZXJzV2l0aGluQ29vcmRpbmF0ZUFyZWEobGV2ZWwsIGFyZWEpXHJcbiAgICBsZXQgYWZmZWN0ZWRfYXJlYSA9IGFmZmVjdGVkX21vYnMubWFwKChtb2IpID0+IHsgcmV0dXJuIG1vYi5sb2NhdGlvbiB9KVxyXG5cclxuICAgIGxldCBkYW1hZ2U6IG51bWJlclxyXG4gICAgbGV0IGVmZmVjdF9mbGFnczogQXJyYXk8QnJldy5FbnVtcy5GbGFnPlxyXG4gICAgbGV0IGJsYXN0X2NvbG9yIDogQnJldy5Db2xvci5JQ29sb3JcclxuXHJcbiAgICBpZiAoZ3JlbmFkZV9pdGVtLnN1YnR5cGUgPT0gQnJldy5EZWZpbml0aW9ucy5JdGVtU3VidHlwZS5HX0V4cGxvc2l2ZSkge1xyXG4gICAgICAgIGRhbWFnZSA9IGdyZW5hZGVfaXRlbS5kYW1hZ2VcclxuICAgICAgICBlZmZlY3RfZmxhZ3MgPSBbXVxyXG4gICAgICAgIGJsYXN0X2NvbG9yID0gQnJldy5Db2xvci5jb2xvcl9leHBsb3Npb25cclxuXHJcbiAgICB9IGVsc2UgaWYgKGdyZW5hZGVfaXRlbS5zdWJ0eXBlID09IEJyZXcuRGVmaW5pdGlvbnMuSXRlbVN1YnR5cGUuR19TdHVuKSB7XHJcbiAgICAgICAgZGFtYWdlID0gMFxyXG4gICAgICAgIGVmZmVjdF9mbGFncyA9IFtCcmV3LkVudW1zLkZsYWcuQ2F1c2VzU3R1bl1cclxuICAgICAgICBibGFzdF9jb2xvciA9IEJyZXcuQ29sb3IuY29sb3Jfc3R1blxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYHVua25vd24gZ3JlbmFkZSB0eXBlICR7Z3JlbmFkZV9pdGVtLnN1YnR5cGV9YClcclxuICAgIH1cclxuXHJcbiAgICBsZXQgbWFzc0V2ZW50IDogQnJldy5FbnVtcy5JQnJld0V2ZW50ID0ge1xyXG4gICAgICAgIGV2ZW50VHlwZTogQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLk1hc3NEYW1hZ2UsXHJcbiAgICAgICAgYWN0b3I6IGdtLmdldFBsYXllcigpLFxyXG4gICAgICAgIHBsYXllckluaXRpYXRlZDogdHJ1ZSxcclxuICAgICAgICBlbmRzVHVybjogZmFsc2UsXHJcbiAgICAgICAgYXR0YWNrRGF0YToge1xyXG4gICAgICAgICAgICBmcm9tX3h5OiBwbGF5ZXIubG9jYXRpb24sXHJcbiAgICAgICAgICAgIHRvX3h5OiB0YXJnZXRfeHksXHJcbiAgICAgICAgICAgIGlzTWVsZWU6IGZhbHNlLFxyXG4gICAgICAgICAgICB0YXJnZXQ6IG51bGwsXHJcbiAgICAgICAgICAgIGRhbWFnZTogZGFtYWdlLFxyXG4gICAgICAgICAgICBlZmZlY3RzOiBlZmZlY3RfZmxhZ3MsXHJcbiAgICAgICAgfSxcclxuICAgICAgICBwYXRoc0RhdGE6IHtcclxuICAgICAgICAgICAgZnJvbV94eTogbnVsbCxcclxuICAgICAgICAgICAgdG9feHk6IG51bGwsXHJcbiAgICAgICAgICAgIHBhdGg6IGFmZmVjdGVkX2FyZWEsXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZ20uaW5zZXJ0RXZlbnQoe1xyXG4gICAgICAgIGV2ZW50VHlwZTogQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLlJ1bkFuaW1hdGlvbixcclxuICAgICAgICBhY3RvcjogZ20uZ2V0UGxheWVyKCksXHJcbiAgICAgICAgcGxheWVySW5pdGlhdGVkOiBmYWxzZSxcclxuICAgICAgICBlbmRzVHVybjogZmFsc2UsXHJcbiAgICAgICAgYW5pbWF0aW9uRGF0YToge1xyXG4gICAgICAgICAgICBhbmltYXRpb25UeXBlOiBCcmV3LkVudW1zLkJyZXdBbmltYXRpb25UeXBlLkNpcmNsZU91dCxcclxuICAgICAgICAgICAgY29sb3I6IEJyZXcuQ29sb3IuY29sb3JfZm9yY2UsXHJcbiAgICAgICAgICAgIGZyb21feHk6IHRhcmdldF94eSxcclxuICAgICAgICAgICAgdG9feHk6IHRhcmdldF94eSxcclxuICAgICAgICAgICAgcmFuZ2U6IGJsYXN0X3JhZGl1c1xyXG4gICAgICAgIH1cclxuICAgIH0pICAgIFxyXG4gICAgZ20uaW5zZXJ0RXZlbnQobWFzc0V2ZW50KVxyXG59XHJcblxyXG4vLyBleHBvcnQgZnVuY3Rpb24gc2V0SXRlbUF0TG9jYXRpb24obGV2ZWw6IExldmVsLCBpdGVtOiBCcmV3LkdyaWRUaGluZ3MuSXRlbSwgdGFyZ2V0X3h5OiBCcmV3LkNvb3JkaW5hdGUpIHtcclxuLy8gICAgIGxldCBleGlzdGluZ19pdGVtID0gbGV2ZWwuaXRlbXMuZ2V0QXQodGFyZ2V0X3h5KVxyXG5cclxuLy8gICAgIGlmIChleGlzdGluZ19pdGVtKSB7XHJcbi8vICAgICAgICAgcHVzaEV4aXN0aW5nSXRlbUF3YXlUb1NhZmVTcG90KGxldmVsLCBleGlzdGluZ19pdGVtKVxyXG4vLyAgICAgfVxyXG4vLyAgICAgbGV2ZWwuaXRlbXMuc2V0QXQodGFyZ2V0X3h5LCBpdGVtKVxyXG4vLyB9XHJcblxyXG4vLyBleHBvcnQgZnVuY3Rpb24gcHVzaEV4aXN0aW5nSXRlbUF3YXlUb1NhZmVTcG90KGxldmVsOiBMZXZlbCwgaXRlbV9hdDogQnJldy5HcmlkVGhpbmdzLkl0ZW0pIHtcclxuLy8gICAgIGxldCBpdGVtX3h5ID0gaXRlbV9hdC5sb2NhdGlvbi5jbG9uZSgpXHJcbi8vICAgICBsZXQgbmVhcl94eSA9IGxldmVsLmdldFNhZmVMb2NhdGlvbk5lYXIoaXRlbV94eSwgdHJ1ZSlcclxuLy8gICAgIGxldmVsLml0ZW1zLnJlbW92ZUF0KGl0ZW1feHkpXHJcbi8vICAgICBsZXZlbC5pdGVtcy5zZXRBdChuZWFyX3h5LCBpdGVtX2F0KVxyXG4vLyB9XHJcbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/brew_game/item_interaction.ts\n");

/***/ }),

/***/ "./src/brew_game/levelgen.ts":
/*!***********************************!*\
  !*** ./src/brew_game/levelgen.ts ***!
  \***********************************/
/*! exports provided: buildLevel, buildAndAttachNewLevel */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"buildLevel\", function() { return buildLevel; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"buildAndAttachNewLevel\", function() { return buildAndAttachNewLevel; });\n/* harmony import */ var rot_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! rot-js */ \"./node_modules/rot-js/lib/rot.js\");\n/* harmony import */ var rot_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(rot_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _brew__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../brew */ \"./src/brew.ts\");\n\r\n\r\nfunction buildLevel(gm, depth, lastLevel) {\r\n    let success;\r\n    let my_level = new _brew__WEBPACK_IMPORTED_MODULE_1__[\"Level\"](_brew__WEBPACK_IMPORTED_MODULE_1__[\"Config\"].map_width_tiles, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Config\"].map_height_tiles, depth);\r\n    // todo: make this an array and use some/all to make sure its a good level\r\n    success = false;\r\n    let num_tries = 0;\r\n    while (!(success)) {\r\n        num_tries += 1;\r\n        success = setupTerrain_Simple(my_level, lastLevel);\r\n    }\r\n    console.log(`depth ${depth}: ${num_tries} tries`);\r\n    my_level.updateNavigation();\r\n    addTerrainSpice(my_level);\r\n    my_level.updateNavigation();\r\n    success = setupExitLocations(my_level, lastLevel);\r\n    success = setupPortals(gm, my_level);\r\n    success = setupItems(my_level, lastLevel);\r\n    success = setupMonsters(gm, my_level, lastLevel);\r\n    my_level.isConstructed = true;\r\n    return my_level;\r\n}\r\nfunction buildAndAttachNewLevel(gm, currentLevel, portal) {\r\n    let next_level = buildLevel(gm, currentLevel.depth + 1, false);\r\n    gm.addLevel(next_level);\r\n    portal.attachDestination(next_level.id, next_level.simple_start_xy);\r\n}\r\nfunction setupPortals(gm, lair) {\r\n    let portal_forward;\r\n    portal_forward = new _brew__WEBPACK_IMPORTED_MODULE_1__[\"Portal\"](lair.id, lair.simple_exit_xy);\r\n    // portal_forward.attachDestination(listLevels[i+1].id, listLevels[i+1].simple_start_xy)\r\n    lair.portals.setAt(lair.simple_exit_xy, portal_forward);\r\n    return true;\r\n}\r\nfunction setupTerrain_Simple(lair, lastLevel) {\r\n    let terrain;\r\n    let easyMap = (x, y, what) => {\r\n        let xy = new _brew__WEBPACK_IMPORTED_MODULE_1__[\"Coordinate\"](x, y);\r\n        // walls override\r\n        // if ((x == 0) || (y == 0) || (x == lair.width - 1) || (y == lair.height - 1)) {\r\n        //     terrain = Brew.Definitions.terrainFactory(Brew.Definitions.TerrainType.Wall)\r\n        // } else {\r\n        if (what == 1) {\r\n            terrain = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Definitions\"].terrainFactory(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Definitions\"].TerrainType.Rock);\r\n        }\r\n        else if (what == 0) {\r\n            terrain = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Definitions\"].terrainFactory(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Definitions\"].TerrainType.Sand);\r\n        }\r\n        else {\r\n            throw new RangeError(`Unexpected levelgen return value ${what}`);\r\n        }\r\n        // }\r\n        lair.terrain.setAt(xy, terrain);\r\n    };\r\n    // let rotMap = new ROT.Map.Arena(lair.width, lair.height)\r\n    let rotMap = new rot_js__WEBPACK_IMPORTED_MODULE_0__[\"Map\"].Cellular(lair.width, lair.height, { connected: true });\r\n    rotMap.randomize(0.4);\r\n    rotMap.create(easyMap);\r\n    // rotMap.create(easyMap)\r\n    // rotMap.create(easyMap)\r\n    // make terrain interesting\r\n    let noise = new rot_js__WEBPACK_IMPORTED_MODULE_0__[\"Noise\"].Simplex(10);\r\n    let terrain_at;\r\n    for (let x = 1; x < (lair.width - 1); x++) {\r\n        for (let y = 1; y < (lair.height - 1); y++) {\r\n            let xy = new _brew__WEBPACK_IMPORTED_MODULE_1__[\"Coordinate\"](x, y);\r\n            let p = noise.get(x / 10, y / 10);\r\n            if ((p > .5) && (!(lastLevel))) {\r\n                terrain_at = lair.terrain.getAt(xy);\r\n                if (terrain_at.isType(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Definitions\"].TerrainType.Sand)) {\r\n                    lair.terrain.removeAt(xy);\r\n                    lair.terrain.setAt(xy, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Definitions\"].terrainFactory(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Definitions\"].TerrainType.Grass));\r\n                }\r\n            }\r\n            if (p < -0.5) {\r\n                terrain_at = lair.terrain.getAt(xy);\r\n                if (terrain_at.isType(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Definitions\"].TerrainType.Sand)) {\r\n                    lair.terrain.removeAt(xy);\r\n                    lair.terrain.setAt(xy, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Definitions\"].terrainFactory(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Definitions\"].TerrainType.Rubble));\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return true;\r\n}\r\nfunction setupExitLocations(lair, lastLevel) {\r\n    // get all available floor spots\r\n    let floors = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Utils\"].randomize(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Utils\"].clone(lair.navigation_tiles[_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].LevelNavigationType.Walk]), true);\r\n    // unless otherwise specified, pick a random start location\r\n    // todo: ensure minimum distance between start and end\r\n    let start_xy = floors[0];\r\n    let exit_xy = floors[1];\r\n    let min_distance = Math.max(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Config\"].map_height_tiles, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Config\"].map_width_tiles) / 2;\r\n    while (_brew__WEBPACK_IMPORTED_MODULE_1__[\"Utils\"].dist2d(start_xy, exit_xy) < min_distance) {\r\n        exit_xy = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Utils\"].randomOf(floors, true);\r\n    }\r\n    // console.log(\"start\", start_xy)\r\n    // console.log(\"exit\", exit_xy)\r\n    lair.simple_start_xy = start_xy;\r\n    lair.simple_exit_xy = exit_xy;\r\n    // let start_xy = lair.simple_start_xy\r\n    // let exit_xy = lair.simple_exit_xy\r\n    // let entrance_stairs = Brew.Definitions.terrainFactory(Brew.Definitions.TerrainType.UpStairs)\r\n    // lair.terrain.removeAt(start_xy)\r\n    // lair.terrain.setAt(start_xy, entrance_stairs)\r\n    // if (lair.depth == 1) {\r\n    //     entrance_stairs.code = Brew.Symbols.double_angle_bracket_left\r\n    // }\r\n    // if (lair.depth < Brew.Config.max_depth) {\r\n    if (!(lastLevel)) {\r\n        lair.terrain.removeAt(exit_xy);\r\n        lair.terrain.setAt(exit_xy, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Definitions\"].terrainFactory(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Definitions\"].TerrainType.LevelCheckPoint));\r\n    }\r\n    // todo: eventually this will be fail-able\r\n    return true;\r\n}\r\nfunction setupItems(lair, lastLevel) {\r\n    // some items\r\n    let it;\r\n    let num_civilians = 5;\r\n    let num_supplies = 5;\r\n    let num_bullets = 5;\r\n    let num_shells = 5;\r\n    for (let i = 0; i < num_civilians; i++) {\r\n        it = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Definitions\"].itemFactory(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Definitions\"].ItemType.Civilian);\r\n        lair.items.setAt(lair.getSafeLocation(), it);\r\n    }\r\n    for (let i = 0; i < num_supplies; i++) {\r\n        it = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Definitions\"].itemFactory(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Definitions\"].ItemType.Supplies);\r\n        lair.items.setAt(lair.getSafeLocation(), it);\r\n    }\r\n    for (let i = 0; i < num_shells; i++) {\r\n        it = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Definitions\"].itemFactory(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Definitions\"].ItemType.Shells);\r\n        lair.items.setAt(lair.getSafeLocation(), it);\r\n    }\r\n    for (let i = 0; i < num_bullets; i++) {\r\n        it = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Definitions\"].itemFactory(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Definitions\"].ItemType.Bullets);\r\n        lair.items.setAt(lair.getSafeLocation(), it);\r\n    }\r\n    return true;\r\n}\r\nfunction setupMonsters(gm, lair, lastLevel) {\r\n    let weightedMonsters = {\r\n        \"Mercenary\": 5,\r\n        \"Soldier\": 5,\r\n    };\r\n    if (lair.depth > 5) {\r\n        weightedMonsters[\"Grenadier\"] = Math.min(5, (lair.depth - 5));\r\n    }\r\n    let num_monsters = 10 + (lair.depth * 2);\r\n    for (let i = 0; i < num_monsters; i++) {\r\n        // let mdef : Brew.Definitions.MonsterType\r\n        // if (ROT.RNG.getUniform() < 0.7) {\r\n        //     mdef = Brew.Definitions.MonsterType.Killbot\r\n        // } else {\r\n        //     mdef = Brew.Definitions.MonsterType.Guardguy\r\n        // }\r\n        let mdef = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Definitions\"].MonsterType[rot_js__WEBPACK_IMPORTED_MODULE_0__[\"RNG\"].getWeightedValue(weightedMonsters)];\r\n        // let mob = Brew.Definitions.monsterFactory(gm, Brew.Definitions.MonsterType.Killbot, {monster_status: Brew.GridThings.MonsterStatus.Wander })\r\n        let mob = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Definitions\"].monsterFactory(gm, mdef, { monster_status: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].MonsterStatus.Wander });\r\n        // mob.code = i.toString()\r\n        mob.name = \"Monster \" + i.toString();\r\n        // mob.code = i.toString()\r\n        // mob.monster_status = Brew.GridThings.MonsterStatus.Wander\r\n        // todo: ensure monsters dont start too near the starting location\r\n        let xy = lair.getSafeLocation();\r\n        // let xy : Brew.Coordinate = Brew.randomOf(level.floors)\r\n        lair.monsters.setAt(xy, mob);\r\n        // gm.scheduler.add(mob, true)\r\n    }\r\n    return true;\r\n}\r\nfunction addTerrainSpice(level) {\r\n    let floors = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Utils\"].randomize(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Utils\"].clone(level.navigation_tiles[_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].LevelNavigationType.Walk]), true);\r\n    let num_buildings = rot_js__WEBPACK_IMPORTED_MODULE_0__[\"RNG\"].getUniformInt(0, 3);\r\n    let building_tiles = new _brew__WEBPACK_IMPORTED_MODULE_1__[\"CoordinateArea\"]();\r\n    for (let i = 0; i < num_buildings; i++) {\r\n        let size = Math.max(3, Math.floor(rot_js__WEBPACK_IMPORTED_MODULE_0__[\"RNG\"].getNormal(10, 1)));\r\n        let center_xy = floors[i];\r\n        let structure;\r\n        if (rot_js__WEBPACK_IMPORTED_MODULE_0__[\"RNG\"].getUniform() < 0.5) {\r\n            structure = new _brew__WEBPACK_IMPORTED_MODULE_1__[\"Rooms\"].OvalRoom(new _brew__WEBPACK_IMPORTED_MODULE_1__[\"Rooms\"].Rectangle(center_xy.x, center_xy.y, size, size));\r\n        }\r\n        else {\r\n            structure = new _brew__WEBPACK_IMPORTED_MODULE_1__[\"Rooms\"].RectangleRoom(new _brew__WEBPACK_IMPORTED_MODULE_1__[\"Rooms\"].Rectangle(center_xy.x, center_xy.y, size, size));\r\n        }\r\n        for (let xy of structure.getWalls()) {\r\n            if (building_tiles.hasCoordinate(xy)) {\r\n                continue;\r\n            }\r\n            if (rot_js__WEBPACK_IMPORTED_MODULE_0__[\"RNG\"].getUniform() > 0.25) {\r\n                if (level.isValid_PointsOnly(xy)) {\r\n                    level.terrain.removeAt(xy);\r\n                    level.terrain.setAt(xy, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Definitions\"].terrainFactory(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Definitions\"].TerrainType.Broken_Wall));\r\n                }\r\n            }\r\n            building_tiles.addCoordinate(xy);\r\n        }\r\n        for (let xy of structure.getFloors()) {\r\n            // if (building_tiles.hasCoordinate)\r\n            if (level.isValid_PointsOnly(xy)) {\r\n                level.terrain.removeAt(xy);\r\n                level.terrain.setAt(xy, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Definitions\"].terrainFactory(_brew__WEBPACK_IMPORTED_MODULE_1__[\"Definitions\"].TerrainType.Rubble));\r\n            }\r\n            // building_tiles.addCoordinate(xy)\r\n        }\r\n    }\r\n}\r\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvYnJld19nYW1lL2xldmVsZ2VuLnRzP2M5NjUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQTZCO0FBQ0U7QUFHekIsb0JBQXFCLEVBQW1CLEVBQUUsS0FBYSxFQUFFLFNBQWtCO0lBQzdFLElBQUksT0FBaUI7SUFFckIsSUFBSSxRQUFRLEdBQUcsSUFBSSwyQ0FBVSxDQUFDLDRDQUFXLENBQUMsZUFBZSxFQUFFLDRDQUFXLENBQUMsZ0JBQWdCLEVBQUUsS0FBSyxDQUFDO0lBRS9GLDBFQUEwRTtJQUMxRSxPQUFPLEdBQUcsS0FBSztJQUNmLElBQUksU0FBUyxHQUFHLENBQUM7SUFDakIsT0FBTyxDQUFDLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQztRQUNoQixTQUFTLElBQUksQ0FBQztRQUNkLE9BQU8sR0FBRyxtQkFBbUIsQ0FBQyxRQUFRLEVBQUUsU0FBUyxDQUFDO0lBQ3RELENBQUM7SUFDRCxPQUFPLENBQUMsR0FBRyxDQUFDLFNBQVMsS0FBSyxLQUFLLFNBQVMsUUFBUSxDQUFDO0lBRWpELFFBQVEsQ0FBQyxnQkFBZ0IsRUFBRTtJQUMzQixlQUFlLENBQUMsUUFBUSxDQUFDO0lBQ3pCLFFBQVEsQ0FBQyxnQkFBZ0IsRUFBRTtJQUUzQixPQUFPLEdBQUcsa0JBQWtCLENBQUMsUUFBUSxFQUFFLFNBQVMsQ0FBQztJQUNqRCxPQUFPLEdBQUcsWUFBWSxDQUFDLEVBQUUsRUFBRSxRQUFRLENBQUM7SUFDcEMsT0FBTyxHQUFHLFVBQVUsQ0FBQyxRQUFRLEVBQUUsU0FBUyxDQUFDO0lBQ3pDLE9BQU8sR0FBRyxhQUFhLENBQUMsRUFBRSxFQUFFLFFBQVEsRUFBRSxTQUFTLENBQUM7SUFHaEQsUUFBUSxDQUFDLGFBQWEsR0FBRyxJQUFJO0lBQzdCLE1BQU0sQ0FBQyxRQUFRO0FBQ25CLENBQUM7QUFFSyxnQ0FBaUMsRUFBbUIsRUFBRSxZQUF3QixFQUFFLE1BQW1CO0lBQ3JHLElBQUksVUFBVSxHQUFHLFVBQVUsQ0FBQyxFQUFFLEVBQUUsWUFBWSxDQUFDLEtBQUssR0FBRyxDQUFDLEVBQUUsS0FBSyxDQUFDO0lBQzlELEVBQUUsQ0FBQyxRQUFRLENBQUMsVUFBVSxDQUFDO0lBQ3ZCLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxVQUFVLENBQUMsRUFBRSxFQUFFLFVBQVUsQ0FBQyxlQUFlLENBQUM7QUFDdkUsQ0FBQztBQUVELHNCQUFzQixFQUFtQixFQUFFLElBQWdCO0lBQ3ZELElBQUksY0FBNEI7SUFDaEMsY0FBYyxHQUFHLElBQUksNENBQVcsQ0FBQyxJQUFJLENBQUMsRUFBRSxFQUFFLElBQUksQ0FBQyxjQUFjLENBQUM7SUFDOUQsd0ZBQXdGO0lBQ3hGLElBQUksQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxjQUFjLEVBQUUsY0FBYyxDQUFDO0lBQ3ZELE1BQU0sQ0FBQyxJQUFJO0FBQ2YsQ0FBQztBQUVELDZCQUE4QixJQUFpQixFQUFFLFNBQWtCO0lBRS9ELElBQUksT0FBZ0M7SUFFcEMsSUFBSSxPQUFPLEdBQUcsQ0FBQyxDQUFTLEVBQUUsQ0FBUyxFQUFFLElBQVksRUFBRSxFQUFFO1FBQ2pELElBQUksRUFBRSxHQUFvQixJQUFJLGdEQUFlLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUNuRCxpQkFBaUI7UUFDakIsaUZBQWlGO1FBQ2pGLG1GQUFtRjtRQUNuRixXQUFXO1FBQ1AsRUFBRSxDQUFDLENBQUMsSUFBSSxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDWixPQUFPLEdBQUcsaURBQWdCLENBQUMsY0FBYyxDQUFDLGlEQUFnQixDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUM7UUFDaEYsQ0FBQztRQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxJQUFJLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUNuQixPQUFPLEdBQUcsaURBQWdCLENBQUMsY0FBYyxDQUFDLGlEQUFnQixDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUM7UUFDaEYsQ0FBQztRQUFDLElBQUksQ0FBQyxDQUFDO1lBQ0osTUFBTSxJQUFJLFVBQVUsQ0FBQyxvQ0FBb0MsSUFBSSxFQUFFLENBQUM7UUFDcEUsQ0FBQztRQUVMLElBQUk7UUFFSixJQUFJLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxFQUFFLEVBQUUsT0FBTyxDQUFDO0lBQ25DLENBQUM7SUFFRCwwREFBMEQ7SUFDMUQsSUFBSSxNQUFNLEdBQUcsSUFBSSwwQ0FBTyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsS0FBSyxFQUFFLElBQUksQ0FBQyxNQUFNLEVBQUUsRUFBRSxTQUFTLEVBQUUsSUFBSSxFQUFFLENBQUU7SUFFaEYsTUFBTSxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUM7SUFDckIsTUFBTSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUM7SUFDdEIseUJBQXlCO0lBQ3pCLHlCQUF5QjtJQUV6QiwyQkFBMkI7SUFDM0IsSUFBSSxLQUFLLEdBQUcsSUFBSSw0Q0FBUyxDQUFDLE9BQU8sQ0FBQyxFQUFFLENBQUM7SUFDckMsSUFBSSxVQUFvQztJQUN4QyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLEtBQUssR0FBRyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDO1FBQ3hDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUM7WUFDekMsSUFBSSxFQUFFLEdBQUcsSUFBSSxnREFBZSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUM7WUFFbEMsSUFBSSxDQUFDLEdBQUcsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUMsRUFBRSxFQUFFLENBQUMsR0FBQyxFQUFFLENBQUM7WUFFN0IsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsRUFBRSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7Z0JBQzdCLFVBQVUsR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUM7Z0JBQ25DLEVBQUUsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxNQUFNLENBQUMsaURBQWdCLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztvQkFDdkQsSUFBSSxDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUMsRUFBRSxDQUFDO29CQUN6QixJQUFJLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxFQUFFLEVBQUUsaURBQWdCLENBQUMsY0FBYyxDQUFDLGlEQUFnQixDQUFDLFdBQVcsQ0FBQyxLQUFLLENBQUMsQ0FBQztnQkFDL0YsQ0FBQztZQUNMLENBQUM7WUFFRCxFQUFFLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO2dCQUNYLFVBQVUsR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUM7Z0JBQ25DLEVBQUUsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxNQUFNLENBQUMsaURBQWdCLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztvQkFDdkQsSUFBSSxDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUMsRUFBRSxDQUFDO29CQUN6QixJQUFJLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxFQUFFLEVBQUUsaURBQWdCLENBQUMsY0FBYyxDQUFDLGlEQUFnQixDQUFDLFdBQVcsQ0FBQyxNQUFNLENBQUMsQ0FBQztnQkFDaEcsQ0FBQztZQUNMLENBQUM7UUFDTCxDQUFDO0lBQ0wsQ0FBQztJQUVELE1BQU0sQ0FBQyxJQUFJO0FBQ2YsQ0FBQztBQUVELDRCQUE2QixJQUFpQixFQUFFLFNBQWtCO0lBRTlELGdDQUFnQztJQUNoQyxJQUFJLE1BQU0sR0FBNEIsMkNBQVUsQ0FBQyxTQUFTLENBQUMsMkNBQVUsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLDJDQUFVLENBQUMsbUJBQW1CLENBQUMsSUFBSSxDQUFDLENBQUMsRUFBRSxJQUFJLENBQUM7SUFHOUksMkRBQTJEO0lBQzNELHNEQUFzRDtJQUN0RCxJQUFJLFFBQVEsR0FBRyxNQUFNLENBQUMsQ0FBQyxDQUFDO0lBQ3hCLElBQUksT0FBTyxHQUFHLE1BQU0sQ0FBQyxDQUFDLENBQUM7SUFDdkIsSUFBSSxZQUFZLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyw0Q0FBVyxDQUFDLGdCQUFnQixFQUFFLDRDQUFXLENBQUMsZUFBZSxDQUFDLEdBQUcsQ0FBQztJQUMxRixPQUFPLDJDQUFVLENBQUMsTUFBTSxDQUFDLFFBQVEsRUFBRSxPQUFPLENBQUMsR0FBRyxZQUFZLEVBQUUsQ0FBQztRQUN6RCxPQUFPLEdBQUcsMkNBQVUsQ0FBQyxRQUFRLENBQUMsTUFBTSxFQUFFLElBQUksQ0FBQztJQUMvQyxDQUFDO0lBQ0QsaUNBQWlDO0lBQ2pDLCtCQUErQjtJQUUvQixJQUFJLENBQUMsZUFBZSxHQUFHLFFBQVE7SUFDL0IsSUFBSSxDQUFDLGNBQWMsR0FBRyxPQUFPO0lBRTdCLHNDQUFzQztJQUN0QyxvQ0FBb0M7SUFFcEMsK0ZBQStGO0lBQy9GLGtDQUFrQztJQUNsQyxnREFBZ0Q7SUFDaEQseUJBQXlCO0lBQ3pCLG9FQUFvRTtJQUNwRSxJQUFJO0lBRUosNENBQTRDO0lBQzVDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDZixJQUFJLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUM7UUFDOUIsSUFBSSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsT0FBTyxFQUFFLGlEQUFnQixDQUFDLGNBQWMsQ0FBQyxpREFBZ0IsQ0FBQyxXQUFXLENBQUMsZUFBZSxDQUFDLENBQUM7SUFDOUcsQ0FBQztJQUVELDBDQUEwQztJQUMxQyxNQUFNLENBQUMsSUFBSTtBQUNmLENBQUM7QUFFRCxvQkFBcUIsSUFBZ0IsRUFBRSxTQUFrQjtJQUNyRCxhQUFhO0lBQ2IsSUFBSSxFQUF5QjtJQUM3QixJQUFJLGFBQWEsR0FBRyxDQUFDO0lBQ3JCLElBQUksWUFBWSxHQUFHLENBQUM7SUFDcEIsSUFBSSxXQUFXLEdBQUcsQ0FBQztJQUNuQixJQUFJLFVBQVUsR0FBRyxDQUFDO0lBRWxCLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsYUFBYSxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUM7UUFDckMsRUFBRSxHQUFHLGlEQUFnQixDQUFDLFdBQVcsQ0FBQyxpREFBZ0IsQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDO1FBQ3JFLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxlQUFlLEVBQUUsRUFBRyxFQUFFLENBQUM7SUFDakQsQ0FBQztJQUVELEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsWUFBWSxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUM7UUFDcEMsRUFBRSxHQUFHLGlEQUFnQixDQUFDLFdBQVcsQ0FBQyxpREFBZ0IsQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDO1FBQ3JFLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxlQUFlLEVBQUUsRUFBRyxFQUFFLENBQUM7SUFDakQsQ0FBQztJQUVELEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsVUFBVSxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUM7UUFDbEMsRUFBRSxHQUFHLGlEQUFnQixDQUFDLFdBQVcsQ0FBQyxpREFBZ0IsQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDO1FBQ25FLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxlQUFlLEVBQUUsRUFBRyxFQUFFLENBQUM7SUFDakQsQ0FBQztJQUVELEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsV0FBVyxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUM7UUFDbkMsRUFBRSxHQUFHLGlEQUFnQixDQUFDLFdBQVcsQ0FBQyxpREFBZ0IsQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDO1FBQ3BFLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxlQUFlLEVBQUUsRUFBRyxFQUFFLENBQUM7SUFDakQsQ0FBQztJQUVELE1BQU0sQ0FBQyxJQUFJO0FBQ2YsQ0FBQztBQUVELHVCQUF3QixFQUFvQixFQUFFLElBQWdCLEVBQUUsU0FBa0I7SUFDOUUsSUFBSSxnQkFBZ0IsR0FBRztRQUNuQixXQUFXLEVBQUUsQ0FBQztRQUNkLFNBQVMsRUFBRSxDQUFDO0tBR2Y7SUFFRCxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDakIsZ0JBQWdCLENBQUMsV0FBVyxDQUFDLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsS0FBSyxHQUFHLENBQUMsQ0FBQyxDQUFDO0lBQ2pFLENBQUM7SUFFRCxJQUFJLFlBQVksR0FBRyxFQUFFLEdBQUcsQ0FBQyxJQUFJLENBQUMsS0FBSyxHQUFHLENBQUMsQ0FBQztJQUN4QyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLFlBQVksRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDO1FBQ3BDLDBDQUEwQztRQUMxQyxvQ0FBb0M7UUFDcEMsa0RBQWtEO1FBQ2xELFdBQVc7UUFDWCxtREFBbUQ7UUFDbkQsSUFBSTtRQUNKLElBQUksSUFBSSxHQUFHLGlEQUFnQixDQUFDLFdBQVcsQ0FBQywwQ0FBTyxDQUFDLGdCQUFnQixDQUFDLGdCQUFnQixDQUFDLENBQUM7UUFDbkYsK0lBQStJO1FBQy9JLElBQUksR0FBRyxHQUFHLGlEQUFnQixDQUFDLGNBQWMsQ0FBQyxFQUFFLEVBQUUsSUFBSSxFQUFFLEVBQUMsY0FBYyxFQUFFLDJDQUFVLENBQUMsYUFBYSxDQUFDLE1BQU0sRUFBRSxDQUFDO1FBQ3ZHLDBCQUEwQjtRQUMxQixHQUFHLENBQUMsSUFBSSxHQUFHLFVBQVUsR0FBRyxDQUFDLENBQUMsUUFBUSxFQUFFO1FBQ3BDLDBCQUEwQjtRQUUxQiw0REFBNEQ7UUFDNUQsa0VBQWtFO1FBQ2xFLElBQUksRUFBRSxHQUFxQixJQUFJLENBQUMsZUFBZSxFQUFFO1FBQ2pELHlEQUF5RDtRQUN6RCxJQUFJLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxFQUFFLEVBQUUsR0FBRyxDQUFDO1FBQzVCLDhCQUE4QjtJQUNsQyxDQUFDO0lBRUQsTUFBTSxDQUFDLElBQUk7QUFDZixDQUFDO0FBRUQseUJBQXlCLEtBQWlCO0lBQ3RDLElBQUksTUFBTSxHQUE0QiwyQ0FBVSxDQUFDLFNBQVMsQ0FBQywyQ0FBVSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsZ0JBQWdCLENBQUMsMkNBQVUsQ0FBQyxtQkFBbUIsQ0FBQyxJQUFJLENBQUMsQ0FBQyxFQUFFLElBQUksQ0FBQztJQUUvSSxJQUFJLGFBQWEsR0FBRywwQ0FBTyxDQUFDLGFBQWEsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDO0lBRS9DLElBQUksY0FBYyxHQUFHLElBQUksb0RBQW1CLEVBQUU7SUFFOUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxhQUFhLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQztRQUNyQyxJQUFJLElBQUksR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLDBDQUFPLENBQUMsU0FBUyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQzVELElBQUksU0FBUyxHQUFHLE1BQU0sQ0FBQyxDQUFDLENBQUM7UUFFekIsSUFBSSxTQUEyQjtRQUMvQixFQUFFLENBQUMsQ0FBQywwQ0FBTyxDQUFDLFVBQVUsRUFBRSxHQUFHLEdBQUcsQ0FBQyxDQUFDLENBQUM7WUFDN0IsU0FBUyxHQUFHLElBQUksMkNBQVUsQ0FBQyxRQUFRLENBQUMsSUFBSSwyQ0FBVSxDQUFDLFNBQVMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxFQUFFLFNBQVMsQ0FBQyxDQUFDLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDO1FBQ3ZHLENBQUM7UUFBQyxJQUFJLENBQUMsQ0FBQztZQUNKLFNBQVMsR0FBRyxJQUFJLDJDQUFVLENBQUMsYUFBYSxDQUFDLElBQUksMkNBQVUsQ0FBQyxTQUFTLENBQUMsU0FBUyxDQUFDLENBQUMsRUFBRSxTQUFTLENBQUMsQ0FBQyxFQUFFLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQztRQUU1RyxDQUFDO1FBRUQsR0FBRyxDQUFDLENBQUMsSUFBSSxFQUFFLElBQUksU0FBUyxDQUFDLFFBQVEsRUFBRSxDQUFDLENBQUMsQ0FBQztZQUNsQyxFQUFFLENBQUMsQ0FBQyxjQUFjLENBQUMsYUFBYSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQztnQkFDbkMsUUFBUTtZQUNaLENBQUM7WUFFRCxFQUFFLENBQUMsQ0FBQywwQ0FBTyxDQUFDLFVBQVUsRUFBRSxHQUFHLElBQUksQ0FBQyxDQUFDLENBQUM7Z0JBQzlCLEVBQUUsQ0FBQyxDQUFDLEtBQUssQ0FBQyxrQkFBa0IsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7b0JBQy9CLEtBQUssQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBQztvQkFDMUIsS0FBSyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsRUFBRSxFQUFFLGlEQUFnQixDQUFDLGNBQWMsQ0FBQyxpREFBZ0IsQ0FBQyxXQUFXLENBQUMsV0FBVyxDQUFDLENBQUM7Z0JBQ3RHLENBQUM7WUFDTCxDQUFDO1lBRUQsY0FBYyxDQUFDLGFBQWEsQ0FBQyxFQUFFLENBQUM7UUFDcEMsQ0FBQztRQUVELEdBQUcsQ0FBQyxDQUFDLElBQUksRUFBRSxJQUFJLFNBQVMsQ0FBQyxTQUFTLEVBQUUsQ0FBQyxDQUFDLENBQUM7WUFDbkMsb0NBQW9DO1lBRXBDLEVBQUUsQ0FBQyxDQUFDLEtBQUssQ0FBQyxrQkFBa0IsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7Z0JBQy9CLEtBQUssQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBQztnQkFDMUIsS0FBSyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsRUFBRSxFQUFFLGlEQUFnQixDQUFDLGNBQWMsQ0FBQyxpREFBZ0IsQ0FBQyxXQUFXLENBQUMsTUFBTSxDQUFDLENBQUM7WUFDakcsQ0FBQztZQUVELG1DQUFtQztRQUN2QyxDQUFDO0lBQ0wsQ0FBQztBQUVMLENBQUMiLCJmaWxlIjoiLi9zcmMvYnJld19nYW1lL2xldmVsZ2VuLnRzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgUk9UIGZyb20gJ3JvdC1qcydcclxuaW1wb3J0ICogYXMgQnJldyBmcm9tICcuLi9icmV3J1xyXG5cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBidWlsZExldmVsKGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGRlcHRoOiBudW1iZXIsIGxhc3RMZXZlbDogYm9vbGVhbikge1xyXG4gICAgbGV0IHN1Y2Nlc3MgOiBib29sZWFuXHJcblxyXG4gICAgbGV0IG15X2xldmVsID0gbmV3IEJyZXcuTGV2ZWwoQnJldy5Db25maWcubWFwX3dpZHRoX3RpbGVzLCBCcmV3LkNvbmZpZy5tYXBfaGVpZ2h0X3RpbGVzLCBkZXB0aClcclxuXHJcbiAgICAvLyB0b2RvOiBtYWtlIHRoaXMgYW4gYXJyYXkgYW5kIHVzZSBzb21lL2FsbCB0byBtYWtlIHN1cmUgaXRzIGEgZ29vZCBsZXZlbFxyXG4gICAgc3VjY2VzcyA9IGZhbHNlXHJcbiAgICBsZXQgbnVtX3RyaWVzID0gMFxyXG4gICAgd2hpbGUgKCEoc3VjY2VzcykpIHtcclxuICAgICAgICBudW1fdHJpZXMgKz0gMVxyXG4gICAgICAgIHN1Y2Nlc3MgPSBzZXR1cFRlcnJhaW5fU2ltcGxlKG15X2xldmVsLCBsYXN0TGV2ZWwpXHJcbiAgICB9XHJcbiAgICBjb25zb2xlLmxvZyhgZGVwdGggJHtkZXB0aH06ICR7bnVtX3RyaWVzfSB0cmllc2ApXHJcblxyXG4gICAgbXlfbGV2ZWwudXBkYXRlTmF2aWdhdGlvbigpXHJcbiAgICBhZGRUZXJyYWluU3BpY2UobXlfbGV2ZWwpXHJcbiAgICBteV9sZXZlbC51cGRhdGVOYXZpZ2F0aW9uKClcclxuICAgIFxyXG4gICAgc3VjY2VzcyA9IHNldHVwRXhpdExvY2F0aW9ucyhteV9sZXZlbCwgbGFzdExldmVsKVxyXG4gICAgc3VjY2VzcyA9IHNldHVwUG9ydGFscyhnbSwgbXlfbGV2ZWwpXHJcbiAgICBzdWNjZXNzID0gc2V0dXBJdGVtcyhteV9sZXZlbCwgbGFzdExldmVsKVxyXG4gICAgc3VjY2VzcyA9IHNldHVwTW9uc3RlcnMoZ20sIG15X2xldmVsLCBsYXN0TGV2ZWwpXHJcblxyXG5cclxuICAgIG15X2xldmVsLmlzQ29uc3RydWN0ZWQgPSB0cnVlXHJcbiAgICByZXR1cm4gbXlfbGV2ZWxcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGJ1aWxkQW5kQXR0YWNoTmV3TGV2ZWwoZ206IEJyZXcuR2FtZU1hc3RlciwgY3VycmVudExldmVsOiBCcmV3LkxldmVsLCBwb3J0YWw6IEJyZXcuUG9ydGFsKSB7XHJcbiAgICBsZXQgbmV4dF9sZXZlbCA9IGJ1aWxkTGV2ZWwoZ20sIGN1cnJlbnRMZXZlbC5kZXB0aCArIDEsIGZhbHNlKVxyXG4gICAgZ20uYWRkTGV2ZWwobmV4dF9sZXZlbClcclxuICAgIHBvcnRhbC5hdHRhY2hEZXN0aW5hdGlvbihuZXh0X2xldmVsLmlkLCBuZXh0X2xldmVsLnNpbXBsZV9zdGFydF94eSlcclxufVxyXG5cclxuZnVuY3Rpb24gc2V0dXBQb3J0YWxzKGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGxhaXI6IEJyZXcuTGV2ZWwpIDogYm9vbGVhbiB7XHJcbiAgICBsZXQgcG9ydGFsX2ZvcndhcmQgOiBCcmV3LlBvcnRhbFxyXG4gICAgcG9ydGFsX2ZvcndhcmQgPSBuZXcgQnJldy5Qb3J0YWwobGFpci5pZCwgbGFpci5zaW1wbGVfZXhpdF94eSlcclxuICAgIC8vIHBvcnRhbF9mb3J3YXJkLmF0dGFjaERlc3RpbmF0aW9uKGxpc3RMZXZlbHNbaSsxXS5pZCwgbGlzdExldmVsc1tpKzFdLnNpbXBsZV9zdGFydF94eSlcclxuICAgIGxhaXIucG9ydGFscy5zZXRBdChsYWlyLnNpbXBsZV9leGl0X3h5LCBwb3J0YWxfZm9yd2FyZClcclxuICAgIHJldHVybiB0cnVlXHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNldHVwVGVycmFpbl9TaW1wbGUgKGxhaXIgOiBCcmV3LkxldmVsLCBsYXN0TGV2ZWw6IGJvb2xlYW4pIDogYm9vbGVhbiB7XHJcbiAgICBcclxuICAgIGxldCB0ZXJyYWluOiBCcmV3LkdyaWRUaGluZ3MuVGVycmFpblxyXG4gICAgXHJcbiAgICBsZXQgZWFzeU1hcCA9ICh4OiBudW1iZXIsIHk6IG51bWJlciwgd2hhdDogbnVtYmVyKSA9PiB7XHJcbiAgICAgICAgbGV0IHh5OiBCcmV3LkNvb3JkaW5hdGUgPSBuZXcgQnJldy5Db29yZGluYXRlKHgsIHkpXHJcbiAgICAgICAgLy8gd2FsbHMgb3ZlcnJpZGVcclxuICAgICAgICAvLyBpZiAoKHggPT0gMCkgfHwgKHkgPT0gMCkgfHwgKHggPT0gbGFpci53aWR0aCAtIDEpIHx8ICh5ID09IGxhaXIuaGVpZ2h0IC0gMSkpIHtcclxuICAgICAgICAvLyAgICAgdGVycmFpbiA9IEJyZXcuRGVmaW5pdGlvbnMudGVycmFpbkZhY3RvcnkoQnJldy5EZWZpbml0aW9ucy5UZXJyYWluVHlwZS5XYWxsKVxyXG4gICAgICAgIC8vIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGlmICh3aGF0ID09IDEpIHtcclxuICAgICAgICAgICAgICAgIHRlcnJhaW4gPSBCcmV3LkRlZmluaXRpb25zLnRlcnJhaW5GYWN0b3J5KEJyZXcuRGVmaW5pdGlvbnMuVGVycmFpblR5cGUuUm9jaylcclxuICAgICAgICAgICAgfSBlbHNlIGlmICh3aGF0ID09IDApIHtcclxuICAgICAgICAgICAgICAgIHRlcnJhaW4gPSBCcmV3LkRlZmluaXRpb25zLnRlcnJhaW5GYWN0b3J5KEJyZXcuRGVmaW5pdGlvbnMuVGVycmFpblR5cGUuU2FuZClcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBSYW5nZUVycm9yKGBVbmV4cGVjdGVkIGxldmVsZ2VuIHJldHVybiB2YWx1ZSAke3doYXR9YClcclxuICAgICAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgLy8gfVxyXG4gICAgICAgIFxyXG4gICAgICAgIGxhaXIudGVycmFpbi5zZXRBdCh4eSwgdGVycmFpbilcclxuICAgIH1cclxuXHJcbiAgICAvLyBsZXQgcm90TWFwID0gbmV3IFJPVC5NYXAuQXJlbmEobGFpci53aWR0aCwgbGFpci5oZWlnaHQpXHJcbiAgICBsZXQgcm90TWFwID0gbmV3IFJPVC5NYXAuQ2VsbHVsYXIobGFpci53aWR0aCwgbGFpci5oZWlnaHQsIHsgY29ubmVjdGVkOiB0cnVlIH0gKVxyXG5cclxuICAgIHJvdE1hcC5yYW5kb21pemUoMC40KVxyXG4gICAgcm90TWFwLmNyZWF0ZShlYXN5TWFwKVxyXG4gICAgLy8gcm90TWFwLmNyZWF0ZShlYXN5TWFwKVxyXG4gICAgLy8gcm90TWFwLmNyZWF0ZShlYXN5TWFwKVxyXG5cclxuICAgIC8vIG1ha2UgdGVycmFpbiBpbnRlcmVzdGluZ1xyXG4gICAgbGV0IG5vaXNlID0gbmV3IFJPVC5Ob2lzZS5TaW1wbGV4KDEwKVxyXG4gICAgbGV0IHRlcnJhaW5fYXQgOiBCcmV3LkdyaWRUaGluZ3MuVGVycmFpblxyXG4gICAgZm9yIChsZXQgeCA9IDE7IHggPCAobGFpci53aWR0aCAtIDEpOyB4KyspIHtcclxuICAgICAgICBmb3IgKGxldCB5ID0gMTsgeSA8IChsYWlyLmhlaWdodCAtIDEpOyB5KyspIHtcclxuICAgICAgICAgICAgbGV0IHh5ID0gbmV3IEJyZXcuQ29vcmRpbmF0ZSh4LCB5KVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgbGV0IHAgPSBub2lzZS5nZXQoeC8xMCwgeS8xMClcclxuXHJcbiAgICAgICAgICAgIGlmICgocCA+IC41KSAmJiAoIShsYXN0TGV2ZWwpKSkge1xyXG4gICAgICAgICAgICAgICAgdGVycmFpbl9hdCA9IGxhaXIudGVycmFpbi5nZXRBdCh4eSlcclxuICAgICAgICAgICAgICAgIGlmICh0ZXJyYWluX2F0LmlzVHlwZShCcmV3LkRlZmluaXRpb25zLlRlcnJhaW5UeXBlLlNhbmQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGFpci50ZXJyYWluLnJlbW92ZUF0KHh5KVxyXG4gICAgICAgICAgICAgICAgICAgIGxhaXIudGVycmFpbi5zZXRBdCh4eSwgQnJldy5EZWZpbml0aW9ucy50ZXJyYWluRmFjdG9yeShCcmV3LkRlZmluaXRpb25zLlRlcnJhaW5UeXBlLkdyYXNzKSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKHAgPCAtMC41KSB7XHJcbiAgICAgICAgICAgICAgICB0ZXJyYWluX2F0ID0gbGFpci50ZXJyYWluLmdldEF0KHh5KVxyXG4gICAgICAgICAgICAgICAgaWYgKHRlcnJhaW5fYXQuaXNUeXBlKEJyZXcuRGVmaW5pdGlvbnMuVGVycmFpblR5cGUuU2FuZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBsYWlyLnRlcnJhaW4ucmVtb3ZlQXQoeHkpXHJcbiAgICAgICAgICAgICAgICAgICAgbGFpci50ZXJyYWluLnNldEF0KHh5LCBCcmV3LkRlZmluaXRpb25zLnRlcnJhaW5GYWN0b3J5KEJyZXcuRGVmaW5pdGlvbnMuVGVycmFpblR5cGUuUnViYmxlKSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gdHJ1ZVxyXG59XHJcblxyXG5mdW5jdGlvbiBzZXR1cEV4aXRMb2NhdGlvbnMgKGxhaXIgOiBCcmV3LkxldmVsLCBsYXN0TGV2ZWw6IGJvb2xlYW4pIDogYm9vbGVhbiB7XHJcblxyXG4gICAgLy8gZ2V0IGFsbCBhdmFpbGFibGUgZmxvb3Igc3BvdHNcclxuICAgIGxldCBmbG9vcnMgOiBBcnJheTxCcmV3LkNvb3JkaW5hdGU+ID0gQnJldy5VdGlscy5yYW5kb21pemUoQnJldy5VdGlscy5jbG9uZShsYWlyLm5hdmlnYXRpb25fdGlsZXNbQnJldy5FbnVtcy5MZXZlbE5hdmlnYXRpb25UeXBlLldhbGtdKSwgdHJ1ZSlcclxuICAgIFxyXG5cclxuICAgIC8vIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLCBwaWNrIGEgcmFuZG9tIHN0YXJ0IGxvY2F0aW9uXHJcbiAgICAvLyB0b2RvOiBlbnN1cmUgbWluaW11bSBkaXN0YW5jZSBiZXR3ZWVuIHN0YXJ0IGFuZCBlbmRcclxuICAgIGxldCBzdGFydF94eSA9IGZsb29yc1swXVxyXG4gICAgbGV0IGV4aXRfeHkgPSBmbG9vcnNbMV1cclxuICAgIGxldCBtaW5fZGlzdGFuY2UgPSBNYXRoLm1heChCcmV3LkNvbmZpZy5tYXBfaGVpZ2h0X3RpbGVzLCBCcmV3LkNvbmZpZy5tYXBfd2lkdGhfdGlsZXMpIC8gMlxyXG4gICAgd2hpbGUgKEJyZXcuVXRpbHMuZGlzdDJkKHN0YXJ0X3h5LCBleGl0X3h5KSA8IG1pbl9kaXN0YW5jZSkge1xyXG4gICAgICAgIGV4aXRfeHkgPSBCcmV3LlV0aWxzLnJhbmRvbU9mKGZsb29ycywgdHJ1ZSlcclxuICAgIH1cclxuICAgIC8vIGNvbnNvbGUubG9nKFwic3RhcnRcIiwgc3RhcnRfeHkpXHJcbiAgICAvLyBjb25zb2xlLmxvZyhcImV4aXRcIiwgZXhpdF94eSlcclxuXHJcbiAgICBsYWlyLnNpbXBsZV9zdGFydF94eSA9IHN0YXJ0X3h5XHJcbiAgICBsYWlyLnNpbXBsZV9leGl0X3h5ID0gZXhpdF94eVxyXG5cclxuICAgIC8vIGxldCBzdGFydF94eSA9IGxhaXIuc2ltcGxlX3N0YXJ0X3h5XHJcbiAgICAvLyBsZXQgZXhpdF94eSA9IGxhaXIuc2ltcGxlX2V4aXRfeHlcclxuXHJcbiAgICAvLyBsZXQgZW50cmFuY2Vfc3RhaXJzID0gQnJldy5EZWZpbml0aW9ucy50ZXJyYWluRmFjdG9yeShCcmV3LkRlZmluaXRpb25zLlRlcnJhaW5UeXBlLlVwU3RhaXJzKVxyXG4gICAgLy8gbGFpci50ZXJyYWluLnJlbW92ZUF0KHN0YXJ0X3h5KVxyXG4gICAgLy8gbGFpci50ZXJyYWluLnNldEF0KHN0YXJ0X3h5LCBlbnRyYW5jZV9zdGFpcnMpXHJcbiAgICAvLyBpZiAobGFpci5kZXB0aCA9PSAxKSB7XHJcbiAgICAvLyAgICAgZW50cmFuY2Vfc3RhaXJzLmNvZGUgPSBCcmV3LlN5bWJvbHMuZG91YmxlX2FuZ2xlX2JyYWNrZXRfbGVmdFxyXG4gICAgLy8gfVxyXG5cclxuICAgIC8vIGlmIChsYWlyLmRlcHRoIDwgQnJldy5Db25maWcubWF4X2RlcHRoKSB7XHJcbiAgICBpZiAoIShsYXN0TGV2ZWwpKSB7XHJcbiAgICAgICAgbGFpci50ZXJyYWluLnJlbW92ZUF0KGV4aXRfeHkpXHJcbiAgICAgICAgbGFpci50ZXJyYWluLnNldEF0KGV4aXRfeHksIEJyZXcuRGVmaW5pdGlvbnMudGVycmFpbkZhY3RvcnkoQnJldy5EZWZpbml0aW9ucy5UZXJyYWluVHlwZS5MZXZlbENoZWNrUG9pbnQpKVxyXG4gICAgfVxyXG5cclxuICAgIC8vIHRvZG86IGV2ZW50dWFsbHkgdGhpcyB3aWxsIGJlIGZhaWwtYWJsZVxyXG4gICAgcmV0dXJuIHRydWVcclxufVxyXG5cclxuZnVuY3Rpb24gc2V0dXBJdGVtcyAobGFpcjogQnJldy5MZXZlbCwgbGFzdExldmVsOiBib29sZWFuKSA6IGJvb2xlYW4ge1xyXG4gICAgLy8gc29tZSBpdGVtc1xyXG4gICAgbGV0IGl0IDogQnJldy5HcmlkVGhpbmdzLkl0ZW1cclxuICAgIGxldCBudW1fY2l2aWxpYW5zID0gNVxyXG4gICAgbGV0IG51bV9zdXBwbGllcyA9IDVcclxuICAgIGxldCBudW1fYnVsbGV0cyA9IDVcclxuICAgIGxldCBudW1fc2hlbGxzID0gNVxyXG5cclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtX2NpdmlsaWFuczsgaSsrKSB7XHJcbiAgICAgICAgaXQgPSBCcmV3LkRlZmluaXRpb25zLml0ZW1GYWN0b3J5KEJyZXcuRGVmaW5pdGlvbnMuSXRlbVR5cGUuQ2l2aWxpYW4pXHJcbiAgICAgICAgbGFpci5pdGVtcy5zZXRBdChsYWlyLmdldFNhZmVMb2NhdGlvbigpICwgaXQpXHJcbiAgICB9IFxyXG5cclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtX3N1cHBsaWVzOyBpKyspIHtcclxuICAgICAgICBpdCA9IEJyZXcuRGVmaW5pdGlvbnMuaXRlbUZhY3RvcnkoQnJldy5EZWZpbml0aW9ucy5JdGVtVHlwZS5TdXBwbGllcylcclxuICAgICAgICBsYWlyLml0ZW1zLnNldEF0KGxhaXIuZ2V0U2FmZUxvY2F0aW9uKCkgLCBpdClcclxuICAgIH0gXHJcblxyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1fc2hlbGxzOyBpKyspIHtcclxuICAgICAgICBpdCA9IEJyZXcuRGVmaW5pdGlvbnMuaXRlbUZhY3RvcnkoQnJldy5EZWZpbml0aW9ucy5JdGVtVHlwZS5TaGVsbHMpXHJcbiAgICAgICAgbGFpci5pdGVtcy5zZXRBdChsYWlyLmdldFNhZmVMb2NhdGlvbigpICwgaXQpXHJcbiAgICB9IFxyXG5cclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtX2J1bGxldHM7IGkrKykge1xyXG4gICAgICAgIGl0ID0gQnJldy5EZWZpbml0aW9ucy5pdGVtRmFjdG9yeShCcmV3LkRlZmluaXRpb25zLkl0ZW1UeXBlLkJ1bGxldHMpXHJcbiAgICAgICAgbGFpci5pdGVtcy5zZXRBdChsYWlyLmdldFNhZmVMb2NhdGlvbigpICwgaXQpXHJcbiAgICB9IFxyXG5cclxuICAgIHJldHVybiB0cnVlXHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNldHVwTW9uc3RlcnMgKGdtIDogQnJldy5HYW1lTWFzdGVyLCBsYWlyOiBCcmV3LkxldmVsLCBsYXN0TGV2ZWw6IGJvb2xlYW4pIDogYm9vbGVhbiB7XHJcbiAgICBsZXQgd2VpZ2h0ZWRNb25zdGVycyA9IHtcclxuICAgICAgICBcIk1lcmNlbmFyeVwiOiA1LFxyXG4gICAgICAgIFwiU29sZGllclwiOiA1LFxyXG4gICAgICAgIC8vIFwiR3JlbmFkaWVyXCI6IDIsXHJcbiAgICAgICAgLy8gXCJKZWVwXCI6IDIsXHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGxhaXIuZGVwdGggPiA1KSB7XHJcbiAgICAgICAgd2VpZ2h0ZWRNb25zdGVyc1tcIkdyZW5hZGllclwiXSA9IE1hdGgubWluKDUsIChsYWlyLmRlcHRoIC0gNSkpXHJcbiAgICB9XHJcbiAgICBcclxuICAgIGxldCBudW1fbW9uc3RlcnMgPSAxMCArIChsYWlyLmRlcHRoICogMilcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtX21vbnN0ZXJzOyBpKyspIHtcclxuICAgICAgICAvLyBsZXQgbWRlZiA6IEJyZXcuRGVmaW5pdGlvbnMuTW9uc3RlclR5cGVcclxuICAgICAgICAvLyBpZiAoUk9ULlJORy5nZXRVbmlmb3JtKCkgPCAwLjcpIHtcclxuICAgICAgICAvLyAgICAgbWRlZiA9IEJyZXcuRGVmaW5pdGlvbnMuTW9uc3RlclR5cGUuS2lsbGJvdFxyXG4gICAgICAgIC8vIH0gZWxzZSB7XHJcbiAgICAgICAgLy8gICAgIG1kZWYgPSBCcmV3LkRlZmluaXRpb25zLk1vbnN0ZXJUeXBlLkd1YXJkZ3V5XHJcbiAgICAgICAgLy8gfVxyXG4gICAgICAgIGxldCBtZGVmID0gQnJldy5EZWZpbml0aW9ucy5Nb25zdGVyVHlwZVtST1QuUk5HLmdldFdlaWdodGVkVmFsdWUod2VpZ2h0ZWRNb25zdGVycyldXHJcbiAgICAgICAgLy8gbGV0IG1vYiA9IEJyZXcuRGVmaW5pdGlvbnMubW9uc3RlckZhY3RvcnkoZ20sIEJyZXcuRGVmaW5pdGlvbnMuTW9uc3RlclR5cGUuS2lsbGJvdCwge21vbnN0ZXJfc3RhdHVzOiBCcmV3LkdyaWRUaGluZ3MuTW9uc3RlclN0YXR1cy5XYW5kZXIgfSlcclxuICAgICAgICBsZXQgbW9iID0gQnJldy5EZWZpbml0aW9ucy5tb25zdGVyRmFjdG9yeShnbSwgbWRlZiwge21vbnN0ZXJfc3RhdHVzOiBCcmV3LkVudW1zLk1vbnN0ZXJTdGF0dXMuV2FuZGVyIH0pXHJcbiAgICAgICAgLy8gbW9iLmNvZGUgPSBpLnRvU3RyaW5nKClcclxuICAgICAgICBtb2IubmFtZSA9IFwiTW9uc3RlciBcIiArIGkudG9TdHJpbmcoKVxyXG4gICAgICAgIC8vIG1vYi5jb2RlID0gaS50b1N0cmluZygpXHJcblxyXG4gICAgICAgIC8vIG1vYi5tb25zdGVyX3N0YXR1cyA9IEJyZXcuR3JpZFRoaW5ncy5Nb25zdGVyU3RhdHVzLldhbmRlclxyXG4gICAgICAgIC8vIHRvZG86IGVuc3VyZSBtb25zdGVycyBkb250IHN0YXJ0IHRvbyBuZWFyIHRoZSBzdGFydGluZyBsb2NhdGlvblxyXG4gICAgICAgIGxldCB4eSA6IEJyZXcuQ29vcmRpbmF0ZSA9IGxhaXIuZ2V0U2FmZUxvY2F0aW9uKClcclxuICAgICAgICAvLyBsZXQgeHkgOiBCcmV3LkNvb3JkaW5hdGUgPSBCcmV3LnJhbmRvbU9mKGxldmVsLmZsb29ycylcclxuICAgICAgICBsYWlyLm1vbnN0ZXJzLnNldEF0KHh5LCBtb2IpXHJcbiAgICAgICAgLy8gZ20uc2NoZWR1bGVyLmFkZChtb2IsIHRydWUpXHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHRydWVcclxufVxyXG5cclxuZnVuY3Rpb24gYWRkVGVycmFpblNwaWNlKGxldmVsOiBCcmV3LkxldmVsKSB7XHJcbiAgICBsZXQgZmxvb3JzIDogQXJyYXk8QnJldy5Db29yZGluYXRlPiA9IEJyZXcuVXRpbHMucmFuZG9taXplKEJyZXcuVXRpbHMuY2xvbmUobGV2ZWwubmF2aWdhdGlvbl90aWxlc1tCcmV3LkVudW1zLkxldmVsTmF2aWdhdGlvblR5cGUuV2Fsa10pLCB0cnVlKVxyXG5cclxuICAgIGxldCBudW1fYnVpbGRpbmdzID0gUk9ULlJORy5nZXRVbmlmb3JtSW50KDAsIDMpXHJcblxyXG4gICAgbGV0IGJ1aWxkaW5nX3RpbGVzID0gbmV3IEJyZXcuQ29vcmRpbmF0ZUFyZWEoKVxyXG5cclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtX2J1aWxkaW5nczsgaSsrKSB7XHJcbiAgICAgICAgbGV0IHNpemUgPSBNYXRoLm1heCgzLCBNYXRoLmZsb29yKFJPVC5STkcuZ2V0Tm9ybWFsKDEwLCAxKSkpXHJcbiAgICAgICAgbGV0IGNlbnRlcl94eSA9IGZsb29yc1tpXVxyXG5cclxuICAgICAgICBsZXQgc3RydWN0dXJlIDogQnJldy5Sb29tcy5Sb29tXHJcbiAgICAgICAgaWYgKFJPVC5STkcuZ2V0VW5pZm9ybSgpIDwgMC41KSB7XHJcbiAgICAgICAgICAgIHN0cnVjdHVyZSA9IG5ldyBCcmV3LlJvb21zLk92YWxSb29tKG5ldyBCcmV3LlJvb21zLlJlY3RhbmdsZShjZW50ZXJfeHkueCwgY2VudGVyX3h5LnksIHNpemUsIHNpemUpKVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHN0cnVjdHVyZSA9IG5ldyBCcmV3LlJvb21zLlJlY3RhbmdsZVJvb20obmV3IEJyZXcuUm9vbXMuUmVjdGFuZ2xlKGNlbnRlcl94eS54LCBjZW50ZXJfeHkueSwgc2l6ZSwgc2l6ZSkpXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBmb3IgKGxldCB4eSBvZiBzdHJ1Y3R1cmUuZ2V0V2FsbHMoKSkge1xyXG4gICAgICAgICAgICBpZiAoYnVpbGRpbmdfdGlsZXMuaGFzQ29vcmRpbmF0ZSh4eSkpIHtcclxuICAgICAgICAgICAgICAgIGNvbnRpbnVlXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChST1QuUk5HLmdldFVuaWZvcm0oKSA+IDAuMjUpIHtcclxuICAgICAgICAgICAgICAgIGlmIChsZXZlbC5pc1ZhbGlkX1BvaW50c09ubHkoeHkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV2ZWwudGVycmFpbi5yZW1vdmVBdCh4eSlcclxuICAgICAgICAgICAgICAgICAgICBsZXZlbC50ZXJyYWluLnNldEF0KHh5LCBCcmV3LkRlZmluaXRpb25zLnRlcnJhaW5GYWN0b3J5KEJyZXcuRGVmaW5pdGlvbnMuVGVycmFpblR5cGUuQnJva2VuX1dhbGwpKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBidWlsZGluZ190aWxlcy5hZGRDb29yZGluYXRlKHh5KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZm9yIChsZXQgeHkgb2Ygc3RydWN0dXJlLmdldEZsb29ycygpKSB7XHJcbiAgICAgICAgICAgIC8vIGlmIChidWlsZGluZ190aWxlcy5oYXNDb29yZGluYXRlKVxyXG5cclxuICAgICAgICAgICAgaWYgKGxldmVsLmlzVmFsaWRfUG9pbnRzT25seSh4eSkpIHtcclxuICAgICAgICAgICAgICAgIGxldmVsLnRlcnJhaW4ucmVtb3ZlQXQoeHkpXHJcbiAgICAgICAgICAgICAgICBsZXZlbC50ZXJyYWluLnNldEF0KHh5LCBCcmV3LkRlZmluaXRpb25zLnRlcnJhaW5GYWN0b3J5KEJyZXcuRGVmaW5pdGlvbnMuVGVycmFpblR5cGUuUnViYmxlKSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gYnVpbGRpbmdfdGlsZXMuYWRkQ29vcmRpbmF0ZSh4eSlcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG59Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/brew_game/levelgen.ts\n");

/***/ }),

/***/ "./src/brew_game/menus.ts":
/*!********************************!*\
  !*** ./src/brew_game/menus.ts ***!
  \********************************/
/*! exports provided: showContextMenu, showInventoryList, showPowerManagementMenu, showPowerInstallPromptMenu, showPowerInstallSelectMenu, showPowerSwapSelectMenu, getMenuData_Entries_for_Powers, showHeadsUpDisplay, showGenericMenu, stopShowingGenericMenu, getEntryName, updateGenericMenu, selectFromGenericMenu, showConfirmPaths, finalizeConfirmPaths, cancelConfirmPaths, getWarpBeaconMenuEvent, showHelpMenu */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"showContextMenu\", function() { return showContextMenu; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"showInventoryList\", function() { return showInventoryList; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"showPowerManagementMenu\", function() { return showPowerManagementMenu; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"showPowerInstallPromptMenu\", function() { return showPowerInstallPromptMenu; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"showPowerInstallSelectMenu\", function() { return showPowerInstallSelectMenu; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"showPowerSwapSelectMenu\", function() { return showPowerSwapSelectMenu; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getMenuData_Entries_for_Powers\", function() { return getMenuData_Entries_for_Powers; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"showHeadsUpDisplay\", function() { return showHeadsUpDisplay; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"showGenericMenu\", function() { return showGenericMenu; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"stopShowingGenericMenu\", function() { return stopShowingGenericMenu; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getEntryName\", function() { return getEntryName; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"updateGenericMenu\", function() { return updateGenericMenu; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"selectFromGenericMenu\", function() { return selectFromGenericMenu; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"showConfirmPaths\", function() { return showConfirmPaths; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"finalizeConfirmPaths\", function() { return finalizeConfirmPaths; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"cancelConfirmPaths\", function() { return cancelConfirmPaths; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getWarpBeaconMenuEvent\", function() { return getWarpBeaconMenuEvent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"showHelpMenu\", function() { return showHelpMenu; });\n/* harmony import */ var _brew__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../brew */ \"./src/brew.ts\");\n\r\nfunction resetHUDToGame(gm) {\r\n    gm.input_handler = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].InputHandler.Main;\r\n    gm.display.clearDisplay(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].DisplayNames.HUD);\r\n    gm.displayAll();\r\n}\r\n//////////////////// context menu\r\nfunction showContextMenu(gm, brEvent) {\r\n    let context_action_list = brEvent.contextMenuData.context_list;\r\n    let item = brEvent.contextMenuData.item;\r\n    let invkey = brEvent.contextMenuData.invkey;\r\n    let entries = [];\r\n    let menuEvent = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].createGenericEventOfType(gm, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.GenericMenuOn);\r\n    context_action_list.forEach((context_action, index, array) => {\r\n        let entryEvent;\r\n        let entryName = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].ContextMenuItem[context_action];\r\n        if (context_action == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].ContextMenuItem.Drop) {\r\n            entryEvent = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].addDataToEvent(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].createGenericEventOfType(gm, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.Drop, true), {\r\n                itemData: {\r\n                    item: item,\r\n                    invkey: invkey,\r\n                    to_xy: gm.getPlayer().location.clone()\r\n                }\r\n            });\r\n        }\r\n        else if (context_action == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].ContextMenuItem.Throw) {\r\n            entryEvent = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].createGenericEventOfType(gm, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.TargetingOn, false);\r\n            entryEvent.itemData = {\r\n                item: item,\r\n                invkey: invkey\r\n            };\r\n            entryEvent.startTargetingData = {\r\n                from_xy: gm.getPlayer().location,\r\n                to_xy: gm.getPlayer().location,\r\n                targetingAction: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewTargetingAction.ThrowItem\r\n            };\r\n        }\r\n        else if (context_action == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].ContextMenuItem.Use) {\r\n            entryEvent = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].createGenericEventOfType(gm, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.UseItem, true);\r\n            entryEvent.itemData = {\r\n                item: item,\r\n                invkey: invkey\r\n            };\r\n        }\r\n        else {\r\n            throw new Error(\"bad context given\");\r\n        }\r\n        entries.push({\r\n            entryType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].GenericMenuEntryType.ItemContextAction,\r\n            entryName: entryName,\r\n            entryEvent: entryEvent\r\n        });\r\n    });\r\n    menuEvent.genericMenuData = {\r\n        menuTitle: item.getName(),\r\n        allowCancel: true,\r\n        menuEntriesList: entries\r\n    };\r\n    // gm.input_handler = Brew.Enums.InputHandler.ContextMenu\r\n    // gm.display.contextMenuDraw(contextList, 0)\r\n    // data.contextMenuData.selected_item_index = 0\r\n    gm.insertEvent(menuEvent);\r\n    gm.endEvent(brEvent);\r\n}\r\n//////////////////// inventory\r\nfunction showInventoryList(gm, data) {\r\n    let inv = data.inventoryData.inventory;\r\n    // gm.input_handler = Brew.Enums.InputHandler.InventoryList\r\n    // gm.display.inventoryDraw(inv, 0)\r\n    // data.inventoryData.selected_item_index = 0\r\n    let entries = [];\r\n    let menuEvent = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].createGenericEventOfType(gm, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.GenericMenuOn);\r\n    let item1;\r\n    let item2;\r\n    let inv_keys = inv.getKeys();\r\n    inv_keys.sort((key1, key2) => {\r\n        item1 = inv.getItemByKey(key1);\r\n        item2 = inv.getItemByKey(key2);\r\n        if (item1.getDefinition() == item2.getDefinition()) {\r\n            return 0;\r\n        }\r\n        else {\r\n            return (item1.getDefinition() < item2.getDefinition()) ? -1 : 1;\r\n        }\r\n    });\r\n    inv_keys.forEach((invkey, index, array) => {\r\n        let invitem = inv.getInventoryItemByKey(invkey);\r\n        entries.push({\r\n            entryType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].GenericMenuEntryType.InventoryItem,\r\n            entryEvent: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].addDataToEvent(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].createGenericEventOfType(gm, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.ContextMenuOn), {\r\n                contextMenuData: {\r\n                    item: invitem.item,\r\n                    invkey: invkey,\r\n                    context_list: [_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].ContextMenuItem.Drop, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].ContextMenuItem.Throw] //, Brew.Enums.ContextMenuItem.Use]//todo: figure out allowed contexts based on item type\r\n                }\r\n            })\r\n        });\r\n    });\r\n    entries.push({\r\n        entryType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].GenericMenuEntryType.Cancel,\r\n        entryName: (_brew__WEBPACK_IMPORTED_MODULE_0__[\"Config\"].max_items - inv.getItems().length) + \" spaces remaining\",\r\n        entryDescription: \"Your inventory has \" + (_brew__WEBPACK_IMPORTED_MODULE_0__[\"Config\"].max_items - inv.getItems().length) + \" spaces remaining\",\r\n        entryEvent: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].createGenericEventOfType(gm, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.GenericMenuOff, false)\r\n    });\r\n    menuEvent.genericMenuData = {\r\n        menuTitle: \"Inventory\",\r\n        allowCancel: true,\r\n        menuEntriesList: entries\r\n    };\r\n    gm.insertEvent(menuEvent);\r\n    gm.endEvent(data);\r\n}\r\n//////////////////////////////////////////////////\r\n// power management screen + uninstall + swap\r\n//////////////////////////////////////////////////\r\nfunction showPowerManagementMenu(gm, brEvent) {\r\n    let selected_power = brEvent.powerData.power;\r\n    let entries = [];\r\n    let menuEvent = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].createGenericEventOfType(gm, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.GenericMenuOn);\r\n    entries.push({\r\n        entryName: \"Swap\",\r\n        entryType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].GenericMenuEntryType.EventBased,\r\n        entryEvent: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].addDataToEvent(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].createGenericEventOfType(gm, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.PowerSwapSelectMenuOn, false), {\r\n            powerData: {\r\n                power: selected_power\r\n            }\r\n        })\r\n    });\r\n    entries.push({\r\n        entryName: \"Uninstall\",\r\n        entryType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].GenericMenuEntryType.EventBased,\r\n        entryEvent: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].addDataToEvent(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].createGenericEventOfType(gm, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.PowerUninstall, true), {\r\n            powerData: {\r\n                power: selected_power\r\n            }\r\n        })\r\n    });\r\n    menuEvent.genericMenuData = {\r\n        menuTitle: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewPowerType[selected_power.powerType],\r\n        allowCancel: true,\r\n        menuEntriesList: entries\r\n    };\r\n    gm.insertEvent(menuEvent);\r\n    gm.endEvent(brEvent);\r\n}\r\n//////////////////// list of powers menu helper\r\n// function showListOfPowersMenu_Helper(gm: Brew.GameMaster, brEvent: Brew.Enums.IBrewEvent, eventOnSelection : Brew.Enums.BrewEventType, endsTurn : boolean) {\r\n//     let selected_power  = brEvent.powerData.power\r\n//     let player = gm.getPlayer()\r\n//     let power_entries : Array<Brew.Enums.IBrewGenericMenuEntry> = []\r\n//     let powers = player.getPowers()\r\n//     powers.listOfPowers.forEach((pow, index, array) => {\r\n//         power_entries.push({\r\n//             entryName: Brew.Enums.BrewPowerType[pow.powerType] + ` ${pow.charge_stat.getCurrentLevel()} / ${pow.charge_stat.getMaxLevel()}` ,\r\n//             entryType: Brew.Enums.GenericMenuEntryType.PowerSelect,\r\n//             entryEvent: Brew.Events.addDataToEvent(Brew.Events.createGenericEventOfType(gm, eventOnSelection, endsTurn), {\r\n//                 powerData: {\r\n//                     power: selected_power\r\n//                 },\r\n//                 swapPowerData: {\r\n//                     power: pow\r\n//                 }\r\n//             })\r\n//         })\r\n//     })\r\n//     let menuEvent = Brew.Events.createGenericEventOfType(gm, Brew.Enums.BrewEventType.GenericMenuOn)\r\n//     menuEvent.genericMenuData = {\r\n//         menuTitle: Brew.Enums.BrewEventType[eventOnSelection],\r\n//         allowCancel: true,\r\n//         menuEntriesList: power_entries\r\n//     }\r\n//     gm.insertEvent(menuEvent)\r\n//     gm.endEvent(brEvent)\r\n// }\r\n//////////////////////////////////////////////////\r\n// power install\r\n//////////////////////////////////////////////////\r\nfunction showPowerInstallPromptMenu(gm, brEvent) {\r\n    let power = brEvent.powerData.power;\r\n    let entries = [];\r\n    entries.push({\r\n        entryType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].GenericMenuEntryType.EventBased,\r\n        entryName: \"Yes, Install\",\r\n        entryDescription: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Glossary\"].getPowerDesc(power),\r\n        entryEvent: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].addDataToEvent(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].createGenericEventOfType(gm, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.PowerInstallReplacementOn, false), {\r\n            powerData: {\r\n                power: power\r\n            }\r\n        })\r\n    });\r\n    entries.push({\r\n        entryType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].GenericMenuEntryType.Cancel,\r\n        entryName: \"No, Cancel\",\r\n        entryDescription: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Glossary\"].getPowerDesc(power),\r\n        entryEvent: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].createGenericEventOfType(gm, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.GenericMenuOff)\r\n    });\r\n    let menuEvent = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].createGenericEventOfType(gm, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.GenericMenuOn);\r\n    menuEvent.genericMenuData = {\r\n        menuTitle: \"Install This?\",\r\n        allowCancel: true,\r\n        menuEntriesList: entries,\r\n        menuDescription: \"Install this new power in an empty slot or replace an existing power\",\r\n    };\r\n    gm.insertEvent(menuEvent);\r\n    gm.endEvent(brEvent);\r\n}\r\nfunction showPowerInstallSelectMenu(gm, brEvent) {\r\n    // showListOfPowersMenu_Helper(gm, brEvent, Brew.Enums.BrewEventType.PowerInstallFinalize, true)\r\n    let menuEvent = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].createGenericEventOfType(gm, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.GenericMenuOn);\r\n    menuEvent.genericMenuData = {\r\n        menuTitle: \"Replace Which?\",\r\n        allowCancel: true,\r\n        menuEntriesList: getMenuData_Entries_for_Powers(gm, brEvent.actor, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.PowerInstallFinalize, true, brEvent.powerData.power)\r\n    };\r\n    gm.insertEvent(menuEvent);\r\n    gm.endEvent(brEvent);\r\n}\r\nfunction showPowerSwapSelectMenu(gm, brEvent) {\r\n    // showListOfPowersMenu_Helper(gm, brEvent, Brew.Enums.BrewEventType.PowerSwapFinalize, false)\r\n    let menuEvent = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].createGenericEventOfType(gm, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.GenericMenuOn);\r\n    menuEvent.genericMenuData = {\r\n        menuTitle: \"Swap With?\",\r\n        allowCancel: true,\r\n        menuEntriesList: getMenuData_Entries_for_Powers(gm, brEvent.actor, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.PowerSwapFinalize, false, brEvent.powerData.power)\r\n    };\r\n    gm.insertEvent(menuEvent);\r\n    gm.endEvent(brEvent);\r\n}\r\n//////////////////////////////////////////////////\r\n// power list\r\n//////////////////////////////////////////////////\r\nfunction getMenuData_Entries_for_Powers(gm, power_user, eventOnSelection, eventEndsTurn, swapPowerWith) {\r\n    // let player = gm.getPlayer()\r\n    let power_entries = [];\r\n    let powers = power_user.getPowers();\r\n    let basePower;\r\n    let swapPower;\r\n    let entry;\r\n    powers.listOfPowers.forEach((pow, index, array) => {\r\n        entry = {\r\n            entryName: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Glossary\"].getPowerName(pow),\r\n            entryType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].GenericMenuEntryType.EventBased,\r\n            entryEvent: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].addDataToEvent(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].createGenericEventOfType(gm, eventOnSelection, eventEndsTurn), {\r\n                powerData: {\r\n                    power: swapPowerWith ? swapPowerWith : pow\r\n                }\r\n            }),\r\n            entryDescription: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Glossary\"].getPowerDesc(pow)\r\n        };\r\n        if (swapPowerWith) {\r\n            entry.entryEvent.swapPowerData = {\r\n                power: pow\r\n            };\r\n        }\r\n        power_entries.push(entry);\r\n    });\r\n    return power_entries;\r\n}\r\n//////////////////////////////////////////////////\r\n// HUD\r\n//////////////////////////////////////////////////\r\nfunction showHeadsUpDisplay(gm, brEvent) {\r\n    gm.input_handler = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].InputHandler.HeadsUpDisplay;\r\n    let current_page = brEvent.headsUpData.selected_index;\r\n    let notes = brEvent.headsUpData.headsUpDisplayNotePages[current_page];\r\n    gm.display.headsUpDisplayDraw(notes);\r\n    gm.endEvent(brEvent);\r\n}\r\n//////////////////////////////////////////////////\r\n// generic menu system\r\n//////////////////////////////////////////////////\r\nfunction showGenericMenu(gm, brEvent) {\r\n    let menu_entries = brEvent.genericMenuData.menuEntriesList;\r\n    gm.input_handler = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].InputHandler.GenericMenu;\r\n    gm.display.genericMenuDraw(brEvent.genericMenuData.menuTitle, brEvent.genericMenuData.menuDescription, menu_entries, 0);\r\n    brEvent.genericMenuData.selected_index = 0;\r\n    gm.endEvent(brEvent);\r\n}\r\nfunction stopShowingGenericMenu(gm, data) {\r\n    resetHUDToGame(gm);\r\n    gm.endEvent(data);\r\n}\r\nfunction getEntryName(entry) {\r\n    let entry_text;\r\n    if (entry.entryName) {\r\n        entry_text = entry.entryName;\r\n    }\r\n    else if (entry.entryType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].GenericMenuEntryType.EventBased) {\r\n        entry_text = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType[entry.entryEvent.eventType];\r\n    }\r\n    else if (entry.entryType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].GenericMenuEntryType.InventoryItem) {\r\n        entry_text = entry.entryEvent.contextMenuData.item.getName();\r\n    }\r\n    else if (entry.entryType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].GenericMenuEntryType.ItemContextAction) {\r\n        entry_text = entry.entryEvent.itemData.item.getName();\r\n    }\r\n    else {\r\n        entry_text = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].GenericMenuEntryType[entry.entryType];\r\n    }\r\n    return entry_text;\r\n}\r\nfunction updateGenericMenu(gm, brEvent) {\r\n    let cycle_dir = brEvent.genericMenuData.direction;\r\n    let lastEventMenuData = gm.getLastEvent().genericMenuData;\r\n    let current_index = lastEventMenuData.selected_index;\r\n    let entries = lastEventMenuData.menuEntriesList;\r\n    let new_index = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].mod(current_index + cycle_dir, entries.length);\r\n    gm.display.genericMenuDraw(lastEventMenuData.menuTitle, lastEventMenuData.menuDescription, entries, new_index);\r\n    // make sure data carries over during the subsequent event\r\n    brEvent.genericMenuData.menuEntriesList = entries;\r\n    brEvent.genericMenuData.selected_index = new_index;\r\n    gm.endEvent(brEvent);\r\n}\r\nfunction selectFromGenericMenu(gm, brEvent) {\r\n    let current_index = gm.getLastEvent().genericMenuData.selected_index;\r\n    let entries = gm.getLastEvent().genericMenuData.menuEntriesList;\r\n    let activeEntry = entries[current_index];\r\n    resetHUDToGame(gm);\r\n    // grab the event attached to this entry and load it to run next\r\n    // console.log(\"finished menu, inserting this event\", activeEntry.entryEvent)\r\n    gm.insertEvent(activeEntry.entryEvent);\r\n    gm.endEvent(brEvent);\r\n}\r\n//////////////////////////////////////////////////\r\n// Confirm Paths Menu\r\n//////////////////////////////////////////////////\r\nfunction showConfirmPaths(gm, brEvent) {\r\n    // draw the highlights\r\n    gm.display.highlights.clearAll();\r\n    for (let highlight_pair of brEvent.confirmPathsData.highlights) {\r\n        // gm.display.highlights.setAt(highlight_pair.xy\r\n        gm.display.highlights.setAt(highlight_pair.xy, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].terrainFactory(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].TerrainType.Highlight, { color: highlight_pair.color }));\r\n        gm.displayList(brEvent.confirmPathsData.highlights.map((pair, index, array) => {\r\n            return pair.xy;\r\n        }));\r\n    }\r\n    gm.input_handler = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].InputHandler.ConfirmPaths;\r\n    gm.endEvent(brEvent);\r\n}\r\nfunction stopConfirmPaths(gm, highlighted_path) {\r\n    gm.display.highlights.clearAll();\r\n    gm.displayList(highlighted_path.map((pair, index, array) => {\r\n        return pair.xy;\r\n    }));\r\n    gm.input_handler = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].InputHandler.Main;\r\n}\r\nfunction finalizeConfirmPaths(gm, brEvent) {\r\n    let last_event = gm.getLastEvent();\r\n    stopConfirmPaths(gm, last_event.confirmPathsData.highlights);\r\n    gm.insertEvent(last_event.confirmPathsData.follow_event);\r\n    gm.endEvent(brEvent);\r\n}\r\nfunction cancelConfirmPaths(gm, brEvent) {\r\n    let last_event = gm.getLastEvent();\r\n    stopConfirmPaths(gm, last_event.confirmPathsData.highlights);\r\n    gm.endEvent(brEvent);\r\n}\r\nfunction getWarpBeaconMenuEvent(gm, level, terrain) {\r\n    // return a menu event for a given warp pod location\r\n    let player = gm.getPlayer();\r\n    let menuEvent = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].createGenericEventOfType(gm, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.GenericMenuOn);\r\n    let entry;\r\n    menuEvent.genericMenuData = {\r\n        menuTitle: \"Warp Pod\",\r\n        menuDescription: \"Using a warp crystal, home base can transmit items and other upgrades to your systems. Be mindful, warp crystals are only good for one use.\",\r\n        allowCancel: true,\r\n        menuEntriesList: []\r\n    };\r\n    menuEvent.genericMenuData.menuEntriesList.push({\r\n        entryName: \"Heal\",\r\n        entryDescription: \"Restore health to maximum\",\r\n        entryType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].GenericMenuEntryType.EventBased,\r\n        entryEvent: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].createGenericEventOfType(gm, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.WarpBeaconHeal)\r\n    });\r\n    menuEvent.genericMenuData.menuEntriesList.push({\r\n        entryName: \"Reinforcements\",\r\n        entryDescription: \"Warp in an allied marine squad\",\r\n        entryType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].GenericMenuEntryType.EventBased,\r\n        entryEvent: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].createGenericEventOfType(gm, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.WarpBeaconAllyDrop)\r\n    });\r\n    player.getPowers().listOfPowers.forEach((pow, index, array) => {\r\n        if ((pow.canBeRecharged) && (pow.charge_stat.getCurrentLevel() < pow.charge_stat.getMaxLevel())) {\r\n            menuEvent.genericMenuData.menuEntriesList.push({\r\n                entryName: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Glossary\"].getPowerShortName(pow) + \" RECHARGE\",\r\n                entryDescription: \"Restore this power to the maximum number of charges\",\r\n                entryType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].GenericMenuEntryType.EventBased,\r\n                entryEvent: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].addDataToEvent(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].createGenericEventOfType(gm, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.WarpBeaconRechargePower, false), {\r\n                    powerData: {\r\n                        power: pow\r\n                    }\r\n                })\r\n            });\r\n        }\r\n        if (_brew__WEBPACK_IMPORTED_MODULE_0__[\"Powers\"].canUpgradePowerCharges(pow)) {\r\n            menuEvent.genericMenuData.menuEntriesList.push({\r\n                entryName: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Glossary\"].getPowerShortName(pow) + \" INCREASE\",\r\n                entryDescription: \"Permanently increase the number of charges for this power. Also adds 1 charge.\",\r\n                entryType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].GenericMenuEntryType.EventBased,\r\n                entryEvent: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].addDataToEvent(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].createGenericEventOfType(gm, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.WarpBeaconIncreasePower, false), {\r\n                    powerData: {\r\n                        power: pow\r\n                    }\r\n                })\r\n            });\r\n        }\r\n        if (_brew__WEBPACK_IMPORTED_MODULE_0__[\"Powers\"].canUpgradePowerStrength(pow)) {\r\n            menuEvent.genericMenuData.menuEntriesList.push({\r\n                entryName: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Glossary\"].getPowerShortName(pow) + \" UPGRADE\",\r\n                entryDescription: \"Permanently increase the STRENGTH this power. Does not add new charges.\",\r\n                entryType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].GenericMenuEntryType.EventBased,\r\n                entryEvent: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].addDataToEvent(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].createGenericEventOfType(gm, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.WarpBeaconUpgradePower, false), {\r\n                    powerData: {\r\n                        power: pow\r\n                    }\r\n                })\r\n            });\r\n        }\r\n    });\r\n    return menuEvent;\r\n}\r\n//////////////////////////////////////////////////\r\n// HELP\r\n//////////////////////////////////////////////////\r\nfunction showHelpMenu(gm, brEvent) {\r\n    gm.input_handler = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].InputHandler.HelpMenu;\r\n    let current_index = brEvent.helpData.selected_index;\r\n    // let notes = brEvent.headsUpData.headsUpDisplayNotePages[current_page]\r\n    gm.display.drawHelpMenu(current_index);\r\n    gm.endEvent(brEvent);\r\n}\r\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvYnJld19nYW1lL21lbnVzLnRzP2FhZWMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBK0I7QUFFL0Isd0JBQXdCLEVBQW1CO0lBQ3ZDLEVBQUUsQ0FBQyxhQUFhLEdBQUcsMkNBQVUsQ0FBQyxZQUFZLENBQUMsSUFBSTtJQUMvQyxFQUFFLENBQUMsT0FBTyxDQUFDLFlBQVksQ0FBQywyQ0FBVSxDQUFDLFlBQVksQ0FBQyxHQUFHLENBQUM7SUFDcEQsRUFBRSxDQUFDLFVBQVUsRUFBRTtBQUNuQixDQUFDO0FBRUQsaUNBQWlDO0FBRTNCLHlCQUEwQixFQUFtQixFQUFFLE9BQThCO0lBQy9FLElBQUksbUJBQW1CLEdBQXVDLE9BQU8sQ0FBQyxlQUFlLENBQUMsWUFBWTtJQUNsRyxJQUFJLElBQUksR0FBRyxPQUFPLENBQUMsZUFBZSxDQUFDLElBQUk7SUFDdkMsSUFBSSxNQUFNLEdBQUcsT0FBTyxDQUFDLGVBQWUsQ0FBQyxNQUFNO0lBRTNDLElBQUksT0FBTyxHQUE2QyxFQUFFO0lBQzFELElBQUksU0FBUyxHQUFHLDRDQUFXLENBQUMsd0JBQXdCLENBQUMsRUFBRSxFQUFFLDJDQUFVLENBQUMsYUFBYSxDQUFDLGFBQWEsQ0FBQztJQUVoRyxtQkFBbUIsQ0FBQyxPQUFPLENBQUMsQ0FBQyxjQUEwQyxFQUFFLEtBQWEsRUFBRSxLQUFLLEVBQUUsRUFBRTtRQUM3RixJQUFJLFVBQWtDO1FBQ3RDLElBQUksU0FBUyxHQUFZLDJDQUFVLENBQUMsZUFBZSxDQUFDLGNBQWMsQ0FBQztRQUVuRSxFQUFFLENBQUMsQ0FBQyxjQUFjLElBQUksMkNBQVUsQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztZQUVwRCxVQUFVLEdBQUcsNENBQVcsQ0FBQyxjQUFjLENBQUMsNENBQVcsQ0FBQyx3QkFBd0IsQ0FBQyxFQUFFLEVBQUUsMkNBQVUsQ0FBQyxhQUFhLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxFQUFFO2dCQUNuSCxRQUFRLEVBQUU7b0JBQ04sSUFBSSxFQUFFLElBQUk7b0JBQ1YsTUFBTSxFQUFFLE1BQU07b0JBQ2QsS0FBSyxFQUFFLEVBQUUsQ0FBQyxTQUFTLEVBQUUsQ0FBQyxRQUFRLENBQUMsS0FBSyxFQUFFO2lCQUN6QzthQUNKLENBQUM7UUFFTixDQUFDO1FBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLGNBQWMsSUFBSSwyQ0FBVSxDQUFDLGVBQWUsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO1lBQzVELFVBQVUsR0FBRyw0Q0FBVyxDQUFDLHdCQUF3QixDQUFDLEVBQUUsRUFBRSwyQ0FBVSxDQUFDLGFBQWEsQ0FBQyxXQUFXLEVBQUUsS0FBSyxDQUFDO1lBQ2xHLFVBQVUsQ0FBQyxRQUFRLEdBQUc7Z0JBQ2xCLElBQUksRUFBRSxJQUFJO2dCQUNWLE1BQU0sRUFBRSxNQUFNO2FBQ2pCO1lBQ0QsVUFBVSxDQUFDLGtCQUFrQixHQUFHO2dCQUM1QixPQUFPLEVBQUUsRUFBRSxDQUFDLFNBQVMsRUFBRSxDQUFDLFFBQVE7Z0JBQ2hDLEtBQUssRUFBRSxFQUFFLENBQUMsU0FBUyxFQUFFLENBQUMsUUFBUTtnQkFDOUIsZUFBZSxFQUFFLDJDQUFVLENBQUMsbUJBQW1CLENBQUMsU0FBUzthQUM1RDtRQUVMLENBQUM7UUFBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsY0FBYyxJQUFJLDJDQUFVLENBQUMsZUFBZSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7WUFDMUQsVUFBVSxHQUFHLDRDQUFXLENBQUMsd0JBQXdCLENBQUMsRUFBRSxFQUFFLDJDQUFVLENBQUMsYUFBYSxDQUFDLE9BQU8sRUFBRSxJQUFJLENBQUM7WUFDN0YsVUFBVSxDQUFDLFFBQVEsR0FBRztnQkFDbEIsSUFBSSxFQUFFLElBQUk7Z0JBQ1YsTUFBTSxFQUFFLE1BQU07YUFDakI7UUFDTCxDQUFDO1FBQUMsSUFBSSxDQUFDLENBQUM7WUFDSixNQUFNLElBQUksS0FBSyxDQUFDLG1CQUFtQixDQUFDO1FBQ3hDLENBQUM7UUFFRCxPQUFPLENBQUMsSUFBSSxDQUFDO1lBQ1QsU0FBUyxFQUFFLDJDQUFVLENBQUMsb0JBQW9CLENBQUMsaUJBQWlCO1lBQzVELFNBQVMsRUFBRSxTQUFTO1lBQ3BCLFVBQVUsRUFBRSxVQUFVO1NBQ3pCLENBQUM7SUFDTixDQUFDLENBQUM7SUFFRixTQUFTLENBQUMsZUFBZSxHQUFHO1FBQ3hCLFNBQVMsRUFBRSxJQUFJLENBQUMsT0FBTyxFQUFFO1FBQ3pCLFdBQVcsRUFBRSxJQUFJO1FBQ2pCLGVBQWUsRUFBRSxPQUFPO0tBQzNCO0lBQ0QseURBQXlEO0lBQ3pELDZDQUE2QztJQUM3QywrQ0FBK0M7SUFDL0MsRUFBRSxDQUFDLFdBQVcsQ0FBQyxTQUFTLENBQUM7SUFDekIsRUFBRSxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUM7QUFDeEIsQ0FBQztBQUVELDhCQUE4QjtBQUV4QiwyQkFBNEIsRUFBbUIsRUFBRSxJQUEyQjtJQUM5RSxJQUFJLEdBQUcsR0FBb0IsSUFBSSxDQUFDLGFBQWEsQ0FBQyxTQUFTO0lBRXZELDJEQUEyRDtJQUMzRCxtQ0FBbUM7SUFDbkMsNkNBQTZDO0lBRTdDLElBQUksT0FBTyxHQUE2QyxFQUFFO0lBQzFELElBQUksU0FBUyxHQUFHLDRDQUFXLENBQUMsd0JBQXdCLENBQUMsRUFBRSxFQUFFLDJDQUFVLENBQUMsYUFBYSxDQUFDLGFBQWEsQ0FBQztJQUNoRyxJQUFJLEtBQTRCO0lBQ2hDLElBQUksS0FBMkI7SUFFL0IsSUFBSSxRQUFRLEdBQUcsR0FBRyxDQUFDLE9BQU8sRUFBRTtJQUM1QixRQUFRLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxFQUFFLElBQUksRUFBRSxFQUFFO1FBQ3pCLEtBQUssR0FBRyxHQUFHLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQztRQUM5QixLQUFLLEdBQUcsR0FBRyxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUM7UUFDOUIsRUFBRSxDQUFDLENBQUMsS0FBSyxDQUFDLGFBQWEsRUFBRSxJQUFJLEtBQUssQ0FBQyxhQUFhLEVBQUUsQ0FBQyxDQUFDLENBQUM7WUFDakQsTUFBTSxDQUFDLENBQUM7UUFDWixDQUFDO1FBQUMsSUFBSSxDQUFDLENBQUM7WUFDSixNQUFNLENBQUMsQ0FBQyxLQUFLLENBQUMsYUFBYSxFQUFFLEdBQUcsS0FBSyxDQUFDLGFBQWEsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ25FLENBQUM7SUFDTCxDQUFDLENBQUM7SUFFRixRQUFRLENBQUMsT0FBTyxDQUFDLENBQUMsTUFBYyxFQUFFLEtBQWEsRUFBRSxLQUFLLEVBQUUsRUFBRTtRQUN0RCxJQUFJLE9BQU8sR0FBRyxHQUFHLENBQUMscUJBQXFCLENBQUMsTUFBTSxDQUFDO1FBRS9DLE9BQU8sQ0FBQyxJQUFJLENBQUM7WUFDVCxTQUFTLEVBQUUsMkNBQVUsQ0FBQyxvQkFBb0IsQ0FBQyxhQUFhO1lBQ3hELFVBQVUsRUFBRSw0Q0FBVyxDQUFDLGNBQWMsQ0FBQyw0Q0FBVyxDQUFDLHdCQUF3QixDQUFDLEVBQUUsRUFBRSwyQ0FBVSxDQUFDLGFBQWEsQ0FBQyxhQUFhLENBQUMsRUFBRTtnQkFDckgsZUFBZSxFQUFFO29CQUNiLElBQUksRUFBRSxPQUFPLENBQUMsSUFBSTtvQkFDbEIsTUFBTSxFQUFFLE1BQU07b0JBQ2QsWUFBWSxFQUFFLENBQUMsMkNBQVUsQ0FBQyxlQUFlLENBQUMsSUFBSSxFQUFFLDJDQUFVLENBQUMsZUFBZSxDQUFDLEtBQUssQ0FBQywwRkFBeUY7aUJBQzdLO2FBQ0osQ0FBQztTQUNMLENBQUM7SUFDTixDQUFDLENBQUMsQ0FBQztJQUVILE9BQU8sQ0FBQyxJQUFJLENBQUM7UUFDVCxTQUFTLEVBQUUsMkNBQVUsQ0FBQyxvQkFBb0IsQ0FBQyxNQUFNO1FBQ2pELFNBQVMsRUFBRSxDQUFDLDRDQUFXLENBQUMsU0FBUyxHQUFHLEdBQUcsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxNQUFNLENBQUMsR0FBRyxtQkFBbUI7UUFDaEYsZ0JBQWdCLEVBQUUscUJBQXFCLEdBQUcsQ0FBQyw0Q0FBVyxDQUFDLFNBQVMsR0FBRyxHQUFHLENBQUMsUUFBUSxFQUFFLENBQUMsTUFBTSxDQUFDLEdBQUcsbUJBQW1CO1FBQy9HLFVBQVUsRUFBRSw0Q0FBVyxDQUFDLHdCQUF3QixDQUFDLEVBQUUsRUFBRSwyQ0FBVSxDQUFDLGFBQWEsQ0FBQyxjQUFjLEVBQUUsS0FBSyxDQUFDO0tBQ3ZHLENBQUM7SUFFRixTQUFTLENBQUMsZUFBZSxHQUFHO1FBQ3hCLFNBQVMsRUFBRSxXQUFXO1FBQ3RCLFdBQVcsRUFBRSxJQUFJO1FBQ2pCLGVBQWUsRUFBRSxPQUFPO0tBQzNCO0lBQ0QsRUFBRSxDQUFDLFdBQVcsQ0FBQyxTQUFTLENBQUM7SUFDekIsRUFBRSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUM7QUFDckIsQ0FBQztBQUVELGtEQUFrRDtBQUNsRCw2Q0FBNkM7QUFDN0Msa0RBQWtEO0FBRTVDLGlDQUFrQyxFQUFtQixFQUFFLE9BQThCO0lBQ3ZGLElBQUksY0FBYyxHQUFJLE9BQU8sQ0FBQyxTQUFTLENBQUMsS0FBSztJQUU3QyxJQUFJLE9BQU8sR0FBNkMsRUFBRTtJQUMxRCxJQUFJLFNBQVMsR0FBRyw0Q0FBVyxDQUFDLHdCQUF3QixDQUFDLEVBQUUsRUFBRSwyQ0FBVSxDQUFDLGFBQWEsQ0FBQyxhQUFhLENBQUM7SUFFaEcsT0FBTyxDQUFDLElBQUksQ0FBQztRQUNULFNBQVMsRUFBRSxNQUFNO1FBQ2pCLFNBQVMsRUFBRSwyQ0FBVSxDQUFDLG9CQUFvQixDQUFDLFVBQVU7UUFDckQsVUFBVSxFQUFFLDRDQUFXLENBQUMsY0FBYyxDQUFDLDRDQUFXLENBQUMsd0JBQXdCLENBQUMsRUFBRSxFQUFFLDJDQUFVLENBQUMsYUFBYSxDQUFDLHFCQUFxQixFQUFFLEtBQUssQ0FBQyxFQUFFO1lBQ3BJLFNBQVMsRUFBRTtnQkFDUCxLQUFLLEVBQUUsY0FBYzthQUN4QjtTQUNKLENBQUM7S0FDTCxDQUFDO0lBRUYsT0FBTyxDQUFDLElBQUksQ0FBQztRQUNULFNBQVMsRUFBRSxXQUFXO1FBQ3RCLFNBQVMsRUFBRSwyQ0FBVSxDQUFDLG9CQUFvQixDQUFDLFVBQVU7UUFDckQsVUFBVSxFQUFFLDRDQUFXLENBQUMsY0FBYyxDQUFDLDRDQUFXLENBQUMsd0JBQXdCLENBQUMsRUFBRSxFQUFFLDJDQUFVLENBQUMsYUFBYSxDQUFDLGNBQWMsRUFBRSxJQUFJLENBQUMsRUFBRTtZQUM1SCxTQUFTLEVBQUU7Z0JBQ1AsS0FBSyxFQUFFLGNBQWM7YUFDeEI7U0FDSixDQUFDO0tBQ0wsQ0FBQztJQUVGLFNBQVMsQ0FBQyxlQUFlLEdBQUc7UUFDeEIsU0FBUyxFQUFFLDJDQUFVLENBQUMsYUFBYSxDQUFDLGNBQWMsQ0FBQyxTQUFTLENBQUM7UUFDN0QsV0FBVyxFQUFFLElBQUk7UUFDakIsZUFBZSxFQUFFLE9BQU87S0FDM0I7SUFFRCxFQUFFLENBQUMsV0FBVyxDQUFDLFNBQVMsQ0FBQztJQUN6QixFQUFFLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQztBQUN4QixDQUFDO0FBR0QsK0NBQStDO0FBQy9DLCtKQUErSjtBQUMvSixvREFBb0Q7QUFFcEQsa0NBQWtDO0FBQ2xDLHVFQUF1RTtBQUN2RSxzQ0FBc0M7QUFFdEMsMkRBQTJEO0FBRTNELCtCQUErQjtBQUMvQixnSkFBZ0o7QUFDaEosc0VBQXNFO0FBQ3RFLDZIQUE2SDtBQUM3SCwrQkFBK0I7QUFDL0IsNENBQTRDO0FBQzVDLHFCQUFxQjtBQUNyQixtQ0FBbUM7QUFDbkMsaUNBQWlDO0FBQ2pDLG9CQUFvQjtBQUNwQixpQkFBaUI7QUFDakIsYUFBYTtBQUNiLFNBQVM7QUFFVCx1R0FBdUc7QUFDdkcsb0NBQW9DO0FBQ3BDLGlFQUFpRTtBQUNqRSw2QkFBNkI7QUFDN0IseUNBQXlDO0FBQ3pDLFFBQVE7QUFFUixnQ0FBZ0M7QUFDaEMsMkJBQTJCO0FBQzNCLElBQUk7QUFFSixrREFBa0Q7QUFDbEQsZ0JBQWdCO0FBQ2hCLGtEQUFrRDtBQUU1QyxvQ0FBcUMsRUFBbUIsRUFBRSxPQUE4QjtJQUMxRixJQUFJLEtBQUssR0FBRyxPQUFPLENBQUMsU0FBUyxDQUFDLEtBQUs7SUFDbkMsSUFBSSxPQUFPLEdBQTZDLEVBQUU7SUFFMUQsT0FBTyxDQUFDLElBQUksQ0FBQztRQUNULFNBQVMsRUFBRSwyQ0FBVSxDQUFDLG9CQUFvQixDQUFDLFVBQVU7UUFDckQsU0FBUyxFQUFFLGNBQWM7UUFDekIsZ0JBQWdCLEVBQUUsOENBQWEsQ0FBQyxZQUFZLENBQUMsS0FBSyxDQUFDO1FBQ25ELFVBQVUsRUFBRSw0Q0FBVyxDQUFDLGNBQWMsQ0FBQyw0Q0FBVyxDQUFDLHdCQUF3QixDQUFDLEVBQUUsRUFBRSwyQ0FBVSxDQUFDLGFBQWEsQ0FBQyx5QkFBeUIsRUFBRSxLQUFLLENBQUMsRUFBRTtZQUN4SSxTQUFTLEVBQUU7Z0JBQ1AsS0FBSyxFQUFFLEtBQUs7YUFDZjtTQUNKLENBQUM7S0FDTCxDQUFDO0lBRUYsT0FBTyxDQUFDLElBQUksQ0FBQztRQUNULFNBQVMsRUFBRSwyQ0FBVSxDQUFDLG9CQUFvQixDQUFDLE1BQU07UUFDakQsU0FBUyxFQUFFLFlBQVk7UUFDdkIsZ0JBQWdCLEVBQUUsOENBQWEsQ0FBQyxZQUFZLENBQUMsS0FBSyxDQUFDO1FBQ25ELFVBQVUsRUFBRSw0Q0FBVyxDQUFDLHdCQUF3QixDQUFDLEVBQUUsRUFBRSwyQ0FBVSxDQUFDLGFBQWEsQ0FBQyxjQUFjLENBQUM7S0FDaEcsQ0FBQztJQUVGLElBQUksU0FBUyxHQUFHLDRDQUFXLENBQUMsd0JBQXdCLENBQUMsRUFBRSxFQUFFLDJDQUFVLENBQUMsYUFBYSxDQUFDLGFBQWEsQ0FBQztJQUNoRyxTQUFTLENBQUMsZUFBZSxHQUFHO1FBQ3hCLFNBQVMsRUFBRSxlQUFlO1FBQzFCLFdBQVcsRUFBRSxJQUFJO1FBQ2pCLGVBQWUsRUFBRSxPQUFPO1FBQ3hCLGVBQWUsRUFBRSxzRUFBc0U7S0FDMUY7SUFFRCxFQUFFLENBQUMsV0FBVyxDQUFDLFNBQVMsQ0FBQztJQUN6QixFQUFFLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQztBQUN4QixDQUFDO0FBRUssb0NBQXFDLEVBQW1CLEVBQUUsT0FBOEI7SUFDMUYsZ0dBQWdHO0lBQ2hHLElBQUksU0FBUyxHQUFHLDRDQUFXLENBQUMsd0JBQXdCLENBQUMsRUFBRSxFQUFFLDJDQUFVLENBQUMsYUFBYSxDQUFDLGFBQWEsQ0FBQztJQUNoRyxTQUFTLENBQUMsZUFBZSxHQUFHO1FBQ3hCLFNBQVMsRUFBRSxnQkFBZ0I7UUFDM0IsV0FBVyxFQUFFLElBQUk7UUFDakIsZUFBZSxFQUFFLDhCQUE4QixDQUFDLEVBQUUsRUFBRSxPQUFPLENBQUMsS0FBSyxFQUFFLDJDQUFVLENBQUMsYUFBYSxDQUFDLG9CQUFvQixFQUFFLElBQUksRUFBRSxPQUFPLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQztLQUNuSjtJQUVELEVBQUUsQ0FBQyxXQUFXLENBQUMsU0FBUyxDQUFDO0lBQ3pCLEVBQUUsQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDO0FBQ3hCLENBQUM7QUFFSyxpQ0FBa0MsRUFBbUIsRUFBRSxPQUE4QjtJQUN2Riw4RkFBOEY7SUFDOUYsSUFBSSxTQUFTLEdBQUcsNENBQVcsQ0FBQyx3QkFBd0IsQ0FBQyxFQUFFLEVBQUUsMkNBQVUsQ0FBQyxhQUFhLENBQUMsYUFBYSxDQUFDO0lBQ2hHLFNBQVMsQ0FBQyxlQUFlLEdBQUc7UUFDeEIsU0FBUyxFQUFFLFlBQVk7UUFDdkIsV0FBVyxFQUFFLElBQUk7UUFDakIsZUFBZSxFQUFFLDhCQUE4QixDQUFDLEVBQUUsRUFBRSxPQUFPLENBQUMsS0FBSyxFQUFFLDJDQUFVLENBQUMsYUFBYSxDQUFDLGlCQUFpQixFQUFFLEtBQUssRUFBRSxPQUFPLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQztLQUNqSjtJQUVELEVBQUUsQ0FBQyxXQUFXLENBQUMsU0FBUyxDQUFDO0lBQ3pCLEVBQUUsQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDO0FBRXhCLENBQUM7QUFFRCxrREFBa0Q7QUFDbEQsYUFBYTtBQUNiLGtEQUFrRDtBQUU1Qyx3Q0FBeUMsRUFBbUIsRUFBRSxVQUFtQyxFQUFFLGdCQUEwQyxFQUFFLGFBQXNCLEVBQUUsYUFBaUM7SUFDMU0sOEJBQThCO0lBQzlCLElBQUksYUFBYSxHQUE2QyxFQUFFO0lBQ2hFLElBQUksTUFBTSxHQUFHLFVBQVUsQ0FBQyxTQUFTLEVBQUU7SUFFbkMsSUFBSSxTQUE2QjtJQUNqQyxJQUFJLFNBQTZCO0lBQ2pDLElBQUksS0FBd0M7SUFFNUMsTUFBTSxDQUFDLFlBQVksQ0FBQyxPQUFPLENBQUMsQ0FBQyxHQUFHLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxFQUFFO1FBQzlDLEtBQUssR0FBRztZQUVKLFNBQVMsRUFBRSw4Q0FBYSxDQUFDLFlBQVksQ0FBQyxHQUFHLENBQUM7WUFDMUMsU0FBUyxFQUFFLDJDQUFVLENBQUMsb0JBQW9CLENBQUMsVUFBVTtZQUNyRCxVQUFVLEVBQUUsNENBQVcsQ0FBQyxjQUFjLENBQUMsNENBQVcsQ0FBQyx3QkFBd0IsQ0FBQyxFQUFFLEVBQUUsZ0JBQWdCLEVBQUUsYUFBYSxDQUFDLEVBQUU7Z0JBQzlHLFNBQVMsRUFBRTtvQkFDUCxLQUFLLEVBQUUsYUFBYSxDQUFDLENBQUMsQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDLEdBQUc7aUJBQzdDO2FBQ0osQ0FBQztZQUNGLGdCQUFnQixFQUFFLDhDQUFhLENBQUMsWUFBWSxDQUFDLEdBQUcsQ0FBQztTQUNwRDtRQUVELEVBQUUsQ0FBQyxDQUFDLGFBQWEsQ0FBQyxDQUFDLENBQUM7WUFDaEIsS0FBSyxDQUFDLFVBQVUsQ0FBQyxhQUFhLEdBQUc7Z0JBQzdCLEtBQUssRUFBRSxHQUFHO2FBQ2I7UUFDTCxDQUFDO1FBRUQsYUFBYSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUM7SUFDN0IsQ0FBQyxDQUFDO0lBRUYsTUFBTSxDQUFDLGFBQWE7QUFDeEIsQ0FBQztBQUdELGtEQUFrRDtBQUNsRCxNQUFNO0FBQ04sa0RBQWtEO0FBRTVDLDRCQUE2QixFQUFtQixFQUFFLE9BQThCO0lBRWxGLEVBQUUsQ0FBQyxhQUFhLEdBQUcsMkNBQVUsQ0FBQyxZQUFZLENBQUMsY0FBYztJQUV6RCxJQUFJLFlBQVksR0FBRyxPQUFPLENBQUMsV0FBVyxDQUFDLGNBQWM7SUFDckQsSUFBSSxLQUFLLEdBQUcsT0FBTyxDQUFDLFdBQVcsQ0FBQyx1QkFBdUIsQ0FBQyxZQUFZLENBQUM7SUFDckUsRUFBRSxDQUFDLE9BQU8sQ0FBQyxrQkFBa0IsQ0FBQyxLQUFLLENBQUM7SUFFcEMsRUFBRSxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUM7QUFDeEIsQ0FBQztBQUVELGtEQUFrRDtBQUNsRCxzQkFBc0I7QUFDdEIsa0RBQWtEO0FBRTVDLHlCQUEwQixFQUFtQixFQUFFLE9BQThCO0lBRS9FLElBQUksWUFBWSxHQUFHLE9BQU8sQ0FBQyxlQUFlLENBQUMsZUFBZTtJQUUxRCxFQUFFLENBQUMsYUFBYSxHQUFHLDJDQUFVLENBQUMsWUFBWSxDQUFDLFdBQVc7SUFDdEQsRUFBRSxDQUFDLE9BQU8sQ0FBQyxlQUFlLENBQUMsT0FBTyxDQUFDLGVBQWUsQ0FBQyxTQUFTLEVBQUUsT0FBTyxDQUFDLGVBQWUsQ0FBQyxlQUFlLEVBQUUsWUFBWSxFQUFFLENBQUMsQ0FBQztJQUN2SCxPQUFPLENBQUMsZUFBZSxDQUFDLGNBQWMsR0FBRyxDQUFDO0lBRTFDLEVBQUUsQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDO0FBQ3hCLENBQUM7QUFFSyxnQ0FBaUMsRUFBbUIsRUFBRSxJQUEyQjtJQUNuRixjQUFjLENBQUMsRUFBRSxDQUFDO0lBQ2xCLEVBQUUsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDO0FBQ3JCLENBQUM7QUFFSyxzQkFBdUIsS0FBd0M7SUFDakUsSUFBSSxVQUFtQjtJQUV2QixFQUFFLENBQUMsQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQztRQUNsQixVQUFVLEdBQUcsS0FBSyxDQUFDLFNBQVM7SUFFaEMsQ0FBQztJQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxLQUFLLENBQUMsU0FBUyxJQUFJLDJDQUFVLENBQUMsb0JBQW9CLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQztRQUN2RSxVQUFVLEdBQUcsMkNBQVUsQ0FBQyxhQUFhLENBQUMsS0FBSyxDQUFDLFVBQVUsQ0FBQyxTQUFTLENBQUM7SUFDckUsQ0FBQztJQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxLQUFLLENBQUMsU0FBUyxJQUFJLDJDQUFVLENBQUMsb0JBQW9CLENBQUMsYUFBYSxDQUFDLENBQUMsQ0FBQztRQUMxRSxVQUFVLEdBQUcsS0FBSyxDQUFDLFVBQVUsQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRTtJQUNoRSxDQUFDO0lBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEtBQUssQ0FBQyxTQUFTLElBQUksMkNBQVUsQ0FBQyxvQkFBb0IsQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDLENBQUM7UUFDOUUsVUFBVSxHQUFHLEtBQUssQ0FBQyxVQUFVLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUU7SUFDekQsQ0FBQztJQUFDLElBQUksQ0FBQyxDQUFDO1FBQ0osVUFBVSxHQUFHLDJDQUFVLENBQUMsb0JBQW9CLENBQUMsS0FBSyxDQUFDLFNBQVMsQ0FBQztJQUNqRSxDQUFDO0lBRUQsTUFBTSxDQUFDLFVBQVU7QUFDckIsQ0FBQztBQUVLLDJCQUE0QixFQUFtQixFQUFFLE9BQThCO0lBQ2pGLElBQUksU0FBUyxHQUFHLE9BQU8sQ0FBQyxlQUFlLENBQUMsU0FBUztJQUNqRCxJQUFJLGlCQUFpQixHQUFJLEVBQUUsQ0FBQyxZQUFZLEVBQUUsQ0FBQyxlQUFlO0lBQzFELElBQUksYUFBYSxHQUFHLGlCQUFpQixDQUFDLGNBQWM7SUFDcEQsSUFBSSxPQUFPLEdBQUcsaUJBQWlCLENBQUMsZUFBZTtJQUUvQyxJQUFJLFNBQVMsR0FBRywyQ0FBVSxDQUFDLEdBQUcsQ0FBQyxhQUFhLEdBQUcsU0FBUyxFQUFFLE9BQU8sQ0FBQyxNQUFNLENBQUM7SUFFekUsRUFBRSxDQUFDLE9BQU8sQ0FBQyxlQUFlLENBQUMsaUJBQWlCLENBQUMsU0FBUyxFQUFFLGlCQUFpQixDQUFDLGVBQWUsRUFBRSxPQUFPLEVBQUUsU0FBUyxDQUFDO0lBRTlHLDBEQUEwRDtJQUMxRCxPQUFPLENBQUMsZUFBZSxDQUFDLGVBQWUsR0FBRyxPQUFPO0lBQ2pELE9BQU8sQ0FBQyxlQUFlLENBQUMsY0FBYyxHQUFHLFNBQVM7SUFFbEQsRUFBRSxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUM7QUFDeEIsQ0FBQztBQUVLLCtCQUFnQyxFQUFtQixFQUFFLE9BQThCO0lBQ3JGLElBQUksYUFBYSxHQUFZLEVBQUUsQ0FBQyxZQUFZLEVBQUUsQ0FBQyxlQUFlLENBQUMsY0FBYztJQUM3RSxJQUFJLE9BQU8sR0FBRyxFQUFFLENBQUMsWUFBWSxFQUFFLENBQUMsZUFBZSxDQUFDLGVBQWU7SUFFL0QsSUFBSSxXQUFXLEdBQUcsT0FBTyxDQUFDLGFBQWEsQ0FBQztJQUV4QyxjQUFjLENBQUMsRUFBRSxDQUFDO0lBQ2xCLGdFQUFnRTtJQUNoRSw2RUFBNkU7SUFDN0UsRUFBRSxDQUFDLFdBQVcsQ0FBQyxXQUFXLENBQUMsVUFBVSxDQUFDO0lBQ3RDLEVBQUUsQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDO0FBQ3hCLENBQUM7QUFFRCxrREFBa0Q7QUFDbEQscUJBQXFCO0FBQ3JCLGtEQUFrRDtBQUM1QywwQkFBMkIsRUFBbUIsRUFBRSxPQUE4QjtJQUNoRixzQkFBc0I7SUFDdEIsRUFBRSxDQUFDLE9BQU8sQ0FBQyxVQUFVLENBQUMsUUFBUSxFQUFFO0lBQ2hDLEdBQUcsQ0FBQyxDQUFDLElBQUksY0FBYyxJQUFJLE9BQU8sQ0FBQyxnQkFBZ0IsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDO1FBQzdELGdEQUFnRDtRQUNoRCxFQUFFLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQyxLQUFLLENBQUMsY0FBYyxDQUFDLEVBQUUsRUFBRSxpREFBZ0IsQ0FBQyxjQUFjLENBQUMsaURBQWdCLENBQUMsV0FBVyxDQUFDLFNBQVMsRUFBRSxFQUFFLEtBQUssRUFBRSxjQUFjLENBQUMsS0FBSyxFQUFFLENBQUUsQ0FBQztRQUN6SixFQUFFLENBQUMsV0FBVyxDQUFDLE9BQU8sQ0FBQyxnQkFBZ0IsQ0FBQyxVQUFVLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBcUMsRUFBRSxLQUFhLEVBQUUsS0FBSyxFQUFFLEVBQUU7WUFDbkgsTUFBTSxDQUFDLElBQUksQ0FBQyxFQUFFO1FBQ2xCLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQztJQUNELEVBQUUsQ0FBQyxhQUFhLEdBQUcsMkNBQVUsQ0FBQyxZQUFZLENBQUMsWUFBWTtJQUN2RCxFQUFFLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQztBQUN4QixDQUFDO0FBRUQsMEJBQTBCLEVBQW1CLEVBQUUsZ0JBQXlEO0lBQ3BHLEVBQUUsQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFDLFFBQVEsRUFBRTtJQUNoQyxFQUFFLENBQUMsV0FBVyxDQUFDLGdCQUFnQixDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQXFDLEVBQUUsS0FBYSxFQUFFLEtBQUssRUFBRSxFQUFFO1FBQ2hHLE1BQU0sQ0FBQyxJQUFJLENBQUMsRUFBRTtJQUNsQixDQUFDLENBQUMsQ0FBQztJQUVILEVBQUUsQ0FBQyxhQUFhLEdBQUcsMkNBQVUsQ0FBQyxZQUFZLENBQUMsSUFBSTtBQUNuRCxDQUFDO0FBRUssOEJBQStCLEVBQW1CLEVBQUUsT0FBOEI7SUFDcEYsSUFBSSxVQUFVLEdBQUcsRUFBRSxDQUFDLFlBQVksRUFBRTtJQUVsQyxnQkFBZ0IsQ0FBQyxFQUFFLEVBQUUsVUFBVSxDQUFDLGdCQUFnQixDQUFDLFVBQVUsQ0FBQztJQUM1RCxFQUFFLENBQUMsV0FBVyxDQUFDLFVBQVUsQ0FBQyxnQkFBZ0IsQ0FBQyxZQUFZLENBQUM7SUFDeEQsRUFBRSxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUM7QUFDeEIsQ0FBQztBQUVLLDRCQUE2QixFQUFtQixFQUFFLE9BQThCO0lBQ2xGLElBQUksVUFBVSxHQUFHLEVBQUUsQ0FBQyxZQUFZLEVBQUU7SUFFbEMsZ0JBQWdCLENBQUMsRUFBRSxFQUFFLFVBQVUsQ0FBQyxnQkFBZ0IsQ0FBQyxVQUFVLENBQUM7SUFDNUQsRUFBRSxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUM7QUFDeEIsQ0FBQztBQUVLLGdDQUFpQyxFQUFtQixFQUFFLEtBQWlCLEVBQUUsT0FBZ0M7SUFDM0csb0RBQW9EO0lBQ3BELElBQUksTUFBTSxHQUFHLEVBQUUsQ0FBQyxTQUFTLEVBQUU7SUFDM0IsSUFBSSxTQUFTLEdBQUcsNENBQVcsQ0FBQyx3QkFBd0IsQ0FBQyxFQUFFLEVBQUUsMkNBQVUsQ0FBQyxhQUFhLENBQUMsYUFBYSxDQUFDO0lBQ2hHLElBQUksS0FBd0M7SUFFNUMsU0FBUyxDQUFDLGVBQWUsR0FBRztRQUN4QixTQUFTLEVBQUUsVUFBVTtRQUNyQixlQUFlLEVBQUUsNklBQTZJO1FBQzlKLFdBQVcsRUFBRSxJQUFJO1FBQ2pCLGVBQWUsRUFBRSxFQUFFO0tBQ3RCO0lBRUQsU0FBUyxDQUFDLGVBQWUsQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDO1FBQzNDLFNBQVMsRUFBRSxNQUFNO1FBQ2pCLGdCQUFnQixFQUFFLDJCQUEyQjtRQUM3QyxTQUFTLEVBQUUsMkNBQVUsQ0FBQyxvQkFBb0IsQ0FBQyxVQUFVO1FBQ3JELFVBQVUsRUFBRSw0Q0FBVyxDQUFDLHdCQUF3QixDQUFDLEVBQUUsRUFBRSwyQ0FBVSxDQUFDLGFBQWEsQ0FBQyxjQUFjLENBQUM7S0FDaEcsQ0FBQztJQUVGLFNBQVMsQ0FBQyxlQUFlLENBQUMsZUFBZSxDQUFDLElBQUksQ0FBQztRQUMzQyxTQUFTLEVBQUUsZ0JBQWdCO1FBQzNCLGdCQUFnQixFQUFFLGdDQUFnQztRQUNsRCxTQUFTLEVBQUUsMkNBQVUsQ0FBQyxvQkFBb0IsQ0FBQyxVQUFVO1FBQ3JELFVBQVUsRUFBRSw0Q0FBVyxDQUFDLHdCQUF3QixDQUFDLEVBQUUsRUFBRSwyQ0FBVSxDQUFDLGFBQWEsQ0FBQyxrQkFBa0IsQ0FBQztLQUNwRyxDQUFDO0lBRUYsTUFBTSxDQUFDLFNBQVMsRUFBRSxDQUFDLFlBQVksQ0FBQyxPQUFPLENBQUMsQ0FBQyxHQUFHLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxFQUFFO1FBQzFELEVBQUUsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLFdBQVcsQ0FBQyxlQUFlLEVBQUUsR0FBRyxHQUFHLENBQUMsV0FBVyxDQUFDLFdBQVcsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQzlGLFNBQVMsQ0FBQyxlQUFlLENBQUMsZUFBZSxDQUFDLElBQUksQ0FBQztnQkFDM0MsU0FBUyxFQUFFLDhDQUFhLENBQUMsaUJBQWlCLENBQUMsR0FBRyxDQUFDLEdBQUcsV0FBVztnQkFDN0QsZ0JBQWdCLEVBQUUscURBQXFEO2dCQUN2RSxTQUFTLEVBQUUsMkNBQVUsQ0FBQyxvQkFBb0IsQ0FBQyxVQUFVO2dCQUNyRCxVQUFVLEVBQUUsNENBQVcsQ0FBQyxjQUFjLENBQUMsNENBQVcsQ0FBQyx3QkFBd0IsQ0FBQyxFQUFFLEVBQUUsMkNBQVUsQ0FBQyxhQUFhLENBQUMsdUJBQXVCLEVBQUUsS0FBSyxDQUFDLEVBQUU7b0JBQ3RJLFNBQVMsRUFBRTt3QkFDUCxLQUFLLEVBQUUsR0FBRztxQkFDYjtpQkFDSixDQUFDO2FBQ0wsQ0FBQztRQUNOLENBQUM7UUFFRCxFQUFFLENBQUMsQ0FBQyw0Q0FBVyxDQUFDLHNCQUFzQixDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUMxQyxTQUFTLENBQUMsZUFBZSxDQUFDLGVBQWUsQ0FBQyxJQUFJLENBQUM7Z0JBQzNDLFNBQVMsRUFBRSw4Q0FBYSxDQUFDLGlCQUFpQixDQUFDLEdBQUcsQ0FBQyxHQUFHLFdBQVc7Z0JBQzdELGdCQUFnQixFQUFFLGdGQUFnRjtnQkFDbEcsU0FBUyxFQUFFLDJDQUFVLENBQUMsb0JBQW9CLENBQUMsVUFBVTtnQkFDckQsVUFBVSxFQUFFLDRDQUFXLENBQUMsY0FBYyxDQUFDLDRDQUFXLENBQUMsd0JBQXdCLENBQUMsRUFBRSxFQUFFLDJDQUFVLENBQUMsYUFBYSxDQUFDLHVCQUF1QixFQUFFLEtBQUssQ0FBQyxFQUFFO29CQUN0SSxTQUFTLEVBQUU7d0JBQ1AsS0FBSyxFQUFFLEdBQUc7cUJBQ2I7aUJBQ0osQ0FBQzthQUNMLENBQUM7UUFDTixDQUFDO1FBRUQsRUFBRSxDQUFDLENBQUMsNENBQVcsQ0FBQyx1QkFBdUIsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDM0MsU0FBUyxDQUFDLGVBQWUsQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDO2dCQUMzQyxTQUFTLEVBQUUsOENBQWEsQ0FBQyxpQkFBaUIsQ0FBQyxHQUFHLENBQUMsR0FBRyxVQUFVO2dCQUM1RCxnQkFBZ0IsRUFBRSx5RUFBeUU7Z0JBQzNGLFNBQVMsRUFBRSwyQ0FBVSxDQUFDLG9CQUFvQixDQUFDLFVBQVU7Z0JBQ3JELFVBQVUsRUFBRSw0Q0FBVyxDQUFDLGNBQWMsQ0FBQyw0Q0FBVyxDQUFDLHdCQUF3QixDQUFDLEVBQUUsRUFBRSwyQ0FBVSxDQUFDLGFBQWEsQ0FBQyxzQkFBc0IsRUFBRSxLQUFLLENBQUMsRUFBRTtvQkFDckksU0FBUyxFQUFFO3dCQUNQLEtBQUssRUFBRSxHQUFHO3FCQUNiO2lCQUNKLENBQUM7YUFDTCxDQUFDO1FBQ04sQ0FBQztJQUVMLENBQUMsQ0FBQztJQUdGLE1BQU0sQ0FBQyxTQUFTO0FBRXBCLENBQUM7QUFFRCxrREFBa0Q7QUFDbEQsT0FBTztBQUNQLGtEQUFrRDtBQUU1QyxzQkFBdUIsRUFBbUIsRUFBRSxPQUE4QjtJQUU1RSxFQUFFLENBQUMsYUFBYSxHQUFHLDJDQUFVLENBQUMsWUFBWSxDQUFDLFFBQVE7SUFFbkQsSUFBSSxhQUFhLEdBQUcsT0FBTyxDQUFDLFFBQVEsQ0FBQyxjQUFjO0lBQ25ELHdFQUF3RTtJQUN4RSxFQUFFLENBQUMsT0FBTyxDQUFDLFlBQVksQ0FBQyxhQUFhLENBQUM7SUFFdEMsRUFBRSxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUM7QUFDeEIsQ0FBQyIsImZpbGUiOiIuL3NyYy9icmV3X2dhbWUvbWVudXMudHMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBCcmV3IGZyb20gXCIuLi9icmV3XCJcclxuXHJcbmZ1bmN0aW9uIHJlc2V0SFVEVG9HYW1lKGdtOiBCcmV3LkdhbWVNYXN0ZXIpIHtcclxuICAgIGdtLmlucHV0X2hhbmRsZXIgPSBCcmV3LkVudW1zLklucHV0SGFuZGxlci5NYWluXHJcbiAgICBnbS5kaXNwbGF5LmNsZWFyRGlzcGxheShCcmV3LkVudW1zLkRpc3BsYXlOYW1lcy5IVUQpXHJcbiAgICBnbS5kaXNwbGF5QWxsKClcclxufVxyXG4gICAgXHJcbi8vLy8vLy8vLy8vLy8vLy8vLy8vIGNvbnRleHQgbWVudVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHNob3dDb250ZXh0TWVudShnbTogQnJldy5HYW1lTWFzdGVyLCBickV2ZW50OiBCcmV3LkVudW1zLklCcmV3RXZlbnQpIHtcclxuICAgIGxldCBjb250ZXh0X2FjdGlvbl9saXN0IDogQXJyYXk8QnJldy5FbnVtcy5Db250ZXh0TWVudUl0ZW0+ID0gYnJFdmVudC5jb250ZXh0TWVudURhdGEuY29udGV4dF9saXN0XHJcbiAgICBsZXQgaXRlbSA9IGJyRXZlbnQuY29udGV4dE1lbnVEYXRhLml0ZW1cclxuICAgIGxldCBpbnZrZXkgPSBickV2ZW50LmNvbnRleHRNZW51RGF0YS5pbnZrZXlcclxuXHJcbiAgICBsZXQgZW50cmllcyA6IEFycmF5PEJyZXcuRW51bXMuSUJyZXdHZW5lcmljTWVudUVudHJ5PiA9IFtdXHJcbiAgICBsZXQgbWVudUV2ZW50ID0gQnJldy5FdmVudHMuY3JlYXRlR2VuZXJpY0V2ZW50T2ZUeXBlKGdtLCBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuR2VuZXJpY01lbnVPbilcclxuXHJcbiAgICBjb250ZXh0X2FjdGlvbl9saXN0LmZvckVhY2goKGNvbnRleHRfYWN0aW9uOiBCcmV3LkVudW1zLkNvbnRleHRNZW51SXRlbSwgaW5kZXg6IG51bWJlciwgYXJyYXkpID0+IHtcclxuICAgICAgICBsZXQgZW50cnlFdmVudCA6IEJyZXcuRW51bXMuSUJyZXdFdmVudFxyXG4gICAgICAgIGxldCBlbnRyeU5hbWUgOiBzdHJpbmcgPSBCcmV3LkVudW1zLkNvbnRleHRNZW51SXRlbVtjb250ZXh0X2FjdGlvbl1cclxuXHJcbiAgICAgICAgaWYgKGNvbnRleHRfYWN0aW9uID09IEJyZXcuRW51bXMuQ29udGV4dE1lbnVJdGVtLkRyb3ApIHtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGVudHJ5RXZlbnQgPSBCcmV3LkV2ZW50cy5hZGREYXRhVG9FdmVudChCcmV3LkV2ZW50cy5jcmVhdGVHZW5lcmljRXZlbnRPZlR5cGUoZ20sIEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5Ecm9wLCB0cnVlKSwge1xyXG4gICAgICAgICAgICAgICAgaXRlbURhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICBpdGVtOiBpdGVtLFxyXG4gICAgICAgICAgICAgICAgICAgIGludmtleTogaW52a2V5LFxyXG4gICAgICAgICAgICAgICAgICAgIHRvX3h5OiBnbS5nZXRQbGF5ZXIoKS5sb2NhdGlvbi5jbG9uZSgpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcblxyXG4gICAgICAgIH0gZWxzZSBpZiAoY29udGV4dF9hY3Rpb24gPT0gQnJldy5FbnVtcy5Db250ZXh0TWVudUl0ZW0uVGhyb3cpIHtcclxuICAgICAgICAgICAgZW50cnlFdmVudCA9IEJyZXcuRXZlbnRzLmNyZWF0ZUdlbmVyaWNFdmVudE9mVHlwZShnbSwgQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLlRhcmdldGluZ09uLCBmYWxzZSlcclxuICAgICAgICAgICAgZW50cnlFdmVudC5pdGVtRGF0YSA9IHtcclxuICAgICAgICAgICAgICAgIGl0ZW06IGl0ZW0sXHJcbiAgICAgICAgICAgICAgICBpbnZrZXk6IGludmtleVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVudHJ5RXZlbnQuc3RhcnRUYXJnZXRpbmdEYXRhID0ge1xyXG4gICAgICAgICAgICAgICAgZnJvbV94eTogZ20uZ2V0UGxheWVyKCkubG9jYXRpb24sXHJcbiAgICAgICAgICAgICAgICB0b194eTogZ20uZ2V0UGxheWVyKCkubG9jYXRpb24sIC8vIHRvZG86IG5lZWQgY29kZSB0byBmaW5kIG5lYXJlc3QgbG9naWNhbCB0YXJnZXRcclxuICAgICAgICAgICAgICAgIHRhcmdldGluZ0FjdGlvbjogQnJldy5FbnVtcy5CcmV3VGFyZ2V0aW5nQWN0aW9uLlRocm93SXRlbVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICB9IGVsc2UgaWYgKGNvbnRleHRfYWN0aW9uID09IEJyZXcuRW51bXMuQ29udGV4dE1lbnVJdGVtLlVzZSkge1xyXG4gICAgICAgICAgICBlbnRyeUV2ZW50ID0gQnJldy5FdmVudHMuY3JlYXRlR2VuZXJpY0V2ZW50T2ZUeXBlKGdtLCBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuVXNlSXRlbSwgdHJ1ZSlcclxuICAgICAgICAgICAgZW50cnlFdmVudC5pdGVtRGF0YSA9IHtcclxuICAgICAgICAgICAgICAgIGl0ZW06IGl0ZW0sXHJcbiAgICAgICAgICAgICAgICBpbnZrZXk6IGludmtleVxyXG4gICAgICAgICAgICB9ICAgICAgICAgICAgICAgIFxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcImJhZCBjb250ZXh0IGdpdmVuXCIpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBlbnRyaWVzLnB1c2goe1xyXG4gICAgICAgICAgICBlbnRyeVR5cGU6IEJyZXcuRW51bXMuR2VuZXJpY01lbnVFbnRyeVR5cGUuSXRlbUNvbnRleHRBY3Rpb24sXHJcbiAgICAgICAgICAgIGVudHJ5TmFtZTogZW50cnlOYW1lLFxyXG4gICAgICAgICAgICBlbnRyeUV2ZW50OiBlbnRyeUV2ZW50XHJcbiAgICAgICAgfSlcclxuICAgIH0pXHJcbiAgICBcclxuICAgIG1lbnVFdmVudC5nZW5lcmljTWVudURhdGEgPSB7XHJcbiAgICAgICAgbWVudVRpdGxlOiBpdGVtLmdldE5hbWUoKSxcclxuICAgICAgICBhbGxvd0NhbmNlbDogdHJ1ZSxcclxuICAgICAgICBtZW51RW50cmllc0xpc3Q6IGVudHJpZXNcclxuICAgIH1cclxuICAgIC8vIGdtLmlucHV0X2hhbmRsZXIgPSBCcmV3LkVudW1zLklucHV0SGFuZGxlci5Db250ZXh0TWVudVxyXG4gICAgLy8gZ20uZGlzcGxheS5jb250ZXh0TWVudURyYXcoY29udGV4dExpc3QsIDApXHJcbiAgICAvLyBkYXRhLmNvbnRleHRNZW51RGF0YS5zZWxlY3RlZF9pdGVtX2luZGV4ID0gMFxyXG4gICAgZ20uaW5zZXJ0RXZlbnQobWVudUV2ZW50KVxyXG4gICAgZ20uZW5kRXZlbnQoYnJFdmVudClcclxufVxyXG5cclxuLy8vLy8vLy8vLy8vLy8vLy8vLy8gaW52ZW50b3J5XHJcbiAgICBcclxuZXhwb3J0IGZ1bmN0aW9uIHNob3dJbnZlbnRvcnlMaXN0KGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGRhdGE6IEJyZXcuRW51bXMuSUJyZXdFdmVudCkge1xyXG4gICAgbGV0IGludiA6IEJyZXcuSW52ZW50b3J5ID0gZGF0YS5pbnZlbnRvcnlEYXRhLmludmVudG9yeVxyXG4gICAgXHJcbiAgICAvLyBnbS5pbnB1dF9oYW5kbGVyID0gQnJldy5FbnVtcy5JbnB1dEhhbmRsZXIuSW52ZW50b3J5TGlzdFxyXG4gICAgLy8gZ20uZGlzcGxheS5pbnZlbnRvcnlEcmF3KGludiwgMClcclxuICAgIC8vIGRhdGEuaW52ZW50b3J5RGF0YS5zZWxlY3RlZF9pdGVtX2luZGV4ID0gMFxyXG5cclxuICAgIGxldCBlbnRyaWVzIDogQXJyYXk8QnJldy5FbnVtcy5JQnJld0dlbmVyaWNNZW51RW50cnk+ID0gW11cclxuICAgIGxldCBtZW51RXZlbnQgPSBCcmV3LkV2ZW50cy5jcmVhdGVHZW5lcmljRXZlbnRPZlR5cGUoZ20sIEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5HZW5lcmljTWVudU9uKVxyXG4gICAgbGV0IGl0ZW0xIDogQnJldy5HcmlkVGhpbmdzLkl0ZW1cclxuICAgIGxldCBpdGVtMjogQnJldy5HcmlkVGhpbmdzLkl0ZW1cclxuXHJcbiAgICBsZXQgaW52X2tleXMgPSBpbnYuZ2V0S2V5cygpXHJcbiAgICBpbnZfa2V5cy5zb3J0KChrZXkxLCBrZXkyKSA9PiB7XHJcbiAgICAgICAgaXRlbTEgPSBpbnYuZ2V0SXRlbUJ5S2V5KGtleTEpXHJcbiAgICAgICAgaXRlbTIgPSBpbnYuZ2V0SXRlbUJ5S2V5KGtleTIpXHJcbiAgICAgICAgaWYgKGl0ZW0xLmdldERlZmluaXRpb24oKSA9PSBpdGVtMi5nZXREZWZpbml0aW9uKCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIDBcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gKGl0ZW0xLmdldERlZmluaXRpb24oKSA8IGl0ZW0yLmdldERlZmluaXRpb24oKSkgPyAtMSA6IDFcclxuICAgICAgICB9XHJcbiAgICB9KVxyXG4gICAgXHJcbiAgICBpbnZfa2V5cy5mb3JFYWNoKChpbnZrZXk6IHN0cmluZywgaW5kZXg6IG51bWJlciwgYXJyYXkpID0+IHtcclxuICAgICAgICBsZXQgaW52aXRlbSA9IGludi5nZXRJbnZlbnRvcnlJdGVtQnlLZXkoaW52a2V5KVxyXG4gICAgICAgIFxyXG4gICAgICAgIGVudHJpZXMucHVzaCh7XHJcbiAgICAgICAgICAgIGVudHJ5VHlwZTogQnJldy5FbnVtcy5HZW5lcmljTWVudUVudHJ5VHlwZS5JbnZlbnRvcnlJdGVtLFxyXG4gICAgICAgICAgICBlbnRyeUV2ZW50OiBCcmV3LkV2ZW50cy5hZGREYXRhVG9FdmVudChCcmV3LkV2ZW50cy5jcmVhdGVHZW5lcmljRXZlbnRPZlR5cGUoZ20sIEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5Db250ZXh0TWVudU9uKSwge1xyXG4gICAgICAgICAgICAgICAgY29udGV4dE1lbnVEYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaXRlbTogaW52aXRlbS5pdGVtLFxyXG4gICAgICAgICAgICAgICAgICAgIGludmtleTogaW52a2V5LFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHRfbGlzdDogW0JyZXcuRW51bXMuQ29udGV4dE1lbnVJdGVtLkRyb3AsIEJyZXcuRW51bXMuQ29udGV4dE1lbnVJdGVtLlRocm93XS8vLCBCcmV3LkVudW1zLkNvbnRleHRNZW51SXRlbS5Vc2VdLy90b2RvOiBmaWd1cmUgb3V0IGFsbG93ZWQgY29udGV4dHMgYmFzZWQgb24gaXRlbSB0eXBlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSlcclxuICAgIH0pO1xyXG5cclxuICAgIGVudHJpZXMucHVzaCh7XHJcbiAgICAgICAgZW50cnlUeXBlOiBCcmV3LkVudW1zLkdlbmVyaWNNZW51RW50cnlUeXBlLkNhbmNlbCxcclxuICAgICAgICBlbnRyeU5hbWU6IChCcmV3LkNvbmZpZy5tYXhfaXRlbXMgLSBpbnYuZ2V0SXRlbXMoKS5sZW5ndGgpICsgXCIgc3BhY2VzIHJlbWFpbmluZ1wiLFxyXG4gICAgICAgIGVudHJ5RGVzY3JpcHRpb246IFwiWW91ciBpbnZlbnRvcnkgaGFzIFwiICsgKEJyZXcuQ29uZmlnLm1heF9pdGVtcyAtIGludi5nZXRJdGVtcygpLmxlbmd0aCkgKyBcIiBzcGFjZXMgcmVtYWluaW5nXCIsXHJcbiAgICAgICAgZW50cnlFdmVudDogQnJldy5FdmVudHMuY3JlYXRlR2VuZXJpY0V2ZW50T2ZUeXBlKGdtLCBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuR2VuZXJpY01lbnVPZmYsIGZhbHNlKVxyXG4gICAgfSlcclxuXHJcbiAgICBtZW51RXZlbnQuZ2VuZXJpY01lbnVEYXRhID0ge1xyXG4gICAgICAgIG1lbnVUaXRsZTogXCJJbnZlbnRvcnlcIixcclxuICAgICAgICBhbGxvd0NhbmNlbDogdHJ1ZSxcclxuICAgICAgICBtZW51RW50cmllc0xpc3Q6IGVudHJpZXNcclxuICAgIH1cclxuICAgIGdtLmluc2VydEV2ZW50KG1lbnVFdmVudClcclxuICAgIGdtLmVuZEV2ZW50KGRhdGEpXHJcbn1cclxuXHJcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcbi8vIHBvd2VyIG1hbmFnZW1lbnQgc2NyZWVuICsgdW5pbnN0YWxsICsgc3dhcFxyXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHNob3dQb3dlck1hbmFnZW1lbnRNZW51KGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGJyRXZlbnQ6IEJyZXcuRW51bXMuSUJyZXdFdmVudCkge1xyXG4gICAgbGV0IHNlbGVjdGVkX3Bvd2VyICA9IGJyRXZlbnQucG93ZXJEYXRhLnBvd2VyXHJcblxyXG4gICAgbGV0IGVudHJpZXMgOiBBcnJheTxCcmV3LkVudW1zLklCcmV3R2VuZXJpY01lbnVFbnRyeT4gPSBbXVxyXG4gICAgbGV0IG1lbnVFdmVudCA9IEJyZXcuRXZlbnRzLmNyZWF0ZUdlbmVyaWNFdmVudE9mVHlwZShnbSwgQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLkdlbmVyaWNNZW51T24pXHJcblxyXG4gICAgZW50cmllcy5wdXNoKHtcclxuICAgICAgICBlbnRyeU5hbWU6IFwiU3dhcFwiLFxyXG4gICAgICAgIGVudHJ5VHlwZTogQnJldy5FbnVtcy5HZW5lcmljTWVudUVudHJ5VHlwZS5FdmVudEJhc2VkLFxyXG4gICAgICAgIGVudHJ5RXZlbnQ6IEJyZXcuRXZlbnRzLmFkZERhdGFUb0V2ZW50KEJyZXcuRXZlbnRzLmNyZWF0ZUdlbmVyaWNFdmVudE9mVHlwZShnbSwgQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLlBvd2VyU3dhcFNlbGVjdE1lbnVPbiwgZmFsc2UpLCB7XHJcbiAgICAgICAgICAgIHBvd2VyRGF0YToge1xyXG4gICAgICAgICAgICAgICAgcG93ZXI6IHNlbGVjdGVkX3Bvd2VyXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgfSlcclxuXHJcbiAgICBlbnRyaWVzLnB1c2goe1xyXG4gICAgICAgIGVudHJ5TmFtZTogXCJVbmluc3RhbGxcIixcclxuICAgICAgICBlbnRyeVR5cGU6IEJyZXcuRW51bXMuR2VuZXJpY01lbnVFbnRyeVR5cGUuRXZlbnRCYXNlZCxcclxuICAgICAgICBlbnRyeUV2ZW50OiBCcmV3LkV2ZW50cy5hZGREYXRhVG9FdmVudChCcmV3LkV2ZW50cy5jcmVhdGVHZW5lcmljRXZlbnRPZlR5cGUoZ20sIEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5Qb3dlclVuaW5zdGFsbCwgdHJ1ZSksIHtcclxuICAgICAgICAgICAgcG93ZXJEYXRhOiB7XHJcbiAgICAgICAgICAgICAgICBwb3dlcjogc2VsZWN0ZWRfcG93ZXJcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICB9KVxyXG4gICAgXHJcbiAgICBtZW51RXZlbnQuZ2VuZXJpY01lbnVEYXRhID0ge1xyXG4gICAgICAgIG1lbnVUaXRsZTogQnJldy5FbnVtcy5CcmV3UG93ZXJUeXBlW3NlbGVjdGVkX3Bvd2VyLnBvd2VyVHlwZV0sXHJcbiAgICAgICAgYWxsb3dDYW5jZWw6IHRydWUsXHJcbiAgICAgICAgbWVudUVudHJpZXNMaXN0OiBlbnRyaWVzXHJcbiAgICB9XHJcblxyXG4gICAgZ20uaW5zZXJ0RXZlbnQobWVudUV2ZW50KVxyXG4gICAgZ20uZW5kRXZlbnQoYnJFdmVudClcclxufVxyXG5cclxuXHJcbi8vLy8vLy8vLy8vLy8vLy8vLy8vIGxpc3Qgb2YgcG93ZXJzIG1lbnUgaGVscGVyXHJcbi8vIGZ1bmN0aW9uIHNob3dMaXN0T2ZQb3dlcnNNZW51X0hlbHBlcihnbTogQnJldy5HYW1lTWFzdGVyLCBickV2ZW50OiBCcmV3LkVudW1zLklCcmV3RXZlbnQsIGV2ZW50T25TZWxlY3Rpb24gOiBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUsIGVuZHNUdXJuIDogYm9vbGVhbikge1xyXG4vLyAgICAgbGV0IHNlbGVjdGVkX3Bvd2VyICA9IGJyRXZlbnQucG93ZXJEYXRhLnBvd2VyXHJcblxyXG4vLyAgICAgbGV0IHBsYXllciA9IGdtLmdldFBsYXllcigpXHJcbi8vICAgICBsZXQgcG93ZXJfZW50cmllcyA6IEFycmF5PEJyZXcuRW51bXMuSUJyZXdHZW5lcmljTWVudUVudHJ5PiA9IFtdXHJcbi8vICAgICBsZXQgcG93ZXJzID0gcGxheWVyLmdldFBvd2VycygpXHJcblxyXG4vLyAgICAgcG93ZXJzLmxpc3RPZlBvd2Vycy5mb3JFYWNoKChwb3csIGluZGV4LCBhcnJheSkgPT4ge1xyXG5cclxuLy8gICAgICAgICBwb3dlcl9lbnRyaWVzLnB1c2goe1xyXG4vLyAgICAgICAgICAgICBlbnRyeU5hbWU6IEJyZXcuRW51bXMuQnJld1Bvd2VyVHlwZVtwb3cucG93ZXJUeXBlXSArIGAgJHtwb3cuY2hhcmdlX3N0YXQuZ2V0Q3VycmVudExldmVsKCl9IC8gJHtwb3cuY2hhcmdlX3N0YXQuZ2V0TWF4TGV2ZWwoKX1gICxcclxuLy8gICAgICAgICAgICAgZW50cnlUeXBlOiBCcmV3LkVudW1zLkdlbmVyaWNNZW51RW50cnlUeXBlLlBvd2VyU2VsZWN0LFxyXG4vLyAgICAgICAgICAgICBlbnRyeUV2ZW50OiBCcmV3LkV2ZW50cy5hZGREYXRhVG9FdmVudChCcmV3LkV2ZW50cy5jcmVhdGVHZW5lcmljRXZlbnRPZlR5cGUoZ20sIGV2ZW50T25TZWxlY3Rpb24sIGVuZHNUdXJuKSwge1xyXG4vLyAgICAgICAgICAgICAgICAgcG93ZXJEYXRhOiB7XHJcbi8vICAgICAgICAgICAgICAgICAgICAgcG93ZXI6IHNlbGVjdGVkX3Bvd2VyXHJcbi8vICAgICAgICAgICAgICAgICB9LFxyXG4vLyAgICAgICAgICAgICAgICAgc3dhcFBvd2VyRGF0YToge1xyXG4vLyAgICAgICAgICAgICAgICAgICAgIHBvd2VyOiBwb3dcclxuLy8gICAgICAgICAgICAgICAgIH1cclxuLy8gICAgICAgICAgICAgfSlcclxuLy8gICAgICAgICB9KVxyXG4vLyAgICAgfSlcclxuICAgIFxyXG4vLyAgICAgbGV0IG1lbnVFdmVudCA9IEJyZXcuRXZlbnRzLmNyZWF0ZUdlbmVyaWNFdmVudE9mVHlwZShnbSwgQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLkdlbmVyaWNNZW51T24pXHJcbi8vICAgICBtZW51RXZlbnQuZ2VuZXJpY01lbnVEYXRhID0ge1xyXG4vLyAgICAgICAgIG1lbnVUaXRsZTogQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlW2V2ZW50T25TZWxlY3Rpb25dLFxyXG4vLyAgICAgICAgIGFsbG93Q2FuY2VsOiB0cnVlLFxyXG4vLyAgICAgICAgIG1lbnVFbnRyaWVzTGlzdDogcG93ZXJfZW50cmllc1xyXG4vLyAgICAgfVxyXG5cclxuLy8gICAgIGdtLmluc2VydEV2ZW50KG1lbnVFdmVudClcclxuLy8gICAgIGdtLmVuZEV2ZW50KGJyRXZlbnQpXHJcbi8vIH1cclxuXHJcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcbi8vIHBvd2VyIGluc3RhbGxcclxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBzaG93UG93ZXJJbnN0YWxsUHJvbXB0TWVudShnbTogQnJldy5HYW1lTWFzdGVyLCBickV2ZW50OiBCcmV3LkVudW1zLklCcmV3RXZlbnQpIHtcclxuICAgIGxldCBwb3dlciA9IGJyRXZlbnQucG93ZXJEYXRhLnBvd2VyXHJcbiAgICBsZXQgZW50cmllcyA6IEFycmF5PEJyZXcuRW51bXMuSUJyZXdHZW5lcmljTWVudUVudHJ5PiA9IFtdXHJcblxyXG4gICAgZW50cmllcy5wdXNoKHtcclxuICAgICAgICBlbnRyeVR5cGU6IEJyZXcuRW51bXMuR2VuZXJpY01lbnVFbnRyeVR5cGUuRXZlbnRCYXNlZCxcclxuICAgICAgICBlbnRyeU5hbWU6IFwiWWVzLCBJbnN0YWxsXCIsXHJcbiAgICAgICAgZW50cnlEZXNjcmlwdGlvbjogQnJldy5HbG9zc2FyeS5nZXRQb3dlckRlc2MocG93ZXIpLFxyXG4gICAgICAgIGVudHJ5RXZlbnQ6IEJyZXcuRXZlbnRzLmFkZERhdGFUb0V2ZW50KEJyZXcuRXZlbnRzLmNyZWF0ZUdlbmVyaWNFdmVudE9mVHlwZShnbSwgQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLlBvd2VySW5zdGFsbFJlcGxhY2VtZW50T24sIGZhbHNlKSwge1xyXG4gICAgICAgICAgICBwb3dlckRhdGE6IHtcclxuICAgICAgICAgICAgICAgIHBvd2VyOiBwb3dlclxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgIH0pXHJcblxyXG4gICAgZW50cmllcy5wdXNoKHtcclxuICAgICAgICBlbnRyeVR5cGU6IEJyZXcuRW51bXMuR2VuZXJpY01lbnVFbnRyeVR5cGUuQ2FuY2VsLFxyXG4gICAgICAgIGVudHJ5TmFtZTogXCJObywgQ2FuY2VsXCIsXHJcbiAgICAgICAgZW50cnlEZXNjcmlwdGlvbjogQnJldy5HbG9zc2FyeS5nZXRQb3dlckRlc2MocG93ZXIpLFxyXG4gICAgICAgIGVudHJ5RXZlbnQ6IEJyZXcuRXZlbnRzLmNyZWF0ZUdlbmVyaWNFdmVudE9mVHlwZShnbSwgQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLkdlbmVyaWNNZW51T2ZmKVxyXG4gICAgfSlcclxuXHJcbiAgICBsZXQgbWVudUV2ZW50ID0gQnJldy5FdmVudHMuY3JlYXRlR2VuZXJpY0V2ZW50T2ZUeXBlKGdtLCBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuR2VuZXJpY01lbnVPbilcclxuICAgIG1lbnVFdmVudC5nZW5lcmljTWVudURhdGEgPSB7XHJcbiAgICAgICAgbWVudVRpdGxlOiBcIkluc3RhbGwgVGhpcz9cIixcclxuICAgICAgICBhbGxvd0NhbmNlbDogdHJ1ZSxcclxuICAgICAgICBtZW51RW50cmllc0xpc3Q6IGVudHJpZXMsXHJcbiAgICAgICAgbWVudURlc2NyaXB0aW9uOiBcIkluc3RhbGwgdGhpcyBuZXcgcG93ZXIgaW4gYW4gZW1wdHkgc2xvdCBvciByZXBsYWNlIGFuIGV4aXN0aW5nIHBvd2VyXCIsXHJcbiAgICB9XHJcblxyXG4gICAgZ20uaW5zZXJ0RXZlbnQobWVudUV2ZW50KVxyXG4gICAgZ20uZW5kRXZlbnQoYnJFdmVudClcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHNob3dQb3dlckluc3RhbGxTZWxlY3RNZW51KGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGJyRXZlbnQ6IEJyZXcuRW51bXMuSUJyZXdFdmVudCkge1xyXG4gICAgLy8gc2hvd0xpc3RPZlBvd2Vyc01lbnVfSGVscGVyKGdtLCBickV2ZW50LCBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuUG93ZXJJbnN0YWxsRmluYWxpemUsIHRydWUpXHJcbiAgICBsZXQgbWVudUV2ZW50ID0gQnJldy5FdmVudHMuY3JlYXRlR2VuZXJpY0V2ZW50T2ZUeXBlKGdtLCBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuR2VuZXJpY01lbnVPbilcclxuICAgIG1lbnVFdmVudC5nZW5lcmljTWVudURhdGEgPSB7XHJcbiAgICAgICAgbWVudVRpdGxlOiBcIlJlcGxhY2UgV2hpY2g/XCIsXHJcbiAgICAgICAgYWxsb3dDYW5jZWw6IHRydWUsXHJcbiAgICAgICAgbWVudUVudHJpZXNMaXN0OiBnZXRNZW51RGF0YV9FbnRyaWVzX2Zvcl9Qb3dlcnMoZ20sIGJyRXZlbnQuYWN0b3IsIEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5Qb3dlckluc3RhbGxGaW5hbGl6ZSwgdHJ1ZSwgYnJFdmVudC5wb3dlckRhdGEucG93ZXIpXHJcbiAgICB9XHJcblxyXG4gICAgZ20uaW5zZXJ0RXZlbnQobWVudUV2ZW50KVxyXG4gICAgZ20uZW5kRXZlbnQoYnJFdmVudClcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHNob3dQb3dlclN3YXBTZWxlY3RNZW51KGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGJyRXZlbnQ6IEJyZXcuRW51bXMuSUJyZXdFdmVudCkge1xyXG4gICAgLy8gc2hvd0xpc3RPZlBvd2Vyc01lbnVfSGVscGVyKGdtLCBickV2ZW50LCBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuUG93ZXJTd2FwRmluYWxpemUsIGZhbHNlKVxyXG4gICAgbGV0IG1lbnVFdmVudCA9IEJyZXcuRXZlbnRzLmNyZWF0ZUdlbmVyaWNFdmVudE9mVHlwZShnbSwgQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLkdlbmVyaWNNZW51T24pXHJcbiAgICBtZW51RXZlbnQuZ2VuZXJpY01lbnVEYXRhID0ge1xyXG4gICAgICAgIG1lbnVUaXRsZTogXCJTd2FwIFdpdGg/XCIsXHJcbiAgICAgICAgYWxsb3dDYW5jZWw6IHRydWUsXHJcbiAgICAgICAgbWVudUVudHJpZXNMaXN0OiBnZXRNZW51RGF0YV9FbnRyaWVzX2Zvcl9Qb3dlcnMoZ20sIGJyRXZlbnQuYWN0b3IsIEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5Qb3dlclN3YXBGaW5hbGl6ZSwgZmFsc2UsIGJyRXZlbnQucG93ZXJEYXRhLnBvd2VyKVxyXG4gICAgfVxyXG5cclxuICAgIGdtLmluc2VydEV2ZW50KG1lbnVFdmVudClcclxuICAgIGdtLmVuZEV2ZW50KGJyRXZlbnQpXHJcblxyXG59XHJcblxyXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG4vLyBwb3dlciBsaXN0XHJcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0TWVudURhdGFfRW50cmllc19mb3JfUG93ZXJzKGdtOiBCcmV3LkdhbWVNYXN0ZXIsIHBvd2VyX3VzZXI6IEJyZXcuR3JpZFRoaW5ncy5Nb25zdGVyLCBldmVudE9uU2VsZWN0aW9uOiBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUsIGV2ZW50RW5kc1R1cm46IGJvb2xlYW4sIHN3YXBQb3dlcldpdGg/OiBCcmV3LlBvd2Vycy5Qb3dlcikgOiBBcnJheTxCcmV3LkVudW1zLklCcmV3R2VuZXJpY01lbnVFbnRyeT4ge1xyXG4gICAgLy8gbGV0IHBsYXllciA9IGdtLmdldFBsYXllcigpXHJcbiAgICBsZXQgcG93ZXJfZW50cmllcyA6IEFycmF5PEJyZXcuRW51bXMuSUJyZXdHZW5lcmljTWVudUVudHJ5PiA9IFtdXHJcbiAgICBsZXQgcG93ZXJzID0gcG93ZXJfdXNlci5nZXRQb3dlcnMoKVxyXG5cclxuICAgIGxldCBiYXNlUG93ZXIgOiBCcmV3LlBvd2Vycy5Qb3dlclxyXG4gICAgbGV0IHN3YXBQb3dlciA6IEJyZXcuUG93ZXJzLlBvd2VyXHJcbiAgICBsZXQgZW50cnkgOiBCcmV3LkVudW1zLklCcmV3R2VuZXJpY01lbnVFbnRyeVxyXG5cclxuICAgIHBvd2Vycy5saXN0T2ZQb3dlcnMuZm9yRWFjaCgocG93LCBpbmRleCwgYXJyYXkpID0+IHtcclxuICAgICAgICBlbnRyeSA9IHtcclxuXHJcbiAgICAgICAgICAgIGVudHJ5TmFtZTogQnJldy5HbG9zc2FyeS5nZXRQb3dlck5hbWUocG93KSxcclxuICAgICAgICAgICAgZW50cnlUeXBlOiBCcmV3LkVudW1zLkdlbmVyaWNNZW51RW50cnlUeXBlLkV2ZW50QmFzZWQsXHJcbiAgICAgICAgICAgIGVudHJ5RXZlbnQ6IEJyZXcuRXZlbnRzLmFkZERhdGFUb0V2ZW50KEJyZXcuRXZlbnRzLmNyZWF0ZUdlbmVyaWNFdmVudE9mVHlwZShnbSwgZXZlbnRPblNlbGVjdGlvbiwgZXZlbnRFbmRzVHVybiksIHtcclxuICAgICAgICAgICAgICAgIHBvd2VyRGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgIHBvd2VyOiBzd2FwUG93ZXJXaXRoID8gc3dhcFBvd2VyV2l0aCA6IHBvd1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgZW50cnlEZXNjcmlwdGlvbjogQnJldy5HbG9zc2FyeS5nZXRQb3dlckRlc2MocG93KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHN3YXBQb3dlcldpdGgpIHtcclxuICAgICAgICAgICAgZW50cnkuZW50cnlFdmVudC5zd2FwUG93ZXJEYXRhID0ge1xyXG4gICAgICAgICAgICAgICAgcG93ZXI6IHBvd1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBwb3dlcl9lbnRyaWVzLnB1c2goZW50cnkpXHJcbiAgICB9KVxyXG4gICAgXHJcbiAgICByZXR1cm4gcG93ZXJfZW50cmllc1xyXG59XHJcblxyXG5cclxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuLy8gSFVEXHJcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcblxyXG5leHBvcnQgZnVuY3Rpb24gc2hvd0hlYWRzVXBEaXNwbGF5KGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGJyRXZlbnQ6IEJyZXcuRW51bXMuSUJyZXdFdmVudCkge1xyXG4gICAgXHJcbiAgICBnbS5pbnB1dF9oYW5kbGVyID0gQnJldy5FbnVtcy5JbnB1dEhhbmRsZXIuSGVhZHNVcERpc3BsYXlcclxuICAgIFxyXG4gICAgbGV0IGN1cnJlbnRfcGFnZSA9IGJyRXZlbnQuaGVhZHNVcERhdGEuc2VsZWN0ZWRfaW5kZXhcclxuICAgIGxldCBub3RlcyA9IGJyRXZlbnQuaGVhZHNVcERhdGEuaGVhZHNVcERpc3BsYXlOb3RlUGFnZXNbY3VycmVudF9wYWdlXVxyXG4gICAgZ20uZGlzcGxheS5oZWFkc1VwRGlzcGxheURyYXcobm90ZXMpXHJcblxyXG4gICAgZ20uZW5kRXZlbnQoYnJFdmVudClcclxufVxyXG5cclxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuLy8gZ2VuZXJpYyBtZW51IHN5c3RlbVxyXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHNob3dHZW5lcmljTWVudShnbTogQnJldy5HYW1lTWFzdGVyLCBickV2ZW50OiBCcmV3LkVudW1zLklCcmV3RXZlbnQpIHtcclxuICAgIFxyXG4gICAgbGV0IG1lbnVfZW50cmllcyA9IGJyRXZlbnQuZ2VuZXJpY01lbnVEYXRhLm1lbnVFbnRyaWVzTGlzdFxyXG5cclxuICAgIGdtLmlucHV0X2hhbmRsZXIgPSBCcmV3LkVudW1zLklucHV0SGFuZGxlci5HZW5lcmljTWVudVxyXG4gICAgZ20uZGlzcGxheS5nZW5lcmljTWVudURyYXcoYnJFdmVudC5nZW5lcmljTWVudURhdGEubWVudVRpdGxlLCBickV2ZW50LmdlbmVyaWNNZW51RGF0YS5tZW51RGVzY3JpcHRpb24sIG1lbnVfZW50cmllcywgMClcclxuICAgIGJyRXZlbnQuZ2VuZXJpY01lbnVEYXRhLnNlbGVjdGVkX2luZGV4ID0gMFxyXG5cclxuICAgIGdtLmVuZEV2ZW50KGJyRXZlbnQpXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBzdG9wU2hvd2luZ0dlbmVyaWNNZW51KGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGRhdGE6IEJyZXcuRW51bXMuSUJyZXdFdmVudCkge1xyXG4gICAgcmVzZXRIVURUb0dhbWUoZ20pXHJcbiAgICBnbS5lbmRFdmVudChkYXRhKVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0RW50cnlOYW1lKGVudHJ5IDogQnJldy5FbnVtcy5JQnJld0dlbmVyaWNNZW51RW50cnkpIDogc3RyaW5nIHtcclxuICAgIGxldCBlbnRyeV90ZXh0IDogc3RyaW5nXHJcblxyXG4gICAgaWYgKGVudHJ5LmVudHJ5TmFtZSkge1xyXG4gICAgICAgIGVudHJ5X3RleHQgPSBlbnRyeS5lbnRyeU5hbWVcclxuXHJcbiAgICB9IGVsc2UgaWYgKGVudHJ5LmVudHJ5VHlwZSA9PSBCcmV3LkVudW1zLkdlbmVyaWNNZW51RW50cnlUeXBlLkV2ZW50QmFzZWQpIHtcclxuICAgICAgICBlbnRyeV90ZXh0ID0gQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlW2VudHJ5LmVudHJ5RXZlbnQuZXZlbnRUeXBlXVxyXG4gICAgfSBlbHNlIGlmIChlbnRyeS5lbnRyeVR5cGUgPT0gQnJldy5FbnVtcy5HZW5lcmljTWVudUVudHJ5VHlwZS5JbnZlbnRvcnlJdGVtKSB7XHJcbiAgICAgICAgZW50cnlfdGV4dCA9IGVudHJ5LmVudHJ5RXZlbnQuY29udGV4dE1lbnVEYXRhLml0ZW0uZ2V0TmFtZSgpXHJcbiAgICB9IGVsc2UgaWYgKGVudHJ5LmVudHJ5VHlwZSA9PSBCcmV3LkVudW1zLkdlbmVyaWNNZW51RW50cnlUeXBlLkl0ZW1Db250ZXh0QWN0aW9uKSB7XHJcbiAgICAgICAgZW50cnlfdGV4dCA9IGVudHJ5LmVudHJ5RXZlbnQuaXRlbURhdGEuaXRlbS5nZXROYW1lKClcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgZW50cnlfdGV4dCA9IEJyZXcuRW51bXMuR2VuZXJpY01lbnVFbnRyeVR5cGVbZW50cnkuZW50cnlUeXBlXVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBlbnRyeV90ZXh0XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVHZW5lcmljTWVudShnbTogQnJldy5HYW1lTWFzdGVyLCBickV2ZW50OiBCcmV3LkVudW1zLklCcmV3RXZlbnQpIHtcclxuICAgIGxldCBjeWNsZV9kaXIgPSBickV2ZW50LmdlbmVyaWNNZW51RGF0YS5kaXJlY3Rpb25cclxuICAgIGxldCBsYXN0RXZlbnRNZW51RGF0YSAgPSBnbS5nZXRMYXN0RXZlbnQoKS5nZW5lcmljTWVudURhdGFcclxuICAgIGxldCBjdXJyZW50X2luZGV4ID0gbGFzdEV2ZW50TWVudURhdGEuc2VsZWN0ZWRfaW5kZXhcclxuICAgIGxldCBlbnRyaWVzID0gbGFzdEV2ZW50TWVudURhdGEubWVudUVudHJpZXNMaXN0XHJcbiAgICAgICAgXHJcbiAgICBsZXQgbmV3X2luZGV4ID0gQnJldy5VdGlscy5tb2QoY3VycmVudF9pbmRleCArIGN5Y2xlX2RpciwgZW50cmllcy5sZW5ndGgpXHJcbiAgICBcclxuICAgIGdtLmRpc3BsYXkuZ2VuZXJpY01lbnVEcmF3KGxhc3RFdmVudE1lbnVEYXRhLm1lbnVUaXRsZSwgbGFzdEV2ZW50TWVudURhdGEubWVudURlc2NyaXB0aW9uLCBlbnRyaWVzLCBuZXdfaW5kZXgpXHJcbiAgICBcclxuICAgIC8vIG1ha2Ugc3VyZSBkYXRhIGNhcnJpZXMgb3ZlciBkdXJpbmcgdGhlIHN1YnNlcXVlbnQgZXZlbnRcclxuICAgIGJyRXZlbnQuZ2VuZXJpY01lbnVEYXRhLm1lbnVFbnRyaWVzTGlzdCA9IGVudHJpZXNcclxuICAgIGJyRXZlbnQuZ2VuZXJpY01lbnVEYXRhLnNlbGVjdGVkX2luZGV4ID0gbmV3X2luZGV4XHJcblxyXG4gICAgZ20uZW5kRXZlbnQoYnJFdmVudClcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHNlbGVjdEZyb21HZW5lcmljTWVudShnbTogQnJldy5HYW1lTWFzdGVyLCBickV2ZW50OiBCcmV3LkVudW1zLklCcmV3RXZlbnQpIHtcclxuICAgIGxldCBjdXJyZW50X2luZGV4IDogbnVtYmVyID0gZ20uZ2V0TGFzdEV2ZW50KCkuZ2VuZXJpY01lbnVEYXRhLnNlbGVjdGVkX2luZGV4XHJcbiAgICBsZXQgZW50cmllcyA9IGdtLmdldExhc3RFdmVudCgpLmdlbmVyaWNNZW51RGF0YS5tZW51RW50cmllc0xpc3RcclxuICAgIFxyXG4gICAgbGV0IGFjdGl2ZUVudHJ5ID0gZW50cmllc1tjdXJyZW50X2luZGV4XVxyXG4gICAgXHJcbiAgICByZXNldEhVRFRvR2FtZShnbSlcclxuICAgIC8vIGdyYWIgdGhlIGV2ZW50IGF0dGFjaGVkIHRvIHRoaXMgZW50cnkgYW5kIGxvYWQgaXQgdG8gcnVuIG5leHRcclxuICAgIC8vIGNvbnNvbGUubG9nKFwiZmluaXNoZWQgbWVudSwgaW5zZXJ0aW5nIHRoaXMgZXZlbnRcIiwgYWN0aXZlRW50cnkuZW50cnlFdmVudClcclxuICAgIGdtLmluc2VydEV2ZW50KGFjdGl2ZUVudHJ5LmVudHJ5RXZlbnQpXHJcbiAgICBnbS5lbmRFdmVudChickV2ZW50KVxyXG59XHJcblxyXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG4vLyBDb25maXJtIFBhdGhzIE1lbnVcclxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuZXhwb3J0IGZ1bmN0aW9uIHNob3dDb25maXJtUGF0aHMoZ206IEJyZXcuR2FtZU1hc3RlciwgYnJFdmVudDogQnJldy5FbnVtcy5JQnJld0V2ZW50KSB7XHJcbiAgICAvLyBkcmF3IHRoZSBoaWdobGlnaHRzXHJcbiAgICBnbS5kaXNwbGF5LmhpZ2hsaWdodHMuY2xlYXJBbGwoKVxyXG4gICAgZm9yIChsZXQgaGlnaGxpZ2h0X3BhaXIgb2YgYnJFdmVudC5jb25maXJtUGF0aHNEYXRhLmhpZ2hsaWdodHMpIHtcclxuICAgICAgICAvLyBnbS5kaXNwbGF5LmhpZ2hsaWdodHMuc2V0QXQoaGlnaGxpZ2h0X3BhaXIueHlcclxuICAgICAgICBnbS5kaXNwbGF5LmhpZ2hsaWdodHMuc2V0QXQoaGlnaGxpZ2h0X3BhaXIueHksIEJyZXcuRGVmaW5pdGlvbnMudGVycmFpbkZhY3RvcnkoQnJldy5EZWZpbml0aW9ucy5UZXJyYWluVHlwZS5IaWdobGlnaHQsIHsgY29sb3I6IGhpZ2hsaWdodF9wYWlyLmNvbG9yIH0gKSlcclxuICAgICAgICBnbS5kaXNwbGF5TGlzdChickV2ZW50LmNvbmZpcm1QYXRoc0RhdGEuaGlnaGxpZ2h0cy5tYXAoKHBhaXI6IEJyZXcuRW51bXMuSUNvb3JkaW5hdGVDb2xvclBhaXIsIGluZGV4OiBudW1iZXIsIGFycmF5KSA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiBwYWlyLnh5XHJcbiAgICAgICAgfSkpXHJcbiAgICB9XHJcbiAgICBnbS5pbnB1dF9oYW5kbGVyID0gQnJldy5FbnVtcy5JbnB1dEhhbmRsZXIuQ29uZmlybVBhdGhzXHJcbiAgICBnbS5lbmRFdmVudChickV2ZW50KVxyXG59XHJcblxyXG5mdW5jdGlvbiBzdG9wQ29uZmlybVBhdGhzKGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGhpZ2hsaWdodGVkX3BhdGggOiBBcnJheTxCcmV3LkVudW1zLklDb29yZGluYXRlQ29sb3JQYWlyPikge1xyXG4gICAgZ20uZGlzcGxheS5oaWdobGlnaHRzLmNsZWFyQWxsKClcclxuICAgIGdtLmRpc3BsYXlMaXN0KGhpZ2hsaWdodGVkX3BhdGgubWFwKChwYWlyOiBCcmV3LkVudW1zLklDb29yZGluYXRlQ29sb3JQYWlyLCBpbmRleDogbnVtYmVyLCBhcnJheSkgPT4ge1xyXG4gICAgICAgIHJldHVybiBwYWlyLnh5XHJcbiAgICB9KSlcclxuXHJcbiAgICBnbS5pbnB1dF9oYW5kbGVyID0gQnJldy5FbnVtcy5JbnB1dEhhbmRsZXIuTWFpblxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZmluYWxpemVDb25maXJtUGF0aHMoZ206IEJyZXcuR2FtZU1hc3RlciwgYnJFdmVudDogQnJldy5FbnVtcy5JQnJld0V2ZW50KSB7XHJcbiAgICBsZXQgbGFzdF9ldmVudCA9IGdtLmdldExhc3RFdmVudCgpXHJcblxyXG4gICAgc3RvcENvbmZpcm1QYXRocyhnbSwgbGFzdF9ldmVudC5jb25maXJtUGF0aHNEYXRhLmhpZ2hsaWdodHMpXHJcbiAgICBnbS5pbnNlcnRFdmVudChsYXN0X2V2ZW50LmNvbmZpcm1QYXRoc0RhdGEuZm9sbG93X2V2ZW50KVxyXG4gICAgZ20uZW5kRXZlbnQoYnJFdmVudClcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNhbmNlbENvbmZpcm1QYXRocyhnbTogQnJldy5HYW1lTWFzdGVyLCBickV2ZW50OiBCcmV3LkVudW1zLklCcmV3RXZlbnQpIHtcclxuICAgIGxldCBsYXN0X2V2ZW50ID0gZ20uZ2V0TGFzdEV2ZW50KClcclxuXHJcbiAgICBzdG9wQ29uZmlybVBhdGhzKGdtLCBsYXN0X2V2ZW50LmNvbmZpcm1QYXRoc0RhdGEuaGlnaGxpZ2h0cylcclxuICAgIGdtLmVuZEV2ZW50KGJyRXZlbnQpXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRXYXJwQmVhY29uTWVudUV2ZW50KGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGxldmVsOiBCcmV3LkxldmVsLCB0ZXJyYWluOiBCcmV3LkdyaWRUaGluZ3MuVGVycmFpbik6IEJyZXcuRW51bXMuSUJyZXdFdmVudCB7XHJcbiAgICAvLyByZXR1cm4gYSBtZW51IGV2ZW50IGZvciBhIGdpdmVuIHdhcnAgcG9kIGxvY2F0aW9uXHJcbiAgICBsZXQgcGxheWVyID0gZ20uZ2V0UGxheWVyKClcclxuICAgIGxldCBtZW51RXZlbnQgPSBCcmV3LkV2ZW50cy5jcmVhdGVHZW5lcmljRXZlbnRPZlR5cGUoZ20sIEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5HZW5lcmljTWVudU9uKVxyXG4gICAgbGV0IGVudHJ5IDogQnJldy5FbnVtcy5JQnJld0dlbmVyaWNNZW51RW50cnlcclxuXHJcbiAgICBtZW51RXZlbnQuZ2VuZXJpY01lbnVEYXRhID0ge1xyXG4gICAgICAgIG1lbnVUaXRsZTogXCJXYXJwIFBvZFwiLFxyXG4gICAgICAgIG1lbnVEZXNjcmlwdGlvbjogXCJVc2luZyBhIHdhcnAgY3J5c3RhbCwgaG9tZSBiYXNlIGNhbiB0cmFuc21pdCBpdGVtcyBhbmQgb3RoZXIgdXBncmFkZXMgdG8geW91ciBzeXN0ZW1zLiBCZSBtaW5kZnVsLCB3YXJwIGNyeXN0YWxzIGFyZSBvbmx5IGdvb2QgZm9yIG9uZSB1c2UuXCIsXHJcbiAgICAgICAgYWxsb3dDYW5jZWw6IHRydWUsXHJcbiAgICAgICAgbWVudUVudHJpZXNMaXN0OiBbXVxyXG4gICAgfVxyXG5cclxuICAgIG1lbnVFdmVudC5nZW5lcmljTWVudURhdGEubWVudUVudHJpZXNMaXN0LnB1c2goe1xyXG4gICAgICAgIGVudHJ5TmFtZTogXCJIZWFsXCIsXHJcbiAgICAgICAgZW50cnlEZXNjcmlwdGlvbjogXCJSZXN0b3JlIGhlYWx0aCB0byBtYXhpbXVtXCIsXHJcbiAgICAgICAgZW50cnlUeXBlOiBCcmV3LkVudW1zLkdlbmVyaWNNZW51RW50cnlUeXBlLkV2ZW50QmFzZWQsXHJcbiAgICAgICAgZW50cnlFdmVudDogQnJldy5FdmVudHMuY3JlYXRlR2VuZXJpY0V2ZW50T2ZUeXBlKGdtLCBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuV2FycEJlYWNvbkhlYWwpXHJcbiAgICB9KVxyXG5cclxuICAgIG1lbnVFdmVudC5nZW5lcmljTWVudURhdGEubWVudUVudHJpZXNMaXN0LnB1c2goe1xyXG4gICAgICAgIGVudHJ5TmFtZTogXCJSZWluZm9yY2VtZW50c1wiLFxyXG4gICAgICAgIGVudHJ5RGVzY3JpcHRpb246IFwiV2FycCBpbiBhbiBhbGxpZWQgbWFyaW5lIHNxdWFkXCIsXHJcbiAgICAgICAgZW50cnlUeXBlOiBCcmV3LkVudW1zLkdlbmVyaWNNZW51RW50cnlUeXBlLkV2ZW50QmFzZWQsXHJcbiAgICAgICAgZW50cnlFdmVudDogQnJldy5FdmVudHMuY3JlYXRlR2VuZXJpY0V2ZW50T2ZUeXBlKGdtLCBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuV2FycEJlYWNvbkFsbHlEcm9wKVxyXG4gICAgfSlcclxuXHJcbiAgICBwbGF5ZXIuZ2V0UG93ZXJzKCkubGlzdE9mUG93ZXJzLmZvckVhY2goKHBvdywgaW5kZXgsIGFycmF5KSA9PiB7XHJcbiAgICAgICAgaWYgKChwb3cuY2FuQmVSZWNoYXJnZWQpICYmIChwb3cuY2hhcmdlX3N0YXQuZ2V0Q3VycmVudExldmVsKCkgPCBwb3cuY2hhcmdlX3N0YXQuZ2V0TWF4TGV2ZWwoKSkpIHtcclxuICAgICAgICAgICAgbWVudUV2ZW50LmdlbmVyaWNNZW51RGF0YS5tZW51RW50cmllc0xpc3QucHVzaCh7XHJcbiAgICAgICAgICAgICAgICBlbnRyeU5hbWU6IEJyZXcuR2xvc3NhcnkuZ2V0UG93ZXJTaG9ydE5hbWUocG93KSArIFwiIFJFQ0hBUkdFXCIsXHJcbiAgICAgICAgICAgICAgICBlbnRyeURlc2NyaXB0aW9uOiBcIlJlc3RvcmUgdGhpcyBwb3dlciB0byB0aGUgbWF4aW11bSBudW1iZXIgb2YgY2hhcmdlc1wiLFxyXG4gICAgICAgICAgICAgICAgZW50cnlUeXBlOiBCcmV3LkVudW1zLkdlbmVyaWNNZW51RW50cnlUeXBlLkV2ZW50QmFzZWQsXHJcbiAgICAgICAgICAgICAgICBlbnRyeUV2ZW50OiBCcmV3LkV2ZW50cy5hZGREYXRhVG9FdmVudChCcmV3LkV2ZW50cy5jcmVhdGVHZW5lcmljRXZlbnRPZlR5cGUoZ20sIEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5XYXJwQmVhY29uUmVjaGFyZ2VQb3dlciwgZmFsc2UpLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgcG93ZXJEYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvd2VyOiBwb3dcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKEJyZXcuUG93ZXJzLmNhblVwZ3JhZGVQb3dlckNoYXJnZXMocG93KSkge1xyXG4gICAgICAgICAgICBtZW51RXZlbnQuZ2VuZXJpY01lbnVEYXRhLm1lbnVFbnRyaWVzTGlzdC5wdXNoKHtcclxuICAgICAgICAgICAgICAgIGVudHJ5TmFtZTogQnJldy5HbG9zc2FyeS5nZXRQb3dlclNob3J0TmFtZShwb3cpICsgXCIgSU5DUkVBU0VcIixcclxuICAgICAgICAgICAgICAgIGVudHJ5RGVzY3JpcHRpb246IFwiUGVybWFuZW50bHkgaW5jcmVhc2UgdGhlIG51bWJlciBvZiBjaGFyZ2VzIGZvciB0aGlzIHBvd2VyLiBBbHNvIGFkZHMgMSBjaGFyZ2UuXCIsXHJcbiAgICAgICAgICAgICAgICBlbnRyeVR5cGU6IEJyZXcuRW51bXMuR2VuZXJpY01lbnVFbnRyeVR5cGUuRXZlbnRCYXNlZCxcclxuICAgICAgICAgICAgICAgIGVudHJ5RXZlbnQ6IEJyZXcuRXZlbnRzLmFkZERhdGFUb0V2ZW50KEJyZXcuRXZlbnRzLmNyZWF0ZUdlbmVyaWNFdmVudE9mVHlwZShnbSwgQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLldhcnBCZWFjb25JbmNyZWFzZVBvd2VyLCBmYWxzZSksIHtcclxuICAgICAgICAgICAgICAgICAgICBwb3dlckRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcG93ZXI6IHBvd1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoQnJldy5Qb3dlcnMuY2FuVXBncmFkZVBvd2VyU3RyZW5ndGgocG93KSkge1xyXG4gICAgICAgICAgICBtZW51RXZlbnQuZ2VuZXJpY01lbnVEYXRhLm1lbnVFbnRyaWVzTGlzdC5wdXNoKHtcclxuICAgICAgICAgICAgICAgIGVudHJ5TmFtZTogQnJldy5HbG9zc2FyeS5nZXRQb3dlclNob3J0TmFtZShwb3cpICsgXCIgVVBHUkFERVwiLFxyXG4gICAgICAgICAgICAgICAgZW50cnlEZXNjcmlwdGlvbjogXCJQZXJtYW5lbnRseSBpbmNyZWFzZSB0aGUgU1RSRU5HVEggdGhpcyBwb3dlci4gRG9lcyBub3QgYWRkIG5ldyBjaGFyZ2VzLlwiLFxyXG4gICAgICAgICAgICAgICAgZW50cnlUeXBlOiBCcmV3LkVudW1zLkdlbmVyaWNNZW51RW50cnlUeXBlLkV2ZW50QmFzZWQsXHJcbiAgICAgICAgICAgICAgICBlbnRyeUV2ZW50OiBCcmV3LkV2ZW50cy5hZGREYXRhVG9FdmVudChCcmV3LkV2ZW50cy5jcmVhdGVHZW5lcmljRXZlbnRPZlR5cGUoZ20sIEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5XYXJwQmVhY29uVXBncmFkZVBvd2VyLCBmYWxzZSksIHtcclxuICAgICAgICAgICAgICAgICAgICBwb3dlckRhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcG93ZXI6IHBvd1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG5cclxuICAgIH0pXHJcblxyXG5cclxuICAgIHJldHVybiBtZW51RXZlbnRcclxuICAgXHJcbn1cclxuXHJcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcbi8vIEhFTFBcclxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBzaG93SGVscE1lbnUoZ206IEJyZXcuR2FtZU1hc3RlciwgYnJFdmVudDogQnJldy5FbnVtcy5JQnJld0V2ZW50KSB7XHJcbiAgICBcclxuICAgIGdtLmlucHV0X2hhbmRsZXIgPSBCcmV3LkVudW1zLklucHV0SGFuZGxlci5IZWxwTWVudVxyXG4gICAgXHJcbiAgICBsZXQgY3VycmVudF9pbmRleCA9IGJyRXZlbnQuaGVscERhdGEuc2VsZWN0ZWRfaW5kZXhcclxuICAgIC8vIGxldCBub3RlcyA9IGJyRXZlbnQuaGVhZHNVcERhdGEuaGVhZHNVcERpc3BsYXlOb3RlUGFnZXNbY3VycmVudF9wYWdlXVxyXG4gICAgZ20uZGlzcGxheS5kcmF3SGVscE1lbnUoY3VycmVudF9pbmRleClcclxuXHJcbiAgICBnbS5lbmRFdmVudChickV2ZW50KVxyXG59XHJcbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/brew_game/menus.ts\n");

/***/ }),

/***/ "./src/brew_game/movement.ts":
/*!***********************************!*\
  !*** ./src/brew_game/movement.ts ***!
  \***********************************/
/*! exports provided: move, checkForImpactOfNewParts, isDoor, checkForAmbientEffects, canMoveToLocation, knockback, calculateKnockbackDistance, triggerPortalUse, rest */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"move\", function() { return move; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"checkForImpactOfNewParts\", function() { return checkForImpactOfNewParts; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isDoor\", function() { return isDoor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"checkForAmbientEffects\", function() { return checkForAmbientEffects; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"canMoveToLocation\", function() { return canMoveToLocation; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"knockback\", function() { return knockback; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"calculateKnockbackDistance\", function() { return calculateKnockbackDistance; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"triggerPortalUse\", function() { return triggerPortalUse; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"rest\", function() { return rest; });\n/* harmony import */ var _brew__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../brew */ \"./src/brew.ts\");\n\r\nlet turn_history = [];\r\nlet last_step;\r\nfunction updateTurns(from_xy, to_xy) {\r\n    let step_direction_xy = to_xy.subtract(from_xy);\r\n    if (last_step) {\r\n        let turn_angle = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Turning\"].getAngleBetween(last_step, step_direction_xy);\r\n        turn_history.push(turn_angle);\r\n        if (turn_history.length > 4) {\r\n            let first = turn_history.shift();\r\n        }\r\n    }\r\n    // console.log(turn_history)\r\n    last_step = step_direction_xy;\r\n}\r\nfunction checkForFancySteps() {\r\n    let fancy_footwork = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].FancyStepType.None;\r\n    if (checkForSquareStep()) {\r\n        fancy_footwork = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].FancyStepType.Squarestep;\r\n    }\r\n    else if (checkForLunge()) {\r\n        fancy_footwork = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].FancyStepType.Lunge;\r\n    }\r\n    return fancy_footwork;\r\n}\r\nfunction checkForLunge() {\r\n    if (turn_history.length == 0) {\r\n        return false;\r\n    }\r\n    let last_turn = turn_history[turn_history.length - 1];\r\n    return Math.abs(last_turn) == Math.PI;\r\n}\r\nfunction checkForSquareStep() {\r\n    let half_pi = Math.PI / 2;\r\n    if (turn_history.length < 4) {\r\n        return false;\r\n    }\r\n    let qtr_turn_indicators = turn_history.map((angle_rads) => {\r\n        if (Math.abs(angle_rads) == half_pi) {\r\n            return Math.sign(angle_rads);\r\n        }\r\n        else {\r\n            return 0;\r\n        }\r\n    });\r\n    let sum_of_turns = qtr_turn_indicators.reduce((prev_val, current_val) => {\r\n        return prev_val + current_val;\r\n    }, 0);\r\n    let is_circle_step = Math.abs(sum_of_turns) == 4;\r\n    return is_circle_step;\r\n}\r\nfunction move(gm, data) {\r\n    let level = gm.getCurrentLevel();\r\n    // debug: check if location is full of a monster already\r\n    let m_at = level.monsters.getAt(data.moveData.to_xy);\r\n    if (m_at) {\r\n        console.error(`${data.actor.name} trying to move onto an occupied grid, ${data.moveData.from_xy} -> ${data.moveData.to_xy}`);\r\n    }\r\n    _brew__WEBPACK_IMPORTED_MODULE_0__[\"Parts\"].removeMonsterPartsFromGrid(gm, data.actor);\r\n    level.monsters.removeAt(data.moveData.from_xy);\r\n    level.monsters.setAt(data.moveData.to_xy, data.actor);\r\n    _brew__WEBPACK_IMPORTED_MODULE_0__[\"Parts\"].updateMonsterParts(gm, data.actor);\r\n    _brew__WEBPACK_IMPORTED_MODULE_0__[\"Parts\"].placeMonsterPartsOnGrid(gm, data.actor);\r\n    // check for trigger events\r\n    let didTrigger = checkForTriggerOnStep(gm, data.actor, data.moveData.to_xy, data.moveData.from_xy);\r\n    let ambientTrigger = checkForAmbientEffects(gm, data.actor);\r\n    // if (Brew.Intel.isPlayer(gm, data.actor)) {\r\n    //     updateTurns(data.moveData.from_xy, data.moveData.to_xy)\r\n    // }\r\n    // turn off target locks when someone moves\r\n    _brew__WEBPACK_IMPORTED_MODULE_0__[\"Targeting\"].clearTargetLocksBy(data.actor);\r\n    gm.displayList([data.moveData.from_xy, data.moveData.to_xy]);\r\n    gm.endEvent(data);\r\n}\r\nfunction checkForImpactOfNewParts(gm, actor, component_parts) {\r\n    let level = gm.getCurrentLevel();\r\n    let terrain_at;\r\n    let num_changes = 0;\r\n    for (let part of component_parts) {\r\n        if (level.isValid(part.location)) {\r\n            terrain_at = level.terrain.getAt(part.location);\r\n            if ((terrain_at.isType(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].TerrainType.Rock)) || (terrain_at.isType(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].TerrainType.Broken_Wall))) {\r\n                level.terrain.removeAt(part.location);\r\n                level.terrain.setAt(part.location, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].terrainFactory(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].TerrainType.Rubble));\r\n                num_changes += 1;\r\n            }\r\n        }\r\n    }\r\n    return num_changes > 0;\r\n}\r\nfunction checkForTriggerOnStep(gm, actor, location_xy, previous_xy) {\r\n    let level = gm.getCurrentLevel();\r\n    let triggerEvent;\r\n    let num_events = 0;\r\n    // \r\n    let terrain_at = level.terrain.getAt(location_xy);\r\n    let terrain_from = level.terrain.getAt(previous_xy);\r\n    let door_change;\r\n    if (isDoor(terrain_at)) {\r\n        door_change = holdTheDoor(gm, terrain_at);\r\n        if (door_change) {\r\n            gm.displayAt(location_xy);\r\n        }\r\n    }\r\n    if (isDoor(terrain_from)) {\r\n        door_change = holdTheDoor(gm, terrain_from);\r\n        if (door_change) {\r\n            gm.displayAt(previous_xy);\r\n        }\r\n    }\r\n    return (num_events > 0);\r\n}\r\nfunction isDoor(terrain) {\r\n    return ((terrain.isType(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].TerrainType.Door) || terrain.isType(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].TerrainType.DoorOpen)));\r\n}\r\nfunction holdTheDoor(gm, the_door) {\r\n    let level = gm.getCurrentLevel();\r\n    let xy = the_door.location.clone();\r\n    let monster_on_it = level.monsters.getAt(xy);\r\n    let item_on_it = level.items.getAt(xy);\r\n    let something_on_it = monster_on_it || item_on_it;\r\n    // if its closed\r\n    if (the_door.isType(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].TerrainType.Door)) {\r\n        // and someone is standing on it, make it open\r\n        if (something_on_it) {\r\n            level.terrain.removeAt(xy);\r\n            level.terrain.setAt(xy, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].terrainFactory(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].TerrainType.DoorOpen));\r\n            return true;\r\n        }\r\n    }\r\n    // if its open\r\n    if (the_door.isType(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].TerrainType.DoorOpen)) {\r\n        // and no one is standing on it, close it\r\n        if (!(something_on_it)) {\r\n            level.terrain.removeAt(xy);\r\n            level.terrain.setAt(xy, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].terrainFactory(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].TerrainType.Door));\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\nfunction checkForAmbientEffects(gm, actor) {\r\n    let level = gm.getCurrentLevel();\r\n    let triggerEvent;\r\n    let num_events = 0;\r\n    let location_xy = actor.location;\r\n    // check for part/components of other monsters\r\n    let part_at = level.parts.getAt(location_xy);\r\n    if (part_at) {\r\n        if (part_at.isType(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].FeatureType.TankPart) && (!(part_at.getParent().isSameThing(actor)))) {\r\n            // smooshed by a tank\r\n            triggerEvent = {\r\n                eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.Attack,\r\n                actor: actor,\r\n                playerInitiated: false,\r\n                endsTurn: false,\r\n                attackData: {\r\n                    from_xy: location_xy,\r\n                    to_xy: location_xy,\r\n                    target: actor,\r\n                    isMelee: true,\r\n                    damage: 1,\r\n                    effects: [],\r\n                }\r\n            };\r\n            gm.insertEvent(triggerEvent);\r\n            num_events += 1;\r\n        }\r\n    }\r\n    // check for interactive features\r\n    let feature_at = level.features.getAt(location_xy);\r\n    if (feature_at) {\r\n        if (feature_at.isType(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].FeatureType.RepairGoo)) {\r\n            actor.hp.increment(1);\r\n            console.log(`${actor.name} health is now ${actor.hp}`);\r\n            level.features.removeAt(location_xy);\r\n        }\r\n        else if (feature_at.isType(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].FeatureType.CorrosiveAcid)) {\r\n            level.features.removeAt(location_xy);\r\n            triggerEvent = {\r\n                eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.Attack,\r\n                actor: actor,\r\n                playerInitiated: false,\r\n                endsTurn: false,\r\n                attackData: {\r\n                    from_xy: location_xy,\r\n                    to_xy: location_xy,\r\n                    target: actor,\r\n                    isMelee: true,\r\n                    damage: 0,\r\n                    effects: [_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].Flag.CausesWeak],\r\n                }\r\n            };\r\n            gm.insertEvent(triggerEvent);\r\n            num_events += 1;\r\n        }\r\n        else if (feature_at.isType(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].FeatureType.ProtectiveGoo)) {\r\n            level.features.removeAt(location_xy);\r\n            triggerEvent = {\r\n                eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.Attack,\r\n                actor: actor,\r\n                playerInitiated: false,\r\n                endsTurn: false,\r\n                attackData: {\r\n                    from_xy: location_xy,\r\n                    to_xy: location_xy,\r\n                    target: actor,\r\n                    isMelee: true,\r\n                    damage: 0,\r\n                    effects: [_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].Flag.CausesInvulnerable],\r\n                }\r\n            };\r\n            gm.insertEvent(triggerEvent);\r\n            num_events += 1;\r\n        }\r\n    }\r\n    // console.log(`${num_events} ambient events inserted`)\r\n    return (num_events > 0);\r\n}\r\nfunction canMoveToLocation(gm, actor, location_xy) {\r\n    let level = gm.getCurrentLevel();\r\n    if (!(level.isValid(location_xy))) {\r\n        return false;\r\n    }\r\n    let t = level.terrain.getAt(location_xy);\r\n    return ((!(t.blocks_walking)) ||\r\n        (t.blocks_walking && (actor.hasFlag(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].Flag.PhaseWalk))) ||\r\n        ((!(t.blocks_flying)) && (actor.hasFlag(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].Flag.Flying))));\r\n}\r\nfunction knockback(gm, brEvent) {\r\n    let knockbackData = brEvent.knockbackData;\r\n    let knockback_path = calculateKnockbackPath(gm, knockbackData.origin_xy, knockbackData.magnitude, knockbackData.target);\r\n    if (knockback_path.length < 2) {\r\n        gm.endEvent(brEvent);\r\n        return;\r\n    }\r\n    let final_xy = knockback_path[knockback_path.length - 1];\r\n    // check if something else exists that that location\r\n    let level = gm.getCurrentLevel();\r\n    let mob_at = level.monsters.getAt(final_xy);\r\n    let attackEvent;\r\n    if (mob_at) {\r\n        final_xy = knockback_path[knockback_path.length - 2]; // todo: is this safe or do we need to check for knockback path distances < 2?\r\n    }\r\n    console.log(\"knockpath\", knockback_path);\r\n    let animationEvent = {\r\n        eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.RunAnimation,\r\n        actor: knockbackData.target,\r\n        playerInitiated: false,\r\n        endsTurn: false,\r\n        animationData: {\r\n            animationType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewAnimationType.OverPath,\r\n            code: knockbackData.target.code,\r\n            color: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].red,\r\n            from_xy: knockbackData.target.location,\r\n            to_xy: final_xy,\r\n            path: knockback_path\r\n        }\r\n    };\r\n    let moveEvent = {\r\n        eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.Move,\r\n        actor: knockbackData.target,\r\n        playerInitiated: false,\r\n        endsTurn: false,\r\n        moveData: {\r\n            from_xy: knockbackData.target.location,\r\n            to_xy: final_xy,\r\n        }\r\n    };\r\n    // gm.insertEvent(moveEvent)\r\n    // gm.insertEvent(animationEvent)\r\n    gm.insertEvent_Next(moveEvent);\r\n    gm.insertEvent_Next(animationEvent);\r\n    gm.endEvent(brEvent);\r\n}\r\nfunction calculateKnockbackPath(gm, origin_xy, distance, target) {\r\n    let target_xy = target.location.clone();\r\n    // let offset_xy = target_xy.subtract(origin_xy).toUnit()\r\n    // // todo: calculate slope and use that instead of this method which will only give straights/diagonals\r\n    // let flyaway_xy = offset_xy.multiplyScalar(distance)\r\n    // let final_xy = target_xy.add(flyaway_xy)\r\n    let final_xy = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].getTradjectoryCoordinate(origin_xy, target_xy, distance);\r\n    let full_path = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].getLineBetweenPoints(target_xy, final_xy);\r\n    let actual_path = [];\r\n    let level = gm.getCurrentLevel();\r\n    let terrain_at;\r\n    let mob_at;\r\n    let xy;\r\n    for (let i = 0; i < full_path.length; i++) {\r\n        xy = full_path[i];\r\n        if (!(level.isValid(xy))) {\r\n            break;\r\n        }\r\n        terrain_at = level.terrain.getAt(xy);\r\n        if ((terrain_at.blocks_flying) || (terrain_at.is_solid)) {\r\n            break;\r\n        }\r\n        mob_at = level.monsters.getAt(xy);\r\n        if ((mob_at) && (i > 0)) {\r\n            break;\r\n        }\r\n        actual_path.push(xy);\r\n    }\r\n    return actual_path;\r\n}\r\nfunction calculateKnockbackDistance(gm, origin_xy, magnitude, target) {\r\n    let target_xy = target.location.clone();\r\n    let dist = Math.floor(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].dist2d(origin_xy, target_xy));\r\n    return Math.max(0, magnitude - dist);\r\n}\r\nfunction triggerPortalUse(gm, brEvent) {\r\n    let portal = brEvent.portalData.portal_used;\r\n    // is this the escape portal?\r\n    let level = gm.getCurrentLevel();\r\n    // figure out if we're going somewhere in the same level or new level\r\n    if (portal.dest_level_id != gm.getCurrentLevel().id) {\r\n        // going to a new level\r\n        // make new levels on the fly!!\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"LevelGenerator\"].buildAndAttachNewLevel(gm, level, portal);\r\n        let changeLevelEvent = Object.assign({}, brEvent);\r\n        changeLevelEvent.eventType = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.ChangeLevel;\r\n        gm.insertEvent(changeLevelEvent);\r\n    }\r\n    // maybe it was an item\r\n    let portal_thing;\r\n    if (brEvent.itemData) {\r\n        portal_thing = brEvent.itemData.item;\r\n    }\r\n    else {\r\n        portal_thing = brEvent.actor;\r\n    }\r\n    gm.endEvent(brEvent);\r\n}\r\n// let movementDirectionCache \r\nfunction rest(gm, brEvent) {\r\n    // updateTurns(brEvent.actor.location, brEvent.actor.location)\r\n    if (brEvent.actor.isSameThing(gm.getPlayer())) {\r\n        resetStepTurns();\r\n    }\r\n    gm.endEvent(brEvent);\r\n}\r\nfunction resetStepTurns() {\r\n    last_step = null;\r\n    turn_history = [];\r\n}\r\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvYnJld19nYW1lL21vdmVtZW50LnRzP2ZlOWIiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBK0I7QUFHL0IsSUFBSSxZQUFZLEdBQW1CLEVBQUU7QUFDckMsSUFBSSxTQUEyQjtBQUUvQixxQkFBcUIsT0FBd0IsRUFBRSxLQUFzQjtJQUVqRSxJQUFJLGlCQUFpQixHQUFHLEtBQUssQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDO0lBRy9DLEVBQUUsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUM7UUFDWixJQUFJLFVBQVUsR0FBRyw2Q0FBWSxDQUFDLGVBQWUsQ0FBQyxTQUFTLEVBQUUsaUJBQWlCLENBQUM7UUFDM0UsWUFBWSxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUM7UUFDN0IsRUFBRSxDQUFDLENBQUMsWUFBWSxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQzFCLElBQUksS0FBSyxHQUFHLFlBQVksQ0FBQyxLQUFLLEVBQUU7UUFDcEMsQ0FBQztJQUNMLENBQUM7SUFDRCw0QkFBNEI7SUFDNUIsU0FBUyxHQUFHLGlCQUFpQjtBQUNqQyxDQUFDO0FBRUQ7SUFDSSxJQUFJLGNBQWMsR0FBOEIsMkNBQVUsQ0FBQyxhQUFhLENBQUMsSUFBSTtJQUU3RSxFQUFFLENBQUMsQ0FBQyxrQkFBa0IsRUFBRSxDQUFDLENBQUMsQ0FBQztRQUN2QixjQUFjLEdBQUcsMkNBQVUsQ0FBQyxhQUFhLENBQUMsVUFBVTtJQUN4RCxDQUFDO0lBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLGFBQWEsRUFBRSxDQUFDLENBQUMsQ0FBQztRQUN6QixjQUFjLEdBQUcsMkNBQVUsQ0FBQyxhQUFhLENBQUMsS0FBSztJQUNuRCxDQUFDO0lBRUQsTUFBTSxDQUFDLGNBQWM7QUFDekIsQ0FBQztBQUVEO0lBQ0ksRUFBRSxDQUFDLENBQUMsWUFBWSxDQUFDLE1BQU0sSUFBSSxDQUFDLENBQUMsQ0FBQyxD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QztBQUVELDhCQUE4QjtBQUN4QixjQUFlLEVBQW1CLEVBQUUsT0FBOEI7SUFDcEUsOERBQThEO0lBQzlELEVBQUUsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsV0FBVyxDQUFDLEVBQUUsQ0FBQyxTQUFTLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUM1QyxjQUFjLEVBQUU7SUFDcEIsQ0FBQztJQUNELEVBQUUsQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDO0FBQ3hCLENBQUM7QUFFRDtJQUNJLFNBQVMsR0FBRyxJQUFJO0lBQ2hCLFlBQVksR0FBRyxFQUFFO0FBQ3JCLENBQUMiLCJmaWxlIjoiLi9zcmMvYnJld19nYW1lL21vdmVtZW50LnRzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgQnJldyBmcm9tIFwiLi4vYnJld1wiXHJcbmltcG9ydCB7IHRhcmdldF9jdXJzb3IgfSBmcm9tIFwiLi4vYnJld19jb21wb25lbnRzL2NvbG9yXCI7XHJcblxyXG5sZXQgdHVybl9oaXN0b3J5IDogQXJyYXk8bnVtYmVyPiA9IFtdXHJcbmxldCBsYXN0X3N0ZXAgOiBCcmV3LkNvb3JkaW5hdGVcclxuXHJcbmZ1bmN0aW9uIHVwZGF0ZVR1cm5zKGZyb21feHk6IEJyZXcuQ29vcmRpbmF0ZSwgdG9feHk6IEJyZXcuQ29vcmRpbmF0ZSkge1xyXG4gICAgXHJcbiAgICBsZXQgc3RlcF9kaXJlY3Rpb25feHkgPSB0b194eS5zdWJ0cmFjdChmcm9tX3h5KVxyXG4gICAgXHJcblxyXG4gICAgaWYgKGxhc3Rfc3RlcCkge1xyXG4gICAgICAgIGxldCB0dXJuX2FuZ2xlID0gQnJldy5UdXJuaW5nLmdldEFuZ2xlQmV0d2VlbihsYXN0X3N0ZXAsIHN0ZXBfZGlyZWN0aW9uX3h5KVxyXG4gICAgICAgIHR1cm5faGlzdG9yeS5wdXNoKHR1cm5fYW5nbGUpXHJcbiAgICAgICAgaWYgKHR1cm5faGlzdG9yeS5sZW5ndGggPiA0KSB7XHJcbiAgICAgICAgICAgIGxldCBmaXJzdCA9IHR1cm5faGlzdG9yeS5zaGlmdCgpXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLy8gY29uc29sZS5sb2codHVybl9oaXN0b3J5KVxyXG4gICAgbGFzdF9zdGVwID0gc3RlcF9kaXJlY3Rpb25feHlcclxufVxyXG5cclxuZnVuY3Rpb24gY2hlY2tGb3JGYW5jeVN0ZXBzKCkgOiBCcmV3LkVudW1zLkZhbmN5U3RlcFR5cGUge1xyXG4gICAgbGV0IGZhbmN5X2Zvb3R3b3JrIDogQnJldy5FbnVtcy5GYW5jeVN0ZXBUeXBlID0gQnJldy5FbnVtcy5GYW5jeVN0ZXBUeXBlLk5vbmVcclxuXHJcbiAgICBpZiAoY2hlY2tGb3JTcXVhcmVTdGVwKCkpIHtcclxuICAgICAgICBmYW5jeV9mb290d29yayA9IEJyZXcuRW51bXMuRmFuY3lTdGVwVHlwZS5TcXVhcmVzdGVwXHJcbiAgICB9IGVsc2UgaWYgKGNoZWNrRm9yTHVuZ2UoKSkge1xyXG4gICAgICAgIGZhbmN5X2Zvb3R3b3JrID0gQnJldy5FbnVtcy5GYW5jeVN0ZXBUeXBlLkx1bmdlXHJcbiAgICB9IFxyXG5cclxuICAgIHJldHVybiBmYW5jeV9mb290d29ya1xyXG59XHJcblxyXG5mdW5jdGlvbiBjaGVja0Zvckx1bmdlKCkgOiBib29sZWFuIHtcclxuICAgIGlmICh0dXJuX2hpc3RvcnkubGVuZ3RoID09IDApIHtcclxuICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgIH1cclxuXHJcbiAgICBsZXQgbGFzdF90dXJuID0gdHVybl9oaXN0b3J5W3R1cm5faGlzdG9yeS5sZW5ndGgtMV1cclxuICAgIHJldHVybiBNYXRoLmFicyhsYXN0X3R1cm4pID09IE1hdGguUElcclxufVxyXG5cclxuZnVuY3Rpb24gY2hlY2tGb3JTcXVhcmVTdGVwKCkgOiBib29sZWFuIHtcclxuICAgIGxldCBoYWxmX3BpID0gTWF0aC5QSSAvIDJcclxuXHJcbiAgICBpZiAodHVybl9oaXN0b3J5Lmxlbmd0aCA8IDQpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgIH1cclxuXHJcbiAgICBsZXQgcXRyX3R1cm5faW5kaWNhdG9ycyA9IHR1cm5faGlzdG9yeS5tYXAoKGFuZ2xlX3JhZHMpIDogbnVtYmVyID0+IHtcclxuICAgICAgICBpZiAoTWF0aC5hYnMoYW5nbGVfcmFkcykgPT0gaGFsZl9waSkge1xyXG4gICAgICAgICAgICByZXR1cm4gTWF0aC5zaWduKGFuZ2xlX3JhZHMpXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIDBcclxuICAgICAgICB9XHJcbiAgICB9KVxyXG4gICAgXHJcbiAgICBsZXQgc3VtX29mX3R1cm5zID0gcXRyX3R1cm5faW5kaWNhdG9ycy5yZWR1Y2UoKHByZXZfdmFsOiBudW1iZXIsIGN1cnJlbnRfdmFsOiBudW1iZXIpIDogbnVtYmVyID0+IHtcclxuICAgICAgICByZXR1cm4gcHJldl92YWwgKyBjdXJyZW50X3ZhbFxyXG4gICAgfSwgMClcclxuXHJcbiAgICBsZXQgaXNfY2lyY2xlX3N0ZXAgPSBNYXRoLmFicyhzdW1fb2ZfdHVybnMpID09IDRcclxuXHJcbiAgICByZXR1cm4gaXNfY2lyY2xlX3N0ZXBcclxuICAgIFxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gbW92ZShnbTogQnJldy5HYW1lTWFzdGVyLCBkYXRhOiBCcmV3LkVudW1zLklCcmV3RXZlbnQpIHtcclxuICAgIGxldCBsZXZlbCA9IGdtLmdldEN1cnJlbnRMZXZlbCgpXHJcblxyXG4gICAgLy8gZGVidWc6IGNoZWNrIGlmIGxvY2F0aW9uIGlzIGZ1bGwgb2YgYSBtb25zdGVyIGFscmVhZHlcclxuICAgIGxldCBtX2F0ID0gbGV2ZWwubW9uc3RlcnMuZ2V0QXQoZGF0YS5tb3ZlRGF0YS50b194eSlcclxuICAgIGlmIChtX2F0KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihgJHtkYXRhLmFjdG9yLm5hbWV9IHRyeWluZyB0byBtb3ZlIG9udG8gYW4gb2NjdXBpZWQgZ3JpZCwgJHtkYXRhLm1vdmVEYXRhLmZyb21feHl9IC0+ICR7ZGF0YS5tb3ZlRGF0YS50b194eX1gKVxyXG4gICAgfVxyXG4gICAgQnJldy5QYXJ0cy5yZW1vdmVNb25zdGVyUGFydHNGcm9tR3JpZChnbSwgZGF0YS5hY3RvcilcclxuXHJcbiAgICBsZXZlbC5tb25zdGVycy5yZW1vdmVBdChkYXRhLm1vdmVEYXRhLmZyb21feHkpXHJcbiAgICBsZXZlbC5tb25zdGVycy5zZXRBdChkYXRhLm1vdmVEYXRhLnRvX3h5LCBkYXRhLmFjdG9yKVxyXG5cclxuICAgIEJyZXcuUGFydHMudXBkYXRlTW9uc3RlclBhcnRzKGdtLCBkYXRhLmFjdG9yKVxyXG4gICAgQnJldy5QYXJ0cy5wbGFjZU1vbnN0ZXJQYXJ0c09uR3JpZChnbSwgZGF0YS5hY3RvcilcclxuXHJcbiAgICAvLyBjaGVjayBmb3IgdHJpZ2dlciBldmVudHNcclxuICAgIGxldCBkaWRUcmlnZ2VyID0gY2hlY2tGb3JUcmlnZ2VyT25TdGVwKGdtLCBkYXRhLmFjdG9yLCBkYXRhLm1vdmVEYXRhLnRvX3h5LCBkYXRhLm1vdmVEYXRhLmZyb21feHkpXHJcbiAgICBsZXQgYW1iaWVudFRyaWdnZXIgPSBjaGVja0ZvckFtYmllbnRFZmZlY3RzKGdtLCBkYXRhLmFjdG9yKVxyXG5cclxuICAgIC8vIGlmIChCcmV3LkludGVsLmlzUGxheWVyKGdtLCBkYXRhLmFjdG9yKSkge1xyXG4gICAgLy8gICAgIHVwZGF0ZVR1cm5zKGRhdGEubW92ZURhdGEuZnJvbV94eSwgZGF0YS5tb3ZlRGF0YS50b194eSlcclxuICAgICAgICBcclxuICAgIC8vIH1cclxuXHJcblxyXG4gICAgLy8gdHVybiBvZmYgdGFyZ2V0IGxvY2tzIHdoZW4gc29tZW9uZSBtb3Zlc1xyXG4gICAgQnJldy5UYXJnZXRpbmcuY2xlYXJUYXJnZXRMb2Nrc0J5KGRhdGEuYWN0b3IpXHJcblxyXG4gICAgZ20uZGlzcGxheUxpc3QoW2RhdGEubW92ZURhdGEuZnJvbV94eSwgZGF0YS5tb3ZlRGF0YS50b194eV0pXHJcbiAgICBnbS5lbmRFdmVudChkYXRhKVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY2hlY2tGb3JJbXBhY3RPZk5ld1BhcnRzKGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGFjdG9yOiBCcmV3LkdyaWRUaGluZ3MuTW9uc3RlciwgY29tcG9uZW50X3BhcnRzOiBBcnJheTxCcmV3LkdyaWRUaGluZ3MuRmVhdHVyZT4pIDogYm9vbGVhbiB7XHJcbiAgICBsZXQgbGV2ZWwgPSBnbS5nZXRDdXJyZW50TGV2ZWwoKVxyXG4gICAgbGV0IHRlcnJhaW5fYXQgOkJyZXcuR3JpZFRoaW5ncy5UZXJyYWluXHJcbiAgICBsZXQgbnVtX2NoYW5nZXMgPSAwXHJcblxyXG4gICAgZm9yIChsZXQgcGFydCBvZiBjb21wb25lbnRfcGFydHMpIHtcclxuICAgICAgICBpZiAobGV2ZWwuaXNWYWxpZChwYXJ0LmxvY2F0aW9uKSkge1xyXG4gICAgICAgICAgICB0ZXJyYWluX2F0ID0gbGV2ZWwudGVycmFpbi5nZXRBdChwYXJ0LmxvY2F0aW9uKVxyXG4gICAgICAgICAgICBpZiAoKHRlcnJhaW5fYXQuaXNUeXBlKEJyZXcuRGVmaW5pdGlvbnMuVGVycmFpblR5cGUuUm9jaykpIHx8ICh0ZXJyYWluX2F0LmlzVHlwZShCcmV3LkRlZmluaXRpb25zLlRlcnJhaW5UeXBlLkJyb2tlbl9XYWxsKSkpIHtcclxuICAgICAgICAgICAgICAgIGxldmVsLnRlcnJhaW4ucmVtb3ZlQXQocGFydC5sb2NhdGlvbilcclxuICAgICAgICAgICAgICAgIGxldmVsLnRlcnJhaW4uc2V0QXQocGFydC5sb2NhdGlvbiwgQnJldy5EZWZpbml0aW9ucy50ZXJyYWluRmFjdG9yeShCcmV3LkRlZmluaXRpb25zLlRlcnJhaW5UeXBlLlJ1YmJsZSkpXHJcbiAgICAgICAgICAgICAgICBudW1fY2hhbmdlcyArPSAxXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIG51bV9jaGFuZ2VzID4gMFxyXG59XHJcblxyXG5mdW5jdGlvbiBjaGVja0ZvclRyaWdnZXJPblN0ZXAoZ206IEJyZXcuR2FtZU1hc3RlciwgYWN0b3I6IEJyZXcuR3JpZFRoaW5ncy5Nb25zdGVyLCBsb2NhdGlvbl94eTogQnJldy5Db29yZGluYXRlLCBwcmV2aW91c194eTogQnJldy5Db29yZGluYXRlKSA6IGJvb2xlYW4ge1xyXG5cclxuICAgIGxldCBsZXZlbCA9IGdtLmdldEN1cnJlbnRMZXZlbCgpXHJcbiAgICBsZXQgdHJpZ2dlckV2ZW50IDogQnJldy5FbnVtcy5JQnJld0V2ZW50XHJcbiAgICBsZXQgbnVtX2V2ZW50cyA9IDBcclxuICAgIFxyXG4gICAgLy8gXHJcbiAgICBsZXQgdGVycmFpbl9hdCA9IGxldmVsLnRlcnJhaW4uZ2V0QXQobG9jYXRpb25feHkpXHJcbiAgICBsZXQgdGVycmFpbl9mcm9tID0gbGV2ZWwudGVycmFpbi5nZXRBdChwcmV2aW91c194eSlcclxuICAgIGxldCBkb29yX2NoYW5nZSA6IGJvb2xlYW5cclxuXHJcbiAgICBpZiAoaXNEb29yKHRlcnJhaW5fYXQpKSB7XHJcbiAgICAgICAgZG9vcl9jaGFuZ2UgPSBob2xkVGhlRG9vcihnbSwgdGVycmFpbl9hdClcclxuICAgICAgICBpZiAoZG9vcl9jaGFuZ2UpIHtcclxuICAgICAgICAgICAgZ20uZGlzcGxheUF0KGxvY2F0aW9uX3h5KVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBpZiAoaXNEb29yKHRlcnJhaW5fZnJvbSkpIHtcclxuICAgICAgICBkb29yX2NoYW5nZSA9IGhvbGRUaGVEb29yKGdtLCB0ZXJyYWluX2Zyb20pXHJcbiAgICAgICAgaWYgKGRvb3JfY2hhbmdlKSB7XHJcbiAgICAgICAgICAgIGdtLmRpc3BsYXlBdChwcmV2aW91c194eSlcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJldHVybiAobnVtX2V2ZW50cyA+IDApXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBpc0Rvb3IodGVycmFpbjogQnJldy5HcmlkVGhpbmdzLlRlcnJhaW4pIDogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gKCh0ZXJyYWluLmlzVHlwZShCcmV3LkRlZmluaXRpb25zLlRlcnJhaW5UeXBlLkRvb3IpIHx8IHRlcnJhaW4uaXNUeXBlKEJyZXcuRGVmaW5pdGlvbnMuVGVycmFpblR5cGUuRG9vck9wZW4pKSlcclxufVxyXG5cclxuZnVuY3Rpb24gaG9sZFRoZURvb3IoZ206IEJyZXcuR2FtZU1hc3RlciwgdGhlX2Rvb3I6IEJyZXcuR3JpZFRoaW5ncy5UZXJyYWluKSA6IGJvb2xlYW4ge1xyXG4gICAgbGV0IGxldmVsID0gZ20uZ2V0Q3VycmVudExldmVsKClcclxuICAgIGxldCB4eSA9IHRoZV9kb29yLmxvY2F0aW9uLmNsb25lKClcclxuICAgIGxldCBtb25zdGVyX29uX2l0ID0gbGV2ZWwubW9uc3RlcnMuZ2V0QXQoeHkpXHJcbiAgICBsZXQgaXRlbV9vbl9pdCA9IGxldmVsLml0ZW1zLmdldEF0KHh5KVxyXG4gICAgbGV0IHNvbWV0aGluZ19vbl9pdCA9IG1vbnN0ZXJfb25faXQgfHwgaXRlbV9vbl9pdFxyXG5cclxuICAgIC8vIGlmIGl0cyBjbG9zZWRcclxuICAgIGlmICh0aGVfZG9vci5pc1R5cGUoQnJldy5EZWZpbml0aW9ucy5UZXJyYWluVHlwZS5Eb29yKSkge1xyXG4gICAgICAgIC8vIGFuZCBzb21lb25lIGlzIHN0YW5kaW5nIG9uIGl0LCBtYWtlIGl0IG9wZW5cclxuICAgICAgICBpZiAoc29tZXRoaW5nX29uX2l0KSB7XHJcbiAgICAgICAgICAgIGxldmVsLnRlcnJhaW4ucmVtb3ZlQXQoeHkpXHJcbiAgICAgICAgICAgIGxldmVsLnRlcnJhaW4uc2V0QXQoeHksIEJyZXcuRGVmaW5pdGlvbnMudGVycmFpbkZhY3RvcnkoQnJldy5EZWZpbml0aW9ucy5UZXJyYWluVHlwZS5Eb29yT3BlbikpXHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIGlmIGl0cyBvcGVuXHJcbiAgICBpZiAodGhlX2Rvb3IuaXNUeXBlKEJyZXcuRGVmaW5pdGlvbnMuVGVycmFpblR5cGUuRG9vck9wZW4pKSB7XHJcbiAgICAgICAgLy8gYW5kIG5vIG9uZSBpcyBzdGFuZGluZyBvbiBpdCwgY2xvc2UgaXRcclxuICAgICAgICBpZiAoIShzb21ldGhpbmdfb25faXQpKSB7XHJcbiAgICAgICAgICAgIGxldmVsLnRlcnJhaW4ucmVtb3ZlQXQoeHkpXHJcbiAgICAgICAgICAgIGxldmVsLnRlcnJhaW4uc2V0QXQoeHksIEJyZXcuRGVmaW5pdGlvbnMudGVycmFpbkZhY3RvcnkoQnJldy5EZWZpbml0aW9ucy5UZXJyYWluVHlwZS5Eb29yKSlcclxuICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGZhbHNlXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjaGVja0ZvckFtYmllbnRFZmZlY3RzKGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGFjdG9yOiBCcmV3LkdyaWRUaGluZ3MuTW9uc3RlcikgOiBib29sZWFuIHtcclxuXHJcbiAgICBsZXQgbGV2ZWwgPSBnbS5nZXRDdXJyZW50TGV2ZWwoKVxyXG4gICAgbGV0IHRyaWdnZXJFdmVudCA6IEJyZXcuRW51bXMuSUJyZXdFdmVudFxyXG4gICAgbGV0IG51bV9ldmVudHMgPSAwXHJcbiAgICBsZXQgbG9jYXRpb25feHkgPSBhY3Rvci5sb2NhdGlvblxyXG5cclxuICAgIC8vIGNoZWNrIGZvciBwYXJ0L2NvbXBvbmVudHMgb2Ygb3RoZXIgbW9uc3RlcnNcclxuICAgIGxldCBwYXJ0X2F0ID0gbGV2ZWwucGFydHMuZ2V0QXQobG9jYXRpb25feHkpXHJcbiAgICBpZiAocGFydF9hdCkge1xyXG4gICAgICAgIGlmIChwYXJ0X2F0LmlzVHlwZShCcmV3LkRlZmluaXRpb25zLkZlYXR1cmVUeXBlLlRhbmtQYXJ0KSAmJiAoIShwYXJ0X2F0LmdldFBhcmVudCgpLmlzU2FtZVRoaW5nKGFjdG9yKSkpKSB7XHJcbiAgICAgICAgICAgIC8vIHNtb29zaGVkIGJ5IGEgdGFua1xyXG4gICAgICAgICAgICB0cmlnZ2VyRXZlbnQgPSB7XHJcbiAgICAgICAgICAgICAgICBldmVudFR5cGU6IEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5BdHRhY2ssXHJcbiAgICAgICAgICAgICAgICBhY3RvcjogYWN0b3IsXHJcbiAgICAgICAgICAgICAgICBwbGF5ZXJJbml0aWF0ZWQ6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgZW5kc1R1cm46IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgYXR0YWNrRGF0YToge1xyXG4gICAgICAgICAgICAgICAgICAgIGZyb21feHk6IGxvY2F0aW9uX3h5LFxyXG4gICAgICAgICAgICAgICAgICAgIHRvX3h5OiBsb2NhdGlvbl94eSxcclxuICAgICAgICAgICAgICAgICAgICB0YXJnZXQ6IGFjdG9yLFxyXG4gICAgICAgICAgICAgICAgICAgIGlzTWVsZWU6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgZGFtYWdlOiAxLFxyXG4gICAgICAgICAgICAgICAgICAgIGVmZmVjdHM6IFtdLFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnbS5pbnNlcnRFdmVudCh0cmlnZ2VyRXZlbnQpXHJcbiAgICAgICAgICAgIG51bV9ldmVudHMgKz0gMVxyXG4gICAgICAgIH0gICAgXHJcbiAgICB9XHJcbiAgICAvLyBjaGVjayBmb3IgaW50ZXJhY3RpdmUgZmVhdHVyZXNcclxuICAgIGxldCBmZWF0dXJlX2F0ID0gbGV2ZWwuZmVhdHVyZXMuZ2V0QXQobG9jYXRpb25feHkpXHJcbiAgICBpZiAoZmVhdHVyZV9hdCkge1xyXG4gICAgICAgIGlmIChmZWF0dXJlX2F0LmlzVHlwZShCcmV3LkRlZmluaXRpb25zLkZlYXR1cmVUeXBlLlJlcGFpckdvbykpIHtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGFjdG9yLmhwLmluY3JlbWVudCgxKVxyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgJHthY3Rvci5uYW1lfSBoZWFsdGggaXMgbm93ICR7YWN0b3IuaHB9YClcclxuICAgICAgICAgICAgbGV2ZWwuZmVhdHVyZXMucmVtb3ZlQXQobG9jYXRpb25feHkpXHJcblxyXG4gICAgICAgIH0gZWxzZSBpZiAoZmVhdHVyZV9hdC5pc1R5cGUoQnJldy5EZWZpbml0aW9ucy5GZWF0dXJlVHlwZS5Db3Jyb3NpdmVBY2lkKSkge1xyXG4gICAgICAgICAgICBsZXZlbC5mZWF0dXJlcy5yZW1vdmVBdChsb2NhdGlvbl94eSlcclxuXHJcbiAgICAgICAgICAgIHRyaWdnZXJFdmVudCA9IHtcclxuICAgICAgICAgICAgICAgIGV2ZW50VHlwZTogQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLkF0dGFjayxcclxuICAgICAgICAgICAgICAgIGFjdG9yOiBhY3RvcixcclxuICAgICAgICAgICAgICAgIHBsYXllckluaXRpYXRlZDogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICBlbmRzVHVybjogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICBhdHRhY2tEYXRhOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZnJvbV94eTogbG9jYXRpb25feHksXHJcbiAgICAgICAgICAgICAgICAgICAgdG9feHk6IGxvY2F0aW9uX3h5LFxyXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldDogYWN0b3IsXHJcbiAgICAgICAgICAgICAgICAgICAgaXNNZWxlZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBkYW1hZ2U6IDAsXHJcbiAgICAgICAgICAgICAgICAgICAgZWZmZWN0czogW0JyZXcuRW51bXMuRmxhZy5DYXVzZXNXZWFrXSwgLy8gdG9kbzogd2F5IHRvIGNvbG9yIGF0dGFjayBmbGFzaGVzXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGdtLmluc2VydEV2ZW50KHRyaWdnZXJFdmVudClcclxuICAgICAgICAgICAgbnVtX2V2ZW50cyArPSAxXHJcbiAgICAgICAgfSBlbHNlIGlmIChmZWF0dXJlX2F0LmlzVHlwZShCcmV3LkRlZmluaXRpb25zLkZlYXR1cmVUeXBlLlByb3RlY3RpdmVHb28pKSB7XHJcbiAgICAgICAgICAgIGxldmVsLmZlYXR1cmVzLnJlbW92ZUF0KGxvY2F0aW9uX3h5KVxyXG5cclxuICAgICAgICAgICAgdHJpZ2dlckV2ZW50ID0ge1xyXG4gICAgICAgICAgICAgICAgZXZlbnRUeXBlOiBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuQXR0YWNrLFxyXG4gICAgICAgICAgICAgICAgYWN0b3I6IGFjdG9yLFxyXG4gICAgICAgICAgICAgICAgcGxheWVySW5pdGlhdGVkOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgIGVuZHNUdXJuOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgIGF0dGFja0RhdGE6IHtcclxuICAgICAgICAgICAgICAgICAgICBmcm9tX3h5OiBsb2NhdGlvbl94eSxcclxuICAgICAgICAgICAgICAgICAgICB0b194eTogbG9jYXRpb25feHksXHJcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0OiBhY3RvcixcclxuICAgICAgICAgICAgICAgICAgICBpc01lbGVlOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIGRhbWFnZTogMCxcclxuICAgICAgICAgICAgICAgICAgICBlZmZlY3RzOiBbQnJldy5FbnVtcy5GbGFnLkNhdXNlc0ludnVsbmVyYWJsZV0sIC8vIHRvZG86IHdheSB0byBjb2xvciBhdHRhY2sgZmxhc2hlc1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBnbS5pbnNlcnRFdmVudCh0cmlnZ2VyRXZlbnQpXHJcbiAgICAgICAgICAgIG51bV9ldmVudHMgKz0gMVxyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgfVxyXG4gICAgLy8gY29uc29sZS5sb2coYCR7bnVtX2V2ZW50c30gYW1iaWVudCBldmVudHMgaW5zZXJ0ZWRgKVxyXG4gICAgcmV0dXJuIChudW1fZXZlbnRzID4gMClcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNhbk1vdmVUb0xvY2F0aW9uKGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGFjdG9yOiBCcmV3LkdyaWRUaGluZ3MuTW9uc3RlciwgbG9jYXRpb25feHk6IEJyZXcuQ29vcmRpbmF0ZSkgOiBib29sZWFuIHtcclxuICAgIGxldCBsZXZlbCA9IGdtLmdldEN1cnJlbnRMZXZlbCgpXHJcblxyXG4gICAgaWYgKCEobGV2ZWwuaXNWYWxpZChsb2NhdGlvbl94eSkpKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICB9XHJcblxyXG4gICAgbGV0IHQgPSBsZXZlbC50ZXJyYWluLmdldEF0KGxvY2F0aW9uX3h5KVxyXG4gICAgcmV0dXJuIChcclxuICAgICAgICAoISh0LmJsb2Nrc193YWxraW5nKSkgfHxcclxuICAgICAgICAodC5ibG9ja3Nfd2Fsa2luZyAmJiAoYWN0b3IuaGFzRmxhZyhCcmV3LkVudW1zLkZsYWcuUGhhc2VXYWxrKSkpIHx8XHJcbiAgICAgICAgKCghKHQuYmxvY2tzX2ZseWluZykpICYmIChhY3Rvci5oYXNGbGFnKEJyZXcuRW51bXMuRmxhZy5GbHlpbmcpKSkgXHJcbiAgICApXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBrbm9ja2JhY2soZ206IEJyZXcuR2FtZU1hc3RlciwgYnJFdmVudDogQnJldy5FbnVtcy5JQnJld0V2ZW50KSB7XHJcbiAgICBsZXQga25vY2tiYWNrRGF0YSA9IGJyRXZlbnQua25vY2tiYWNrRGF0YVxyXG5cclxuICAgIGxldCBrbm9ja2JhY2tfcGF0aCA9IGNhbGN1bGF0ZUtub2NrYmFja1BhdGgoZ20sIGtub2NrYmFja0RhdGEub3JpZ2luX3h5LCBrbm9ja2JhY2tEYXRhLm1hZ25pdHVkZSwga25vY2tiYWNrRGF0YS50YXJnZXQpXHJcbiAgICBpZiAoa25vY2tiYWNrX3BhdGgubGVuZ3RoIDwgMikge1xyXG4gICAgICAgIGdtLmVuZEV2ZW50KGJyRXZlbnQpXHJcbiAgICAgICAgcmV0dXJuXHJcbiAgICB9XHJcblxyXG4gICAgbGV0IGZpbmFsX3h5ID0ga25vY2tiYWNrX3BhdGhba25vY2tiYWNrX3BhdGgubGVuZ3RoIC0gMV1cclxuICAgIFxyXG4gICAgLy8gY2hlY2sgaWYgc29tZXRoaW5nIGVsc2UgZXhpc3RzIHRoYXQgdGhhdCBsb2NhdGlvblxyXG4gICAgbGV0IGxldmVsID0gZ20uZ2V0Q3VycmVudExldmVsKClcclxuICAgIGxldCBtb2JfYXQgPSBsZXZlbC5tb25zdGVycy5nZXRBdChmaW5hbF94eSlcclxuICAgIGxldCBhdHRhY2tFdmVudCA6IEJyZXcuRW51bXMuSUJyZXdFdmVudFxyXG5cclxuICAgIGlmIChtb2JfYXQpIHtcclxuICAgICAgICBmaW5hbF94eSA9IGtub2NrYmFja19wYXRoW2tub2NrYmFja19wYXRoLmxlbmd0aCAtIDJdIC8vIHRvZG86IGlzIHRoaXMgc2FmZSBvciBkbyB3ZSBuZWVkIHRvIGNoZWNrIGZvciBrbm9ja2JhY2sgcGF0aCBkaXN0YW5jZXMgPCAyP1xyXG4gICAgICAgIFxyXG4gICAgfVxyXG4gICAgY29uc29sZS5sb2coXCJrbm9ja3BhdGhcIiwga25vY2tiYWNrX3BhdGgpXHJcblxyXG4gICAgbGV0IGFuaW1hdGlvbkV2ZW50IDogQnJldy5FbnVtcy5JQnJld0V2ZW50ID0ge1xyXG4gICAgICAgIGV2ZW50VHlwZTogQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLlJ1bkFuaW1hdGlvbixcclxuICAgICAgICBhY3Rvcjoga25vY2tiYWNrRGF0YS50YXJnZXQsXHJcbiAgICAgICAgcGxheWVySW5pdGlhdGVkOiBmYWxzZSxcclxuICAgICAgICBlbmRzVHVybjogZmFsc2UsXHJcbiAgICAgICAgYW5pbWF0aW9uRGF0YToge1xyXG4gICAgICAgICAgICBhbmltYXRpb25UeXBlOiBCcmV3LkVudW1zLkJyZXdBbmltYXRpb25UeXBlLk92ZXJQYXRoLFxyXG4gICAgICAgICAgICBjb2RlOiBrbm9ja2JhY2tEYXRhLnRhcmdldC5jb2RlLFxyXG4gICAgICAgICAgICBjb2xvcjogQnJldy5Db2xvci5yZWQsXHJcbiAgICAgICAgICAgIGZyb21feHk6IGtub2NrYmFja0RhdGEudGFyZ2V0LmxvY2F0aW9uLFxyXG4gICAgICAgICAgICB0b194eTogZmluYWxfeHksXHJcbiAgICAgICAgICAgIHBhdGg6IGtub2NrYmFja19wYXRoXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGxldCBtb3ZlRXZlbnQgOiBCcmV3LkVudW1zLklCcmV3RXZlbnQgPSB7XHJcbiAgICAgICAgZXZlbnRUeXBlOiBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuTW92ZSxcclxuICAgICAgICBhY3Rvcjoga25vY2tiYWNrRGF0YS50YXJnZXQsXHJcbiAgICAgICAgcGxheWVySW5pdGlhdGVkOiBmYWxzZSxcclxuICAgICAgICBlbmRzVHVybjogZmFsc2UsXHJcbiAgICAgICAgbW92ZURhdGE6IHtcclxuICAgICAgICAgICAgZnJvbV94eToga25vY2tiYWNrRGF0YS50YXJnZXQubG9jYXRpb24sXHJcbiAgICAgICAgICAgIHRvX3h5OiBmaW5hbF94eSxcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gZ20uaW5zZXJ0RXZlbnQobW92ZUV2ZW50KVxyXG4gICAgLy8gZ20uaW5zZXJ0RXZlbnQoYW5pbWF0aW9uRXZlbnQpXHJcbiAgICBnbS5pbnNlcnRFdmVudF9OZXh0KG1vdmVFdmVudClcclxuICAgIGdtLmluc2VydEV2ZW50X05leHQoYW5pbWF0aW9uRXZlbnQpXHJcblxyXG4gICAgZ20uZW5kRXZlbnQoYnJFdmVudClcclxufVxyXG5cclxuZnVuY3Rpb24gY2FsY3VsYXRlS25vY2tiYWNrUGF0aChnbTogQnJldy5HYW1lTWFzdGVyLCBvcmlnaW5feHk6IEJyZXcuQ29vcmRpbmF0ZSwgZGlzdGFuY2U6IG51bWJlciwgdGFyZ2V0OiBCcmV3LkdyaWRUaGluZ3MuTW9uc3RlcikgOiBBcnJheTxCcmV3LkNvb3JkaW5hdGU+IHtcclxuXHJcbiAgICBsZXQgdGFyZ2V0X3h5ID0gdGFyZ2V0LmxvY2F0aW9uLmNsb25lKClcclxuICAgIC8vIGxldCBvZmZzZXRfeHkgPSB0YXJnZXRfeHkuc3VidHJhY3Qob3JpZ2luX3h5KS50b1VuaXQoKVxyXG4gICAgLy8gLy8gdG9kbzogY2FsY3VsYXRlIHNsb3BlIGFuZCB1c2UgdGhhdCBpbnN0ZWFkIG9mIHRoaXMgbWV0aG9kIHdoaWNoIHdpbGwgb25seSBnaXZlIHN0cmFpZ2h0cy9kaWFnb25hbHNcclxuICAgIC8vIGxldCBmbHlhd2F5X3h5ID0gb2Zmc2V0X3h5Lm11bHRpcGx5U2NhbGFyKGRpc3RhbmNlKVxyXG4gICAgLy8gbGV0IGZpbmFsX3h5ID0gdGFyZ2V0X3h5LmFkZChmbHlhd2F5X3h5KVxyXG4gICAgbGV0IGZpbmFsX3h5ID0gQnJldy5VdGlscy5nZXRUcmFkamVjdG9yeUNvb3JkaW5hdGUob3JpZ2luX3h5LCB0YXJnZXRfeHksIGRpc3RhbmNlKVxyXG5cclxuICAgIGxldCBmdWxsX3BhdGggPSBCcmV3LlV0aWxzLmdldExpbmVCZXR3ZWVuUG9pbnRzKHRhcmdldF94eSwgZmluYWxfeHkpXHJcbiAgICBsZXQgYWN0dWFsX3BhdGggOiBBcnJheTxCcmV3LkNvb3JkaW5hdGU+ID0gW11cclxuICAgIGxldCBsZXZlbCA9IGdtLmdldEN1cnJlbnRMZXZlbCgpXHJcbiAgICBsZXQgdGVycmFpbl9hdCA6IEJyZXcuR3JpZFRoaW5ncy5UZXJyYWluXHJcbiAgICBsZXQgbW9iX2F0IDogQnJldy5HcmlkVGhpbmdzLk1vbnN0ZXJcclxuICAgIGxldCB4eTogQnJldy5Db29yZGluYXRlXHJcblxyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBmdWxsX3BhdGgubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICB4eSA9IGZ1bGxfcGF0aFtpXVxyXG4gICAgICAgIGlmICghKGxldmVsLmlzVmFsaWQoeHkpKSkge1xyXG4gICAgICAgICAgICBicmVha1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICB0ZXJyYWluX2F0ID0gbGV2ZWwudGVycmFpbi5nZXRBdCh4eSlcclxuICAgICAgICBpZiAoKHRlcnJhaW5fYXQuYmxvY2tzX2ZseWluZykgfHwgKHRlcnJhaW5fYXQuaXNfc29saWQpKSB7XHJcbiAgICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgfSBcclxuICAgICAgICBcclxuICAgICAgICBtb2JfYXQgPSBsZXZlbC5tb25zdGVycy5nZXRBdCh4eSlcclxuICAgICAgICBpZiAoKG1vYl9hdCkgJiYgKGkgPiAwKSkge1xyXG4gICAgICAgICAgICBicmVha1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgYWN0dWFsX3BhdGgucHVzaCh4eSlcclxuICAgICAgICBcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gYWN0dWFsX3BhdGhcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNhbGN1bGF0ZUtub2NrYmFja0Rpc3RhbmNlKGdtOiBCcmV3LkdhbWVNYXN0ZXIsIG9yaWdpbl94eTogQnJldy5Db29yZGluYXRlLCBtYWduaXR1ZGU6IG51bWJlciwgdGFyZ2V0OiBCcmV3LkdyaWRUaGluZ3MuTW9uc3RlcikgOiBudW1iZXIge1xyXG5cclxuICAgIGxldCB0YXJnZXRfeHkgPSB0YXJnZXQubG9jYXRpb24uY2xvbmUoKVxyXG4gICAgbGV0IGRpc3QgPSBNYXRoLmZsb29yKEJyZXcuVXRpbHMuZGlzdDJkKG9yaWdpbl94eSwgdGFyZ2V0X3h5KSlcclxuXHJcbiAgICByZXR1cm4gTWF0aC5tYXgoMCwgbWFnbml0dWRlIC0gZGlzdClcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHRyaWdnZXJQb3J0YWxVc2UoZ206IEJyZXcuR2FtZU1hc3RlciwgYnJFdmVudDogQnJldy5FbnVtcy5JQnJld0V2ZW50KSB7XHJcblxyXG4gICAgbGV0IHBvcnRhbCA6IEJyZXcuUG9ydGFsID0gYnJFdmVudC5wb3J0YWxEYXRhLnBvcnRhbF91c2VkIFxyXG4gICAgXHJcbiAgICAvLyBpcyB0aGlzIHRoZSBlc2NhcGUgcG9ydGFsP1xyXG4gICAgbGV0IGxldmVsID0gZ20uZ2V0Q3VycmVudExldmVsKClcclxuXHJcbiAgICAvLyBmaWd1cmUgb3V0IGlmIHdlJ3JlIGdvaW5nIHNvbWV3aGVyZSBpbiB0aGUgc2FtZSBsZXZlbCBvciBuZXcgbGV2ZWxcclxuICAgIGlmIChwb3J0YWwuZGVzdF9sZXZlbF9pZCAhPSBnbS5nZXRDdXJyZW50TGV2ZWwoKS5pZCkge1xyXG4gICAgICAgIC8vIGdvaW5nIHRvIGEgbmV3IGxldmVsXHJcblxyXG4gICAgICAgIC8vIG1ha2UgbmV3IGxldmVscyBvbiB0aGUgZmx5ISFcclxuICAgICAgICBCcmV3LkxldmVsR2VuZXJhdG9yLmJ1aWxkQW5kQXR0YWNoTmV3TGV2ZWwoZ20sIGxldmVsLCBwb3J0YWwpXHJcbiAgICAgICAgbGV0IGNoYW5nZUxldmVsRXZlbnQgPSB7Li4uYnJFdmVudH1cclxuICAgICAgICBjaGFuZ2VMZXZlbEV2ZW50LmV2ZW50VHlwZSA9IEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5DaGFuZ2VMZXZlbFxyXG4gICAgICAgIGdtLmluc2VydEV2ZW50KGNoYW5nZUxldmVsRXZlbnQpXHJcbiAgICB9XHJcblxyXG4gICAgLy8gbWF5YmUgaXQgd2FzIGFuIGl0ZW1cclxuICAgIGxldCBwb3J0YWxfdGhpbmcgOiBCcmV3LkdyaWRUaGluZ3MuVGhpbmdcclxuICAgIGlmIChickV2ZW50Lml0ZW1EYXRhKSB7XHJcbiAgICAgICAgcG9ydGFsX3RoaW5nID0gYnJFdmVudC5pdGVtRGF0YS5pdGVtXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHBvcnRhbF90aGluZyA9IGJyRXZlbnQuYWN0b3JcclxuICAgIH1cclxuICAgICAgICBcclxuICAgIGdtLmVuZEV2ZW50KGJyRXZlbnQpXHJcbn1cclxuXHJcbi8vIGxldCBtb3ZlbWVudERpcmVjdGlvbkNhY2hlIFxyXG5leHBvcnQgZnVuY3Rpb24gcmVzdChnbTogQnJldy5HYW1lTWFzdGVyLCBickV2ZW50OiBCcmV3LkVudW1zLklCcmV3RXZlbnQpIHtcclxuICAgIC8vIHVwZGF0ZVR1cm5zKGJyRXZlbnQuYWN0b3IubG9jYXRpb24sIGJyRXZlbnQuYWN0b3IubG9jYXRpb24pXHJcbiAgICBpZiAoYnJFdmVudC5hY3Rvci5pc1NhbWVUaGluZyhnbS5nZXRQbGF5ZXIoKSkpIHtcclxuICAgICAgICByZXNldFN0ZXBUdXJucygpXHJcbiAgICB9XHJcbiAgICBnbS5lbmRFdmVudChickV2ZW50KVxyXG59XHJcblxyXG5mdW5jdGlvbiByZXNldFN0ZXBUdXJucygpIHtcclxuICAgIGxhc3Rfc3RlcCA9IG51bGxcclxuICAgIHR1cm5faGlzdG9yeSA9IFtdXHJcbn1cclxuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/brew_game/movement.ts\n");

/***/ }),

/***/ "./src/brew_game/powers.ts":
/*!*********************************!*\
  !*** ./src/brew_game/powers.ts ***!
  \*********************************/
/*! exports provided: Power, PowerSuite, getEmptyPower, createBasicPowerOfType, createItemFromPower, createPowerFromItem, createPowerItemOfType, uninstallPower, installPower, swapPower, triggerPower, safelyEndPhaseWalk, rocketPunch, throw_axe, recall_axe, getPowerMaxDistance, canUpgradePowerStrength, canUpgradePowerCharges */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Power\", function() { return Power; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"PowerSuite\", function() { return PowerSuite; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getEmptyPower\", function() { return getEmptyPower; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"createBasicPowerOfType\", function() { return createBasicPowerOfType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"createItemFromPower\", function() { return createItemFromPower; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"createPowerFromItem\", function() { return createPowerFromItem; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"createPowerItemOfType\", function() { return createPowerItemOfType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"uninstallPower\", function() { return uninstallPower; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"installPower\", function() { return installPower; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"swapPower\", function() { return swapPower; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"triggerPower\", function() { return triggerPower; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"safelyEndPhaseWalk\", function() { return safelyEndPhaseWalk; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"rocketPunch\", function() { return rocketPunch; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"throw_axe\", function() { return throw_axe; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"recall_axe\", function() { return recall_axe; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getPowerMaxDistance\", function() { return getPowerMaxDistance; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"canUpgradePowerStrength\", function() { return canUpgradePowerStrength; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"canUpgradePowerCharges\", function() { return canUpgradePowerCharges; });\n/* harmony import */ var _brew__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../brew */ \"./src/brew.ts\");\n\r\nclass Power {\r\n    constructor(power_def) {\r\n        this.activated = false;\r\n        this.firing_arc = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].FiringArc.FullArc;\r\n        this.id = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].generateID();\r\n        this.powerType = power_def.powerType;\r\n        this.canBeRecharged = power_def.canBeRecharged;\r\n        this.charge_stat = new _brew__WEBPACK_IMPORTED_MODULE_0__[\"Stat\"](_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].StatName.PowerCharge, power_def.startingCharges);\r\n        this.charge_stat.setCurrentLevel(power_def.startingCharges);\r\n        this.strength = new _brew__WEBPACK_IMPORTED_MODULE_0__[\"Stat\"](_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].StatName.StrengthRank, power_def.maxStrength);\r\n        this.strength.setCurrentLevel(1);\r\n        this.color = power_def.color;\r\n        if (power_def.conveys_flags) {\r\n            this.conveys_flags = [].concat(power_def.conveys_flags);\r\n        }\r\n        else {\r\n            this.conveys_flags = [];\r\n        }\r\n        this.facing_direction = new _brew__WEBPACK_IMPORTED_MODULE_0__[\"Coordinate\"](0, 0);\r\n    }\r\n}\r\nclass PowerSuite {\r\n    constructor(max_capacity) {\r\n        // array of powers\r\n        this.listOfPowers = [];\r\n        this.current_capacity = 0;\r\n        this.max_capacity = max_capacity;\r\n    }\r\n    addPower(power) {\r\n        // returns true if we successfully added this power\r\n        if (this.current_capacity == this.max_capacity) {\r\n            return false;\r\n        }\r\n        else {\r\n            this.listOfPowers.push(power);\r\n            return true;\r\n        }\r\n    }\r\n    removePower(selected_power) {\r\n        let remove_index = this.listOfPowers.findIndex((pow, index, array) => {\r\n            return pow.id == selected_power.id;\r\n        });\r\n        if (remove_index == -1) {\r\n            return false;\r\n        }\r\n        else {\r\n            this.listOfPowers.splice(remove_index, 1);\r\n            return true;\r\n        }\r\n    }\r\n    hasPowerOfType(given_powertype) {\r\n        // returns true if we have at least one power of a given type\r\n        let gotIt = false;\r\n        this.listOfPowers.forEach((pow, index, array) => {\r\n            if (pow.powerType == given_powertype) {\r\n                gotIt = true;\r\n            }\r\n        });\r\n        return gotIt;\r\n    }\r\n    getPowerOfType(given_powertype, defaultToMostCharged = true) {\r\n        // returns the power object associated with a given type\r\n        // if multiple powers are found, it returns the one with the\r\n        // most charge by default, but this behavior can be reversed \r\n        let candidate_list = [];\r\n        for (let i = 0; i < this.listOfPowers.length; i++) {\r\n            let pow = this.listOfPowers[i];\r\n            if (pow.powerType == given_powertype) {\r\n                candidate_list.push(pow);\r\n            }\r\n        }\r\n        if (candidate_list.length == 0) {\r\n            return null;\r\n        }\r\n        else if (candidate_list.length == 1) {\r\n            return candidate_list[0];\r\n        }\r\n        else {\r\n            // multiple\r\n            candidate_list.sort((aPow, bPow) => {\r\n                if (defaultToMostCharged) {\r\n                    return bPow.charge_stat.getCurrentLevel() - aPow.charge_stat.getCurrentLevel();\r\n                }\r\n                else {\r\n                    return aPow.charge_stat.getCurrentLevel() - bPow.charge_stat.getCurrentLevel();\r\n                }\r\n            });\r\n            return candidate_list[0];\r\n        }\r\n    }\r\n    getPowerByIndex(index) {\r\n        if ((index < 0) || (index >= this.listOfPowers.length) || (index >= this.max_capacity)) {\r\n            return null;\r\n        }\r\n        return this.listOfPowers[index];\r\n    }\r\n    hasPowerByID(given_power) {\r\n        return this.listOfPowers.findIndex((pow, index, obj) => {\r\n            return given_power.id == pow.id;\r\n        }) > -1;\r\n    }\r\n    getIndexFromPower(given_power) {\r\n        if (this.hasPowerByID(given_power)) {\r\n            let found_index = this.listOfPowers.findIndex((pow, index, obj) => { return given_power.id == pow.id; });\r\n            return found_index;\r\n        }\r\n        else {\r\n            return null;\r\n        }\r\n    }\r\n} // end class\r\nlet power_defaults = {\r\n    \"TurretCannon\": {\r\n        powerType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewPowerType.TurretCannon,\r\n        canBeRecharged: true,\r\n        startingCharges: 3,\r\n        maxStrength: 1,\r\n        color: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].black,\r\n    },\r\n    \"MachineGun\": {\r\n        powerType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewPowerType.MachineGun,\r\n        canBeRecharged: true,\r\n        startingCharges: 3,\r\n        maxStrength: 1,\r\n        color: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].black,\r\n    },\r\n    \"Scanner\": {\r\n        powerType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewPowerType.Scanner,\r\n        canBeRecharged: true,\r\n        startingCharges: 3,\r\n        maxStrength: 1,\r\n        color: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].black,\r\n    },\r\n};\r\nfunction getEmptyPower() {\r\n    let empty_def = {\r\n        powerType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewPowerType.EmptyNone,\r\n        canBeRecharged: false,\r\n        maxStrength: 1,\r\n        startingCharges: 0,\r\n        color: null,\r\n    };\r\n    let empty_power = new Power(empty_def);\r\n    return empty_power;\r\n}\r\nfunction createBasicPowerOfType(powerType) {\r\n    let power_def = power_defaults[_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewPowerType[powerType]];\r\n    let new_power = new Power(power_def);\r\n    if (powerType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewPowerType.TurretCannon) {\r\n        new_power.associated_item = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].itemFactory(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].ItemType.PowerRelatedItem, { subtype: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].ItemSubtype.PowerItem_Gun, damage: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Config\"].turret_damage, flags: [_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].Flag.CausesExplosion] });\r\n    }\r\n    else if (powerType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewPowerType.MachineGun) {\r\n        new_power.associated_item = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].itemFactory(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].ItemType.PowerRelatedItem, { subtype: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].ItemSubtype.PowerItem_Gun, damage: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Config\"].machinegun_damage, flags: [] });\r\n    }\r\n    return new_power;\r\n}\r\nfunction createItemFromPower(pow) {\r\n    let power_item = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].itemFactory(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].ItemType.PowerSystem, { power: pow, color: pow.color });\r\n    return power_item;\r\n}\r\nfunction createPowerFromItem(power_item) {\r\n    let power = power_item.power;\r\n    return power;\r\n}\r\nfunction createPowerItemOfType(powerType) {\r\n    let pow = createBasicPowerOfType(powerType);\r\n    let item = createItemFromPower(pow);\r\n    return item;\r\n}\r\nfunction uninstallPower(gm, brEvent) {\r\n    let player = gm.getPlayer();\r\n    let level = gm.getCurrentLevel();\r\n    let selected_power = brEvent.powerData.power;\r\n    let item_exists = level.items.hasAt(player.location);\r\n    if (selected_power.powerType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewPowerType.EmptyNone) {\r\n        gm.endEvent(brEvent);\r\n        return;\r\n    }\r\n    if (item_exists) {\r\n        gm.endEvent(brEvent);\r\n    }\r\n    else {\r\n        let power_item = createItemFromPower(selected_power);\r\n        level.items.setAt(player.location, power_item);\r\n        let selected_index = player.getPowers().getIndexFromPower(selected_power);\r\n        player.getPowers().listOfPowers[selected_index] = getEmptyPower();\r\n        // player.getPowers().removePower(selected_power)\r\n        // player.getPowers().addPower(getEmptyPower())\r\n        // return true\r\n        gm.endEvent(brEvent);\r\n    }\r\n}\r\nfunction installPower(gm, brEvent) {\r\n    let player = gm.getPlayer();\r\n    let level = gm.getCurrentLevel();\r\n    let selected_power = brEvent.powerData.power;\r\n    let swapwith_power = brEvent.swapPowerData.power;\r\n    let swapwith_index = player.getPowers().getIndexFromPower(swapwith_power);\r\n    // place new power in the old power slot\r\n    player.getPowers().listOfPowers[swapwith_index] = selected_power;\r\n    // take the power off the floor\r\n    level.items.removeAt(player.location);\r\n    // dump the old power if it's not an empty slot holder\r\n    if (selected_power.powerType != _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewPowerType.EmptyNone) {\r\n        let power_item = createItemFromPower(swapwith_power); // Brew.Definitions.itemFactory(Definitions.ItemType.PowerSystem, { power: swapwith_power})\r\n        level.items.setAt(player.location, power_item);\r\n    }\r\n    gm.endEvent(brEvent);\r\n}\r\nfunction swapPower(gm, brEvent) {\r\n    let player = gm.getPlayer();\r\n    let level = gm.getCurrentLevel();\r\n    let selected_power = brEvent.powerData.power;\r\n    let swapwith_power = brEvent.swapPowerData.power;\r\n    let selected_index = player.getPowers().getIndexFromPower(selected_power);\r\n    let swapwith_index = player.getPowers().getIndexFromPower(swapwith_power);\r\n    player.getPowers().listOfPowers[swapwith_index] = selected_power;\r\n    player.getPowers().listOfPowers[selected_index] = swapwith_power;\r\n    // return true\r\n    // gm.insertEvent(Events.createGenericEventOfType(gm, Brew.Enums.BrewEventType.GenericMenuOff))\r\n    gm.endEvent(brEvent);\r\n}\r\nfunction triggerPower(gm, actor, givenPower) {\r\n    let powerEvent;\r\n    if ((givenPower.powerType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewPowerType.TurretCannon) || (givenPower.powerType == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewPowerType.MachineGun)) {\r\n        let weapon_arc_range = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Tank\"].getFiringArcRange(gm, actor.location, givenPower);\r\n        powerEvent = {\r\n            eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.TargetingOn,\r\n            actor: gm.getPlayer(),\r\n            playerInitiated: true,\r\n            endsTurn: false,\r\n            powerData: {\r\n                power: givenPower\r\n            },\r\n            startTargetingData: {\r\n                from_xy: gm.getPlayer().location,\r\n                to_xy: gm.getPlayer().location,\r\n                targetingAction: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewTargetingAction.RangedAttack,\r\n                minimumArc: weapon_arc_range.minAngle,\r\n                maximumArc: weapon_arc_range.maxAngle,\r\n                midpointArc: weapon_arc_range.midpointAngle,\r\n            }\r\n        };\r\n        // } else if (givenPower.powerType == Brew.Enums.BrewPowerType.MachineGun) {\r\n        //         powerEvent = {\r\n        //             eventType: Brew.Enums.BrewEventType.TargetingOn,\r\n        //             actor: gm.getPlayer(),\r\n        //             playerInitiated: true,\r\n        //             endsTurn: false,\r\n        //             powerData: {\r\n        //                 power: givenPower\r\n        //             },\r\n        //             startTargetingData: {\r\n        //                 from_xy: gm.getPlayer().location,\r\n        //                 to_xy: gm.getPlayer().location,\r\n        //                 targetingAction: Brew.Enums.BrewTargetingAction.RangedAttack\r\n        //             }\r\n        //         }\r\n    }\r\n    else {\r\n        console.error(\"unknown power type\");\r\n    }\r\n    return powerEvent;\r\n}\r\nfunction safelyEndPhaseWalk(gm, actor) {\r\n    // if we ended phasewalk, make sure we arent stuck in some rocks\r\n    let t_at = gm.getCurrentLevel().terrain.getAt(actor.location);\r\n    if (t_at.blocks_walking) {\r\n        // todo: take some damage / attack / die by rock stuck\r\n        let player = gm.getPlayer();\r\n        let level = gm.getCurrentLevel();\r\n        let safe_xy = level.getSafeLocationNear(player.location);\r\n        let old_xy = player.location.clone();\r\n        level.monsters.setAt(safe_xy, player);\r\n        level.monsters.removeAt(old_xy);\r\n        gm.displayList([old_xy, safe_xy]);\r\n    }\r\n}\r\nfunction rocketPunch(gm, data) {\r\n    // decrement power charge on success\r\n    data.powerData.power.charge_stat.decrement(1);\r\n    let moveEvent = {\r\n        eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.Move,\r\n        actor: data.actor,\r\n        playerInitiated: data.playerInitiated,\r\n        endsTurn: data.endsTurn,\r\n        moveData: {\r\n            from_xy: data.actor.location.clone(),\r\n            to_xy: data.targetingData.path[data.targetingData.path.length - 2]\r\n        }\r\n    };\r\n    let victim = gm.getCurrentLevel().monsters.getAt(data.targetingData.to_xy);\r\n    if (!(victim)) {\r\n        console.error(\"should have been a monster at the end of this rainbow\");\r\n    }\r\n    let rpDamage = 1;\r\n    let attack_type = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.Attack;\r\n    let attackEvent = {\r\n        eventType: attack_type,\r\n        actor: data.actor,\r\n        playerInitiated: data.playerInitiated,\r\n        endsTurn: data.endsTurn,\r\n        attackData: {\r\n            from_xy: data.actor.location.clone(),\r\n            to_xy: victim.location.clone(),\r\n            target: victim,\r\n            isMelee: true,\r\n            damage: rpDamage\r\n        }\r\n    };\r\n    attackEvent = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Combat\"].possiblyConvertAttackToSmashAttack(gm, attackEvent);\r\n    let animationEvent = {\r\n        eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.RunAnimation,\r\n        actor: data.actor,\r\n        playerInitiated: data.playerInitiated,\r\n        endsTurn: data.endsTurn,\r\n        animationData: {\r\n            animationType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewAnimationType.OverPath,\r\n            code: data.actor.code,\r\n            color: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].red,\r\n            from_xy: moveEvent.moveData.from_xy,\r\n            to_xy: moveEvent.moveData.to_xy\r\n        }\r\n    };\r\n    gm.insertEvent(animationEvent);\r\n    gm.insertEvent(moveEvent);\r\n    gm.insertEvent(attackEvent);\r\n    // Brew.Animations.animateRocketPunch(gm, data)\r\n    gm.endEvent(data);\r\n}\r\nfunction damageAllInAxePath(gm, axe_path, axe_power, recall) {\r\n    // if (recall) {\r\n    //     axe_path.splice(axe_path.length-1,1)\r\n    // }\r\n    if (recall) {\r\n        // cut off the end when recalling (dont hit player)\r\n        axe_path.splice(axe_path.length - 1, 1);\r\n    }\r\n    else {\r\n        // cut off the front when throwing\r\n        axe_path.splice(0, 1);\r\n    }\r\n    let dmg_amount = axe_power.associated_item.damage;\r\n    let massDamageEvent = {\r\n        eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.MassDamage,\r\n        actor: gm.getPlayer(),\r\n        playerInitiated: true,\r\n        endsTurn: false,\r\n        attackData: {\r\n            isMelee: true,\r\n            damage: dmg_amount,\r\n            from_xy: null,\r\n            to_xy: null,\r\n            target: null,\r\n            effects: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Combat\"].filterDamageEffects(axe_power.associated_item.flags)\r\n        },\r\n        pathsData: {\r\n            from_xy: axe_path[0],\r\n            to_xy: axe_path[axe_path.length - 1],\r\n            path: axe_path\r\n        }\r\n    };\r\n    gm.insertEvent(massDamageEvent);\r\n}\r\nfunction throw_axe(gm, brEvent) {\r\n    // put the axe down where it lands        \r\n    let level = gm.getCurrentLevel();\r\n    let final_xy = brEvent.pathsData.to_xy;\r\n    brEvent.powerData.power.charge_stat.decrement(1);\r\n    // todo: really need a way to move items around\r\n    let axe_item = brEvent.powerData.power.associated_item;\r\n    level.items.removeAt(final_xy);\r\n    level.items.setAt(final_xy, axe_item);\r\n    gm.displayAt(final_xy);\r\n    // update the power to say the axe is activated and do a link\r\n    let power = brEvent.powerData.power;\r\n    power.activated = true;\r\n    damageAllInAxePath(gm, brEvent.pathsData.path, power, false);\r\n    gm.endEvent(brEvent);\r\n}\r\nfunction recall_axe(gm, brEvent) {\r\n    // todo: how to handle - or restrict - multiple axe powers\r\n    // find the axe\r\n    let power = brEvent.powerData.power;\r\n    let axe_item = power.associated_item;\r\n    let level = gm.getCurrentLevel();\r\n    let axe_xy = axe_item.location;\r\n    level.items.removeAt(axe_xy);\r\n    gm.displayAt(axe_xy);\r\n    let animationEvent = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Events\"].createGenericEventOfType(gm, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.RunAnimation, false);\r\n    animationEvent.animationData = {\r\n        animationType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewAnimationType.OverPath,\r\n        code: axe_item.code,\r\n        color: axe_item.color,\r\n        from_xy: brEvent.pathsData.from_xy,\r\n        to_xy: brEvent.pathsData.to_xy,\r\n        path: brEvent.pathsData.path\r\n    };\r\n    gm.insertEvent(animationEvent);\r\n    // deactivate\r\n    brEvent.powerData.power.activated = false;\r\n    damageAllInAxePath(gm, brEvent.pathsData.path, brEvent.powerData.power, true);\r\n    gm.endEvent(brEvent);\r\n}\r\n// export function warp_power(gm: Brew.GameMaster, brEvent: Brew.Enums.IBrewEvent) {\r\n//     let new_loc_xy = gm.getCurrentLevel().getSafeLocation()\r\n//     let warpEvent : Brew.Enums.IBrewEvent = {\r\n//         eventType: Brew.Enums.BrewEventType.Move,\r\n//         actor: brEvent.actor,\r\n//         playerInitiated: true,\r\n//         endsTurn: true,\r\n//         moveData: {\r\n//             from_xy: brEvent.actor.location.clone(),\r\n//             to_xy: new_loc_xy\r\n//         }\r\n//     }\r\n//     gm.endEvent(warpEvent)\r\n// }\r\n// export function stun_power(gm: Brew.GameMaster, brEvent: Brew.Enums.IBrewEvent) {\r\n//     let stunEvent : Brew.Enums.IBrewEvent = {\r\n//         eventType: Brew.Enums.BrewEventType.MassDamage,\r\n//         actor: brEvent.actor,\r\n//         playerInitiated: true,\r\n//         endsTurn: true,\r\n//         attackData: {\r\n//             from_xy: gm.ac\r\n//         },\r\n//         pathsData: {\r\n//         },\r\n//     }\r\n//     gm.endEvent(brEvent)\r\n// }\r\nfunction getPowerMaxDistance(for_power) {\r\n    return 4 + (for_power.strength.getCurrentLevel() * 2);\r\n}\r\nfunction canUpgradePowerStrength(given_power) {\r\n    return (given_power.strength.getCurrentLevel() < given_power.strength.getMaxLevel());\r\n}\r\nfunction canUpgradePowerCharges(given_power) {\r\n    return ((given_power.canBeRecharged) && (given_power.charge_stat.getMaxLevel() < _brew__WEBPACK_IMPORTED_MODULE_0__[\"Config\"].max_power_charges));\r\n}\r\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvYnJld19nYW1lL3Bvd2Vycy50cz9kMTZkIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQStCO0FBWXpCO0lBYUYsWUFBWSxTQUFnQztRQVA1QyxjQUFTLEdBQVksS0FBSztRQUsxQixlQUFVLEdBQXlCLDJDQUFVLENBQUMsU0FBUyxDQUFDLE9BQU87UUFHM0QsSUFBSSxDQUFDLEVBQUUsR0FBRywyQ0FBVSxDQUFDLFVBQVUsRUFBRTtRQUNqQyxJQUFJLENBQUMsU0FBUyxHQUFHLFNBQVMsQ0FBQyxTQUFTO1FBQ3BDLElBQUksQ0FBQyxjQUFjLEdBQUcsU0FBUyxDQUFDLGNBQWM7UUFFOUMsSUFBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLDBDQUFTLENBQUMsMkNBQVUsQ0FBQyxRQUFRLENBQUMsV0FBVyxFQUFFLFNBQVMsQ0FBQyxlQUFlLENBQUM7UUFDNUYsSUFBSSxDQUFDLFdBQVcsQ0FBQyxlQUFlLENBQUMsU0FBUyxDQUFDLGVBQWUsQ0FBQztRQUUzRCxJQUFJLENBQUMsUUFBUSxHQUFHLElBQUksMENBQVMsQ0FBQywyQ0FBVSxDQUFDLFFBQVEsQ0FBQyxZQUFZLEVBQUUsU0FBUyxDQUFDLFdBQVcsQ0FBQztRQUN0RixJQUFJLENBQUMsUUFBUSxDQUFDLGVBQWUsQ0FBQyxDQUFDLENBQUM7UUFFaEMsSUFBSSxDQUFDLEtBQUssR0FBRyxTQUFTLENBQUMsS0FBSztRQUU1QixFQUFFLENBQUMsQ0FBQyxTQUFTLENBQUMsYUFBYSxDQUFDLENBQUMsQ0FBQztZQUMxQixJQUFJLENBQUMsYUFBYSxHQUFHLEVBQUUsQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLGFBQWEsQ0FBQztRQUMzRCxDQUFDO1FBQUMsSUFBSSxDQUFDLENBQUM7WUFDSixJQUFJLENBQUMsYUFBYSxHQUFHLEVBQUU7UUFDM0IsQ0FBQztRQUVELElBQUksQ0FBQyxnQkFBZ0IsR0FBRyxJQUFJLGdEQUFlLENBQUMsQ0FBQyxF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QzFELGdDQUFnQztBQUNoQyxpQ0FBaUM7QUFDakMsMEJBQTBCO0FBQzFCLHdCQUF3QjtBQUN4Qiw2QkFBNkI7QUFDN0IsYUFBYTtBQUNiLHVCQUF1QjtBQUV2QixhQUFhO0FBQ2IsUUFBUTtBQUVSLDJCQUEyQjtBQUMzQixJQUFJO0FBRUUsNkJBQThCLFNBQWdCO0lBQ2hELE1BQU0sQ0FBQyxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLGVBQWUsRUFBRSxHQUFHLENBQUMsQ0FBQztBQUN6RCxDQUFDO0FBRUssaUNBQWtDLFdBQWtCO0lBQ3RELE1BQU0sQ0FBQyxDQUFDLFdBQVcsQ0FBQyxRQUFRLENBQUMsZUFBZSxFQUFFLEdBQUcsV0FBVyxDQUFDLFFBQVEsQ0FBQyxXQUFXLEVBQUUsQ0FBQztBQUN4RixDQUFDO0FBRUssZ0NBQWlDLFdBQWtCO0lBQ3JELE1BQU0sQ0FBQyxDQUFDLENBQUMsV0FBVyxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLFdBQVcsQ0FBQyxXQUFXLEVBQUUsR0FBRyw0Q0FBVyxDQUFDLGlCQUFpQixDQUFDLENBQUM7QUFDcEgsQ0FBQyIsImZpbGUiOiIuL3NyYy9icmV3X2dhbWUvcG93ZXJzLnRzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgQnJldyBmcm9tIFwiLi4vYnJld1wiXHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIElCcmV3UG93ZXJEZWZpbml0aW9uIHtcclxuICAgIHBvd2VyVHlwZTogQnJldy5FbnVtcy5CcmV3UG93ZXJUeXBlXHJcbiAgICBjYW5CZVJlY2hhcmdlZDogYm9vbGVhblxyXG4gICAgc3RhcnRpbmdDaGFyZ2VzOiBudW1iZXJcclxuICAgIG1heFN0cmVuZ3RoOiBudW1iZXJcclxuICAgIC8vIHN0cmVuZ3RoOiBudW1iZXJcclxuICAgIGNvbG9yOiBudW1iZXJbXVxyXG4gICAgY29udmV5c19mbGFncz86IEFycmF5PEJyZXcuRW51bXMuRmxhZz5cclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIFBvd2VyIHtcclxuICAgIGlkOiBudW1iZXJcclxuICAgIGNvbG9yOiBudW1iZXJbXVxyXG4gICAgY2hhcmdlX3N0YXQgOiBCcmV3LlN0YXRcclxuICAgIHBvd2VyVHlwZTogQnJldy5FbnVtcy5CcmV3UG93ZXJUeXBlXHJcbiAgICBjYW5CZVJlY2hhcmdlZDogYm9vbGVhblxyXG4gICAgYWN0aXZhdGVkOiBib29sZWFuID0gZmFsc2VcclxuICAgIHN0cmVuZ3RoOiBCcmV3LlN0YXRcclxuICAgIGFzc29jaWF0ZWRfaXRlbTogQnJldy5HcmlkVGhpbmdzLkl0ZW1cclxuICAgIGNvbnZleXNfZmxhZ3MgOiBBcnJheTxCcmV3LkVudW1zLkZsYWc+XHJcbiAgICBmYWNpbmdfZGlyZWN0aW9uOiBCcmV3LkNvb3JkaW5hdGVcclxuICAgIGZpcmluZ19hcmM6IEJyZXcuRW51bXMuRmlyaW5nQXJjID0gQnJldy5FbnVtcy5GaXJpbmdBcmMuRnVsbEFyY1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHBvd2VyX2RlZiA6IElCcmV3UG93ZXJEZWZpbml0aW9uKSB7XHJcbiAgICAgICAgdGhpcy5pZCA9IEJyZXcuVXRpbHMuZ2VuZXJhdGVJRCgpXHJcbiAgICAgICAgdGhpcy5wb3dlclR5cGUgPSBwb3dlcl9kZWYucG93ZXJUeXBlXHJcbiAgICAgICAgdGhpcy5jYW5CZVJlY2hhcmdlZCA9IHBvd2VyX2RlZi5jYW5CZVJlY2hhcmdlZFxyXG4gICAgICAgIFxyXG4gICAgICAgIHRoaXMuY2hhcmdlX3N0YXQgPSBuZXcgQnJldy5TdGF0KEJyZXcuRW51bXMuU3RhdE5hbWUuUG93ZXJDaGFyZ2UsIHBvd2VyX2RlZi5zdGFydGluZ0NoYXJnZXMpXHJcbiAgICAgICAgdGhpcy5jaGFyZ2Vfc3RhdC5zZXRDdXJyZW50TGV2ZWwocG93ZXJfZGVmLnN0YXJ0aW5nQ2hhcmdlcylcclxuICAgICAgICBcclxuICAgICAgICB0aGlzLnN0cmVuZ3RoID0gbmV3IEJyZXcuU3RhdChCcmV3LkVudW1zLlN0YXROYW1lLlN0cmVuZ3RoUmFuaywgcG93ZXJfZGVmLm1heFN0cmVuZ3RoKVxyXG4gICAgICAgIHRoaXMuc3RyZW5ndGguc2V0Q3VycmVudExldmVsKDEpXHJcblxyXG4gICAgICAgIHRoaXMuY29sb3IgPSBwb3dlcl9kZWYuY29sb3JcclxuXHJcbiAgICAgICAgaWYgKHBvd2VyX2RlZi5jb252ZXlzX2ZsYWdzKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY29udmV5c19mbGFncyA9IFtdLmNvbmNhdChwb3dlcl9kZWYuY29udmV5c19mbGFncylcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmNvbnZleXNfZmxhZ3MgPSBbXVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5mYWNpbmdfZGlyZWN0aW9uID0gbmV3IEJyZXcuQ29vcmRpbmF0ZSgwLCAwKVxyXG4gICAgfVxyXG5cclxuICAgIC8vIGlzQWN0aXZlKCkgOiBib29sZWFuIHtcclxuICAgIC8vICAgICByZXR1cm4gdGhpcy5hY3RpdmF0ZWRcclxuICAgIC8vIH1cclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIFBvd2VyU3VpdGUge1xyXG4gICAgLy8gYXJyYXkgb2YgcG93ZXJzXHJcbiAgICBsaXN0T2ZQb3dlcnMgOiBBcnJheTxQb3dlcj4gPSBbXVxyXG4gICAgbWF4X2NhcGFjaXR5IDogbnVtYmVyXHJcbiAgICBjdXJyZW50X2NhcGFjaXR5IDogbnVtYmVyID0gMFxyXG4gICAgXHJcbiAgICBjb25zdHJ1Y3RvcihtYXhfY2FwYWNpdHkgOiBudW1iZXIpIHtcclxuICAgICAgICB0aGlzLm1heF9jYXBhY2l0eSA9IG1heF9jYXBhY2l0eVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBhZGRQb3dlcihwb3dlciA6IFBvd2VyKSA6IGJvb2xlYW4ge1xyXG4gICAgICAgIC8vIHJldHVybnMgdHJ1ZSBpZiB3ZSBzdWNjZXNzZnVsbHkgYWRkZWQgdGhpcyBwb3dlclxyXG5cclxuICAgICAgICBpZiAodGhpcy5jdXJyZW50X2NhcGFjaXR5ID09IHRoaXMubWF4X2NhcGFjaXR5KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMubGlzdE9mUG93ZXJzLnB1c2gocG93ZXIpXHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJlbW92ZVBvd2VyKHNlbGVjdGVkX3Bvd2VyOiBQb3dlcikgOiBib29sZWFuIHtcclxuICAgICAgICBsZXQgcmVtb3ZlX2luZGV4ID0gdGhpcy5saXN0T2ZQb3dlcnMuZmluZEluZGV4KChwb3c6IFBvd2VyLCBpbmRleDogbnVtYmVyLCBhcnJheSkgPT4ge1xyXG4gICAgICAgICAgICByZXR1cm4gcG93LmlkID09IHNlbGVjdGVkX3Bvd2VyLmlkXHJcbiAgICAgICAgfSlcclxuICAgICAgICBpZiAocmVtb3ZlX2luZGV4ID09IC0xKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMubGlzdE9mUG93ZXJzLnNwbGljZShyZW1vdmVfaW5kZXgsIDEpXHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGhhc1Bvd2VyT2ZUeXBlKGdpdmVuX3Bvd2VydHlwZSA6IEJyZXcuRW51bXMuQnJld1Bvd2VyVHlwZSkgOiBib29sZWFuIHtcclxuICAgICAgICAvLyByZXR1cm5zIHRydWUgaWYgd2UgaGF2ZSBhdCBsZWFzdCBvbmUgcG93ZXIgb2YgYSBnaXZlbiB0eXBlXHJcbiAgICAgICAgbGV0IGdvdEl0IDogYm9vbGVhbiA9IGZhbHNlXHJcbiAgICAgICAgdGhpcy5saXN0T2ZQb3dlcnMuZm9yRWFjaCgocG93LCBpbmRleCwgYXJyYXkpID0+IHtcclxuICAgICAgICAgICAgaWYgKHBvdy5wb3dlclR5cGUgPT0gZ2l2ZW5fcG93ZXJ0eXBlKSB7XHJcbiAgICAgICAgICAgICAgICBnb3RJdCA9IHRydWVcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIHJldHVybiBnb3RJdFxyXG4gICAgfVxyXG5cclxuICAgIGdldFBvd2VyT2ZUeXBlKGdpdmVuX3Bvd2VydHlwZSA6IEJyZXcuRW51bXMuQnJld1Bvd2VyVHlwZSwgZGVmYXVsdFRvTW9zdENoYXJnZWQgOiBib29sZWFuID0gdHJ1ZSkgOiBQb3dlciB7XHJcbiAgICAgICAgLy8gcmV0dXJucyB0aGUgcG93ZXIgb2JqZWN0IGFzc29jaWF0ZWQgd2l0aCBhIGdpdmVuIHR5cGVcclxuICAgICAgICAvLyBpZiBtdWx0aXBsZSBwb3dlcnMgYXJlIGZvdW5kLCBpdCByZXR1cm5zIHRoZSBvbmUgd2l0aCB0aGVcclxuICAgICAgICAvLyBtb3N0IGNoYXJnZSBieSBkZWZhdWx0LCBidXQgdGhpcyBiZWhhdmlvciBjYW4gYmUgcmV2ZXJzZWQgXHJcbiAgICAgICAgbGV0IGNhbmRpZGF0ZV9saXN0IDogQXJyYXk8UG93ZXI+ID0gW11cclxuXHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmxpc3RPZlBvd2Vycy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBsZXQgcG93ID0gdGhpcy5saXN0T2ZQb3dlcnNbaV1cclxuICAgICAgICAgICAgaWYgKHBvdy5wb3dlclR5cGUgPT0gZ2l2ZW5fcG93ZXJ0eXBlKSB7XHJcbiAgICAgICAgICAgICAgICBjYW5kaWRhdGVfbGlzdC5wdXNoKHBvdylcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGNhbmRpZGF0ZV9saXN0Lmxlbmd0aCA9PSAwKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsXHJcbiAgICAgICAgfSBlbHNlIGlmIChjYW5kaWRhdGVfbGlzdC5sZW5ndGggPT0gMSkge1xyXG4gICAgICAgICAgICByZXR1cm4gY2FuZGlkYXRlX2xpc3RbMF1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBtdWx0aXBsZVxyXG4gICAgICAgICAgICBjYW5kaWRhdGVfbGlzdC5zb3J0KChhUG93LCBiUG93KSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZGVmYXVsdFRvTW9zdENoYXJnZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYlBvdy5jaGFyZ2Vfc3RhdC5nZXRDdXJyZW50TGV2ZWwoKSAtIGFQb3cuY2hhcmdlX3N0YXQuZ2V0Q3VycmVudExldmVsKClcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFQb3cuY2hhcmdlX3N0YXQuZ2V0Q3VycmVudExldmVsKCkgLSBiUG93LmNoYXJnZV9zdGF0LmdldEN1cnJlbnRMZXZlbCgpXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIHJldHVybiBjYW5kaWRhdGVfbGlzdFswXVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBnZXRQb3dlckJ5SW5kZXgoaW5kZXg6IG51bWJlcikge1xyXG4gICAgICAgIGlmICgoaW5kZXggPCAwKSB8fCAoaW5kZXggPj0gdGhpcy5saXN0T2ZQb3dlcnMubGVuZ3RoKSB8fCAoaW5kZXggPj0gdGhpcy5tYXhfY2FwYWNpdHkpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsXHJcbiAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICByZXR1cm4gdGhpcy5saXN0T2ZQb3dlcnNbaW5kZXhdXHJcbiAgICB9XHJcblxyXG4gICAgaGFzUG93ZXJCeUlEKGdpdmVuX3Bvd2VyOiBQb3dlcikgOiBib29sZWFuIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5saXN0T2ZQb3dlcnMuZmluZEluZGV4KChwb3c6IFBvd2VyLCBpbmRleDogbnVtYmVyLCBvYmopID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuIGdpdmVuX3Bvd2VyLmlkID09IHBvdy5pZFxyXG4gICAgICAgIH0pID4gLTFcclxuICAgIH1cclxuXHJcbiAgICBnZXRJbmRleEZyb21Qb3dlcihnaXZlbl9wb3dlcjogUG93ZXIpIDogbnVtYmVyIHtcclxuICAgICAgICBpZiAodGhpcy5oYXNQb3dlckJ5SUQoZ2l2ZW5fcG93ZXIpKSB7XHJcbiAgICAgICAgICAgIGxldCBmb3VuZF9pbmRleCA9IHRoaXMubGlzdE9mUG93ZXJzLmZpbmRJbmRleCgocG93OiBQb3dlciwgaW5kZXg6IG51bWJlciwgb2JqKSA9PiB7cmV0dXJuIGdpdmVuX3Bvd2VyLmlkID09IHBvdy5pZH0pXHJcbiAgICAgICAgICAgIHJldHVybiBmb3VuZF9pbmRleFxyXG5cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbn0gLy8gZW5kIGNsYXNzXHJcblxyXG5cclxubGV0IHBvd2VyX2RlZmF1bHRzIDogeyBbcG93ZXJfZGVmOiBzdHJpbmddIDogSUJyZXdQb3dlckRlZmluaXRpb24gfSA9IHtcclxuICAgIFwiVHVycmV0Q2Fubm9uXCI6IHtcclxuICAgICAgICBwb3dlclR5cGU6IEJyZXcuRW51bXMuQnJld1Bvd2VyVHlwZS5UdXJyZXRDYW5ub24sXHJcbiAgICAgICAgY2FuQmVSZWNoYXJnZWQ6IHRydWUsXHJcbiAgICAgICAgc3RhcnRpbmdDaGFyZ2VzOiAzLFxyXG4gICAgICAgIG1heFN0cmVuZ3RoOiAxLFxyXG4gICAgICAgIGNvbG9yOiBCcmV3LkNvbG9yLmJsYWNrLFxyXG4gICAgfSxcclxuICAgIFwiTWFjaGluZUd1blwiOiB7XHJcbiAgICAgICAgcG93ZXJUeXBlOiBCcmV3LkVudW1zLkJyZXdQb3dlclR5cGUuTWFjaGluZUd1bixcclxuICAgICAgICBjYW5CZVJlY2hhcmdlZDogdHJ1ZSxcclxuICAgICAgICBzdGFydGluZ0NoYXJnZXM6IDMsXHJcbiAgICAgICAgbWF4U3RyZW5ndGg6IDEsXHJcbiAgICAgICAgY29sb3I6IEJyZXcuQ29sb3IuYmxhY2ssXHJcbiAgICB9LFxyXG4gICAgXCJTY2FubmVyXCI6IHtcclxuICAgICAgICBwb3dlclR5cGU6IEJyZXcuRW51bXMuQnJld1Bvd2VyVHlwZS5TY2FubmVyLFxyXG4gICAgICAgIGNhbkJlUmVjaGFyZ2VkOiB0cnVlLFxyXG4gICAgICAgIHN0YXJ0aW5nQ2hhcmdlczogMyxcclxuICAgICAgICBtYXhTdHJlbmd0aDogMSxcclxuICAgICAgICBjb2xvcjogQnJldy5Db2xvci5ibGFjayxcclxuICAgIH0sXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRFbXB0eVBvd2VyKCkgOiBQb3dlciB7XHJcbiAgICBsZXQgZW1wdHlfZGVmIDogSUJyZXdQb3dlckRlZmluaXRpb24gPSB7XHJcbiAgICAgICAgcG93ZXJUeXBlOiBCcmV3LkVudW1zLkJyZXdQb3dlclR5cGUuRW1wdHlOb25lLFxyXG4gICAgICAgIGNhbkJlUmVjaGFyZ2VkOiBmYWxzZSxcclxuICAgICAgICBtYXhTdHJlbmd0aDogMSxcclxuICAgICAgICBzdGFydGluZ0NoYXJnZXM6IDAsXHJcbiAgICAgICAgY29sb3I6IG51bGwsXHJcbiAgICB9XHJcblxyXG4gICAgbGV0IGVtcHR5X3Bvd2VyID0gbmV3IFBvd2VyKGVtcHR5X2RlZilcclxuXHJcbiAgICByZXR1cm4gZW1wdHlfcG93ZXJcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUJhc2ljUG93ZXJPZlR5cGUocG93ZXJUeXBlIDogQnJldy5FbnVtcy5CcmV3UG93ZXJUeXBlKSA6IFBvd2VyIHtcclxuICAgIGxldCBwb3dlcl9kZWYgOiBJQnJld1Bvd2VyRGVmaW5pdGlvbiA9IHBvd2VyX2RlZmF1bHRzW0JyZXcuRW51bXMuQnJld1Bvd2VyVHlwZVtwb3dlclR5cGVdXVxyXG4gICAgbGV0IG5ld19wb3dlciA9IG5ldyBQb3dlcihwb3dlcl9kZWYpXHJcblxyXG4gICAgaWYgKHBvd2VyVHlwZSA9PSBCcmV3LkVudW1zLkJyZXdQb3dlclR5cGUuVHVycmV0Q2Fubm9uKSB7XHJcbiAgICAgICAgbmV3X3Bvd2VyLmFzc29jaWF0ZWRfaXRlbSA9IEJyZXcuRGVmaW5pdGlvbnMuaXRlbUZhY3RvcnkoQnJldy5EZWZpbml0aW9ucy5JdGVtVHlwZS5Qb3dlclJlbGF0ZWRJdGVtLCB7IHN1YnR5cGU6IEJyZXcuRGVmaW5pdGlvbnMuSXRlbVN1YnR5cGUuUG93ZXJJdGVtX0d1biwgZGFtYWdlOiBCcmV3LkNvbmZpZy50dXJyZXRfZGFtYWdlLCBmbGFnczogW0JyZXcuRW51bXMuRmxhZy5DYXVzZXNFeHBsb3Npb25dfSlcclxuICAgIH0gZWxzZSBpZiAocG93ZXJUeXBlID09IEJyZXcuRW51bXMuQnJld1Bvd2VyVHlwZS5NYWNoaW5lR3VuKSB7XHJcbiAgICAgICAgbmV3X3Bvd2VyLmFzc29jaWF0ZWRfaXRlbSA9IEJyZXcuRGVmaW5pdGlvbnMuaXRlbUZhY3RvcnkoQnJldy5EZWZpbml0aW9ucy5JdGVtVHlwZS5Qb3dlclJlbGF0ZWRJdGVtLCB7IHN1YnR5cGU6IEJyZXcuRGVmaW5pdGlvbnMuSXRlbVN1YnR5cGUuUG93ZXJJdGVtX0d1biwgZGFtYWdlOiBCcmV3LkNvbmZpZy5tYWNoaW5lZ3VuX2RhbWFnZSwgZmxhZ3M6IFtdfSlcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gbmV3X3Bvd2VyXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVJdGVtRnJvbVBvd2VyKHBvdzogUG93ZXIpIDogQnJldy5HcmlkVGhpbmdzLkl0ZW0ge1xyXG4gICAgbGV0IHBvd2VyX2l0ZW0gPSBCcmV3LkRlZmluaXRpb25zLml0ZW1GYWN0b3J5KEJyZXcuRGVmaW5pdGlvbnMuSXRlbVR5cGUuUG93ZXJTeXN0ZW0sIHsgcG93ZXI6IHBvdywgY29sb3I6IHBvdy5jb2xvciB9KVxyXG4gICAgcmV0dXJuIHBvd2VyX2l0ZW1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVBvd2VyRnJvbUl0ZW0ocG93ZXJfaXRlbTogQnJldy5HcmlkVGhpbmdzLkl0ZW0pIDogUG93ZXIge1xyXG4gICAgbGV0IHBvd2VyIDogUG93ZXIgPSBwb3dlcl9pdGVtLnBvd2VyXHJcbiAgICByZXR1cm4gcG93ZXJcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVBvd2VySXRlbU9mVHlwZShwb3dlclR5cGU6IEJyZXcuRW51bXMuQnJld1Bvd2VyVHlwZSkgOiBCcmV3LkdyaWRUaGluZ3MuSXRlbSB7XHJcbiAgICBsZXQgcG93ID0gY3JlYXRlQmFzaWNQb3dlck9mVHlwZShwb3dlclR5cGUpXHJcbiAgICBsZXQgaXRlbSA9IGNyZWF0ZUl0ZW1Gcm9tUG93ZXIocG93KVxyXG4gICAgcmV0dXJuIGl0ZW1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHVuaW5zdGFsbFBvd2VyKGdtIDogQnJldy5HYW1lTWFzdGVyLCBickV2ZW50OiBCcmV3LkVudW1zLklCcmV3RXZlbnQpICB7IFxyXG4gICAgbGV0IHBsYXllciA9IGdtLmdldFBsYXllcigpXHJcbiAgICBsZXQgbGV2ZWwgPSBnbS5nZXRDdXJyZW50TGV2ZWwoKVxyXG4gICAgbGV0IHNlbGVjdGVkX3Bvd2VyID0gYnJFdmVudC5wb3dlckRhdGEucG93ZXJcclxuICAgIGxldCBpdGVtX2V4aXN0cyA9IGxldmVsLml0ZW1zLmhhc0F0KHBsYXllci5sb2NhdGlvbilcclxuXHJcbiAgICBpZiAoc2VsZWN0ZWRfcG93ZXIucG93ZXJUeXBlID09IEJyZXcuRW51bXMuQnJld1Bvd2VyVHlwZS5FbXB0eU5vbmUpIHtcclxuICAgICAgICBnbS5lbmRFdmVudChickV2ZW50KVxyXG4gICAgICAgIHJldHVyblxyXG4gICAgfVxyXG5cclxuICAgIGlmIChpdGVtX2V4aXN0cykgey8vIHRvZG86IGhhbmRsZSBhdHRlbXB0IGF0IHVuaW5zdGFsbCB2cy4gc3VjY2Vzc1xyXG4gICAgICAgIGdtLmVuZEV2ZW50KGJyRXZlbnQpXHJcbiAgICB9IGVsc2Uge1xyXG5cclxuICAgICAgICBsZXQgcG93ZXJfaXRlbSA9IGNyZWF0ZUl0ZW1Gcm9tUG93ZXIoc2VsZWN0ZWRfcG93ZXIpXHJcbiAgICAgICAgXHJcbiAgICAgICAgbGV2ZWwuaXRlbXMuc2V0QXQocGxheWVyLmxvY2F0aW9uLCBwb3dlcl9pdGVtKVxyXG5cclxuICAgICAgICBsZXQgc2VsZWN0ZWRfaW5kZXggPSBwbGF5ZXIuZ2V0UG93ZXJzKCkuZ2V0SW5kZXhGcm9tUG93ZXIoc2VsZWN0ZWRfcG93ZXIpXHJcbiAgICAgICAgcGxheWVyLmdldFBvd2VycygpLmxpc3RPZlBvd2Vyc1tzZWxlY3RlZF9pbmRleF0gPSBnZXRFbXB0eVBvd2VyKClcclxuICAgICAgICAvLyBwbGF5ZXIuZ2V0UG93ZXJzKCkucmVtb3ZlUG93ZXIoc2VsZWN0ZWRfcG93ZXIpXHJcbiAgICAgICAgLy8gcGxheWVyLmdldFBvd2VycygpLmFkZFBvd2VyKGdldEVtcHR5UG93ZXIoKSlcclxuXHJcbiAgICAgICAgLy8gcmV0dXJuIHRydWVcclxuICAgICAgICBnbS5lbmRFdmVudChickV2ZW50KVxyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaW5zdGFsbFBvd2VyKGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGJyRXZlbnQ6IEJyZXcuRW51bXMuSUJyZXdFdmVudCkge1xyXG4gICAgbGV0IHBsYXllciA9IGdtLmdldFBsYXllcigpXHJcbiAgICBsZXQgbGV2ZWwgPSBnbS5nZXRDdXJyZW50TGV2ZWwoKVxyXG4gICAgbGV0IHNlbGVjdGVkX3Bvd2VyID0gYnJFdmVudC5wb3dlckRhdGEucG93ZXJcclxuICAgIGxldCBzd2Fwd2l0aF9wb3dlciA9IGJyRXZlbnQuc3dhcFBvd2VyRGF0YS5wb3dlclxyXG5cclxuICAgIGxldCBzd2Fwd2l0aF9pbmRleCA9IHBsYXllci5nZXRQb3dlcnMoKS5nZXRJbmRleEZyb21Qb3dlcihzd2Fwd2l0aF9wb3dlcilcclxuICAgIC8vIHBsYWNlIG5ldyBwb3dlciBpbiB0aGUgb2xkIHBvd2VyIHNsb3RcclxuICAgIHBsYXllci5nZXRQb3dlcnMoKS5saXN0T2ZQb3dlcnNbc3dhcHdpdGhfaW5kZXhdID0gc2VsZWN0ZWRfcG93ZXJcclxuXHJcbiAgICAvLyB0YWtlIHRoZSBwb3dlciBvZmYgdGhlIGZsb29yXHJcbiAgICBsZXZlbC5pdGVtcy5yZW1vdmVBdChwbGF5ZXIubG9jYXRpb24pIFxyXG5cclxuICAgIC8vIGR1bXAgdGhlIG9sZCBwb3dlciBpZiBpdCdzIG5vdCBhbiBlbXB0eSBzbG90IGhvbGRlclxyXG4gICAgaWYgKHNlbGVjdGVkX3Bvd2VyLnBvd2VyVHlwZSAhPSBCcmV3LkVudW1zLkJyZXdQb3dlclR5cGUuRW1wdHlOb25lKSB7XHJcbiAgICAgICAgbGV0IHBvd2VyX2l0ZW0gPSBjcmVhdGVJdGVtRnJvbVBvd2VyKHN3YXB3aXRoX3Bvd2VyKSAvLyBCcmV3LkRlZmluaXRpb25zLml0ZW1GYWN0b3J5KERlZmluaXRpb25zLkl0ZW1UeXBlLlBvd2VyU3lzdGVtLCB7IHBvd2VyOiBzd2Fwd2l0aF9wb3dlcn0pXHJcbiAgICAgICAgbGV2ZWwuaXRlbXMuc2V0QXQocGxheWVyLmxvY2F0aW9uLCBwb3dlcl9pdGVtKVxyXG4gICAgfVxyXG5cclxuICAgIGdtLmVuZEV2ZW50KGJyRXZlbnQpXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBzd2FwUG93ZXIoZ20gOiBCcmV3LkdhbWVNYXN0ZXIsIGJyRXZlbnQ6IEJyZXcuRW51bXMuSUJyZXdFdmVudCkgIHsgXHJcbiAgICBsZXQgcGxheWVyID0gZ20uZ2V0UGxheWVyKClcclxuICAgIGxldCBsZXZlbCA9IGdtLmdldEN1cnJlbnRMZXZlbCgpXHJcbiAgICBsZXQgc2VsZWN0ZWRfcG93ZXIgPSBickV2ZW50LnBvd2VyRGF0YS5wb3dlclxyXG4gICAgbGV0IHN3YXB3aXRoX3Bvd2VyID0gYnJFdmVudC5zd2FwUG93ZXJEYXRhLnBvd2VyXHJcblxyXG4gICAgbGV0IHNlbGVjdGVkX2luZGV4ID0gcGxheWVyLmdldFBvd2VycygpLmdldEluZGV4RnJvbVBvd2VyKHNlbGVjdGVkX3Bvd2VyKVxyXG4gICAgbGV0IHN3YXB3aXRoX2luZGV4ID0gcGxheWVyLmdldFBvd2VycygpLmdldEluZGV4RnJvbVBvd2VyKHN3YXB3aXRoX3Bvd2VyKVxyXG4gICAgXHJcbiAgICBwbGF5ZXIuZ2V0UG93ZXJzKCkubGlzdE9mUG93ZXJzW3N3YXB3aXRoX2luZGV4XSA9IHNlbGVjdGVkX3Bvd2VyXHJcbiAgICBwbGF5ZXIuZ2V0UG93ZXJzKCkubGlzdE9mUG93ZXJzW3NlbGVjdGVkX2luZGV4XSA9IHN3YXB3aXRoX3Bvd2VyXHJcblxyXG4gICAgLy8gcmV0dXJuIHRydWVcclxuICAgIC8vIGdtLmluc2VydEV2ZW50KEV2ZW50cy5jcmVhdGVHZW5lcmljRXZlbnRPZlR5cGUoZ20sIEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5HZW5lcmljTWVudU9mZikpXHJcbiAgICBnbS5lbmRFdmVudChickV2ZW50KVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gdHJpZ2dlclBvd2VyKGdtIDogQnJldy5HYW1lTWFzdGVyLCBhY3RvciA6IEJyZXcuR3JpZFRoaW5ncy5Nb25zdGVyLCBnaXZlblBvd2VyIDogUG93ZXIpIDogQnJldy5FbnVtcy5JQnJld0V2ZW50IHtcclxuICAgIGxldCBwb3dlckV2ZW50IDogQnJldy5FbnVtcy5JQnJld0V2ZW50XHJcblxyXG4gICAgaWYgKChnaXZlblBvd2VyLnBvd2VyVHlwZSA9PSBCcmV3LkVudW1zLkJyZXdQb3dlclR5cGUuVHVycmV0Q2Fubm9uKSB8fCAoZ2l2ZW5Qb3dlci5wb3dlclR5cGUgPT0gQnJldy5FbnVtcy5CcmV3UG93ZXJUeXBlLk1hY2hpbmVHdW4pKSB7XHJcbiAgICAgICAgbGV0IHdlYXBvbl9hcmNfcmFuZ2UgPSBCcmV3LlRhbmsuZ2V0RmlyaW5nQXJjUmFuZ2UoZ20sIGFjdG9yLmxvY2F0aW9uLCBnaXZlblBvd2VyKVxyXG4gICAgICAgIHBvd2VyRXZlbnQgPSB7XHJcbiAgICAgICAgICAgIGV2ZW50VHlwZTogQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLlRhcmdldGluZ09uLFxyXG4gICAgICAgICAgICBhY3RvcjogZ20uZ2V0UGxheWVyKCksXHJcbiAgICAgICAgICAgIHBsYXllckluaXRpYXRlZDogdHJ1ZSxcclxuICAgICAgICAgICAgZW5kc1R1cm46IGZhbHNlLFxyXG4gICAgICAgICAgICBwb3dlckRhdGE6IHtcclxuICAgICAgICAgICAgICAgIHBvd2VyOiBnaXZlblBvd2VyXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHN0YXJ0VGFyZ2V0aW5nRGF0YToge1xyXG4gICAgICAgICAgICAgICAgZnJvbV94eTogZ20uZ2V0UGxheWVyKCkubG9jYXRpb24sXHJcbiAgICAgICAgICAgICAgICB0b194eTogZ20uZ2V0UGxheWVyKCkubG9jYXRpb24sXHJcbiAgICAgICAgICAgICAgICB0YXJnZXRpbmdBY3Rpb246IEJyZXcuRW51bXMuQnJld1RhcmdldGluZ0FjdGlvbi5SYW5nZWRBdHRhY2ssXHJcbiAgICAgICAgICAgICAgICBtaW5pbXVtQXJjOiB3ZWFwb25fYXJjX3JhbmdlLm1pbkFuZ2xlLFxyXG4gICAgICAgICAgICAgICAgbWF4aW11bUFyYzogd2VhcG9uX2FyY19yYW5nZS5tYXhBbmdsZSxcclxuICAgICAgICAgICAgICAgIG1pZHBvaW50QXJjOiB3ZWFwb25fYXJjX3JhbmdlLm1pZHBvaW50QW5nbGUsXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAvLyB9IGVsc2UgaWYgKGdpdmVuUG93ZXIucG93ZXJUeXBlID09IEJyZXcuRW51bXMuQnJld1Bvd2VyVHlwZS5NYWNoaW5lR3VuKSB7XHJcbiAgICAvLyAgICAgICAgIHBvd2VyRXZlbnQgPSB7XHJcbiAgICAvLyAgICAgICAgICAgICBldmVudFR5cGU6IEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5UYXJnZXRpbmdPbixcclxuICAgIC8vICAgICAgICAgICAgIGFjdG9yOiBnbS5nZXRQbGF5ZXIoKSxcclxuICAgIC8vICAgICAgICAgICAgIHBsYXllckluaXRpYXRlZDogdHJ1ZSxcclxuICAgIC8vICAgICAgICAgICAgIGVuZHNUdXJuOiBmYWxzZSxcclxuICAgIC8vICAgICAgICAgICAgIHBvd2VyRGF0YToge1xyXG4gICAgLy8gICAgICAgICAgICAgICAgIHBvd2VyOiBnaXZlblBvd2VyXHJcbiAgICAvLyAgICAgICAgICAgICB9LFxyXG4gICAgLy8gICAgICAgICAgICAgc3RhcnRUYXJnZXRpbmdEYXRhOiB7XHJcbiAgICAvLyAgICAgICAgICAgICAgICAgZnJvbV94eTogZ20uZ2V0UGxheWVyKCkubG9jYXRpb24sXHJcbiAgICAvLyAgICAgICAgICAgICAgICAgdG9feHk6IGdtLmdldFBsYXllcigpLmxvY2F0aW9uLFxyXG4gICAgLy8gICAgICAgICAgICAgICAgIHRhcmdldGluZ0FjdGlvbjogQnJldy5FbnVtcy5CcmV3VGFyZ2V0aW5nQWN0aW9uLlJhbmdlZEF0dGFja1xyXG4gICAgLy8gICAgICAgICAgICAgfVxyXG4gICAgLy8gICAgICAgICB9XHJcbiAgICBcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcInVua25vd24gcG93ZXIgdHlwZVwiKVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBwb3dlckV2ZW50XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBzYWZlbHlFbmRQaGFzZVdhbGsoZ206IEJyZXcuR2FtZU1hc3RlciwgYWN0b3I6IEJyZXcuR3JpZFRoaW5ncy5UaGluZykge1xyXG4gICAgLy8gaWYgd2UgZW5kZWQgcGhhc2V3YWxrLCBtYWtlIHN1cmUgd2UgYXJlbnQgc3R1Y2sgaW4gc29tZSByb2Nrc1xyXG4gICAgbGV0IHRfYXQgOiBCcmV3LkdyaWRUaGluZ3MuVGVycmFpbiA9IGdtLmdldEN1cnJlbnRMZXZlbCgpLnRlcnJhaW4uZ2V0QXQoYWN0b3IubG9jYXRpb24pXHJcbiAgICBpZiAodF9hdC5ibG9ja3Nfd2Fsa2luZykge1xyXG5cclxuICAgICAgICAvLyB0b2RvOiB0YWtlIHNvbWUgZGFtYWdlIC8gYXR0YWNrIC8gZGllIGJ5IHJvY2sgc3R1Y2tcclxuICAgICAgICBsZXQgcGxheWVyID0gZ20uZ2V0UGxheWVyKClcclxuICAgICAgICBsZXQgbGV2ZWwgPSBnbS5nZXRDdXJyZW50TGV2ZWwoKVxyXG4gICAgICAgIGxldCBzYWZlX3h5ID0gbGV2ZWwuZ2V0U2FmZUxvY2F0aW9uTmVhcihwbGF5ZXIubG9jYXRpb24pXHJcbiAgICAgICAgbGV0IG9sZF94eSA9IHBsYXllci5sb2NhdGlvbi5jbG9uZSgpXHJcblxyXG4gICAgICAgIGxldmVsLm1vbnN0ZXJzLnNldEF0KHNhZmVfeHksIHBsYXllcilcclxuICAgICAgICBsZXZlbC5tb25zdGVycy5yZW1vdmVBdChvbGRfeHkpXHJcblxyXG4gICAgICAgIGdtLmRpc3BsYXlMaXN0KFtvbGRfeHksIHNhZmVfeHldKVxyXG5cclxuICAgIH1cclxuXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiByb2NrZXRQdW5jaChnbSA6IEJyZXcuR2FtZU1hc3RlciwgZGF0YTogQnJldy5FbnVtcy5JQnJld0V2ZW50KSB7XHJcbiAgICBcclxuICAgIC8vIGRlY3JlbWVudCBwb3dlciBjaGFyZ2Ugb24gc3VjY2Vzc1xyXG4gICAgZGF0YS5wb3dlckRhdGEucG93ZXIuY2hhcmdlX3N0YXQuZGVjcmVtZW50KDEpXHJcblxyXG4gICAgbGV0IG1vdmVFdmVudCA6IEJyZXcuRW51bXMuSUJyZXdFdmVudCA9IHtcclxuICAgICAgICBldmVudFR5cGU6IEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5Nb3ZlLFxyXG4gICAgICAgIGFjdG9yOiBkYXRhLmFjdG9yLFxyXG4gICAgICAgIHBsYXllckluaXRpYXRlZDogZGF0YS5wbGF5ZXJJbml0aWF0ZWQsXHJcbiAgICAgICAgZW5kc1R1cm46IGRhdGEuZW5kc1R1cm4sXHJcbiAgICAgICAgbW92ZURhdGE6IHtcclxuICAgICAgICAgICAgZnJvbV94eTogZGF0YS5hY3Rvci5sb2NhdGlvbi5jbG9uZSgpLFxyXG4gICAgICAgICAgICB0b194eTogZGF0YS50YXJnZXRpbmdEYXRhLnBhdGhbZGF0YS50YXJnZXRpbmdEYXRhLnBhdGgubGVuZ3RoLTJdXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBsZXQgdmljdGltIDogQnJldy5HcmlkVGhpbmdzLk1vbnN0ZXIgPSBnbS5nZXRDdXJyZW50TGV2ZWwoKS5tb25zdGVycy5nZXRBdChkYXRhLnRhcmdldGluZ0RhdGEudG9feHkpXHJcbiAgICBpZiAoISh2aWN0aW0pKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcInNob3VsZCBoYXZlIGJlZW4gYSBtb25zdGVyIGF0IHRoZSBlbmQgb2YgdGhpcyByYWluYm93XCIpXHJcbiAgICB9XHJcblxyXG4gICAgbGV0IHJwRGFtYWdlID0gMVxyXG4gICAgbGV0IGF0dGFja190eXBlIDogQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlID0gQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLkF0dGFja1xyXG5cclxuICAgIGxldCBhdHRhY2tFdmVudCA6IEJyZXcuRW51bXMuSUJyZXdFdmVudCA9IHtcclxuICAgICAgICBldmVudFR5cGU6IGF0dGFja190eXBlLFxyXG4gICAgICAgIGFjdG9yOiBkYXRhLmFjdG9yLFxyXG4gICAgICAgIHBsYXllckluaXRpYXRlZDogZGF0YS5wbGF5ZXJJbml0aWF0ZWQsXHJcbiAgICAgICAgZW5kc1R1cm46IGRhdGEuZW5kc1R1cm4sXHJcbiAgICAgICAgYXR0YWNrRGF0YToge1xyXG4gICAgICAgICAgICBmcm9tX3h5OiBkYXRhLmFjdG9yLmxvY2F0aW9uLmNsb25lKCksXHJcbiAgICAgICAgICAgIHRvX3h5OiB2aWN0aW0ubG9jYXRpb24uY2xvbmUoKSxcclxuICAgICAgICAgICAgdGFyZ2V0OiB2aWN0aW0sXHJcbiAgICAgICAgICAgIGlzTWVsZWU6IHRydWUsXHJcbiAgICAgICAgICAgIGRhbWFnZTogcnBEYW1hZ2VcclxuICAgICAgICB9ICAgICAgICBcclxuICAgIH1cclxuICAgIGF0dGFja0V2ZW50ID0gQnJldy5Db21iYXQucG9zc2libHlDb252ZXJ0QXR0YWNrVG9TbWFzaEF0dGFjayhnbSwgYXR0YWNrRXZlbnQpXHJcbiAgICBcclxuICAgIGxldCBhbmltYXRpb25FdmVudCA6IEJyZXcuRW51bXMuSUJyZXdFdmVudCA9IHtcclxuICAgICAgICBldmVudFR5cGU6IEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5SdW5BbmltYXRpb24sXHJcbiAgICAgICAgYWN0b3I6IGRhdGEuYWN0b3IsXHJcbiAgICAgICAgcGxheWVySW5pdGlhdGVkOiBkYXRhLnBsYXllckluaXRpYXRlZCxcclxuICAgICAgICBlbmRzVHVybjogZGF0YS5lbmRzVHVybixcclxuICAgICAgICBhbmltYXRpb25EYXRhOiB7XHJcbiAgICAgICAgICAgIGFuaW1hdGlvblR5cGU6IEJyZXcuRW51bXMuQnJld0FuaW1hdGlvblR5cGUuT3ZlclBhdGgsXHJcbiAgICAgICAgICAgIGNvZGU6IGRhdGEuYWN0b3IuY29kZSxcclxuICAgICAgICAgICAgY29sb3I6IEJyZXcuQ29sb3IucmVkLFxyXG4gICAgICAgICAgICBmcm9tX3h5OiBtb3ZlRXZlbnQubW92ZURhdGEuZnJvbV94eSxcclxuICAgICAgICAgICAgdG9feHk6IG1vdmVFdmVudC5tb3ZlRGF0YS50b194eVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBnbS5pbnNlcnRFdmVudChhbmltYXRpb25FdmVudClcclxuICAgIGdtLmluc2VydEV2ZW50KG1vdmVFdmVudClcclxuICAgIGdtLmluc2VydEV2ZW50KGF0dGFja0V2ZW50KVxyXG5cclxuICAgIC8vIEJyZXcuQW5pbWF0aW9ucy5hbmltYXRlUm9ja2V0UHVuY2goZ20sIGRhdGEpXHJcbiAgICBnbS5lbmRFdmVudChkYXRhKVxyXG59XHJcblxyXG5cclxuXHJcbmZ1bmN0aW9uIGRhbWFnZUFsbEluQXhlUGF0aChnbTogQnJldy5HYW1lTWFzdGVyLCBheGVfcGF0aDogQXJyYXk8QnJldy5Db29yZGluYXRlPiwgYXhlX3Bvd2VyOiBQb3dlciwgcmVjYWxsOiBib29sZWFuKSB7XHJcbiAgICBcclxuICAgIC8vIGlmIChyZWNhbGwpIHtcclxuICAgIC8vICAgICBheGVfcGF0aC5zcGxpY2UoYXhlX3BhdGgubGVuZ3RoLTEsMSlcclxuICAgIC8vIH1cclxuICAgIGlmIChyZWNhbGwpIHtcclxuICAgICAgICAvLyBjdXQgb2ZmIHRoZSBlbmQgd2hlbiByZWNhbGxpbmcgKGRvbnQgaGl0IHBsYXllcilcclxuICAgICAgICBheGVfcGF0aC5zcGxpY2UoYXhlX3BhdGgubGVuZ3RoLTEsIDEpXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vIGN1dCBvZmYgdGhlIGZyb250IHdoZW4gdGhyb3dpbmdcclxuICAgICAgICBheGVfcGF0aC5zcGxpY2UoMCwgMSlcclxuICAgIH1cclxuXHJcbiAgICBsZXQgZG1nX2Ftb3VudCA6IG51bWJlciA9IGF4ZV9wb3dlci5hc3NvY2lhdGVkX2l0ZW0uZGFtYWdlXHJcblxyXG4gICAgbGV0IG1hc3NEYW1hZ2VFdmVudCA6IEJyZXcuRW51bXMuSUJyZXdFdmVudCA9IHtcclxuICAgICAgICBldmVudFR5cGU6IEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5NYXNzRGFtYWdlLFxyXG4gICAgICAgIGFjdG9yOiBnbS5nZXRQbGF5ZXIoKSxcclxuICAgICAgICBwbGF5ZXJJbml0aWF0ZWQ6IHRydWUsXHJcbiAgICAgICAgZW5kc1R1cm46IGZhbHNlLFxyXG4gICAgICAgIGF0dGFja0RhdGE6IHtcclxuICAgICAgICAgICAgaXNNZWxlZTogdHJ1ZSxcclxuICAgICAgICAgICAgZGFtYWdlOiBkbWdfYW1vdW50LFxyXG4gICAgICAgICAgICBmcm9tX3h5OiBudWxsLFxyXG4gICAgICAgICAgICB0b194eTogbnVsbCxcclxuICAgICAgICAgICAgdGFyZ2V0OiBudWxsLFxyXG4gICAgICAgICAgICBlZmZlY3RzOiBCcmV3LkNvbWJhdC5maWx0ZXJEYW1hZ2VFZmZlY3RzKGF4ZV9wb3dlci5hc3NvY2lhdGVkX2l0ZW0uZmxhZ3MpXHJcbiAgICAgICAgfSxcclxuICAgICAgICBwYXRoc0RhdGE6IHtcclxuICAgICAgICAgICAgZnJvbV94eTogYXhlX3BhdGhbMF0sXHJcbiAgICAgICAgICAgIHRvX3h5OiBheGVfcGF0aFtheGVfcGF0aC5sZW5ndGgtMV0sXHJcbiAgICAgICAgICAgIHBhdGg6IGF4ZV9wYXRoXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZ20uaW5zZXJ0RXZlbnQobWFzc0RhbWFnZUV2ZW50KVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gdGhyb3dfYXhlKGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGJyRXZlbnQ6IEJyZXcuRW51bXMuSUJyZXdFdmVudCkge1xyXG4gICAgLy8gcHV0IHRoZSBheGUgZG93biB3aGVyZSBpdCBsYW5kcyAgICAgICAgXHJcbiAgICBsZXQgbGV2ZWwgPSBnbS5nZXRDdXJyZW50TGV2ZWwoKVxyXG4gICAgbGV0IGZpbmFsX3h5ID0gYnJFdmVudC5wYXRoc0RhdGEudG9feHlcclxuICAgIFxyXG4gICAgYnJFdmVudC5wb3dlckRhdGEucG93ZXIuY2hhcmdlX3N0YXQuZGVjcmVtZW50KDEpXHJcblxyXG4gICAgLy8gdG9kbzogcmVhbGx5IG5lZWQgYSB3YXkgdG8gbW92ZSBpdGVtcyBhcm91bmRcclxuICAgIGxldCBheGVfaXRlbSA9IGJyRXZlbnQucG93ZXJEYXRhLnBvd2VyLmFzc29jaWF0ZWRfaXRlbVxyXG4gICAgbGV2ZWwuaXRlbXMucmVtb3ZlQXQoZmluYWxfeHkpXHJcbiAgICBsZXZlbC5pdGVtcy5zZXRBdChmaW5hbF94eSwgYXhlX2l0ZW0pXHJcbiAgICBnbS5kaXNwbGF5QXQoZmluYWxfeHkpXHJcblxyXG4gICAgLy8gdXBkYXRlIHRoZSBwb3dlciB0byBzYXkgdGhlIGF4ZSBpcyBhY3RpdmF0ZWQgYW5kIGRvIGEgbGlua1xyXG4gICAgbGV0IHBvd2VyIDogUG93ZXIgPSBickV2ZW50LnBvd2VyRGF0YS5wb3dlclxyXG4gICAgcG93ZXIuYWN0aXZhdGVkID0gdHJ1ZVxyXG5cclxuICAgIGRhbWFnZUFsbEluQXhlUGF0aChnbSwgYnJFdmVudC5wYXRoc0RhdGEucGF0aCwgcG93ZXIsIGZhbHNlKVxyXG5cclxuICAgIGdtLmVuZEV2ZW50KGJyRXZlbnQpXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiByZWNhbGxfYXhlKGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGJyRXZlbnQ6IEJyZXcuRW51bXMuSUJyZXdFdmVudCkge1xyXG4gICAgLy8gdG9kbzogaG93IHRvIGhhbmRsZSAtIG9yIHJlc3RyaWN0IC0gbXVsdGlwbGUgYXhlIHBvd2Vyc1xyXG5cclxuICAgIC8vIGZpbmQgdGhlIGF4ZVxyXG4gICAgbGV0IHBvd2VyIDogUG93ZXIgPSBickV2ZW50LnBvd2VyRGF0YS5wb3dlclxyXG4gICAgbGV0IGF4ZV9pdGVtIDogQnJldy5HcmlkVGhpbmdzLkl0ZW0gPSBwb3dlci5hc3NvY2lhdGVkX2l0ZW1cclxuICAgIGxldCBsZXZlbCA9IGdtLmdldEN1cnJlbnRMZXZlbCgpXHJcbiAgICBsZXQgYXhlX3h5ID0gYXhlX2l0ZW0ubG9jYXRpb25cclxuICAgIGxldmVsLml0ZW1zLnJlbW92ZUF0KGF4ZV94eSlcclxuICAgIGdtLmRpc3BsYXlBdChheGVfeHkpXHJcblxyXG4gICAgbGV0IGFuaW1hdGlvbkV2ZW50ID0gQnJldy5FdmVudHMuY3JlYXRlR2VuZXJpY0V2ZW50T2ZUeXBlKGdtLCBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuUnVuQW5pbWF0aW9uLCBmYWxzZSlcclxuICAgIGFuaW1hdGlvbkV2ZW50LmFuaW1hdGlvbkRhdGEgPSB7XHJcbiAgICAgICAgYW5pbWF0aW9uVHlwZTogQnJldy5FbnVtcy5CcmV3QW5pbWF0aW9uVHlwZS5PdmVyUGF0aCxcclxuICAgICAgICBjb2RlOiBheGVfaXRlbS5jb2RlLFxyXG4gICAgICAgIGNvbG9yOiBheGVfaXRlbS5jb2xvcixcclxuICAgICAgICBmcm9tX3h5OiBickV2ZW50LnBhdGhzRGF0YS5mcm9tX3h5LFxyXG4gICAgICAgIHRvX3h5OiBickV2ZW50LnBhdGhzRGF0YS50b194eSxcclxuICAgICAgICBwYXRoOiBickV2ZW50LnBhdGhzRGF0YS5wYXRoXHJcbiAgICB9XHJcbiAgICBnbS5pbnNlcnRFdmVudChhbmltYXRpb25FdmVudClcclxuXHJcbiAgICAvLyBkZWFjdGl2YXRlXHJcbiAgICBickV2ZW50LnBvd2VyRGF0YS5wb3dlci5hY3RpdmF0ZWQgPSBmYWxzZVxyXG4gICAgXHJcbiAgICBkYW1hZ2VBbGxJbkF4ZVBhdGgoZ20sIGJyRXZlbnQucGF0aHNEYXRhLnBhdGgsIGJyRXZlbnQucG93ZXJEYXRhLnBvd2VyLCB0cnVlKVxyXG5cclxuICAgIGdtLmVuZEV2ZW50KGJyRXZlbnQpXHJcbn1cclxuXHJcbi8vIGV4cG9ydCBmdW5jdGlvbiB3YXJwX3Bvd2VyKGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGJyRXZlbnQ6IEJyZXcuRW51bXMuSUJyZXdFdmVudCkge1xyXG4vLyAgICAgbGV0IG5ld19sb2NfeHkgPSBnbS5nZXRDdXJyZW50TGV2ZWwoKS5nZXRTYWZlTG9jYXRpb24oKVxyXG5cclxuLy8gICAgIGxldCB3YXJwRXZlbnQgOiBCcmV3LkVudW1zLklCcmV3RXZlbnQgPSB7XHJcbi8vICAgICAgICAgZXZlbnRUeXBlOiBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuTW92ZSxcclxuLy8gICAgICAgICBhY3RvcjogYnJFdmVudC5hY3RvcixcclxuLy8gICAgICAgICBwbGF5ZXJJbml0aWF0ZWQ6IHRydWUsXHJcbi8vICAgICAgICAgZW5kc1R1cm46IHRydWUsXHJcbi8vICAgICAgICAgbW92ZURhdGE6IHtcclxuLy8gICAgICAgICAgICAgZnJvbV94eTogYnJFdmVudC5hY3Rvci5sb2NhdGlvbi5jbG9uZSgpLFxyXG4vLyAgICAgICAgICAgICB0b194eTogbmV3X2xvY194eVxyXG4vLyAgICAgICAgIH1cclxuLy8gICAgIH1cclxuXHJcbi8vICAgICBnbS5lbmRFdmVudCh3YXJwRXZlbnQpXHJcbi8vIH1cclxuXHJcbi8vIGV4cG9ydCBmdW5jdGlvbiBzdHVuX3Bvd2VyKGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGJyRXZlbnQ6IEJyZXcuRW51bXMuSUJyZXdFdmVudCkge1xyXG5cclxuLy8gICAgIGxldCBzdHVuRXZlbnQgOiBCcmV3LkVudW1zLklCcmV3RXZlbnQgPSB7XHJcbi8vICAgICAgICAgZXZlbnRUeXBlOiBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuTWFzc0RhbWFnZSxcclxuLy8gICAgICAgICBhY3RvcjogYnJFdmVudC5hY3RvcixcclxuLy8gICAgICAgICBwbGF5ZXJJbml0aWF0ZWQ6IHRydWUsXHJcbi8vICAgICAgICAgZW5kc1R1cm46IHRydWUsXHJcbi8vICAgICAgICAgYXR0YWNrRGF0YToge1xyXG4vLyAgICAgICAgICAgICBmcm9tX3h5OiBnbS5hY1xyXG4vLyAgICAgICAgIH0sXHJcbi8vICAgICAgICAgcGF0aHNEYXRhOiB7XHJcbiAgICAgICAgICAgIFxyXG4vLyAgICAgICAgIH0sXHJcbi8vICAgICB9XHJcblxyXG4vLyAgICAgZ20uZW5kRXZlbnQoYnJFdmVudClcclxuLy8gfVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldFBvd2VyTWF4RGlzdGFuY2UoZm9yX3Bvd2VyOiBQb3dlcikge1xyXG4gICAgcmV0dXJuIDQgKyAoZm9yX3Bvd2VyLnN0cmVuZ3RoLmdldEN1cnJlbnRMZXZlbCgpICogMilcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNhblVwZ3JhZGVQb3dlclN0cmVuZ3RoKGdpdmVuX3Bvd2VyOiBQb3dlcikgOiBib29sZWFuIHtcclxuICAgIHJldHVybiAoZ2l2ZW5fcG93ZXIuc3RyZW5ndGguZ2V0Q3VycmVudExldmVsKCkgPCBnaXZlbl9wb3dlci5zdHJlbmd0aC5nZXRNYXhMZXZlbCgpKVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY2FuVXBncmFkZVBvd2VyQ2hhcmdlcyhnaXZlbl9wb3dlcjogUG93ZXIpIDogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gKChnaXZlbl9wb3dlci5jYW5CZVJlY2hhcmdlZCkgJiYgKGdpdmVuX3Bvd2VyLmNoYXJnZV9zdGF0LmdldE1heExldmVsKCkgPCBCcmV3LkNvbmZpZy5tYXhfcG93ZXJfY2hhcmdlcykpXHJcbn1cclxuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/brew_game/powers.ts\n");

/***/ }),

/***/ "./src/brew_game/targeting.ts":
/*!************************************!*\
  !*** ./src/brew_game/targeting.ts ***!
  \************************************/
/*! exports provided: clearTargetLocks, hasTargetLock, clearTargetLocksBy, clearTargetLocksOn, aquireTargetLockEvent, targetingOn, targetingCancel, targetingFinish, showTargetingHighlights, clearTargetingHighlights, targetingMove, checkTargetingPath, getTargetingDataByType, getClosestTargets, getClosestTarget, isRangedAttackThreat, createTestTargetingEvent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"clearTargetLocks\", function() { return clearTargetLocks; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"hasTargetLock\", function() { return hasTargetLock; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"clearTargetLocksBy\", function() { return clearTargetLocksBy; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"clearTargetLocksOn\", function() { return clearTargetLocksOn; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"aquireTargetLockEvent\", function() { return aquireTargetLockEvent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"targetingOn\", function() { return targetingOn; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"targetingCancel\", function() { return targetingCancel; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"targetingFinish\", function() { return targetingFinish; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"showTargetingHighlights\", function() { return showTargetingHighlights; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"clearTargetingHighlights\", function() { return clearTargetingHighlights; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"targetingMove\", function() { return targetingMove; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"checkTargetingPath\", function() { return checkTargetingPath; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getTargetingDataByType\", function() { return getTargetingDataByType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getClosestTargets\", function() { return getClosestTargets; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getClosestTarget\", function() { return getClosestTarget; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isRangedAttackThreat\", function() { return isRangedAttackThreat; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"createTestTargetingEvent\", function() { return createTestTargetingEvent; });\n/* harmony import */ var _brew__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../brew */ \"./src/brew.ts\");\n\r\nvar TargetingError;\r\n(function (TargetingError) {\r\n    TargetingError[TargetingError[\"TargetNotViewable\"] = 1] = \"TargetNotViewable\";\r\n    TargetingError[TargetingError[\"TargetNotWalkable\"] = 2] = \"TargetNotWalkable\";\r\n    TargetingError[TargetingError[\"PathBlockedByTerrain\"] = 3] = \"PathBlockedByTerrain\";\r\n    TargetingError[TargetingError[\"PathBlockedByMob\"] = 4] = \"PathBlockedByMob\";\r\n    TargetingError[TargetingError[\"TargetMonsterRequired\"] = 5] = \"TargetMonsterRequired\";\r\n    TargetingError[TargetingError[\"LessThanMinimumDistance\"] = 6] = \"LessThanMinimumDistance\";\r\n    TargetingError[TargetingError[\"MoreThanMaximumDistance\"] = 7] = \"MoreThanMaximumDistance\";\r\n    TargetingError[TargetingError[\"LandingNotWalkable\"] = 8] = \"LandingNotWalkable\";\r\n    TargetingError[TargetingError[\"TargetNotWithinFiringArc\"] = 9] = \"TargetNotWithinFiringArc\";\r\n})(TargetingError || (TargetingError = {}));\r\nlet targetLockList = [];\r\nfunction clearTargetLocks() {\r\n    targetLockList = [];\r\n}\r\nfunction matchTargetLock(attacker, target, given_targetlock) {\r\n    return ((attacker.getID() == given_targetlock.from) &&\r\n        (target.getID() == given_targetlock.to));\r\n}\r\nfunction hasTargetLock(attacker, target) {\r\n    let attacker_id = attacker.getID();\r\n    let target_id = target.getID();\r\n    let found_list = targetLockList.filter((targetlock) => {\r\n        return matchTargetLock(attacker, target, targetlock);\r\n    });\r\n    return found_list.length > 0;\r\n}\r\nfunction addTargetLock(attacker, target) {\r\n    if (hasTargetLock(attacker, target)) {\r\n        // no need to ask twice\r\n        return;\r\n    }\r\n    let new_lock = {\r\n        from: attacker.getID(),\r\n        to: target.getID()\r\n    };\r\n    targetLockList.push(new_lock);\r\n}\r\nfunction clearTargetLocksBy(attacker) {\r\n    let had_locks_on = [];\r\n    targetLockList = targetLockList.filter((targetlock) => {\r\n        if (targetlock.from == attacker.getID()) {\r\n            had_locks_on.push(targetlock.to);\r\n            return false;\r\n        }\r\n        else {\r\n            return true;\r\n        }\r\n    });\r\n    return had_locks_on;\r\n}\r\nfunction clearTargetLocksOn(target) {\r\n    let had_locks_by = [];\r\n    targetLockList = targetLockList.filter((targetlock) => {\r\n        if (targetlock.to == target.getID()) {\r\n            had_locks_by.push(targetlock.from);\r\n            return false;\r\n        }\r\n        else {\r\n            return true;\r\n        }\r\n    });\r\n    return had_locks_by;\r\n}\r\n// export function getTargetLocksOn(target: Brew.GridThings.Monster) : Array<ITargetLock> {\r\n//     //\r\n//     return targetLockList.filter((targetlock) => {\r\n//         return targetlock.to == target.getID()\r\n//     })\r\n// }\r\nfunction aquireTargetLockEvent(gm, brEvent) {\r\n    // send in what would otherwise be an attack event\r\n    let target = brEvent.attackData.target;\r\n    let attacker = brEvent.actor;\r\n    addTargetLock(attacker, target);\r\n    // console.log(\"target locked\")\r\n    // flash when locking\r\n    gm.insertEvent({\r\n        eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.RunAnimation,\r\n        actor: brEvent.actor,\r\n        endsTurn: false,\r\n        playerInitiated: false,\r\n        animationData: {\r\n            animationType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewAnimationType.Flash,\r\n            color: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].orange,\r\n            from_xy: attacker.location.clone(),\r\n            to_xy: attacker.location.clone(),\r\n        }\r\n    });\r\n    gm.endEvent(brEvent);\r\n}\r\n//////////////////// targeting\r\nfunction targetingOn(gm, data) {\r\n    // set up targeting data depending on type\r\n    data.targetingData = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Targeting\"].getTargetingDataByType(gm, data);\r\n    // guess initial target\r\n    let good_guess = false;\r\n    let guess_mob = getClosestTarget(gm, data.actor);\r\n    if (guess_mob) {\r\n        data.targetingData.to_xy = guess_mob.location;\r\n        // check new targeting and show the results\r\n        let resp = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Targeting\"].checkTargetingPath(gm, data);\r\n        if (resp.is_valid) {\r\n            showTargetingHighlights(gm, data, resp);\r\n            good_guess = true;\r\n        }\r\n    }\r\n    // if we dont have a good guess or path is invalid then start from scratch\r\n    if (!(good_guess)) {\r\n        let tgtHighlight = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].terrainFactory(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].TerrainType.Highlight);\r\n        tgtHighlight.color = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].target_cursor;\r\n        gm.display.highlights.setAt(gm.getPlayer().location, tgtHighlight);\r\n        gm.displayAt(gm.getPlayer().location);\r\n    }\r\n    // examine is a special case\r\n    if (data.targetingData.action == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewTargetingAction.Examine) {\r\n        gm.display.updateDescriptionFooterForPoint(data.targetingData.to_xy);\r\n    }\r\n    gm.input_handler = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].InputHandler.Targeting;\r\n    gm.endEvent(data);\r\n}\r\nfunction targetingCancel(gm, data) {\r\n    console.log(\"cancelling targeting\");\r\n    clearTargetingHighlights(gm);\r\n    gm.display.drawFooter();\r\n    gm.input_handler = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].InputHandler.Main;\r\n    gm.endEvent(data);\r\n}\r\nfunction targetingFinish(gm, data) {\r\n    // make sure we didn't error out first\r\n    let resp = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Targeting\"].checkTargetingPath(gm, data);\r\n    if (!(resp.is_valid)) {\r\n        targetingCancel(gm, data);\r\n        return;\r\n    }\r\n    // console.log(\"target gotten: \", data.targetingData.action)\r\n    clearTargetingHighlights(gm);\r\n    gm.input_handler = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].InputHandler.Main;\r\n    gm.copyEventDataFromLastEvent(data);\r\n    data.targetingData.path = resp.path;\r\n    let nextEventAfterTargeting;\r\n    if (data.targetingData.action == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewTargetingAction.ThrowItem) {\r\n        nextEventAfterTargeting = {\r\n            // todo: change this to some kind of 'landing' event\r\n            eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.Land,\r\n            actor: data.actor,\r\n            playerInitiated: true,\r\n            endsTurn: true,\r\n            itemData: {\r\n                item: data.itemData.item,\r\n                invkey: data.itemData.invkey,\r\n                to_xy: data.targetingData.to_xy.clone()\r\n            }\r\n        };\r\n        let animationEvent = {\r\n            eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.RunAnimation,\r\n            actor: data.actor,\r\n            playerInitiated: true,\r\n            endsTurn: false,\r\n            animationData: {\r\n                animationType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewAnimationType.OverPath,\r\n                code: data.itemData.item.code,\r\n                color: data.itemData.item.color,\r\n                from_xy: data.actor.location.clone(),\r\n                to_xy: data.targetingData.to_xy.clone()\r\n            }\r\n        };\r\n        gm.insertEvent(animationEvent);\r\n    }\r\n    else if (data.targetingData.action == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewTargetingAction.HeaveItem) {\r\n        nextEventAfterTargeting = {\r\n            // todo: change this to some kind of 'landing' event\r\n            eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.Heave,\r\n            actor: data.actor,\r\n            playerInitiated: true,\r\n            endsTurn: true,\r\n            itemData: {\r\n                item: data.itemData.item,\r\n                // invkey: data.itemData.invkey,\r\n                to_xy: data.targetingData.to_xy.clone(),\r\n            }\r\n        };\r\n        let animationEvent = {\r\n            eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.RunAnimation,\r\n            actor: data.actor,\r\n            playerInitiated: true,\r\n            endsTurn: false,\r\n            animationData: {\r\n                animationType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewAnimationType.OverPath,\r\n                code: data.itemData.item.code,\r\n                color: data.itemData.item.color,\r\n                from_xy: data.actor.location.clone(),\r\n                to_xy: data.targetingData.to_xy.clone()\r\n            }\r\n        };\r\n        gm.insertEvent(animationEvent);\r\n    }\r\n    else if (data.targetingData.action == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewTargetingAction.ThrowHeavyAxe) {\r\n        nextEventAfterTargeting = {\r\n            eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.HeavyAxeThrow,\r\n            actor: data.actor,\r\n            playerInitiated: true,\r\n            endsTurn: true,\r\n            pathsData: {\r\n                from_xy: data.targetingData.from_xy.clone(),\r\n                to_xy: data.targetingData.to_xy.clone(),\r\n                path: data.targetingData.path\r\n            },\r\n            powerData: Object.assign({}, data.powerData)\r\n        };\r\n        let animationEvent = {\r\n            eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.RunAnimation,\r\n            actor: data.actor,\r\n            playerInitiated: true,\r\n            endsTurn: false,\r\n            animationData: {\r\n                animationType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewAnimationType.OverPath,\r\n                code: data.powerData.power.associated_item.code,\r\n                color: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].power_axe,\r\n                from_xy: data.actor.location.clone(),\r\n                to_xy: data.targetingData.to_xy.clone()\r\n            }\r\n        };\r\n        gm.insertEvent(animationEvent);\r\n    }\r\n    else if (data.targetingData.action == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewTargetingAction.Hack) {\r\n        nextEventAfterTargeting = {\r\n            eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.Hack,\r\n            actor: data.actor,\r\n            playerInitiated: true,\r\n            endsTurn: true,\r\n            powerData: data.powerData,\r\n            moveData: {\r\n                to_xy: data.targetingData.to_xy.clone(),\r\n                from_xy: data.targetingData.from_xy.clone()\r\n            }\r\n        };\r\n    }\r\n    else if (data.targetingData.action == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewTargetingAction.RocketPunch) {\r\n        nextEventAfterTargeting = {\r\n            eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.RocketPunch,\r\n            actor: data.actor,\r\n            playerInitiated: true,\r\n            endsTurn: true,\r\n            powerData: data.powerData,\r\n            moveData: {\r\n                to_xy: data.targetingData.to_xy.clone(),\r\n                from_xy: data.targetingData.from_xy.clone()\r\n            },\r\n            targetingData: Object.assign({}, data.targetingData)\r\n        };\r\n    }\r\n    else if (data.targetingData.action == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewTargetingAction.Examine) {\r\n        nextEventAfterTargeting = {\r\n            eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.Info,\r\n            actor: data.actor,\r\n            playerInitiated: true,\r\n            endsTurn: false,\r\n            moveData: {\r\n                from_xy: data.targetingData.from_xy,\r\n                to_xy: data.targetingData.to_xy\r\n            }\r\n        };\r\n    }\r\n    else if (data.targetingData.action == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewTargetingAction.DebugSummonMob) {\r\n        nextEventAfterTargeting = {\r\n            eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.DebugCreateMobAt,\r\n            actor: data.actor,\r\n            playerInitiated: true,\r\n            endsTurn: false,\r\n            moveData: {\r\n                from_xy: data.targetingData.from_xy,\r\n                to_xy: data.targetingData.to_xy\r\n            },\r\n            debugMenuData: Object.assign({}, data.debugMenuData)\r\n        };\r\n    }\r\n    else if (data.targetingData.action == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewTargetingAction.DebugMakeFeature) {\r\n        nextEventAfterTargeting = {\r\n            eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.DebugCreateFeatureAt,\r\n            actor: data.actor,\r\n            playerInitiated: true,\r\n            endsTurn: false,\r\n            moveData: {\r\n                from_xy: data.targetingData.from_xy,\r\n                to_xy: data.targetingData.to_xy\r\n            },\r\n            debugMenuData: Object.assign({}, data.debugMenuData)\r\n        };\r\n    }\r\n    else if (data.targetingData.action == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewTargetingAction.DebugMakeTerrain) {\r\n        nextEventAfterTargeting = {\r\n            eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.DebugCreateTerrainAt,\r\n            actor: data.actor,\r\n            playerInitiated: true,\r\n            endsTurn: false,\r\n            moveData: {\r\n                from_xy: data.targetingData.from_xy,\r\n                to_xy: data.targetingData.to_xy\r\n            },\r\n            debugMenuData: Object.assign({}, data.debugMenuData)\r\n        };\r\n    }\r\n    else if (data.targetingData.action == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewTargetingAction.RangedAttack) {\r\n        let attack_target = gm.getCurrentLevel().monsters.getAt(data.targetingData.to_xy);\r\n        nextEventAfterTargeting = {\r\n            eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.Attack,\r\n            actor: data.actor,\r\n            playerInitiated: true,\r\n            endsTurn: true,\r\n            powerData: data.powerData,\r\n            attackData: {\r\n                from_xy: data.targetingData.from_xy,\r\n                to_xy: data.targetingData.to_xy,\r\n                target: attack_target,\r\n                isMelee: false,\r\n                damage: data.powerData.power.associated_item.damage,\r\n                effects: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Combat\"].filterDamageEffects(data.powerData.power.associated_item.flags)\r\n            }\r\n        };\r\n    }\r\n    else {\r\n        throw new Error(`unknown or unhandled type of targeting action ${data.targetingData.action}`);\r\n    }\r\n    gm.insertEvent_Next(nextEventAfterTargeting);\r\n    gm.endEvent(data);\r\n}\r\nfunction showTargetingHighlights(gm, data, targetingResponse) {\r\n    // clear the old highlights\r\n    clearTargetingHighlights(gm);\r\n    // setup our highlight colors\r\n    let tHighlight = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].terrainFactory(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].TerrainType.Highlight);\r\n    tHighlight.color = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].target_path;\r\n    let tCursor = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].terrainFactory(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].TerrainType.Highlight);\r\n    // set highlights across the path and show them\r\n    targetingResponse.path.forEach((xy, index, array) => {\r\n        gm.display.highlights.setAt(xy, tHighlight);\r\n    });\r\n    // change cursor color depending on the outcome\r\n    if (targetingResponse.is_valid) {\r\n        tCursor.color = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].target_cursor;\r\n    }\r\n    else {\r\n        tCursor.color = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Color\"].target_error;\r\n    }\r\n    // set the cursor by itself\r\n    gm.display.highlights.removeAt(data.targetingData.to_xy);\r\n    gm.display.highlights.setAt(data.targetingData.to_xy, tCursor);\r\n    // tell the display to redraw all these new highlighted squares\r\n    gm.displayList(targetingResponse.path.concat(data.targetingData.to_xy));\r\n    // gm.displayAt(data.targetingData.to_xy)\r\n}\r\nfunction clearTargetingHighlights(gm) {\r\n    // actually just clear all highlights\r\n    let copyList = gm.display.highlights.getAllCoordinates();\r\n    copyList.forEach((value, index, array) => {\r\n        gm.display.highlights.removeAt(value);\r\n    });\r\n    gm.displayList(copyList);\r\n}\r\nfunction targetingMove(gm, data) {\r\n    // modify event, so we can grab last event next time.. keep updating target location as we move\r\n    // move target\r\n    let offset_xy = data.offsetData.offset_xy;\r\n    let current_target_xy = data.targetingData.to_xy;\r\n    let new_target_xy = current_target_xy.add(offset_xy);\r\n    // twp: copy event data from last event, so we keep track of our item/target thing/etc\r\n    // let lastEventData = gm.getLastEvent().itemData\r\n    // data.itemData = {...lastEventData}\r\n    gm.copyEventDataFromLastEvent(data);\r\n    // set new target\r\n    data.targetingData.to_xy = new_target_xy;\r\n    // check new targeting and show the results\r\n    let resp = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Targeting\"].checkTargetingPath(gm, data);\r\n    showTargetingHighlights(gm, data, resp);\r\n    // examine is a special case - apply this code as we go\r\n    if (data.targetingData.action == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewTargetingAction.Examine) {\r\n        gm.display.updateDescriptionFooterForPoint(data.targetingData.to_xy);\r\n    }\r\n    gm.endEvent(data);\r\n}\r\nfunction checkTargetingPath(gm, data) {\r\n    let level = gm.getCurrentLevel();\r\n    let target_xy = data.targetingData.to_xy;\r\n    let in_fov = data.actor.fov.hasAt(target_xy); //data.actor.inFOV(t)\r\n    // initial response\r\n    let response = {\r\n        is_valid: false,\r\n        path: []\r\n    };\r\n    // check target first, easier than checking the entire path\r\n    if ((!in_fov) && data.targetingData.destinationMustBeVisible) {\r\n        response.error_reason = TargetingError.TargetNotViewable;\r\n        return response;\r\n    }\r\n    let terrain_at = level.terrain.getAt(target_xy);\r\n    if (terrain_at.blocks_walking && data.targetingData.destinationMustBeWalkable) {\r\n        response.error_reason = TargetingError.TargetNotWalkable;\r\n        return response;\r\n    }\r\n    if (data.targetingData.method == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewTargetingMethod.PointOnly) {\r\n        response.path = [target_xy];\r\n        response.is_valid = true;\r\n    }\r\n    else if (data.targetingData.method == _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewTargetingMethod.StraightLine) {\r\n        // draw new path\r\n        let path_lst = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].getLineBetweenPoints(data.targetingData.from_xy, data.targetingData.to_xy);\r\n        // check for minimum distance\r\n        if (path_lst.length < data.targetingData.minimumDistance) {\r\n            response.is_valid = false;\r\n            response.error_reason = TargetingError.LessThanMinimumDistance;\r\n            return response;\r\n        }\r\n        // check for max distance\r\n        if (data.targetingData.maximumDistance && (path_lst.length > data.targetingData.maximumDistance)) {\r\n            response.is_valid = false;\r\n            response.error_reason = TargetingError.MoreThanMaximumDistance;\r\n            return response;\r\n        }\r\n        // check for within arc\r\n        if (data.targetingData.minimumArc) {\r\n            let target_offset_polar = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].xyToPolar(target_xy, data.targetingData.from_xy);\r\n            let target_angle = target_offset_polar.angle_theta;\r\n            if ((Math.abs(data.targetingData.midpointArc) == Math.PI) && (target_offset_polar.angle_theta < 0)) {\r\n                target_angle = Math.PI + (Math.PI - Math.abs(target_angle));\r\n            }\r\n            let in_arc1 = (target_angle >= data.targetingData.minimumArc) && (target_angle <= data.targetingData.midpointArc);\r\n            let in_arc2 = (target_angle >= data.targetingData.midpointArc) && (target_angle <= data.targetingData.maximumArc);\r\n            if (!(in_arc1 || in_arc2)) {\r\n                response.is_valid = false;\r\n                response.error_reason = TargetingError.TargetNotWithinFiringArc;\r\n                return response;\r\n            }\r\n        }\r\n        // assume path is true unless we run into something\r\n        response.is_valid = true;\r\n        let real_path_lst = [];\r\n        for (let i = 0; i < path_lst.length; i++) {\r\n            let xy = path_lst[i];\r\n            let t = level.terrain.getAt(xy);\r\n            in_fov = data.actor.fov.hasAt(xy); //data.actor.inFOV(t)\r\n            if (data.targetingData.destinationMustBeVisible && (!(in_fov))) {\r\n                response.is_valid = false;\r\n                response.error_reason = TargetingError.TargetNotViewable;\r\n                break;\r\n            }\r\n            if (data.targetingData.pathBlockedByNonWalkable && t.blocks_walking) {\r\n                response.is_valid = false;\r\n                response.error_reason = TargetingError.PathBlockedByTerrain;\r\n                break;\r\n            }\r\n            if (data.targetingData.pathBlockedByNonFlyable && t.blocks_flying) {\r\n                response.is_valid = false;\r\n                response.error_reason = TargetingError.PathBlockedByTerrain;\r\n                break;\r\n            }\r\n            let m = level.monsters.getAt(xy);\r\n            let last_element = i == (path_lst.length - 1);\r\n            if (!(last_element)) {\r\n                // not the last coord, but mob is in the way\r\n                if (data.targetingData.pathBlockedByMobs && (m) && (!(i == 0))) {\r\n                    real_path_lst.push(xy);\r\n                    response.is_valid = false;\r\n                    response.error_reason = TargetingError.PathBlockedByMob;\r\n                    response.actual_xy = xy.clone();\r\n                    break;\r\n                }\r\n            }\r\n            else {\r\n                // is the last element, check if we need to have a mob target\r\n                // todo: maybe some kind of good / bad indicator for the path\r\n            }\r\n            real_path_lst.push(xy);\r\n        } // end path for loop\r\n        response.path = real_path_lst;\r\n    } // end if\r\n    // see if we need a target at the end of everything\r\n    if (response.is_valid && data.targetingData.destinationMustHaveMob) {\r\n        let check_m = level.monsters.getAt(target_xy);\r\n        if (!(check_m)) {\r\n            response.is_valid = false;\r\n            response.error_reason = TargetingError.TargetMonsterRequired;\r\n        }\r\n        else if (!(data.actor.hasKnowledgeOf(check_m))) {\r\n            response.is_valid = false;\r\n            response.error_reason = TargetingError.TargetMonsterRequired;\r\n        }\r\n    }\r\n    // special check for 'actual' landing spot\r\n    if (response.actual_xy) {\r\n        let terrain_at = level.terrain.getAt(response.actual_xy);\r\n        if (data.targetingData.destinationMustBeWalkable && terrain_at.blocks_walking) {\r\n            response.is_valid = false;\r\n            response.error_reason = TargetingError.LandingNotWalkable;\r\n        }\r\n    }\r\n    return response;\r\n}\r\nfunction getTargetingDataByType(gm, data) {\r\n    let tgtAction = data.startTargetingData.targetingAction;\r\n    let result;\r\n    let power;\r\n    if ([_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewTargetingAction.RangedAttack].indexOf(tgtAction) > -1) {\r\n        // let firing_range = Brew.Tank.getFiringArcRange(gm, data.actor.location, )\r\n        let mob_target_required = (data.powerData.power.powerType != _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewPowerType.TurretCannon);\r\n        result = {\r\n            action: data.startTargetingData.targetingAction,\r\n            origin_xy: gm.getPlayer().location.clone(),\r\n            from_xy: gm.getPlayer().location.clone(),\r\n            to_xy: gm.getPlayer().location.clone(),\r\n            method: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewTargetingMethod.StraightLine,\r\n            destinationMustBeVisible: true,\r\n            destinationMustBeWalkable: false,\r\n            destinationMustHaveMob: mob_target_required,\r\n            pathBlockedByNonFlyable: true,\r\n            pathBlockedByNonWalkable: false,\r\n            pathBlockedByMobs: true,\r\n            minimumDistance: 0,\r\n            minimumArc: data.startTargetingData.minimumArc,\r\n            maximumArc: data.startTargetingData.maximumArc,\r\n            midpointArc: data.startTargetingData.midpointArc,\r\n        };\r\n    }\r\n    else if ([_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewTargetingAction.Examine, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewTargetingAction.DebugSummonMob, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewTargetingAction.DebugMakeFeature, _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewTargetingAction.DebugMakeTerrain].indexOf(tgtAction) > -1) {\r\n        result = {\r\n            action: data.startTargetingData.targetingAction,\r\n            origin_xy: gm.getPlayer().location.clone(),\r\n            from_xy: gm.getPlayer().location.clone(),\r\n            to_xy: gm.getPlayer().location.clone(),\r\n            method: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewTargetingMethod.PointOnly,\r\n            destinationMustBeVisible: false,\r\n            destinationMustBeWalkable: false,\r\n            destinationMustHaveMob: false,\r\n            pathBlockedByNonFlyable: false,\r\n            pathBlockedByNonWalkable: false,\r\n            pathBlockedByMobs: false,\r\n            minimumDistance: 0,\r\n        };\r\n    }\r\n    else {\r\n        // default case\r\n        result = {\r\n            action: data.startTargetingData.targetingAction,\r\n            origin_xy: gm.getPlayer().location.clone(),\r\n            from_xy: gm.getPlayer().location.clone(),\r\n            to_xy: gm.getPlayer().location.clone(),\r\n            method: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewTargetingMethod.StraightLine,\r\n            destinationMustBeVisible: true,\r\n            destinationMustBeWalkable: true,\r\n            destinationMustHaveMob: false,\r\n            pathBlockedByNonFlyable: true,\r\n            pathBlockedByNonWalkable: false,\r\n            pathBlockedByMobs: true,\r\n            minimumDistance: 0,\r\n        };\r\n    }\r\n    return result;\r\n}\r\nfunction getClosestTargets(gm, actor) {\r\n    // return closest target within attack range\r\n    let level = gm.getCurrentLevel();\r\n    let distMap = {};\r\n    for (let m of level.monsters.getAllThings()) {\r\n        let dist2d = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].dist2d(actor.location, m.location);\r\n        distMap[m.getID()] = dist2d;\r\n    }\r\n    let monsters = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Intel\"].getMonstersKnownBy(gm, actor).filter((m, index, array) => {\r\n        // let dist2d = Math.floor(Utils.dist2d(actor.location, m.location))\r\n        return (_brew__WEBPACK_IMPORTED_MODULE_0__[\"Intel\"].isEnemy(actor, m)); //&& \r\n        // (dist2d <= actor.attack_range)\r\n    }).sort((aMob, bMob) => {\r\n        return distMap[aMob.getID()] - distMap[bMob.getID()];\r\n    });\r\n    return monsters;\r\n}\r\nfunction getClosestTarget(gm, actor) {\r\n    let targets = getClosestTargets(gm, actor);\r\n    if (targets.length == 0) {\r\n        return null;\r\n    }\r\n    else {\r\n        return targets[0];\r\n    }\r\n}\r\nfunction isRangedAttackThreat(gm, potential_attacker, target) {\r\n    // friends should not be threats\r\n    if (!(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Intel\"].isEnemy(target, potential_attacker))) {\r\n        return false;\r\n    }\r\n    // if they have a lock then they've already been through all the algorithms\r\n    if (hasTargetLock(potential_attacker, target)) {\r\n        return true;\r\n    }\r\n    // melee-only bad guys shouldnt ever be ranged threats\r\n    if (potential_attacker.attack_range == 1) {\r\n        return false;\r\n    }\r\n    // if they need a lock but don't have one then obviously they fail this test\r\n    if (potential_attacker.hasFlag(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].Flag.NeedsTargetLock)) {\r\n        return false;\r\n    }\r\n    // otherwise check if they have a clear shot\r\n    let testTargetEvent = createTestTargetingEvent(potential_attacker, target, 0, 2);\r\n    let targeting_check = checkTargetingPath(gm, testTargetEvent);\r\n    return targeting_check.is_valid;\r\n}\r\nfunction createTestTargetingEvent(potential_attacker, target, damage, min_distance) {\r\n    let testTargetEvent;\r\n    testTargetEvent = {\r\n        eventType: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewEventType.Attack,\r\n        actor: potential_attacker,\r\n        playerInitiated: false,\r\n        endsTurn: true,\r\n        attackData: {\r\n            from_xy: potential_attacker.location.clone(),\r\n            to_xy: target.location.clone(),\r\n            target: target,\r\n            isMelee: false,\r\n            damage: damage\r\n        }\r\n    };\r\n    testTargetEvent.targetingData = {\r\n        action: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewTargetingAction.RangedAttack,\r\n        method: _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewTargetingMethod.StraightLine,\r\n        destinationMustBeVisible: true,\r\n        destinationMustHaveMob: true,\r\n        destinationMustBeWalkable: false,\r\n        origin_xy: testTargetEvent.attackData.from_xy,\r\n        from_xy: testTargetEvent.attackData.from_xy,\r\n        to_xy: testTargetEvent.attackData.to_xy,\r\n        minimumDistance: min_distance,\r\n        pathBlockedByMobs: true,\r\n        pathBlockedByNonWalkable: false,\r\n        pathBlockedByNonFlyable: true,\r\n    };\r\n    return testTargetEvent;\r\n}\r\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvYnJld19nYW1lL3RhcmdldGluZy50cz81NTQ5Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBK0I7QUFFL0IsSUFBSyxjQVVKO0FBVkQsV0FBSyxjQUFjO0lBQ2YsNkVBQXFCO0lBQ3JCLDZFQUFpQjtJQUNqQixtRkFBb0I7SUFDcEIsMkVBQWdCO0lBQ2hCLHFGQUFxQjtJQUNyQix5RkFBdUI7SUFDdkIseUZBQXVCO0lBQ3ZCLCtFQUFrQjtJQUNsQiwyRkFBd0I7QUFDNUIsQ0FBQyxFQVZJLGNBQWMsS0FBZCxjQUFjLFFBVWxCO0FBZ0JELElBQUksY0FBYyxHQUF3QixFQUFFO0FBRXRDO0lBQ0YsY0FBYyxHQUFHLEVBQUU7QUFDdkIsQ0FBQztBQUVELHlCQUF5QixRQUFpQyxFQUFFLE1BQStCLEVBQUUsZ0JBQTZCO0lBQ3RILE1BQU0sQ0FBQyxDQUNILENBQUMsUUFBUSxDQUFDLEtBQUssRUFBRSxJQUFJLGdCQUFnQixDQUFDLElBQUksQ0FBQztRQUMzQyxDQUFDLE1BQU0sQ0FBQyxLQUFLLEVBQUUsSUFBSSxnQkFBZ0IsQ0FBQyxFQUFFLENBQUMsQ0FDMUM7QUFDTCxDQUFDO0FBRUssdUJBQXdCLFFBQWlDLEVBQUUsTUFBK0I7SUFDNUYsSUFBSSxXQUFXLEdBQUcsUUFBUSxDQUFDLEtBQUssRUFBRTtJQUNsQyxJQUFJLFNBQVMsR0FBRyxNQUFNLENBQUMsS0FBSyxFQUFFO0lBRTlCLElBQUksVUFBVSxHQUFHLGNBQWMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxVQUFVLEVBQUUsRUFBRTtRQUNsRCxNQUFNLENBQUMsZUFBZSxDQUFDLFFBQVEsRUFBRSxNQUFNLEVBQUUsVUFBVSxDQUFDO0lBQ3hELENBQUMsQ0FBQztJQUVGLE1BQU0sQ0FBQyxVQUFVLENBQUMsTUFBTSxHQUFHLENBQUM7QUFDaEMsQ0FBQztBQUVELHVCQUF1QixRQUFpQyxFQUFFLE1BQStCO0lBQ3JGLEVBQUUsQ0FBQyxDQUFD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ZSI6Ii4vc3JjL2JyZXdfZ2FtZS90YXJnZXRpbmcudHMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBCcmV3IGZyb20gXCIuLi9icmV3XCJcclxuXHJcbmVudW0gVGFyZ2V0aW5nRXJyb3Ige1xyXG4gICAgVGFyZ2V0Tm90Vmlld2FibGUgPSAxLFxyXG4gICAgVGFyZ2V0Tm90V2Fsa2FibGUsXHJcbiAgICBQYXRoQmxvY2tlZEJ5VGVycmFpbixcclxuICAgIFBhdGhCbG9ja2VkQnlNb2IsXHJcbiAgICBUYXJnZXRNb25zdGVyUmVxdWlyZWQsXHJcbiAgICBMZXNzVGhhbk1pbmltdW1EaXN0YW5jZSxcclxuICAgIE1vcmVUaGFuTWF4aW11bURpc3RhbmNlLFxyXG4gICAgTGFuZGluZ05vdFdhbGthYmxlLFxyXG4gICAgVGFyZ2V0Tm90V2l0aGluRmlyaW5nQXJjLFxyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIElUYXJnZXRpbmdSZXNwb25zZSB7XHJcbiAgICBpc192YWxpZDogYm9vbGVhblxyXG4gICAgcGF0aDogQXJyYXk8QnJldy5Db29yZGluYXRlPlxyXG4gICAgZXJyb3JfcmVhc29uPzogVGFyZ2V0aW5nRXJyb3JcclxuICAgIGFjdHVhbF94eT86IEJyZXcuQ29vcmRpbmF0ZVxyXG59XHJcblxyXG4vLy8vLy8vLy8vLy8vLy8vLy8vLyB0YXJnZXQgbG9jayBtYW5hZ2VtZW50XHJcblxyXG5pbnRlcmZhY2UgSVRhcmdldExvY2sgeyBcclxuICAgIGZyb206IG51bWJlcixcclxuICAgIHRvOiBudW1iZXJcclxufVxyXG5cclxubGV0IHRhcmdldExvY2tMaXN0IDogQXJyYXk8SVRhcmdldExvY2s+ID0gW11cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjbGVhclRhcmdldExvY2tzKCkge1xyXG4gICAgdGFyZ2V0TG9ja0xpc3QgPSBbXVxyXG59XHJcblxyXG5mdW5jdGlvbiBtYXRjaFRhcmdldExvY2soYXR0YWNrZXI6IEJyZXcuR3JpZFRoaW5ncy5Nb25zdGVyLCB0YXJnZXQ6IEJyZXcuR3JpZFRoaW5ncy5Nb25zdGVyLCBnaXZlbl90YXJnZXRsb2NrOiBJVGFyZ2V0TG9jaykgOiBib29sZWFuIHtcclxuICAgIHJldHVybiAoXHJcbiAgICAgICAgKGF0dGFja2VyLmdldElEKCkgPT0gZ2l2ZW5fdGFyZ2V0bG9jay5mcm9tKSAmJlxyXG4gICAgICAgICh0YXJnZXQuZ2V0SUQoKSA9PSBnaXZlbl90YXJnZXRsb2NrLnRvKVxyXG4gICAgKVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaGFzVGFyZ2V0TG9jayhhdHRhY2tlcjogQnJldy5HcmlkVGhpbmdzLk1vbnN0ZXIsIHRhcmdldDogQnJldy5HcmlkVGhpbmdzLk1vbnN0ZXIpIDogYm9vbGVhbiB7XHJcbiAgICBsZXQgYXR0YWNrZXJfaWQgPSBhdHRhY2tlci5nZXRJRCgpXHJcbiAgICBsZXQgdGFyZ2V0X2lkID0gdGFyZ2V0LmdldElEKClcclxuICAgIFxyXG4gICAgbGV0IGZvdW5kX2xpc3QgPSB0YXJnZXRMb2NrTGlzdC5maWx0ZXIoKHRhcmdldGxvY2spID0+IHtcclxuICAgICAgICByZXR1cm4gbWF0Y2hUYXJnZXRMb2NrKGF0dGFja2VyLCB0YXJnZXQsIHRhcmdldGxvY2spXHJcbiAgICB9KVxyXG5cclxuICAgIHJldHVybiBmb3VuZF9saXN0Lmxlbmd0aCA+IDBcclxufVxyXG5cclxuZnVuY3Rpb24gYWRkVGFyZ2V0TG9jayhhdHRhY2tlcjogQnJldy5HcmlkVGhpbmdzLk1vbnN0ZXIsIHRhcmdldDogQnJldy5HcmlkVGhpbmdzLk1vbnN0ZXIpIHtcclxuICAgIGlmIChoYXNUYXJnZXRMb2NrKGF0dGFja2VyLCB0YXJnZXQpKSB7XHJcbiAgICAgICAgLy8gbm8gbmVlZCB0byBhc2sgdHdpY2VcclxuICAgICAgICByZXR1cm5cclxuICAgIH1cclxuXHJcbiAgICBsZXQgbmV3X2xvY2sgOiBJVGFyZ2V0TG9jayA9IHtcclxuICAgICAgICBmcm9tOiBhdHRhY2tlci5nZXRJRCgpLFxyXG4gICAgICAgIHRvOiB0YXJnZXQuZ2V0SUQoKVxyXG4gICAgfVxyXG5cclxuICAgIHRhcmdldExvY2tMaXN0LnB1c2gobmV3X2xvY2spXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjbGVhclRhcmdldExvY2tzQnkoYXR0YWNrZXI6IEJyZXcuR3JpZFRoaW5ncy5Nb25zdGVyKSA6IG51bWJlcltdIHtcclxuICAgIGxldCBoYWRfbG9ja3Nfb24gOiBudW1iZXJbXSA9IFtdXHJcblxyXG4gICAgdGFyZ2V0TG9ja0xpc3QgPSB0YXJnZXRMb2NrTGlzdC5maWx0ZXIoKHRhcmdldGxvY2spID0+IHtcclxuICAgICAgICBpZiAodGFyZ2V0bG9jay5mcm9tID09IGF0dGFja2VyLmdldElEKCkpIHtcclxuICAgICAgICAgICAgaGFkX2xvY2tzX29uLnB1c2godGFyZ2V0bG9jay50bylcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICB9XHJcbiAgICB9KVxyXG5cclxuICAgIHJldHVybiBoYWRfbG9ja3Nfb25cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNsZWFyVGFyZ2V0TG9ja3NPbih0YXJnZXQ6IEJyZXcuR3JpZFRoaW5ncy5Nb25zdGVyKSA6IG51bWJlcltdIHtcclxuICAgIGxldCBoYWRfbG9ja3NfYnkgOiBudW1iZXJbXSA9IFtdXHJcblxyXG4gICAgdGFyZ2V0TG9ja0xpc3QgPSB0YXJnZXRMb2NrTGlzdC5maWx0ZXIoKHRhcmdldGxvY2spID0+IHtcclxuICAgICAgICBpZiAodGFyZ2V0bG9jay50byA9PSB0YXJnZXQuZ2V0SUQoKSkge1xyXG4gICAgICAgICAgICBoYWRfbG9ja3NfYnkucHVzaCh0YXJnZXRsb2NrLmZyb20pXHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgfVxyXG4gICAgfSlcclxuXHJcbiAgICByZXR1cm4gaGFkX2xvY2tzX2J5XHJcbn1cclxuXHJcbi8vIGV4cG9ydCBmdW5jdGlvbiBnZXRUYXJnZXRMb2Nrc09uKHRhcmdldDogQnJldy5HcmlkVGhpbmdzLk1vbnN0ZXIpIDogQXJyYXk8SVRhcmdldExvY2s+IHtcclxuLy8gICAgIC8vXHJcbi8vICAgICByZXR1cm4gdGFyZ2V0TG9ja0xpc3QuZmlsdGVyKCh0YXJnZXRsb2NrKSA9PiB7XHJcbi8vICAgICAgICAgcmV0dXJuIHRhcmdldGxvY2sudG8gPT0gdGFyZ2V0LmdldElEKClcclxuLy8gICAgIH0pXHJcbi8vIH1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBhcXVpcmVUYXJnZXRMb2NrRXZlbnQoZ206IEJyZXcuR2FtZU1hc3RlciwgYnJFdmVudDogQnJldy5FbnVtcy5JQnJld0V2ZW50KSB7XHJcbiAgICAvLyBzZW5kIGluIHdoYXQgd291bGQgb3RoZXJ3aXNlIGJlIGFuIGF0dGFjayBldmVudFxyXG4gICAgbGV0IHRhcmdldCA9IGJyRXZlbnQuYXR0YWNrRGF0YS50YXJnZXRcclxuICAgIGxldCBhdHRhY2tlciA9IGJyRXZlbnQuYWN0b3JcclxuXHJcbiAgICBhZGRUYXJnZXRMb2NrKGF0dGFja2VyLCB0YXJnZXQpXHJcblxyXG4gICAgLy8gY29uc29sZS5sb2coXCJ0YXJnZXQgbG9ja2VkXCIpXHJcbiAgICAvLyBmbGFzaCB3aGVuIGxvY2tpbmdcclxuICAgIGdtLmluc2VydEV2ZW50KHtcclxuICAgICAgICBldmVudFR5cGU6IEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5SdW5BbmltYXRpb24sXHJcbiAgICAgICAgYWN0b3I6IGJyRXZlbnQuYWN0b3IsXHJcbiAgICAgICAgZW5kc1R1cm46IGZhbHNlLFxyXG4gICAgICAgIHBsYXllckluaXRpYXRlZDogZmFsc2UsXHJcbiAgICAgICAgYW5pbWF0aW9uRGF0YToge1xyXG4gICAgICAgICAgICBhbmltYXRpb25UeXBlOiBCcmV3LkVudW1zLkJyZXdBbmltYXRpb25UeXBlLkZsYXNoLFxyXG4gICAgICAgICAgICBjb2xvcjogQnJldy5Db2xvci5vcmFuZ2UsXHJcbiAgICAgICAgICAgIGZyb21feHk6IGF0dGFja2VyLmxvY2F0aW9uLmNsb25lKCksXHJcbiAgICAgICAgICAgIHRvX3h5OiBhdHRhY2tlci5sb2NhdGlvbi5jbG9uZSgpLFxyXG4gICAgICAgIH1cclxuICAgIH0pXHJcbiAgICBnbS5lbmRFdmVudChickV2ZW50KVxyXG59XHJcblxyXG4vLy8vLy8vLy8vLy8vLy8vLy8vLyB0YXJnZXRpbmdcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB0YXJnZXRpbmdPbihnbTogQnJldy5HYW1lTWFzdGVyLCBkYXRhOiBCcmV3LkVudW1zLklCcmV3RXZlbnQpIHtcclxuICAgIFxyXG4gICAgLy8gc2V0IHVwIHRhcmdldGluZyBkYXRhIGRlcGVuZGluZyBvbiB0eXBlXHJcbiAgICBkYXRhLnRhcmdldGluZ0RhdGEgPSBCcmV3LlRhcmdldGluZy5nZXRUYXJnZXRpbmdEYXRhQnlUeXBlKGdtLCBkYXRhKVxyXG4gICAgXHJcbiAgICAvLyBndWVzcyBpbml0aWFsIHRhcmdldFxyXG4gICAgbGV0IGdvb2RfZ3Vlc3MgPSBmYWxzZVxyXG4gICAgbGV0IGd1ZXNzX21vYiA9IGdldENsb3Nlc3RUYXJnZXQoZ20sIGRhdGEuYWN0b3IpXHJcbiAgICBpZiAoZ3Vlc3NfbW9iKSB7XHJcbiAgICAgICAgZGF0YS50YXJnZXRpbmdEYXRhLnRvX3h5ID0gZ3Vlc3NfbW9iLmxvY2F0aW9uXHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gY2hlY2sgbmV3IHRhcmdldGluZyBhbmQgc2hvdyB0aGUgcmVzdWx0c1xyXG4gICAgICAgIGxldCByZXNwID0gQnJldy5UYXJnZXRpbmcuY2hlY2tUYXJnZXRpbmdQYXRoKGdtLCBkYXRhKVxyXG5cclxuICAgICAgICBpZiAocmVzcC5pc192YWxpZCkge1xyXG4gICAgICAgICAgICBzaG93VGFyZ2V0aW5nSGlnaGxpZ2h0cyhnbSwgZGF0YSwgcmVzcClcclxuICAgICAgICAgICAgZ29vZF9ndWVzcyA9IHRydWVcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIGlmIHdlIGRvbnQgaGF2ZSBhIGdvb2QgZ3Vlc3Mgb3IgcGF0aCBpcyBpbnZhbGlkIHRoZW4gc3RhcnQgZnJvbSBzY3JhdGNoXHJcbiAgICBpZiAoIShnb29kX2d1ZXNzKSkge1xyXG4gICAgICAgIGxldCB0Z3RIaWdobGlnaHQgPSBCcmV3LkRlZmluaXRpb25zLnRlcnJhaW5GYWN0b3J5KEJyZXcuRGVmaW5pdGlvbnMuVGVycmFpblR5cGUuSGlnaGxpZ2h0KVxyXG4gICAgICAgIHRndEhpZ2hsaWdodC5jb2xvciA9IEJyZXcuQ29sb3IudGFyZ2V0X2N1cnNvclxyXG4gICAgICAgIFxyXG4gICAgICAgIGdtLmRpc3BsYXkuaGlnaGxpZ2h0cy5zZXRBdChnbS5nZXRQbGF5ZXIoKS5sb2NhdGlvbiwgdGd0SGlnaGxpZ2h0KVxyXG4gICAgICAgIGdtLmRpc3BsYXlBdChnbS5nZXRQbGF5ZXIoKS5sb2NhdGlvbilcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gZXhhbWluZSBpcyBhIHNwZWNpYWwgY2FzZVxyXG4gICAgaWYgKGRhdGEudGFyZ2V0aW5nRGF0YS5hY3Rpb24gPT0gQnJldy5FbnVtcy5CcmV3VGFyZ2V0aW5nQWN0aW9uLkV4YW1pbmUpIHtcclxuICAgICAgICBnbS5kaXNwbGF5LnVwZGF0ZURlc2NyaXB0aW9uRm9vdGVyRm9yUG9pbnQoZGF0YS50YXJnZXRpbmdEYXRhLnRvX3h5KVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBnbS5pbnB1dF9oYW5kbGVyID0gQnJldy5FbnVtcy5JbnB1dEhhbmRsZXIuVGFyZ2V0aW5nXHJcbiAgICBcclxuICAgIGdtLmVuZEV2ZW50KGRhdGEpXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB0YXJnZXRpbmdDYW5jZWwoZ206IEJyZXcuR2FtZU1hc3RlciwgZGF0YTogQnJldy5FbnVtcy5JQnJld0V2ZW50KSB7XHJcbiAgICBjb25zb2xlLmxvZyhcImNhbmNlbGxpbmcgdGFyZ2V0aW5nXCIpXHJcbiAgICBjbGVhclRhcmdldGluZ0hpZ2hsaWdodHMoZ20pXHJcbiAgICBnbS5kaXNwbGF5LmRyYXdGb290ZXIoKVxyXG4gICAgZ20uaW5wdXRfaGFuZGxlciA9IEJyZXcuRW51bXMuSW5wdXRIYW5kbGVyLk1haW5cclxuICAgIGdtLmVuZEV2ZW50KGRhdGEpXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB0YXJnZXRpbmdGaW5pc2goZ206IEJyZXcuR2FtZU1hc3RlciwgZGF0YTogQnJldy5FbnVtcy5JQnJld0V2ZW50KSB7XHJcbiAgICBcclxuICAgIC8vIG1ha2Ugc3VyZSB3ZSBkaWRuJ3QgZXJyb3Igb3V0IGZpcnN0XHJcbiAgICBsZXQgcmVzcCA9IEJyZXcuVGFyZ2V0aW5nLmNoZWNrVGFyZ2V0aW5nUGF0aChnbSwgZGF0YSlcclxuICAgIGlmICghKHJlc3AuaXNfdmFsaWQpKSB7XHJcbiAgICAgICAgdGFyZ2V0aW5nQ2FuY2VsKGdtLCBkYXRhKVxyXG4gICAgICAgIHJldHVyblxyXG4gICAgfVxyXG5cclxuICAgIC8vIGNvbnNvbGUubG9nKFwidGFyZ2V0IGdvdHRlbjogXCIsIGRhdGEudGFyZ2V0aW5nRGF0YS5hY3Rpb24pXHJcbiAgICBjbGVhclRhcmdldGluZ0hpZ2hsaWdodHMoZ20pXHJcbiAgICBnbS5pbnB1dF9oYW5kbGVyID0gQnJldy5FbnVtcy5JbnB1dEhhbmRsZXIuTWFpblxyXG5cclxuICAgIGdtLmNvcHlFdmVudERhdGFGcm9tTGFzdEV2ZW50KGRhdGEpXHJcbiAgICBkYXRhLnRhcmdldGluZ0RhdGEucGF0aCA9IHJlc3AucGF0aFxyXG5cclxuICAgIGxldCBuZXh0RXZlbnRBZnRlclRhcmdldGluZyA6IEJyZXcuRW51bXMuSUJyZXdFdmVudDtcclxuICAgIFxyXG4gICAgaWYgKGRhdGEudGFyZ2V0aW5nRGF0YS5hY3Rpb24gPT0gQnJldy5FbnVtcy5CcmV3VGFyZ2V0aW5nQWN0aW9uLlRocm93SXRlbSkge1xyXG4gICAgICAgIG5leHRFdmVudEFmdGVyVGFyZ2V0aW5nID0ge1xyXG4gICAgICAgICAgICAvLyB0b2RvOiBjaGFuZ2UgdGhpcyB0byBzb21lIGtpbmQgb2YgJ2xhbmRpbmcnIGV2ZW50XHJcbiAgICAgICAgICAgIGV2ZW50VHlwZTogQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLkxhbmQsXHJcbiAgICAgICAgICAgIGFjdG9yOiBkYXRhLmFjdG9yLFxyXG4gICAgICAgICAgICBwbGF5ZXJJbml0aWF0ZWQ6IHRydWUsXHJcbiAgICAgICAgICAgIGVuZHNUdXJuOiB0cnVlLFxyXG4gICAgICAgICAgICBpdGVtRGF0YToge1xyXG4gICAgICAgICAgICAgICAgaXRlbTogZGF0YS5pdGVtRGF0YS5pdGVtLFxyXG4gICAgICAgICAgICAgICAgaW52a2V5OiBkYXRhLml0ZW1EYXRhLmludmtleSxcclxuICAgICAgICAgICAgICAgIHRvX3h5OiBkYXRhLnRhcmdldGluZ0RhdGEudG9feHkuY2xvbmUoKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgYW5pbWF0aW9uRXZlbnQgOiBCcmV3LkVudW1zLklCcmV3RXZlbnQgPSB7XHJcbiAgICAgICAgICAgIGV2ZW50VHlwZTogQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLlJ1bkFuaW1hdGlvbixcclxuICAgICAgICAgICAgYWN0b3I6IGRhdGEuYWN0b3IsXHJcbiAgICAgICAgICAgIHBsYXllckluaXRpYXRlZDogdHJ1ZSxcclxuICAgICAgICAgICAgZW5kc1R1cm46IGZhbHNlLC8vVE9ETzogbWF5YmUgdGhpcyBicmVha3Mgc29lbXRoaW5nP1xyXG4gICAgICAgICAgICBhbmltYXRpb25EYXRhOiB7XHJcbiAgICAgICAgICAgICAgICBhbmltYXRpb25UeXBlOiBCcmV3LkVudW1zLkJyZXdBbmltYXRpb25UeXBlLk92ZXJQYXRoLFxyXG4gICAgICAgICAgICAgICAgY29kZTogZGF0YS5pdGVtRGF0YS5pdGVtLmNvZGUsXHJcbiAgICAgICAgICAgICAgICBjb2xvcjogZGF0YS5pdGVtRGF0YS5pdGVtLmNvbG9yLFxyXG4gICAgICAgICAgICAgICAgZnJvbV94eTogZGF0YS5hY3Rvci5sb2NhdGlvbi5jbG9uZSgpLFxyXG4gICAgICAgICAgICAgICAgdG9feHk6IGRhdGEudGFyZ2V0aW5nRGF0YS50b194eS5jbG9uZSgpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGdtLmluc2VydEV2ZW50KGFuaW1hdGlvbkV2ZW50KVxyXG5cclxuICAgIH0gZWxzZSBpZiAoZGF0YS50YXJnZXRpbmdEYXRhLmFjdGlvbiA9PSBCcmV3LkVudW1zLkJyZXdUYXJnZXRpbmdBY3Rpb24uSGVhdmVJdGVtKSB7XHJcbiAgICAgICAgbmV4dEV2ZW50QWZ0ZXJUYXJnZXRpbmcgPSB7XHJcbiAgICAgICAgICAgIC8vIHRvZG86IGNoYW5nZSB0aGlzIHRvIHNvbWUga2luZCBvZiAnbGFuZGluZycgZXZlbnRcclxuICAgICAgICAgICAgZXZlbnRUeXBlOiBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuSGVhdmUsXHJcbiAgICAgICAgICAgIGFjdG9yOiBkYXRhLmFjdG9yLFxyXG4gICAgICAgICAgICBwbGF5ZXJJbml0aWF0ZWQ6IHRydWUsXHJcbiAgICAgICAgICAgIGVuZHNUdXJuOiB0cnVlLFxyXG4gICAgICAgICAgICBpdGVtRGF0YToge1xyXG4gICAgICAgICAgICAgICAgaXRlbTogZGF0YS5pdGVtRGF0YS5pdGVtLFxyXG4gICAgICAgICAgICAgICAgLy8gaW52a2V5OiBkYXRhLml0ZW1EYXRhLmludmtleSxcclxuICAgICAgICAgICAgICAgIHRvX3h5OiBkYXRhLnRhcmdldGluZ0RhdGEudG9feHkuY2xvbmUoKSxcclxuICAgICAgICAgICAgICAgIC8vIGZyb21feHk6IGRhdGEudGFyZ2V0aW5nRGF0YS5mcm9tX3h5LmNsb25lKCksXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCBhbmltYXRpb25FdmVudCA6IEJyZXcuRW51bXMuSUJyZXdFdmVudCA9IHtcclxuICAgICAgICAgICAgZXZlbnRUeXBlOiBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuUnVuQW5pbWF0aW9uLFxyXG4gICAgICAgICAgICBhY3RvcjogZGF0YS5hY3RvcixcclxuICAgICAgICAgICAgcGxheWVySW5pdGlhdGVkOiB0cnVlLFxyXG4gICAgICAgICAgICBlbmRzVHVybjogZmFsc2UsLy9UT0RPOiBtYXliZSB0aGlzIGJyZWFrcyBzb2VtdGhpbmc/XHJcbiAgICAgICAgICAgIGFuaW1hdGlvbkRhdGE6IHtcclxuICAgICAgICAgICAgICAgIGFuaW1hdGlvblR5cGU6IEJyZXcuRW51bXMuQnJld0FuaW1hdGlvblR5cGUuT3ZlclBhdGgsXHJcbiAgICAgICAgICAgICAgICBjb2RlOiBkYXRhLml0ZW1EYXRhLml0ZW0uY29kZSxcclxuICAgICAgICAgICAgICAgIGNvbG9yOiBkYXRhLml0ZW1EYXRhLml0ZW0uY29sb3IsXHJcbiAgICAgICAgICAgICAgICBmcm9tX3h5OiBkYXRhLmFjdG9yLmxvY2F0aW9uLmNsb25lKCksXHJcbiAgICAgICAgICAgICAgICB0b194eTogZGF0YS50YXJnZXRpbmdEYXRhLnRvX3h5LmNsb25lKClcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9XHJcbiAgICAgICAgZ20uaW5zZXJ0RXZlbnQoYW5pbWF0aW9uRXZlbnQpXHJcblxyXG4gICAgfSBlbHNlIGlmIChkYXRhLnRhcmdldGluZ0RhdGEuYWN0aW9uID09IEJyZXcuRW51bXMuQnJld1RhcmdldGluZ0FjdGlvbi5UaHJvd0hlYXZ5QXhlKSB7XHJcbiAgICAgICAgbmV4dEV2ZW50QWZ0ZXJUYXJnZXRpbmcgPSB7XHJcbiAgICAgICAgICAgIGV2ZW50VHlwZTogQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLkhlYXZ5QXhlVGhyb3csXHJcbiAgICAgICAgICAgIGFjdG9yOiBkYXRhLmFjdG9yLFxyXG4gICAgICAgICAgICBwbGF5ZXJJbml0aWF0ZWQ6IHRydWUsXHJcbiAgICAgICAgICAgIGVuZHNUdXJuOiB0cnVlLFxyXG4gICAgICAgICAgICBwYXRoc0RhdGE6IHtcclxuICAgICAgICAgICAgICAgIGZyb21feHk6IGRhdGEudGFyZ2V0aW5nRGF0YS5mcm9tX3h5LmNsb25lKCksXHJcbiAgICAgICAgICAgICAgICB0b194eTogZGF0YS50YXJnZXRpbmdEYXRhLnRvX3h5LmNsb25lKCksXHJcbiAgICAgICAgICAgICAgICBwYXRoOiBkYXRhLnRhcmdldGluZ0RhdGEucGF0aFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBwb3dlckRhdGE6IHsuLi5kYXRhLnBvd2VyRGF0YX1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCBhbmltYXRpb25FdmVudCA6IEJyZXcuRW51bXMuSUJyZXdFdmVudCA9IHtcclxuICAgICAgICAgICAgZXZlbnRUeXBlOiBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuUnVuQW5pbWF0aW9uLFxyXG4gICAgICAgICAgICBhY3RvcjogZGF0YS5hY3RvcixcclxuICAgICAgICAgICAgcGxheWVySW5pdGlhdGVkOiB0cnVlLFxyXG4gICAgICAgICAgICBlbmRzVHVybjogZmFsc2UsLy9UT0RPOiBtYXliZSB0aGlzIGJyZWFrcyBzb2VtdGhpbmc/XHJcbiAgICAgICAgICAgIGFuaW1hdGlvbkRhdGE6IHtcclxuICAgICAgICAgICAgICAgIGFuaW1hdGlvblR5cGU6IEJyZXcuRW51bXMuQnJld0FuaW1hdGlvblR5cGUuT3ZlclBhdGgsXHJcbiAgICAgICAgICAgICAgICBjb2RlOiBkYXRhLnBvd2VyRGF0YS5wb3dlci5hc3NvY2lhdGVkX2l0ZW0uY29kZSwgLy90b2RvOiBuZWVkIGEgYmV0dGVyIGNvZGUgZm9yIHRoZSBheGVcclxuICAgICAgICAgICAgICAgIGNvbG9yOiBCcmV3LkNvbG9yLnBvd2VyX2F4ZSxcclxuICAgICAgICAgICAgICAgIGZyb21feHk6IGRhdGEuYWN0b3IubG9jYXRpb24uY2xvbmUoKSxcclxuICAgICAgICAgICAgICAgIHRvX3h5OiBkYXRhLnRhcmdldGluZ0RhdGEudG9feHkuY2xvbmUoKVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH1cclxuICAgICAgICBnbS5pbnNlcnRFdmVudChhbmltYXRpb25FdmVudClcclxuXHJcbiAgICB9IGVsc2UgaWYgKGRhdGEudGFyZ2V0aW5nRGF0YS5hY3Rpb24gPT0gQnJldy5FbnVtcy5CcmV3VGFyZ2V0aW5nQWN0aW9uLkhhY2spIHtcclxuICAgICAgICBuZXh0RXZlbnRBZnRlclRhcmdldGluZyA9IHtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV2ZW50VHlwZTogQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLkhhY2ssXHJcbiAgICAgICAgICAgIGFjdG9yOiBkYXRhLmFjdG9yLFxyXG4gICAgICAgICAgICBwbGF5ZXJJbml0aWF0ZWQ6IHRydWUsXHJcbiAgICAgICAgICAgIGVuZHNUdXJuOiB0cnVlLFxyXG4gICAgICAgICAgICBwb3dlckRhdGE6IGRhdGEucG93ZXJEYXRhLFxyXG4gICAgICAgICAgICBtb3ZlRGF0YToge1xyXG4gICAgICAgICAgICAgICAgdG9feHk6IGRhdGEudGFyZ2V0aW5nRGF0YS50b194eS5jbG9uZSgpLFxyXG4gICAgICAgICAgICAgICAgZnJvbV94eTogZGF0YS50YXJnZXRpbmdEYXRhLmZyb21feHkuY2xvbmUoKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH0gZWxzZSBpZiAoZGF0YS50YXJnZXRpbmdEYXRhLmFjdGlvbiA9PSBCcmV3LkVudW1zLkJyZXdUYXJnZXRpbmdBY3Rpb24uUm9ja2V0UHVuY2gpIHtcclxuICAgICAgICBuZXh0RXZlbnRBZnRlclRhcmdldGluZyA9IHtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGV2ZW50VHlwZTogQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLlJvY2tldFB1bmNoLFxyXG4gICAgICAgICAgICBhY3RvcjogZGF0YS5hY3RvcixcclxuICAgICAgICAgICAgcGxheWVySW5pdGlhdGVkOiB0cnVlLFxyXG4gICAgICAgICAgICBlbmRzVHVybjogdHJ1ZSxcclxuICAgICAgICAgICAgcG93ZXJEYXRhOiBkYXRhLnBvd2VyRGF0YSxcclxuICAgICAgICAgICAgbW92ZURhdGE6IHtcclxuICAgICAgICAgICAgICAgIHRvX3h5OiBkYXRhLnRhcmdldGluZ0RhdGEudG9feHkuY2xvbmUoKSxcclxuICAgICAgICAgICAgICAgIGZyb21feHk6IGRhdGEudGFyZ2V0aW5nRGF0YS5mcm9tX3h5LmNsb25lKClcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgdGFyZ2V0aW5nRGF0YTogey4uLmRhdGEudGFyZ2V0aW5nRGF0YX1cclxuICAgICAgICB9XHJcbiAgICBcclxuICAgIH0gZWxzZSBpZiAoZGF0YS50YXJnZXRpbmdEYXRhLmFjdGlvbiA9PSBCcmV3LkVudW1zLkJyZXdUYXJnZXRpbmdBY3Rpb24uRXhhbWluZSkge1xyXG5cclxuICAgICAgICBuZXh0RXZlbnRBZnRlclRhcmdldGluZyA9IHtcclxuICAgICAgICAgICAgZXZlbnRUeXBlOiBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuSW5mbyxcclxuICAgICAgICAgICAgYWN0b3I6IGRhdGEuYWN0b3IsXHJcbiAgICAgICAgICAgIHBsYXllckluaXRpYXRlZDogdHJ1ZSxcclxuICAgICAgICAgICAgZW5kc1R1cm46IGZhbHNlLFxyXG4gICAgICAgICAgICBtb3ZlRGF0YToge1xyXG4gICAgICAgICAgICAgICAgZnJvbV94eTogZGF0YS50YXJnZXRpbmdEYXRhLmZyb21feHksXHJcbiAgICAgICAgICAgICAgICB0b194eTogZGF0YS50YXJnZXRpbmdEYXRhLnRvX3h5XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgfSBlbHNlIGlmIChkYXRhLnRhcmdldGluZ0RhdGEuYWN0aW9uID09IEJyZXcuRW51bXMuQnJld1RhcmdldGluZ0FjdGlvbi5EZWJ1Z1N1bW1vbk1vYikge1xyXG5cclxuICAgICAgICBuZXh0RXZlbnRBZnRlclRhcmdldGluZyA9IHtcclxuICAgICAgICAgICAgZXZlbnRUeXBlOiBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuRGVidWdDcmVhdGVNb2JBdCxcclxuICAgICAgICAgICAgYWN0b3I6IGRhdGEuYWN0b3IsXHJcbiAgICAgICAgICAgIHBsYXllckluaXRpYXRlZDogdHJ1ZSxcclxuICAgICAgICAgICAgZW5kc1R1cm46IGZhbHNlLFxyXG4gICAgICAgICAgICBtb3ZlRGF0YToge1xyXG4gICAgICAgICAgICAgICAgZnJvbV94eTogZGF0YS50YXJnZXRpbmdEYXRhLmZyb21feHksXHJcbiAgICAgICAgICAgICAgICB0b194eTogZGF0YS50YXJnZXRpbmdEYXRhLnRvX3h5XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGRlYnVnTWVudURhdGE6IHsuLi5kYXRhLmRlYnVnTWVudURhdGF9XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH0gZWxzZSBpZiAoZGF0YS50YXJnZXRpbmdEYXRhLmFjdGlvbiA9PSBCcmV3LkVudW1zLkJyZXdUYXJnZXRpbmdBY3Rpb24uRGVidWdNYWtlRmVhdHVyZSkge1xyXG5cclxuICAgICAgICBuZXh0RXZlbnRBZnRlclRhcmdldGluZyA9IHtcclxuICAgICAgICAgICAgZXZlbnRUeXBlOiBCcmV3LkVudW1zLkJyZXdFdmVudFR5cGUuRGVidWdDcmVhdGVGZWF0dXJlQXQsXHJcbiAgICAgICAgICAgIGFjdG9yOiBkYXRhLmFjdG9yLFxyXG4gICAgICAgICAgICBwbGF5ZXJJbml0aWF0ZWQ6IHRydWUsXHJcbiAgICAgICAgICAgIGVuZHNUdXJuOiBmYWxzZSxcclxuICAgICAgICAgICAgbW92ZURhdGE6IHtcclxuICAgICAgICAgICAgICAgIGZyb21feHk6IGRhdGEudGFyZ2V0aW5nRGF0YS5mcm9tX3h5LFxyXG4gICAgICAgICAgICAgICAgdG9feHk6IGRhdGEudGFyZ2V0aW5nRGF0YS50b194eVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBkZWJ1Z01lbnVEYXRhOiB7Li4uZGF0YS5kZWJ1Z01lbnVEYXRhfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICB9IGVsc2UgaWYgKGRhdGEudGFyZ2V0aW5nRGF0YS5hY3Rpb24gPT0gQnJldy5FbnVtcy5CcmV3VGFyZ2V0aW5nQWN0aW9uLkRlYnVnTWFrZVRlcnJhaW4pIHtcclxuXHJcbiAgICAgICAgbmV4dEV2ZW50QWZ0ZXJUYXJnZXRpbmcgPSB7XHJcbiAgICAgICAgICAgIGV2ZW50VHlwZTogQnJldy5FbnVtcy5CcmV3RXZlbnRUeXBlLkRlYnVnQ3JlYXRlVGVycmFpbkF0LFxyXG4gICAgICAgICAgICBhY3RvcjogZGF0YS5hY3RvcixcclxuICAgICAgICAgICAgcGxheWVySW5pdGlhdGVkOiB0cnVlLFxyXG4gICAgICAgICAgICBlbmRzVHVybjogZmFsc2UsXHJcbiAgICAgICAgICAgIG1vdmVEYXRhOiB7XHJcbiAgICAgICAgICAgICAgICBmcm9tX3h5OiBkYXRhLnRhcmdldGluZ0RhdGEuZnJvbV94eSxcclxuICAgICAgICAgICAgICAgIHRvX3h5OiBkYXRhLnRhcmdldGluZ0RhdGEudG9feHlcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgZGVidWdNZW51RGF0YTogey4uLmRhdGEuZGVidWdNZW51RGF0YX1cclxuICAgICAgICB9XHJcblxyXG4gICAgfSBlbHNlIGlmIChkYXRhLnRhcmdldGluZ0RhdGEuYWN0aW9uID09IEJyZXcuRW51bXMuQnJld1RhcmdldGluZ0FjdGlvbi5SYW5nZWRBdHRhY2spIHtcclxuICAgICAgICBsZXQgYXR0YWNrX3RhcmdldCA9IGdtLmdldEN1cnJlbnRMZXZlbCgpLm1vbnN0ZXJzLmdldEF0KGRhdGEudGFyZ2V0aW5nRGF0YS50b194eSlcclxuXHJcbiAgICAgICAgbmV4dEV2ZW50QWZ0ZXJUYXJnZXRpbmcgPSB7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBldmVudFR5cGU6IEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5BdHRhY2ssXHJcbiAgICAgICAgICAgIGFjdG9yOiBkYXRhLmFjdG9yLFxyXG4gICAgICAgICAgICBwbGF5ZXJJbml0aWF0ZWQ6IHRydWUsXHJcbiAgICAgICAgICAgIGVuZHNUdXJuOiB0cnVlLFxyXG4gICAgICAgICAgICBwb3dlckRhdGE6IGRhdGEucG93ZXJEYXRhLFxyXG4gICAgICAgICAgICBhdHRhY2tEYXRhOiB7XHJcbiAgICAgICAgICAgICAgICBmcm9tX3h5OiBkYXRhLnRhcmdldGluZ0RhdGEuZnJvbV94eSxcclxuICAgICAgICAgICAgICAgIHRvX3h5OiBkYXRhLnRhcmdldGluZ0RhdGEudG9feHksXHJcbiAgICAgICAgICAgICAgICB0YXJnZXQ6IGF0dGFja190YXJnZXQsXHJcbiAgICAgICAgICAgICAgICBpc01lbGVlOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgIGRhbWFnZTogZGF0YS5wb3dlckRhdGEucG93ZXIuYXNzb2NpYXRlZF9pdGVtLmRhbWFnZSxcclxuICAgICAgICAgICAgICAgIGVmZmVjdHM6IEJyZXcuQ29tYmF0LmZpbHRlckRhbWFnZUVmZmVjdHMoZGF0YS5wb3dlckRhdGEucG93ZXIuYXNzb2NpYXRlZF9pdGVtLmZsYWdzKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGB1bmtub3duIG9yIHVuaGFuZGxlZCB0eXBlIG9mIHRhcmdldGluZyBhY3Rpb24gJHtkYXRhLnRhcmdldGluZ0RhdGEuYWN0aW9ufWApXHJcbiAgICB9XHJcblxyXG4gICAgZ20uaW5zZXJ0RXZlbnRfTmV4dChuZXh0RXZlbnRBZnRlclRhcmdldGluZylcclxuICAgIGdtLmVuZEV2ZW50KGRhdGEpICAgICAgICAgXHJcbn0gICAgXHJcblxyXG5leHBvcnQgZnVuY3Rpb24gc2hvd1RhcmdldGluZ0hpZ2hsaWdodHMoZ206IEJyZXcuR2FtZU1hc3RlciwgZGF0YTogQnJldy5FbnVtcy5JQnJld0V2ZW50LCB0YXJnZXRpbmdSZXNwb25zZSA6IElUYXJnZXRpbmdSZXNwb25zZSkge1xyXG4gICAgXHJcbiAgICAvLyBjbGVhciB0aGUgb2xkIGhpZ2hsaWdodHNcclxuICAgIGNsZWFyVGFyZ2V0aW5nSGlnaGxpZ2h0cyhnbSlcclxuICAgIFxyXG4gICAgLy8gc2V0dXAgb3VyIGhpZ2hsaWdodCBjb2xvcnNcclxuICAgIGxldCB0SGlnaGxpZ2h0ID0gQnJldy5EZWZpbml0aW9ucy50ZXJyYWluRmFjdG9yeShCcmV3LkRlZmluaXRpb25zLlRlcnJhaW5UeXBlLkhpZ2hsaWdodClcclxuICAgIHRIaWdobGlnaHQuY29sb3IgPSBCcmV3LkNvbG9yLnRhcmdldF9wYXRoXHJcbiAgICBsZXQgdEN1cnNvciA9IEJyZXcuRGVmaW5pdGlvbnMudGVycmFpbkZhY3RvcnkoQnJldy5EZWZpbml0aW9ucy5UZXJyYWluVHlwZS5IaWdobGlnaHQpXHJcbiAgICBcclxuICAgIC8vIHNldCBoaWdobGlnaHRzIGFjcm9zcyB0aGUgcGF0aCBhbmQgc2hvdyB0aGVtXHJcbiAgICB0YXJnZXRpbmdSZXNwb25zZS5wYXRoLmZvckVhY2goKHh5OiBCcmV3LkNvb3JkaW5hdGUsIGluZGV4LCBhcnJheSkgPT4ge1xyXG4gICAgICAgIGdtLmRpc3BsYXkuaGlnaGxpZ2h0cy5zZXRBdCh4eSwgdEhpZ2hsaWdodClcclxuICAgIH0pXHJcbiAgICBcclxuICAgIC8vIGNoYW5nZSBjdXJzb3IgY29sb3IgZGVwZW5kaW5nIG9uIHRoZSBvdXRjb21lXHJcbiAgICBpZiAodGFyZ2V0aW5nUmVzcG9uc2UuaXNfdmFsaWQpIHtcclxuICAgICAgICB0Q3Vyc29yLmNvbG9yID0gQnJldy5Db2xvci50YXJnZXRfY3Vyc29yXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRDdXJzb3IuY29sb3IgPSBCcmV3LkNvbG9yLnRhcmdldF9lcnJvclxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBzZXQgdGhlIGN1cnNvciBieSBpdHNlbGZcclxuICAgIGdtLmRpc3BsYXkuaGlnaGxpZ2h0cy5yZW1vdmVBdChkYXRhLnRhcmdldGluZ0RhdGEudG9feHkpXHJcbiAgICBnbS5kaXNwbGF5LmhpZ2hsaWdodHMuc2V0QXQoZGF0YS50YXJnZXRpbmdEYXRhLnRvX3h5LCB0Q3Vyc29yKVxyXG4gICAgXHJcbiAgICAvLyB0ZWxsIHRoZSBkaXNwbGF5IHRvIHJlZHJhdyBhbGwgdGhlc2UgbmV3IGhpZ2hsaWdodGVkIHNxdWFyZXNcclxuICAgIGdtLmRpc3BsYXlMaXN0KHRhcmdldGluZ1Jlc3BvbnNlLnBhdGguY29uY2F0KGRhdGEudGFyZ2V0aW5nRGF0YS50b194eSkpXHJcbiAgICAvLyBnbS5kaXNwbGF5QXQoZGF0YS50YXJnZXRpbmdEYXRhLnRvX3h5KVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY2xlYXJUYXJnZXRpbmdIaWdobGlnaHRzKGdtOiBCcmV3LkdhbWVNYXN0ZXIpIHtcclxuICAgIC8vIGFjdHVhbGx5IGp1c3QgY2xlYXIgYWxsIGhpZ2hsaWdodHNcclxuICAgIGxldCBjb3B5TGlzdCA9IGdtLmRpc3BsYXkuaGlnaGxpZ2h0cy5nZXRBbGxDb29yZGluYXRlcygpIFxyXG4gICAgY29weUxpc3QuZm9yRWFjaCgodmFsdWUsIGluZGV4LCBhcnJheSkgPT4ge1xyXG4gICAgICAgIGdtLmRpc3BsYXkuaGlnaGxpZ2h0cy5yZW1vdmVBdCh2YWx1ZSlcclxuICAgIH0pXHJcbiAgICBnbS5kaXNwbGF5TGlzdChjb3B5TGlzdClcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHRhcmdldGluZ01vdmUoZ206IEJyZXcuR2FtZU1hc3RlciwgZGF0YTogQnJldy5FbnVtcy5JQnJld0V2ZW50KSB7XHJcbiAgICAvLyBtb2RpZnkgZXZlbnQsIHNvIHdlIGNhbiBncmFiIGxhc3QgZXZlbnQgbmV4dCB0aW1lLi4ga2VlcCB1cGRhdGluZyB0YXJnZXQgbG9jYXRpb24gYXMgd2UgbW92ZVxyXG4gICAgXHJcbiAgICAvLyBtb3ZlIHRhcmdldFxyXG4gICAgbGV0IG9mZnNldF94eSA9IGRhdGEub2Zmc2V0RGF0YS5vZmZzZXRfeHkgXHJcbiAgICBsZXQgY3VycmVudF90YXJnZXRfeHkgPSBkYXRhLnRhcmdldGluZ0RhdGEudG9feHlcclxuICAgIGxldCBuZXdfdGFyZ2V0X3h5ID0gY3VycmVudF90YXJnZXRfeHkuYWRkKG9mZnNldF94eSlcclxuXHJcbiAgICAvLyB0d3A6IGNvcHkgZXZlbnQgZGF0YSBmcm9tIGxhc3QgZXZlbnQsIHNvIHdlIGtlZXAgdHJhY2sgb2Ygb3VyIGl0ZW0vdGFyZ2V0IHRoaW5nL2V0Y1xyXG4gICAgLy8gbGV0IGxhc3RFdmVudERhdGEgPSBnbS5nZXRMYXN0RXZlbnQoKS5pdGVtRGF0YVxyXG4gICAgLy8gZGF0YS5pdGVtRGF0YSA9IHsuLi5sYXN0RXZlbnREYXRhfVxyXG4gICAgZ20uY29weUV2ZW50RGF0YUZyb21MYXN0RXZlbnQoZGF0YSlcclxuICAgIFxyXG4gICAgLy8gc2V0IG5ldyB0YXJnZXRcclxuICAgIGRhdGEudGFyZ2V0aW5nRGF0YS50b194eSA9IG5ld190YXJnZXRfeHlcclxuICAgIFxyXG4gICAgLy8gY2hlY2sgbmV3IHRhcmdldGluZyBhbmQgc2hvdyB0aGUgcmVzdWx0c1xyXG4gICAgbGV0IHJlc3AgPSBCcmV3LlRhcmdldGluZy5jaGVja1RhcmdldGluZ1BhdGgoZ20sIGRhdGEpXHJcbiAgICBzaG93VGFyZ2V0aW5nSGlnaGxpZ2h0cyhnbSwgZGF0YSwgcmVzcClcclxuICAgIFxyXG4gICAgLy8gZXhhbWluZSBpcyBhIHNwZWNpYWwgY2FzZSAtIGFwcGx5IHRoaXMgY29kZSBhcyB3ZSBnb1xyXG4gICAgaWYgKGRhdGEudGFyZ2V0aW5nRGF0YS5hY3Rpb24gPT0gQnJldy5FbnVtcy5CcmV3VGFyZ2V0aW5nQWN0aW9uLkV4YW1pbmUpIHtcclxuICAgICAgICBnbS5kaXNwbGF5LnVwZGF0ZURlc2NyaXB0aW9uRm9vdGVyRm9yUG9pbnQoZGF0YS50YXJnZXRpbmdEYXRhLnRvX3h5KVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBnbS5lbmRFdmVudChkYXRhKVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY2hlY2tUYXJnZXRpbmdQYXRoKGdtOiBCcmV3LkdhbWVNYXN0ZXIsIGRhdGE6IEJyZXcuRW51bXMuSUJyZXdFdmVudCkgOiBJVGFyZ2V0aW5nUmVzcG9uc2Uge1xyXG4gICAgXHJcbiAgICBsZXQgbGV2ZWwgPSBnbS5nZXRDdXJyZW50TGV2ZWwoKVxyXG4gICAgbGV0IHRhcmdldF94eSA6IEJyZXcuQ29vcmRpbmF0ZSA9IGRhdGEudGFyZ2V0aW5nRGF0YS50b194eVxyXG4gICAgbGV0IGluX2ZvdiA6IGJvb2xlYW4gPSBkYXRhLmFjdG9yLmZvdi5oYXNBdCh0YXJnZXRfeHkpIC8vZGF0YS5hY3Rvci5pbkZPVih0KVxyXG5cclxuICAgIC8vIGluaXRpYWwgcmVzcG9uc2VcclxuICAgIGxldCByZXNwb25zZSA6IElUYXJnZXRpbmdSZXNwb25zZSA9IHtcclxuICAgICAgICBpc192YWxpZDogZmFsc2UsXHJcbiAgICAgICAgcGF0aDogW11cclxuICAgIH1cclxuXHJcbiAgICAvLyBjaGVjayB0YXJnZXQgZmlyc3QsIGVhc2llciB0aGFuIGNoZWNraW5nIHRoZSBlbnRpcmUgcGF0aFxyXG4gICAgaWYgKCghaW5fZm92KSAmJiAgZGF0YS50YXJnZXRpbmdEYXRhLmRlc3RpbmF0aW9uTXVzdEJlVmlzaWJsZSkge1xyXG4gICAgICAgIHJlc3BvbnNlLmVycm9yX3JlYXNvbiA9IFRhcmdldGluZ0Vycm9yLlRhcmdldE5vdFZpZXdhYmxlXHJcbiAgICAgICAgcmV0dXJuIHJlc3BvbnNlXHJcbiAgICB9XHJcblxyXG4gICAgbGV0IHRlcnJhaW5fYXQgPSBsZXZlbC50ZXJyYWluLmdldEF0KHRhcmdldF94eSlcclxuICAgIGlmICh0ZXJyYWluX2F0LmJsb2Nrc193YWxraW5nICYmIGRhdGEudGFyZ2V0aW5nRGF0YS5kZXN0aW5hdGlvbk11c3RCZVdhbGthYmxlKSB7XHJcbiAgICAgICAgcmVzcG9uc2UuZXJyb3JfcmVhc29uID0gVGFyZ2V0aW5nRXJyb3IuVGFyZ2V0Tm90V2Fsa2FibGVcclxuICAgICAgICByZXR1cm4gcmVzcG9uc2VcclxuICAgIH1cclxuXHJcblxyXG4gICAgaWYgKGRhdGEudGFyZ2V0aW5nRGF0YS5tZXRob2QgPT0gQnJldy5FbnVtcy5CcmV3VGFyZ2V0aW5nTWV0aG9kLlBvaW50T25seSkge1xyXG4gICAgICAgIFxyXG4gICAgICAgIHJlc3BvbnNlLnBhdGggPSBbdGFyZ2V0X3h5XVxyXG4gICAgICAgIHJlc3BvbnNlLmlzX3ZhbGlkID0gdHJ1ZVxyXG5cclxuICAgIH0gZWxzZSBpZiAoZGF0YS50YXJnZXRpbmdEYXRhLm1ldGhvZCA9PSBCcmV3LkVudW1zLkJyZXdUYXJnZXRpbmdNZXRob2QuU3RyYWlnaHRMaW5lKSB7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gZHJhdyBuZXcgcGF0aFxyXG4gICAgICAgIGxldCBwYXRoX2xzdCA9IEJyZXcuVXRpbHMuZ2V0TGluZUJldHdlZW5Qb2ludHMoZGF0YS50YXJnZXRpbmdEYXRhLmZyb21feHksIGRhdGEudGFyZ2V0aW5nRGF0YS50b194eSlcclxuXHJcbiAgICAgICAgLy8gY2hlY2sgZm9yIG1pbmltdW0gZGlzdGFuY2VcclxuICAgICAgICBpZiAocGF0aF9sc3QubGVuZ3RoIDwgZGF0YS50YXJnZXRpbmdEYXRhLm1pbmltdW1EaXN0YW5jZSkge1xyXG4gICAgICAgICAgICByZXNwb25zZS5pc192YWxpZCA9IGZhbHNlXHJcbiAgICAgICAgICAgIHJlc3BvbnNlLmVycm9yX3JlYXNvbiA9IFRhcmdldGluZ0Vycm9yLkxlc3NUaGFuTWluaW11bURpc3RhbmNlXHJcbiAgICAgICAgICAgIHJldHVybiByZXNwb25zZVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gY2hlY2sgZm9yIG1heCBkaXN0YW5jZVxyXG4gICAgICAgIGlmIChkYXRhLnRhcmdldGluZ0RhdGEubWF4aW11bURpc3RhbmNlICYmIChwYXRoX2xzdC5sZW5ndGggPiBkYXRhLnRhcmdldGluZ0RhdGEubWF4aW11bURpc3RhbmNlKSkge1xyXG4gICAgICAgICAgICByZXNwb25zZS5pc192YWxpZCA9IGZhbHNlXHJcbiAgICAgICAgICAgIHJlc3BvbnNlLmVycm9yX3JlYXNvbiA9IFRhcmdldGluZ0Vycm9yLk1vcmVUaGFuTWF4aW11bURpc3RhbmNlXHJcbiAgICAgICAgICAgIHJldHVybiByZXNwb25zZVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gY2hlY2sgZm9yIHdpdGhpbiBhcmNcclxuICAgICAgICBpZiAoZGF0YS50YXJnZXRpbmdEYXRhLm1pbmltdW1BcmMpIHtcclxuICAgICAgICAgICAgbGV0IHRhcmdldF9vZmZzZXRfcG9sYXIgPSBCcmV3LlV0aWxzLnh5VG9Qb2xhcih0YXJnZXRfeHksIGRhdGEudGFyZ2V0aW5nRGF0YS5mcm9tX3h5KVxyXG4gICAgICAgICAgICBsZXQgdGFyZ2V0X2FuZ2xlID0gdGFyZ2V0X29mZnNldF9wb2xhci5hbmdsZV90aGV0YVxyXG5cclxuICAgICAgICAgICAgaWYgKChNYXRoLmFicyhkYXRhLnRhcmdldGluZ0RhdGEubWlkcG9pbnRBcmMpID09IE1hdGguUEkpICYmICh0YXJnZXRfb2Zmc2V0X3BvbGFyLmFuZ2xlX3RoZXRhIDwgMCkpIHtcclxuICAgICAgICAgICAgICAgIHRhcmdldF9hbmdsZSA9IE1hdGguUEkgKyAoTWF0aC5QSSAtIE1hdGguYWJzKHRhcmdldF9hbmdsZSkpXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGxldCBpbl9hcmMxID0gKHRhcmdldF9hbmdsZSA+PSBkYXRhLnRhcmdldGluZ0RhdGEubWluaW11bUFyYykgJiYgKHRhcmdldF9hbmdsZSA8PSBkYXRhLnRhcmdldGluZ0RhdGEubWlkcG9pbnRBcmMpXHJcbiAgICAgICAgICAgIGxldCBpbl9hcmMyID0gKHRhcmdldF9hbmdsZSA+PSBkYXRhLnRhcmdldGluZ0RhdGEubWlkcG9pbnRBcmMpICYmICh0YXJnZXRfYW5nbGUgPD0gZGF0YS50YXJnZXRpbmdEYXRhLm1heGltdW1BcmMpXHJcblxyXG4gICAgICAgICAgICBpZiAoIShpbl9hcmMxIHx8IGluX2FyYzIpKSB7XHJcbiAgICAgICAgICAgICAgICByZXNwb25zZS5pc192YWxpZCA9IGZhbHNlXHJcbiAgICAgICAgICAgICAgICByZXNwb25zZS5lcnJvcl9yZWFzb24gPSBUYXJnZXRpbmdFcnJvci5UYXJnZXROb3RXaXRoaW5GaXJpbmdBcmNcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZVxyXG4gICAgICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcblxyXG4gICAgICAgIC8vIGFzc3VtZSBwYXRoIGlzIHRydWUgdW5sZXNzIHdlIHJ1biBpbnRvIHNvbWV0aGluZ1xyXG4gICAgICAgIHJlc3BvbnNlLmlzX3ZhbGlkID0gdHJ1ZVxyXG4gICAgICAgIFxyXG4gICAgICAgIGxldCByZWFsX3BhdGhfbHN0IDogQXJyYXk8QnJldy5Db29yZGluYXRlPiA9IFtdXHJcbiAgICAgICAgXHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwYXRoX2xzdC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBsZXQgeHkgPSBwYXRoX2xzdFtpXSBcclxuICAgICAgICAgICAgbGV0IHQgPSBsZXZlbC50ZXJyYWluLmdldEF0KHh5KVxyXG4gICAgICAgICAgICBpbl9mb3YgPSBkYXRhLmFjdG9yLmZvdi5oYXNBdCh4eSkgLy9kYXRhLmFjdG9yLmluRk9WKHQpXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBpZiAoZGF0YS50YXJnZXRpbmdEYXRhLmRlc3RpbmF0aW9uTXVzdEJlVmlzaWJsZSAmJiAoIShpbl9mb3YpKSkge1xyXG4gICAgICAgICAgICAgICAgcmVzcG9uc2UuaXNfdmFsaWQgPSBmYWxzZVxyXG4gICAgICAgICAgICAgICAgcmVzcG9uc2UuZXJyb3JfcmVhc29uID0gVGFyZ2V0aW5nRXJyb3IuVGFyZ2V0Tm90Vmlld2FibGVcclxuICAgICAgICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgICAgIH0gXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBpZiAoZGF0YS50YXJnZXRpbmdEYXRhLnBhdGhCbG9ja2VkQnlOb25XYWxrYWJsZSAmJiB0LmJsb2Nrc193YWxraW5nKSB7XHJcbiAgICAgICAgICAgICAgICByZXNwb25zZS5pc192YWxpZCA9IGZhbHNlXHJcbiAgICAgICAgICAgICAgICByZXNwb25zZS5lcnJvcl9yZWFzb24gPSBUYXJnZXRpbmdFcnJvci5QYXRoQmxvY2tlZEJ5VGVycmFpblxyXG4gICAgICAgICAgICAgICAgYnJlYWtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKGRhdGEudGFyZ2V0aW5nRGF0YS5wYXRoQmxvY2tlZEJ5Tm9uRmx5YWJsZSAmJiB0LmJsb2Nrc19mbHlpbmcpIHtcclxuICAgICAgICAgICAgICAgIHJlc3BvbnNlLmlzX3ZhbGlkID0gZmFsc2VcclxuICAgICAgICAgICAgICAgIHJlc3BvbnNlLmVycm9yX3JlYXNvbiA9IFRhcmdldGluZ0Vycm9yLlBhdGhCbG9ja2VkQnlUZXJyYWluXHJcbiAgICAgICAgICAgICAgICBicmVha1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBsZXQgbSA9IGxldmVsLm1vbnN0ZXJzLmdldEF0KHh5KVxyXG4gICAgICAgICAgICBsZXQgbGFzdF9lbGVtZW50ID0gaSA9PSAocGF0aF9sc3QubGVuZ3RoIC0gMSlcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGlmICghKGxhc3RfZWxlbWVudCkpIHtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgLy8gbm90IHRoZSBsYXN0IGNvb3JkLCBidXQgbW9iIGlzIGluIHRoZSB3YXlcclxuICAgICAgICAgICAgICAgIGlmIChkYXRhLnRhcmdldGluZ0RhdGEucGF0aEJsb2NrZWRCeU1vYnMgJiYgKG0pICYmICghKGkgPT0gMCkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVhbF9wYXRoX2xzdC5wdXNoKHh5KVxyXG4gICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlLmlzX3ZhbGlkID0gZmFsc2VcclxuICAgICAgICAgICAgICAgICAgICByZXNwb25zZS5lcnJvcl9yZWFzb24gPSBUYXJnZXRpbmdFcnJvci5QYXRoQmxvY2tlZEJ5TW9iXHJcbiAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2UuYWN0dWFsX3h5ID0geHkuY2xvbmUoKVxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIGlzIHRoZSBsYXN0IGVsZW1lbnQsIGNoZWNrIGlmIHdlIG5lZWQgdG8gaGF2ZSBhIG1vYiB0YXJnZXRcclxuICAgICAgICAgICAgICAgIC8vIHRvZG86IG1heWJlIHNvbWUga2luZCBvZiBnb29kIC8gYmFkIGluZGljYXRvciBmb3IgdGhlIHBhdGhcclxuICAgICAgICAgICAgfSBcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHJlYWxfcGF0aF9sc3QucHVzaCh4eSlcclxuICAgICAgICB9IC8vIGVuZCBwYXRoIGZvciBsb29wXHJcbiAgICAgICAgXHJcbiAgICAgICAgcmVzcG9uc2UucGF0aCA9IHJlYWxfcGF0aF9sc3RcclxuICAgIH0gLy8gZW5kIGlmXHJcblxyXG4gICAgLy8gc2VlIGlmIHdlIG5lZWQgYSB0YXJnZXQgYXQgdGhlIGVuZCBvZiBldmVyeXRoaW5nXHJcbiAgICBpZiAocmVzcG9uc2UuaXNfdmFsaWQgJiYgZGF0YS50YXJnZXRpbmdEYXRhLmRlc3RpbmF0aW9uTXVzdEhhdmVNb2IpIHtcclxuICAgICAgICBsZXQgY2hlY2tfbSA9IGxldmVsLm1vbnN0ZXJzLmdldEF0KHRhcmdldF94eSlcclxuICAgICAgICBpZiAoIShjaGVja19tKSkge1xyXG4gICAgICAgICAgICByZXNwb25zZS5pc192YWxpZCA9IGZhbHNlXHJcbiAgICAgICAgICAgIHJlc3BvbnNlLmVycm9yX3JlYXNvbiA9IFRhcmdldGluZ0Vycm9yLlRhcmdldE1vbnN0ZXJSZXF1aXJlZFxyXG5cclxuICAgICAgICB9IGVsc2UgaWYgKCEoZGF0YS5hY3Rvci5oYXNLbm93bGVkZ2VPZihjaGVja19tKSkpIHtcclxuICAgICAgICAgICAgcmVzcG9uc2UuaXNfdmFsaWQgPSBmYWxzZVxyXG4gICAgICAgICAgICByZXNwb25zZS5lcnJvcl9yZWFzb24gPSBUYXJnZXRpbmdFcnJvci5UYXJnZXRNb25zdGVyUmVxdWlyZWRcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gc3BlY2lhbCBjaGVjayBmb3IgJ2FjdHVhbCcgbGFuZGluZyBzcG90XHJcbiAgICBpZiAocmVzcG9uc2UuYWN0dWFsX3h5KSB7XHJcbiAgICAgICAgbGV0IHRlcnJhaW5fYXQgPSBsZXZlbC50ZXJyYWluLmdldEF0KHJlc3BvbnNlLmFjdHVhbF94eSlcclxuICAgICAgICBpZiAoZGF0YS50YXJnZXRpbmdEYXRhLmRlc3RpbmF0aW9uTXVzdEJlV2Fsa2FibGUgJiYgdGVycmFpbl9hdC5ibG9ja3Nfd2Fsa2luZykge1xyXG4gICAgICAgICAgICByZXNwb25zZS5pc192YWxpZCA9IGZhbHNlXHJcbiAgICAgICAgICAgIHJlc3BvbnNlLmVycm9yX3JlYXNvbiA9IFRhcmdldGluZ0Vycm9yLkxhbmRpbmdOb3RXYWxrYWJsZVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gcmVzcG9uc2VcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldFRhcmdldGluZ0RhdGFCeVR5cGUoZ206IEJyZXcuR2FtZU1hc3RlciwgZGF0YTogQnJldy5FbnVtcy5JQnJld0V2ZW50KSA6ICBCcmV3LkVudW1zLklCcmV3VGFyZ2V0aW5nRGF0YXtcclxuICAgIGxldCB0Z3RBY3Rpb24gPSAgZGF0YS5zdGFydFRhcmdldGluZ0RhdGEudGFyZ2V0aW5nQWN0aW9uXHJcbiAgICBsZXQgcmVzdWx0IDogQnJldy5FbnVtcy5JQnJld1RhcmdldGluZ0RhdGFcclxuICAgIGxldCBwb3dlciA6IEJyZXcuUG93ZXJzLlBvd2VyXHJcblxyXG4gICAgaWYgKFtCcmV3LkVudW1zLkJyZXdUYXJnZXRpbmdBY3Rpb24uUmFuZ2VkQXR0YWNrXS5pbmRleE9mKHRndEFjdGlvbikgPiAtMSkge1xyXG4gICAgICAgIC8vIGxldCBmaXJpbmdfcmFuZ2UgPSBCcmV3LlRhbmsuZ2V0RmlyaW5nQXJjUmFuZ2UoZ20sIGRhdGEuYWN0b3IubG9jYXRpb24sIClcclxuICAgICAgICBsZXQgbW9iX3RhcmdldF9yZXF1aXJlZCA6IGJvb2xlYW4gPSAoZGF0YS5wb3dlckRhdGEucG93ZXIucG93ZXJUeXBlICE9IEJyZXcuRW51bXMuQnJld1Bvd2VyVHlwZS5UdXJyZXRDYW5ub24pXHJcblxyXG4gICAgICAgIHJlc3VsdCA9IHtcclxuICAgICAgICAgICAgYWN0aW9uOiBkYXRhLnN0YXJ0VGFyZ2V0aW5nRGF0YS50YXJnZXRpbmdBY3Rpb24sIC8vIGNvcGllZCBvdmVyIGZyb20gaW5pdGlhbCBldmVudFxyXG4gICAgICAgICAgICBvcmlnaW5feHk6IGdtLmdldFBsYXllcigpLmxvY2F0aW9uLmNsb25lKCksXHJcbiAgICAgICAgICAgIGZyb21feHk6IGdtLmdldFBsYXllcigpLmxvY2F0aW9uLmNsb25lKCksXHJcbiAgICAgICAgICAgIHRvX3h5OiBnbS5nZXRQbGF5ZXIoKS5sb2NhdGlvbi5jbG9uZSgpLFxyXG4gICAgICAgICAgICBtZXRob2Q6IEJyZXcuRW51bXMuQnJld1RhcmdldGluZ01ldGhvZC5TdHJhaWdodExpbmUsIFxyXG4gICAgICAgICAgICBkZXN0aW5hdGlvbk11c3RCZVZpc2libGU6IHRydWUsICBcclxuICAgICAgICAgICAgZGVzdGluYXRpb25NdXN0QmVXYWxrYWJsZTogZmFsc2UsXHJcbiAgICAgICAgICAgIGRlc3RpbmF0aW9uTXVzdEhhdmVNb2I6IG1vYl90YXJnZXRfcmVxdWlyZWQsXHJcbiAgICAgICAgICAgIHBhdGhCbG9ja2VkQnlOb25GbHlhYmxlOiB0cnVlLFxyXG4gICAgICAgICAgICBwYXRoQmxvY2tlZEJ5Tm9uV2Fsa2FibGU6IGZhbHNlLFxyXG4gICAgICAgICAgICBwYXRoQmxvY2tlZEJ5TW9iczogdHJ1ZSxcclxuICAgICAgICAgICAgbWluaW11bURpc3RhbmNlOiAwLFxyXG4gICAgICAgICAgICBtaW5pbXVtQXJjOiBkYXRhLnN0YXJ0VGFyZ2V0aW5nRGF0YS5taW5pbXVtQXJjLFxyXG4gICAgICAgICAgICBtYXhpbXVtQXJjOiBkYXRhLnN0YXJ0VGFyZ2V0aW5nRGF0YS5tYXhpbXVtQXJjLFxyXG4gICAgICAgICAgICBtaWRwb2ludEFyYzogZGF0YS5zdGFydFRhcmdldGluZ0RhdGEubWlkcG9pbnRBcmMsXHJcbiAgICAgICAgfVxyXG5cclxuICAgIH0gZWxzZSBpZiAoW0JyZXcuRW51bXMuQnJld1RhcmdldGluZ0FjdGlvbi5FeGFtaW5lLCBCcmV3LkVudW1zLkJyZXdUYXJnZXRpbmdBY3Rpb24uRGVidWdTdW1tb25Nb2IsIEJyZXcuRW51bXMuQnJld1RhcmdldGluZ0FjdGlvbi5EZWJ1Z01ha2VGZWF0dXJlLCBCcmV3LkVudW1zLkJyZXdUYXJnZXRpbmdBY3Rpb24uRGVidWdNYWtlVGVycmFpbl0uaW5kZXhPZih0Z3RBY3Rpb24pID4gLTEpIHtcclxuICAgICAgICByZXN1bHQgPSB7XHJcbiAgICAgICAgICAgIGFjdGlvbjogZGF0YS5zdGFydFRhcmdldGluZ0RhdGEudGFyZ2V0aW5nQWN0aW9uLCAvLyBjb3BpZWQgb3ZlciBmcm9tIGluaXRpYWwgZXZlbnRcclxuICAgICAgICAgICAgb3JpZ2luX3h5OiBnbS5nZXRQbGF5ZXIoKS5sb2NhdGlvbi5jbG9uZSgpLFxyXG4gICAgICAgICAgICBmcm9tX3h5OiBnbS5nZXRQbGF5ZXIoKS5sb2NhdGlvbi5jbG9uZSgpLFxyXG4gICAgICAgICAgICB0b194eTogZ20uZ2V0UGxheWVyKCkubG9jYXRpb24uY2xvbmUoKSxcclxuICAgICAgICAgICAgbWV0aG9kOiBCcmV3LkVudW1zLkJyZXdUYXJnZXRpbmdNZXRob2QuUG9pbnRPbmx5LFxyXG4gICAgICAgICAgICBkZXN0aW5hdGlvbk11c3RCZVZpc2libGU6IGZhbHNlLCAgXHJcbiAgICAgICAgICAgIGRlc3RpbmF0aW9uTXVzdEJlV2Fsa2FibGU6IGZhbHNlLFxyXG4gICAgICAgICAgICBkZXN0aW5hdGlvbk11c3RIYXZlTW9iOiBmYWxzZSxcclxuICAgICAgICAgICAgcGF0aEJsb2NrZWRCeU5vbkZseWFibGU6IGZhbHNlLFxyXG4gICAgICAgICAgICBwYXRoQmxvY2tlZEJ5Tm9uV2Fsa2FibGU6IGZhbHNlLFxyXG4gICAgICAgICAgICBwYXRoQmxvY2tlZEJ5TW9iczogZmFsc2UsXHJcbiAgICAgICAgICAgIG1pbmltdW1EaXN0YW5jZTogMCxcclxuICAgICAgICB9XHJcblxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICAvLyBkZWZhdWx0IGNhc2VcclxuICAgICAgICByZXN1bHQgPSB7XHJcbiAgICAgICAgICAgIGFjdGlvbjogZGF0YS5zdGFydFRhcmdldGluZ0RhdGEudGFyZ2V0aW5nQWN0aW9uLCAvLyBjb3BpZWQgb3ZlciBmcm9tIGluaXRpYWwgZXZlbnRcclxuICAgICAgICAgICAgb3JpZ2luX3h5OiBnbS5nZXRQbGF5ZXIoKS5sb2NhdGlvbi5jbG9uZSgpLFxyXG4gICAgICAgICAgICBmcm9tX3h5OiBnbS5nZXRQbGF5ZXIoKS5sb2NhdGlvbi5jbG9uZSgpLFxyXG4gICAgICAgICAgICB0b194eTogZ20uZ2V0UGxheWVyKCkubG9jYXRpb24uY2xvbmUoKSxcclxuICAgICAgICAgICAgbWV0aG9kOiBCcmV3LkVudW1zLkJyZXdUYXJnZXRpbmdNZXRob2QuU3RyYWlnaHRMaW5lLCBcclxuICAgICAgICAgICAgZGVzdGluYXRpb25NdXN0QmVWaXNpYmxlOiB0cnVlLCAgXHJcbiAgICAgICAgICAgIGRlc3RpbmF0aW9uTXVzdEJlV2Fsa2FibGU6IHRydWUsXHJcbiAgICAgICAgICAgIGRlc3RpbmF0aW9uTXVzdEhhdmVNb2I6IGZhbHNlLFxyXG4gICAgICAgICAgICBwYXRoQmxvY2tlZEJ5Tm9uRmx5YWJsZTogdHJ1ZSxcclxuICAgICAgICAgICAgcGF0aEJsb2NrZWRCeU5vbldhbGthYmxlOiBmYWxzZSxcclxuICAgICAgICAgICAgcGF0aEJsb2NrZWRCeU1vYnM6IHRydWUsXHJcbiAgICAgICAgICAgIG1pbmltdW1EaXN0YW5jZTogMCxcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHJlc3VsdFxyXG59XHJcblxyXG5pbnRlcmZhY2UgRGljdDxUPiB7XHJcbiAgICBba2V5OiBudW1iZXJdOiBUXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRDbG9zZXN0VGFyZ2V0cyhnbSA6IEJyZXcuR2FtZU1hc3RlciwgYWN0b3I6IEJyZXcuR3JpZFRoaW5ncy5Nb25zdGVyKSA6IEFycmF5PEJyZXcuR3JpZFRoaW5ncy5Nb25zdGVyPiB7XHJcbiAgICAvLyByZXR1cm4gY2xvc2VzdCB0YXJnZXQgd2l0aGluIGF0dGFjayByYW5nZVxyXG4gICAgbGV0IGxldmVsID0gZ20uZ2V0Q3VycmVudExldmVsKClcclxuICAgIGxldCBkaXN0TWFwIDogRGljdDxudW1iZXI+ID0ge31cclxuXHJcbiAgICBmb3IgKGxldCBtIG9mIGxldmVsLm1vbnN0ZXJzLmdldEFsbFRoaW5ncygpKSB7XHJcbiAgICAgICAgbGV0IGRpc3QyZCA9IEJyZXcuVXRpbHMuZGlzdDJkKGFjdG9yLmxvY2F0aW9uLCBtLmxvY2F0aW9uKVxyXG4gICAgICAgIGRpc3RNYXBbbS5nZXRJRCgpXSA9IGRpc3QyZFxyXG4gICAgfVxyXG5cclxuICAgIGxldCBtb25zdGVycyA6IEFycmF5PEJyZXcuR3JpZFRoaW5ncy5Nb25zdGVyPiAgPSBCcmV3LkludGVsLmdldE1vbnN0ZXJzS25vd25CeShnbSwgYWN0b3IpLmZpbHRlcigobSwgaW5kZXgsIGFycmF5KSA9PiB7XHJcbiAgICAgICAgLy8gbGV0IGRpc3QyZCA9IE1hdGguZmxvb3IoVXRpbHMuZGlzdDJkKGFjdG9yLmxvY2F0aW9uLCBtLmxvY2F0aW9uKSlcclxuICAgICAgICByZXR1cm4gKEJyZXcuSW50ZWwuaXNFbmVteShhY3RvciwgbSkpIC8vJiYgXHJcbiAgICAgICAgICAgIC8vIChkaXN0MmQgPD0gYWN0b3IuYXR0YWNrX3JhbmdlKVxyXG4gICAgICAgIFxyXG4gICAgfSkuc29ydCgoYU1vYiwgYk1vYikgPT4ge1xyXG4gICAgICAgIHJldHVybiBkaXN0TWFwW2FNb2IuZ2V0SUQoKV0gLSBkaXN0TWFwW2JNb2IuZ2V0SUQoKV1cclxuICAgIH0pXHJcblxyXG4gICAgcmV0dXJuIG1vbnN0ZXJzXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRDbG9zZXN0VGFyZ2V0KGdtIDogQnJldy5HYW1lTWFzdGVyLCBhY3RvcjogQnJldy5HcmlkVGhpbmdzLk1vbnN0ZXIpIDogQnJldy5HcmlkVGhpbmdzLk1vbnN0ZXIge1xyXG4gICAgbGV0IHRhcmdldHMgPSBnZXRDbG9zZXN0VGFyZ2V0cyhnbSwgYWN0b3IpXHJcbiAgICBpZiAodGFyZ2V0cy5sZW5ndGggPT0gMCkge1xyXG4gICAgICAgIHJldHVybiBudWxsXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJldHVybiB0YXJnZXRzWzBdXHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBpc1JhbmdlZEF0dGFja1RocmVhdChnbTogQnJldy5HYW1lTWFzdGVyLCBwb3RlbnRpYWxfYXR0YWNrZXIgOiBCcmV3LkdyaWRUaGluZ3MuTW9uc3RlciwgdGFyZ2V0OiBCcmV3LkdyaWRUaGluZ3MuTW9uc3RlcikgOiBib29sZWFuIHtcclxuICAgIC8vIGZyaWVuZHMgc2hvdWxkIG5vdCBiZSB0aHJlYXRzXHJcbiAgICBpZiAoIShCcmV3LkludGVsLmlzRW5lbXkodGFyZ2V0LCBwb3RlbnRpYWxfYXR0YWNrZXIpKSkge1xyXG4gICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBpZiB0aGV5IGhhdmUgYSBsb2NrIHRoZW4gdGhleSd2ZSBhbHJlYWR5IGJlZW4gdGhyb3VnaCBhbGwgdGhlIGFsZ29yaXRobXNcclxuICAgIGlmIChoYXNUYXJnZXRMb2NrKHBvdGVudGlhbF9hdHRhY2tlciwgdGFyZ2V0KSkge1xyXG4gICAgICAgIHJldHVybiB0cnVlXHJcbiAgICB9XHJcblxyXG4gICAgLy8gbWVsZWUtb25seSBiYWQgZ3V5cyBzaG91bGRudCBldmVyIGJlIHJhbmdlZCB0aHJlYXRzXHJcbiAgICBpZiAocG90ZW50aWFsX2F0dGFja2VyLmF0dGFja19yYW5nZSA9PSAxKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICB9XHJcblxyXG4gICAgLy8gaWYgdGhleSBuZWVkIGEgbG9jayBidXQgZG9uJ3QgaGF2ZSBvbmUgdGhlbiBvYnZpb3VzbHkgdGhleSBmYWlsIHRoaXMgdGVzdFxyXG4gICAgaWYgKHBvdGVudGlhbF9hdHRhY2tlci5oYXNGbGFnKEJyZXcuRW51bXMuRmxhZy5OZWVkc1RhcmdldExvY2spKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICB9XHJcblxyXG4gICAgLy8gb3RoZXJ3aXNlIGNoZWNrIGlmIHRoZXkgaGF2ZSBhIGNsZWFyIHNob3RcclxuICAgIGxldCB0ZXN0VGFyZ2V0RXZlbnQgPSBjcmVhdGVUZXN0VGFyZ2V0aW5nRXZlbnQocG90ZW50aWFsX2F0dGFja2VyLCB0YXJnZXQsIDAsIDIpXHJcbiAgICBsZXQgdGFyZ2V0aW5nX2NoZWNrID0gY2hlY2tUYXJnZXRpbmdQYXRoKGdtLCB0ZXN0VGFyZ2V0RXZlbnQpXHJcbiAgICByZXR1cm4gdGFyZ2V0aW5nX2NoZWNrLmlzX3ZhbGlkXHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVUZXN0VGFyZ2V0aW5nRXZlbnQocG90ZW50aWFsX2F0dGFja2VyOiBCcmV3LkdyaWRUaGluZ3MuTW9uc3RlciwgdGFyZ2V0OiBCcmV3LkdyaWRUaGluZ3MuTW9uc3RlciwgZGFtYWdlIDogbnVtYmVyLCBtaW5fZGlzdGFuY2UgOiBudW1iZXIpIDogQnJldy5FbnVtcy5JQnJld0V2ZW50IHtcclxuICAgIGxldCB0ZXN0VGFyZ2V0RXZlbnQgOiBCcmV3LkVudW1zLklCcmV3RXZlbnRcclxuICAgIHRlc3RUYXJnZXRFdmVudCA9IHtcclxuICAgICAgICBldmVudFR5cGU6IEJyZXcuRW51bXMuQnJld0V2ZW50VHlwZS5BdHRhY2ssXHJcbiAgICAgICAgYWN0b3I6IHBvdGVudGlhbF9hdHRhY2tlcixcclxuICAgICAgICBwbGF5ZXJJbml0aWF0ZWQ6IGZhbHNlLFxyXG4gICAgICAgIGVuZHNUdXJuOiB0cnVlLFxyXG4gICAgICAgIGF0dGFja0RhdGE6IHtcclxuICAgICAgICAgICAgZnJvbV94eTogcG90ZW50aWFsX2F0dGFja2VyLmxvY2F0aW9uLmNsb25lKCksXHJcbiAgICAgICAgICAgIHRvX3h5OiB0YXJnZXQubG9jYXRpb24uY2xvbmUoKSxcclxuICAgICAgICAgICAgdGFyZ2V0OiB0YXJnZXQsXHJcbiAgICAgICAgICAgIGlzTWVsZWU6IGZhbHNlLFxyXG4gICAgICAgICAgICBkYW1hZ2U6IGRhbWFnZVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHRlc3RUYXJnZXRFdmVudC50YXJnZXRpbmdEYXRhID0ge1xyXG4gICAgICAgIGFjdGlvbjogQnJldy5FbnVtcy5CcmV3VGFyZ2V0aW5nQWN0aW9uLlJhbmdlZEF0dGFjayxcclxuICAgICAgICBtZXRob2Q6IEJyZXcuRW51bXMuQnJld1RhcmdldGluZ01ldGhvZC5TdHJhaWdodExpbmUsXHJcbiAgICAgICAgZGVzdGluYXRpb25NdXN0QmVWaXNpYmxlOiB0cnVlLFxyXG4gICAgICAgIGRlc3RpbmF0aW9uTXVzdEhhdmVNb2I6IHRydWUsXHJcbiAgICAgICAgZGVzdGluYXRpb25NdXN0QmVXYWxrYWJsZTogZmFsc2UsIC8vIGNhbiBzdGlsbCBhdHRhY2tcclxuICAgICAgICBvcmlnaW5feHk6IHRlc3RUYXJnZXRFdmVudC5hdHRhY2tEYXRhLmZyb21feHksXHJcbiAgICAgICAgZnJvbV94eTogdGVzdFRhcmdldEV2ZW50LmF0dGFja0RhdGEuZnJvbV94eSxcclxuICAgICAgICB0b194eTogdGVzdFRhcmdldEV2ZW50LmF0dGFja0RhdGEudG9feHksXHJcbiAgICAgICAgbWluaW11bURpc3RhbmNlOiBtaW5fZGlzdGFuY2UsXHJcbiAgICAgICAgcGF0aEJsb2NrZWRCeU1vYnM6IHRydWUsXHJcbiAgICAgICAgcGF0aEJsb2NrZWRCeU5vbldhbGthYmxlOiBmYWxzZSxcclxuICAgICAgICBwYXRoQmxvY2tlZEJ5Tm9uRmx5YWJsZTogdHJ1ZSxcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gdGVzdFRhcmdldEV2ZW50XHJcbn1cclxuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/brew_game/targeting.ts\n");

/***/ }),

/***/ "./src/grid_things/above.ts":
/*!**********************************!*\
  !*** ./src/grid_things/above.ts ***!
  \**********************************/
/*! exports provided: Above */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Above\", function() { return Above; });\n/* harmony import */ var _brew__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../brew */ \"./src/brew.ts\");\n/* harmony import */ var _grid_things_thing__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../grid_things/thing */ \"./src/grid_things/thing.ts\");\n\r\n\r\nclass Above extends _grid_things_thing__WEBPACK_IMPORTED_MODULE_1__[\"Thing\"] {\r\n    constructor(definition) {\r\n        super(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewObjectType.Above, definition);\r\n    }\r\n    getName() {\r\n        return _brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].AboveType[this.definition];\r\n    }\r\n}\r\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvZ3JpZF90aGluZ3MvYWJvdmUudHM/NDE0YSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQStCO0FBQ2E7QUFFdEMsV0FBYSxTQUFRLHdEQUFLO0lBRTVCLFlBQWEsVUFBc0M7UUFDL0MsS0FBSyxDQUFDLDJDQUFVLENBQUMsY0FBYyxDQUFDLEtBQUssRUFBRSxVQUFVLENBQUM7SUFDdEQsQ0FBQztJQUVNLE9BQU87UUFDVixNQUFNLENBQUMsaURBQWdCLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUM7SUFDdEQsQ0FBQztDQUNKIiwiZmlsZSI6Ii4vc3JjL2dyaWRfdGhpbmdzL2Fib3ZlLnRzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgQnJldyBmcm9tIFwiLi4vYnJld1wiXHJcbmltcG9ydCB7IFRoaW5nIH0gZnJvbSAnLi4vZ3JpZF90aGluZ3MvdGhpbmcnXHJcblxyXG5leHBvcnQgY2xhc3MgQWJvdmUgZXh0ZW5kcyBUaGluZyB7XHJcblxyXG4gICAgY29uc3RydWN0b3IgKGRlZmluaXRpb246IEJyZXcuRGVmaW5pdGlvbnMuQWJvdmVUeXBlKSB7XHJcbiAgICAgICAgc3VwZXIoQnJldy5FbnVtcy5CcmV3T2JqZWN0VHlwZS5BYm92ZSwgZGVmaW5pdGlvbilcclxuICAgIH1cclxuICAgIFxyXG4gICAgcHVibGljIGdldE5hbWUoKSA6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIEJyZXcuRGVmaW5pdGlvbnMuQWJvdmVUeXBlW3RoaXMuZGVmaW5pdGlvbl1cclxuICAgIH1cclxufVxyXG5cclxuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/grid_things/above.ts\n");

/***/ }),

/***/ "./src/grid_things/definitions.ts":
/*!****************************************!*\
  !*** ./src/grid_things/definitions.ts ***!
  \****************************************/
/*! exports provided: TerrainType, terrainFactory, AboveType, aboveFactory, FeatureType, featureFactory, ItemType, ItemSubtype, itemFactory, MonsterType, monsterFactory */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"TerrainType\", function() { return TerrainType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"terrainFactory\", function() { return terrainFactory; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AboveType\", function() { return AboveType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"aboveFactory\", function() { return aboveFactory; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"FeatureType\", function() { return FeatureType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"featureFactory\", function() { return featureFactory; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ItemType\", function() { return ItemType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ItemSubtype\", function() { return ItemSubtype; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"itemFactory\", function() { return itemFactory; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"MonsterType\", function() { return MonsterType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"monsterFactory\", function() { return monsterFactory; });\n/* harmony import */ var rot_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! rot-js */ \"./node_modules/rot-js/lib/rot.js\");\n/* harmony import */ var rot_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(rot_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _brew__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../brew */ \"./src/brew.ts\");\n/* harmony import */ var _above__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./above */ \"./src/grid_things/above.ts\");\n/* harmony import */ var _features__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./features */ \"./src/grid_things/features.ts\");\n/* harmony import */ var _item__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./item */ \"./src/grid_things/item.ts\");\n/* harmony import */ var _terrain__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./terrain */ \"./src/grid_things/terrain.ts\");\n\r\n\r\n\r\n\r\n\r\n\r\nvar TerrainType;\r\n(function (TerrainType) {\r\n    TerrainType[TerrainType[\"Rock\"] = 0] = \"Rock\";\r\n    TerrainType[TerrainType[\"Broken_Wall\"] = 1] = \"Broken_Wall\";\r\n    TerrainType[TerrainType[\"Sand\"] = 2] = \"Sand\";\r\n    TerrainType[TerrainType[\"Grass\"] = 3] = \"Grass\";\r\n    TerrainType[TerrainType[\"Rubble\"] = 4] = \"Rubble\";\r\n    TerrainType[TerrainType[\"Chasm\"] = 5] = \"Chasm\";\r\n    TerrainType[TerrainType[\"Highlight\"] = 6] = \"Highlight\";\r\n    TerrainType[TerrainType[\"LevelCheckPoint\"] = 7] = \"LevelCheckPoint\";\r\n    TerrainType[TerrainType[\"UpStairs\"] = 8] = \"UpStairs\";\r\n    TerrainType[TerrainType[\"Door\"] = 9] = \"Door\";\r\n    TerrainType[TerrainType[\"DoorOpen\"] = 10] = \"DoorOpen\";\r\n    TerrainType[TerrainType[\"DoorBroken\"] = 11] = \"DoorBroken\";\r\n    TerrainType[TerrainType[\"WarpBeacon\"] = 12] = \"WarpBeacon\";\r\n})(TerrainType || (TerrainType = {}));\r\nlet terrain_defaults = {\r\n    code: \" \",\r\n    color: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].normal,\r\n    bg_color: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].dark_gray,\r\n    blocks_walking: false,\r\n    blocks_vision: false,\r\n    blocks_flying: false,\r\n    is_solid: false,\r\n    alwaysOnTop: false,\r\n};\r\nlet terrain_definitions = {\r\n    \"Rock\": {\r\n        code: \"#\",\r\n        color: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].normal,\r\n        bg_color: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].dark_gray,\r\n        // randomize_bgcolor: [0, 0, 10],\r\n        blocks_vision: true,\r\n        blocks_walking: true,\r\n        blocks_flying: true\r\n    },\r\n    \"Broken_Wall\": {\r\n        code: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Symbols\"].half_block_lower,\r\n        color: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].light_slate_gray,\r\n        bg_color: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].dark_gray,\r\n        // randomize_bgcolor: [0, 0, 10],\r\n        blocks_vision: false,\r\n        blocks_walking: true,\r\n        blocks_flying: true\r\n    },\r\n    \"Sand\": {\r\n        code: \".\",\r\n        color: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].primary_shade_2,\r\n        bg_color: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].dark_gray,\r\n        // randomize_bgcolor: [0, 0, 10],\r\n        blocks_vision: false,\r\n        blocks_walking: false,\r\n        blocks_flying: false\r\n    },\r\n    \"Grass\": {\r\n        code: '\"',\r\n        color: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].secondary_green_shade_2,\r\n        bg_color: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].dark_gray,\r\n        // randomize_bgcolor: [0, 0, 10],\r\n        blocks_vision: false,\r\n        blocks_walking: false,\r\n        blocks_flying: false\r\n    },\r\n    \"Rubble\": {\r\n        code: \",\",\r\n        color: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].primary_shade_0,\r\n        bg_color: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].dark_gray,\r\n        // randomize_bgcolor: [0, 0, 10],\r\n        blocks_vision: false,\r\n        blocks_walking: false,\r\n        blocks_flying: false\r\n    },\r\n    \"Chasm\": {\r\n        code: \":\",\r\n        color: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].light_slate_gray,\r\n        bg_color: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].midnight_blue,\r\n        blocks_vision: false,\r\n        blocks_walking: true,\r\n        blocks_flying: false\r\n    },\r\n    \"Highlight\": {\r\n        code: \" \"\r\n    },\r\n    \"LevelCheckPoint\": {\r\n        code: \"X\",\r\n        color: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].red,\r\n        blocks_vision: false,\r\n        blocks_walking: false,\r\n        blocks_flying: false\r\n    },\r\n    \"UpStairs\": {\r\n        code: \"<\",\r\n        blocks_vision: false,\r\n        blocks_walking: false,\r\n        blocks_flying: false\r\n    },\r\n    \"Door\": {\r\n        code: \"+\",\r\n        color: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].yellow,\r\n        blocks_vision: true,\r\n        blocks_walking: false,\r\n        blocks_flying: false,\r\n        alwaysOnTop: true,\r\n        is_solid: true,\r\n    },\r\n    \"DoorOpen\": {\r\n        code: \"-\",\r\n        blocks_vision: false,\r\n        blocks_walking: false,\r\n        blocks_flying: false,\r\n        alwaysOnTop: true,\r\n    },\r\n    \"DoorBroken\": {\r\n        code: \"/\",\r\n        blocks_vision: false,\r\n        blocks_walking: false,\r\n        blocks_flying: false,\r\n        alwaysOnTop: true,\r\n    },\r\n    \"WarpBeacon\": {\r\n        code: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Symbols\"].quad_diamond,\r\n        blocks_vision: false,\r\n        blocks_walking: false,\r\n        blocks_flying: false,\r\n        alwaysOnTop: true,\r\n    }\r\n};\r\nfunction terrainFactory(terrain_type, options = {}) {\r\n    let t = new _terrain__WEBPACK_IMPORTED_MODULE_5__[\"Terrain\"](terrain_type);\r\n    // build up definition with 3 layers: default, given def, options\r\n    // 1. default\r\n    let def = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Utils\"].clone(terrain_defaults);\r\n    // 2. given definition\r\n    let type_name = TerrainType[terrain_type];\r\n    let type_def = terrain_definitions[type_name];\r\n    for (let prop in type_def) {\r\n        // console.log(\"typedef\", prop, type_def[prop])\r\n        def[prop] = type_def[prop];\r\n    }\r\n    // 3. options\r\n    for (let prop in options) {\r\n        // console.log(\"options\", prop, options[prop])\r\n        def[prop] = options[prop];\r\n    }\r\n    // 4. set all properties\r\n    for (let prop in def) {\r\n        if (prop.startsWith(\"randomize_\")) {\r\n            continue;\r\n        }\r\n        t[prop] = def[prop];\r\n    }\r\n    //terrain dont have flags yet \r\n    //t.flags = [].concat(def.flags).concat(options.flags)\r\n    // 5. randomize\r\n    let random_rgb;\r\n    if (def.randomize_color) {\r\n        random_rgb = def.randomize_color.map((c, index) => {\r\n            return def.color[index] + rot_js__WEBPACK_IMPORTED_MODULE_0__[\"RNG\"].getNormal(0, c);\r\n        });\r\n        t.color = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Utils\"].safe_color(random_rgb);\r\n    }\r\n    if (def.randomize_bgcolor) {\r\n        random_rgb = def.randomize_bgcolor.map((c, index) => {\r\n            return def.bg_color[index] + rot_js__WEBPACK_IMPORTED_MODULE_0__[\"RNG\"].getNormal(0, c);\r\n        });\r\n        t.bg_color = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Utils\"].safe_color(random_rgb);\r\n    }\r\n    return t;\r\n}\r\nvar AboveType;\r\n(function (AboveType) {\r\n    AboveType[AboveType[\"Smoke\"] = 1] = \"Smoke\";\r\n    AboveType[AboveType[\"Projectile\"] = 2] = \"Projectile\";\r\n    AboveType[AboveType[\"Flash\"] = 3] = \"Flash\";\r\n})(AboveType || (AboveType = {}));\r\nlet above_defaults = {\r\n    code: \"?\",\r\n    color: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].black\r\n};\r\nlet above_definitions = {\r\n    \"Smoke\": {\r\n        code: \"^\",\r\n        color: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].red\r\n    },\r\n    \"Projectile\": {\r\n        code: \"*\",\r\n        color: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].black\r\n    },\r\n    \"Flash\": {\r\n        code: \"\\u2588\",\r\n        color: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].blue\r\n    },\r\n};\r\nfunction aboveFactory(above_type, options = {}) {\r\n    let a = new _above__WEBPACK_IMPORTED_MODULE_2__[\"Above\"](above_type);\r\n    // build up definition with 3 layers: default, given def, options\r\n    // 1. default\r\n    let def = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Utils\"].clone(above_defaults);\r\n    // 2. given definition\r\n    let type_name = AboveType[above_type];\r\n    let type_def = above_definitions[type_name];\r\n    for (let prop in type_def) {\r\n        // console.log(\"typedef\", prop, type_def[prop])\r\n        def[prop] = type_def[prop];\r\n    }\r\n    // 3. options\r\n    for (let prop in options) {\r\n        // console.log(\"options\", prop, options[prop])\r\n        def[prop] = options[prop];\r\n    }\r\n    // 4. set all properties\r\n    for (let prop in def) {\r\n        a[prop] = def[prop];\r\n    }\r\n    return a;\r\n}\r\nvar FeatureType;\r\n(function (FeatureType) {\r\n    FeatureType[FeatureType[\"RepairGoo\"] = 0] = \"RepairGoo\";\r\n    FeatureType[FeatureType[\"CorrosiveAcid\"] = 1] = \"CorrosiveAcid\";\r\n    FeatureType[FeatureType[\"ProtectiveGoo\"] = 2] = \"ProtectiveGoo\";\r\n    // Rocks,\r\n    FeatureType[FeatureType[\"Scrap\"] = 3] = \"Scrap\";\r\n    FeatureType[FeatureType[\"Fire\"] = 4] = \"Fire\";\r\n    FeatureType[FeatureType[\"TankPart\"] = 5] = \"TankPart\";\r\n    // TankTread,\r\n    // TankTurret,\r\n    // TankHelm,\r\n    // Radiation,\r\n})(FeatureType || (FeatureType = {}));\r\nlet feature_defaults = {\r\n    code: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Symbols\"].fourdots,\r\n    color: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].black,\r\n    randomize_code: [],\r\n    flags: [],\r\n};\r\nlet feature_definitions = {\r\n    \"Fire\": {\r\n        code: '^',\r\n        color: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].orange,\r\n    },\r\n    \"Scrap\": {\r\n        code: ',',\r\n        randomize_code: [\"\\u2574\", \"\\u2575\", \"\\u2576\", \"\\u2577\"],\r\n        color: null\r\n    },\r\n    \"TankPart\": {\r\n        code: \"x\",\r\n        color: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].hero_blue,\r\n    },\r\n};\r\nfunction featureFactory(feature_type, options = {}) {\r\n    let f = new _features__WEBPACK_IMPORTED_MODULE_3__[\"Feature\"](feature_type);\r\n    // build up definition with 3 layers: default, given def, options\r\n    // 1. default\r\n    let def = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Utils\"].clone(feature_defaults);\r\n    // 2. given definition\r\n    let type_name = FeatureType[feature_type];\r\n    let type_def = feature_definitions[type_name];\r\n    for (let prop in type_def) {\r\n        // console.log(\"typedef\", prop, type_def[prop])\r\n        def[prop] = type_def[prop];\r\n    }\r\n    // 3. options\r\n    for (let prop in options) {\r\n        // console.log(\"options\", prop, options[prop])\r\n        def[prop] = options[prop];\r\n    }\r\n    // 4. set all properties\r\n    for (let prop in def) {\r\n        if (prop.startsWith(\"randomize_\")) {\r\n            continue;\r\n        }\r\n        f[prop] = def[prop];\r\n    }\r\n    f.flags = [].concat(def.flags).concat(options.flags);\r\n    // 5. randomize\r\n    if (def.randomize_code.length > 0) {\r\n        let c = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Utils\"].randomOf(def.randomize_code);\r\n        f.code = c;\r\n    }\r\n    return f;\r\n}\r\nvar ItemType;\r\n(function (ItemType) {\r\n    ItemType[ItemType[\"Grenade\"] = 0] = \"Grenade\";\r\n    ItemType[ItemType[\"Nanotech\"] = 1] = \"Nanotech\";\r\n    // SuitModule,\r\n    // WarpCrystal,\r\n    // KeyCard,\r\n    ItemType[ItemType[\"PowerRelatedItem\"] = 2] = \"PowerRelatedItem\";\r\n    ItemType[ItemType[\"PowerSystem\"] = 3] = \"PowerSystem\";\r\n    // Wreckage,\r\n    // MacGuffin,\r\n    ItemType[ItemType[\"Civilian\"] = 4] = \"Civilian\";\r\n    ItemType[ItemType[\"Supplies\"] = 5] = \"Supplies\";\r\n    ItemType[ItemType[\"Bullets\"] = 6] = \"Bullets\";\r\n    ItemType[ItemType[\"Shells\"] = 7] = \"Shells\";\r\n})(ItemType || (ItemType = {}));\r\nvar ItemSubtype;\r\n(function (ItemSubtype) {\r\n    ItemSubtype[ItemSubtype[\"NonSpecific\"] = 0] = \"NonSpecific\";\r\n    ItemSubtype[ItemSubtype[\"PowerItem_Axe\"] = 1] = \"PowerItem_Axe\";\r\n    ItemSubtype[ItemSubtype[\"PowerItem_Gun\"] = 2] = \"PowerItem_Gun\";\r\n    ItemSubtype[ItemSubtype[\"G_Explosive\"] = 3] = \"G_Explosive\";\r\n    ItemSubtype[ItemSubtype[\"G_Concusive\"] = 4] = \"G_Concusive\";\r\n    ItemSubtype[ItemSubtype[\"G_Stun\"] = 5] = \"G_Stun\";\r\n    ItemSubtype[ItemSubtype[\"N_Acid\"] = 6] = \"N_Acid\";\r\n    // N_Barrier,\r\n    // N_Might,\r\n    ItemSubtype[ItemSubtype[\"N_Health\"] = 7] = \"N_Health\";\r\n    ItemSubtype[ItemSubtype[\"N_Armor\"] = 8] = \"N_Armor\";\r\n    // N_Sticky,\r\n})(ItemSubtype || (ItemSubtype = {}));\r\nlet item_defaults = {\r\n    code: \"?\",\r\n    color: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].black,\r\n    subtype: ItemSubtype.NonSpecific,\r\n    canPickup: true,\r\n    canUse: true,\r\n    canHeave: false,\r\n    damage: 0,\r\n    flags: [],\r\n};\r\nlet item_definitions = {\r\n    \"PowerRelatedItem\": {\r\n        code: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Symbols\"].arrow_up,\r\n        color: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].power_axe,\r\n        canPickup: false,\r\n        canUse: false,\r\n    },\r\n    \"PowerSystem\": {\r\n        code: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Symbols\"].power_sys,\r\n        color: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].orange,\r\n        canPickup: false,\r\n        canUse: false,\r\n    },\r\n    \"Grenade\": {\r\n        code: '!',\r\n        color: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].goldenrod,\r\n    },\r\n    \"NanotechCore\": {\r\n        code: '=',\r\n        color: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].goldenrod,\r\n    },\r\n    // \"SuitModule\": {\r\n    //     code: '?',\r\n    //     color: Brew.Color.goldenrod,\r\n    // },\r\n    // \"WarpCrystal\": {\r\n    //     code: Brew.Symbols.diamond_full,\r\n    //     color: Brew.Color.goldenrod,\r\n    //     canUse: false,\r\n    // },\r\n    // \"KeyCard\": {\r\n    //     code: '-',\r\n    //     color: Brew.Color.goldenrod,\r\n    //     canUse: false,\r\n    // },\r\n    // \"Wreckage\": {\r\n    //     code: '%',\r\n    //     color: Brew.Color.white,\r\n    //     canUse: false,\r\n    //     canPickup: false,\r\n    //     canHeave: true,\r\n    // },\r\n    // \"MacGuffin\": {\r\n    //     code: '(',\r\n    //     color: Brew.Color.goldenrod,\r\n    //     canUse: false,\r\n    //     canPickup: true,\r\n    //     canHeave: false,\r\n    // }\r\n    \"Civilian\": {\r\n        code: '@',\r\n        color: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].goldenrod,\r\n        canUse: false,\r\n        canPickup: true,\r\n        canHeave: false,\r\n    },\r\n    \"Supplies\": {\r\n        code: '%',\r\n        color: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].goldenrod,\r\n        canUse: false,\r\n        canPickup: true,\r\n        canHeave: false,\r\n    },\r\n    \"Bullets\": {\r\n        code: '=',\r\n        color: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].goldenrod,\r\n        canUse: false,\r\n        canPickup: true,\r\n        canHeave: false,\r\n    },\r\n    \"Shells\": {\r\n        code: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Symbols\"].power_sys,\r\n        color: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].goldenrod,\r\n        canUse: false,\r\n        canPickup: true,\r\n        canHeave: false,\r\n    },\r\n};\r\n//     Grenade,\r\n// Nanotech,\r\n// SuitModule,\r\n// WarpCrystal,\r\n// KeyCard,\r\nfunction itemFactory(item_type, options = {}) {\r\n    let i = new _item__WEBPACK_IMPORTED_MODULE_4__[\"Item\"](item_type);\r\n    // build up definition with 3 layers: default, given def, options\r\n    // 1. default\r\n    let def = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Utils\"].clone(item_defaults);\r\n    // 2. given definition\r\n    let type_name = ItemType[item_type];\r\n    let type_def = item_definitions[type_name];\r\n    for (let prop in type_def) {\r\n        // console.log(\"typedef\", prop, type_def[prop])\r\n        def[prop] = type_def[prop];\r\n    }\r\n    // 3. options\r\n    for (let prop in options) {\r\n        // console.log(\"options\", prop, options[prop])\r\n        def[prop] = options[prop];\r\n    }\r\n    // 4. set all properties\r\n    for (let prop in def) {\r\n        i[prop] = def[prop];\r\n    }\r\n    i.flags = [].concat(def.flags).concat(options.flags);\r\n    return i;\r\n}\r\nvar MonsterType;\r\n(function (MonsterType) {\r\n    MonsterType[MonsterType[\"Hero\"] = 0] = \"Hero\";\r\n    MonsterType[MonsterType[\"Architect\"] = 1] = \"Architect\";\r\n    MonsterType[MonsterType[\"Mercenary\"] = 2] = \"Mercenary\";\r\n    MonsterType[MonsterType[\"Soldier\"] = 3] = \"Soldier\";\r\n    MonsterType[MonsterType[\"Grenadier\"] = 4] = \"Grenadier\";\r\n    MonsterType[MonsterType[\"Jeep\"] = 5] = \"Jeep\";\r\n})(MonsterType || (MonsterType = {}));\r\nlet monster_defaults = {\r\n    code: '1',\r\n    color: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].normal,\r\n    attack_range: 1,\r\n    monster_status: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].MonsterStatus.Sleep,\r\n    speed: 12,\r\n    sight_range: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Config\"].default_monster_sight_range,\r\n    flags: [],\r\n    hp_number: 1,\r\n    shield_number: 0,\r\n};\r\nlet monster_definitions = {\r\n    \"Hero\": {\r\n        code: \"@\",\r\n        color: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].hero_blue,\r\n        attack_range: 1,\r\n        sight_range: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Config\"].default_player_sight_range,\r\n        hp_number: 12,\r\n    },\r\n    \"Architect\": {},\r\n    \"Mercenary\": {\r\n        code: \"m\",\r\n        color: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].monster_color,\r\n        attack_range: 4,\r\n        flags: [_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].Flag.KeepsDistance, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].Flag.NeedsTargetLock],\r\n        hp_number: 1,\r\n    },\r\n    \"Soldier\": {\r\n        code: \"s\",\r\n        color: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].monster_color,\r\n        attack_range: 6,\r\n        flags: [_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].Flag.NeedsTargetLock],\r\n        hp_number: 1,\r\n    },\r\n    \"Grenadier\": {\r\n        code: \"G\",\r\n        color: _brew__WEBPACK_IMPORTED_MODULE_1__[\"Color\"].monster_color,\r\n        attack_range: 6,\r\n        hp_number: 2,\r\n        flags: [],\r\n    },\r\n};\r\nfunction monsterFactory(gm, monster_type, options = {}) {\r\n    let m = new _brew__WEBPACK_IMPORTED_MODULE_1__[\"GridThings\"].Monster(monster_type);\r\n    // build up definition with 3 layers: default, given def, options\r\n    // 1. default\r\n    let def = _brew__WEBPACK_IMPORTED_MODULE_1__[\"Utils\"].clone(monster_defaults);\r\n    // 2. given definition\r\n    let type_name = MonsterType[monster_type];\r\n    let type_def = monster_definitions[type_name];\r\n    for (let prop in type_def) {\r\n        // console.log(\"typedef\", prop, type_def[prop])\r\n        def[prop] = type_def[prop];\r\n    }\r\n    // 3. options\r\n    for (let prop in options) {\r\n        // console.log(\"options\", prop, options[prop])\r\n        def[prop] = options[prop];\r\n    }\r\n    // 4. set all properties\r\n    for (let prop in def) {\r\n        m[prop] = def[prop];\r\n    }\r\n    // 5. initiate stats\r\n    m.hp = new _brew__WEBPACK_IMPORTED_MODULE_1__[\"Stat\"](_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].StatName.Health, def.hp_number);\r\n    m.shields = new _brew__WEBPACK_IMPORTED_MODULE_1__[\"Stat\"](_brew__WEBPACK_IMPORTED_MODULE_1__[\"Enums\"].StatName.Shields, def.shield_number);\r\n    m.flags = [].concat(def.flags);\r\n    if (options.flags) {\r\n        m.flags = m.flags.concat(options.flags);\r\n    }\r\n    // act for ROT.js engine\r\n    m.act = () => {\r\n        gm.channel_turn.publish(\"turn.start\", { actor: m });\r\n        // game.monsterAct(m)\r\n    };\r\n    return m;\r\n}\r\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvZ3JpZF90aGluZ3MvZGVmaW5pdGlvbnMudHM/OTJhNSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQTZCO0FBQ0U7QUFDQTtBQUNLO0FBQ1A7QUFFTTtBQUVuQyxJQUFZLFdBY1g7QUFkRCxXQUFZLFdBQVc7SUFDbkIsNkNBQUk7SUFDSiwyREFBVztJQUNYLDZDQUFJO0lBQ0osK0NBQUs7SUFDTCxpREFBTTtJQUNOLCtDQUFLO0lBQ0wsdURBQVM7SUFDVCxtRUFBZTtJQUNmLHFEQUFRO0lBQ1IsNkNBQUk7SUFDSixzREFBUTtJQUNSLDBEQUFVO0lBQ1YsMERBQVU7QUFDZCxDQUFDLEVBZFcsV0FBVyxLQUFYLFdBQVcsUUFjdEI7QUFlRCxJQUFJLGdCQUFnQixHQUFnQjtJQUNoQyxJQUFJLEVBQUUsR0FBRztJQUNULEtBQUssRUFBRSwyQ0FBVSxDQUFDLE1BQU07SUFDeEIsUUFBUSxFQUFFLDJDQUFVLENBQUMsU0FBUztJQUM5QixjQUFjLEVBQUUsS0FBSztJQUNyQixhQUFhLEVBQUUsS0FBSztJQUNwQixhQUFhLEVBQUUsS0FBSztJQUNwQixRQUFRLEVBQUUsS0FBSztJQUNmLFdBQVcsRUFBRSxLQUFLO0NBQ3JCO0FBT0QsSUFBSSxtQkFBbUIsR0FBa0I7SUFDckMsTUFBTSxFQUFFO1FBQ0osSUFBSSxFQUFFLEdBQUc7UUFDVCxLQUFLLEVBQUUsMkNBQVUsQ0FBQyxNQUFNO1FBQ3hCLFFBQVEsRUFBRSwyQ0FBVSxDQUFDLFNBQVM7UUFDOUIsaUNBQWlDO1FBQ2pDLGFBQWEsRUFBRSxJQUFJO1FBQ25CLGNBQWMsRUFBRSxJQUFJO1FBQ3BCLGFBQWEsRUFBRSxJQUFJO0tBQ3RCO0lBQ0QsYUFBYSxFQUFFO1FBQ1gsSUFBSSxFQUFFLDZDQUFZLENBQUMsZ0JBQWdCO1FBQ25DLEtBQUssRUFBRSwyQ0FBVSxDQUFDLGdCQUFnQjtRQUNsQyxRQUFRLEVBQUUsMkNBQVUsQ0FBQyxTQUFTO1FBQzlC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R0FBRyxHQUFHLEVBQUU7UUFDVCxFQUFFLENBQUMsWUFBWSxDQUFDLE9BQU8sQ0FBQyxZQUFZLEVBQUUsRUFBRSxLQUFLLEVBQUUsQ0FBQyxFQUFFLENBQUM7UUFDbkQscUJBQXFCO0lBQ3pCLENBQUM7SUFFRCxNQUFNLENBQUMsQ0FBQztBQUNaLENBQUMiLCJmaWxlIjoiLi9zcmMvZ3JpZF90aGluZ3MvZGVmaW5pdGlvbnMudHMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBST1QgZnJvbSAncm90LWpzJ1xyXG5pbXBvcnQgKiBhcyBCcmV3IGZyb20gXCIuLi9icmV3XCJcclxuaW1wb3J0IHsgQWJvdmUgfSBmcm9tICcuL2Fib3ZlJ1xyXG5pbXBvcnQgeyBGZWF0dXJlIH0gZnJvbSAnLi9mZWF0dXJlcydcclxuaW1wb3J0IHsgSXRlbSB9IGZyb20gJy4vaXRlbSdcclxuaW1wb3J0IHsgTW9uc3RlciB9IGZyb20gJy4vbW9uc3RlcidcclxuaW1wb3J0IHsgVGVycmFpbiB9IGZyb20gJy4vdGVycmFpbidcclxuXHJcbmV4cG9ydCBlbnVtIFRlcnJhaW5UeXBlIHtcclxuICAgIFJvY2ssXHJcbiAgICBCcm9rZW5fV2FsbCxcclxuICAgIFNhbmQsXHJcbiAgICBHcmFzcyxcclxuICAgIFJ1YmJsZSxcclxuICAgIENoYXNtLFxyXG4gICAgSGlnaGxpZ2h0LFxyXG4gICAgTGV2ZWxDaGVja1BvaW50LFxyXG4gICAgVXBTdGFpcnMsXHJcbiAgICBEb29yLFxyXG4gICAgRG9vck9wZW4sXHJcbiAgICBEb29yQnJva2VuLFxyXG4gICAgV2FycEJlYWNvbixcclxufVxyXG5cclxuaW50ZXJmYWNlIFRlcnJhaW5EZWYge1xyXG4gICAgY29kZT86IHN0cmluZ1xyXG4gICAgY29sb3I/OiBudW1iZXJbXVxyXG4gICAgcmFuZG9taXplX2NvbG9yPzogbnVtYmVyW11cclxuICAgIGJnX2NvbG9yPzogbnVtYmVyW11cclxuICAgIHJhbmRvbWl6ZV9iZ2NvbG9yPzogbnVtYmVyW11cclxuICAgIGJsb2Nrc193YWxraW5nPzogYm9vbGVhblxyXG4gICAgYmxvY2tzX3Zpc2lvbj86IGJvb2xlYW5cclxuICAgIGJsb2Nrc19mbHlpbmc/OiBib29sZWFuXHJcbiAgICBpc19zb2xpZD86IGJvb2xlYW5cclxuICAgIGFsd2F5c09uVG9wPzogYm9vbGVhblxyXG59XHJcblxyXG5sZXQgdGVycmFpbl9kZWZhdWx0cyA6IFRlcnJhaW5EZWYgPSB7XHJcbiAgICBjb2RlOiBcIiBcIixcclxuICAgIGNvbG9yOiBCcmV3LkNvbG9yLm5vcm1hbCxcclxuICAgIGJnX2NvbG9yOiBCcmV3LkNvbG9yLmRhcmtfZ3JheSxcclxuICAgIGJsb2Nrc193YWxraW5nOiBmYWxzZSxcclxuICAgIGJsb2Nrc192aXNpb246IGZhbHNlLFxyXG4gICAgYmxvY2tzX2ZseWluZzogZmFsc2UsXHJcbiAgICBpc19zb2xpZDogZmFsc2UsXHJcbiAgICBhbHdheXNPblRvcDogZmFsc2UsXHJcbn1cclxuXHJcbi8vIFtrZXk6IG51bWJlcl06IFRcclxuaW50ZXJmYWNlIElUZXJyYWluRGVmcyB7XHJcbiAgICBbZGVmX25hbWU6IHN0cmluZ10gOiBUZXJyYWluRGVmIFxyXG59IFxyXG5cclxubGV0IHRlcnJhaW5fZGVmaW5pdGlvbnMgOiBJVGVycmFpbkRlZnMgPSB7XHJcbiAgICBcIlJvY2tcIjoge1xyXG4gICAgICAgIGNvZGU6IFwiI1wiLFxyXG4gICAgICAgIGNvbG9yOiBCcmV3LkNvbG9yLm5vcm1hbCxcclxuICAgICAgICBiZ19jb2xvcjogQnJldy5Db2xvci5kYXJrX2dyYXksXHJcbiAgICAgICAgLy8gcmFuZG9taXplX2JnY29sb3I6IFswLCAwLCAxMF0sXHJcbiAgICAgICAgYmxvY2tzX3Zpc2lvbjogdHJ1ZSxcclxuICAgICAgICBibG9ja3Nfd2Fsa2luZzogdHJ1ZSxcclxuICAgICAgICBibG9ja3NfZmx5aW5nOiB0cnVlXHJcbiAgICB9LFxyXG4gICAgXCJCcm9rZW5fV2FsbFwiOiB7XHJcbiAgICAgICAgY29kZTogQnJldy5TeW1ib2xzLmhhbGZfYmxvY2tfbG93ZXIsXHJcbiAgICAgICAgY29sb3I6IEJyZXcuQ29sb3IubGlnaHRfc2xhdGVfZ3JheSxcclxuICAgICAgICBiZ19jb2xvcjogQnJldy5Db2xvci5kYXJrX2dyYXksXHJcbiAgICAgICAgLy8gcmFuZG9taXplX2JnY29sb3I6IFswLCAwLCAxMF0sXHJcbiAgICAgICAgYmxvY2tzX3Zpc2lvbjogZmFsc2UsXHJcbiAgICAgICAgYmxvY2tzX3dhbGtpbmc6IHRydWUsXHJcbiAgICAgICAgYmxvY2tzX2ZseWluZzogdHJ1ZVxyXG4gICAgfSxcclxuICAgIFwiU2FuZFwiOiAge1xyXG4gICAgICAgIGNvZGU6IFwiLlwiLFxyXG4gICAgICAgIGNvbG9yOiBCcmV3LkNvbG9yLnByaW1hcnlfc2hhZGVfMixcclxuICAgICAgICBiZ19jb2xvcjogQnJldy5Db2xvci5kYXJrX2dyYXksXHJcbiAgICAgICAgLy8gcmFuZG9taXplX2JnY29sb3I6IFswLCAwLCAxMF0sXHJcbiAgICAgICAgYmxvY2tzX3Zpc2lvbjogZmFsc2UsIFxyXG4gICAgICAgIGJsb2Nrc193YWxraW5nOiBmYWxzZSxcclxuICAgICAgICBibG9ja3NfZmx5aW5nOiBmYWxzZVxyXG4gICAgfSxcclxuICAgIFwiR3Jhc3NcIjogIHtcclxuICAgICAgICBjb2RlOiAnXCInLFxyXG4gICAgICAgIGNvbG9yOiBCcmV3LkNvbG9yLnNlY29uZGFyeV9ncmVlbl9zaGFkZV8yLFxyXG4gICAgICAgIGJnX2NvbG9yOiBCcmV3LkNvbG9yLmRhcmtfZ3JheSxcclxuICAgICAgICAvLyByYW5kb21pemVfYmdjb2xvcjogWzAsIDAsIDEwXSxcclxuICAgICAgICBibG9ja3NfdmlzaW9uOiBmYWxzZSwgXHJcbiAgICAgICAgYmxvY2tzX3dhbGtpbmc6IGZhbHNlLFxyXG4gICAgICAgIGJsb2Nrc19mbHlpbmc6IGZhbHNlXHJcbiAgICB9LFxyXG4gICAgXCJSdWJibGVcIjogIHtcclxuICAgICAgICBjb2RlOiBcIixcIixcclxuICAgICAgICBjb2xvcjogQnJldy5Db2xvci5wcmltYXJ5X3NoYWRlXzAsXHJcbiAgICAgICAgYmdfY29sb3I6IEJyZXcuQ29sb3IuZGFya19ncmF5LFxyXG4gICAgICAgIC8vIHJhbmRvbWl6ZV9iZ2NvbG9yOiBbMCwgMCwgMTBdLFxyXG4gICAgICAgIGJsb2Nrc192aXNpb246IGZhbHNlLCBcclxuICAgICAgICBibG9ja3Nfd2Fsa2luZzogZmFsc2UsXHJcbiAgICAgICAgYmxvY2tzX2ZseWluZzogZmFsc2VcclxuICAgIH0sXHJcbiAgICBcIkNoYXNtXCI6ICB7XHJcbiAgICAgICAgY29kZTogXCI6XCIsXHJcbiAgICAgICAgY29sb3I6IEJyZXcuQ29sb3IubGlnaHRfc2xhdGVfZ3JheSxcclxuICAgICAgICBiZ19jb2xvcjogQnJldy5Db2xvci5taWRuaWdodF9ibHVlLFxyXG4gICAgICAgIGJsb2Nrc192aXNpb246IGZhbHNlLFxyXG4gICAgICAgIGJsb2Nrc193YWxraW5nOiB0cnVlLFxyXG4gICAgICAgIGJsb2Nrc19mbHlpbmc6IGZhbHNlXHJcbiAgICB9LFxyXG4gICAgXCJIaWdobGlnaHRcIjoge1xyXG4gICAgICAgIGNvZGU6IFwiIFwiXHJcbiAgICB9LFxyXG4gICAgXCJMZXZlbENoZWNrUG9pbnRcIjogIHtcclxuICAgICAgICBjb2RlOiBcIlhcIixcclxuICAgICAgICBjb2xvcjogQnJldy5Db2xvci5yZWQsXHJcbiAgICAgICAgYmxvY2tzX3Zpc2lvbjogZmFsc2UsIFxyXG4gICAgICAgIGJsb2Nrc193YWxraW5nOiBmYWxzZSxcclxuICAgICAgICBibG9ja3NfZmx5aW5nOiBmYWxzZVxyXG4gICAgfSxcclxuICAgIFwiVXBTdGFpcnNcIjogIHtcclxuICAgICAgICBjb2RlOiBcIjxcIixcclxuICAgICAgICBibG9ja3NfdmlzaW9uOiBmYWxzZSwgXHJcbiAgICAgICAgYmxvY2tzX3dhbGtpbmc6IGZhbHNlLFxyXG4gICAgICAgIGJsb2Nrc19mbHlpbmc6IGZhbHNlXHJcbiAgICB9LFxyXG4gICAgXCJEb29yXCI6IHtcclxuICAgICAgICBjb2RlOiBcIitcIixcclxuICAgICAgICBjb2xvcjogQnJldy5Db2xvci55ZWxsb3csXHJcbiAgICAgICAgYmxvY2tzX3Zpc2lvbjogdHJ1ZSxcclxuICAgICAgICBibG9ja3Nfd2Fsa2luZzogZmFsc2UsXHJcbiAgICAgICAgYmxvY2tzX2ZseWluZzogZmFsc2UsXHJcbiAgICAgICAgYWx3YXlzT25Ub3A6IHRydWUsXHJcbiAgICAgICAgaXNfc29saWQ6IHRydWUsXHJcbiAgICB9LFxyXG4gICAgXCJEb29yT3BlblwiOiB7XHJcbiAgICAgICAgY29kZTogXCItXCIsXHJcbiAgICAgICAgYmxvY2tzX3Zpc2lvbjogZmFsc2UsXHJcbiAgICAgICAgYmxvY2tzX3dhbGtpbmc6IGZhbHNlLFxyXG4gICAgICAgIGJsb2Nrc19mbHlpbmc6IGZhbHNlLFxyXG4gICAgICAgIGFsd2F5c09uVG9wOiB0cnVlLFxyXG4gICAgfSxcclxuICAgIFwiRG9vckJyb2tlblwiOiB7XHJcbiAgICAgICAgY29kZTogXCIvXCIsXHJcbiAgICAgICAgYmxvY2tzX3Zpc2lvbjogZmFsc2UsXHJcbiAgICAgICAgYmxvY2tzX3dhbGtpbmc6IGZhbHNlLFxyXG4gICAgICAgIGJsb2Nrc19mbHlpbmc6IGZhbHNlLFxyXG4gICAgICAgIGFsd2F5c09uVG9wOiB0cnVlLFxyXG4gICAgfSxcclxuICAgIFwiV2FycEJlYWNvblwiOiB7XHJcbiAgICAgICAgY29kZTogQnJldy5TeW1ib2xzLnF1YWRfZGlhbW9uZCxcclxuICAgICAgICBibG9ja3NfdmlzaW9uOiBmYWxzZSxcclxuICAgICAgICBibG9ja3Nfd2Fsa2luZzogZmFsc2UsXHJcbiAgICAgICAgYmxvY2tzX2ZseWluZzogZmFsc2UsXHJcbiAgICAgICAgYWx3YXlzT25Ub3A6IHRydWUsXHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiB0ZXJyYWluRmFjdG9yeSh0ZXJyYWluX3R5cGUgOiBUZXJyYWluVHlwZSwgb3B0aW9ucyA6IFRlcnJhaW5EZWYgPSB7fSkgOiBUZXJyYWluIHtcclxuICAgIGxldCB0IDogVGVycmFpbiA9IG5ldyBUZXJyYWluKHRlcnJhaW5fdHlwZSlcclxuICAgIFxyXG4gICAgLy8gYnVpbGQgdXAgZGVmaW5pdGlvbiB3aXRoIDMgbGF5ZXJzOiBkZWZhdWx0LCBnaXZlbiBkZWYsIG9wdGlvbnNcclxuICAgIC8vIDEuIGRlZmF1bHRcclxuICAgIGxldCBkZWYgOiBUZXJyYWluRGVmID0gQnJldy5VdGlscy5jbG9uZSh0ZXJyYWluX2RlZmF1bHRzKVxyXG4gICAgXHJcbiAgICAvLyAyLiBnaXZlbiBkZWZpbml0aW9uXHJcbiAgICBsZXQgdHlwZV9uYW1lID0gVGVycmFpblR5cGVbdGVycmFpbl90eXBlXVxyXG4gICAgbGV0IHR5cGVfZGVmID0gdGVycmFpbl9kZWZpbml0aW9uc1t0eXBlX25hbWVdXHJcbiAgICBmb3IgKGxldCBwcm9wIGluIHR5cGVfZGVmKSB7XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2coXCJ0eXBlZGVmXCIsIHByb3AsIHR5cGVfZGVmW3Byb3BdKVxyXG4gICAgICAgIGRlZltwcm9wXSA9IHR5cGVfZGVmW3Byb3BdXHJcbiAgICB9IFxyXG4gICAgXHJcbiAgICAvLyAzLiBvcHRpb25zXHJcbiAgICBmb3IgKGxldCBwcm9wIGluIG9wdGlvbnMpIHtcclxuICAgICAgICAvLyBjb25zb2xlLmxvZyhcIm9wdGlvbnNcIiwgcHJvcCwgb3B0aW9uc1twcm9wXSlcclxuICAgICAgICBkZWZbcHJvcF0gPSBvcHRpb25zW3Byb3BdXHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIDQuIHNldCBhbGwgcHJvcGVydGllc1xyXG4gICAgZm9yIChsZXQgcHJvcCBpbiBkZWYpIHtcclxuICAgICAgICBpZiAocHJvcC5zdGFydHNXaXRoKFwicmFuZG9taXplX1wiKSkge1xyXG4gICAgICAgICAgICBjb250aW51ZVxyXG4gICAgICAgIH1cclxuICAgICAgICB0W3Byb3BdID0gZGVmW3Byb3BdXHJcbiAgICB9XHJcblxyXG4gICAgLy90ZXJyYWluIGRvbnQgaGF2ZSBmbGFncyB5ZXQgXHJcbiAgICAvL3QuZmxhZ3MgPSBbXS5jb25jYXQoZGVmLmZsYWdzKS5jb25jYXQob3B0aW9ucy5mbGFncylcclxuXHJcbiAgICAvLyA1LiByYW5kb21pemVcclxuICAgIGxldCByYW5kb21fcmdiOiBudW1iZXJbXVxyXG4gICAgaWYgKGRlZi5yYW5kb21pemVfY29sb3IpIHtcclxuICAgICAgICByYW5kb21fcmdiID0gZGVmLnJhbmRvbWl6ZV9jb2xvci5tYXAoKGM6IG51bWJlciwgaW5kZXg6IG51bWJlcikgPT4ge1xyXG4gICAgICAgICAgICByZXR1cm4gZGVmLmNvbG9yW2luZGV4XSArIFJPVC5STkcuZ2V0Tm9ybWFsKDAsIGMpXHJcbiAgICAgICAgfSlcclxuICAgICAgICB0LmNvbG9yID0gQnJldy5VdGlscy5zYWZlX2NvbG9yKHJhbmRvbV9yZ2IpXHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGRlZi5yYW5kb21pemVfYmdjb2xvcikge1xyXG4gICAgICAgIHJhbmRvbV9yZ2IgPSBkZWYucmFuZG9taXplX2JnY29sb3IubWFwKChjOiBudW1iZXIsIGluZGV4OiBudW1iZXIpID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuIGRlZi5iZ19jb2xvcltpbmRleF0gKyBST1QuUk5HLmdldE5vcm1hbCgwLCBjKVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgdC5iZ19jb2xvciA9IEJyZXcuVXRpbHMuc2FmZV9jb2xvcihyYW5kb21fcmdiKVxyXG4gICAgfVxyXG5cclxuICAgIFxyXG4gICAgcmV0dXJuIHRcclxufVxyXG5cclxuXHJcbmV4cG9ydCBlbnVtIEFib3ZlVHlwZSB7XHJcbiAgICBTbW9rZSA9IDEsXHJcbiAgICBQcm9qZWN0aWxlLFxyXG4gICAgRmxhc2hcclxufVxyXG5cclxuaW50ZXJmYWNlIEFib3ZlRGVmIHtcclxuICAgIGNvZGU/OiBzdHJpbmdcclxuICAgIGNvbG9yPzogbnVtYmVyW11cclxufVxyXG5cclxubGV0IGFib3ZlX2RlZmF1bHRzIDogQWJvdmVEZWYgPSB7XHJcbiAgICBjb2RlOiBcIj9cIixcclxuICAgIGNvbG9yOiBCcmV3LkNvbG9yLmJsYWNrXHJcbn1cclxuXHJcbi8vIFtrZXk6IG51bWJlcl06IFRcclxuaW50ZXJmYWNlIElBYm92ZURlZnMge1xyXG4gICAgW2RlZl9uYW1lOiBzdHJpbmddIDogQWJvdmVEZWYgXHJcbn0gXHJcblxyXG5sZXQgYWJvdmVfZGVmaW5pdGlvbnMgIDogSUFib3ZlRGVmcyA9IHtcclxuICAgIFwiU21va2VcIjoge1xyXG4gICAgICAgIGNvZGU6IFwiXlwiLFxyXG4gICAgICAgIGNvbG9yOiBCcmV3LkNvbG9yLnJlZFxyXG4gICAgfSxcclxuICAgIFwiUHJvamVjdGlsZVwiOiB7XHJcbiAgICAgICAgY29kZTogXCIqXCIsXHJcbiAgICAgICAgY29sb3I6IEJyZXcuQ29sb3IuYmxhY2tcclxuICAgIH0sXHJcbiAgICBcIkZsYXNoXCI6IHtcclxuICAgICAgICBjb2RlOiBcIlxcdTI1ODhcIiwgLy9cIiNcIixcclxuICAgICAgICBjb2xvcjogQnJldy5Db2xvci5ibHVlXHJcbiAgICB9LFxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gYWJvdmVGYWN0b3J5KGFib3ZlX3R5cGUgOiBBYm92ZVR5cGUsIG9wdGlvbnMgOiBBYm92ZURlZiA9IHt9KSA6IEFib3ZlIHtcclxuICAgIGxldCBhIDogQWJvdmUgPSBuZXcgQWJvdmUoYWJvdmVfdHlwZSlcclxuICAgIFxyXG4gICAgLy8gYnVpbGQgdXAgZGVmaW5pdGlvbiB3aXRoIDMgbGF5ZXJzOiBkZWZhdWx0LCBnaXZlbiBkZWYsIG9wdGlvbnNcclxuICAgIC8vIDEuIGRlZmF1bHRcclxuICAgIGxldCBkZWYgOiBBYm92ZURlZiA9IEJyZXcuVXRpbHMuY2xvbmUoYWJvdmVfZGVmYXVsdHMpXHJcbiAgICBcclxuICAgIC8vIDIuIGdpdmVuIGRlZmluaXRpb25cclxuICAgIGxldCB0eXBlX25hbWUgPSBBYm92ZVR5cGVbYWJvdmVfdHlwZV1cclxuICAgIGxldCB0eXBlX2RlZiA9IGFib3ZlX2RlZmluaXRpb25zW3R5cGVfbmFtZV1cclxuICAgIGZvciAobGV0IHByb3AgaW4gdHlwZV9kZWYpIHtcclxuICAgICAgICAvLyBjb25zb2xlLmxvZyhcInR5cGVkZWZcIiwgcHJvcCwgdHlwZV9kZWZbcHJvcF0pXHJcbiAgICAgICAgZGVmW3Byb3BdID0gdHlwZV9kZWZbcHJvcF1cclxuICAgIH0gXHJcbiAgICBcclxuICAgIC8vIDMuIG9wdGlvbnNcclxuICAgIGZvciAobGV0IHByb3AgaW4gb3B0aW9ucykge1xyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKFwib3B0aW9uc1wiLCBwcm9wLCBvcHRpb25zW3Byb3BdKVxyXG4gICAgICAgIGRlZltwcm9wXSA9IG9wdGlvbnNbcHJvcF1cclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gNC4gc2V0IGFsbCBwcm9wZXJ0aWVzXHJcbiAgICBmb3IgKGxldCBwcm9wIGluIGRlZikge1xyXG4gICAgICAgIGFbcHJvcF0gPSBkZWZbcHJvcF1cclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuIGFcclxufVxyXG5cclxuZXhwb3J0IGVudW0gRmVhdHVyZVR5cGUge1xyXG4gICAgUmVwYWlyR29vLFxyXG4gICAgQ29ycm9zaXZlQWNpZCxcclxuICAgIFByb3RlY3RpdmVHb28sXHJcbiAgICAvLyBSb2NrcyxcclxuICAgIFNjcmFwLFxyXG4gICAgRmlyZSxcclxuICAgIFRhbmtQYXJ0LFxyXG4gICAgLy8gVGFua1RyZWFkLFxyXG4gICAgLy8gVGFua1R1cnJldCxcclxuICAgIC8vIFRhbmtIZWxtLFxyXG4gICAgLy8gUmFkaWF0aW9uLFxyXG59XHJcblxyXG5pbnRlcmZhY2UgRmVhdHVyZURlZiB7XHJcbiAgICBjb2RlPzogc3RyaW5nXHJcbiAgICBjb2xvcj86IG51bWJlcltdXHJcbiAgICAvLyBiZ19jb2xvcj86IG51bWJlcltdXHJcbiAgICByYW5kb21pemVfY29kZT86IHN0cmluZ1tdXHJcbiAgICBmbGFncz86IEFycmF5PEJyZXcuRW51bXMuRmxhZz4sXHJcbn1cclxuXHJcbmxldCBmZWF0dXJlX2RlZmF1bHRzIDogRmVhdHVyZURlZiA9IHtcclxuICAgIGNvZGU6IEJyZXcuU3ltYm9scy5mb3VyZG90cyxcclxuICAgIGNvbG9yOiBCcmV3LkNvbG9yLmJsYWNrLFxyXG4gICAgcmFuZG9taXplX2NvZGU6IFtdLFxyXG4gICAgZmxhZ3M6IFtdLFxyXG59XHJcblxyXG4vLyBba2V5OiBudW1iZXJdOiBUXHJcbmludGVyZmFjZSBJRmVhdHVyZURlZnMge1xyXG4gICAgW2RlZl9uYW1lOiBzdHJpbmddIDogRmVhdHVyZURlZiBcclxufSBcclxuXHJcbmxldCBmZWF0dXJlX2RlZmluaXRpb25zICA6IElGZWF0dXJlRGVmcyA9IHtcclxuICAgIFwiRmlyZVwiOiB7XHJcbiAgICAgICAgY29kZTogJ14nLFxyXG4gICAgICAgIGNvbG9yOiBCcmV3LkNvbG9yLm9yYW5nZSxcclxuICAgIH0sXHJcbiAgICBcIlNjcmFwXCI6IHtcclxuICAgICAgICBjb2RlOiAnLCcsXHJcbiAgICAgICAgcmFuZG9taXplX2NvZGU6IFtcIlxcdTI1NzRcIiwgXCJcXHUyNTc1XCIsIFwiXFx1MjU3NlwiLCBcIlxcdTI1NzdcIl0sLy9bJywnLCAnKicsICd7JywgJ30nLCAnYCddLFxyXG4gICAgICAgIGNvbG9yOiBudWxsXHJcbiAgICB9LFxyXG4gICAgXCJUYW5rUGFydFwiOiB7XHJcbiAgICAgICAgY29kZTogXCJ4XCIsXHJcbiAgICAgICAgY29sb3I6IEJyZXcuQ29sb3IuaGVyb19ibHVlLFxyXG4gICAgfSxcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGZlYXR1cmVGYWN0b3J5KGZlYXR1cmVfdHlwZSA6IEZlYXR1cmVUeXBlLCBvcHRpb25zIDogRmVhdHVyZURlZiA9IHt9KSA6IEZlYXR1cmUge1xyXG4gICAgbGV0IGYgOiBGZWF0dXJlID0gbmV3IEZlYXR1cmUoZmVhdHVyZV90eXBlKVxyXG4gICAgXHJcbiAgICAvLyBidWlsZCB1cCBkZWZpbml0aW9uIHdpdGggMyBsYXllcnM6IGRlZmF1bHQsIGdpdmVuIGRlZiwgb3B0aW9uc1xyXG4gICAgLy8gMS4gZGVmYXVsdFxyXG4gICAgbGV0IGRlZiA6IEZlYXR1cmVEZWYgPSBCcmV3LlV0aWxzLmNsb25lKGZlYXR1cmVfZGVmYXVsdHMpXHJcbiAgICBcclxuICAgIC8vIDIuIGdpdmVuIGRlZmluaXRpb25cclxuICAgIGxldCB0eXBlX25hbWUgPSBGZWF0dXJlVHlwZVtmZWF0dXJlX3R5cGVdXHJcbiAgICBsZXQgdHlwZV9kZWYgPSBmZWF0dXJlX2RlZmluaXRpb25zW3R5cGVfbmFtZV1cclxuICAgIGZvciAobGV0IHByb3AgaW4gdHlwZV9kZWYpIHtcclxuICAgICAgICAvLyBjb25zb2xlLmxvZyhcInR5cGVkZWZcIiwgcHJvcCwgdHlwZV9kZWZbcHJvcF0pXHJcbiAgICAgICAgZGVmW3Byb3BdID0gdHlwZV9kZWZbcHJvcF1cclxuICAgIH0gXHJcbiAgICBcclxuICAgIC8vIDMuIG9wdGlvbnNcclxuICAgIGZvciAobGV0IHByb3AgaW4gb3B0aW9ucykge1xyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKFwib3B0aW9uc1wiLCBwcm9wLCBvcHRpb25zW3Byb3BdKVxyXG4gICAgICAgIGRlZltwcm9wXSA9IG9wdGlvbnNbcHJvcF1cclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gNC4gc2V0IGFsbCBwcm9wZXJ0aWVzXHJcbiAgICBmb3IgKGxldCBwcm9wIGluIGRlZikge1xyXG4gICAgICAgIGlmIChwcm9wLnN0YXJ0c1dpdGgoXCJyYW5kb21pemVfXCIpKSB7XHJcbiAgICAgICAgICAgIGNvbnRpbnVlXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZbcHJvcF0gPSBkZWZbcHJvcF1cclxuICAgIH1cclxuICAgIFxyXG4gICAgZi5mbGFncyA9IFtdLmNvbmNhdChkZWYuZmxhZ3MpLmNvbmNhdChvcHRpb25zLmZsYWdzKVxyXG5cclxuICAgIC8vIDUuIHJhbmRvbWl6ZVxyXG4gICAgaWYgKGRlZi5yYW5kb21pemVfY29kZS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgbGV0IGMgPSBCcmV3LlV0aWxzLnJhbmRvbU9mKGRlZi5yYW5kb21pemVfY29kZSlcclxuICAgICAgICBmLmNvZGUgPSBjXHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGZcclxufVxyXG5cclxuZXhwb3J0IGVudW0gSXRlbVR5cGUge1xyXG4gICAgR3JlbmFkZSxcclxuICAgIE5hbm90ZWNoLFxyXG4gICAgLy8gU3VpdE1vZHVsZSxcclxuICAgIC8vIFdhcnBDcnlzdGFsLFxyXG4gICAgLy8gS2V5Q2FyZCxcclxuICAgIFBvd2VyUmVsYXRlZEl0ZW0sXHJcbiAgICBQb3dlclN5c3RlbSxcclxuICAgIC8vIFdyZWNrYWdlLFxyXG4gICAgLy8gTWFjR3VmZmluLFxyXG4gICAgQ2l2aWxpYW4sXHJcbiAgICBTdXBwbGllcyxcclxuICAgIEJ1bGxldHMsXHJcbiAgICBTaGVsbHMsXHJcbn1cclxuXHJcbmV4cG9ydCBlbnVtIEl0ZW1TdWJ0eXBlIHtcclxuICAgIE5vblNwZWNpZmljLFxyXG4gICAgUG93ZXJJdGVtX0F4ZSxcclxuICAgIFBvd2VySXRlbV9HdW4sXHJcbiAgICBHX0V4cGxvc2l2ZSxcclxuICAgIEdfQ29uY3VzaXZlLFxyXG4gICAgR19TdHVuLFxyXG4gICAgTl9BY2lkLFxyXG4gICAgLy8gTl9CYXJyaWVyLFxyXG4gICAgLy8gTl9NaWdodCxcclxuICAgIE5fSGVhbHRoLFxyXG4gICAgTl9Bcm1vcixcclxuICAgIC8vIE5fU3RpY2t5LFxyXG59XHJcblxyXG5pbnRlcmZhY2UgSXRlbURlZiB7XHJcbiAgICBjb2RlPzogc3RyaW5nXHJcbiAgICBjb2xvcj86IG51bWJlcltdXHJcbiAgICBzdWJ0eXBlPzogSXRlbVN1YnR5cGVcclxuXHJcbiAgICBwb3dlcj86IEJyZXcuUG93ZXJzLlBvd2VyXHJcbiAgICBjYW5QaWNrdXA/OiBib29sZWFuXHJcbiAgICBjYW5Vc2U/OiBib29sZWFuXHJcbiAgICBjYW5IZWF2ZT86IGJvb2xlYW5cclxuICAgIGRhbWFnZT86IG51bWJlclxyXG4gICAgZmxhZ3M/OiBBcnJheTxCcmV3LkVudW1zLkZsYWc+XHJcbn1cclxuXHJcbmxldCBpdGVtX2RlZmF1bHRzIDogSXRlbURlZiA9IHtcclxuICAgIGNvZGU6IFwiP1wiLFxyXG4gICAgY29sb3I6IEJyZXcuQ29sb3IuYmxhY2ssXHJcbiAgICBzdWJ0eXBlOiBJdGVtU3VidHlwZS5Ob25TcGVjaWZpYyxcclxuICAgIGNhblBpY2t1cDogdHJ1ZSxcclxuICAgIGNhblVzZTogdHJ1ZSxcclxuICAgIGNhbkhlYXZlOiBmYWxzZSxcclxuICAgIGRhbWFnZTogMCxcclxuICAgIGZsYWdzOiBbXSxcclxufVxyXG5cclxuLy8gW2tleTogbnVtYmVyXTogVFxyXG5pbnRlcmZhY2UgSUl0ZW1EZWZzIHtcclxuICAgIFtkZWZfbmFtZTogc3RyaW5nXSA6IEl0ZW1EZWYgXHJcbn0gXHJcblxyXG5sZXQgaXRlbV9kZWZpbml0aW9ucyAgOiBJSXRlbURlZnMgPSB7XHJcbiAgICBcIlBvd2VyUmVsYXRlZEl0ZW1cIjoge1xyXG4gICAgICAgIGNvZGU6IEJyZXcuU3ltYm9scy5hcnJvd191cCxcclxuICAgICAgICBjb2xvcjogQnJldy5Db2xvci5wb3dlcl9heGUsXHJcbiAgICAgICAgY2FuUGlja3VwOiBmYWxzZSxcclxuICAgICAgICBjYW5Vc2U6IGZhbHNlLFxyXG4gICAgfSxcclxuICAgIFwiUG93ZXJTeXN0ZW1cIjoge1xyXG4gICAgICAgIGNvZGU6IEJyZXcuU3ltYm9scy5wb3dlcl9zeXMsXHJcbiAgICAgICAgY29sb3I6IEJyZXcuQ29sb3Iub3JhbmdlLFxyXG4gICAgICAgIGNhblBpY2t1cDogZmFsc2UsXHJcbiAgICAgICAgY2FuVXNlOiBmYWxzZSxcclxuICAgIH0sXHJcbiAgICBcIkdyZW5hZGVcIjoge1xyXG4gICAgICAgIGNvZGU6ICchJyxcclxuICAgICAgICBjb2xvcjogQnJldy5Db2xvci5nb2xkZW5yb2QsXHJcbiAgICB9LFxyXG4gICAgXCJOYW5vdGVjaENvcmVcIjoge1xyXG4gICAgICAgIGNvZGU6ICc9JywgXHJcbiAgICAgICAgY29sb3I6IEJyZXcuQ29sb3IuZ29sZGVucm9kLFxyXG4gICAgfSxcclxuICAgIC8vIFwiU3VpdE1vZHVsZVwiOiB7XHJcbiAgICAvLyAgICAgY29kZTogJz8nLFxyXG4gICAgLy8gICAgIGNvbG9yOiBCcmV3LkNvbG9yLmdvbGRlbnJvZCxcclxuICAgIC8vIH0sXHJcbiAgICAvLyBcIldhcnBDcnlzdGFsXCI6IHtcclxuICAgIC8vICAgICBjb2RlOiBCcmV3LlN5bWJvbHMuZGlhbW9uZF9mdWxsLFxyXG4gICAgLy8gICAgIGNvbG9yOiBCcmV3LkNvbG9yLmdvbGRlbnJvZCxcclxuICAgIC8vICAgICBjYW5Vc2U6IGZhbHNlLFxyXG4gICAgLy8gfSxcclxuICAgIC8vIFwiS2V5Q2FyZFwiOiB7XHJcbiAgICAvLyAgICAgY29kZTogJy0nLFxyXG4gICAgLy8gICAgIGNvbG9yOiBCcmV3LkNvbG9yLmdvbGRlbnJvZCxcclxuICAgIC8vICAgICBjYW5Vc2U6IGZhbHNlLFxyXG4gICAgLy8gfSxcclxuICAgIC8vIFwiV3JlY2thZ2VcIjoge1xyXG4gICAgLy8gICAgIGNvZGU6ICclJyxcclxuICAgIC8vICAgICBjb2xvcjogQnJldy5Db2xvci53aGl0ZSxcclxuICAgIC8vICAgICBjYW5Vc2U6IGZhbHNlLFxyXG4gICAgLy8gICAgIGNhblBpY2t1cDogZmFsc2UsXHJcbiAgICAvLyAgICAgY2FuSGVhdmU6IHRydWUsXHJcbiAgICAvLyB9LFxyXG4gICAgLy8gXCJNYWNHdWZmaW5cIjoge1xyXG4gICAgLy8gICAgIGNvZGU6ICcoJyxcclxuICAgIC8vICAgICBjb2xvcjogQnJldy5Db2xvci5nb2xkZW5yb2QsXHJcbiAgICAvLyAgICAgY2FuVXNlOiBmYWxzZSxcclxuICAgIC8vICAgICBjYW5QaWNrdXA6IHRydWUsXHJcbiAgICAvLyAgICAgY2FuSGVhdmU6IGZhbHNlLFxyXG4gICAgLy8gfVxyXG4gICAgXCJDaXZpbGlhblwiOiB7XHJcbiAgICAgICAgY29kZTogJ0AnLFxyXG4gICAgICAgIGNvbG9yOiBCcmV3LkNvbG9yLmdvbGRlbnJvZCxcclxuICAgICAgICBjYW5Vc2U6IGZhbHNlLFxyXG4gICAgICAgIGNhblBpY2t1cDogdHJ1ZSxcclxuICAgICAgICBjYW5IZWF2ZTogZmFsc2UsXHJcbiAgICB9LFxyXG4gICAgXCJTdXBwbGllc1wiOiB7XHJcbiAgICAgICAgY29kZTogJyUnLFxyXG4gICAgICAgIGNvbG9yOiBCcmV3LkNvbG9yLmdvbGRlbnJvZCxcclxuICAgICAgICBjYW5Vc2U6IGZhbHNlLFxyXG4gICAgICAgIGNhblBpY2t1cDogdHJ1ZSxcclxuICAgICAgICBjYW5IZWF2ZTogZmFsc2UsXHJcbiAgICB9LFxyXG4gICAgXCJCdWxsZXRzXCI6IHtcclxuICAgICAgICBjb2RlOiAnPScsXHJcbiAgICAgICAgY29sb3I6IEJyZXcuQ29sb3IuZ29sZGVucm9kLFxyXG4gICAgICAgIGNhblVzZTogZmFsc2UsXHJcbiAgICAgICAgY2FuUGlja3VwOiB0cnVlLFxyXG4gICAgICAgIGNhbkhlYXZlOiBmYWxzZSxcclxuICAgIH0sXHJcbiAgICBcIlNoZWxsc1wiOiB7XHJcbiAgICAgICAgY29kZTogQnJldy5TeW1ib2xzLnBvd2VyX3N5cyxcclxuICAgICAgICBjb2xvcjogQnJldy5Db2xvci5nb2xkZW5yb2QsXHJcbiAgICAgICAgY2FuVXNlOiBmYWxzZSxcclxuICAgICAgICBjYW5QaWNrdXA6IHRydWUsXHJcbiAgICAgICAgY2FuSGVhdmU6IGZhbHNlLFxyXG4gICAgfSxcclxufVxyXG5cclxuICAgIC8vICAgICBHcmVuYWRlLFxyXG4gICAgLy8gTmFub3RlY2gsXHJcbiAgICAvLyBTdWl0TW9kdWxlLFxyXG4gICAgLy8gV2FycENyeXN0YWwsXHJcbiAgICAvLyBLZXlDYXJkLFxyXG5leHBvcnQgZnVuY3Rpb24gaXRlbUZhY3RvcnkoaXRlbV90eXBlIDogSXRlbVR5cGUsIG9wdGlvbnMgOiBJdGVtRGVmID0ge30pIDogSXRlbSB7XHJcbiAgICBsZXQgaSA6IEl0ZW0gPSBuZXcgSXRlbShpdGVtX3R5cGUpXHJcbiAgICBcclxuICAgIC8vIGJ1aWxkIHVwIGRlZmluaXRpb24gd2l0aCAzIGxheWVyczogZGVmYXVsdCwgZ2l2ZW4gZGVmLCBvcHRpb25zXHJcbiAgICAvLyAxLiBkZWZhdWx0XHJcbiAgICBsZXQgZGVmIDogSXRlbURlZiA9IEJyZXcuVXRpbHMuY2xvbmUoaXRlbV9kZWZhdWx0cylcclxuICAgIFxyXG4gICAgLy8gMi4gZ2l2ZW4gZGVmaW5pdGlvblxyXG4gICAgbGV0IHR5cGVfbmFtZSA9IEl0ZW1UeXBlW2l0ZW1fdHlwZV1cclxuICAgIGxldCB0eXBlX2RlZiA9IGl0ZW1fZGVmaW5pdGlvbnNbdHlwZV9uYW1lXVxyXG4gICAgZm9yIChsZXQgcHJvcCBpbiB0eXBlX2RlZikge1xyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKFwidHlwZWRlZlwiLCBwcm9wLCB0eXBlX2RlZltwcm9wXSlcclxuICAgICAgICBkZWZbcHJvcF0gPSB0eXBlX2RlZltwcm9wXVxyXG4gICAgfSBcclxuICAgIFxyXG4gICAgLy8gMy4gb3B0aW9uc1xyXG4gICAgZm9yIChsZXQgcHJvcCBpbiBvcHRpb25zKSB7XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2coXCJvcHRpb25zXCIsIHByb3AsIG9wdGlvbnNbcHJvcF0pXHJcbiAgICAgICAgZGVmW3Byb3BdID0gb3B0aW9uc1twcm9wXVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyA0LiBzZXQgYWxsIHByb3BlcnRpZXNcclxuICAgIGZvciAobGV0IHByb3AgaW4gZGVmKSB7XHJcbiAgICAgICAgaVtwcm9wXSA9IGRlZltwcm9wXVxyXG4gICAgfVxyXG5cclxuICAgIFxyXG4gICAgaS5mbGFncyA9IFtdLmNvbmNhdChkZWYuZmxhZ3MpLmNvbmNhdChvcHRpb25zLmZsYWdzKVxyXG5cclxuICAgIHJldHVybiBpXHJcbn1cclxuXHJcblxyXG5leHBvcnQgZW51bSBNb25zdGVyVHlwZSB7XHJcbiAgICBIZXJvLFxyXG4gICAgQXJjaGl0ZWN0LFxyXG4gICAgTWVyY2VuYXJ5LFxyXG4gICAgU29sZGllcixcclxuICAgIEdyZW5hZGllcixcclxuICAgIEplZXAsXHJcbn1cclxuXHJcbmludGVyZmFjZSBNb25zdGVyRGVmICB7XHJcbiAgICBjb2RlPzogc3RyaW5nXHJcbiAgICBjb2xvcj86IG51bWJlcltdXHJcbiAgICBhdHRhY2tfcmFuZ2U/OiBudW1iZXJcclxuICAgIG1vbnN0ZXJfc3RhdHVzPyA6IEJyZXcuRW51bXMuTW9uc3RlclN0YXR1c1xyXG4gICAgc3BlZWQ/OiBudW1iZXJcclxuICAgIHNpZ2h0X3JhbmdlPzogbnVtYmVyXHJcbiAgICBocF9udW1iZXI/OiBudW1iZXJcclxuICAgIHNoaWVsZF9udW1iZXI/OiBudW1iZXJcclxuICAgIGZsYWdzPzogQXJyYXk8QnJldy5FbnVtcy5GbGFnPlxyXG59XHJcblxyXG5sZXQgbW9uc3Rlcl9kZWZhdWx0cyA6IE1vbnN0ZXJEZWYgPSB7XHJcbiAgICBjb2RlOiAnMScsXHJcbiAgICBjb2xvcjogQnJldy5Db2xvci5ub3JtYWwsXHJcbiAgICBhdHRhY2tfcmFuZ2U6IDEsXHJcbiAgICBtb25zdGVyX3N0YXR1czogQnJldy5FbnVtcy5Nb25zdGVyU3RhdHVzLlNsZWVwLCAgICAgICAgXHJcbiAgICBzcGVlZDogMTIsXHJcbiAgICBzaWdodF9yYW5nZTogQnJldy5Db25maWcuZGVmYXVsdF9tb25zdGVyX3NpZ2h0X3JhbmdlLFxyXG4gICAgZmxhZ3M6IFtdLFxyXG4gICAgaHBfbnVtYmVyOiAxLFxyXG4gICAgc2hpZWxkX251bWJlcjogMCxcclxufVxyXG5cclxuLy8gW2tleTogbnVtYmVyXTogVFxyXG5pbnRlcmZhY2UgSU1vbnN0ZXJEZWZzIHtcclxuICAgIFtkZWZfbmFtZTogc3RyaW5nXSA6IE1vbnN0ZXJEZWYgXHJcbn0gXHJcblxyXG5sZXQgbW9uc3Rlcl9kZWZpbml0aW9ucyA6IElNb25zdGVyRGVmcyA9IHtcclxuICAgIFwiSGVyb1wiOiB7IFxyXG4gICAgICAgIGNvZGU6IFwiQFwiLFxyXG4gICAgICAgIGNvbG9yOiBCcmV3LkNvbG9yLmhlcm9fYmx1ZSxcclxuICAgICAgICBhdHRhY2tfcmFuZ2U6IDEsXHJcbiAgICAgICAgc2lnaHRfcmFuZ2U6IEJyZXcuQ29uZmlnLmRlZmF1bHRfcGxheWVyX3NpZ2h0X3JhbmdlLFxyXG4gICAgICAgIGhwX251bWJlcjogMTIsXHJcbiAgICB9LFxyXG4gICAgXCJBcmNoaXRlY3RcIjoge1xyXG5cclxuICAgIH0sXHJcbiAgICBcIk1lcmNlbmFyeVwiOiB7XHJcbiAgICAgICAgY29kZTogXCJtXCIsXHJcbiAgICAgICAgY29sb3I6IEJyZXcuQ29sb3IubW9uc3Rlcl9jb2xvcixcclxuICAgICAgICBhdHRhY2tfcmFuZ2U6IDQsIFxyXG4gICAgICAgIGZsYWdzOiBbQnJldy5FbnVtcy5GbGFnLktlZXBzRGlzdGFuY2UsIEJyZXcuRW51bXMuRmxhZy5OZWVkc1RhcmdldExvY2tdLFxyXG4gICAgICAgIGhwX251bWJlcjogMSxcclxuICAgIH0sXHJcbiAgICBcIlNvbGRpZXJcIjoge1xyXG4gICAgICAgIGNvZGU6IFwic1wiLFxyXG4gICAgICAgIGNvbG9yOiBCcmV3LkNvbG9yLm1vbnN0ZXJfY29sb3IsXHJcbiAgICAgICAgYXR0YWNrX3JhbmdlOiA2LCBcclxuICAgICAgICBmbGFnczogW0JyZXcuRW51bXMuRmxhZy5OZWVkc1RhcmdldExvY2tdLFxyXG4gICAgICAgIGhwX251bWJlcjogMSxcclxuICAgIH0sXHJcbiAgICBcIkdyZW5hZGllclwiOiB7XHJcbiAgICAgICAgY29kZTogXCJHXCIsXHJcbiAgICAgICAgY29sb3I6IEJyZXcuQ29sb3IubW9uc3Rlcl9jb2xvcixcclxuICAgICAgICBhdHRhY2tfcmFuZ2U6IDYsIFxyXG4gICAgICAgIGhwX251bWJlcjogMixcclxuICAgICAgICBmbGFnczogW10sXHJcbiAgICB9LFxyXG59XHJcblxyXG4gICAgXHJcbmV4cG9ydCBmdW5jdGlvbiBtb25zdGVyRmFjdG9yeShnbTogQnJldy5HYW1lTWFzdGVyLCBtb25zdGVyX3R5cGUgOiBNb25zdGVyVHlwZSwgb3B0aW9ucyA6IE1vbnN0ZXJEZWYgPSB7fSkgOiBNb25zdGVyIHtcclxuICAgIGxldCBtIDogTW9uc3RlciA9IG5ldyBCcmV3LkdyaWRUaGluZ3MuTW9uc3Rlcihtb25zdGVyX3R5cGUpXHJcbiAgICBcclxuICAgIC8vIGJ1aWxkIHVwIGRlZmluaXRpb24gd2l0aCAzIGxheWVyczogZGVmYXVsdCwgZ2l2ZW4gZGVmLCBvcHRpb25zXHJcbiAgICAvLyAxLiBkZWZhdWx0XHJcbiAgICBsZXQgZGVmIDogTW9uc3RlckRlZiA9IEJyZXcuVXRpbHMuY2xvbmUobW9uc3Rlcl9kZWZhdWx0cylcclxuICAgIFxyXG4gICAgLy8gMi4gZ2l2ZW4gZGVmaW5pdGlvblxyXG4gICAgbGV0IHR5cGVfbmFtZSA9IE1vbnN0ZXJUeXBlW21vbnN0ZXJfdHlwZV1cclxuICAgIGxldCB0eXBlX2RlZiA9IG1vbnN0ZXJfZGVmaW5pdGlvbnNbdHlwZV9uYW1lXVxyXG4gICAgZm9yIChsZXQgcHJvcCBpbiB0eXBlX2RlZikge1xyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKFwidHlwZWRlZlwiLCBwcm9wLCB0eXBlX2RlZltwcm9wXSlcclxuICAgICAgICBkZWZbcHJvcF0gPSB0eXBlX2RlZltwcm9wXVxyXG4gICAgfSBcclxuICAgIFxyXG4gICAgLy8gMy4gb3B0aW9uc1xyXG4gICAgZm9yIChsZXQgcHJvcCBpbiBvcHRpb25zKSB7XHJcbiAgICAgICAgLy8gY29uc29sZS5sb2coXCJvcHRpb25zXCIsIHByb3AsIG9wdGlvbnNbcHJvcF0pXHJcbiAgICAgICAgZGVmW3Byb3BdID0gb3B0aW9uc1twcm9wXVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyA0LiBzZXQgYWxsIHByb3BlcnRpZXNcclxuICAgIGZvciAobGV0IHByb3AgaW4gZGVmKSB7XHJcbiAgICAgICAgbVtwcm9wXSA9IGRlZltwcm9wXVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyA1LiBpbml0aWF0ZSBzdGF0c1xyXG4gICAgbS5ocCA9IG5ldyBCcmV3LlN0YXQoQnJldy5FbnVtcy5TdGF0TmFtZS5IZWFsdGgsIGRlZi5ocF9udW1iZXIpXHJcbiAgICBtLnNoaWVsZHMgPSBuZXcgQnJldy5TdGF0KEJyZXcuRW51bXMuU3RhdE5hbWUuU2hpZWxkcywgZGVmLnNoaWVsZF9udW1iZXIpXHJcblxyXG4gICAgbS5mbGFncyA9IFtdLmNvbmNhdChkZWYuZmxhZ3MpXHJcbiAgICBpZiAob3B0aW9ucy5mbGFncykge1xyXG4gICAgICAgIG0uZmxhZ3MgPSBtLmZsYWdzLmNvbmNhdChvcHRpb25zLmZsYWdzKVxyXG4gICAgfVxyXG5cclxuICAgIC8vIGFjdCBmb3IgUk9ULmpzIGVuZ2luZVxyXG4gICAgbS5hY3QgPSAoKSA9PiB7XHJcbiAgICAgICAgZ20uY2hhbm5lbF90dXJuLnB1Ymxpc2goXCJ0dXJuLnN0YXJ0XCIsIHsgYWN0b3I6IG0gfSlcclxuICAgICAgICAvLyBnYW1lLm1vbnN0ZXJBY3QobSlcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gbVxyXG59XHJcbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/grid_things/definitions.ts\n");

/***/ }),

/***/ "./src/grid_things/features.ts":
/*!*************************************!*\
  !*** ./src/grid_things/features.ts ***!
  \*************************************/
/*! exports provided: Feature */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Feature\", function() { return Feature; });\n/* harmony import */ var _brew__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../brew */ \"./src/brew.ts\");\n/* harmony import */ var _grid_things_thing__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../grid_things/thing */ \"./src/grid_things/thing.ts\");\n\r\n\r\nclass Feature extends _grid_things_thing__WEBPACK_IMPORTED_MODULE_1__[\"Thing\"] {\r\n    constructor(definition) {\r\n        super(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewObjectType.Feature, definition);\r\n        this.parent = null;\r\n    }\r\n    getName() {\r\n        return _brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].FeatureType[this.definition];\r\n    }\r\n    getParent() {\r\n        return this.parent;\r\n    }\r\n    // public isRoot() : boolean {\r\n    //     return (this.parent) ? false : true\r\n    // }\r\n    setParent(p) {\r\n        this.parent = p;\r\n    }\r\n}\r\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvZ3JpZF90aGluZ3MvZmVhdHVyZXMudHM/M2UxNSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQStCO0FBQ2E7QUFFdEMsYUFBZSxTQUFRLHdEQUFLO0lBRzlCLFlBQWEsVUFBd0M7UUFDakQsS0FBSyxDQUFDLDJDQUFVLENBQUMsY0FBYyxDQUFDLE9BQU8sRUFBRSxVQUFVLENBQUM7UUFDcEQsSUFBSSxDQUFDLE1BQU0sR0FBRyxJQUFJO0lBQ3RCLENBQUM7SUFFTSxPQUFPO1FBQ1YsTUFBTSxDQUFDLGlEQUFnQixDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDO0lBQ3hELENBQUM7SUFFTSxTQUFTO1FBQ1osTUFBTSxDQUFDLElBQUksQ0FBQyxNQUFNO0lBQ3RCLENBQUM7SUFFRCw4QkFBOEI7SUFDOUIsMENBQTBDO0lBQzFDLElBQUk7SUFFRyxTQUFTLENBQUMsQ0FBUTtRQUNyQixJQUFJLENBQUMsTUFBTSxHQUFHLENBQUM7SUFDbkIsQ0FBQztDQVNKIiwiZmlsZSI6Ii4vc3JjL2dyaWRfdGhpbmdzL2ZlYXR1cmVzLnRzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgQnJldyBmcm9tIFwiLi4vYnJld1wiXHJcbmltcG9ydCB7IFRoaW5nIH0gZnJvbSAnLi4vZ3JpZF90aGluZ3MvdGhpbmcnXHJcblxyXG5leHBvcnQgY2xhc3MgRmVhdHVyZSBleHRlbmRzIFRoaW5nICB7XHJcbiAgICBwcml2YXRlIHBhcmVudCA6IFRoaW5nXHJcblxyXG4gICAgY29uc3RydWN0b3IgKGRlZmluaXRpb246IEJyZXcuRGVmaW5pdGlvbnMuRmVhdHVyZVR5cGUpIHtcclxuICAgICAgICBzdXBlcihCcmV3LkVudW1zLkJyZXdPYmplY3RUeXBlLkZlYXR1cmUsIGRlZmluaXRpb24pXHJcbiAgICAgICAgdGhpcy5wYXJlbnQgPSBudWxsXHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGdldE5hbWUoKSA6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIEJyZXcuRGVmaW5pdGlvbnMuRmVhdHVyZVR5cGVbdGhpcy5kZWZpbml0aW9uXVxyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBnZXRQYXJlbnQoKSA6IFRoaW5nIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5wYXJlbnRcclxuICAgIH1cclxuXHJcbiAgICAvLyBwdWJsaWMgaXNSb290KCkgOiBib29sZWFuIHtcclxuICAgIC8vICAgICByZXR1cm4gKHRoaXMucGFyZW50KSA/IGZhbHNlIDogdHJ1ZVxyXG4gICAgLy8gfVxyXG5cclxuICAgIHB1YmxpYyBzZXRQYXJlbnQocDogVGhpbmcpIHtcclxuICAgICAgICB0aGlzLnBhcmVudCA9IHBcclxuICAgIH1cclxuXHJcbiAgICAvLyBwdWJsaWMgZ2V0Um9vdCgpIDogRmVhdHVyZSB7XHJcbiAgICAvLyAgICAgaWYgKHRoaXMuaXNSb290KCkpIHtcclxuICAgIC8vICAgICAgICAgcmV0dXJuIHRoaXNcclxuICAgIC8vICAgICB9IGVsc2Uge1xyXG4gICAgLy8gICAgICAgICByZXR1cm4gdGhpcy5wYXJlbnQuZ2V0Um9vdCgpXHJcbiAgICAvLyAgICAgfVxyXG4gICAgLy8gfVxyXG59XHJcblxyXG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/grid_things/features.ts\n");

/***/ }),

/***/ "./src/grid_things/index.ts":
/*!**********************************!*\
  !*** ./src/grid_things/index.ts ***!
  \**********************************/
/*! exports provided: Thing, Item, Monster, Above, Feature, Terrain */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _thing__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./thing */ \"./src/grid_things/thing.ts\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"Thing\", function() { return _thing__WEBPACK_IMPORTED_MODULE_0__[\"Thing\"]; });\n\n/* harmony import */ var _item__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./item */ \"./src/grid_things/item.ts\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"Item\", function() { return _item__WEBPACK_IMPORTED_MODULE_1__[\"Item\"]; });\n\n/* harmony import */ var _monster__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./monster */ \"./src/grid_things/monster.ts\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"Monster\", function() { return _monster__WEBPACK_IMPORTED_MODULE_2__[\"Monster\"]; });\n\n/* harmony import */ var _above__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./above */ \"./src/grid_things/above.ts\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"Above\", function() { return _above__WEBPACK_IMPORTED_MODULE_3__[\"Above\"]; });\n\n/* harmony import */ var _features__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./features */ \"./src/grid_things/features.ts\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"Feature\", function() { return _features__WEBPACK_IMPORTED_MODULE_4__[\"Feature\"]; });\n\n/* harmony import */ var _terrain__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./terrain */ \"./src/grid_things/terrain.ts\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"Terrain\", function() { return _terrain__WEBPACK_IMPORTED_MODULE_5__[\"Terrain\"]; });\n\n\r\n\r\n\r\n\r\n\r\n\r\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvZ3JpZF90aGluZ3MvaW5kZXgudHM/YWE3OSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQStCO0FBQ0Y7QUFDTTtBQUNKO0FBQ0s7QUFDRCIsImZpbGUiOiIuL3NyYy9ncmlkX3RoaW5ncy9pbmRleC50cy5qcyIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCB7IFRoaW5nIH0gZnJvbSAnLi90aGluZydcclxuZXhwb3J0IHsgSXRlbSB9IGZyb20gJy4vaXRlbSdcclxuZXhwb3J0IHsgTW9uc3RlciB9IGZyb20gJy4vbW9uc3RlcidcclxuZXhwb3J0IHsgQWJvdmUgfSBmcm9tICcuL2Fib3ZlJ1xyXG5leHBvcnQgeyBGZWF0dXJlIH0gZnJvbSAnLi9mZWF0dXJlcydcclxuZXhwb3J0IHsgVGVycmFpbiB9IGZyb20gJy4vdGVycmFpbidcclxuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/grid_things/index.ts\n");

/***/ }),

/***/ "./src/grid_things/item.ts":
/*!*********************************!*\
  !*** ./src/grid_things/item.ts ***!
  \*********************************/
/*! exports provided: Item */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Item\", function() { return Item; });\n/* harmony import */ var _brew__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../brew */ \"./src/brew.ts\");\n/* harmony import */ var _grid_things_thing__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../grid_things/thing */ \"./src/grid_things/thing.ts\");\n\r\n\r\nclass Item extends _grid_things_thing__WEBPACK_IMPORTED_MODULE_1__[\"Thing\"] {\r\n    constructor(definition, subtype = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].ItemSubtype.NonSpecific) {\r\n        super(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewObjectType.Item, definition);\r\n        this.subtype = subtype;\r\n    }\r\n    getName() {\r\n        return _brew__WEBPACK_IMPORTED_MODULE_0__[\"Glossary\"].getItemName(this);\r\n    }\r\n}\r\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvZ3JpZF90aGluZ3MvaXRlbS50cz85M2EwIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBK0I7QUFDYTtBQUV0QyxVQUFZLFNBQVEsd0RBQUs7SUFPM0IsWUFBYSxVQUFxQyxFQUFFLFVBQXdDLGlEQUFnQixDQUFDLFdBQVcsQ0FBQyxXQUFXO1FBQ2hJLEtBQUssQ0FBQywyQ0FBVSxDQUFDLGNBQWMsQ0FBQyxJQUFJLEVBQUUsVUFBVSxDQUFDO1FBQ2pELElBQUksQ0FBQyxPQUFPLEdBQUcsT0FBTztJQUMxQixDQUFDO0lBRUQsT0FBTztRQUNILE1BQU0sQ0FBQyw4Q0FBYSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUM7SUFDMUMsQ0FBQztDQUNKIiwiZmlsZSI6Ii4vc3JjL2dyaWRfdGhpbmdzL2l0ZW0udHMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBCcmV3IGZyb20gXCIuLi9icmV3XCJcclxuaW1wb3J0IHsgVGhpbmcgfSBmcm9tICcuLi9ncmlkX3RoaW5ncy90aGluZydcclxuXHJcbmV4cG9ydCBjbGFzcyBJdGVtIGV4dGVuZHMgVGhpbmcgIHtcclxuICAgIHBvd2VyIDogQnJldy5Qb3dlcnMuUG93ZXIgLy8gdG9kbzogZmlndXJlIG91dCBpbXBsZW1lbnRhdGlvbiB2cyBleHRlbmRpbmcgVGhpbmcsIG1heWJlIFRoaW5nIGlzIGFsc28gYW4gaW50ZXJmYWNlXHJcbiAgICBjYW5QaWNrdXA6IGJvb2xlYW5cclxuICAgIGNhbkhlYXZlOiBib29sZWFuXHJcbiAgICBkYW1hZ2U6IG51bWJlclxyXG4gICAgc3VidHlwZTogQnJldy5EZWZpbml0aW9ucy5JdGVtU3VidHlwZVxyXG5cclxuICAgIGNvbnN0cnVjdG9yIChkZWZpbml0aW9uOiBCcmV3LkRlZmluaXRpb25zLkl0ZW1UeXBlLCBzdWJ0eXBlOiBCcmV3LkRlZmluaXRpb25zLkl0ZW1TdWJ0eXBlID0gQnJldy5EZWZpbml0aW9ucy5JdGVtU3VidHlwZS5Ob25TcGVjaWZpYykge1xyXG4gICAgICAgIHN1cGVyKEJyZXcuRW51bXMuQnJld09iamVjdFR5cGUuSXRlbSwgZGVmaW5pdGlvbilcclxuICAgICAgICB0aGlzLnN1YnR5cGUgPSBzdWJ0eXBlXHJcbiAgICB9XHJcblxyXG4gICAgZ2V0TmFtZSgpIDogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gQnJldy5HbG9zc2FyeS5nZXRJdGVtTmFtZSh0aGlzKVxyXG4gICAgfVxyXG59XHJcblxyXG5cclxuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/grid_things/item.ts\n");

/***/ }),

/***/ "./src/grid_things/monster.ts":
/*!************************************!*\
  !*** ./src/grid_things/monster.ts ***!
  \************************************/
/*! exports provided: Monster */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Monster\", function() { return Monster; });\n/* harmony import */ var _brew__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../brew */ \"./src/brew.ts\");\n/* harmony import */ var _thing__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./thing */ \"./src/grid_things/thing.ts\");\n\r\n\r\nclass MemoryPalace {\r\n    constructor() {\r\n        this.memory_dict = {};\r\n    }\r\n    saveLevelMemory(level_id, memory) {\r\n        this.memory_dict[level_id] = memory.clone();\r\n    }\r\n    hasLevelMemory(level_id) {\r\n        return level_id in this.memory_dict;\r\n    }\r\n    getLevelMemory(level_id) {\r\n        if (this.hasLevelMemory(level_id)) {\r\n            return this.memory_dict[level_id];\r\n        }\r\n        else {\r\n            console.error(\"missing memory archive for given level id:\", level_id);\r\n            return null;\r\n        }\r\n    }\r\n}\r\nclass Monster extends _thing__WEBPACK_IMPORTED_MODULE_1__[\"Thing\"] {\r\n    constructor(definition) {\r\n        super(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewObjectType.Monster, definition);\r\n        this.team = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].Team.Enemy;\r\n        this.parts = [];\r\n        this.building_type = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].ComponentPartsBuildingType.None;\r\n        this.fov = new _brew__WEBPACK_IMPORTED_MODULE_0__[\"GridOfThings\"]();\r\n        this.knowledge = new _brew__WEBPACK_IMPORTED_MODULE_0__[\"GridOfThings\"]();\r\n        this.memory = new _brew__WEBPACK_IMPORTED_MODULE_0__[\"GridOfThings\"]();\r\n        this.memory_archive = new MemoryPalace();\r\n        this.power_suite = new _brew__WEBPACK_IMPORTED_MODULE_0__[\"Powers\"].PowerSuite(0);\r\n        this.facing_direction = new _brew__WEBPACK_IMPORTED_MODULE_0__[\"Coordinate\"](0, 0);\r\n        // this.flags = []\r\n        this.score = new _brew__WEBPACK_IMPORTED_MODULE_0__[\"Stat\"](_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].StatName.Score, 0);\r\n    }\r\n    setFacing(new_direction) {\r\n        this.facing_direction = new_direction;\r\n    }\r\n    clearParts() {\r\n        this.parts = [];\r\n    }\r\n    getParts() {\r\n        return this.parts;\r\n    }\r\n    setParts(new_parts) {\r\n        this.parts = new_parts;\r\n    }\r\n    getSpeed() {\r\n        return this.speed;\r\n    }\r\n    act() { } // gets overridden by factory creation \r\n    clearFov() {\r\n        this.fov = new _brew__WEBPACK_IMPORTED_MODULE_0__[\"GridOfThings\"]();\r\n    }\r\n    clearKnowledge() {\r\n        this.knowledge = new _brew__WEBPACK_IMPORTED_MODULE_0__[\"GridOfThings\"]();\r\n    }\r\n    hasKnowledgeOf(other_thing) {\r\n        for (let thing of this.knowledge.getAllThings()) {\r\n            if (thing.isSameThing(other_thing)) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n    inFOV(target) {\r\n        return (this.fov.hasAt(target.location));\r\n    }\r\n    getPowers() {\r\n        return this.power_suite;\r\n    }\r\n    getName() {\r\n        return _brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].MonsterType[this.definition];\r\n    }\r\n    // override default Thing get Brew.Enums.Flags\r\n    getFlags() {\r\n        let my_flags = this.flags.concat([]);\r\n        for (let pow of this.power_suite.listOfPowers) {\r\n            my_flags = my_flags.concat(pow.conveys_flags);\r\n        }\r\n        return my_flags;\r\n    }\r\n}\r\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvZ3JpZF90aGluZ3MvbW9uc3Rlci50cz81ODM5Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBK0I7QUFDQTtBQUUvQjtJQUdJO1FBQ0ksSUFBSSxDQUFDLFdBQVcsR0FBRyxFQUFFO0lBQ3pCLENBQUM7SUFFRCxlQUFlLENBQUMsUUFBZ0IsRUFBRSxNQUFnQztRQUM5RCxJQUFJLENBQUMsV0FBVyxDQUFDLFFBQVEsQ0FBQyxHQUFHLE1BQU0sQ0FBQyxLQUFLLEVBQUU7SUFDL0MsQ0FBQztJQUVELGNBQWMsQ0FBQyxRQUFnQjtRQUMzQixNQUFNLENBQUMsUUFBUSxJQUFJLElBQUksQ0FBQyxXQUFXO0lBQ3ZDLENBQUM7SUFFRCxjQUFjLENBQUMsUUFBZ0I7UUFDM0IsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLGNBQWMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDaEMsTUFBTSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDO1FBQ3JDLENBQUM7UUFBQyxJQUFJLENBQUMsQ0FBQztZQUNKLE9BQU8sQ0FBQyxLQUFLLENBQUMsNENBQTRDLEVBQUUsUUFBUSxDQUFDO1lBQ3JFLE1BQU0sQ0FBQyxJQUFJO1FBQ2YsQ0FBQztJQUNMLENBQUM7Q0FDSjtBQUVLLGFBQWUsU0FBUSw0Q0FBSztJQXVCOUIsWUFBYSxVQUF3QztRQUNqRCxLQUFLLENBQUMsMkNBQVUsQ0FBQyxjQUFjLENBQUMsT0FBTyxFQUFFLFVBQVUsQ0FBQztRQWR4RCxTQUFJLEdBQW9CLDJDQUFVLENBQUMsSUFBSSxDQUFDLEtBQUs7UUFTN0MsVUFBSyxHQUFtQyxFQUFFO1FBQzFDLGtCQUFhLEdBQTBDLDJDQUFVLENBQUMsMEJBQTBCLENBQUMsSUFBSTtRQUs3RixJQUFJLENBQUMsR0FBRyxHQUFHLElBQUksa0RBQWlCLEVBQStCO1FBQy9ELElBQUksQ0FBQyxTQUFTLEdBQUcsSUFBSSxrREFBaUIsRUFBUztRQUMvQyxJQUFJLENBQUMsTUFBTSxHQUFHLElBQUksa0RBQWlCLEVBQVM7UUFDNUMsSUFBSSxDQUFDLGNBQWMsR0FBRyxJQUFJLFlBQVksRUFBRTtRQUN4QyxJQUFJLENBQUMsV0FBVyxHQUFHLElBQUksNENBQVcsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDO1FBQ2hELElBQUksQ0FBQyxnQkFBZ0IsR0FBRyxJQUFJLGdEQUFlLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUNqRCxrQkFBa0I7UUFDbEIsSUFBSSxDQUFDLEtBQUssR0FBRyxJQUFJLDBDQUFTLENBQUMsMkNBQVUsQ0FBQyxRQUFRLENBQUMsS0FBSyxFQUFFLENBQUMsQ0FBQztJQUM1RCxDQUFDO0lBRUQsU0FBUyxDQUFDLGFBQThCO1FBQ3BDLElBQUksQ0FBQyxnQkFBZ0IsR0FBRyxhQUFhO0lBQ3pDLENBQUM7SUFFRCxVQUFVO1FBQ04sSUFBSSxDQUFDLEtBQUssR0FBRyxFQUFFO0lBQ25CLENBQUM7SUFFRCxRQUFRO1FBQ0osTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFLO0lBQ3JCLENBQUM7SUFFRCxRQUFRLENBQUMsU0FBeUM7UUFDOUMsSUFBSSxDQUFDLEtBQUssR0FBRyxTQUFTO0lBQzFCLENBQUM7SUFFRCxRQUFRO1FBQ0osTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFLO0lBQ3JCLENBQUM7SUFFRCxHQUFHLEtBQVUsQ0FBQyxDQUFDLHVDQUF1QztJQUV0RCxRQUFRO1FBQ0osSUFBSSxDQUFDLEdBQUcsR0FBRyxJQUFJLGtEQUFpQixFQUErQjtJQUNuRSxDQUFDO0lBRUQsY0FBYztRQUNWLElBQUksQ0FBQyxTQUFTLEdBQUcsSUFBSSxrREFBaUIsRUFBUztJQUNuRCxDQUFDO0lBRUQsY0FBYyxDQUFDLFdBQXFCO1FBQ2hDLEdBQUcsQ0FBQyxDQUFDLElBQUksS0FBSyxJQUFJLElBQUksQ0FBQyxTQUFTLENBQUMsWUFBWSxFQUFFLENBQUMsQ0FBQyxDQUFDO1lBQzlDLEVBQUUsQ0FBQyxDQUFDLEtBQUssQ0FBQyxXQUFXLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxDQUFDO2dCQUNqQyxNQUFNLENBQUMsSUFBSTtZQUNmLENBQUM7UUFDTCxDQUFDO1FBRUQsTUFBTSxDQUFDLEtBQUs7SUFDaEIsQ0FBQztJQUVELEtBQUssQ0FBQyxNQUFhO1FBQ2YsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDO0lBQzVDLENBQUM7SUFFRCxTQUFTO1FBQ0wsTUFBTSxDQUFDLElBQUksQ0FBQyxXQUFXO0lBQzNCLENBQUM7SUFFTSxPQUFPO1FBQ1YsTUFBTSxDQUFDLGlEQUFnQixDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDO0lBQ3hELENBQUM7SUFFRCw4Q0FBOEM7SUFDOUMsUUFBUTtRQUNKLElBQUksUUFBUSxHQUE0QixJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUM7UUFFN0QsR0FBRyxDQUFDLENBQUMsSUFBSSxHQUFHLElBQUksSUFBSSxDQUFDLFdBQVcsQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDO1lBQzVDLFFBQVEsR0FBRyxRQUFRLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxhQUFhLENBQUM7UUFDakQsQ0FBQztRQUVELE1BQU0sQ0FBQyxRQUFRO0lBQ25CLENBQUM7Q0FDSiIsImZpbGUiOiIuL3NyYy9ncmlkX3RoaW5ncy9tb25zdGVyLnRzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgQnJldyBmcm9tIFwiLi4vYnJld1wiXHJcbmltcG9ydCB7IFRoaW5nIH0gZnJvbSAnLi90aGluZydcclxuXHJcbmNsYXNzIE1lbW9yeVBhbGFjZSB7XHJcbiAgICBtZW1vcnlfZGljdCA6IEJyZXcuVXRpbHMuRGljdDxCcmV3LkdyaWRPZlRoaW5nczxUaGluZz4+XHJcblxyXG4gICAgY29uc3RydWN0b3IgKCkge1xyXG4gICAgICAgIHRoaXMubWVtb3J5X2RpY3QgPSB7fVxyXG4gICAgfVxyXG5cclxuICAgIHNhdmVMZXZlbE1lbW9yeShsZXZlbF9pZDogbnVtYmVyLCBtZW1vcnk6IEJyZXcuR3JpZE9mVGhpbmdzPFRoaW5nPikge1xyXG4gICAgICAgIHRoaXMubWVtb3J5X2RpY3RbbGV2ZWxfaWRdID0gbWVtb3J5LmNsb25lKClcclxuICAgIH1cclxuXHJcbiAgICBoYXNMZXZlbE1lbW9yeShsZXZlbF9pZDogbnVtYmVyKSA6IGJvb2xlYW4ge1xyXG4gICAgICAgIHJldHVybiBsZXZlbF9pZCBpbiB0aGlzLm1lbW9yeV9kaWN0XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0TGV2ZWxNZW1vcnkobGV2ZWxfaWQ6IG51bWJlcikgOiBCcmV3LkdyaWRPZlRoaW5nczxUaGluZz4ge1xyXG4gICAgICAgIGlmICh0aGlzLmhhc0xldmVsTWVtb3J5KGxldmVsX2lkKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5tZW1vcnlfZGljdFtsZXZlbF9pZF1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFwibWlzc2luZyBtZW1vcnkgYXJjaGl2ZSBmb3IgZ2l2ZW4gbGV2ZWwgaWQ6XCIsIGxldmVsX2lkKVxyXG4gICAgICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIE1vbnN0ZXIgZXh0ZW5kcyBUaGluZyB7XHJcbiAgICBzcGVlZDogbnVtYmVyXHJcbiAgICBzaWdodF9yYW5nZTogbnVtYmVyXHJcbiAgICBtb25zdGVyX3N0YXR1czogQnJldy5FbnVtcy5Nb25zdGVyU3RhdHVzXHJcbiAgICBkZXN0aW5hdGlvbl94eTogQnJldy5Db29yZGluYXRlXHJcbiAgICBnaXZldXA6IG51bWJlclxyXG4gICAgYXR0YWNrX3JhbmdlOiBudW1iZXJcclxuICAgIGhwOiBCcmV3LlN0YXRcclxuICAgIHNoaWVsZHM6IEJyZXcuU3RhdFxyXG4gICAgcG93ZXJfc3VpdGU6IEJyZXcuUG93ZXJzLlBvd2VyU3VpdGVcclxuICAgIHRlYW06IEJyZXcuRW51bXMuVGVhbSA9IEJyZXcuRW51bXMuVGVhbS5FbmVteVxyXG4gICAgZmFjaW5nX2RpcmVjdGlvbjogQnJldy5Db29yZGluYXRlXHJcbiAgICBzY29yZTogQnJldy5TdGF0XHJcblxyXG4gICAgZm92OiBCcmV3LkdyaWRPZlRoaW5nczxCcmV3LkVudW1zLkJyZXdWaXNpb25Tb3VyY2U+XHJcbiAgICBrbm93bGVkZ2U6IEJyZXcuR3JpZE9mVGhpbmdzPFRoaW5nPlxyXG4gICAgbWVtb3J5OiBCcmV3LkdyaWRPZlRoaW5nczxUaGluZz5cclxuICAgIG1lbW9yeV9hcmNoaXZlOiBNZW1vcnlQYWxhY2VcclxuICAgIFxyXG4gICAgcGFydHM6IEFycmF5PEJyZXcuR3JpZFRoaW5ncy5GZWF0dXJlPiA9IFtdXHJcbiAgICBidWlsZGluZ190eXBlOiBCcmV3LkVudW1zLkNvbXBvbmVudFBhcnRzQnVpbGRpbmdUeXBlID0gQnJldy5FbnVtcy5Db21wb25lbnRQYXJ0c0J1aWxkaW5nVHlwZS5Ob25lXHJcbiAgICBpbnZlbnRvcnk6IEJyZXcuSW52ZW50b3J5XHJcbiAgICBcclxuICAgIGNvbnN0cnVjdG9yIChkZWZpbml0aW9uOiBCcmV3LkRlZmluaXRpb25zLk1vbnN0ZXJUeXBlKSB7XHJcbiAgICAgICAgc3VwZXIoQnJldy5FbnVtcy5CcmV3T2JqZWN0VHlwZS5Nb25zdGVyLCBkZWZpbml0aW9uKVxyXG4gICAgICAgIHRoaXMuZm92ID0gbmV3IEJyZXcuR3JpZE9mVGhpbmdzPEJyZXcuRW51bXMuQnJld1Zpc2lvblNvdXJjZT4oKVxyXG4gICAgICAgIHRoaXMua25vd2xlZGdlID0gbmV3IEJyZXcuR3JpZE9mVGhpbmdzPFRoaW5nPigpXHJcbiAgICAgICAgdGhpcy5tZW1vcnkgPSBuZXcgQnJldy5HcmlkT2ZUaGluZ3M8VGhpbmc+KClcclxuICAgICAgICB0aGlzLm1lbW9yeV9hcmNoaXZlID0gbmV3IE1lbW9yeVBhbGFjZSgpXHJcbiAgICAgICAgdGhpcy5wb3dlcl9zdWl0ZSA9IG5ldyBCcmV3LlBvd2Vycy5Qb3dlclN1aXRlKDApXHJcbiAgICAgICAgdGhpcy5mYWNpbmdfZGlyZWN0aW9uID0gbmV3IEJyZXcuQ29vcmRpbmF0ZSgwLCAwKVxyXG4gICAgICAgIC8vIHRoaXMuZmxhZ3MgPSBbXVxyXG4gICAgICAgIHRoaXMuc2NvcmUgPSBuZXcgQnJldy5TdGF0KEJyZXcuRW51bXMuU3RhdE5hbWUuU2NvcmUsIDApXHJcbiAgICB9XHJcbiAgICBcclxuICAgIHNldEZhY2luZyhuZXdfZGlyZWN0aW9uOiBCcmV3LkNvb3JkaW5hdGUpIHtcclxuICAgICAgICB0aGlzLmZhY2luZ19kaXJlY3Rpb24gPSBuZXdfZGlyZWN0aW9uXHJcbiAgICB9XHJcblxyXG4gICAgY2xlYXJQYXJ0cygpIHtcclxuICAgICAgICB0aGlzLnBhcnRzID0gW11cclxuICAgIH1cclxuXHJcbiAgICBnZXRQYXJ0cygpIDogQXJyYXk8QnJldy5HcmlkVGhpbmdzLkZlYXR1cmU+IHtcclxuICAgICAgICByZXR1cm4gdGhpcy5wYXJ0c1xyXG4gICAgfVxyXG5cclxuICAgIHNldFBhcnRzKG5ld19wYXJ0czogQXJyYXk8QnJldy5HcmlkVGhpbmdzLkZlYXR1cmU+KSB7XHJcbiAgICAgICAgdGhpcy5wYXJ0cyA9IG5ld19wYXJ0c1xyXG4gICAgfVxyXG5cclxuICAgIGdldFNwZWVkKCkgOiBudW1iZXIge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNwZWVkXHJcbiAgICB9XHJcblxyXG4gICAgYWN0KCk6IHZvaWQge30gLy8gZ2V0cyBvdmVycmlkZGVuIGJ5IGZhY3RvcnkgY3JlYXRpb24gXHJcblxyXG4gICAgY2xlYXJGb3YoKSA6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuZm92ID0gbmV3IEJyZXcuR3JpZE9mVGhpbmdzPEJyZXcuRW51bXMuQnJld1Zpc2lvblNvdXJjZT4oKVxyXG4gICAgfSAgIFxyXG4gICAgXHJcbiAgICBjbGVhcktub3dsZWRnZSgpIDogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5rbm93bGVkZ2UgPSBuZXcgQnJldy5HcmlkT2ZUaGluZ3M8VGhpbmc+KClcclxuICAgIH1cclxuXHJcbiAgICBoYXNLbm93bGVkZ2VPZihvdGhlcl90aGluZyA6IE1vbnN0ZXIpIDogYm9vbGVhbiB7XHJcbiAgICAgICAgZm9yIChsZXQgdGhpbmcgb2YgdGhpcy5rbm93bGVkZ2UuZ2V0QWxsVGhpbmdzKCkpIHtcclxuICAgICAgICAgICAgaWYgKHRoaW5nLmlzU2FtZVRoaW5nKG90aGVyX3RoaW5nKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgIH1cclxuXHJcbiAgICBpbkZPVih0YXJnZXQ6IFRoaW5nKSB7XHJcbiAgICAgICAgcmV0dXJuICh0aGlzLmZvdi5oYXNBdCh0YXJnZXQubG9jYXRpb24pKVxyXG4gICAgfVxyXG5cclxuICAgIGdldFBvd2VycygpIDogQnJldy5Qb3dlcnMuUG93ZXJTdWl0ZSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMucG93ZXJfc3VpdGVcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZ2V0TmFtZSgpIDogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gQnJldy5EZWZpbml0aW9ucy5Nb25zdGVyVHlwZVt0aGlzLmRlZmluaXRpb25dXHJcbiAgICB9XHJcblxyXG4gICAgLy8gb3ZlcnJpZGUgZGVmYXVsdCBUaGluZyBnZXQgQnJldy5FbnVtcy5GbGFnc1xyXG4gICAgZ2V0RmxhZ3MoKSA6IEFycmF5PEJyZXcuRW51bXMuRmxhZz4ge1xyXG4gICAgICAgIGxldCBteV9mbGFncyA6IEFycmF5PEJyZXcuRW51bXMuRmxhZz4gPSB0aGlzLmZsYWdzLmNvbmNhdChbXSlcclxuXHJcbiAgICAgICAgZm9yIChsZXQgcG93IG9mIHRoaXMucG93ZXJfc3VpdGUubGlzdE9mUG93ZXJzKSB7XHJcbiAgICAgICAgICAgIG15X2ZsYWdzID0gbXlfZmxhZ3MuY29uY2F0KHBvdy5jb252ZXlzX2ZsYWdzKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIG15X2ZsYWdzXHJcbiAgICB9XHJcbn1cclxuXHJcbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/grid_things/monster.ts\n");

/***/ }),

/***/ "./src/grid_things/terrain.ts":
/*!************************************!*\
  !*** ./src/grid_things/terrain.ts ***!
  \************************************/
/*! exports provided: Terrain */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Terrain\", function() { return Terrain; });\n/* harmony import */ var _brew__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../brew */ \"./src/brew.ts\");\n/* harmony import */ var _grid_things_thing__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../grid_things/thing */ \"./src/grid_things/thing.ts\");\n\r\n\r\nclass Terrain extends _grid_things_thing__WEBPACK_IMPORTED_MODULE_1__[\"Thing\"] {\r\n    constructor(definition) {\r\n        super(_brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewObjectType.Terrain, definition);\r\n    }\r\n    getName() {\r\n        return _brew__WEBPACK_IMPORTED_MODULE_0__[\"Definitions\"].TerrainType[this.definition];\r\n    }\r\n}\r\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvZ3JpZF90aGluZ3MvdGVycmFpbi50cz9iMGUxIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBK0I7QUFDYTtBQUV0QyxhQUFlLFNBQVEsd0RBQUs7SUFPOUIsWUFBYSxVQUF3QztRQUNqRCxLQUFLLENBQUMsMkNBQVUsQ0FBQyxjQUFjLENBQUMsT0FBTyxFQUFFLFVBQVUsQ0FBQztJQUN4RCxDQUFDO0lBRU0sT0FBTztRQUNWLE1BQU0sQ0FBQyxpREFBZ0IsQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQztJQUN4RCxDQUFDO0NBQ0oiLCJmaWxlIjoiLi9zcmMvZ3JpZF90aGluZ3MvdGVycmFpbi50cy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIEJyZXcgZnJvbSBcIi4uL2JyZXdcIlxyXG5pbXBvcnQgeyBUaGluZyB9IGZyb20gJy4uL2dyaWRfdGhpbmdzL3RoaW5nJ1xyXG5cclxuZXhwb3J0IGNsYXNzIFRlcnJhaW4gZXh0ZW5kcyBUaGluZyB7XHJcbiAgICBibG9ja3Nfd2Fsa2luZzogYm9vbGVhblxyXG4gICAgYmxvY2tzX3Zpc2lvbjogYm9vbGVhblxyXG4gICAgYmxvY2tzX2ZseWluZzogYm9vbGVhbiAgLy8gdG9kbzogbmVlZCBhIGNsZWFuZXIgY29ubmVjdGlvbiB0byB0aGUgdGVycmFpbiBJbnRlcmZhY2UgKG5vIG5lZWQgdG8gZGVmaW5lIHRoZXNlIG11bHRpcGxlIHRpbWVzKVxyXG4gICAgaXNfc29saWQ6IGJvb2xlYW5cclxuICAgIGFsd2F5c09uVG9wOiBib29sZWFuXHJcblxyXG4gICAgY29uc3RydWN0b3IgKGRlZmluaXRpb246IEJyZXcuRGVmaW5pdGlvbnMuVGVycmFpblR5cGUpIHtcclxuICAgICAgICBzdXBlcihCcmV3LkVudW1zLkJyZXdPYmplY3RUeXBlLlRlcnJhaW4sIGRlZmluaXRpb24pXHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGdldE5hbWUoKSA6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIEJyZXcuRGVmaW5pdGlvbnMuVGVycmFpblR5cGVbdGhpcy5kZWZpbml0aW9uXVxyXG4gICAgfVxyXG59XHJcblxyXG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/grid_things/terrain.ts\n");

/***/ }),

/***/ "./src/grid_things/thing.ts":
/*!**********************************!*\
  !*** ./src/grid_things/thing.ts ***!
  \**********************************/
/*! exports provided: Thing */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Thing\", function() { return Thing; });\n/* harmony import */ var _brew__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../brew */ \"./src/brew.ts\");\n\r\nclass Thing {\r\n    constructor(objtype, definition) {\r\n        // public id: number\r\n        this.objtype = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Enums\"].BrewObjectType.Thing;\r\n        this.name = \"unnamed_thing\";\r\n        this.code = \"0\";\r\n        this.flags = [];\r\n        this.objtype = objtype;\r\n        this.definition = definition;\r\n        this.id = _brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].generateID();\r\n    }\r\n    setLocation(xyNew) {\r\n        this.location = xyNew;\r\n    }\r\n    getDefinition() {\r\n        return this.definition;\r\n    }\r\n    isType(other_definition) {\r\n        return other_definition == this.definition;\r\n    }\r\n    getID() {\r\n        return this.id;\r\n    }\r\n    isSameThing(other_thing) {\r\n        return this.getID() === other_thing.getID();\r\n    }\r\n    getName() {\r\n        // override this\r\n        throw new Error(\"Thing subclass missing getName override\");\r\n    }\r\n    setFlag(flag) {\r\n        _brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].remove(this.flags, flag);\r\n        this.flags.push(flag);\r\n    }\r\n    removeFlag(flag) {\r\n        // returns true if we had this flag, false if not\r\n        if (this.flags.indexOf(flag) > -1) {\r\n            _brew__WEBPACK_IMPORTED_MODULE_0__[\"Utils\"].remove(this.flags, flag);\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    hasFlag(flag) {\r\n        // return (this.flags.indexOf(flag) > -1) \r\n        return (this.getFlags().indexOf(flag) > -1);\r\n    }\r\n    getFlags() {\r\n        return this.flags;\r\n    }\r\n}\r\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvZ3JpZF90aGluZ3MvdGhpbmcudHM/YWY0OCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFDK0I7QUFFekI7SUFjRixZQUFhLE9BQWtDLEVBQUUsVUFBZTtRQWJoRSxvQkFBb0I7UUFDVixZQUFPLEdBQThCLDJDQUFVLENBQUMsY0FBYyxDQUFDLEtBQUs7UUFJdkUsU0FBSSxHQUFXLGVBQWU7UUFDOUIsU0FBSSxHQUFXLEdBQUc7UUFLekIsVUFBSyxHQUEyQixFQUFFO1FBRzlCLElBQUksQ0FBQyxPQUFPLEdBQUcsT0FBTztRQUN0QixJQUFJLENBQUMsVUFBVSxHQUFHLFVBQVU7UUFDNUIsSUFBSSxDQUFDLEVBQUUsR0FBRywyQ0FBVSxDQUFDLFVBQVUsRUFBRTtJQUNyQyxDQUFDO0lBRU0sV0FBVyxDQUFDLEtBQXNCO1FBQ3JDLElBQUksQ0FBQyxRQUFRLEdBQUcsS0FBSztJQUN6QixDQUFDO0lBRU0sYUFBYTtRQUNoQixNQUFNLENBQUMsSUFBSSxDQUFDLFVBQVU7SUFDMUIsQ0FBQztJQUVNLE1BQU0sQ0FBQyxnQkFBcUI7UUFDL0IsTUFBTSxDQUFDLGdCQUFnQixJQUFJLElBQUksQ0FBQyxVQUFVO0lBQzlDLENBQUM7SUFFTSxLQUFLO1FBQ1IsTUFBTSxDQUFDLElBQUksQ0FBQyxFQUFFO0lBQ2xCLENBQUM7SUFFTSxXQUFXLENBQUMsV0FBa0I7UUFDakMsTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFLLEVBQUUsS0FBSyxXQUFXLENBQUMsS0FBSyxFQUFFO0lBQy9DLENBQUM7SUFFTSxPQUFPO1FBQ1YsZ0JBQWdCO1FBQ2hCLE1BQU0sSUFBSSxLQUFLLENBQUMseUNBQXlDLENBQUM7SUFDOUQsQ0FBQztJQUVELE9BQU8sQ0FBQyxJQUFxQjtRQUN6QiwyQ0FBVSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsS0FBSyxFQUFFLElBQUksQ0FBQztRQUNuQyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUM7SUFDekIsQ0FBQztJQUVELFVBQVUsQ0FBQyxJQUFxQjtRQUM1QixpREFBaUQ7UUFDakQsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ2hDLDJDQUFVLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFLLEVBQUUsSUFBSSxDQUFDO1lBQ25DLE1BQU0sQ0FBQyxJQUFJO1FBQ2YsQ0FBQztRQUFDLElBQUksQ0FBQyxDQUFDO1lBQ0osTUFBTSxDQUFDLEtBQUs7UUFDaEIsQ0FBQztJQUNMLENBQUM7SUFFRCxPQUFPLENBQUMsSUFBcUI7UUFDekIsMENBQTBDO1FBQzFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7SUFDL0MsQ0FBQztJQUVELFFBQVE7UUFDSixNQUFNLENBQUMsSUFBSSxDQUFDLEtBQUs7SUFDckIsQ0FBQztDQUNKIiwiZmlsZSI6Ii4vc3JjL2dyaWRfdGhpbmdzL3RoaW5nLnRzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgUk9UIGZyb20gJ3JvdC1qcydcclxuaW1wb3J0ICogYXMgQnJldyBmcm9tIFwiLi4vYnJld1wiXHJcblxyXG5leHBvcnQgY2xhc3MgVGhpbmcge1xyXG4gICAgLy8gcHVibGljIGlkOiBudW1iZXJcclxuICAgIHByb3RlY3RlZCBvYmp0eXBlOiBCcmV3LkVudW1zLkJyZXdPYmplY3RUeXBlID0gQnJldy5FbnVtcy5CcmV3T2JqZWN0VHlwZS5UaGluZ1xyXG4gICAgcHJvdGVjdGVkIGRlZmluaXRpb246IGFueVxyXG4gICAgcHJvdGVjdGVkIGlkIDogbnVtYmVyXHJcbiAgICBcclxuICAgIHB1YmxpYyBuYW1lOiBzdHJpbmcgPSBcInVubmFtZWRfdGhpbmdcIlxyXG4gICAgcHVibGljIGNvZGU6IHN0cmluZyA9IFwiMFwiXHJcbiAgICBwdWJsaWMgY29sb3I6IG51bWJlcltdXHJcbiAgICBwdWJsaWMgYmdfY29sb3I6IG51bWJlcltdXHJcbiAgICBwdWJsaWMgbG9jYXRpb246IEJyZXcuQ29vcmRpbmF0ZVxyXG4gICAgXHJcbiAgICBmbGFnczogQXJyYXk8QnJldy5FbnVtcy5GbGFnPiA9IFtdXHJcblxyXG4gICAgY29uc3RydWN0b3IgKG9ianR5cGU6IEJyZXcuRW51bXMuQnJld09iamVjdFR5cGUsIGRlZmluaXRpb246IGFueSkge1xyXG4gICAgICAgIHRoaXMub2JqdHlwZSA9IG9ianR5cGVcclxuICAgICAgICB0aGlzLmRlZmluaXRpb24gPSBkZWZpbml0aW9uXHJcbiAgICAgICAgdGhpcy5pZCA9IEJyZXcuVXRpbHMuZ2VuZXJhdGVJRCgpXHJcbiAgICB9XHJcbiAgICBcclxuICAgIHB1YmxpYyBzZXRMb2NhdGlvbih4eU5ldzogQnJldy5Db29yZGluYXRlKSA6IHZvaWQge1xyXG4gICAgICAgIHRoaXMubG9jYXRpb24gPSB4eU5ld1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBwdWJsaWMgZ2V0RGVmaW5pdGlvbigpIDogYW55IHtcclxuICAgICAgICByZXR1cm4gdGhpcy5kZWZpbml0aW9uXHJcbiAgICB9XHJcbiAgICBcclxuICAgIHB1YmxpYyBpc1R5cGUob3RoZXJfZGVmaW5pdGlvbjogYW55KSA6IGJvb2xlYW4ge1xyXG4gICAgICAgIHJldHVybiBvdGhlcl9kZWZpbml0aW9uID09IHRoaXMuZGVmaW5pdGlvblxyXG4gICAgfSBcclxuICAgIFxyXG4gICAgcHVibGljIGdldElEKCkgOiBudW1iZXIge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmlkXHJcbiAgICB9XHJcbiAgICBcclxuICAgIHB1YmxpYyBpc1NhbWVUaGluZyhvdGhlcl90aGluZzogVGhpbmcpIDogYm9vbGVhbiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0SUQoKSA9PT0gb3RoZXJfdGhpbmcuZ2V0SUQoKVxyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBnZXROYW1lKCkgOiBzdHJpbmcge1xyXG4gICAgICAgIC8vIG92ZXJyaWRlIHRoaXNcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJUaGluZyBzdWJjbGFzcyBtaXNzaW5nIGdldE5hbWUgb3ZlcnJpZGVcIilcclxuICAgIH1cclxuXHJcbiAgICBzZXRGbGFnKGZsYWc6IEJyZXcuRW51bXMuRmxhZykge1xyXG4gICAgICAgIEJyZXcuVXRpbHMucmVtb3ZlKHRoaXMuZmxhZ3MsIGZsYWcpXHJcbiAgICAgICAgdGhpcy5mbGFncy5wdXNoKGZsYWcpXHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJlbW92ZUZsYWcoZmxhZzogQnJldy5FbnVtcy5GbGFnKSA6IGJvb2xlYW4ge1xyXG4gICAgICAgIC8vIHJldHVybnMgdHJ1ZSBpZiB3ZSBoYWQgdGhpcyBmbGFnLCBmYWxzZSBpZiBub3RcclxuICAgICAgICBpZiAodGhpcy5mbGFncy5pbmRleE9mKGZsYWcpID4gLTEpIHtcclxuICAgICAgICAgICAgQnJldy5VdGlscy5yZW1vdmUodGhpcy5mbGFncywgZmxhZylcclxuICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGhhc0ZsYWcoZmxhZzogQnJldy5FbnVtcy5GbGFnKSA6IGJvb2xlYW4ge1xyXG4gICAgICAgIC8vIHJldHVybiAodGhpcy5mbGFncy5pbmRleE9mKGZsYWcpID4gLTEpIFxyXG4gICAgICAgIHJldHVybiAodGhpcy5nZXRGbGFncygpLmluZGV4T2YoZmxhZykgPiAtMSkgXHJcbiAgICB9XHJcblxyXG4gICAgZ2V0RmxhZ3MoKSA6IEFycmF5PEJyZXcuRW51bXMuRmxhZz4ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmZsYWdzXHJcbiAgICB9XHJcbn1cclxuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/grid_things/thing.ts\n");

/***/ }),

/***/ "./src/level_generator/rooms.ts":
/*!**************************************!*\
  !*** ./src/level_generator/rooms.ts ***!
  \**************************************/
/*! exports provided: Rectangle, Room, RectangleRoom, CrossRoom, OvalRoom, CorridorRoom */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Rectangle\", function() { return Rectangle; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Room\", function() { return Room; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"RectangleRoom\", function() { return RectangleRoom; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"CrossRoom\", function() { return CrossRoom; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"OvalRoom\", function() { return OvalRoom; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"CorridorRoom\", function() { return CorridorRoom; });\n/* harmony import */ var rot_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! rot-js */ \"./node_modules/rot-js/lib/rot.js\");\n/* harmony import */ var rot_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(rot_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _brew_components_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../brew_components/utils */ \"./src/brew_components/utils.ts\");\n/* harmony import */ var _brew_components_coordinate__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../brew_components/coordinate */ \"./src/brew_components/coordinate.ts\");\n\r\n// let _id = Math.floor(ROT.RNG.getUniform()*9999)\r\n// function idGenerator() : number {\r\n//     _id += 1\r\n//     return _id\r\n// }\r\n\r\n\r\nclass Rectangle {\r\n    constructor(x, y, width, height) {\r\n        this.x = x;\r\n        this.y = y;\r\n        this.width = width;\r\n        this.height = height;\r\n        this.id = Object(_brew_components_utils__WEBPACK_IMPORTED_MODULE_1__[\"generateID\"])();\r\n    }\r\n    right() {\r\n        return this.x + this.width - 1;\r\n    }\r\n    bottom() {\r\n        return this.y + this.height - 1;\r\n    }\r\n    left() { return this.x; }\r\n    top() { return this.y; }\r\n    area() { return this.width * this.height; }\r\n    isPointInside(xy) {\r\n        return ((xy.x > this.x) && (xy.x < this.right()) && (xy.y > this.y) && (xy.y < this.bottom()));\r\n    }\r\n    // isPointInside(xy: Coordinate) : boolean {\r\n    //     return ((xy.x >= this.x) && (xy.x <= this.right()) && (xy.y >= this.y) && (xy.y <= this.bottom()))\r\n    // }\r\n    checkIntersection_Strict(other_rect) {\r\n        if ((this.right() < other_rect.left()) ||\r\n            (other_rect.right() < this.left()) ||\r\n            (this.bottom() < other_rect.top()) ||\r\n            (other_rect.bottom() < this.top())) {\r\n            return false;\r\n        }\r\n        else {\r\n            return true;\r\n        }\r\n    }\r\n    checkIntersection_AllowPerimeter(other_rect) {\r\n        if ((this.right() <= other_rect.left()) ||\r\n            (other_rect.right() <= this.left()) ||\r\n            (this.bottom() <= other_rect.top()) ||\r\n            (other_rect.bottom() <= this.top())) {\r\n            return false;\r\n        }\r\n        else {\r\n            return true;\r\n        }\r\n    }\r\n    // checkOverlap(other_rect : Rectangle) : boolean {\r\n    //     return this.getCorners().some((xy) => {\r\n    //         return other_rect.isPointInside(xy)\r\n    //     })\r\n    // }\r\n    contains(other_rect) {\r\n        return other_rect.getCorners().every((xy) => {\r\n            return this.isPointInside(xy);\r\n        });\r\n    }\r\n    getPerimeter() {\r\n        let walls = [];\r\n        for (let x = 0; x < this.width; x++) {\r\n            walls.push(new _brew_components_coordinate__WEBPACK_IMPORTED_MODULE_2__[\"Coordinate\"](x + this.x, this.y));\r\n            walls.push(new _brew_components_coordinate__WEBPACK_IMPORTED_MODULE_2__[\"Coordinate\"](x + this.x, this.bottom()));\r\n        }\r\n        for (let y = 1; y < this.height - 1; y++) {\r\n            walls.push(new _brew_components_coordinate__WEBPACK_IMPORTED_MODULE_2__[\"Coordinate\"](this.x, y + this.y));\r\n            walls.push(new _brew_components_coordinate__WEBPACK_IMPORTED_MODULE_2__[\"Coordinate\"](this.right(), y + this.y));\r\n        }\r\n        return walls;\r\n    }\r\n    getInterior() {\r\n        let floors = [];\r\n        for (let x = this.x + 1; x < this.right(); x++) {\r\n            for (let y = this.y + 1; y < this.bottom(); y++) {\r\n                floors.push(new _brew_components_coordinate__WEBPACK_IMPORTED_MODULE_2__[\"Coordinate\"](x, y));\r\n            }\r\n        }\r\n        return floors;\r\n    }\r\n    getCorners() {\r\n        return [\r\n            new _brew_components_coordinate__WEBPACK_IMPORTED_MODULE_2__[\"Coordinate\"](this.x, this.y),\r\n            new _brew_components_coordinate__WEBPACK_IMPORTED_MODULE_2__[\"Coordinate\"](this.x, this.bottom()),\r\n            new _brew_components_coordinate__WEBPACK_IMPORTED_MODULE_2__[\"Coordinate\"](this.right(), this.y),\r\n            new _brew_components_coordinate__WEBPACK_IMPORTED_MODULE_2__[\"Coordinate\"](this.right(), this.bottom()),\r\n        ];\r\n    }\r\n    isCorner(xy) {\r\n        let corners = this.getCorners();\r\n        return corners.some((corner_xy) => {\r\n            return (corner_xy.compare(xy));\r\n        });\r\n    }\r\n    getPerimeter_NoCorners() {\r\n        return this.getPerimeter().filter((xy) => {\r\n            return (!(this.isCorner(xy)));\r\n        });\r\n    }\r\n}\r\nclass Room {\r\n    constructor(bounding_rectangle) {\r\n        this.bounding_rectangle = bounding_rectangle;\r\n        this.id = Object(_brew_components_utils__WEBPACK_IMPORTED_MODULE_1__[\"generateID\"])();\r\n        this.doors = [];\r\n    }\r\n    addDoor(door) {\r\n        this.doors.push(door);\r\n    }\r\n    getFloors() {\r\n        throw new Error(\"does not implement getFloors\");\r\n    }\r\n    getWalls() {\r\n        throw new Error(\"does not implement getFloors\");\r\n    }\r\n    getCorners() {\r\n        throw new Error(\"does not implement getFloors\");\r\n    }\r\n    isCorner(xy) {\r\n        let corners = this.getCorners();\r\n        return corners.some((corner_xy) => {\r\n            return (corner_xy.compare(xy));\r\n        });\r\n    }\r\n    getWallsOnly() {\r\n        return this.getWalls().filter((xy) => {\r\n            return (!(this.isCorner(xy)));\r\n        });\r\n    }\r\n}\r\nclass RectangleRoom extends Room {\r\n    getFloors() {\r\n        return this.bounding_rectangle.getInterior();\r\n    }\r\n    getWalls() {\r\n        return this.bounding_rectangle.getPerimeter();\r\n    }\r\n    getCorners() {\r\n        return this.bounding_rectangle.getCorners();\r\n    }\r\n    isCorner(xy) {\r\n        return this.bounding_rectangle.isCorner(xy);\r\n    }\r\n}\r\nclass CrossRoom extends Room {\r\n    constructor(bounding_rectangle, rect_tall, rect_wide) {\r\n        super(bounding_rectangle);\r\n        this.bounding_rectangle = bounding_rectangle;\r\n        this.rect_tall = rect_tall;\r\n        this.rect_wide = rect_wide;\r\n    }\r\n    getFloors() {\r\n        let floor_keys = this.rect_wide.getInterior().map((xy) => {\r\n            return Object(_brew_components_utils__WEBPACK_IMPORTED_MODULE_1__[\"xyToKey\"])(xy);\r\n        });\r\n        let tall_keys = this.rect_tall.getInterior().map((xy) => {\r\n            return Object(_brew_components_utils__WEBPACK_IMPORTED_MODULE_1__[\"xyToKey\"])(xy);\r\n        });\r\n        for (let tall_key of tall_keys) {\r\n            if (floor_keys.indexOf(tall_key) == -1) {\r\n                floor_keys.push(tall_key);\r\n            }\r\n        }\r\n        return floor_keys.map((key) => { return Object(_brew_components_utils__WEBPACK_IMPORTED_MODULE_1__[\"keyToXY\"])(key); });\r\n    }\r\n    getWalls() {\r\n        let walls = [];\r\n        let wide_walls = this.rect_wide.getPerimeter();\r\n        let tall_walls = this.rect_tall.getPerimeter();\r\n        for (let xy of wide_walls) {\r\n            if (!(this.rect_tall.isPointInside(xy))) {\r\n                walls.push(xy);\r\n            }\r\n        }\r\n        let wall_keys = walls.map((xy) => { return Object(_brew_components_utils__WEBPACK_IMPORTED_MODULE_1__[\"xyToKey\"])(xy); });\r\n        for (let xy of tall_walls) {\r\n            if ((!(this.rect_wide.isPointInside(xy))) && (wall_keys.indexOf(Object(_brew_components_utils__WEBPACK_IMPORTED_MODULE_1__[\"xyToKey\"])(xy)) == -1)) {\r\n                walls.push(xy);\r\n            }\r\n        }\r\n        return walls;\r\n        // return wide_walls.concat(tall_walls)\r\n    }\r\n    getCorners() {\r\n        let corners = [];\r\n        corners = corners.concat(this.rect_tall.getCorners()).concat(this.rect_wide.getCorners());\r\n        return corners;\r\n    }\r\n}\r\n// export class CircleRoom extends Room {\r\n//     radius: number\r\n//     center_x: number\r\n//     center_y: number\r\n//     private walls: Array<Coordinate>\r\n//     constructor(public bounding_rectangle: Rectangle) {\r\n//         super(bounding_rectangle)\r\n//         let r = Math.floor(Math.min(bounding_rectangle.height, bounding_rectangle.width) / 2)\r\n//         this.radius = r\r\n//         this.center_x = bounding_rectangle.x + r\r\n//         this.center_y = bounding_rectangle.y + r\r\n//         this.walls = []\r\n//     }\r\n//     getCorners() : Array<Coordinate> { return [] }\r\n//     getWalls() : Array<Coordinate> {\r\n//         if (this.walls.length == 0) {\r\n//             this.walls = getBresenhamCirclePoints(this.center_x, this.center_y, this.radius)\r\n//         }\r\n//         return this.walls\r\n//     }\r\n//     // getFloors() : Array<Coordinate> {\r\n//     // }\r\n// }\r\n// function getBresenhamCirclePoints (x0, y0, radius) : Array<Coordinate> {\r\n//     // return an array of [x, y] integer coordinate pairs that describe an ellipse\r\n//     // http://en.wikipedia.org/wiki/Midpoint_circle_algorithm\r\n//     let x = radius\r\n//     let y = 0\r\n//     let radiusError = 1 - x\r\n//     let points : Array<Coordinate> = []\r\n//     while (x >= y) {\r\n//         points.push(new Coordinate(x + x0, y + y0))\r\n//         points.push(new Coordinate(y + x0, x + y0))\r\n//         points.push(new Coordinate(-x + x0, y + y0))\r\n//         points.push(new Coordinate(-y + x0, x + y0))\r\n//         points.push(new Coordinate(-x + x0, -y + y0))\r\n//         points.push(new Coordinate(-y + x0, -x + y0))\r\n//         points.push(new Coordinate(x + x0, -y + y0))\r\n//         points.push(new Coordinate(y + x0, -x + y0))\r\n//         y += 1\r\n//         if (radiusError < 0) {\r\n//             radiusError += 2 * y + 1\r\n//         } else {\r\n//             x--\r\n//             radiusError += 2 * (y - x + 1)\r\n//         }\r\n//     }\r\n//     return points\r\n// }\r\nclass OvalRoom extends Room {\r\n    constructor(bounding_rectangle) {\r\n        super(bounding_rectangle);\r\n        this.bounding_rectangle = bounding_rectangle;\r\n        this.radius_a = Math.floor((bounding_rectangle.width / 2.0) - 0.5);\r\n        this.radius_b = Math.floor((bounding_rectangle.height / 2.0) - 0.5);\r\n        this.center_x = bounding_rectangle.left() + this.radius_a;\r\n        this.center_y = bounding_rectangle.top() + this.radius_b;\r\n        this.walls = [];\r\n        this.floors = [];\r\n    }\r\n    getCorners() { return []; }\r\n    getWalls() {\r\n        if (this.walls.length == 0) {\r\n            this.walls = getMcIlroyEllipsePoints(this.center_x, this.center_y, this.radius_a, this.radius_b);\r\n        }\r\n        return this.walls;\r\n    }\r\n    getFloors() {\r\n        if (this.floors.length == 0) {\r\n            this.floors = floodFillFloors(new _brew_components_coordinate__WEBPACK_IMPORTED_MODULE_2__[\"Coordinate\"](this.center_x, this.center_y), this.getWalls());\r\n        }\r\n        return this.floors;\r\n    }\r\n}\r\nfunction floodFillFloors(start_xy, walls) {\r\n    let floors = [];\r\n    // let floor_keys : Array<number> = []\r\n    // let wall_keys : Array<number> = walls.map((xy) => { return xyToKey(xy) })\r\n    // let \r\n    let flood_fn = (xy) => {\r\n        // stop condition: already visited\r\n        if (Object(_brew_components_utils__WEBPACK_IMPORTED_MODULE_1__[\"isCoordinateInListOfCoordinates\"])(xy, floors)) {\r\n            return;\r\n        }\r\n        // stop condition: wall\r\n        if (Object(_brew_components_utils__WEBPACK_IMPORTED_MODULE_1__[\"isCoordinateInListOfCoordinates\"])(xy, walls)) {\r\n            return;\r\n        }\r\n        // otherwise, record it\r\n        floors.push(xy);\r\n        // move on\r\n        for (let neighbor_xy of xy.getAdjacent()) {\r\n            flood_fn(neighbor_xy);\r\n        }\r\n    };\r\n    flood_fn(start_xy);\r\n    return floors;\r\n}\r\nfunction getMcIlroyEllipsePoints(xc, yc, a, b) {\r\n    // return an array of [x, y] integer coordinate pairs that describe an ellipse\r\n    // http://enchantia.com/graphapp/doc/tech/ellipses.html\r\n    let x = 0;\r\n    let y = b;\r\n    let a2 = a * a;\r\n    let b2 = b * b;\r\n    let crit1 = -(a2 / 4 + a % 2 + b2);\r\n    let crit2 = -(b2 / 4 + b % 2 + a2);\r\n    let crit3 = -(b2 / 4 + b % 2);\r\n    let t = -a2 * y;\r\n    let dxt = 2 * b2 * x;\r\n    let dyt = -2 * a2 * y;\r\n    let d2xt = 2 * b2;\r\n    let d2yt = 2 * a2;\r\n    let points = [];\r\n    while ((y >= 0) && (x <= a)) {\r\n        points.push(new _brew_components_coordinate__WEBPACK_IMPORTED_MODULE_2__[\"Coordinate\"](xc + x, yc + y));\r\n        if ((x != 0) || (y != 0)) {\r\n            points.push(new _brew_components_coordinate__WEBPACK_IMPORTED_MODULE_2__[\"Coordinate\"](xc - x, yc - y));\r\n        }\r\n        if ((x != 0) && (y != 0)) {\r\n            points.push(new _brew_components_coordinate__WEBPACK_IMPORTED_MODULE_2__[\"Coordinate\"](xc + x, yc - y));\r\n            points.push(new _brew_components_coordinate__WEBPACK_IMPORTED_MODULE_2__[\"Coordinate\"](xc - x, yc + y));\r\n        }\r\n        if ((t + b2 * x <= crit1) || (t + a2 * y <= crit3)) {\r\n            // incx()\r\n            x += 1;\r\n            dxt += d2xt;\r\n            t += dxt;\r\n        }\r\n        else if (t - a2 * y > crit2) {\r\n            // incy()\r\n            y -= 1;\r\n            dyt += d2yt;\r\n            t += dyt;\r\n        }\r\n        else {\r\n            // incx()\r\n            x += 1;\r\n            dxt += d2xt;\r\n            t += dxt;\r\n            // incy()\r\n            y -= 1;\r\n            dyt += d2yt;\r\n            t += dyt;\r\n        }\r\n    }\r\n    return points;\r\n}\r\nclass CorridorRoom extends Room {\r\n    constructor(bounding_rectangle, openings_xy_list) {\r\n        super(bounding_rectangle);\r\n        this.bounding_rectangle = bounding_rectangle;\r\n        this.openings_xy_list = openings_xy_list;\r\n        // this.blocks = []\r\n        this.floors = [];\r\n        this.initCorridors();\r\n    }\r\n    getCorners() { return []; }\r\n    getWalls() {\r\n        return this.bounding_rectangle.getPerimeter();\r\n    }\r\n    getFloors() {\r\n        return this.floors;\r\n    }\r\n    initCorridors() {\r\n        let fn_passable = (x, y) => {\r\n            // if (ROT.RNG.getUniform() < 0.125) {\r\n            //     return false\r\n            // }\r\n            let xy = new _brew_components_coordinate__WEBPACK_IMPORTED_MODULE_2__[\"Coordinate\"](x, y);\r\n            if (Object(_brew_components_utils__WEBPACK_IMPORTED_MODULE_1__[\"isCoordinateInListOfCoordinates\"])(xy, this.openings_xy_list)) {\r\n                return true;\r\n            }\r\n            if ((x <= this.bounding_rectangle.x) || (y <= this.bounding_rectangle.y) || (x >= this.bounding_rectangle.right()) || (y >= this.bounding_rectangle.bottom())) {\r\n                return false;\r\n            }\r\n            // let xy = new Coordinate(x, y)\r\n            return true;\r\n        };\r\n        let all_paths = [];\r\n        let local_path;\r\n        let fn_update_path = (x, y) => {\r\n            let xy = new _brew_components_coordinate__WEBPACK_IMPORTED_MODULE_2__[\"Coordinate\"](x, y);\r\n            if (!(Object(_brew_components_utils__WEBPACK_IMPORTED_MODULE_1__[\"isCoordinateInListOfCoordinates\"])(xy, local_path))) {\r\n                local_path.push(xy);\r\n            }\r\n        };\r\n        for (let from_xy of this.openings_xy_list) {\r\n            let other_openings = this.openings_xy_list.filter((xy) => { return (!(xy.compare(from_xy))); });\r\n            for (let to_xy of other_openings) {\r\n                let fwd_path = [];\r\n                let is_valid = false;\r\n                while (!(is_valid)) {\r\n                    is_valid = true;\r\n                    let random_x = Math.floor(rot_js__WEBPACK_IMPORTED_MODULE_0__[\"RNG\"].getUniform() * this.bounding_rectangle.right()) + this.bounding_rectangle.x;\r\n                    let random_y = Math.floor(rot_js__WEBPACK_IMPORTED_MODULE_0__[\"RNG\"].getUniform() * this.bounding_rectangle.bottom()) + this.bounding_rectangle.y;\r\n                    // let random_xy = new Coordinate(random_x, random_y)\r\n                    local_path = [];\r\n                    let astar = new rot_js__WEBPACK_IMPORTED_MODULE_0__[\"Path\"].AStar(from_xy.x, from_xy.y, fn_passable, { topology: 4 });\r\n                    astar.compute(random_x, random_y, fn_update_path);\r\n                    if (local_path.length == 0) {\r\n                        is_valid = false;\r\n                        continue;\r\n                    }\r\n                    fwd_path = [].concat(local_path);\r\n                    local_path = [];\r\n                    astar = new rot_js__WEBPACK_IMPORTED_MODULE_0__[\"Path\"].AStar(random_x, random_y, fn_passable, { topology: 4 });\r\n                    astar.compute(to_xy.x, to_xy.y, fn_update_path);\r\n                    if (local_path.length == 0) {\r\n                        is_valid = false;\r\n                        continue;\r\n                    }\r\n                    all_paths = all_paths.concat(local_path).concat(fwd_path);\r\n                }\r\n            }\r\n        }\r\n        this.floors = all_paths;\r\n    }\r\n}\r\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvbGV2ZWxfZ2VuZXJhdG9yL3Jvb21zLnRzPzQzZDUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBNkI7QUFFN0Isa0RBQWtEO0FBQ2xELG9DQUFvQztBQUNwQyxlQUFlO0FBQ2YsaUJBQWlCO0FBQ2pCLElBQUk7QUFDb0c7QUFDOUM7QUFFcEQ7SUFFRixZQUFtQixDQUFTLEVBQVMsQ0FBUyxFQUFTLEtBQWEsRUFBUyxNQUFlO1FBQXpFLE1BQUMsR0FBRCxDQUFDLENBQVE7UUFBUyxNQUFDLEdBQUQsQ0FBQyxDQUFRO1FBQVMsVUFBSyxHQUFMLEtBQUssQ0FBUTtRQUFTLFdBQU0sR0FBTixNQUFNLENBQVM7UUFDeEYsSUFBSSxDQUFDLEVBQUUsR0FBRyx5RUFBVSxFQUFFO0lBQzFCLENBQUM7SUFFRCxLQUFLO1FBQ0QsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLEtBQUssR0FBRyxDQUFDO0lBQ2xDLENBQUM7SUFFRCxNQUFNO1FBQ0YsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLE1BQU0sR0FBRyxDQUFDO0lBQ25DLENBQUM7SUFFRCxJQUFJLEtBQWEsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLEVBQUMsQ0FBQztJQUNoQyxHQUFHLEtBQWEsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLEVBQUMsQ0FBQztJQUUvQixJQUFJLEtBQWEsTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDLE1BQU0sRUFBQyxDQUFDO0lBRWxELGFBQWEsQ0FBQyxFQUFjO1FBQ3hCLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsR0FBRyxJQUFJLENB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LENBQUM7Q0FDSiIsImZpbGUiOiIuL3NyYy9sZXZlbF9nZW5lcmF0b3Ivcm9vbXMudHMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBST1QgZnJvbSAncm90LWpzJ1xyXG5cclxuLy8gbGV0IF9pZCA9IE1hdGguZmxvb3IoUk9ULlJORy5nZXRVbmlmb3JtKCkqOTk5OSlcclxuLy8gZnVuY3Rpb24gaWRHZW5lcmF0b3IoKSA6IG51bWJlciB7XHJcbi8vICAgICBfaWQgKz0gMVxyXG4vLyAgICAgcmV0dXJuIF9pZFxyXG4vLyB9XHJcbmltcG9ydCB7IGdlbmVyYXRlSUQsIHh5VG9LZXksIGtleVRvWFksIGlzQ29vcmRpbmF0ZUluTGlzdE9mQ29vcmRpbmF0ZXMgfSBmcm9tICcuLi9icmV3X2NvbXBvbmVudHMvdXRpbHMnXHJcbmltcG9ydCB7IENvb3JkaW5hdGUgfSBmcm9tICcuLi9icmV3X2NvbXBvbmVudHMvY29vcmRpbmF0ZSdcclxuXHJcbmV4cG9ydCBjbGFzcyBSZWN0YW5nbGUge1xyXG4gICAgaWQ6IG51bWJlclxyXG4gICAgY29uc3RydWN0b3IocHVibGljIHg6IG51bWJlciwgcHVibGljIHk6IG51bWJlciwgcHVibGljIHdpZHRoOiBudW1iZXIsIHB1YmxpYyBoZWlnaHQgOiBudW1iZXIpIHtcclxuICAgICAgICB0aGlzLmlkID0gZ2VuZXJhdGVJRCgpXHJcbiAgICB9XHJcblxyXG4gICAgcmlnaHQoKSA6IG51bWJlciB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMueCArIHRoaXMud2lkdGggLSAxXHJcbiAgICB9XHJcblxyXG4gICAgYm90dG9tKCk6IG51bWJlciB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMueSArIHRoaXMuaGVpZ2h0IC0gMVxyXG4gICAgfVxyXG5cclxuICAgIGxlZnQoKTogbnVtYmVyIHsgcmV0dXJuIHRoaXMueCB9XHJcbiAgICB0b3AoKTogbnVtYmVyIHsgcmV0dXJuIHRoaXMueSB9XHJcbiAgICBcclxuICAgIGFyZWEoKTogbnVtYmVyIHsgcmV0dXJuIHRoaXMud2lkdGggKiB0aGlzLmhlaWdodCB9XHJcblxyXG4gICAgaXNQb2ludEluc2lkZSh4eTogQ29vcmRpbmF0ZSkgOiBib29sZWFuIHtcclxuICAgICAgICByZXR1cm4gKCh4eS54ID4gdGhpcy54KSAmJiAoeHkueCA8IHRoaXMucmlnaHQoKSkgJiYgKHh5LnkgPiB0aGlzLnkpICYmICh4eS55IDwgdGhpcy5ib3R0b20oKSkpXHJcbiAgICB9XHJcblxyXG4gICAgLy8gaXNQb2ludEluc2lkZSh4eTogQ29vcmRpbmF0ZSkgOiBib29sZWFuIHtcclxuICAgIC8vICAgICByZXR1cm4gKCh4eS54ID49IHRoaXMueCkgJiYgKHh5LnggPD0gdGhpcy5yaWdodCgpKSAmJiAoeHkueSA+PSB0aGlzLnkpICYmICh4eS55IDw9IHRoaXMuYm90dG9tKCkpKVxyXG4gICAgLy8gfVxyXG5cclxuICAgIGNoZWNrSW50ZXJzZWN0aW9uX1N0cmljdChvdGhlcl9yZWN0OiBSZWN0YW5nbGUpIDogYm9vbGVhbiB7XHJcbiAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAodGhpcy5yaWdodCgpIDwgb3RoZXJfcmVjdC5sZWZ0KCkpIHx8XHJcbiAgICAgICAgICAgIChvdGhlcl9yZWN0LnJpZ2h0KCkgPCB0aGlzLmxlZnQoKSkgfHxcclxuICAgICAgICAgICAgKHRoaXMuYm90dG9tKCkgPCBvdGhlcl9yZWN0LnRvcCgpKSB8fFxyXG4gICAgICAgICAgICAob3RoZXJfcmVjdC5ib3R0b20oKSA8IHRoaXMudG9wKCkpXHJcbiAgICAgICAgKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGNoZWNrSW50ZXJzZWN0aW9uX0FsbG93UGVyaW1ldGVyKG90aGVyX3JlY3Q6IFJlY3RhbmdsZSkgOiBib29sZWFuIHtcclxuICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgICh0aGlzLnJpZ2h0KCkgPD0gb3RoZXJfcmVjdC5sZWZ0KCkpIHx8XHJcbiAgICAgICAgICAgIChvdGhlcl9yZWN0LnJpZ2h0KCkgPD0gdGhpcy5sZWZ0KCkpIHx8XHJcbiAgICAgICAgICAgICh0aGlzLmJvdHRvbSgpIDw9IG90aGVyX3JlY3QudG9wKCkpIHx8XHJcbiAgICAgICAgICAgIChvdGhlcl9yZWN0LmJvdHRvbSgpIDw9IHRoaXMudG9wKCkpXHJcbiAgICAgICAgKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIGNoZWNrT3ZlcmxhcChvdGhlcl9yZWN0IDogUmVjdGFuZ2xlKSA6IGJvb2xlYW4ge1xyXG4gICAgLy8gICAgIHJldHVybiB0aGlzLmdldENvcm5lcnMoKS5zb21lKCh4eSkgPT4ge1xyXG4gICAgLy8gICAgICAgICByZXR1cm4gb3RoZXJfcmVjdC5pc1BvaW50SW5zaWRlKHh5KVxyXG4gICAgLy8gICAgIH0pXHJcbiAgICAvLyB9XHJcbiAgICBcclxuICAgIGNvbnRhaW5zKG90aGVyX3JlY3Q6IFJlY3RhbmdsZSkgOiBib29sZWFuIHtcclxuICAgICAgICByZXR1cm4gb3RoZXJfcmVjdC5nZXRDb3JuZXJzKCkuZXZlcnkoKHh5KSA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmlzUG9pbnRJbnNpZGUoeHkpXHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICBnZXRQZXJpbWV0ZXIoKSA6IEFycmF5PENvb3JkaW5hdGU+IHtcclxuICAgICAgICBsZXQgd2FsbHMgOiBBcnJheTxDb29yZGluYXRlPiA9IFtdXHJcbiAgICAgICAgZm9yIChsZXQgeCA9IDA7IHggPCB0aGlzLndpZHRoOyB4KyspIHtcclxuICAgICAgICAgICAgd2FsbHMucHVzaChuZXcgQ29vcmRpbmF0ZSh4ICsgdGhpcy54LCB0aGlzLnkpKVxyXG4gICAgICAgICAgICB3YWxscy5wdXNoKG5ldyBDb29yZGluYXRlKHggKyB0aGlzLngsIHRoaXMuYm90dG9tKCkpKVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZm9yIChsZXQgeSA9IDE7IHkgPCB0aGlzLmhlaWdodCAtIDE7IHkrKykge1xyXG4gICAgICAgICAgICB3YWxscy5wdXNoKG5ldyBDb29yZGluYXRlKHRoaXMueCwgeSArIHRoaXMueSkpXHJcbiAgICAgICAgICAgIHdhbGxzLnB1c2gobmV3IENvb3JkaW5hdGUodGhpcy5yaWdodCgpLCB5ICsgdGhpcy55KSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiB3YWxsc1xyXG4gICAgfVxyXG5cclxuICAgIGdldEludGVyaW9yKCkgOiBBcnJheTxDb29yZGluYXRlPiB7XHJcbiAgICAgICAgbGV0IGZsb29ycyA6IEFycmF5PENvb3JkaW5hdGU+ID0gW11cclxuICAgICAgICBmb3IgKGxldCB4ID0gdGhpcy54ICsgMTsgeCA8IHRoaXMucmlnaHQoKTsgeCsrKSB7XHJcbiAgICAgICAgICAgIGZvciAobGV0IHkgPSB0aGlzLnkgKyAxOyB5IDwgdGhpcy5ib3R0b20oKTsgeSsrKSB7XHJcbiAgICAgICAgICAgICAgICBmbG9vcnMucHVzaChuZXcgQ29vcmRpbmF0ZSh4LCB5KSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmxvb3JzXHJcbiAgICB9XHJcblxyXG4gICAgZ2V0Q29ybmVycygpIDogQXJyYXk8Q29vcmRpbmF0ZT4ge1xyXG4gICAgICAgIHJldHVybiBbXHJcbiAgICAgICAgICAgIG5ldyBDb29yZGluYXRlKHRoaXMueCwgdGhpcy55KSxcclxuICAgICAgICAgICAgbmV3IENvb3JkaW5hdGUodGhpcy54LCB0aGlzLmJvdHRvbSgpKSxcclxuICAgICAgICAgICAgbmV3IENvb3JkaW5hdGUodGhpcy5yaWdodCgpLCB0aGlzLnkpLFxyXG4gICAgICAgICAgICBuZXcgQ29vcmRpbmF0ZSh0aGlzLnJpZ2h0KCksIHRoaXMuYm90dG9tKCkpLFxyXG4gICAgICAgIF1cclxuICAgIH1cclxuXHJcbiAgICBpc0Nvcm5lcih4eTogQ29vcmRpbmF0ZSkgOiBib29sZWFuIHtcclxuICAgICAgICBsZXQgY29ybmVycyA9IHRoaXMuZ2V0Q29ybmVycygpXHJcbiAgICAgICAgcmV0dXJuIGNvcm5lcnMuc29tZSgoY29ybmVyX3h5KSA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiAoY29ybmVyX3h5LmNvbXBhcmUoeHkpKVxyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgZ2V0UGVyaW1ldGVyX05vQ29ybmVycygpIDogQXJyYXk8Q29vcmRpbmF0ZT4ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmdldFBlcmltZXRlcigpLmZpbHRlcigoeHkpID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuICghKHRoaXMuaXNDb3JuZXIoeHkpKSlcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIElEb29yIHtcclxuICAgIGZyb21fYXJlYV9pZDogbnVtYmVyLFxyXG4gICAgdG9fYXJlYV9pZDogbnVtYmVyLFxyXG4gICAgeHk6IENvb3JkaW5hdGUsXHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBSb29tIHtcclxuICAgIGlkOiBudW1iZXJcclxuICAgIGRvb3JzOiBBcnJheTxJRG9vcj5cclxuICAgIGNvbnN0cnVjdG9yKHB1YmxpYyBib3VuZGluZ19yZWN0YW5nbGU6IFJlY3RhbmdsZSkge1xyXG4gICAgICAgICAgICB0aGlzLmlkID0gZ2VuZXJhdGVJRCgpICAgICAgICAgICBcclxuICAgICAgICAgICAgdGhpcy5kb29ycyA9IFtdXHJcbiAgICB9XHJcblxyXG4gICAgYWRkRG9vcihkb29yOiBJRG9vcikge1xyXG4gICAgICAgIHRoaXMuZG9vcnMucHVzaChkb29yKVxyXG4gICAgfVxyXG5cclxuICAgIGdldEZsb29ycyAoKSA6IEFycmF5PENvb3JkaW5hdGU+IHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJkb2VzIG5vdCBpbXBsZW1lbnQgZ2V0Rmxvb3JzXCIpXHJcbiAgICB9XHJcblxyXG4gICAgZ2V0V2FsbHMgKCkgOiBBcnJheTxDb29yZGluYXRlPiB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiZG9lcyBub3QgaW1wbGVtZW50IGdldEZsb29yc1wiKVxyXG4gICAgfVxyXG5cclxuICAgIGdldENvcm5lcnMgKCkgOiBBcnJheTxDb29yZGluYXRlPiB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiZG9lcyBub3QgaW1wbGVtZW50IGdldEZsb29yc1wiKVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBpc0Nvcm5lciAoeHk6IENvb3JkaW5hdGUpIDogYm9vbGVhbiB7XHJcbiAgICAgICAgbGV0IGNvcm5lcnMgPSB0aGlzLmdldENvcm5lcnMoKVxyXG4gICAgICAgIHJldHVybiBjb3JuZXJzLnNvbWUoKGNvcm5lcl94eSkgPT4ge1xyXG4gICAgICAgICAgICByZXR1cm4gKGNvcm5lcl94eS5jb21wYXJlKHh5KSlcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBnZXRXYWxsc09ubHkgKCkgOiBBcnJheTxDb29yZGluYXRlPiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0V2FsbHMoKS5maWx0ZXIoKHh5KSA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiAoISh0aGlzLmlzQ29ybmVyKHh5KSkpXHJcbiAgICAgICAgfSlcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIFJlY3RhbmdsZVJvb20gZXh0ZW5kcyBSb29tIHtcclxuICAgIGdldEZsb29ycyAoKSA6IEFycmF5PENvb3JkaW5hdGU+IHtcclxuICAgICAgICByZXR1cm4gdGhpcy5ib3VuZGluZ19yZWN0YW5nbGUuZ2V0SW50ZXJpb3IoKVxyXG4gICAgfVxyXG5cclxuICAgIGdldFdhbGxzICgpIDogQXJyYXk8Q29vcmRpbmF0ZT4ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmJvdW5kaW5nX3JlY3RhbmdsZS5nZXRQZXJpbWV0ZXIoKVxyXG4gICAgfVxyXG5cclxuICAgIGdldENvcm5lcnMgKCkgOiBBcnJheTxDb29yZGluYXRlPiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYm91bmRpbmdfcmVjdGFuZ2xlLmdldENvcm5lcnMoKVxyXG4gICAgfVxyXG5cclxuICAgIGlzQ29ybmVyICh4eTogQ29vcmRpbmF0ZSk6IGJvb2xlYW4ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmJvdW5kaW5nX3JlY3RhbmdsZS5pc0Nvcm5lcih4eSlcclxuICAgIH1cclxuXHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBDcm9zc1Jvb20gZXh0ZW5kcyBSb29tIHtcclxuICAgIGNvbnN0cnVjdG9yKHB1YmxpYyBib3VuZGluZ19yZWN0YW5nbGU6IFJlY3RhbmdsZSwgcHVibGljIHJlY3RfdGFsbCA6IFJlY3RhbmdsZSwgcHVibGljIHJlY3Rfd2lkZSA6IFJlY3RhbmdsZSkge1xyXG4gICAgICAgIHN1cGVyKGJvdW5kaW5nX3JlY3RhbmdsZSlcclxuXHJcbiAgICB9XHJcbiAgICBnZXRGbG9vcnMgKCkgOiBBcnJheTxDb29yZGluYXRlPiB7XHJcbiAgICAgICAgbGV0IGZsb29yX2tleXMgPSB0aGlzLnJlY3Rfd2lkZS5nZXRJbnRlcmlvcigpLm1hcCgoeHkpID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuIHh5VG9LZXkoeHkpXHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgbGV0IHRhbGxfa2V5cyA9IHRoaXMucmVjdF90YWxsLmdldEludGVyaW9yKCkubWFwKCh4eSkgPT4ge1xyXG4gICAgICAgICAgICByZXR1cm4geHlUb0tleSh4eSlcclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICBcclxuICAgICAgICBmb3IgKGxldCB0YWxsX2tleSBvZiB0YWxsX2tleXMpIHtcclxuICAgICAgICAgICAgaWYgKGZsb29yX2tleXMuaW5kZXhPZih0YWxsX2tleSkgPT0gLTEpIHtcclxuICAgICAgICAgICAgICAgIGZsb29yX2tleXMucHVzaCh0YWxsX2tleSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGZsb29yX2tleXMubWFwKChrZXkpID0+IHsgcmV0dXJuIGtleVRvWFkoa2V5KX0pXHJcbiAgICB9XHJcblxyXG4gICAgZ2V0V2FsbHMgKCkgOiBBcnJheTxDb29yZGluYXRlPiB7XHJcbiAgICAgICAgbGV0IHdhbGxzIDogQXJyYXk8Q29vcmRpbmF0ZT4gPSBbXVxyXG4gICAgICAgIGxldCB3aWRlX3dhbGxzID0gdGhpcy5yZWN0X3dpZGUuZ2V0UGVyaW1ldGVyKClcclxuICAgICAgICBsZXQgdGFsbF93YWxscyA9IHRoaXMucmVjdF90YWxsLmdldFBlcmltZXRlcigpXHJcblxyXG4gICAgICAgIGZvciAobGV0IHh5IG9mIHdpZGVfd2FsbHMpIHtcclxuICAgICAgICAgICAgaWYgKCEodGhpcy5yZWN0X3RhbGwuaXNQb2ludEluc2lkZSh4eSkpKSB7XHJcbiAgICAgICAgICAgICAgICB3YWxscy5wdXNoKHh5KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgd2FsbF9rZXlzID0gd2FsbHMubWFwKCh4eSkgPT4geyByZXR1cm4geHlUb0tleSh4eSkgfSlcclxuXHJcbiAgICAgICAgZm9yIChsZXQgeHkgb2YgdGFsbF93YWxscykge1xyXG4gICAgICAgICAgICBpZiAoKCEodGhpcy5yZWN0X3dpZGUuaXNQb2ludEluc2lkZSh4eSkpKSAmJiAod2FsbF9rZXlzLmluZGV4T2YoeHlUb0tleSh4eSkpID09IC0xKSkge1xyXG4gICAgICAgICAgICAgICAgd2FsbHMucHVzaCh4eSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHdhbGxzXHJcbiAgICAgICAgLy8gcmV0dXJuIHdpZGVfd2FsbHMuY29uY2F0KHRhbGxfd2FsbHMpXHJcbiAgICB9XHJcblxyXG4gICAgZ2V0Q29ybmVycyAoKSA6IEFycmF5PENvb3JkaW5hdGU+IHtcclxuICAgICAgICBsZXQgY29ybmVycyA6IEFycmF5PENvb3JkaW5hdGU+ID0gW11cclxuICAgICAgICBjb3JuZXJzID0gY29ybmVycy5jb25jYXQodGhpcy5yZWN0X3RhbGwuZ2V0Q29ybmVycygpKS5jb25jYXQodGhpcy5yZWN0X3dpZGUuZ2V0Q29ybmVycygpKVxyXG4gICAgICAgIHJldHVybiBjb3JuZXJzXHJcbiAgICB9XHJcblxyXG59XHJcblxyXG4vLyBleHBvcnQgY2xhc3MgQ2lyY2xlUm9vbSBleHRlbmRzIFJvb20ge1xyXG4vLyAgICAgcmFkaXVzOiBudW1iZXJcclxuLy8gICAgIGNlbnRlcl94OiBudW1iZXJcclxuLy8gICAgIGNlbnRlcl95OiBudW1iZXJcclxuLy8gICAgIHByaXZhdGUgd2FsbHM6IEFycmF5PENvb3JkaW5hdGU+XHJcblxyXG4vLyAgICAgY29uc3RydWN0b3IocHVibGljIGJvdW5kaW5nX3JlY3RhbmdsZTogUmVjdGFuZ2xlKSB7XHJcbi8vICAgICAgICAgc3VwZXIoYm91bmRpbmdfcmVjdGFuZ2xlKVxyXG4vLyAgICAgICAgIGxldCByID0gTWF0aC5mbG9vcihNYXRoLm1pbihib3VuZGluZ19yZWN0YW5nbGUuaGVpZ2h0LCBib3VuZGluZ19yZWN0YW5nbGUud2lkdGgpIC8gMilcclxuLy8gICAgICAgICB0aGlzLnJhZGl1cyA9IHJcclxuLy8gICAgICAgICB0aGlzLmNlbnRlcl94ID0gYm91bmRpbmdfcmVjdGFuZ2xlLnggKyByXHJcbi8vICAgICAgICAgdGhpcy5jZW50ZXJfeSA9IGJvdW5kaW5nX3JlY3RhbmdsZS55ICsgclxyXG4vLyAgICAgICAgIHRoaXMud2FsbHMgPSBbXVxyXG4vLyAgICAgfVxyXG5cclxuLy8gICAgIGdldENvcm5lcnMoKSA6IEFycmF5PENvb3JkaW5hdGU+IHsgcmV0dXJuIFtdIH1cclxuLy8gICAgIGdldFdhbGxzKCkgOiBBcnJheTxDb29yZGluYXRlPiB7XHJcbi8vICAgICAgICAgaWYgKHRoaXMud2FsbHMubGVuZ3RoID09IDApIHtcclxuLy8gICAgICAgICAgICAgdGhpcy53YWxscyA9IGdldEJyZXNlbmhhbUNpcmNsZVBvaW50cyh0aGlzLmNlbnRlcl94LCB0aGlzLmNlbnRlcl95LCB0aGlzLnJhZGl1cylcclxuLy8gICAgICAgICB9XHJcbi8vICAgICAgICAgcmV0dXJuIHRoaXMud2FsbHNcclxuLy8gICAgIH1cclxuXHJcbi8vICAgICAvLyBnZXRGbG9vcnMoKSA6IEFycmF5PENvb3JkaW5hdGU+IHtcclxuXHJcbi8vICAgICAvLyB9XHJcbi8vIH1cclxuXHJcbi8vIGZ1bmN0aW9uIGdldEJyZXNlbmhhbUNpcmNsZVBvaW50cyAoeDAsIHkwLCByYWRpdXMpIDogQXJyYXk8Q29vcmRpbmF0ZT4ge1xyXG4vLyAgICAgLy8gcmV0dXJuIGFuIGFycmF5IG9mIFt4LCB5XSBpbnRlZ2VyIGNvb3JkaW5hdGUgcGFpcnMgdGhhdCBkZXNjcmliZSBhbiBlbGxpcHNlXHJcbi8vICAgICAvLyBodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL01pZHBvaW50X2NpcmNsZV9hbGdvcml0aG1cclxuXHJcbi8vICAgICBsZXQgeCA9IHJhZGl1c1xyXG4vLyAgICAgbGV0IHkgPSAwXHJcbi8vICAgICBsZXQgcmFkaXVzRXJyb3IgPSAxIC0geFxyXG5cclxuLy8gICAgIGxldCBwb2ludHMgOiBBcnJheTxDb29yZGluYXRlPiA9IFtdXHJcblxyXG4vLyAgICAgd2hpbGUgKHggPj0geSkge1xyXG4vLyAgICAgICAgIHBvaW50cy5wdXNoKG5ldyBDb29yZGluYXRlKHggKyB4MCwgeSArIHkwKSlcclxuLy8gICAgICAgICBwb2ludHMucHVzaChuZXcgQ29vcmRpbmF0ZSh5ICsgeDAsIHggKyB5MCkpXHJcbi8vICAgICAgICAgcG9pbnRzLnB1c2gobmV3IENvb3JkaW5hdGUoLXggKyB4MCwgeSArIHkwKSlcclxuLy8gICAgICAgICBwb2ludHMucHVzaChuZXcgQ29vcmRpbmF0ZSgteSArIHgwLCB4ICsgeTApKVxyXG4vLyAgICAgICAgIHBvaW50cy5wdXNoKG5ldyBDb29yZGluYXRlKC14ICsgeDAsIC15ICsgeTApKVxyXG4vLyAgICAgICAgIHBvaW50cy5wdXNoKG5ldyBDb29yZGluYXRlKC15ICsgeDAsIC14ICsgeTApKVxyXG4vLyAgICAgICAgIHBvaW50cy5wdXNoKG5ldyBDb29yZGluYXRlKHggKyB4MCwgLXkgKyB5MCkpXHJcbi8vICAgICAgICAgcG9pbnRzLnB1c2gobmV3IENvb3JkaW5hdGUoeSArIHgwLCAteCArIHkwKSlcclxuLy8gICAgICAgICB5ICs9IDFcclxuXHJcbi8vICAgICAgICAgaWYgKHJhZGl1c0Vycm9yIDwgMCkge1xyXG4vLyAgICAgICAgICAgICByYWRpdXNFcnJvciArPSAyICogeSArIDFcclxuXHJcbi8vICAgICAgICAgfSBlbHNlIHtcclxuLy8gICAgICAgICAgICAgeC0tXHJcbi8vICAgICAgICAgICAgIHJhZGl1c0Vycm9yICs9IDIgKiAoeSAtIHggKyAxKVxyXG4vLyAgICAgICAgIH1cclxuLy8gICAgIH1cclxuXHJcbi8vICAgICByZXR1cm4gcG9pbnRzXHJcbi8vIH1cclxuXHJcblxyXG5leHBvcnQgY2xhc3MgT3ZhbFJvb20gZXh0ZW5kcyBSb29tIHtcclxuICAgIHJhZGl1c19hOiBudW1iZXJcclxuICAgIHJhZGl1c19iOiBudW1iZXJcclxuICAgIGNlbnRlcl94OiBudW1iZXJcclxuICAgIGNlbnRlcl95OiBudW1iZXJcclxuICAgIHByaXZhdGUgd2FsbHM6IEFycmF5PENvb3JkaW5hdGU+XHJcbiAgICBwcml2YXRlIGZsb29yczogQXJyYXk8Q29vcmRpbmF0ZT5cclxuXHJcbiAgICBjb25zdHJ1Y3RvcihwdWJsaWMgYm91bmRpbmdfcmVjdGFuZ2xlOiBSZWN0YW5nbGUpIHtcclxuICAgICAgICBzdXBlcihib3VuZGluZ19yZWN0YW5nbGUpXHJcbiAgICAgICAgdGhpcy5yYWRpdXNfYSA9IE1hdGguZmxvb3IoKGJvdW5kaW5nX3JlY3RhbmdsZS53aWR0aCAvIDIuMCkgLSAwLjUpXHJcbiAgICAgICAgdGhpcy5yYWRpdXNfYiA9IE1hdGguZmxvb3IoKGJvdW5kaW5nX3JlY3RhbmdsZS5oZWlnaHQgLyAyLjApIC0gMC41KVxyXG4gICAgICAgIHRoaXMuY2VudGVyX3ggPSBib3VuZGluZ19yZWN0YW5nbGUubGVmdCgpICsgdGhpcy5yYWRpdXNfYVxyXG4gICAgICAgIHRoaXMuY2VudGVyX3kgPSBib3VuZGluZ19yZWN0YW5nbGUudG9wKCkgKyB0aGlzLnJhZGl1c19iXHJcbiAgICAgICAgdGhpcy53YWxscyA9IFtdXHJcbiAgICAgICAgdGhpcy5mbG9vcnMgPSBbXVxyXG4gICAgfVxyXG5cclxuICAgIGdldENvcm5lcnMoKSA6IEFycmF5PENvb3JkaW5hdGU+IHsgcmV0dXJuIFtdIH1cclxuICAgIGdldFdhbGxzKCkgOiBBcnJheTxDb29yZGluYXRlPiB7XHJcbiAgICAgICAgaWYgKHRoaXMud2FsbHMubGVuZ3RoID09IDApIHtcclxuICAgICAgICAgICAgdGhpcy53YWxscyA9IGdldE1jSWxyb3lFbGxpcHNlUG9pbnRzKHRoaXMuY2VudGVyX3gsIHRoaXMuY2VudGVyX3ksIHRoaXMucmFkaXVzX2EsIHRoaXMucmFkaXVzX2IpXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLndhbGxzXHJcbiAgICB9XHJcblxyXG4gICAgZ2V0Rmxvb3JzKCkgOiBBcnJheTxDb29yZGluYXRlPiB7XHJcbiAgICAgICAgaWYgKHRoaXMuZmxvb3JzLmxlbmd0aCA9PSAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZmxvb3JzID0gZmxvb2RGaWxsRmxvb3JzKG5ldyBDb29yZGluYXRlKHRoaXMuY2VudGVyX3gsIHRoaXMuY2VudGVyX3kpLCB0aGlzLmdldFdhbGxzKCkpXHJcbiAgICAgICAgfSBcclxuICAgICAgICByZXR1cm4gdGhpcy5mbG9vcnNcclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gZmxvb2RGaWxsRmxvb3JzKHN0YXJ0X3h5OiBDb29yZGluYXRlLCB3YWxsczogQXJyYXk8Q29vcmRpbmF0ZT4pIDogQXJyYXk8Q29vcmRpbmF0ZT4ge1xyXG4gICAgbGV0IGZsb29ycyA6IEFycmF5PENvb3JkaW5hdGU+ID0gW11cclxuICAgIC8vIGxldCBmbG9vcl9rZXlzIDogQXJyYXk8bnVtYmVyPiA9IFtdXHJcbiAgICAvLyBsZXQgd2FsbF9rZXlzIDogQXJyYXk8bnVtYmVyPiA9IHdhbGxzLm1hcCgoeHkpID0+IHsgcmV0dXJuIHh5VG9LZXkoeHkpIH0pXHJcbiAgICAvLyBsZXQgXHJcbiAgICBcclxuICAgIGxldCBmbG9vZF9mbiA9ICh4eTogQ29vcmRpbmF0ZSkgPT4ge1xyXG4gICAgICAgIC8vIHN0b3AgY29uZGl0aW9uOiBhbHJlYWR5IHZpc2l0ZWRcclxuICAgICAgICBpZiAoaXNDb29yZGluYXRlSW5MaXN0T2ZDb29yZGluYXRlcyh4eSwgZmxvb3JzKSkge1xyXG4gICAgICAgICAgICByZXR1cm5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIHN0b3AgY29uZGl0aW9uOiB3YWxsXHJcbiAgICAgICAgaWYgKGlzQ29vcmRpbmF0ZUluTGlzdE9mQ29vcmRpbmF0ZXMoeHksIHdhbGxzKSkge1xyXG4gICAgICAgICAgICByZXR1cm5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIG90aGVyd2lzZSwgcmVjb3JkIGl0XHJcbiAgICAgICAgZmxvb3JzLnB1c2goeHkpXHJcblxyXG4gICAgICAgIC8vIG1vdmUgb25cclxuICAgICAgICBmb3IgKGxldCBuZWlnaGJvcl94eSBvZiB4eS5nZXRBZGphY2VudCgpKSB7XHJcbiAgICAgICAgICAgIGZsb29kX2ZuKG5laWdoYm9yX3h5KVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBmbG9vZF9mbihzdGFydF94eSlcclxuICAgIHJldHVybiBmbG9vcnNcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0TWNJbHJveUVsbGlwc2VQb2ludHMgKHhjOiBudW1iZXIgLCB5YzogbnVtYmVyLCBhOiBudW1iZXIsIGI6IG51bWJlcikgOiBBcnJheTxDb29yZGluYXRlPiB7XHJcbiAgICAvLyByZXR1cm4gYW4gYXJyYXkgb2YgW3gsIHldIGludGVnZXIgY29vcmRpbmF0ZSBwYWlycyB0aGF0IGRlc2NyaWJlIGFuIGVsbGlwc2VcclxuICAgIC8vIGh0dHA6Ly9lbmNoYW50aWEuY29tL2dyYXBoYXBwL2RvYy90ZWNoL2VsbGlwc2VzLmh0bWxcclxuXHJcbiAgICBsZXQgeCA9IDBcclxuICAgIGxldCB5ID0gYlxyXG4gICAgbGV0IGEyID0gYSphXHJcbiAgICBsZXQgYjIgPSBiKmJcclxuICAgIGxldCBjcml0MSA9IC0oYTIvNCArIGElMiArIGIyKVxyXG4gICAgbGV0IGNyaXQyID0gLShiMi80ICsgYiUyICsgYTIpXHJcbiAgICBsZXQgY3JpdDMgPSAtKGIyLzQgKyBiJTIpXHJcbiAgICBsZXQgdCA9IC1hMip5XHJcbiAgICBsZXQgZHh0ID0gMipiMip4XHJcbiAgICBsZXQgZHl0ID0gLTIqYTIqeVxyXG4gICAgbGV0IGQyeHQgPSAyKmIyXHJcbiAgICBsZXQgZDJ5dCA9IDIqYTJcclxuXHJcbiAgICBsZXQgcG9pbnRzIDogQXJyYXk8Q29vcmRpbmF0ZT4gPSBbXVxyXG5cclxuICAgIHdoaWxlICgoeSA+PSAwKSAmJiAoeCA8PSBhKSkge1xyXG4gICAgICAgIHBvaW50cy5wdXNoKG5ldyBDb29yZGluYXRlKHhjK3gsIHljK3kpKVxyXG4gICAgICAgIFxyXG4gICAgICAgIGlmICgoeCAhPSAwKSB8fCAoeSAhPSAwKSkge1xyXG4gICAgICAgICAgICBwb2ludHMucHVzaChuZXcgQ29vcmRpbmF0ZSh4Yy14LCB5Yy15KSlcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCh4ICE9IDApICYmICh5ICE9IDApKSB7XHJcbiAgICAgICAgICAgIHBvaW50cy5wdXNoKG5ldyBDb29yZGluYXRlKHhjK3gsIHljLXkpKVxyXG4gICAgICAgICAgICBwb2ludHMucHVzaChuZXcgQ29vcmRpbmF0ZSh4Yy14LCB5Yyt5KSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICgodCArIGIyKnggPD0gY3JpdDEpIHx8ICh0ICsgYTIqeSA8PSBjcml0MykpIHtcclxuICAgICAgICAgICAgLy8gaW5jeCgpXHJcbiAgICAgICAgICAgIHggKz0gMVxyXG4gICAgICAgICAgICBkeHQgKz0gZDJ4dFxyXG4gICAgICAgICAgICB0ICs9IGR4dFxyXG5cclxuICAgICAgICB9IGVsc2UgaWYgKHQgLSBhMip5ID4gY3JpdDIpIHtcclxuICAgICAgICAgICAgLy8gaW5jeSgpXHJcbiAgICAgICAgICAgIHkgLT0gMVxyXG4gICAgICAgICAgICBkeXQgKz0gZDJ5dFxyXG4gICAgICAgICAgICB0ICs9IGR5dFxyXG5cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBpbmN4KClcclxuICAgICAgICAgICAgeCArPSAxXHJcbiAgICAgICAgICAgIGR4dCArPSBkMnh0XHJcbiAgICAgICAgICAgIHQgKz0gZHh0XHJcblxyXG4gICAgICAgICAgICAvLyBpbmN5KClcclxuICAgICAgICAgICAgeSAtPSAxXHJcbiAgICAgICAgICAgIGR5dCArPSBkMnl0XHJcbiAgICAgICAgICAgIHQgKz0gZHl0XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBwb2ludHNcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIENvcnJpZG9yUm9vbSBleHRlbmRzIFJvb20ge1xyXG4gICAgLy8gcHJpdmF0ZSBibG9ja3M6IEFycmF5PENvb3JkaW5hdGU+XHJcbiAgICBwcml2YXRlIGZsb29yczogQXJyYXk8Q29vcmRpbmF0ZT5cclxuXHJcbiAgICBjb25zdHJ1Y3RvcihwdWJsaWMgYm91bmRpbmdfcmVjdGFuZ2xlOiBSZWN0YW5nbGUsIHByaXZhdGUgb3BlbmluZ3NfeHlfbGlzdDogQXJyYXk8Q29vcmRpbmF0ZT4pIHtcclxuICAgICAgICBzdXBlcihib3VuZGluZ19yZWN0YW5nbGUpXHJcbiAgICAgICAgLy8gdGhpcy5ibG9ja3MgPSBbXVxyXG4gICAgICAgIHRoaXMuZmxvb3JzID0gW11cclxuICAgICAgICB0aGlzLmluaXRDb3JyaWRvcnMoKVxyXG4gICAgfVxyXG5cclxuICAgIGdldENvcm5lcnMoKSA6IEFycmF5PENvb3JkaW5hdGU+IHsgcmV0dXJuIFtdIH1cclxuICAgIGdldFdhbGxzKCkgOiBBcnJheTxDb29yZGluYXRlPiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYm91bmRpbmdfcmVjdGFuZ2xlLmdldFBlcmltZXRlcigpXHJcbiAgICB9XHJcblxyXG4gICAgZ2V0Rmxvb3JzKCkgOiBBcnJheTxDb29yZGluYXRlPiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZmxvb3JzXHJcbiAgICB9XHJcblxyXG4gICAgaW5pdENvcnJpZG9ycygpIHtcclxuICAgICAgICBsZXQgZm5fcGFzc2FibGUgPSAoeDogbnVtYmVyLCB5OiBudW1iZXIpIDogYm9vbGVhbiA9PiB7XHJcbiAgICAgICAgICAgIC8vIGlmIChST1QuUk5HLmdldFVuaWZvcm0oKSA8IDAuMTI1KSB7XHJcbiAgICAgICAgICAgIC8vICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgICAgICAgLy8gfVxyXG4gICAgICAgICAgICBsZXQgeHkgPSBuZXcgQ29vcmRpbmF0ZSh4LCB5KVxyXG4gICAgICAgICAgICBpZiAoaXNDb29yZGluYXRlSW5MaXN0T2ZDb29yZGluYXRlcyh4eSwgdGhpcy5vcGVuaW5nc194eV9saXN0KSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKCh4IDw9IHRoaXMuYm91bmRpbmdfcmVjdGFuZ2xlLngpIHx8ICh5IDw9IHRoaXMuYm91bmRpbmdfcmVjdGFuZ2xlLnkpIHx8ICh4ID49IHRoaXMuYm91bmRpbmdfcmVjdGFuZ2xlLnJpZ2h0KCkpIHx8ICh5ID49IHRoaXMuYm91bmRpbmdfcmVjdGFuZ2xlLmJvdHRvbSgpKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gbGV0IHh5ID0gbmV3IENvb3JkaW5hdGUoeCwgeSlcclxuICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IGFsbF9wYXRocyA6IEFycmF5PENvb3JkaW5hdGU+ID0gW11cclxuICAgICAgICBsZXQgbG9jYWxfcGF0aCA6IEFycmF5PENvb3JkaW5hdGU+IFxyXG5cclxuICAgICAgICBsZXQgZm5fdXBkYXRlX3BhdGggPSAoeDogbnVtYmVyLCB5OiBudW1iZXIpIDogdm9pZCA9PiB7XHJcbiAgICAgICAgICAgIGxldCB4eSA9IG5ldyBDb29yZGluYXRlKHgsIHkpXHJcbiAgICAgICAgICAgIGlmICghKGlzQ29vcmRpbmF0ZUluTGlzdE9mQ29vcmRpbmF0ZXMoeHksIGxvY2FsX3BhdGgpKSkge1xyXG4gICAgICAgICAgICAgICAgbG9jYWxfcGF0aC5wdXNoKHh5KVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmb3IgKGxldCBmcm9tX3h5IG9mIHRoaXMub3BlbmluZ3NfeHlfbGlzdCkge1xyXG4gICAgICAgICAgICBsZXQgb3RoZXJfb3BlbmluZ3MgPSB0aGlzLm9wZW5pbmdzX3h5X2xpc3QuZmlsdGVyKCh4eSkgPT4geyByZXR1cm4gKCEoeHkuY29tcGFyZShmcm9tX3h5KSkpIH0pXHJcblxyXG4gICAgICAgICAgICBmb3IgKGxldCB0b194eSBvZiBvdGhlcl9vcGVuaW5ncykge1xyXG4gICAgICAgICAgICAgICAgbGV0IGZ3ZF9wYXRoIDogQXJyYXk8Q29vcmRpbmF0ZT4gPSBbXVxyXG4gICAgICAgICAgICAgICAgbGV0IGlzX3ZhbGlkID0gZmFsc2VcclxuICAgICAgICAgICAgICAgIHdoaWxlICghKGlzX3ZhbGlkKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlzX3ZhbGlkID0gdHJ1ZVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBsZXQgcmFuZG9tX3ggPSBNYXRoLmZsb29yKFJPVC5STkcuZ2V0VW5pZm9ybSgpKnRoaXMuYm91bmRpbmdfcmVjdGFuZ2xlLnJpZ2h0KCkpICsgdGhpcy5ib3VuZGluZ19yZWN0YW5nbGUueFxyXG4gICAgICAgICAgICAgICAgICAgIGxldCByYW5kb21feSA9IE1hdGguZmxvb3IoUk9ULlJORy5nZXRVbmlmb3JtKCkqdGhpcy5ib3VuZGluZ19yZWN0YW5nbGUuYm90dG9tKCkpICsgdGhpcy5ib3VuZGluZ19yZWN0YW5nbGUueVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGxldCByYW5kb21feHkgPSBuZXcgQ29vcmRpbmF0ZShyYW5kb21feCwgcmFuZG9tX3kpXHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGxvY2FsX3BhdGggPSBbXVxyXG4gICAgICAgICAgICAgICAgICAgIGxldCBhc3RhciA9IG5ldyBST1QuUGF0aC5BU3Rhcihmcm9tX3h5LngsIGZyb21feHkueSwgZm5fcGFzc2FibGUsIHsgdG9wb2xvZ3k6IDR9KVxyXG4gICAgICAgICAgICAgICAgICAgIGFzdGFyLmNvbXB1dGUocmFuZG9tX3gsIHJhbmRvbV95LCBmbl91cGRhdGVfcGF0aClcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGxvY2FsX3BhdGgubGVuZ3RoID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaXNfdmFsaWQgPSBmYWxzZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZndkX3BhdGggPSBbXS5jb25jYXQobG9jYWxfcGF0aClcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgbG9jYWxfcGF0aCA9IFtdXHJcbiAgICAgICAgICAgICAgICAgICAgYXN0YXIgPSBuZXcgUk9ULlBhdGguQVN0YXIocmFuZG9tX3gsIHJhbmRvbV95LCBmbl9wYXNzYWJsZSwgeyB0b3BvbG9neTogNH0pXHJcbiAgICAgICAgICAgICAgICAgICAgYXN0YXIuY29tcHV0ZSh0b194eS54LCB0b194eS55LCBmbl91cGRhdGVfcGF0aClcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGxvY2FsX3BhdGgubGVuZ3RoID09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaXNfdmFsaWQgPSBmYWxzZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICBhbGxfcGF0aHMgPSBhbGxfcGF0aHMuY29uY2F0KGxvY2FsX3BhdGgpLmNvbmNhdChmd2RfcGF0aClcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIFxyXG5cclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmZsb29ycyA9IGFsbF9wYXRoc1xyXG4gICAgfVxyXG59XHJcbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/level_generator/rooms.ts\n");

/***/ }),

/***/ "./src/start.ts":
/*!**********************!*\
  !*** ./src/start.ts ***!
  \**********************/
/*! exports provided: startGame */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"startGame\", function() { return startGame; });\n/* harmony import */ var postal__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! postal */ \"./node_modules/postal/lib/postal.js\");\n/* harmony import */ var postal__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(postal__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _brew__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./brew */ \"./src/brew.ts\");\n\r\n\r\nvar gm;\r\nvar BREW_FIRST_STARTUP = true;\r\n// var BREW_START_SEED : number = null\r\nfunction startGame(given_seed = 202) {\r\n    postal__WEBPACK_IMPORTED_MODULE_0__[\"reset\"]();\r\n    let divGame = (document.getElementById(\"id_div_game\"));\r\n    // given_seed = 168\r\n    // unconnected seed with broken pathmaps = 4258\r\n    gm = new _brew__WEBPACK_IMPORTED_MODULE_1__[\"GameMaster\"](given_seed, divGame, _brew__WEBPACK_IMPORTED_MODULE_1__[\"Input\"].handleAllInput, // input\r\n    _brew__WEBPACK_IMPORTED_MODULE_1__[\"Events\"].mainEventhandler, // event\r\n    _brew__WEBPACK_IMPORTED_MODULE_1__[\"Intel\"].mainAiHandler, // ai\r\n    _brew__WEBPACK_IMPORTED_MODULE_1__[\"Intel\"].runBeforePlayerTurn, // pre-player\r\n    _brew__WEBPACK_IMPORTED_MODULE_1__[\"Intel\"].runAfterPlayerTurn);\r\n    if (BREW_FIRST_STARTUP) {\r\n        gm.initEventListener(divGame);\r\n    }\r\n    BREW_FIRST_STARTUP = false;\r\n    test_sandbox();\r\n}\r\nfunction test_sandbox() {\r\n    // let a_set = new Brew.CoordinateArea()\r\n    // a_set.addCoordinate(new Brew.Coordinate(2, 2))\r\n    // a_set.addCoordinates(new Brew.Coordinate(2, 2).getAdjacent())\r\n    // console.log(\"A\", a_set.getCoordinates())\r\n    // console.log(\"A except 0,0\", a_set.getCoordinatesExcept([new Brew.Coordinate(0, 0)]))\r\n    // let b_set = new Brew.CoordinateArea()\r\n    // b_set.addCoordinates([new Brew.Coordinate(2, 2), new Brew.Coordinate(3, 2), new Brew.Coordinate(1, 2), new Brew.Coordinate(5, 5)])\r\n    // debugger\r\n    // console.log(\"B\", b_set)\r\n    // console.log(\"A+B union\", b_set.getUnion(a_set))\r\n    // console.log(\"A diff B\", a_set.getDiff(b_set))\r\n    // console.log(\"B diff A\", b_set.getDiff(a_set))\r\n    // console.log(\"A B symm diff\", a_set.getSymmetricDiff(b_set))\r\n}\r\n// window.onload = startGame\r\n// window.onload = function (event) {\r\n//   someFunction(someArg, someOtherArg)\r\n// }\r\n// http://stackoverflow.com/questions/901115/how-can-i-get-query-string-values-in-javascript/901144#901144\r\nfunction getParameterByName(name) {\r\n    var match = RegExp('[?&]' + name + '=([^&]*)').exec(window.location.search);\r\n    return match && decodeURIComponent(match[1].replace(/\\+/g, ' '));\r\n}\r\nvar gseed = getParameterByName(\"seed\");\r\nvar use_boss_mode = Boolean(getParameterByName(\"boss\"));\r\nif (use_boss_mode) {\r\n    _brew__WEBPACK_IMPORTED_MODULE_1__[\"Debug\"].toggleBossMode(true);\r\n    let background_img_src = 'https://www.google.com/images/branding/googlelogo/1x/googlelogo_color_272x92dp.png';\r\n    let param_img = getParameterByName(\"img\");\r\n    if (param_img) {\r\n        background_img_src = param_img;\r\n    }\r\n    let imgBackground = (document.getElementById(\"id_img_backgroundcover\"));\r\n    imgBackground.src = background_img_src;\r\n}\r\nstartGame(Number(gseed));\r\n\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvc3RhcnQudHM/ODNlMSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFnQztBQUNGO0FBRTlCLElBQUksRUFBb0I7QUFFeEIsSUFBSSxrQkFBa0IsR0FBYSxJQUFJO0FBQ3ZDLHNDQUFzQztBQUVoQyxtQkFBb0IsYUFBcUIsR0FBRztJQUU5Qyw0Q0FBWSxFQUFFO0lBQ2QsSUFBSSxPQUFPLEdBQW9CLENBQUMsUUFBUSxDQUFDLGNBQWMsQ0FBQyxhQUFhLENBQUMsQ0FBQztJQUV2RSxtQkFBbUI7SUFDbkIsK0NBQStDO0lBQy9DLEVBQUUsR0FBRyxJQUFJLGdEQUFlLENBQ3BCLFVBQVUsRUFDVixPQUFPLEVBQ1AsMkNBQVUsQ0FBQyxjQUFjLEVBQUUsUUFBUTtJQUNuQyw0Q0FBVyxDQUFDLGdCQUFnQixFQUFDLFFBQVE7SUFDckMsMkNBQVUsQ0FBQyxhQUFhLEVBQUUsS0FBSztJQUMvQiwyQ0FBVSxDQUFDLG1CQUFtQixFQUFFLGFBQWE7SUFDN0MsMkNBQVUsQ0FBQyxrQkFBa0IsQ0FDaEM7SUFFRCxFQUFFLENBQUMsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDLENBQUM7UUFDckIsRUFBRSxDQUFDLGlCQUFpQixDQUFDLE9BQU8sQ0FBQztJQUNqQyxDQUFDO0lBRUQsa0JBQWtCLEdBQUcsS0FBSztJQUMxQixZQUFZLEVBQUU7QUFDbEIsQ0FBQztBQUVEO0lBQ0ksd0NBQXdDO0lBQ3hDLGlEQUFpRDtJQUNqRCxnRUFBZ0U7SUFDaEUsMkNBQTJDO0lBRTNDLHVGQUF1RjtJQUV2Rix3Q0FBd0M7SUFDeEMscUlBQXFJO0lBQ3JJLFdBQVc7SUFDWCwwQkFBMEI7SUFDMUIsa0RBQWtEO0lBQ2xELGdEQUFnRDtJQUNoRCxnREFBZ0Q7SUFDaEQsOERBQThEO0FBRWxFLENBQUM7QUFFRCw0QkFBNEI7QUFFNUIscUNBQXFDO0FBQ3JDLHdDQUF3QztBQUN4QyxJQUFJO0FBRUosMEdBQTBHO0FBQzFHLDRCQUE0QixJQUFZO0lBQ3BDLElBQUksS0FBSyxHQUFHLE1BQU0sQ0FBQyxNQUFNLEdBQUcsSUFBSSxHQUFHLFVBQVUsQ0FBQyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQzVFLE1BQU0sQ0FBQyxLQUFLLElBQUksa0JBQWtCLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxLQUFLLEVBQUUsR0FBRyxDQUFDLENBQUMsQ0FBQztBQUNyRSxDQUFDO0FBRUQsSUFBSSxLQUFLLEdBQUcsa0JBQWtCLENBQUMsTUFBTSxDQUFDO0FBQ3RDLElBQUksYUFBYSxHQUFHLE9BQU8sQ0FBQyxrQkFBa0IsQ0FBQyxNQUFNLENBQUMsQ0FBQztBQUV2RCxFQUFFLENBQUMsQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDO0lBQ2hCLDJDQUFVLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQztJQUcvQixJQUFJLGtCQUFrQixHQUFHLG9GQUFvRjtJQUM3RyxJQUFJLFNBQVMsR0FBRyxrQkFBa0IsQ0FBQyxLQUFLLENBQUM7SUFFekMsRUFBRSxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQztRQUNaLGtCQUFrQixHQUFHLFNBQVM7SUFDbEMsQ0FBQztJQUNELElBQUksYUFBYSxHQUFxQixDQUFDLFFBQVEsQ0FBQyxjQUFjLENBQUMsd0JBQXdCLENBQUMsQ0FBQztJQUN6RixhQUFhLENBQUMsR0FBRyxHQUFHLGtCQUFrQjtBQUUxQyxDQUFDO0FBR0QsU0FBUyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyIsImZpbGUiOiIuL3NyYy9zdGFydC50cy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIHBvc3RhbCBmcm9tICdwb3N0YWwnXHJcbmltcG9ydCAqIGFzIEJyZXcgZnJvbSBcIi4vYnJld1wiXHJcblxyXG52YXIgZ20gOiBCcmV3LkdhbWVNYXN0ZXJcclxuXHJcbnZhciBCUkVXX0ZJUlNUX1NUQVJUVVAgOiBib29sZWFuID0gdHJ1ZVxyXG4vLyB2YXIgQlJFV19TVEFSVF9TRUVEIDogbnVtYmVyID0gbnVsbFxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHN0YXJ0R2FtZShnaXZlbl9zZWVkOiBudW1iZXIgPSAyMDIpIHtcclxuXHJcbiAgICBwb3N0YWwucmVzZXQoKVxyXG4gICAgbGV0IGRpdkdhbWUgPSA8SFRNTERpdkVsZW1lbnQ+IChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImlkX2Rpdl9nYW1lXCIpKVxyXG4gICAgXHJcbiAgICAvLyBnaXZlbl9zZWVkID0gMTY4XHJcbiAgICAvLyB1bmNvbm5lY3RlZCBzZWVkIHdpdGggYnJva2VuIHBhdGhtYXBzID0gNDI1OFxyXG4gICAgZ20gPSBuZXcgQnJldy5HYW1lTWFzdGVyKFxyXG4gICAgICAgIGdpdmVuX3NlZWQsXHJcbiAgICAgICAgZGl2R2FtZSxcclxuICAgICAgICBCcmV3LklucHV0LmhhbmRsZUFsbElucHV0LCAvLyBpbnB1dFxyXG4gICAgICAgIEJyZXcuRXZlbnRzLm1haW5FdmVudGhhbmRsZXIsLy8gZXZlbnRcclxuICAgICAgICBCcmV3LkludGVsLm1haW5BaUhhbmRsZXIsIC8vIGFpXHJcbiAgICAgICAgQnJldy5JbnRlbC5ydW5CZWZvcmVQbGF5ZXJUdXJuLCAvLyBwcmUtcGxheWVyXHJcbiAgICAgICAgQnJldy5JbnRlbC5ydW5BZnRlclBsYXllclR1cm4sIC8vIHBvc3QtcGxheWVyLFxyXG4gICAgKVxyXG4gICAgXHJcbiAgICBpZiAoQlJFV19GSVJTVF9TVEFSVFVQKSB7XHJcbiAgICAgICAgZ20uaW5pdEV2ZW50TGlzdGVuZXIoZGl2R2FtZSlcclxuICAgIH1cclxuXHJcbiAgICBCUkVXX0ZJUlNUX1NUQVJUVVAgPSBmYWxzZVxyXG4gICAgdGVzdF9zYW5kYm94KClcclxufVxyXG5cclxuZnVuY3Rpb24gdGVzdF9zYW5kYm94KCkge1xyXG4gICAgLy8gbGV0IGFfc2V0ID0gbmV3IEJyZXcuQ29vcmRpbmF0ZUFyZWEoKVxyXG4gICAgLy8gYV9zZXQuYWRkQ29vcmRpbmF0ZShuZXcgQnJldy5Db29yZGluYXRlKDIsIDIpKVxyXG4gICAgLy8gYV9zZXQuYWRkQ29vcmRpbmF0ZXMobmV3IEJyZXcuQ29vcmRpbmF0ZSgyLCAyKS5nZXRBZGphY2VudCgpKVxyXG4gICAgLy8gY29uc29sZS5sb2coXCJBXCIsIGFfc2V0LmdldENvb3JkaW5hdGVzKCkpXHJcblxyXG4gICAgLy8gY29uc29sZS5sb2coXCJBIGV4Y2VwdCAwLDBcIiwgYV9zZXQuZ2V0Q29vcmRpbmF0ZXNFeGNlcHQoW25ldyBCcmV3LkNvb3JkaW5hdGUoMCwgMCldKSlcclxuXHJcbiAgICAvLyBsZXQgYl9zZXQgPSBuZXcgQnJldy5Db29yZGluYXRlQXJlYSgpXHJcbiAgICAvLyBiX3NldC5hZGRDb29yZGluYXRlcyhbbmV3IEJyZXcuQ29vcmRpbmF0ZSgyLCAyKSwgbmV3IEJyZXcuQ29vcmRpbmF0ZSgzLCAyKSwgbmV3IEJyZXcuQ29vcmRpbmF0ZSgxLCAyKSwgbmV3IEJyZXcuQ29vcmRpbmF0ZSg1LCA1KV0pXHJcbiAgICAvLyBkZWJ1Z2dlclxyXG4gICAgLy8gY29uc29sZS5sb2coXCJCXCIsIGJfc2V0KVxyXG4gICAgLy8gY29uc29sZS5sb2coXCJBK0IgdW5pb25cIiwgYl9zZXQuZ2V0VW5pb24oYV9zZXQpKVxyXG4gICAgLy8gY29uc29sZS5sb2coXCJBIGRpZmYgQlwiLCBhX3NldC5nZXREaWZmKGJfc2V0KSlcclxuICAgIC8vIGNvbnNvbGUubG9nKFwiQiBkaWZmIEFcIiwgYl9zZXQuZ2V0RGlmZihhX3NldCkpXHJcbiAgICAvLyBjb25zb2xlLmxvZyhcIkEgQiBzeW1tIGRpZmZcIiwgYV9zZXQuZ2V0U3ltbWV0cmljRGlmZihiX3NldCkpXHJcblxyXG59XHJcblxyXG4vLyB3aW5kb3cub25sb2FkID0gc3RhcnRHYW1lXHJcblxyXG4vLyB3aW5kb3cub25sb2FkID0gZnVuY3Rpb24gKGV2ZW50KSB7XHJcbi8vICAgc29tZUZ1bmN0aW9uKHNvbWVBcmcsIHNvbWVPdGhlckFyZylcclxuLy8gfVxyXG5cclxuLy8gaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy85MDExMTUvaG93LWNhbi1pLWdldC1xdWVyeS1zdHJpbmctdmFsdWVzLWluLWphdmFzY3JpcHQvOTAxMTQ0IzkwMTE0NFxyXG5mdW5jdGlvbiBnZXRQYXJhbWV0ZXJCeU5hbWUobmFtZTogc3RyaW5nKSB7XHJcbiAgICB2YXIgbWF0Y2ggPSBSZWdFeHAoJ1s/Jl0nICsgbmFtZSArICc9KFteJl0qKScpLmV4ZWMod2luZG93LmxvY2F0aW9uLnNlYXJjaCk7XHJcbiAgICByZXR1cm4gbWF0Y2ggJiYgZGVjb2RlVVJJQ29tcG9uZW50KG1hdGNoWzFdLnJlcGxhY2UoL1xcKy9nLCAnICcpKTtcclxufVxyXG5cclxudmFyIGdzZWVkID0gZ2V0UGFyYW1ldGVyQnlOYW1lKFwic2VlZFwiKVxyXG52YXIgdXNlX2Jvc3NfbW9kZSA9IEJvb2xlYW4oZ2V0UGFyYW1ldGVyQnlOYW1lKFwiYm9zc1wiKSlcclxuXHJcbmlmICh1c2VfYm9zc19tb2RlKSB7XHJcbiAgICBCcmV3LkRlYnVnLnRvZ2dsZUJvc3NNb2RlKHRydWUpXHJcblxyXG4gICAgXHJcbiAgICBsZXQgYmFja2dyb3VuZF9pbWdfc3JjID0gJ2h0dHBzOi8vd3d3Lmdvb2dsZS5jb20vaW1hZ2VzL2JyYW5kaW5nL2dvb2dsZWxvZ28vMXgvZ29vZ2xlbG9nb19jb2xvcl8yNzJ4OTJkcC5wbmcnXHJcbiAgICBsZXQgcGFyYW1faW1nID0gZ2V0UGFyYW1ldGVyQnlOYW1lKFwiaW1nXCIpXHJcblxyXG4gICAgaWYgKHBhcmFtX2ltZykge1xyXG4gICAgICAgIGJhY2tncm91bmRfaW1nX3NyYyA9IHBhcmFtX2ltZ1xyXG4gICAgfVxyXG4gICAgbGV0IGltZ0JhY2tncm91bmQgPSA8SFRNTEltYWdlRWxlbWVudD4oZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJpZF9pbWdfYmFja2dyb3VuZGNvdmVyXCIpKVxyXG4gICAgaW1nQmFja2dyb3VuZC5zcmMgPSBiYWNrZ3JvdW5kX2ltZ19zcmNcclxuXHJcbn1cclxuXHJcblxyXG5zdGFydEdhbWUoTnVtYmVyKGdzZWVkKSlcclxuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/start.ts\n");

/***/ })

/******/ });